BLEU SCORE: 0.16233395773754944

TEST MSG: some changes to find the bug
GENERATED MSG: some changes regarding right structure size

TEST DIFF (one line): diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbFunction . java b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbFunction . java <nl> index 5903e2f . . 4327da4 100644 <nl> - - - a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbFunction . java <nl> + + + b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbFunction . java <nl> @ @ - 52 , 8 + 52 , 8 @ @ public class TlbFunction extends TlbAbstractMethod implements Variant { <nl> <nl> String methodparams = " " ; <nl> String methodvariables = " " ; <nl> - int vtableId = funcDesc . oVft ; <nl> - int paramCount = funcDesc . cParams ; <nl> + short vtableId = funcDesc . oVft . shortValue ( ) ; <nl> + short paramCount = funcDesc . cParams . shortValue ( ) ; <nl> ELEMDESC elemDesdRetType = funcDesc . elemdescFunc ; <nl> String returnType = this . getType ( elemDesdRetType . tdesc ) ; <nl> String [ ] names = typeInfoUtil . getNames ( funcDesc . memid , paramCount + 1 ) ; <nl> diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbFunctionStub . java b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbFunctionStub . java <nl> index caa7ab9 . . 81c27f0 100644 <nl> - - - a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbFunctionStub . java <nl> + + + b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbFunctionStub . java <nl> @ @ - 56 , 8 + 56 , 8 @ @ public class TlbFunctionStub extends TlbAbstractMethod implements Variant { <nl> <nl> String methodparams = " " ; <nl> String methodvariables = " " ; <nl> - int vtableId = funcDesc . oVft ; <nl> - int paramCount = funcDesc . cParams ; <nl> + short vtableId = funcDesc . oVft . shortValue ( ) ; <nl> + short paramCount = funcDesc . cParams . shortValue ( ) ; <nl> ELEMDESC elemDesdRetType = funcDesc . elemdescFunc ; <nl> String returnType = this . getType ( elemDesdRetType . tdesc ) ; <nl> String [ ] names = typeInfoUtil . getNames ( funcDesc . memid , paramCount + 1 ) ; <nl> diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyGet . java b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyGet . java <nl> index 4556168 . . f78572b 100644 <nl> - - - a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyGet . java <nl> + + + b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyGet . java <nl> @ @ - 47 , 7 + 47 , 7 @ @ public class TlbPropertyGet extends TlbAbstractMethod implements Variant { <nl> super ( index , typeLibUtil , funcDesc , typeInfoUtil ) ; <nl> <nl> this . methodName = " get " + this . getMethodName ( ) ; <nl> - int vtableId = funcDesc . oVft ; <nl> + short vtableId = funcDesc . oVft . shortValue ( ) ; <nl> String returnType = this . getType ( funcDesc ) ; <nl> <nl> this . replaceVariable ( " helpstring " , docStr ) ; <nl> diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyGetStub . java b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyGetStub . java <nl> index 3969ffb . . 0facd12 100644 <nl> - - - a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyGetStub . java <nl> + + + b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyGetStub . java <nl> @ @ - 53 , 7 + 53 , 7 @ @ public class TlbPropertyGetStub extends TlbAbstractMethod implements Variant { <nl> TypeInfoDoc typeInfoDoc = typeInfoUtil . getDocumentation ( funcDesc . memid ) ; <nl> String docStr = typeInfoDoc . getDocString ( ) ; <nl> String methodname = " get " + typeInfoDoc . getName ( ) ; <nl> - int vtableId = funcDesc . oVft ; <nl> + short vtableId = funcDesc . oVft . shortValue ( ) ; <nl> String returnType = this . getType ( funcDesc ) ; <nl> <nl> this . replaceVariable ( " helpstring " , docStr ) ; <nl> diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyPut . java b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyPut . java <nl> index aaaced6 . . e5adb72 100644 <nl> - - - a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyPut . java <nl> + + + b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyPut . java <nl> @ @ - 53 , 8 + 53 , 8 @ @ public class TlbPropertyPut extends TlbAbstractMethod implements Variant { <nl> this . methodName = " set " + getMethodName ( ) ; <nl> String methodparams = " " ; <nl> String methodvariables = " , " ; <nl> - int vtableId = funcDesc . oVft ; <nl> - int paramCount = funcDesc . cParams ; <nl> + short vtableId = funcDesc . oVft . shortValue ( ) ; <nl> + short paramCount = funcDesc . cParams . shortValue ( ) ; <nl> String varType ; <nl> String [ ] names = typeInfoUtil . getNames ( funcDesc . memid , paramCount + 1 ) ; <nl> <nl> diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyPutStub . java b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyPutStub . java <nl> index 14b8025 . . 11bdd5b 100644 <nl> - - - a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyPutStub . java <nl> + + + b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyPutStub . java <nl> @ @ - 54 , 8 + 54 , 8 @ @ public class TlbPropertyPutStub extends TlbAbstractMethod implements Variant { <nl> String docStr = typeInfoDoc . getDocString ( ) ; <nl> String methodname = " set " + typeInfoDoc . getName ( ) ; <nl> String methodparams = " " ; <nl> - int vtableId = funcDesc . oVft ; <nl> - int paramCount = funcDesc . cParams ; <nl> + short vtableId = funcDesc . oVft . shortValue ( ) ; <nl> + short paramCount = funcDesc . cParams . shortValue ( ) ; <nl> String varType ; <nl> String [ ] names = typeInfoUtil . getNames ( funcDesc . memid , paramCount + 1 ) ; <nl> <nl> diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / OaIdl . java b / contrib / platform / src / com / sun / jna / platform / win32 / OaIdl . java <nl> index 0831423 . . f4efbd7 100644 <nl> - - - a / contrib / platform / src / com / sun / jna / platform / win32 / OaIdl . java <nl> + + + b / contrib / platform / src / com / sun / jna / platform / win32 / OaIdl . java <nl> @ @ - 26 , 6 + 26 , 7 @ @ import com . sun . jna . platform . win32 . WinDef . LONG ; <nl> import com . sun . jna . platform . win32 . WinDef . LONGLONG ; <nl> import com . sun . jna . platform . win32 . WinDef . PVOID ; <nl> import com . sun . jna . platform . win32 . WinDef . SCODE ; <nl> + import com . sun . jna . platform . win32 . WinDef . SHORT ; <nl> import com . sun . jna . platform . win32 . WinDef . ULONG ; <nl> import com . sun . jna . platform . win32 . WinDef . ULONGLONG ; <nl> import com . sun . jna . platform . win32 . WinDef . USHORT ; <nl> @ @ - 768 , 31 + 769 , 18 @ @ public interface OaIdl { <nl> Structure . ByReference { <nl> } ; <nl> <nl> - / / / C type : MEMBERID <nl> public MEMBERID memid ; <nl> - / * * <nl> - * [ size _ is ] < br > <nl> - * C type : SCODE * <nl> - * / <nl> public ScodeArg . ByReference lprgscode ; <nl> - / * * <nl> - * [ size _ is ] < br > <nl> - * C type : ELEMDESC * <nl> - * / <nl> public ElemDescArg . ByReference lprgelemdescParam ; <nl> - / / / C type : FUNCKIND <nl> public FUNCKIND funckind ; <nl> - / / / C type : INVOKEKIND <nl> public INVOKEKIND invkind ; <nl> - / / / C type : CALLCONV <nl> public CALLCONV callconv ; <nl> - public int cParams ; <nl> - public int cParamsOpt ; <nl> - public int oVft ; <nl> - public int cScodes ; <nl> - / / / C type : ELEMDESC <nl> + public SHORT cParams ; <nl> + public SHORT cParamsOpt ; <nl> + public SHORT oVft ; <nl> + public SHORT cScodes ; <nl> public ELEMDESC elemdescFunc ; <nl> - public int wFuncFlags ; <nl> + public WORD wFuncFlags ; <nl> <nl> public FUNCDESC ( ) { <nl> } <nl> @ @ - 801 , 8 + 789 , 8 @ @ public interface OaIdl { <nl> super ( pointer ) ; <nl> this . read ( ) ; <nl> <nl> - if ( this . cParams > 1 ) { <nl> - this . lprgelemdescParam . elemDescArg = new ELEMDESC [ this . cParams ] ; <nl> + if ( this . cParams . shortValue ( ) > 1 ) { <nl> + this . lprgelemdescParam . elemDescArg = new ELEMDESC [ this . cParams . shortValue ( ) ] ; <nl> this . lprgelemdescParam . read ( ) ; <nl> } <nl> } <nl> @ @ - 1351 , 7 + 1339 , 7 @ @ public interface OaIdl { <nl> } <nl> <nl> @ Override <nl> - protected List getFieldOrder ( ) { <nl> + protected List < String > getFieldOrder ( ) { <nl> return Arrays . asList ( new String [ ] { " cBytes " , " varDefaultValue " } ) ; <nl> } <nl> } <nl> diff - - git a / contrib / platform / test / com / sun / jna / platform / win32 / COM / TypeLibUtilTest . java b / contrib / platform / test / com / sun / jna / platform / win32 / COM / TypeLibUtilTest . java <nl> index b5defd3 . . b592068 100644 <nl> - - - a / contrib / platform / test / com / sun / jna / platform / win32 / COM / TypeLibUtilTest . java <nl> + + + b / contrib / platform / test / com / sun / jna / platform / win32 / COM / TypeLibUtilTest . java <nl> @ @ - 38 , 7 + 38 , 7 @ @ public class TypeLibUtilTest extends TestCase { <nl> public void testGetTypeInfoCount ( ) { <nl> TypeLibUtil shellTypeLib = loadShellTypeLib ( ) ; <nl> int typeInfoCount = shellTypeLib . getTypeInfoCount ( ) ; <nl> - assertTrue ( " MS Shell should contain at 36 types . " , typeInfoCount = = 36 ) ; <nl> + assertTrue ( " MS Shell should contain at least 36 types . " , typeInfoCount > = 36 ) ; <nl> } <nl> <nl> public void testGetTypeInfo ( ) { <nl> @ @ - 70 , 4 + 70 , 32 @ @ public class TypeLibUtilTest extends TestCase { <nl> typeInfoUtil . ReleaseTypeAttr ( typeAttr ) ; <nl> } <nl> } <nl> + <nl> + public void testBug ( ) { <nl> + TypeLibUtil shellTypeLib = loadShellTypeLib ( ) ; <nl> + int typeInfoCount = shellTypeLib . getTypeInfoCount ( ) ; <nl> + <nl> + ITypeInfo typeInfo = shellTypeLib . getTypeInfo ( 4 ) ; <nl> + TypeInfoUtil typeInfoUtil = new TypeInfoUtil ( typeInfo ) ; <nl> + <nl> + TYPEATTR typeAttr = typeInfoUtil . getTypeAttr ( ) ; <nl> + int cFuncs = typeAttr . cFuncs . intValue ( ) ; <nl> + <nl> + for ( int y = 13 ; y < cFuncs ; y + + ) { <nl> + System . out . println ( " y : " + y ) ; <nl> + / / Get the function description <nl> + FUNCDESC funcDesc = typeInfoUtil . getFuncDesc ( y ) ; <nl> + / / Get the member ID <nl> + MEMBERID memberID = funcDesc . memid ; <nl> + / / Get the name of the method <nl> + TypeInfoDoc typeInfoDoc2 = typeInfoUtil . getDocumentation ( memberID ) ; <nl> + String methodName = typeInfoDoc2 . getName ( ) ; <nl> + <nl> + assertNotNull ( methodName ) ; <nl> + <nl> + typeInfoUtil . ReleaseFuncDesc ( funcDesc ) ; <nl> + } <nl> + <nl> + typeInfoUtil . ReleaseTypeAttr ( typeAttr ) ; <nl> + } <nl> } <nl> diff - - git a / src / com / sun / jna / Structure . java b / src / com / sun / jna / Structure . java <nl> index c1d5224 . . 9e5b56c 100644 <nl> - - - a / src / com / sun / jna / Structure . java <nl> + + + b / src / com / sun / jna / Structure . java <nl> @ @ - 534 , 8 + 534 , 6 @ @ public abstract class Structure { <nl> try { <nl> for ( Iterator i = fields ( ) . values ( ) . iterator ( ) ; i . hasNext ( ) ; ) { <nl> StructField structField = ( StructField ) i . next ( ) ; <nl> - System . out . println ( structField . name ) ; <nl> - System . out . println ( structField . type . toString ( ) ) ; <nl> readField ( structField ) ; <nl> } <nl> }
NEAREST DIFF (one line): diff - - git a / www / FrequentlyAskedQuestions . md b / www / FrequentlyAskedQuestions . md <nl> index e0c7e80 . . 25f39d1 100644 <nl> - - - a / www / FrequentlyAskedQuestions . md <nl> + + + b / www / FrequentlyAskedQuestions . md <nl> @ @ - 46 , 13 + 46 , 15 @ @ Find your corresponding native declaration below : <nl> / / Field is a pointer to an array of struct <nl> typedef struct _ outerstruct5 { <nl> simplestruct * ptr _ to _ array ; / / use Structure . ByReference , and use <nl> - / / Structure . toArray ( ) to allocate the array <nl> + / / Structure . toArray ( ) to allocate the array , <nl> + / / then assign the first array element to the field <nl> } outerstruct5 ; <nl> <nl> / / struct pointers as return value or argument <nl> - / / use Structure <nl> - outerstruct * myfunc ( ) ; <nl> - void myfunc ( outerstruct * data ) ; <nl> + simplestruct * myfunc ( ) ; / / use Structure <nl> + void myfunc ( simplestruct * data ) ; <nl> + void myfunc ( simplestruct * data _ array , int count ) ; / / use Structure [ ] , and use Structure . toArray ( ) to generate the array <nl> + void myfunc ( simplestruct * * data _ array , int count ) ; / / use Structure . ByReference [ ] <nl> <nl> / / struct ( by value ) as return value or argument <nl> / / use Structure . ByValue

TEST DIFF:
diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbFunction . java b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbFunction . java 
 index 5903e2f . . 4327da4 100644 
 - - - a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbFunction . java 
 + + + b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbFunction . java 
 @ @ - 52 , 8 + 52 , 8 @ @ public class TlbFunction extends TlbAbstractMethod implements Variant { 
 
 String methodparams = " " ; 
 String methodvariables = " " ; 
 - int vtableId = funcDesc . oVft ; 
 - int paramCount = funcDesc . cParams ; 
 + short vtableId = funcDesc . oVft . shortValue ( ) ; 
 + short paramCount = funcDesc . cParams . shortValue ( ) ; 
 ELEMDESC elemDesdRetType = funcDesc . elemdescFunc ; 
 String returnType = this . getType ( elemDesdRetType . tdesc ) ; 
 String [ ] names = typeInfoUtil . getNames ( funcDesc . memid , paramCount + 1 ) ; 
 diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbFunctionStub . java b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbFunctionStub . java 
 index caa7ab9 . . 81c27f0 100644 
 - - - a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbFunctionStub . java 
 + + + b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbFunctionStub . java 
 @ @ - 56 , 8 + 56 , 8 @ @ public class TlbFunctionStub extends TlbAbstractMethod implements Variant { 
 
 String methodparams = " " ; 
 String methodvariables = " " ; 
 - int vtableId = funcDesc . oVft ; 
 - int paramCount = funcDesc . cParams ; 
 + short vtableId = funcDesc . oVft . shortValue ( ) ; 
 + short paramCount = funcDesc . cParams . shortValue ( ) ; 
 ELEMDESC elemDesdRetType = funcDesc . elemdescFunc ; 
 String returnType = this . getType ( elemDesdRetType . tdesc ) ; 
 String [ ] names = typeInfoUtil . getNames ( funcDesc . memid , paramCount + 1 ) ; 
 diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyGet . java b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyGet . java 
 index 4556168 . . f78572b 100644 
 - - - a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyGet . java 
 + + + b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyGet . java 
 @ @ - 47 , 7 + 47 , 7 @ @ public class TlbPropertyGet extends TlbAbstractMethod implements Variant { 
 super ( index , typeLibUtil , funcDesc , typeInfoUtil ) ; 
 
 this . methodName = " get " + this . getMethodName ( ) ; 
 - int vtableId = funcDesc . oVft ; 
 + short vtableId = funcDesc . oVft . shortValue ( ) ; 
 String returnType = this . getType ( funcDesc ) ; 
 
 this . replaceVariable ( " helpstring " , docStr ) ; 
 diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyGetStub . java b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyGetStub . java 
 index 3969ffb . . 0facd12 100644 
 - - - a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyGetStub . java 
 + + + b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyGetStub . java 
 @ @ - 53 , 7 + 53 , 7 @ @ public class TlbPropertyGetStub extends TlbAbstractMethod implements Variant { 
 TypeInfoDoc typeInfoDoc = typeInfoUtil . getDocumentation ( funcDesc . memid ) ; 
 String docStr = typeInfoDoc . getDocString ( ) ; 
 String methodname = " get " + typeInfoDoc . getName ( ) ; 
 - int vtableId = funcDesc . oVft ; 
 + short vtableId = funcDesc . oVft . shortValue ( ) ; 
 String returnType = this . getType ( funcDesc ) ; 
 
 this . replaceVariable ( " helpstring " , docStr ) ; 
 diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyPut . java b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyPut . java 
 index aaaced6 . . e5adb72 100644 
 - - - a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyPut . java 
 + + + b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyPut . java 
 @ @ - 53 , 8 + 53 , 8 @ @ public class TlbPropertyPut extends TlbAbstractMethod implements Variant { 
 this . methodName = " set " + getMethodName ( ) ; 
 String methodparams = " " ; 
 String methodvariables = " , " ; 
 - int vtableId = funcDesc . oVft ; 
 - int paramCount = funcDesc . cParams ; 
 + short vtableId = funcDesc . oVft . shortValue ( ) ; 
 + short paramCount = funcDesc . cParams . shortValue ( ) ; 
 String varType ; 
 String [ ] names = typeInfoUtil . getNames ( funcDesc . memid , paramCount + 1 ) ; 
 
 diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyPutStub . java b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyPutStub . java 
 index 14b8025 . . 11bdd5b 100644 
 - - - a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyPutStub . java 
 + + + b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbPropertyPutStub . java 
 @ @ - 54 , 8 + 54 , 8 @ @ public class TlbPropertyPutStub extends TlbAbstractMethod implements Variant { 
 String docStr = typeInfoDoc . getDocString ( ) ; 
 String methodname = " set " + typeInfoDoc . getName ( ) ; 
 String methodparams = " " ; 
 - int vtableId = funcDesc . oVft ; 
 - int paramCount = funcDesc . cParams ; 
 + short vtableId = funcDesc . oVft . shortValue ( ) ; 
 + short paramCount = funcDesc . cParams . shortValue ( ) ; 
 String varType ; 
 String [ ] names = typeInfoUtil . getNames ( funcDesc . memid , paramCount + 1 ) ; 
 
 diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / OaIdl . java b / contrib / platform / src / com / sun / jna / platform / win32 / OaIdl . java 
 index 0831423 . . f4efbd7 100644 
 - - - a / contrib / platform / src / com / sun / jna / platform / win32 / OaIdl . java 
 + + + b / contrib / platform / src / com / sun / jna / platform / win32 / OaIdl . java 
 @ @ - 26 , 6 + 26 , 7 @ @ import com . sun . jna . platform . win32 . WinDef . LONG ; 
 import com . sun . jna . platform . win32 . WinDef . LONGLONG ; 
 import com . sun . jna . platform . win32 . WinDef . PVOID ; 
 import com . sun . jna . platform . win32 . WinDef . SCODE ; 
 + import com . sun . jna . platform . win32 . WinDef . SHORT ; 
 import com . sun . jna . platform . win32 . WinDef . ULONG ; 
 import com . sun . jna . platform . win32 . WinDef . ULONGLONG ; 
 import com . sun . jna . platform . win32 . WinDef . USHORT ; 
 @ @ - 768 , 31 + 769 , 18 @ @ public interface OaIdl { 
 Structure . ByReference { 
 } ; 
 
 - / / / C type : MEMBERID 
 public MEMBERID memid ; 
 - / * * 
 - * [ size _ is ] < br > 
 - * C type : SCODE * 
 - * / 
 public ScodeArg . ByReference lprgscode ; 
 - / * * 
 - * [ size _ is ] < br > 
 - * C type : ELEMDESC * 
 - * / 
 public ElemDescArg . ByReference lprgelemdescParam ; 
 - / / / C type : FUNCKIND 
 public FUNCKIND funckind ; 
 - / / / C type : INVOKEKIND 
 public INVOKEKIND invkind ; 
 - / / / C type : CALLCONV 
 public CALLCONV callconv ; 
 - public int cParams ; 
 - public int cParamsOpt ; 
 - public int oVft ; 
 - public int cScodes ; 
 - / / / C type : ELEMDESC 
 + public SHORT cParams ; 
 + public SHORT cParamsOpt ; 
 + public SHORT oVft ; 
 + public SHORT cScodes ; 
 public ELEMDESC elemdescFunc ; 
 - public int wFuncFlags ; 
 + public WORD wFuncFlags ; 
 
 public FUNCDESC ( ) { 
 } 
 @ @ - 801 , 8 + 789 , 8 @ @ public interface OaIdl { 
 super ( pointer ) ; 
 this . read ( ) ; 
 
 - if ( this . cParams > 1 ) { 
 - this . lprgelemdescParam . elemDescArg = new ELEMDESC [ this . cParams ] ; 
 + if ( this . cParams . shortValue ( ) > 1 ) { 
 + this . lprgelemdescParam . elemDescArg = new ELEMDESC [ this . cParams . shortValue ( ) ] ; 
 this . lprgelemdescParam . read ( ) ; 
 } 
 } 
 @ @ - 1351 , 7 + 1339 , 7 @ @ public interface OaIdl { 
 } 
 
 @ Override 
 - protected List getFieldOrder ( ) { 
 + protected List < String > getFieldOrder ( ) { 
 return Arrays . asList ( new String [ ] { " cBytes " , " varDefaultValue " } ) ; 
 } 
 } 
 diff - - git a / contrib / platform / test / com / sun / jna / platform / win32 / COM / TypeLibUtilTest . java b / contrib / platform / test / com / sun / jna / platform / win32 / COM / TypeLibUtilTest . java 
 index b5defd3 . . b592068 100644 
 - - - a / contrib / platform / test / com / sun / jna / platform / win32 / COM / TypeLibUtilTest . java 
 + + + b / contrib / platform / test / com / sun / jna / platform / win32 / COM / TypeLibUtilTest . java 
 @ @ - 38 , 7 + 38 , 7 @ @ public class TypeLibUtilTest extends TestCase { 
 public void testGetTypeInfoCount ( ) { 
 TypeLibUtil shellTypeLib = loadShellTypeLib ( ) ; 
 int typeInfoCount = shellTypeLib . getTypeInfoCount ( ) ; 
 - assertTrue ( " MS Shell should contain at 36 types . " , typeInfoCount = = 36 ) ; 
 + assertTrue ( " MS Shell should contain at least 36 types . " , typeInfoCount > = 36 ) ; 
 } 
 
 public void testGetTypeInfo ( ) { 
 @ @ - 70 , 4 + 70 , 32 @ @ public class TypeLibUtilTest extends TestCase { 
 typeInfoUtil . ReleaseTypeAttr ( typeAttr ) ; 
 } 
 } 
 + 
 + public void testBug ( ) { 
 + TypeLibUtil shellTypeLib = loadShellTypeLib ( ) ; 
 + int typeInfoCount = shellTypeLib . getTypeInfoCount ( ) ; 
 + 
 + ITypeInfo typeInfo = shellTypeLib . getTypeInfo ( 4 ) ; 
 + TypeInfoUtil typeInfoUtil = new TypeInfoUtil ( typeInfo ) ; 
 + 
 + TYPEATTR typeAttr = typeInfoUtil . getTypeAttr ( ) ; 
 + int cFuncs = typeAttr . cFuncs . intValue ( ) ; 
 + 
 + for ( int y = 13 ; y < cFuncs ; y + + ) { 
 + System . out . println ( " y : " + y ) ; 
 + / / Get the function description 
 + FUNCDESC funcDesc = typeInfoUtil . getFuncDesc ( y ) ; 
 + / / Get the member ID 
 + MEMBERID memberID = funcDesc . memid ; 
 + / / Get the name of the method 
 + TypeInfoDoc typeInfoDoc2 = typeInfoUtil . getDocumentation ( memberID ) ; 
 + String methodName = typeInfoDoc2 . getName ( ) ; 
 + 
 + assertNotNull ( methodName ) ; 
 + 
 + typeInfoUtil . ReleaseFuncDesc ( funcDesc ) ; 
 + } 
 + 
 + typeInfoUtil . ReleaseTypeAttr ( typeAttr ) ; 
 + } 
 } 
 diff - - git a / src / com / sun / jna / Structure . java b / src / com / sun / jna / Structure . java 
 index c1d5224 . . 9e5b56c 100644 
 - - - a / src / com / sun / jna / Structure . java 
 + + + b / src / com / sun / jna / Structure . java 
 @ @ - 534 , 8 + 534 , 6 @ @ public abstract class Structure { 
 try { 
 for ( Iterator i = fields ( ) . values ( ) . iterator ( ) ; i . hasNext ( ) ; ) { 
 StructField structField = ( StructField ) i . next ( ) ; 
 - System . out . println ( structField . name ) ; 
 - System . out . println ( structField . type . toString ( ) ) ; 
 readField ( structField ) ; 
 } 
 }

NEAREST DIFF:
diff - - git a / www / FrequentlyAskedQuestions . md b / www / FrequentlyAskedQuestions . md 
 index e0c7e80 . . 25f39d1 100644 
 - - - a / www / FrequentlyAskedQuestions . md 
 + + + b / www / FrequentlyAskedQuestions . md 
 @ @ - 46 , 13 + 46 , 15 @ @ Find your corresponding native declaration below : 
 / / Field is a pointer to an array of struct 
 typedef struct _ outerstruct5 { 
 simplestruct * ptr _ to _ array ; / / use Structure . ByReference , and use 
 - / / Structure . toArray ( ) to allocate the array 
 + / / Structure . toArray ( ) to allocate the array , 
 + / / then assign the first array element to the field 
 } outerstruct5 ; 
 
 / / struct pointers as return value or argument 
 - / / use Structure 
 - outerstruct * myfunc ( ) ; 
 - void myfunc ( outerstruct * data ) ; 
 + simplestruct * myfunc ( ) ; / / use Structure 
 + void myfunc ( simplestruct * data ) ; 
 + void myfunc ( simplestruct * data _ array , int count ) ; / / use Structure [ ] , and use Structure . toArray ( ) to generate the array 
 + void myfunc ( simplestruct * * data _ array , int count ) ; / / use Structure . ByReference [ ] 
 
 / / struct ( by value ) as return value or argument 
 / / use Structure . ByValue
