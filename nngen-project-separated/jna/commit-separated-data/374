BLEU SCORE: 0.018543295278285157

TEST MSG: Fixed 2 bugs in Win32WindowDemo . java
GENERATED MSG: move IUnknownTest to its rightful place ( w / rename )

TEST DIFF (one line): diff - - git a / contrib / native _ window _ msg / src / com / sun / jna / platform / win32 / Win32WindowDemo . java b / contrib / native _ window _ msg / src / com / sun / jna / platform / win32 / Win32WindowDemo . java <nl> index 155b908 . . 93350d2 100644 <nl> - - - a / contrib / native _ window _ msg / src / com / sun / jna / platform / win32 / Win32WindowDemo . java <nl> + + + b / contrib / native _ window _ msg / src / com / sun / jna / platform / win32 / Win32WindowDemo . java <nl> @ @ - 16 , 6 + 16 , 11 @ @ package com . sun . jna . platform . win32 ; <nl> import com . sun . jna . WString ; <nl> import com . sun . jna . platform . win32 . DBT ; <nl> import com . sun . jna . platform . win32 . DBT . DEV _ BROADCAST _ DEVICEINTERFACE ; <nl> + import com . sun . jna . platform . win32 . DBT . DEV _ BROADCAST _ HANDLE ; <nl> + import com . sun . jna . platform . win32 . DBT . DEV _ BROADCAST _ HDR ; <nl> + import com . sun . jna . platform . win32 . DBT . DEV _ BROADCAST _ OEM ; <nl> + import com . sun . jna . platform . win32 . DBT . DEV _ BROADCAST _ PORT ; <nl> + import com . sun . jna . platform . win32 . DBT . DEV _ BROADCAST _ VOLUME ; <nl> import com . sun . jna . platform . win32 . Kernel32 ; <nl> import com . sun . jna . platform . win32 . User32 ; <nl> import com . sun . jna . platform . win32 . WinDef . HMODULE ; <nl> @ @ - 59 , 7 + 64 , 9 @ @ public class Win32WindowDemo implements WindowProc { <nl> 	 	 	 	 	 	 User32 . WS _ EX _ TOPMOST , <nl> 	 	 	 	 	 	 windowClass , <nl> 	 	 	 	 	 	 " My hidden helper window , used only to catch the windows events " , <nl> - 	 	 	 	 	 	 0 , 0 , 0 , 0 , 0 , WinUser . HWND _ MESSAGE , null , hInst , null ) ; <nl> + 	 	 	 	 	 	 0 , 0 , 0 , 0 , 0 , <nl> + 	 	 	 	 	 	 null , / / WM _ DEVICECHANGE contradicts parent = WinUser . HWND _ MESSAGE <nl> + 	 	 	 	 	 	 null , hInst , null ) ; <nl> <nl> 	 	 getLastError ( ) ; <nl> 	 	 System . out . println ( " window sucessfully created ! window hwnd : " <nl> @ @ - 74 , 6 + 81 , 7 @ @ public class Win32WindowDemo implements WindowProc { <nl> <nl> 	 	 / * this filters for all usb device classes * / <nl> 	 	 DEV _ BROADCAST _ DEVICEINTERFACE notificationFilter = new DEV _ BROADCAST _ DEVICEINTERFACE ( ) ; <nl> + 	 	 notificationFilter . dbcc _ size = notificationFilter . size ( ) ; <nl> 	 	 notificationFilter . dbcc _ devicetype = DBT . DBT _ DEVTYP _ DEVICEINTERFACE ; <nl> 	 	 notificationFilter . dbcc _ classguid = DBT . GUID _ DEVINTERFACE _ USB _ DEVICE ; <nl> <nl> @ @ - 125 , 8 + 133 , 9 @ @ public class Win32WindowDemo implements WindowProc { <nl> 	 	 	 return new LRESULT ( 0 ) ; <nl> 	 	 } <nl> 	 	 case WinUser . WM _ DEVICECHANGE : { <nl> - 	 	 	 this . onDeviceChange ( wParam , lParam ) ; <nl> - 	 	 	 return new LRESULT ( 0 ) ; <nl> + 	 	 	 LRESULT lResult = this . onDeviceChange ( wParam , lParam ) ; <nl> + 	 	 	 return lResult ! = null ? lResult : <nl> + 	 	 	 	 User32 . INSTANCE . DefWindowProc ( hwnd , uMsg , wParam , lParam ) ; <nl> 	 	 } <nl> 	 	 default : <nl> 	 	 	 return User32 . INSTANCE . DefWindowProc ( hwnd , uMsg , wParam , lParam ) ; <nl> @ @ - 251 , 42 + 260 , 101 @ @ public class Win32WindowDemo implements WindowProc { <nl> 	 * the w param <nl> 	 * @ param lParam <nl> 	 * the l param <nl> + 	 * @ return the result . Null if the message is not processed . <nl> 	 * / <nl> - 	 protected void onDeviceChange ( WPARAM wParam , LPARAM lParam ) { <nl> - 	 	 / / <nl> - 	 	 / / This is the actual message from the interface via Windows messaging . <nl> - 	 	 / / This code includes some additional decoding for this particular <nl> - 	 	 / / device type <nl> - 	 	 / / and some common validation checks . <nl> - 	 	 / / <nl> - 	 	 / / Note that not all devices utilize these optional parameters in the <nl> - 	 	 / / same <nl> - 	 	 / / way . Refer to the extended information for your particular device <nl> - 	 	 / / type <nl> - 	 	 / / specified by your GUID . <nl> - 	 	 / / <nl> - 	 	 DEV _ BROADCAST _ DEVICEINTERFACE bdif = new DEV _ BROADCAST _ DEVICEINTERFACE ( <nl> - 	 	 	 	 lParam . longValue ( ) ) ; <nl> - 	 	 System . out . println ( " dbcc _ devicetype : " + bdif . dbcc _ devicetype ) ; <nl> - 	 	 System . out . println ( " dbcc _ name : " + bdif . getDbcc _ name ( ) ) ; <nl> - 	 	 System . out . println ( " dbcc _ classguid : " <nl> - 	 	 	 	 + bdif . dbcc _ classguid . toGuidString ( ) ) ; <nl> - <nl> - 	 	 / / Output some messages to the window . <nl> + 	 protected LRESULT onDeviceChange ( WPARAM wParam , LPARAM lParam ) { <nl> 	 	 switch ( wParam . intValue ( ) ) { <nl> - 	 	 case DBT . DBT _ DEVICEARRIVAL : <nl> - 	 	 	 System . out . println ( " Message DBT _ DEVICEARRIVAL " ) ; <nl> + 	 	 case DBT . DBT _ DEVICEARRIVAL : { <nl> + 	 	 	 return onDeviceChangeArrival ( lParam ) ; <nl> + 	 	 } <nl> + 	 	 case DBT . DBT _ DEVICEREMOVECOMPLETE : { <nl> + 	 	 	 return onDeviceChangeRemoveComplete ( lParam ) ; <nl> + 	 	 } <nl> + 	 	 case DBT . DBT _ DEVNODES _ CHANGED : { <nl> + 	 	 	 / / lParam is 0 for this wParam <nl> + 	 	 	 return onDeviceChangeNodesChanged ( ) ; <nl> + 	 	 } <nl> + 	 	 default : <nl> + 	 	 	 System . out <nl> + 	 	 	 	 	 . println ( " Message WM _ DEVICECHANGE message received , value unhandled . " ) ; <nl> + 	 	 } <nl> + 	 	 return null ; <nl> + 	 } <nl> + 	 <nl> + 	 protected LRESULT onDeviceChangeArrivalOrRemoveComplete ( LPARAM lParam , String action ) { <nl> + 	 	 DEV _ BROADCAST _ HDR bhdr = new DEV _ BROADCAST _ HDR ( lParam . longValue ( ) ) ; <nl> + 	 	 switch ( bhdr . dbch _ devicetype ) { <nl> + 	 	 case DBT . DBT _ DEVTYP _ DEVICEINTERFACE : { <nl> + 	 	 	 / / see http : / / msdn . microsoft . com / en - us / library / windows / desktop / aa363244 . aspx <nl> + 	 	 	 DEV _ BROADCAST _ DEVICEINTERFACE bdif = new DEV _ BROADCAST _ DEVICEINTERFACE ( bhdr . getPointer ( ) ) ; <nl> + 	 	 	 System . out . println ( " BROADCAST _ DEVICEINTERFACE : " + action ) ; <nl> + 	 	 	 System . out . println ( " dbcc _ devicetype : " + bdif . dbcc _ devicetype ) ; <nl> + 	 	 	 System . out . println ( " dbcc _ name : " + bdif . getDbcc _ name ( ) ) ; <nl> + 	 	 	 System . out . println ( " dbcc _ classguid : " <nl> + 	 	 	 	 	 + bdif . dbcc _ classguid . toGuidString ( ) ) ; <nl> + 	 	 	 break ; <nl> + 	 	 } <nl> + 	 	 case DBT . DBT _ DEVTYP _ HANDLE : { <nl> + 	 	 	 / / see http : / / msdn . microsoft . com / en - us / library / windows / desktop / aa363245 . aspx <nl> + 	 	 	 DEV _ BROADCAST _ HANDLE bhd = new DEV _ BROADCAST _ HANDLE ( bhdr . getPointer ( ) ) ; <nl> + 	 	 	 System . out . println ( " BROADCAST _ HANDLE : " + action ) ; <nl> + 	 	 	 break ; <nl> + 	 	 } <nl> + 	 	 case DBT . DBT _ DEVTYP _ OEM : { <nl> + 	 	 	 / / see http : / / msdn . microsoft . com / en - us / library / windows / desktop / aa363247 . aspx <nl> + 	 	 	 DEV _ BROADCAST _ OEM boem = new DEV _ BROADCAST _ OEM ( bhdr . getPointer ( ) ) ; <nl> + 	 	 	 System . out . println ( " BROADCAST _ OEM : " + action ) ; <nl> 	 	 	 break ; <nl> - 	 	 case DBT . DBT _ DEVICEREMOVECOMPLETE : <nl> - 	 	 	 System . out . println ( " Message DBT _ DEVICEREMOVECOMPLETE " ) ; <nl> + 	 	 } <nl> + 	 	 case DBT . DBT _ DEVTYP _ PORT : { <nl> + 	 	 	 / / see http : / / msdn . microsoft . com / en - us / library / windows / desktop / aa363248 . aspx <nl> + 	 	 	 DEV _ BROADCAST _ PORT bpt = new DEV _ BROADCAST _ PORT ( bhdr . getPointer ( ) ) ; <nl> + 	 	 	 System . out . println ( " BROADCAST _ PORT : " + action ) ; <nl> 	 	 	 break ; <nl> - 	 	 case DBT . DBT _ DEVNODES _ CHANGED : <nl> - 	 	 	 System . out . println ( " Message DBT _ DEVNODES _ CHANGED " ) ; <nl> + 	 	 } <nl> + 	 	 case DBT . DBT _ DEVTYP _ VOLUME : { <nl> + 	 	 	 / / see http : / / msdn . microsoft . com / en - us / library / windows / desktop / aa363249 . aspx <nl> + 	 	 	 DEV _ BROADCAST _ VOLUME bvl = new DEV _ BROADCAST _ VOLUME ( bhdr . getPointer ( ) ) ; <nl> + 	 	 	 int logicalDriveAffected = bvl . dbcv _ unitmask ; <nl> + 	 	 	 short flag = bvl . dbcv _ flags ; <nl> + 	 	 	 boolean isMediaNotPhysical = 0 ! = ( flag & 1 / * DBT . DBTF _ MEDIA * / ) ; <nl> + 	 	 	 boolean isNet = 0 ! = ( flag & 2 / * DBT . DBTF _ NET * / ) ; <nl> + 	 	 	 System . out . println ( action ) ; <nl> + 	 	 	 int driveLetterIndex = 0 ; <nl> + 	 	 	 while ( logicalDriveAffected ! = 0 ) { <nl> + 	 	 	 	 if ( 0 ! = ( logicalDriveAffected & 1 ) ) { <nl> + 	 	 	 	 	 System . out . println ( " Logical Drive Letter : " + <nl> + 	 	 	 	 	 	 ( ( char ) ( ' A ' + driveLetterIndex ) ) ) ; <nl> + 	 	 	 	 } <nl> + 	 	 	 	 logicalDriveAffected > > > = 1 ; <nl> + 	 	 	 	 driveLetterIndex + + ; <nl> + 	 	 	 } <nl> + 	 	 	 System . out . println ( " isMediaNotPhysical : " + isMediaNotPhysical ) ; <nl> + 	 	 	 System . out . println ( " isNet : " + isNet ) ; <nl> 	 	 	 break ; <nl> + 	 	 } <nl> 	 	 default : <nl> - 	 	 	 System . out <nl> - 	 	 	 	 	 . println ( " Message WM _ DEVICECHANGE message received , value unhandled . " ) ; <nl> + 	 	 	 return null ; <nl> 	 	 } <nl> + 	 	 / / return TRUE means processed message for this wParam . <nl> + 	 	 / / see http : / / msdn . microsoft . com / en - us / library / windows / desktop / aa363205 . aspx <nl> + 	 	 / / see http : / / msdn . microsoft . com / en - us / library / windows / desktop / aa363208 . aspx <nl> + 	 	 return new LRESULT ( 1 ) ; <nl> + 	 } <nl> + <nl> + 	 protected LRESULT onDeviceChangeArrival ( LPARAM lParam ) { <nl> + 	 	 return onDeviceChangeArrivalOrRemoveComplete ( lParam , " Arrival " ) ; <nl> + 	 } <nl> + <nl> + 	 protected LRESULT onDeviceChangeRemoveComplete ( LPARAM lParam ) { <nl> + 	 	 return onDeviceChangeArrivalOrRemoveComplete ( lParam , " Remove Complete " ) ; <nl> + 	 } <nl> + <nl> + 	 protected LRESULT onDeviceChangeNodesChanged ( ) { <nl> + 	 	 System . out . println ( " Message DBT _ DEVNODES _ CHANGED " ) ; <nl> + 	 	 / / return TRUE means processed message for this wParam . <nl> + 	 	 / / see http : / / msdn . microsoft . com / en - us / library / windows / desktop / aa363211 . aspx <nl> + 	 	 return new LRESULT ( 1 ) ; <nl> 	 } <nl> <nl> 	 / * *
NEAREST DIFF (one line): diff - - git a / ChangeLog b / ChangeLog <nl> index bf2c179 . . 1b09d91 100644 <nl> - - - a / ChangeLog <nl> + + + b / ChangeLog <nl> @ @ - 1 , 5 + 1 , 10 @ @ <nl> 2013 - 02 - 07 Anthony Green < green @ moxielogic . com > <nl> <nl> + 	 * src / sparc / v8 . S ( ffi _ call _ v8 ) : Fix typo from last patch <nl> + 	 ( effectively hiding ffi _ call _ v8 ) . <nl> + <nl> + 2013 - 02 - 07 Anthony Green < green @ moxielogic . com > <nl> + <nl> 	 * configure . ac : Update bug reporting address . <nl> 	 * configure . in : Rebuild . <nl> <nl> diff - - git a / configure b / configure <nl> index a94399a . . 2908c45 100755 <nl> - - - a / configure <nl> + + + b / configure <nl> @ @ - 1 , 6 + 1 , 6 @ @ <nl> # ! / bin / sh <nl> # Guess values for system - dependent variables and create Makefiles . <nl> - # Generated by GNU Autoconf 2 . 69 for libffi 3 . 0 . 12 - rc2 . <nl> + # Generated by GNU Autoconf 2 . 69 for libffi 3 . 0 . 12 - rc3 . <nl> # <nl> # Report bugs to < http : / / github . com / atgreen / libffi / issues > . <nl> # <nl> @ @ - 590 , 8 + 590 , 8 @ @ MAKEFLAGS = <nl> # Identity of this package . <nl> PACKAGE _ NAME = ' libffi ' <nl> PACKAGE _ TARNAME = ' libffi ' <nl> - PACKAGE _ VERSION = ' 3 . 0 . 12 - rc2 ' <nl> - PACKAGE _ STRING = ' libffi 3 . 0 . 12 - rc2 ' <nl> + PACKAGE _ VERSION = ' 3 . 0 . 12 - rc3 ' <nl> + PACKAGE _ STRING = ' libffi 3 . 0 . 12 - rc3 ' <nl> PACKAGE _ BUGREPORT = ' http : / / github . com / atgreen / libffi / issues ' <nl> PACKAGE _ URL = ' ' <nl> <nl> @ @ - 1405 , 7 + 1405 , 7 @ @ if test " $ ac _ init _ help " = " long " ; then <nl> # Omit some internal or obsolete options to make the list less imposing . <nl> # This message is too long to be a string in the A / UX 3 . 1 sh . <nl> cat < < _ ACEOF <nl> - \ ` configure ' configures libffi 3 . 0 . 12 - rc2 to adapt to many kinds of systems . <nl> + \ ` configure ' configures libffi 3 . 0 . 12 - rc3 to adapt to many kinds of systems . <nl> <nl> Usage : $ 0 [ OPTION ] . . . [ VAR = VALUE ] . . . <nl> <nl> @ @ - 1476 , 7 + 1476 , 7 @ @ fi <nl> <nl> if test - n " $ ac _ init _ help " ; then <nl> case $ ac _ init _ help in <nl> - short | recursive ) echo " Configuration of libffi 3 . 0 . 12 - rc2 : " ; ; <nl> + short | recursive ) echo " Configuration of libffi 3 . 0 . 12 - rc3 : " ; ; <nl> esac <nl> cat < < \ _ ACEOF <nl> <nl> @ @ - 1596 , 7 + 1596 , 7 @ @ fi <nl> test - n " $ ac _ init _ help " & & exit $ ac _ status <nl> if $ ac _ init _ version ; then <nl> cat < < \ _ ACEOF <nl> - libffi configure 3 . 0 . 12 - rc2 <nl> + libffi configure 3 . 0 . 12 - rc3 <nl> generated by GNU Autoconf 2 . 69 <nl> <nl> Copyright ( C ) 2012 Free Software Foundation , Inc . <nl> @ @ - 2202 , 7 + 2202 , 7 @ @ cat > config . log < < _ ACEOF <nl> This file contains any messages produced by compilers while <nl> running configure , to aid debugging if configure makes a mistake . <nl> <nl> - It was created by libffi $ as _ me 3 . 0 . 12 - rc2 , which was <nl> + It was created by libffi $ as _ me 3 . 0 . 12 - rc3 , which was <nl> generated by GNU Autoconf 2 . 69 . Invocation command line was <nl> <nl> $ $ 0 $ @ <nl> @ @ - 3245 , 7 + 3245 , 7 @ @ fi <nl> <nl> # Define the identity of the package . <nl> PACKAGE = ' libffi ' <nl> - VERSION = ' 3 . 0 . 12 - rc2 ' <nl> + VERSION = ' 3 . 0 . 12 - rc3 ' <nl> <nl> <nl> cat > > confdefs . h < < _ ACEOF <nl> @ @ - 15527 , 7 + 15527 , 7 @ @ cat > > $ CONFIG _ STATUS < < \ _ ACEOF | | ac _ write _ fail = 1 <nl> # report actual input values of CONFIG _ FILES etc . instead of their <nl> # values after options handling . <nl> ac _ log = " <nl> - This file was extended by libffi $ as _ me 3 . 0 . 12 - rc2 , which was <nl> + This file was extended by libffi $ as _ me 3 . 0 . 12 - rc3 , which was <nl> generated by GNU Autoconf 2 . 69 . Invocation command line was <nl> <nl> CONFIG _ FILES = $ CONFIG _ FILES <nl> @ @ - 15597 , 7 + 15597 , 7 @ @ _ ACEOF <nl> cat > > $ CONFIG _ STATUS < < _ ACEOF | | ac _ write _ fail = 1 <nl> ac _ cs _ config = " ` $ as _ echo " $ ac _ configure _ args " | sed ' s / ^ / / ; s / [ \ \ " " \ ` \ $ ] / \ \ \ \ & / g ' ` " <nl> ac _ cs _ version = " \ \ <nl> - libffi config . status 3 . 0 . 12 - rc2 <nl> + libffi config . status 3 . 0 . 12 - rc3 <nl> configured by $ 0 , generated by GNU Autoconf 2 . 69 , <nl> with options \ \ " \ $ ac _ cs _ config \ \ " <nl> <nl> diff - - git a / configure . ac b / configure . ac <nl> index acf13b2 . . 1d1eed2 100644 <nl> - - - a / configure . ac <nl> + + + b / configure . ac <nl> @ @ - 2 , 7 + 2 , 7 @ @ dnl Process this with autoconf to create configure <nl> <nl> AC _ PREREQ ( 2 . 68 ) <nl> <nl> - AC _ INIT ( [ libffi ] , [ 3 . 0 . 12 - rc2 ] , [ http : / / github . com / atgreen / libffi / issues ] ) <nl> + AC _ INIT ( [ libffi ] , [ 3 . 0 . 12 - rc3 ] , [ http : / / github . com / atgreen / libffi / issues ] ) <nl> AC _ CONFIG _ HEADERS ( [ fficonfig . h ] ) <nl> <nl> AC _ CANONICAL _ SYSTEM <nl> diff - - git a / doc / stamp - vti b / doc / stamp - vti <nl> index a187361 . . 38f07d7 100644 <nl> - - - a / doc / stamp - vti <nl> + + + b / doc / stamp - vti <nl> @ @ - 1 , 4 + 1 , 4 @ @ <nl> @ set UPDATED 6 February 2013 <nl> @ set UPDATED - MONTH February 2013 <nl> - @ set EDITION 3 . 0 . 12 - rc1 <nl> - @ set VERSION 3 . 0 . 12 - rc1 <nl> + @ set EDITION 3 . 0 . 12 - rc2 <nl> + @ set VERSION 3 . 0 . 12 - rc2 <nl> diff - - git a / doc / version . texi b / doc / version . texi <nl> index a187361 . . 38f07d7 100644 <nl> - - - a / doc / version . texi <nl> + + + b / doc / version . texi <nl> @ @ - 1 , 4 + 1 , 4 @ @ <nl> @ set UPDATED 6 February 2013 <nl> @ set UPDATED - MONTH February 2013 <nl> - @ set EDITION 3 . 0 . 12 - rc1 <nl> - @ set VERSION 3 . 0 . 12 - rc1 <nl> + @ set EDITION 3 . 0 . 12 - rc2 <nl> + @ set VERSION 3 . 0 . 12 - rc2 <nl> diff - - git a / src / sparc / v8 . S b / src / sparc / v8 . S <nl> index 027c363 . . 4faf3bd 100644 <nl> - - - a / src / sparc / v8 . S <nl> + + + b / src / sparc / v8 . S <nl> @ @ - 33 , 7 + 33 , 7 @ @ <nl> # define ARGS ( 64 + 4 ) 	 	 / * Offset of register area in frame * / <nl> <nl> # ifndef _ _ GNUC _ _ 	 <nl> - . text <nl> + 	 . text <nl> . align 8 <nl> . globl ffi _ flush _ icache <nl> . globl _ ffi _ flush _ icache <nl> @ @ - 54 , 12 + 54 , 12 @ @ _ ffi _ flush _ icache : <nl> 	 nop <nl> . ffi _ flush _ icache _ end : <nl> 	 . size 	 ffi _ flush _ icache , . ffi _ flush _ icache _ end - ffi _ flush _ icache <nl> + # endif <nl> <nl> 	 . text <nl> . align 8 <nl> . globl ffi _ call _ v8 <nl> . globl _ ffi _ call _ v8 <nl> - # endif <nl> 	 <nl> ffi _ call _ v8 : <nl> _ ffi _ call _ v8 :

TEST DIFF:
diff - - git a / contrib / native _ window _ msg / src / com / sun / jna / platform / win32 / Win32WindowDemo . java b / contrib / native _ window _ msg / src / com / sun / jna / platform / win32 / Win32WindowDemo . java 
 index 155b908 . . 93350d2 100644 
 - - - a / contrib / native _ window _ msg / src / com / sun / jna / platform / win32 / Win32WindowDemo . java 
 + + + b / contrib / native _ window _ msg / src / com / sun / jna / platform / win32 / Win32WindowDemo . java 
 @ @ - 16 , 6 + 16 , 11 @ @ package com . sun . jna . platform . win32 ; 
 import com . sun . jna . WString ; 
 import com . sun . jna . platform . win32 . DBT ; 
 import com . sun . jna . platform . win32 . DBT . DEV _ BROADCAST _ DEVICEINTERFACE ; 
 + import com . sun . jna . platform . win32 . DBT . DEV _ BROADCAST _ HANDLE ; 
 + import com . sun . jna . platform . win32 . DBT . DEV _ BROADCAST _ HDR ; 
 + import com . sun . jna . platform . win32 . DBT . DEV _ BROADCAST _ OEM ; 
 + import com . sun . jna . platform . win32 . DBT . DEV _ BROADCAST _ PORT ; 
 + import com . sun . jna . platform . win32 . DBT . DEV _ BROADCAST _ VOLUME ; 
 import com . sun . jna . platform . win32 . Kernel32 ; 
 import com . sun . jna . platform . win32 . User32 ; 
 import com . sun . jna . platform . win32 . WinDef . HMODULE ; 
 @ @ - 59 , 7 + 64 , 9 @ @ public class Win32WindowDemo implements WindowProc { 
 	 	 	 	 	 	 User32 . WS _ EX _ TOPMOST , 
 	 	 	 	 	 	 windowClass , 
 	 	 	 	 	 	 " My hidden helper window , used only to catch the windows events " , 
 - 	 	 	 	 	 	 0 , 0 , 0 , 0 , 0 , WinUser . HWND _ MESSAGE , null , hInst , null ) ; 
 + 	 	 	 	 	 	 0 , 0 , 0 , 0 , 0 , 
 + 	 	 	 	 	 	 null , / / WM _ DEVICECHANGE contradicts parent = WinUser . HWND _ MESSAGE 
 + 	 	 	 	 	 	 null , hInst , null ) ; 
 
 	 	 getLastError ( ) ; 
 	 	 System . out . println ( " window sucessfully created ! window hwnd : " 
 @ @ - 74 , 6 + 81 , 7 @ @ public class Win32WindowDemo implements WindowProc { 
 
 	 	 / * this filters for all usb device classes * / 
 	 	 DEV _ BROADCAST _ DEVICEINTERFACE notificationFilter = new DEV _ BROADCAST _ DEVICEINTERFACE ( ) ; 
 + 	 	 notificationFilter . dbcc _ size = notificationFilter . size ( ) ; 
 	 	 notificationFilter . dbcc _ devicetype = DBT . DBT _ DEVTYP _ DEVICEINTERFACE ; 
 	 	 notificationFilter . dbcc _ classguid = DBT . GUID _ DEVINTERFACE _ USB _ DEVICE ; 
 
 @ @ - 125 , 8 + 133 , 9 @ @ public class Win32WindowDemo implements WindowProc { 
 	 	 	 return new LRESULT ( 0 ) ; 
 	 	 } 
 	 	 case WinUser . WM _ DEVICECHANGE : { 
 - 	 	 	 this . onDeviceChange ( wParam , lParam ) ; 
 - 	 	 	 return new LRESULT ( 0 ) ; 
 + 	 	 	 LRESULT lResult = this . onDeviceChange ( wParam , lParam ) ; 
 + 	 	 	 return lResult ! = null ? lResult : 
 + 	 	 	 	 User32 . INSTANCE . DefWindowProc ( hwnd , uMsg , wParam , lParam ) ; 
 	 	 } 
 	 	 default : 
 	 	 	 return User32 . INSTANCE . DefWindowProc ( hwnd , uMsg , wParam , lParam ) ; 
 @ @ - 251 , 42 + 260 , 101 @ @ public class Win32WindowDemo implements WindowProc { 
 	 * the w param 
 	 * @ param lParam 
 	 * the l param 
 + 	 * @ return the result . Null if the message is not processed . 
 	 * / 
 - 	 protected void onDeviceChange ( WPARAM wParam , LPARAM lParam ) { 
 - 	 	 / / 
 - 	 	 / / This is the actual message from the interface via Windows messaging . 
 - 	 	 / / This code includes some additional decoding for this particular 
 - 	 	 / / device type 
 - 	 	 / / and some common validation checks . 
 - 	 	 / / 
 - 	 	 / / Note that not all devices utilize these optional parameters in the 
 - 	 	 / / same 
 - 	 	 / / way . Refer to the extended information for your particular device 
 - 	 	 / / type 
 - 	 	 / / specified by your GUID . 
 - 	 	 / / 
 - 	 	 DEV _ BROADCAST _ DEVICEINTERFACE bdif = new DEV _ BROADCAST _ DEVICEINTERFACE ( 
 - 	 	 	 	 lParam . longValue ( ) ) ; 
 - 	 	 System . out . println ( " dbcc _ devicetype : " + bdif . dbcc _ devicetype ) ; 
 - 	 	 System . out . println ( " dbcc _ name : " + bdif . getDbcc _ name ( ) ) ; 
 - 	 	 System . out . println ( " dbcc _ classguid : " 
 - 	 	 	 	 + bdif . dbcc _ classguid . toGuidString ( ) ) ; 
 - 
 - 	 	 / / Output some messages to the window . 
 + 	 protected LRESULT onDeviceChange ( WPARAM wParam , LPARAM lParam ) { 
 	 	 switch ( wParam . intValue ( ) ) { 
 - 	 	 case DBT . DBT _ DEVICEARRIVAL : 
 - 	 	 	 System . out . println ( " Message DBT _ DEVICEARRIVAL " ) ; 
 + 	 	 case DBT . DBT _ DEVICEARRIVAL : { 
 + 	 	 	 return onDeviceChangeArrival ( lParam ) ; 
 + 	 	 } 
 + 	 	 case DBT . DBT _ DEVICEREMOVECOMPLETE : { 
 + 	 	 	 return onDeviceChangeRemoveComplete ( lParam ) ; 
 + 	 	 } 
 + 	 	 case DBT . DBT _ DEVNODES _ CHANGED : { 
 + 	 	 	 / / lParam is 0 for this wParam 
 + 	 	 	 return onDeviceChangeNodesChanged ( ) ; 
 + 	 	 } 
 + 	 	 default : 
 + 	 	 	 System . out 
 + 	 	 	 	 	 . println ( " Message WM _ DEVICECHANGE message received , value unhandled . " ) ; 
 + 	 	 } 
 + 	 	 return null ; 
 + 	 } 
 + 	 
 + 	 protected LRESULT onDeviceChangeArrivalOrRemoveComplete ( LPARAM lParam , String action ) { 
 + 	 	 DEV _ BROADCAST _ HDR bhdr = new DEV _ BROADCAST _ HDR ( lParam . longValue ( ) ) ; 
 + 	 	 switch ( bhdr . dbch _ devicetype ) { 
 + 	 	 case DBT . DBT _ DEVTYP _ DEVICEINTERFACE : { 
 + 	 	 	 / / see http : / / msdn . microsoft . com / en - us / library / windows / desktop / aa363244 . aspx 
 + 	 	 	 DEV _ BROADCAST _ DEVICEINTERFACE bdif = new DEV _ BROADCAST _ DEVICEINTERFACE ( bhdr . getPointer ( ) ) ; 
 + 	 	 	 System . out . println ( " BROADCAST _ DEVICEINTERFACE : " + action ) ; 
 + 	 	 	 System . out . println ( " dbcc _ devicetype : " + bdif . dbcc _ devicetype ) ; 
 + 	 	 	 System . out . println ( " dbcc _ name : " + bdif . getDbcc _ name ( ) ) ; 
 + 	 	 	 System . out . println ( " dbcc _ classguid : " 
 + 	 	 	 	 	 + bdif . dbcc _ classguid . toGuidString ( ) ) ; 
 + 	 	 	 break ; 
 + 	 	 } 
 + 	 	 case DBT . DBT _ DEVTYP _ HANDLE : { 
 + 	 	 	 / / see http : / / msdn . microsoft . com / en - us / library / windows / desktop / aa363245 . aspx 
 + 	 	 	 DEV _ BROADCAST _ HANDLE bhd = new DEV _ BROADCAST _ HANDLE ( bhdr . getPointer ( ) ) ; 
 + 	 	 	 System . out . println ( " BROADCAST _ HANDLE : " + action ) ; 
 + 	 	 	 break ; 
 + 	 	 } 
 + 	 	 case DBT . DBT _ DEVTYP _ OEM : { 
 + 	 	 	 / / see http : / / msdn . microsoft . com / en - us / library / windows / desktop / aa363247 . aspx 
 + 	 	 	 DEV _ BROADCAST _ OEM boem = new DEV _ BROADCAST _ OEM ( bhdr . getPointer ( ) ) ; 
 + 	 	 	 System . out . println ( " BROADCAST _ OEM : " + action ) ; 
 	 	 	 break ; 
 - 	 	 case DBT . DBT _ DEVICEREMOVECOMPLETE : 
 - 	 	 	 System . out . println ( " Message DBT _ DEVICEREMOVECOMPLETE " ) ; 
 + 	 	 } 
 + 	 	 case DBT . DBT _ DEVTYP _ PORT : { 
 + 	 	 	 / / see http : / / msdn . microsoft . com / en - us / library / windows / desktop / aa363248 . aspx 
 + 	 	 	 DEV _ BROADCAST _ PORT bpt = new DEV _ BROADCAST _ PORT ( bhdr . getPointer ( ) ) ; 
 + 	 	 	 System . out . println ( " BROADCAST _ PORT : " + action ) ; 
 	 	 	 break ; 
 - 	 	 case DBT . DBT _ DEVNODES _ CHANGED : 
 - 	 	 	 System . out . println ( " Message DBT _ DEVNODES _ CHANGED " ) ; 
 + 	 	 } 
 + 	 	 case DBT . DBT _ DEVTYP _ VOLUME : { 
 + 	 	 	 / / see http : / / msdn . microsoft . com / en - us / library / windows / desktop / aa363249 . aspx 
 + 	 	 	 DEV _ BROADCAST _ VOLUME bvl = new DEV _ BROADCAST _ VOLUME ( bhdr . getPointer ( ) ) ; 
 + 	 	 	 int logicalDriveAffected = bvl . dbcv _ unitmask ; 
 + 	 	 	 short flag = bvl . dbcv _ flags ; 
 + 	 	 	 boolean isMediaNotPhysical = 0 ! = ( flag & 1 / * DBT . DBTF _ MEDIA * / ) ; 
 + 	 	 	 boolean isNet = 0 ! = ( flag & 2 / * DBT . DBTF _ NET * / ) ; 
 + 	 	 	 System . out . println ( action ) ; 
 + 	 	 	 int driveLetterIndex = 0 ; 
 + 	 	 	 while ( logicalDriveAffected ! = 0 ) { 
 + 	 	 	 	 if ( 0 ! = ( logicalDriveAffected & 1 ) ) { 
 + 	 	 	 	 	 System . out . println ( " Logical Drive Letter : " + 
 + 	 	 	 	 	 	 ( ( char ) ( ' A ' + driveLetterIndex ) ) ) ; 
 + 	 	 	 	 } 
 + 	 	 	 	 logicalDriveAffected > > > = 1 ; 
 + 	 	 	 	 driveLetterIndex + + ; 
 + 	 	 	 } 
 + 	 	 	 System . out . println ( " isMediaNotPhysical : " + isMediaNotPhysical ) ; 
 + 	 	 	 System . out . println ( " isNet : " + isNet ) ; 
 	 	 	 break ; 
 + 	 	 } 
 	 	 default : 
 - 	 	 	 System . out 
 - 	 	 	 	 	 . println ( " Message WM _ DEVICECHANGE message received , value unhandled . " ) ; 
 + 	 	 	 return null ; 
 	 	 } 
 + 	 	 / / return TRUE means processed message for this wParam . 
 + 	 	 / / see http : / / msdn . microsoft . com / en - us / library / windows / desktop / aa363205 . aspx 
 + 	 	 / / see http : / / msdn . microsoft . com / en - us / library / windows / desktop / aa363208 . aspx 
 + 	 	 return new LRESULT ( 1 ) ; 
 + 	 } 
 + 
 + 	 protected LRESULT onDeviceChangeArrival ( LPARAM lParam ) { 
 + 	 	 return onDeviceChangeArrivalOrRemoveComplete ( lParam , " Arrival " ) ; 
 + 	 } 
 + 
 + 	 protected LRESULT onDeviceChangeRemoveComplete ( LPARAM lParam ) { 
 + 	 	 return onDeviceChangeArrivalOrRemoveComplete ( lParam , " Remove Complete " ) ; 
 + 	 } 
 + 
 + 	 protected LRESULT onDeviceChangeNodesChanged ( ) { 
 + 	 	 System . out . println ( " Message DBT _ DEVNODES _ CHANGED " ) ; 
 + 	 	 / / return TRUE means processed message for this wParam . 
 + 	 	 / / see http : / / msdn . microsoft . com / en - us / library / windows / desktop / aa363211 . aspx 
 + 	 	 return new LRESULT ( 1 ) ; 
 	 } 
 
 	 / * *

NEAREST DIFF:
diff - - git a / ChangeLog b / ChangeLog 
 index bf2c179 . . 1b09d91 100644 
 - - - a / ChangeLog 
 + + + b / ChangeLog 
 @ @ - 1 , 5 + 1 , 10 @ @ 
 2013 - 02 - 07 Anthony Green < green @ moxielogic . com > 
 
 + 	 * src / sparc / v8 . S ( ffi _ call _ v8 ) : Fix typo from last patch 
 + 	 ( effectively hiding ffi _ call _ v8 ) . 
 + 
 + 2013 - 02 - 07 Anthony Green < green @ moxielogic . com > 
 + 
 	 * configure . ac : Update bug reporting address . 
 	 * configure . in : Rebuild . 
 
 diff - - git a / configure b / configure 
 index a94399a . . 2908c45 100755 
 - - - a / configure 
 + + + b / configure 
 @ @ - 1 , 6 + 1 , 6 @ @ 
 # ! / bin / sh 
 # Guess values for system - dependent variables and create Makefiles . 
 - # Generated by GNU Autoconf 2 . 69 for libffi 3 . 0 . 12 - rc2 . 
 + # Generated by GNU Autoconf 2 . 69 for libffi 3 . 0 . 12 - rc3 . 
 # 
 # Report bugs to < http : / / github . com / atgreen / libffi / issues > . 
 # 
 @ @ - 590 , 8 + 590 , 8 @ @ MAKEFLAGS = 
 # Identity of this package . 
 PACKAGE _ NAME = ' libffi ' 
 PACKAGE _ TARNAME = ' libffi ' 
 - PACKAGE _ VERSION = ' 3 . 0 . 12 - rc2 ' 
 - PACKAGE _ STRING = ' libffi 3 . 0 . 12 - rc2 ' 
 + PACKAGE _ VERSION = ' 3 . 0 . 12 - rc3 ' 
 + PACKAGE _ STRING = ' libffi 3 . 0 . 12 - rc3 ' 
 PACKAGE _ BUGREPORT = ' http : / / github . com / atgreen / libffi / issues ' 
 PACKAGE _ URL = ' ' 
 
 @ @ - 1405 , 7 + 1405 , 7 @ @ if test " $ ac _ init _ help " = " long " ; then 
 # Omit some internal or obsolete options to make the list less imposing . 
 # This message is too long to be a string in the A / UX 3 . 1 sh . 
 cat < < _ ACEOF 
 - \ ` configure ' configures libffi 3 . 0 . 12 - rc2 to adapt to many kinds of systems . 
 + \ ` configure ' configures libffi 3 . 0 . 12 - rc3 to adapt to many kinds of systems . 
 
 Usage : $ 0 [ OPTION ] . . . [ VAR = VALUE ] . . . 
 
 @ @ - 1476 , 7 + 1476 , 7 @ @ fi 
 
 if test - n " $ ac _ init _ help " ; then 
 case $ ac _ init _ help in 
 - short | recursive ) echo " Configuration of libffi 3 . 0 . 12 - rc2 : " ; ; 
 + short | recursive ) echo " Configuration of libffi 3 . 0 . 12 - rc3 : " ; ; 
 esac 
 cat < < \ _ ACEOF 
 
 @ @ - 1596 , 7 + 1596 , 7 @ @ fi 
 test - n " $ ac _ init _ help " & & exit $ ac _ status 
 if $ ac _ init _ version ; then 
 cat < < \ _ ACEOF 
 - libffi configure 3 . 0 . 12 - rc2 
 + libffi configure 3 . 0 . 12 - rc3 
 generated by GNU Autoconf 2 . 69 
 
 Copyright ( C ) 2012 Free Software Foundation , Inc . 
 @ @ - 2202 , 7 + 2202 , 7 @ @ cat > config . log < < _ ACEOF 
 This file contains any messages produced by compilers while 
 running configure , to aid debugging if configure makes a mistake . 
 
 - It was created by libffi $ as _ me 3 . 0 . 12 - rc2 , which was 
 + It was created by libffi $ as _ me 3 . 0 . 12 - rc3 , which was 
 generated by GNU Autoconf 2 . 69 . Invocation command line was 
 
 $ $ 0 $ @ 
 @ @ - 3245 , 7 + 3245 , 7 @ @ fi 
 
 # Define the identity of the package . 
 PACKAGE = ' libffi ' 
 - VERSION = ' 3 . 0 . 12 - rc2 ' 
 + VERSION = ' 3 . 0 . 12 - rc3 ' 
 
 
 cat > > confdefs . h < < _ ACEOF 
 @ @ - 15527 , 7 + 15527 , 7 @ @ cat > > $ CONFIG _ STATUS < < \ _ ACEOF | | ac _ write _ fail = 1 
 # report actual input values of CONFIG _ FILES etc . instead of their 
 # values after options handling . 
 ac _ log = " 
 - This file was extended by libffi $ as _ me 3 . 0 . 12 - rc2 , which was 
 + This file was extended by libffi $ as _ me 3 . 0 . 12 - rc3 , which was 
 generated by GNU Autoconf 2 . 69 . Invocation command line was 
 
 CONFIG _ FILES = $ CONFIG _ FILES 
 @ @ - 15597 , 7 + 15597 , 7 @ @ _ ACEOF 
 cat > > $ CONFIG _ STATUS < < _ ACEOF | | ac _ write _ fail = 1 
 ac _ cs _ config = " ` $ as _ echo " $ ac _ configure _ args " | sed ' s / ^ / / ; s / [ \ \ " " \ ` \ $ ] / \ \ \ \ & / g ' ` " 
 ac _ cs _ version = " \ \ 
 - libffi config . status 3 . 0 . 12 - rc2 
 + libffi config . status 3 . 0 . 12 - rc3 
 configured by $ 0 , generated by GNU Autoconf 2 . 69 , 
 with options \ \ " \ $ ac _ cs _ config \ \ " 
 
 diff - - git a / configure . ac b / configure . ac 
 index acf13b2 . . 1d1eed2 100644 
 - - - a / configure . ac 
 + + + b / configure . ac 
 @ @ - 2 , 7 + 2 , 7 @ @ dnl Process this with autoconf to create configure 
 
 AC _ PREREQ ( 2 . 68 ) 
 
 - AC _ INIT ( [ libffi ] , [ 3 . 0 . 12 - rc2 ] , [ http : / / github . com / atgreen / libffi / issues ] ) 
 + AC _ INIT ( [ libffi ] , [ 3 . 0 . 12 - rc3 ] , [ http : / / github . com / atgreen / libffi / issues ] ) 
 AC _ CONFIG _ HEADERS ( [ fficonfig . h ] ) 
 
 AC _ CANONICAL _ SYSTEM 
 diff - - git a / doc / stamp - vti b / doc / stamp - vti 
 index a187361 . . 38f07d7 100644 
 - - - a / doc / stamp - vti 
 + + + b / doc / stamp - vti 
 @ @ - 1 , 4 + 1 , 4 @ @ 
 @ set UPDATED 6 February 2013 
 @ set UPDATED - MONTH February 2013 
 - @ set EDITION 3 . 0 . 12 - rc1 
 - @ set VERSION 3 . 0 . 12 - rc1 
 + @ set EDITION 3 . 0 . 12 - rc2 
 + @ set VERSION 3 . 0 . 12 - rc2 
 diff - - git a / doc / version . texi b / doc / version . texi 
 index a187361 . . 38f07d7 100644 
 - - - a / doc / version . texi 
 + + + b / doc / version . texi 
 @ @ - 1 , 4 + 1 , 4 @ @ 
 @ set UPDATED 6 February 2013 
 @ set UPDATED - MONTH February 2013 
 - @ set EDITION 3 . 0 . 12 - rc1 
 - @ set VERSION 3 . 0 . 12 - rc1 
 + @ set EDITION 3 . 0 . 12 - rc2 
 + @ set VERSION 3 . 0 . 12 - rc2 
 diff - - git a / src / sparc / v8 . S b / src / sparc / v8 . S 
 index 027c363 . . 4faf3bd 100644 
 - - - a / src / sparc / v8 . S 
 + + + b / src / sparc / v8 . S 
 @ @ - 33 , 7 + 33 , 7 @ @ 
 # define ARGS ( 64 + 4 ) 	 	 / * Offset of register area in frame * / 
 
 # ifndef _ _ GNUC _ _ 	 
 - . text 
 + 	 . text 
 . align 8 
 . globl ffi _ flush _ icache 
 . globl _ ffi _ flush _ icache 
 @ @ - 54 , 12 + 54 , 12 @ @ _ ffi _ flush _ icache : 
 	 nop 
 . ffi _ flush _ icache _ end : 
 	 . size 	 ffi _ flush _ icache , . ffi _ flush _ icache _ end - ffi _ flush _ icache 
 + # endif 
 
 	 . text 
 . align 8 
 . globl ffi _ call _ v8 
 . globl _ ffi _ call _ v8 
 - # endif 
 	 
 ffi _ call _ v8 : 
 _ ffi _ call _ v8 :
