BLEU SCORE: 0.31947155212313627

TEST MSG: some changes to TlbImp
GENERATED MSG: some changes

TEST DIFF (one line): diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / COM / TypeLibUtil . java b / contrib / platform / src / com / sun / jna / platform / win32 / COM / TypeLibUtil . java <nl> index 571c6ce . . dfe2db1 100644 <nl> - - - a / contrib / platform / src / com / sun / jna / platform / win32 / COM / TypeLibUtil . java <nl> + + + b / contrib / platform / src / com / sun / jna / platform / win32 / COM / TypeLibUtil . java <nl> @ @ - 89 , 6 + 89 , 18 @ @ public class TypeLibUtil { <nl> this . initTypeLibInfo ( ) ; <nl> } <nl> <nl> + public TypeLibUtil ( String file ) { <nl> + / / load typelib <nl> + PointerByReference pTypeLib = new PointerByReference ( ) ; <nl> + HRESULT hr = OleAuto . INSTANCE . LoadTypeLib ( new WString ( file ) , pTypeLib ) ; <nl> + COMUtils . checkTypeLibRC ( hr ) ; <nl> + <nl> + / / init type lib class <nl> + this . typelib = new TypeLib ( pTypeLib . getValue ( ) ) ; <nl> + <nl> + this . initTypeLibInfo ( ) ; <nl> + } <nl> + <nl> / * * <nl> * Inits the type lib info . <nl> * / <nl> diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / TlbImp . java b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / TlbImp . java <nl> index 18b8f7b . . 1ebb291 100644 <nl> - - - a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / TlbImp . java <nl> + + + b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / TlbImp . java <nl> @ @ - 14 , 11 + 14 , 12 @ @ package com . sun . jna . platform . win32 . COM . tlb ; <nl> <nl> import java . io . File ; <nl> import java . io . FileNotFoundException ; <nl> - import java . io . FileOutputStream ; <nl> import java . io . IOException ; <nl> import java . io . RandomAccessFile ; <nl> + import java . net . URL ; <nl> import java . nio . ByteBuffer ; <nl> import java . nio . channels . FileChannel ; <nl> + import java . util . Enumeration ; <nl> <nl> import com . sun . jna . Native ; <nl> import com . sun . jna . platform . win32 . OaIdl . TYPEKIND ; <nl> @ @ - 58 , 27 + 59 , 36 @ @ public class TlbImp implements TlbConst { <nl> } <nl> <nl> public TlbImp ( String [ ] args ) { <nl> + Native . setProtected ( true ) ; <nl> this . cmdlineArgs = new TlbCmdlineArgs ( args ) ; <nl> <nl> - String clsid = this . cmdlineArgs . getParam ( CMD _ ARG _ TYPELIB _ ID ) ; <nl> - int majorVersion = this . cmdlineArgs <nl> - . getIntParam ( CMD _ ARG _ TYPELIB _ MAJOR _ VERSION ) ; <nl> - int minorVersion = this . cmdlineArgs <nl> - . getIntParam ( CMD _ ARG _ TYPELIB _ MINOR _ VERSION ) ; <nl> + if ( this . cmdlineArgs . isTlbId ( ) ) { <nl> + String clsid = this . cmdlineArgs . getParam ( CMD _ ARG _ TYPELIB _ ID ) ; <nl> + int majorVersion = this . cmdlineArgs <nl> + . getIntParam ( CMD _ ARG _ TYPELIB _ MAJOR _ VERSION ) ; <nl> + int minorVersion = this . cmdlineArgs <nl> + . getIntParam ( CMD _ ARG _ TYPELIB _ MINOR _ VERSION ) ; <nl> <nl> - this . startCOM2Java ( clsid , majorVersion , minorVersion ) ; <nl> - Native . setProtected ( true ) ; <nl> + / / initialize typelib <nl> + / / check version numbers with registry entries ! ! ! <nl> + this . typeLibUtil = new TypeLibUtil ( clsid , majorVersion , <nl> + minorVersion ) ; <nl> + this . startCOM2Java ( ) ; <nl> + } else if ( this . cmdlineArgs . isTlbFile ( ) ) { <nl> + String file = this . cmdlineArgs . getParam ( CMD _ ARG _ TYPELIB _ FILE ) ; <nl> + / / initialize typelib <nl> + / / check version numbers with registry entries ! ! ! <nl> + this . typeLibUtil = new TypeLibUtil ( file ) ; <nl> + this . startCOM2Java ( ) ; <nl> + } else <nl> + this . cmdlineArgs . showCmdHelp ( ) ; <nl> } <nl> <nl> / * * <nl> * Start startCOM2Java . <nl> * / <nl> - public void startCOM2Java ( String clsid , int majorVersion , int minorVersion ) { <nl> + public void startCOM2Java ( ) { <nl> try { <nl> - / / initialize typelib <nl> - / / check version numbers with registry entries ! ! ! <nl> - this . typeLibUtil = new TypeLibUtil ( clsid , majorVersion , <nl> - minorVersion ) ; <nl> / / create output Dir <nl> this . createDir ( ) ; <nl> <nl> @ @ - 139 , 11 + 149 , 12 @ @ public class TlbImp implements TlbConst { <nl> private void writeTextFile ( String filename , String str ) throws IOException { <nl> String file = this . comRootDir + File . separator + filename ; <nl> FileChannel rwChannel = new RandomAccessFile ( file , " rw " ) . getChannel ( ) ; <nl> - ByteBuffer wrBuf = rwChannel . map ( FileChannel . MapMode . READ _ WRITE , 0 , str . length ( ) ) ; <nl> + ByteBuffer wrBuf = rwChannel . map ( FileChannel . MapMode . READ _ WRITE , 0 , <nl> + str . length ( ) ) ; <nl> <nl> wrBuf . put ( str . getBytes ( ) ) ; <nl> <nl> - rwChannel . close ( ) ; <nl> + rwChannel . close ( ) ; <nl> } <nl> <nl> private void writeTlbClass ( TlbBase tlbBase ) throws IOException { <nl> diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbCmdlineArgs . java b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbCmdlineArgs . java <nl> index 98127b8 . . 527074d 100644 <nl> - - - a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbCmdlineArgs . java <nl> + + + b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbCmdlineArgs . java <nl> @ @ - 6 , 7 + 6 , 7 @ @ public class TlbCmdlineArgs extends Hashtable < String , String > implements <nl> TlbConst { <nl> <nl> public TlbCmdlineArgs ( String [ ] args ) { <nl> - this . scanCmdArgs ( args ) ; <nl> + this . readCmdArgs ( args ) ; <nl> } <nl> <nl> public int getIntParam ( String key ) { <nl> @ @ - 22 , 11 + 22 , 41 @ @ public class TlbCmdlineArgs extends Hashtable < String , String > implements <nl> return param ; <nl> } <nl> <nl> - private void scanCmdArgs ( String [ ] args ) { <nl> + private void readCmdArgs ( String [ ] args ) { <nl> + if ( args . length < 2 ) <nl> + this . showCmdHelp ( ) ; <nl> + <nl> for ( int i = 0 ; i < args . length ; i + + ) { <nl> - if ( args [ i ] . startsWith ( " - " ) ) { <nl> + String cmd = args [ i ] ; <nl> + if ( cmd . startsWith ( " - " ) ) { <nl> this . put ( args [ i ] . substring ( 1 ) , args [ i + 1 ] ) ; <nl> } <nl> } <nl> } <nl> + <nl> + public boolean isTlbFile ( ) { <nl> + return this . containsKey ( CMD _ ARG _ TYPELIB _ FILE ) ; <nl> + } <nl> + <nl> + public boolean isTlbId ( ) { <nl> + return this . containsKey ( CMD _ ARG _ TYPELIB _ ID ) ; <nl> + } <nl> + <nl> + public void showCmdHelp ( ) { <nl> + String helpStr = " usage : TlbImp [ - tlb . id - tlb . major . version - tlb . minor . version ] [ - tlb . file ] " + CRCR + <nl> + " options : " + CR + <nl> + " - tlb . id The guid of the type library . " + CR + <nl> + " - tlb . major . version The major version of the type library . " + CR + <nl> + " - tlb . minor . version The minor version of the type library . " + CR + <nl> + " - tlb . file The file name containing the type library . " + CRCR + <nl> + " samples : " + CR + <nl> + " Microsoft Shell Controls And Automation : " + CR + <nl> + " - tlb . file shell32 . dll " + CR + <nl> + " - tlb . id { 50A7E9B0 - 70EF - 11D1 - B75A - 00A0C90564FE } - tlb . major . version 1 - tlb . minor . version 0 " + CRCR + <nl> + " Microsoft Word 12 . 0 Object Library : " + CR + <nl> + " - tlb . id { 00020905 - 0000 - 0000 - C000 - 000000000046 } - tlb . major . version 8 - tlb . minor . version 4 " + CRCR ; <nl> + <nl> + System . out . println ( helpStr ) ; <nl> + System . exit ( 0 ) ; <nl> + } <nl> } <nl> diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbConst . java b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbConst . java <nl> index 6a438fe . . f70d35f 100644 <nl> - - - a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbConst . java <nl> + + + b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbConst . java <nl> @ @ - 8 , 6 + 8 , 10 @ @ public interface TlbConst { <nl> <nl> public final static String TYPELIB _ ID _ SHELL = " { 50A7E9B0 - 70EF - 11D1 - B75A - 00A0C90564FE } " ; <nl> <nl> + public final static String TYPELIB _ MAJOR _ VERSION _ SHELL = " 1 " ; <nl> + <nl> + public final static String TYPELIB _ MINOR _ VERSION _ SHELL = " 0 " ; <nl> + <nl> public final static String TYPELIB _ ID _ WORD = " { 00020905 - 0000 - 0000 - C000 - 000000000046 } " ; <nl> <nl> public final static String TYPELIB _ MAJOR _ VERSION _ WORD = " 8 " ; <nl> @ @ - 26 , 4 + 30 , 5 @ @ public interface TlbConst { <nl> <nl> public final static String CMD _ ARG _ TYPELIB _ MINOR _ VERSION = " tlb . minor . version " ; <nl> <nl> + public final static String CMD _ ARG _ TYPELIB _ FILE = " tlb . file " ; <nl> } <nl> diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / OleAuto . java b / contrib / platform / src / com / sun / jna / platform / win32 / OleAuto . java <nl> index 7d10ba0 . . 49c1a00 100644 <nl> - - - a / contrib / platform / src / com / sun / jna / platform / win32 / OleAuto . java <nl> + + + b / contrib / platform / src / com / sun / jna / platform / win32 / OleAuto . java <nl> @ @ - 471 , 7 + 471 , 7 @ @ public interface OleAuto extends StdCallLibrary { <nl> 	 * TYPE _ E _ CANTLOADLIBRARY The type library or DLL could not be <nl> 	 * loaded . <nl> 	 * / <nl> - 	 public HRESULT LoadTypeLib ( WString szFile , TypeLib . ByReference pptlib ) ; <nl> + 	 public HRESULT LoadTypeLib ( WString szFile , PointerByReference pptlib ) ; <nl> <nl> 	 / * * <nl> 	 * Converts a system time to a variant representation .
NEAREST DIFF (one line): diff - - git a / ChangeLog b / ChangeLog <nl> index 289d195 . . ff76645 100644 <nl> - - - a / ChangeLog <nl> + + + b / ChangeLog <nl> @ @ - 1 , 3 + 1 , 13 @ @ <nl> + 2013 - 01 - 10 Anthony Green < green @ moxielogic . com > <nl> + <nl> + 	 * configure . ac : Put local . exp in the right place . <nl> + 	 * configure : Rebuilt . <nl> + <nl> + 	 * src / x86 / ffi . c : Update comment about regparm function attributes . <nl> + 	 * src / x86 / sysv . S ( ffi _ closure _ SYSV ) : The SUNPRO compiler requires <nl> + 	 that all function arguments be passed on the stack ( no regparm <nl> + 	 support ) . <nl> + <nl> 2013 - 01 - 08 Anthony Green < green @ moxielogic . com > <nl> <nl> 	 * configure . ac : Generate local . exp . This sets CC _ FOR _ TARGET <nl> diff - - git a / configure b / configure <nl> index 5876eb7 . . 4a12b96 100755 <nl> - - - a / configure <nl> + + + b / configure <nl> @ @ - 13068 , 10 + 13068 , 10 @ @ ac _ compiler _ gnu = $ ac _ cv _ c _ compiler _ gnu <nl> <nl> if test " x $ GCC " = " xyes " ; then <nl> CFLAGS = " $ CFLAGS - fexceptions " <nl> - touch testsuite / local . exp <nl> + touch local . exp <nl> else <nl> cat > local . exp < < EOF <nl> - set CC _ FOR _ TARGET $ CC <nl> + set CC _ FOR _ TARGET " $ CC " <nl> EOF <nl> fi <nl> <nl> diff - - git a / configure . ac b / configure . ac <nl> index 7ffb36c . . 13d5bc2 100644 <nl> - - - a / configure . ac <nl> + + + b / configure . ac <nl> @ @ - 40 , 10 + 40 , 10 @ @ AX _ CC _ MAXOPT <nl> AX _ CFLAGS _ WARN _ ALL <nl> if test " x $ GCC " = " xyes " ; then <nl> CFLAGS = " $ CFLAGS - fexceptions " <nl> - touch testsuite / local . exp <nl> + touch local . exp <nl> else <nl> cat > local . exp < < EOF <nl> - set CC _ FOR _ TARGET $ CC <nl> + set CC _ FOR _ TARGET " $ CC " <nl> EOF <nl> fi <nl> <nl> diff - - git a / src / x86 / ffi . c b / src / x86 / ffi . c <nl> index 611e221 . . 3f46693 100644 <nl> - - - a / src / x86 / ffi . c <nl> + + + b / src / x86 / ffi . c <nl> @ @ - 424 , 7 + 424 , 7 @ @ void ffi _ call ( ffi _ cif * cif , void ( * fn ) ( void ) , void * rvalue , void * * avalue ) <nl> / * * private members * * / <nl> <nl> / * The following _ _ attribute _ _ ( ( regparm ( 1 ) ) ) decorations will have no effect <nl> - on MSVC - standard cdecl convention applies . * / <nl> + on MSVC or SUNPRO _ C - - standard conventions apply . * / <nl> static void ffi _ prep _ incoming _ args _ SYSV ( char * stack , void * * ret , <nl> void * * args , ffi _ cif * cif ) ; <nl> void FFI _ HIDDEN ffi _ closure _ SYSV ( ffi _ closure * ) <nl> diff - - git a / src / x86 / sysv . S b / src / x86 / sysv . S <nl> index 69e7e8d . . 71502bb 100644 <nl> - - - a / src / x86 / sysv . S <nl> + + + b / src / x86 / sysv . S <nl> @ @ - 182 , 9 + 182 , 19 @ @ ffi _ closure _ SYSV : <nl> 	 leal 	 - 24 ( % ebp ) , % edx <nl> 	 movl 	 % edx , - 12 ( % ebp ) 	 / * resp * / <nl> 	 leal 	 8 ( % ebp ) , % edx <nl> + # ifdef _ _ SUNPRO _ C <nl> + 	 / * The SUNPRO compiler doesn ' t support GCC ' s regparm function <nl> + 	 attribute , so we have to pass all three arguments to <nl> + 	 ffi _ closure _ SYSV _ inner on the stack . * / <nl> + 	 movl 	 % edx , 8 ( % esp ) 	 / * args = _ _ builtin _ dwarf _ cfa ( ) * / <nl> + 	 leal 	 - 12 ( % ebp ) , % edx <nl> + 	 movl 	 % edx , 4 ( % esp ) 	 / * & resp * / <nl> + 	 movl % eax , ( % esp ) / * closure * / <nl> + # else <nl> 	 movl 	 % edx , 4 ( % esp ) 	 / * args = _ _ builtin _ dwarf _ cfa ( ) * / <nl> 	 leal 	 - 12 ( % ebp ) , % edx <nl> 	 movl 	 % edx , ( % esp ) 	 / * & resp * / <nl> + # endif <nl> # if defined HAVE _ HIDDEN _ VISIBILITY _ ATTRIBUTE | | ! defined _ _ PIC _ _ <nl> 	 call 	 ffi _ closure _ SYSV _ inner <nl> # else

TEST DIFF:
diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / COM / TypeLibUtil . java b / contrib / platform / src / com / sun / jna / platform / win32 / COM / TypeLibUtil . java 
 index 571c6ce . . dfe2db1 100644 
 - - - a / contrib / platform / src / com / sun / jna / platform / win32 / COM / TypeLibUtil . java 
 + + + b / contrib / platform / src / com / sun / jna / platform / win32 / COM / TypeLibUtil . java 
 @ @ - 89 , 6 + 89 , 18 @ @ public class TypeLibUtil { 
 this . initTypeLibInfo ( ) ; 
 } 
 
 + public TypeLibUtil ( String file ) { 
 + / / load typelib 
 + PointerByReference pTypeLib = new PointerByReference ( ) ; 
 + HRESULT hr = OleAuto . INSTANCE . LoadTypeLib ( new WString ( file ) , pTypeLib ) ; 
 + COMUtils . checkTypeLibRC ( hr ) ; 
 + 
 + / / init type lib class 
 + this . typelib = new TypeLib ( pTypeLib . getValue ( ) ) ; 
 + 
 + this . initTypeLibInfo ( ) ; 
 + } 
 + 
 / * * 
 * Inits the type lib info . 
 * / 
 diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / TlbImp . java b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / TlbImp . java 
 index 18b8f7b . . 1ebb291 100644 
 - - - a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / TlbImp . java 
 + + + b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / TlbImp . java 
 @ @ - 14 , 11 + 14 , 12 @ @ package com . sun . jna . platform . win32 . COM . tlb ; 
 
 import java . io . File ; 
 import java . io . FileNotFoundException ; 
 - import java . io . FileOutputStream ; 
 import java . io . IOException ; 
 import java . io . RandomAccessFile ; 
 + import java . net . URL ; 
 import java . nio . ByteBuffer ; 
 import java . nio . channels . FileChannel ; 
 + import java . util . Enumeration ; 
 
 import com . sun . jna . Native ; 
 import com . sun . jna . platform . win32 . OaIdl . TYPEKIND ; 
 @ @ - 58 , 27 + 59 , 36 @ @ public class TlbImp implements TlbConst { 
 } 
 
 public TlbImp ( String [ ] args ) { 
 + Native . setProtected ( true ) ; 
 this . cmdlineArgs = new TlbCmdlineArgs ( args ) ; 
 
 - String clsid = this . cmdlineArgs . getParam ( CMD _ ARG _ TYPELIB _ ID ) ; 
 - int majorVersion = this . cmdlineArgs 
 - . getIntParam ( CMD _ ARG _ TYPELIB _ MAJOR _ VERSION ) ; 
 - int minorVersion = this . cmdlineArgs 
 - . getIntParam ( CMD _ ARG _ TYPELIB _ MINOR _ VERSION ) ; 
 + if ( this . cmdlineArgs . isTlbId ( ) ) { 
 + String clsid = this . cmdlineArgs . getParam ( CMD _ ARG _ TYPELIB _ ID ) ; 
 + int majorVersion = this . cmdlineArgs 
 + . getIntParam ( CMD _ ARG _ TYPELIB _ MAJOR _ VERSION ) ; 
 + int minorVersion = this . cmdlineArgs 
 + . getIntParam ( CMD _ ARG _ TYPELIB _ MINOR _ VERSION ) ; 
 
 - this . startCOM2Java ( clsid , majorVersion , minorVersion ) ; 
 - Native . setProtected ( true ) ; 
 + / / initialize typelib 
 + / / check version numbers with registry entries ! ! ! 
 + this . typeLibUtil = new TypeLibUtil ( clsid , majorVersion , 
 + minorVersion ) ; 
 + this . startCOM2Java ( ) ; 
 + } else if ( this . cmdlineArgs . isTlbFile ( ) ) { 
 + String file = this . cmdlineArgs . getParam ( CMD _ ARG _ TYPELIB _ FILE ) ; 
 + / / initialize typelib 
 + / / check version numbers with registry entries ! ! ! 
 + this . typeLibUtil = new TypeLibUtil ( file ) ; 
 + this . startCOM2Java ( ) ; 
 + } else 
 + this . cmdlineArgs . showCmdHelp ( ) ; 
 } 
 
 / * * 
 * Start startCOM2Java . 
 * / 
 - public void startCOM2Java ( String clsid , int majorVersion , int minorVersion ) { 
 + public void startCOM2Java ( ) { 
 try { 
 - / / initialize typelib 
 - / / check version numbers with registry entries ! ! ! 
 - this . typeLibUtil = new TypeLibUtil ( clsid , majorVersion , 
 - minorVersion ) ; 
 / / create output Dir 
 this . createDir ( ) ; 
 
 @ @ - 139 , 11 + 149 , 12 @ @ public class TlbImp implements TlbConst { 
 private void writeTextFile ( String filename , String str ) throws IOException { 
 String file = this . comRootDir + File . separator + filename ; 
 FileChannel rwChannel = new RandomAccessFile ( file , " rw " ) . getChannel ( ) ; 
 - ByteBuffer wrBuf = rwChannel . map ( FileChannel . MapMode . READ _ WRITE , 0 , str . length ( ) ) ; 
 + ByteBuffer wrBuf = rwChannel . map ( FileChannel . MapMode . READ _ WRITE , 0 , 
 + str . length ( ) ) ; 
 
 wrBuf . put ( str . getBytes ( ) ) ; 
 
 - rwChannel . close ( ) ; 
 + rwChannel . close ( ) ; 
 } 
 
 private void writeTlbClass ( TlbBase tlbBase ) throws IOException { 
 diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbCmdlineArgs . java b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbCmdlineArgs . java 
 index 98127b8 . . 527074d 100644 
 - - - a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbCmdlineArgs . java 
 + + + b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbCmdlineArgs . java 
 @ @ - 6 , 7 + 6 , 7 @ @ public class TlbCmdlineArgs extends Hashtable < String , String > implements 
 TlbConst { 
 
 public TlbCmdlineArgs ( String [ ] args ) { 
 - this . scanCmdArgs ( args ) ; 
 + this . readCmdArgs ( args ) ; 
 } 
 
 public int getIntParam ( String key ) { 
 @ @ - 22 , 11 + 22 , 41 @ @ public class TlbCmdlineArgs extends Hashtable < String , String > implements 
 return param ; 
 } 
 
 - private void scanCmdArgs ( String [ ] args ) { 
 + private void readCmdArgs ( String [ ] args ) { 
 + if ( args . length < 2 ) 
 + this . showCmdHelp ( ) ; 
 + 
 for ( int i = 0 ; i < args . length ; i + + ) { 
 - if ( args [ i ] . startsWith ( " - " ) ) { 
 + String cmd = args [ i ] ; 
 + if ( cmd . startsWith ( " - " ) ) { 
 this . put ( args [ i ] . substring ( 1 ) , args [ i + 1 ] ) ; 
 } 
 } 
 } 
 + 
 + public boolean isTlbFile ( ) { 
 + return this . containsKey ( CMD _ ARG _ TYPELIB _ FILE ) ; 
 + } 
 + 
 + public boolean isTlbId ( ) { 
 + return this . containsKey ( CMD _ ARG _ TYPELIB _ ID ) ; 
 + } 
 + 
 + public void showCmdHelp ( ) { 
 + String helpStr = " usage : TlbImp [ - tlb . id - tlb . major . version - tlb . minor . version ] [ - tlb . file ] " + CRCR + 
 + " options : " + CR + 
 + " - tlb . id The guid of the type library . " + CR + 
 + " - tlb . major . version The major version of the type library . " + CR + 
 + " - tlb . minor . version The minor version of the type library . " + CR + 
 + " - tlb . file The file name containing the type library . " + CRCR + 
 + " samples : " + CR + 
 + " Microsoft Shell Controls And Automation : " + CR + 
 + " - tlb . file shell32 . dll " + CR + 
 + " - tlb . id { 50A7E9B0 - 70EF - 11D1 - B75A - 00A0C90564FE } - tlb . major . version 1 - tlb . minor . version 0 " + CRCR + 
 + " Microsoft Word 12 . 0 Object Library : " + CR + 
 + " - tlb . id { 00020905 - 0000 - 0000 - C000 - 000000000046 } - tlb . major . version 8 - tlb . minor . version 4 " + CRCR ; 
 + 
 + System . out . println ( helpStr ) ; 
 + System . exit ( 0 ) ; 
 + } 
 } 
 diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbConst . java b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbConst . java 
 index 6a438fe . . f70d35f 100644 
 - - - a / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbConst . java 
 + + + b / contrib / platform / src / com / sun / jna / platform / win32 / COM / tlb / imp / TlbConst . java 
 @ @ - 8 , 6 + 8 , 10 @ @ public interface TlbConst { 
 
 public final static String TYPELIB _ ID _ SHELL = " { 50A7E9B0 - 70EF - 11D1 - B75A - 00A0C90564FE } " ; 
 
 + public final static String TYPELIB _ MAJOR _ VERSION _ SHELL = " 1 " ; 
 + 
 + public final static String TYPELIB _ MINOR _ VERSION _ SHELL = " 0 " ; 
 + 
 public final static String TYPELIB _ ID _ WORD = " { 00020905 - 0000 - 0000 - C000 - 000000000046 } " ; 
 
 public final static String TYPELIB _ MAJOR _ VERSION _ WORD = " 8 " ; 
 @ @ - 26 , 4 + 30 , 5 @ @ public interface TlbConst { 
 
 public final static String CMD _ ARG _ TYPELIB _ MINOR _ VERSION = " tlb . minor . version " ; 
 
 + public final static String CMD _ ARG _ TYPELIB _ FILE = " tlb . file " ; 
 } 
 diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / OleAuto . java b / contrib / platform / src / com / sun / jna / platform / win32 / OleAuto . java 
 index 7d10ba0 . . 49c1a00 100644 
 - - - a / contrib / platform / src / com / sun / jna / platform / win32 / OleAuto . java 
 + + + b / contrib / platform / src / com / sun / jna / platform / win32 / OleAuto . java 
 @ @ - 471 , 7 + 471 , 7 @ @ public interface OleAuto extends StdCallLibrary { 
 	 * TYPE _ E _ CANTLOADLIBRARY The type library or DLL could not be 
 	 * loaded . 
 	 * / 
 - 	 public HRESULT LoadTypeLib ( WString szFile , TypeLib . ByReference pptlib ) ; 
 + 	 public HRESULT LoadTypeLib ( WString szFile , PointerByReference pptlib ) ; 
 
 	 / * * 
 	 * Converts a system time to a variant representation .

NEAREST DIFF:
diff - - git a / ChangeLog b / ChangeLog 
 index 289d195 . . ff76645 100644 
 - - - a / ChangeLog 
 + + + b / ChangeLog 
 @ @ - 1 , 3 + 1 , 13 @ @ 
 + 2013 - 01 - 10 Anthony Green < green @ moxielogic . com > 
 + 
 + 	 * configure . ac : Put local . exp in the right place . 
 + 	 * configure : Rebuilt . 
 + 
 + 	 * src / x86 / ffi . c : Update comment about regparm function attributes . 
 + 	 * src / x86 / sysv . S ( ffi _ closure _ SYSV ) : The SUNPRO compiler requires 
 + 	 that all function arguments be passed on the stack ( no regparm 
 + 	 support ) . 
 + 
 2013 - 01 - 08 Anthony Green < green @ moxielogic . com > 
 
 	 * configure . ac : Generate local . exp . This sets CC _ FOR _ TARGET 
 diff - - git a / configure b / configure 
 index 5876eb7 . . 4a12b96 100755 
 - - - a / configure 
 + + + b / configure 
 @ @ - 13068 , 10 + 13068 , 10 @ @ ac _ compiler _ gnu = $ ac _ cv _ c _ compiler _ gnu 
 
 if test " x $ GCC " = " xyes " ; then 
 CFLAGS = " $ CFLAGS - fexceptions " 
 - touch testsuite / local . exp 
 + touch local . exp 
 else 
 cat > local . exp < < EOF 
 - set CC _ FOR _ TARGET $ CC 
 + set CC _ FOR _ TARGET " $ CC " 
 EOF 
 fi 
 
 diff - - git a / configure . ac b / configure . ac 
 index 7ffb36c . . 13d5bc2 100644 
 - - - a / configure . ac 
 + + + b / configure . ac 
 @ @ - 40 , 10 + 40 , 10 @ @ AX _ CC _ MAXOPT 
 AX _ CFLAGS _ WARN _ ALL 
 if test " x $ GCC " = " xyes " ; then 
 CFLAGS = " $ CFLAGS - fexceptions " 
 - touch testsuite / local . exp 
 + touch local . exp 
 else 
 cat > local . exp < < EOF 
 - set CC _ FOR _ TARGET $ CC 
 + set CC _ FOR _ TARGET " $ CC " 
 EOF 
 fi 
 
 diff - - git a / src / x86 / ffi . c b / src / x86 / ffi . c 
 index 611e221 . . 3f46693 100644 
 - - - a / src / x86 / ffi . c 
 + + + b / src / x86 / ffi . c 
 @ @ - 424 , 7 + 424 , 7 @ @ void ffi _ call ( ffi _ cif * cif , void ( * fn ) ( void ) , void * rvalue , void * * avalue ) 
 / * * private members * * / 
 
 / * The following _ _ attribute _ _ ( ( regparm ( 1 ) ) ) decorations will have no effect 
 - on MSVC - standard cdecl convention applies . * / 
 + on MSVC or SUNPRO _ C - - standard conventions apply . * / 
 static void ffi _ prep _ incoming _ args _ SYSV ( char * stack , void * * ret , 
 void * * args , ffi _ cif * cif ) ; 
 void FFI _ HIDDEN ffi _ closure _ SYSV ( ffi _ closure * ) 
 diff - - git a / src / x86 / sysv . S b / src / x86 / sysv . S 
 index 69e7e8d . . 71502bb 100644 
 - - - a / src / x86 / sysv . S 
 + + + b / src / x86 / sysv . S 
 @ @ - 182 , 9 + 182 , 19 @ @ ffi _ closure _ SYSV : 
 	 leal 	 - 24 ( % ebp ) , % edx 
 	 movl 	 % edx , - 12 ( % ebp ) 	 / * resp * / 
 	 leal 	 8 ( % ebp ) , % edx 
 + # ifdef _ _ SUNPRO _ C 
 + 	 / * The SUNPRO compiler doesn ' t support GCC ' s regparm function 
 + 	 attribute , so we have to pass all three arguments to 
 + 	 ffi _ closure _ SYSV _ inner on the stack . * / 
 + 	 movl 	 % edx , 8 ( % esp ) 	 / * args = _ _ builtin _ dwarf _ cfa ( ) * / 
 + 	 leal 	 - 12 ( % ebp ) , % edx 
 + 	 movl 	 % edx , 4 ( % esp ) 	 / * & resp * / 
 + 	 movl % eax , ( % esp ) / * closure * / 
 + # else 
 	 movl 	 % edx , 4 ( % esp ) 	 / * args = _ _ builtin _ dwarf _ cfa ( ) * / 
 	 leal 	 - 12 ( % ebp ) , % edx 
 	 movl 	 % edx , ( % esp ) 	 / * & resp * / 
 + # endif 
 # if defined HAVE _ HIDDEN _ VISIBILITY _ ATTRIBUTE | | ! defined _ _ PIC _ _ 
 	 call 	 ffi _ closure _ SYSV _ inner 
 # else
