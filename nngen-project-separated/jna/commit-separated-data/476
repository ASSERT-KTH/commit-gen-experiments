BLEU SCORE: 0.1270331870386537

TEST MSG: fix some tests under clover
GENERATED MSG: fix 2 failing w32ce tests

TEST DIFF (one line): diff - - git a / test / com / sun / jna / DirectTest . java b / test / com / sun / jna / DirectTest . java <nl> index 1891e95 . . 7fa5a28 100644 <nl> - - - a / test / com / sun / jna / DirectTest . java <nl> + + + b / test / com / sun / jna / DirectTest . java <nl> @ @ - 110 , 7 + 110 , 7 @ @ public class DirectTest extends TestCase implements Paths { <nl> : new URL [ ] { <nl> new File ( BUILDDIR + " / classes " ) . toURI ( ) . toURL ( ) , <nl> new File ( BUILDDIR + " / test - classes " ) . toURI ( ) . toURL ( ) , <nl> - } , null ) ; <nl> + } , new CloverLoader ( ) ) ; <nl> } <nl> protected Class findClass ( String name ) throws ClassNotFoundException { <nl> String boot = System . getProperty ( " jna . boot . library . path " ) ; <nl> @ @ - 125 , 6 + 125 , 7 @ @ public class DirectTest extends TestCase implements Paths { <nl> } <nl> } <nl> <nl> + / / Fails under clover <nl> public void testRegisterMethods ( ) throws Exception { <nl> / / Use a dedicated class loader to ensure the class can be gc ' d <nl> String name = " com . sun . jna . DirectTest $ MathLibrary " ; <nl> diff - - git a / test / com / sun / jna / JNAUnloadTest . java b / test / com / sun / jna / JNAUnloadTest . java <nl> index 75aa85b . . 4faaa07 100644 <nl> - - - a / test / com / sun / jna / JNAUnloadTest . java <nl> + + + b / test / com / sun / jna / JNAUnloadTest . java <nl> @ @ - 32 , 7 + 32 , 7 @ @ public class JNAUnloadTest extends TestCase implements Paths { <nl> Platform . isWindowsCE ( ) <nl> ? new File ( " / Storage Card / " + ( fromJar ? " jna . jar " : " test . jar " ) ) . toURI ( ) . toURL ( ) <nl> : new File ( BUILDDIR + ( fromJar ? " / jna . jar " : " / classes " ) ) . toURI ( ) . toURL ( ) , <nl> - } , null ) ; <nl> + } , new CloverLoader ( ) ) ; <nl> if ( fromJar ) { <nl> assertJarExists ( ) ; <nl> } <nl> diff - - git a / test / com / sun / jna / LibraryLoadTest . java b / test / com / sun / jna / LibraryLoadTest . java <nl> index 2347bf8 . . da61afe 100644 <nl> - - - a / test / com / sun / jna / LibraryLoadTest . java <nl> + + + b / test / com / sun / jna / LibraryLoadTest . java <nl> @ @ - 29 , 7 + 29 , 8 @ @ public class LibraryLoadTest extends TestCase implements Paths { <nl> <nl> private class TestLoader extends URLClassLoader { <nl> public TestLoader ( File path ) throws MalformedURLException { <nl> - super ( new URL [ ] { path . toURI ( ) . toURL ( ) } , null ) ; <nl> + super ( new URL [ ] { path . toURI ( ) . toURL ( ) , } , <nl> + new CloverLoader ( ) ) ; <nl> } <nl> } <nl> <nl> diff - - git a / test / com / sun / jna / Paths . java b / test / com / sun / jna / Paths . java <nl> index 49c163e . . c7f8592 100644 <nl> - - - a / test / com / sun / jna / Paths . java <nl> + + + b / test / com / sun / jna / Paths . java <nl> @ @ - 12 , 11 + 12 , 27 @ @ <nl> * / <nl> package com . sun . jna ; <nl> <nl> + import java . io . File ; <nl> + import java . net . MalformedURLException ; <nl> + import java . net . URL ; <nl> + import java . net . URLClassLoader ; <nl> + <nl> public interface Paths { <nl> + boolean USING _ CLOVER = System . getProperty ( " java . class . path " ) . indexOf ( " clover " ) ! = - 1 ; <nl> + / * * Use this as a parent class loader to ensure clover can be loaded . * / <nl> + class CloverLoader extends URLClassLoader { <nl> + public CloverLoader ( ) throws MalformedURLException { <nl> + super ( new URL [ ] { <nl> + new File ( USING _ CLOVER ? " lib / clover . jar " : " / dev / null " ) . toURI ( ) . toURL ( ) <nl> + } , null ) ; <nl> + } <nl> + } <nl> String BUILDDIR = Platform . isWindowsCE ( ) <nl> ? " / Storage Card " <nl> : System . getProperty ( " jna . builddir " , <nl> - " build " + ( Platform . is64Bit ( ) ? " - d64 " : " " ) ) ; <nl> + USING _ CLOVER <nl> + ? " build . clover " <nl> + : " build " + ( Platform . is64Bit ( ) ? " - d64 " : " " ) ) ; <nl> String CLASSES = BUILDDIR + ( Platform . isWindowsCE ( ) ? " " : " / classes " ) ; <nl> String JNAJAR = BUILDDIR + " / jna . jar " ; <nl> <nl> diff - - git a / test / com / sun / jna / PerformanceTest . java b / test / com / sun / jna / PerformanceTest . java <nl> index 5d51c8e . . 4162b32 100644 <nl> - - - a / test / com / sun / jna / PerformanceTest . java <nl> + + + b / test / com / sun / jna / PerformanceTest . java <nl> @ @ - 17 , 9 + 17 , 6 @ @ import com . sun . jna . * ; <nl> import com . sun . jna . ptr . PointerByReference ; <nl> import java . lang . ref . * ; <nl> import java . io . File ; <nl> - import java . net . MalformedURLException ; <nl> - import java . net . URL ; <nl> - import java . net . URLClassLoader ; <nl> import java . nio . Buffer ; <nl> import java . nio . ByteBuffer ; <nl> import java . nio . ByteOrder ; <nl> diff - - git a / test / com / sun / jna / WebStartTest . java b / test / com / sun / jna / WebStartTest . java <nl> index b451e48 . . 1fc5025 100644 <nl> - - - a / test / com / sun / jna / WebStartTest . java <nl> + + + b / test / com / sun / jna / WebStartTest . java <nl> @ @ - 136 , 10 + 136 , 8 @ @ public class WebStartTest extends TestCase implements Paths { <nl> contents = contents . replace ( " { CODEBASE } " , codebase ) ; <nl> contents = contents . replace ( " { JNLP _ FILE } " , jnlp . toURI ( ) . toURL ( ) . toString ( ) ) ; <nl> contents = contents . replace ( " { PORT } " , String . valueOf ( port ) ) ; <nl> - boolean clover = <nl> - System . getProperty ( " java . class . path " ) . indexOf ( " clover " ) ! = - 1 ; <nl> contents = contents . replace ( " { CLOVER } " , <nl> - clover ? " < jar href = ' clover . jar ' / > " : " " ) ; <nl> + USING _ CLOVER ? " < jar href = ' clover . jar ' / > " : " " ) ; <nl> <nl> try { <nl> OutputStream os = new FileOutputStream ( jnlp ) ;
NEAREST DIFF (one line): diff - - git a / dist / jna . jar b / dist / jna . jar <nl> index 57f31c3 . . b8fdc1f 100644 <nl> Binary files a / dist / jna . jar and b / dist / jna . jar differ <nl> diff - - git a / dist / w32ce - arm . jar b / dist / w32ce - arm . jar <nl> index 568db1b . . 6fb4471 100644 <nl> Binary files a / dist / w32ce - arm . jar and b / dist / w32ce - arm . jar differ

TEST DIFF:
diff - - git a / test / com / sun / jna / DirectTest . java b / test / com / sun / jna / DirectTest . java 
 index 1891e95 . . 7fa5a28 100644 
 - - - a / test / com / sun / jna / DirectTest . java 
 + + + b / test / com / sun / jna / DirectTest . java 
 @ @ - 110 , 7 + 110 , 7 @ @ public class DirectTest extends TestCase implements Paths { 
 : new URL [ ] { 
 new File ( BUILDDIR + " / classes " ) . toURI ( ) . toURL ( ) , 
 new File ( BUILDDIR + " / test - classes " ) . toURI ( ) . toURL ( ) , 
 - } , null ) ; 
 + } , new CloverLoader ( ) ) ; 
 } 
 protected Class findClass ( String name ) throws ClassNotFoundException { 
 String boot = System . getProperty ( " jna . boot . library . path " ) ; 
 @ @ - 125 , 6 + 125 , 7 @ @ public class DirectTest extends TestCase implements Paths { 
 } 
 } 
 
 + / / Fails under clover 
 public void testRegisterMethods ( ) throws Exception { 
 / / Use a dedicated class loader to ensure the class can be gc ' d 
 String name = " com . sun . jna . DirectTest $ MathLibrary " ; 
 diff - - git a / test / com / sun / jna / JNAUnloadTest . java b / test / com / sun / jna / JNAUnloadTest . java 
 index 75aa85b . . 4faaa07 100644 
 - - - a / test / com / sun / jna / JNAUnloadTest . java 
 + + + b / test / com / sun / jna / JNAUnloadTest . java 
 @ @ - 32 , 7 + 32 , 7 @ @ public class JNAUnloadTest extends TestCase implements Paths { 
 Platform . isWindowsCE ( ) 
 ? new File ( " / Storage Card / " + ( fromJar ? " jna . jar " : " test . jar " ) ) . toURI ( ) . toURL ( ) 
 : new File ( BUILDDIR + ( fromJar ? " / jna . jar " : " / classes " ) ) . toURI ( ) . toURL ( ) , 
 - } , null ) ; 
 + } , new CloverLoader ( ) ) ; 
 if ( fromJar ) { 
 assertJarExists ( ) ; 
 } 
 diff - - git a / test / com / sun / jna / LibraryLoadTest . java b / test / com / sun / jna / LibraryLoadTest . java 
 index 2347bf8 . . da61afe 100644 
 - - - a / test / com / sun / jna / LibraryLoadTest . java 
 + + + b / test / com / sun / jna / LibraryLoadTest . java 
 @ @ - 29 , 7 + 29 , 8 @ @ public class LibraryLoadTest extends TestCase implements Paths { 
 
 private class TestLoader extends URLClassLoader { 
 public TestLoader ( File path ) throws MalformedURLException { 
 - super ( new URL [ ] { path . toURI ( ) . toURL ( ) } , null ) ; 
 + super ( new URL [ ] { path . toURI ( ) . toURL ( ) , } , 
 + new CloverLoader ( ) ) ; 
 } 
 } 
 
 diff - - git a / test / com / sun / jna / Paths . java b / test / com / sun / jna / Paths . java 
 index 49c163e . . c7f8592 100644 
 - - - a / test / com / sun / jna / Paths . java 
 + + + b / test / com / sun / jna / Paths . java 
 @ @ - 12 , 11 + 12 , 27 @ @ 
 * / 
 package com . sun . jna ; 
 
 + import java . io . File ; 
 + import java . net . MalformedURLException ; 
 + import java . net . URL ; 
 + import java . net . URLClassLoader ; 
 + 
 public interface Paths { 
 + boolean USING _ CLOVER = System . getProperty ( " java . class . path " ) . indexOf ( " clover " ) ! = - 1 ; 
 + / * * Use this as a parent class loader to ensure clover can be loaded . * / 
 + class CloverLoader extends URLClassLoader { 
 + public CloverLoader ( ) throws MalformedURLException { 
 + super ( new URL [ ] { 
 + new File ( USING _ CLOVER ? " lib / clover . jar " : " / dev / null " ) . toURI ( ) . toURL ( ) 
 + } , null ) ; 
 + } 
 + } 
 String BUILDDIR = Platform . isWindowsCE ( ) 
 ? " / Storage Card " 
 : System . getProperty ( " jna . builddir " , 
 - " build " + ( Platform . is64Bit ( ) ? " - d64 " : " " ) ) ; 
 + USING _ CLOVER 
 + ? " build . clover " 
 + : " build " + ( Platform . is64Bit ( ) ? " - d64 " : " " ) ) ; 
 String CLASSES = BUILDDIR + ( Platform . isWindowsCE ( ) ? " " : " / classes " ) ; 
 String JNAJAR = BUILDDIR + " / jna . jar " ; 
 
 diff - - git a / test / com / sun / jna / PerformanceTest . java b / test / com / sun / jna / PerformanceTest . java 
 index 5d51c8e . . 4162b32 100644 
 - - - a / test / com / sun / jna / PerformanceTest . java 
 + + + b / test / com / sun / jna / PerformanceTest . java 
 @ @ - 17 , 9 + 17 , 6 @ @ import com . sun . jna . * ; 
 import com . sun . jna . ptr . PointerByReference ; 
 import java . lang . ref . * ; 
 import java . io . File ; 
 - import java . net . MalformedURLException ; 
 - import java . net . URL ; 
 - import java . net . URLClassLoader ; 
 import java . nio . Buffer ; 
 import java . nio . ByteBuffer ; 
 import java . nio . ByteOrder ; 
 diff - - git a / test / com / sun / jna / WebStartTest . java b / test / com / sun / jna / WebStartTest . java 
 index b451e48 . . 1fc5025 100644 
 - - - a / test / com / sun / jna / WebStartTest . java 
 + + + b / test / com / sun / jna / WebStartTest . java 
 @ @ - 136 , 10 + 136 , 8 @ @ public class WebStartTest extends TestCase implements Paths { 
 contents = contents . replace ( " { CODEBASE } " , codebase ) ; 
 contents = contents . replace ( " { JNLP _ FILE } " , jnlp . toURI ( ) . toURL ( ) . toString ( ) ) ; 
 contents = contents . replace ( " { PORT } " , String . valueOf ( port ) ) ; 
 - boolean clover = 
 - System . getProperty ( " java . class . path " ) . indexOf ( " clover " ) ! = - 1 ; 
 contents = contents . replace ( " { CLOVER } " , 
 - clover ? " < jar href = ' clover . jar ' / > " : " " ) ; 
 + USING _ CLOVER ? " < jar href = ' clover . jar ' / > " : " " ) ; 
 
 try { 
 OutputStream os = new FileOutputStream ( jnlp ) ;

NEAREST DIFF:
diff - - git a / dist / jna . jar b / dist / jna . jar 
 index 57f31c3 . . b8fdc1f 100644 
 Binary files a / dist / jna . jar and b / dist / jna . jar differ 
 diff - - git a / dist / w32ce - arm . jar b / dist / w32ce - arm . jar 
 index 568db1b . . 6fb4471 100644 
 Binary files a / dist / w32ce - arm . jar and b / dist / w32ce - arm . jar differ
