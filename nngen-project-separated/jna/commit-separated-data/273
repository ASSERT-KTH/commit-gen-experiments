BLEU SCORE: 0.07986788803078405

TEST MSG: add privileges if necessary
GENERATED MSG: Restore original imports .

TEST DIFF (one line): diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / W32Service . java b / contrib / platform / src / com / sun / jna / platform / win32 / W32Service . java <nl> index 62a077b . . 8c43592 100644 <nl> - - - a / contrib / platform / src / com / sun / jna / platform / win32 / W32Service . java <nl> + + + b / contrib / platform / src / com / sun / jna / platform / win32 / W32Service . java <nl> @ @ - 19 , 6 + 19 , 13 @ @ import com . sun . jna . Memory ; <nl> import com . sun . jna . Native ; <nl> import com . sun . jna . Pointer ; <nl> import com . sun . jna . Structure ; <nl> + import com . sun . jna . platform . win32 . WinDef . DWORD ; <nl> + import com . sun . jna . platform . win32 . WinNT ; <nl> + import com . sun . jna . platform . win32 . WinNT . HANDLE ; <nl> + import com . sun . jna . platform . win32 . WinNT . HANDLEByReference ; <nl> + import com . sun . jna . platform . win32 . WinNT . LUID ; <nl> + import com . sun . jna . platform . win32 . WinNT . LUID _ AND _ ATTRIBUTES ; <nl> + import com . sun . jna . platform . win32 . WinNT . TOKEN _ PRIVILEGES ; <nl> import com . sun . jna . platform . win32 . Winsvc . SC _ ACTION ; <nl> import com . sun . jna . platform . win32 . Winsvc . SC _ HANDLE ; <nl> import com . sun . jna . platform . win32 . Winsvc . SC _ STATUS _ TYPE ; <nl> @ @ - 57 , 6 + 64 , 18 @ @ public class W32Service { <nl> 	 	 } <nl> 	 } <nl> <nl> + 	 private void addShutdownPrivilegeToProcess ( ) { <nl> + 	 	 HANDLEByReference hToken = new HANDLEByReference ( ) ; <nl> + 	 	 LUID luid = new LUID ( ) ; <nl> + 	 	 Advapi32 . INSTANCE . OpenProcessToken ( Kernel32 . INSTANCE . GetCurrentProcess ( ) , <nl> + 	 	 	 	 WinNT . TOKEN _ ADJUST _ PRIVILEGES , hToken ) ; <nl> + 	 	 Advapi32 . INSTANCE . LookupPrivilegeValue ( " " , WinNT . SE _ SHUTDOWN _ NAME , luid ) ; <nl> + 	 	 TOKEN _ PRIVILEGES tp = new TOKEN _ PRIVILEGES ( 1 ) ; <nl> + 	 	 tp . Privileges [ 0 ] = new LUID _ AND _ ATTRIBUTES ( luid , new DWORD ( WinNT . SE _ PRIVILEGE _ ENABLED ) ) ; <nl> + 	 	 Advapi32 . INSTANCE . AdjustTokenPrivileges ( hToken . getValue ( ) , false , tp , tp . size ( ) , null , <nl> + 	 	 	 	 new IntByReference ( ) ) ; <nl> + 	 } <nl> + <nl> 	 / * * <nl> 	 * Set the failure actions of the specified service . Corresponds to <nl> 	 * < a href = " https : / / msdn . microsoft . com / en - us / library / windows / desktop / ms681988 . aspx " > ChangeServiceConfig2 < / a > <nl> @ @ - 82 , 8 + 101 , 13 @ @ public class W32Service { <nl> <nl> 	 	 actionStruct . lpsaActions = new SC _ ACTION . ByReference ( ) ; <nl> 	 	 SC _ ACTION [ ] actionArray = ( SC _ ACTION [ ] ) actionStruct . lpsaActions . toArray ( actions . size ( ) ) ; <nl> + 	 	 boolean hasShutdownPrivilege = false ; <nl> 	 	 int i = 0 ; <nl> 	 	 for ( SC _ ACTION action : actions ) { <nl> + 	 	 	 if ( ! hasShutdownPrivilege & & action . type = = Winsvc . SC _ ACTION _ REBOOT ) { <nl> + 	 	 	 	 addShutdownPrivilegeToProcess ( ) ; <nl> + 	 	 	 	 hasShutdownPrivilege = true ; <nl> + 	 	 	 } <nl> 	 	 	 actionArray [ i ] . type = action . type ; <nl> 	 	 	 actionArray [ i ] . delay = action . delay ; <nl> 	 	 	 i + + ;
NEAREST DIFF (one line): diff - - git a / README . md b / README . md <nl> index 8b836fe . . fb7433c 100644 <nl> - - - a / README . md <nl> + + + b / README . md <nl> @ @ - 18 , 8 + 18 , 8 @ @ Download <nl> <nl> Version 3 . 3 . 0 <nl> <nl> - * [ jna . jar ] ( raw / 3 . 3 . 0 / jnalib / dist / jna . jar ) <nl> - * [ platform . jar ] ( raw / 3 . 3 . 0 / jnalib / dist / platform . jar ) <nl> + * [ jna . jar ] ( jna / raw / 3 . 3 . 0 / jnalib / dist / jna . jar ) <nl> + * [ platform . jar ] ( jna / raw / 3 . 3 . 0 / jnalib / dist / platform . jar ) <nl> <nl> Features <nl> = = = = = = = =

TEST DIFF:
diff - - git a / contrib / platform / src / com / sun / jna / platform / win32 / W32Service . java b / contrib / platform / src / com / sun / jna / platform / win32 / W32Service . java 
 index 62a077b . . 8c43592 100644 
 - - - a / contrib / platform / src / com / sun / jna / platform / win32 / W32Service . java 
 + + + b / contrib / platform / src / com / sun / jna / platform / win32 / W32Service . java 
 @ @ - 19 , 6 + 19 , 13 @ @ import com . sun . jna . Memory ; 
 import com . sun . jna . Native ; 
 import com . sun . jna . Pointer ; 
 import com . sun . jna . Structure ; 
 + import com . sun . jna . platform . win32 . WinDef . DWORD ; 
 + import com . sun . jna . platform . win32 . WinNT ; 
 + import com . sun . jna . platform . win32 . WinNT . HANDLE ; 
 + import com . sun . jna . platform . win32 . WinNT . HANDLEByReference ; 
 + import com . sun . jna . platform . win32 . WinNT . LUID ; 
 + import com . sun . jna . platform . win32 . WinNT . LUID _ AND _ ATTRIBUTES ; 
 + import com . sun . jna . platform . win32 . WinNT . TOKEN _ PRIVILEGES ; 
 import com . sun . jna . platform . win32 . Winsvc . SC _ ACTION ; 
 import com . sun . jna . platform . win32 . Winsvc . SC _ HANDLE ; 
 import com . sun . jna . platform . win32 . Winsvc . SC _ STATUS _ TYPE ; 
 @ @ - 57 , 6 + 64 , 18 @ @ public class W32Service { 
 	 	 } 
 	 } 
 
 + 	 private void addShutdownPrivilegeToProcess ( ) { 
 + 	 	 HANDLEByReference hToken = new HANDLEByReference ( ) ; 
 + 	 	 LUID luid = new LUID ( ) ; 
 + 	 	 Advapi32 . INSTANCE . OpenProcessToken ( Kernel32 . INSTANCE . GetCurrentProcess ( ) , 
 + 	 	 	 	 WinNT . TOKEN _ ADJUST _ PRIVILEGES , hToken ) ; 
 + 	 	 Advapi32 . INSTANCE . LookupPrivilegeValue ( " " , WinNT . SE _ SHUTDOWN _ NAME , luid ) ; 
 + 	 	 TOKEN _ PRIVILEGES tp = new TOKEN _ PRIVILEGES ( 1 ) ; 
 + 	 	 tp . Privileges [ 0 ] = new LUID _ AND _ ATTRIBUTES ( luid , new DWORD ( WinNT . SE _ PRIVILEGE _ ENABLED ) ) ; 
 + 	 	 Advapi32 . INSTANCE . AdjustTokenPrivileges ( hToken . getValue ( ) , false , tp , tp . size ( ) , null , 
 + 	 	 	 	 new IntByReference ( ) ) ; 
 + 	 } 
 + 
 	 / * * 
 	 * Set the failure actions of the specified service . Corresponds to 
 	 * < a href = " https : / / msdn . microsoft . com / en - us / library / windows / desktop / ms681988 . aspx " > ChangeServiceConfig2 < / a > 
 @ @ - 82 , 8 + 101 , 13 @ @ public class W32Service { 
 
 	 	 actionStruct . lpsaActions = new SC _ ACTION . ByReference ( ) ; 
 	 	 SC _ ACTION [ ] actionArray = ( SC _ ACTION [ ] ) actionStruct . lpsaActions . toArray ( actions . size ( ) ) ; 
 + 	 	 boolean hasShutdownPrivilege = false ; 
 	 	 int i = 0 ; 
 	 	 for ( SC _ ACTION action : actions ) { 
 + 	 	 	 if ( ! hasShutdownPrivilege & & action . type = = Winsvc . SC _ ACTION _ REBOOT ) { 
 + 	 	 	 	 addShutdownPrivilegeToProcess ( ) ; 
 + 	 	 	 	 hasShutdownPrivilege = true ; 
 + 	 	 	 } 
 	 	 	 actionArray [ i ] . type = action . type ; 
 	 	 	 actionArray [ i ] . delay = action . delay ; 
 	 	 	 i + + ;

NEAREST DIFF:
diff - - git a / README . md b / README . md 
 index 8b836fe . . fb7433c 100644 
 - - - a / README . md 
 + + + b / README . md 
 @ @ - 18 , 8 + 18 , 8 @ @ Download 
 
 Version 3 . 3 . 0 
 
 - * [ jna . jar ] ( raw / 3 . 3 . 0 / jnalib / dist / jna . jar ) 
 - * [ platform . jar ] ( raw / 3 . 3 . 0 / jnalib / dist / platform . jar ) 
 + * [ jna . jar ] ( jna / raw / 3 . 3 . 0 / jnalib / dist / jna . jar ) 
 + * [ platform . jar ] ( jna / raw / 3 . 3 . 0 / jnalib / dist / platform . jar ) 
 
 Features 
 = = = = = = = =
