BLEU SCORE: 0.015784309053930103

TEST MSG: Add chunk loading protection to WorldSever . getTileEntitiesIn , may prevent orphanced chunks and a CME in EntityPlayerMP . Note : The ' max ' parameters are NON - inclusive .
GENERATED MSG: Only call blockBreak when block itself changes , not just meta . Fixes bottles poping out of brewing stands .

TEST DIFF (one line): diff - - git a / patches / minecraft / net / minecraft / entity / player / EntityPlayerMP . java . patch b / patches / minecraft / net / minecraft / entity / player / EntityPlayerMP . java . patch <nl> index 91bf0b3 . . cda8667 100644 <nl> - - - a / patches / minecraft / net / minecraft / entity / player / EntityPlayerMP . java . patch <nl> + + + b / patches / minecraft / net / minecraft / entity / player / EntityPlayerMP . java . patch <nl> @ @ - 27 , 17 + 27 , 7 @ @ <nl> { <nl> this . func _ 71053 _ j ( ) ; <nl> this . field _ 71070 _ bA = this . field _ 71069 _ bz ; <nl> - @ @ - 264 , 7 + 265 , 8 @ @ <nl> - if ( chunk . func _ 150802 _ k ( ) ) <nl> - { <nl> - list . add ( chunk ) ; <nl> - - list1 . addAll ( ( ( WorldServer ) this . field _ 70170 _ p ) . func _ 147486 _ a ( chunkcoordintpair . field _ 77276 _ a * 16 , 0 , chunkcoordintpair . field _ 77275 _ b * 16 , chunkcoordintpair . field _ 77276 _ a * 16 + 16 , 256 , chunkcoordintpair . field _ 77275 _ b * 16 + 16 ) ) ; <nl> - + list1 . addAll ( ( ( WorldServer ) this . field _ 70170 _ p ) . func _ 147486 _ a ( chunkcoordintpair . field _ 77276 _ a * 16 , 0 , chunkcoordintpair . field _ 77275 _ b * 16 , chunkcoordintpair . field _ 77276 _ a * 16 + 16 , 256 , chunkcoordintpair . field _ 77275 _ b * 16 + 15 ) ) ; <nl> - + / / BugFix : 16 makes it load an extra chunk , which isn ' t associated with a player , which makes it not unload unless a player walks near it . <nl> - iterator1 . remove ( ) ; <nl> - } <nl> - } <nl> - @ @ - 294 , 6 + 296 , 7 @ @ <nl> + @ @ - 294 , 6 + 295 , 7 @ @ <nl> for ( Chunk chunk1 : list ) <nl> { <nl> this . func _ 71121 _ q ( ) . func _ 73039 _ n ( ) . func _ 85172 _ a ( this , chunk1 ) ; <nl> @ @ - 45 , 7 + 35 , 7 @ @ <nl> } <nl> } <nl> } <nl> - @ @ - 424 , 6 + 427 , 7 @ @ <nl> + @ @ - 424 , 6 + 426 , 7 @ @ <nl> <nl> public void func _ 70645 _ a ( DamageSource p _ 70645 _ 1 _ ) <nl> { <nl> @ @ - 53 , 7 + 43 , 7 @ @ <nl> if ( this . field _ 70170 _ p . func _ 82736 _ K ( ) . func _ 82766 _ b ( " showDeathMessages " ) ) <nl> { <nl> Team team = this . func _ 96124 _ cp ( ) ; <nl> - @ @ - 447 , 7 + 451 , 20 @ @ <nl> + @ @ - 447 , 7 + 450 , 20 @ @ <nl> <nl> if ( ! this . field _ 70170 _ p . func _ 82736 _ K ( ) . func _ 82766 _ b ( " keepInventory " ) ) <nl> { <nl> @ @ - 74 , 7 + 64 , 7 @ @ <nl> } <nl> <nl> for ( ScoreObjective scoreobjective : this . field _ 70170 _ p . func _ 96441 _ U ( ) . func _ 96520 _ a ( IScoreObjectiveCriteria . field _ 96642 _ c ) ) <nl> - @ @ - 461 , 6 + 478 , 7 @ @ <nl> + @ @ - 461 , 6 + 477 , 7 @ @ <nl> if ( entitylivingbase ! = null ) <nl> { <nl> EntityList . EntityEggInfo entitylist $ entityegginfo = ( EntityList . EntityEggInfo ) EntityList . field _ 75627 _ a . get ( Integer . valueOf ( EntityList . func _ 75619 _ a ( entitylivingbase ) ) ) ; <nl> @ @ - 82 , 7 + 72 , 7 @ @ <nl> <nl> if ( entitylist $ entityegginfo ! = null ) <nl> { <nl> - @ @ - 831 , 6 + 849 , 7 @ @ <nl> + @ @ - 831 , 6 + 848 , 7 @ @ <nl> { <nl> if ( p _ 71064 _ 1 _ ! = null ) <nl> { <nl> diff - - git a / patches / minecraft / net / minecraft / world / WorldServer . java . patch b / patches / minecraft / net / minecraft / world / WorldServer . java . patch <nl> index b8e52a8 . . bb280aa 100644 <nl> - - - a / patches / minecraft / net / minecraft / world / WorldServer . java . patch <nl> + + + b / patches / minecraft / net / minecraft / world / WorldServer . java . patch <nl> @ @ - 127 , 23 + 127 , 24 @ @ <nl> int k = 0 ; <nl> <nl> if ( this . func _ 175707 _ a ( nextticklistentry1 . field _ 180282 _ a . func _ 177982 _ a ( - k , - k , - k ) , nextticklistentry1 . field _ 180282 _ a . func _ 177982 _ a ( k , k , k ) ) ) <nl> - @ @ - 696 , 22 + 720 , 39 @ @ <nl> + @ @ - 696 , 22 + 720 , 40 @ @ <nl> { <nl> List < TileEntity > list = Lists . < TileEntity > newArrayList ( ) ; <nl> <nl> - for ( int i = 0 ; i < this . field _ 147482 _ g . size ( ) ; + + i ) <nl> - + / / Forge : Optomize this loop to only grab from the chunks it needs <nl> - + for ( int x = ( p _ 147486 _ 1 _ > > 4 ) ; x < = ( p _ 147486 _ 4 _ > > 4 ) ; x + + ) <nl> + + / / Forge : Optimize this loop to only grab from the chunks it needs <nl> + + for ( int x = p _ 147486 _ 1 _ ; x < p _ 147486 _ 4 _ ; x + = 16 ) <nl> { <nl> - TileEntity tileentity = ( TileEntity ) this . field _ 147482 _ g . get ( i ) ; <nl> - BlockPos blockpos = tileentity . func _ 174877 _ v ( ) ; <nl> - <nl> - if ( blockpos . func _ 177958 _ n ( ) > = p _ 147486 _ 1 _ & & blockpos . func _ 177956 _ o ( ) > = p _ 147486 _ 2 _ & & blockpos . func _ 177952 _ p ( ) > = p _ 147486 _ 3 _ & & blockpos . func _ 177958 _ n ( ) < p _ 147486 _ 4 _ & & blockpos . func _ 177956 _ o ( ) < p _ 147486 _ 5 _ & & blockpos . func _ 177952 _ p ( ) < p _ 147486 _ 6 _ ) <nl> - + for ( int z = ( p _ 147486 _ 3 _ > > 4 ) ; z < = ( p _ 147486 _ 6 _ > > 4 ) ; z + + ) <nl> + + for ( int z = p _ 147486 _ 3 _ ; z < p _ 147486 _ 6 _ ; z + = 16 ) <nl> { <nl> - list . add ( tileentity ) ; <nl> - + Chunk chunk = this . func _ 72964 _ e ( x , z ) ; <nl> - + if ( chunk ! = null ) <nl> + + if ( ! this . func _ 175680 _ a ( x > > 4 , z > > 4 , true ) ) continue ; / / Prevent loading extra chunks to just read data . This causes orphaned chunks that never unload . <nl> + + Chunk chunk = this . func _ 72964 _ e ( x > > 4 , z > > 4 ) ; <nl> + + if ( chunk ! = null & & ! chunk . func _ 76621 _ g ( ) ) <nl> + { <nl> + for ( TileEntity entity : chunk . func _ 177434 _ r ( ) . values ( ) ) <nl> + { <nl> @ @ - 151 , 7 + 152 , 7 @ @ <nl> + { <nl> + BlockPos pos = entity . func _ 174877 _ v ( ) ; <nl> + if ( pos . func _ 177958 _ n ( ) > = p _ 147486 _ 1 _ & & pos . func _ 177956 _ o ( ) > = p _ 147486 _ 2 _ & & pos . func _ 177952 _ p ( ) > = p _ 147486 _ 3 _ & & <nl> - + pos . func _ 177958 _ n ( ) < = p _ 147486 _ 4 _ & & pos . func _ 177956 _ o ( ) < = p _ 147486 _ 5 _ & & pos . func _ 177952 _ p ( ) < = p _ 147486 _ 6 _ ) <nl> + + pos . func _ 177958 _ n ( ) < p _ 147486 _ 4 _ & & pos . func _ 177956 _ o ( ) < p _ 147486 _ 5 _ & & pos . func _ 177952 _ p ( ) < p _ 147486 _ 6 _ ) <nl> + { <nl> + list . add ( entity ) ; <nl> + } <nl> @ @ - 174 , 7 + 175 , 7 @ @ <nl> return ! this . field _ 73061 _ a . func _ 175579 _ a ( this , p _ 175660 _ 2 _ , p _ 175660 _ 1 _ ) & & this . func _ 175723 _ af ( ) . func _ 177746 _ a ( p _ 175660 _ 2 _ ) ; <nl> } <nl> <nl> - @ @ - 777 , 6 + 818 , 7 @ @ <nl> + @ @ - 777 , 6 + 819 , 7 @ @ <nl> } <nl> else <nl> { <nl> @ @ - 182 , 7 + 183 , 7 @ @ <nl> this . field _ 72987 _ B = true ; <nl> WorldChunkManager worldchunkmanager = this . field _ 73011 _ w . func _ 177499 _ m ( ) ; <nl> List < BiomeGenBase > list = worldchunkmanager . func _ 76932 _ a ( ) ; <nl> - @ @ - 822 , 7 + 864 , 7 @ @ <nl> + @ @ - 822 , 7 + 865 , 7 @ @ <nl> <nl> protected void func _ 73047 _ i ( ) <nl> { <nl> @ @ - 191 , 7 + 192 , 7 @ @ <nl> <nl> for ( int i = 0 ; i < 10 ; + + i ) <nl> { <nl> - @ @ - 859 , 6 + 901 , 7 @ @ <nl> + @ @ - 859 , 6 + 902 , 7 @ @ <nl> } <nl> <nl> this . field _ 73020 _ y . func _ 73151 _ a ( p _ 73044 _ 1 _ , p _ 73044 _ 2 _ ) ; <nl> @ @ - 199 , 7 + 200 , 7 @ @ <nl> <nl> for ( Chunk chunk : Lists . newArrayList ( this . field _ 73059 _ b . func _ 152380 _ a ( ) ) ) <nl> { <nl> - @ @ - 892 , 6 + 935 , 7 @ @ <nl> + @ @ - 892 , 6 + 936 , 7 @ @ <nl> this . field _ 72986 _ A . func _ 176135 _ e ( this . func _ 175723 _ af ( ) . func _ 177732 _ i ( ) ) ; <nl> this . field _ 73019 _ z . func _ 75755 _ a ( this . field _ 72986 _ A , this . field _ 73061 _ a . func _ 71203 _ ab ( ) . func _ 72378 _ q ( ) ) ; <nl> this . field _ 72988 _ C . func _ 75744 _ a ( ) ; <nl> @ @ - 207 , 7 + 208 , 7 @ @ <nl> } <nl> <nl> public void func _ 72923 _ a ( Entity p _ 72923 _ 1 _ ) <nl> - @ @ - 947 , 6 + 991 , 7 @ @ <nl> + @ @ - 947 , 6 + 992 , 7 @ @ <nl> public Explosion func _ 72885 _ a ( Entity p _ 72885 _ 1 _ , double p _ 72885 _ 2 _ , double p _ 72885 _ 4 _ , double p _ 72885 _ 6 _ , float p _ 72885 _ 8 _ , boolean p _ 72885 _ 9 _ , boolean p _ 72885 _ 10 _ ) <nl> { <nl> Explosion explosion = new Explosion ( this , p _ 72885 _ 1 _ , p _ 72885 _ 2 _ , p _ 72885 _ 4 _ , p _ 72885 _ 6 _ , p _ 72885 _ 8 _ , p _ 72885 _ 9 _ , p _ 72885 _ 10 _ ) ; <nl> @ @ - 215 , 7 + 216 , 7 @ @ <nl> explosion . func _ 77278 _ a ( ) ; <nl> explosion . func _ 77279 _ a ( false ) ; <nl> <nl> - @ @ - 1026 , 19 + 1071 , 23 @ @ <nl> + @ @ - 1026 , 19 + 1072 , 23 @ @ <nl> this . field _ 73061 _ a . func _ 71203 _ ab ( ) . func _ 148537 _ a ( new S2BPacketChangeGameState ( 8 , this . field _ 73017 _ q ) , this . field _ 73011 _ w . func _ 177502 _ q ( ) ) ; <nl> } <nl> <nl> @ @ - 243 , 7 + 244 , 7 @ @ <nl> } <nl> } <nl> <nl> - @ @ - 1104 , 6 + 1153 , 11 @ @ <nl> + @ @ - 1104 , 6 + 1154 , 11 @ @ <nl> return this . field _ 73061 _ a . func _ 152345 _ ab ( ) ; <nl> } <nl>
NEAREST DIFF (one line): diff - - git a / patches / minecraft / net / minecraft / tileentity / TileEntity . java . patch b / patches / minecraft / net / minecraft / tileentity / TileEntity . java . patch <nl> index 85b49af . . 17834bc 100644 <nl> - - - a / patches / minecraft / net / minecraft / tileentity / TileEntity . java . patch <nl> + + + b / patches / minecraft / net / minecraft / tileentity / TileEntity . java . patch <nl> @ @ - 39 , 7 + 39 , 7 @ @ <nl> + * / <nl> + public boolean shouldRefresh ( World world , BlockPos pos , IBlockState oldState , IBlockState newSate ) <nl> + { <nl> - + return ! isVanilla | | ( oldState ! = newSate ) ; <nl> + + return ! isVanilla | | ( oldState . func _ 177230 _ c ( ) ! = newSate . func _ 177230 _ c ( ) ) ; <nl> + } <nl> + <nl> + public boolean shouldRenderInPass ( int pass ) <nl> diff - - git a / patches / minecraft / net / minecraft / world / chunk / Chunk . java . patch b / patches / minecraft / net / minecraft / world / chunk / Chunk . java . patch <nl> index 7966f3c . . f5ec7e9 100644 <nl> - - - a / patches / minecraft / net / minecraft / world / chunk / Chunk . java . patch <nl> + + + b / patches / minecraft / net / minecraft / world / chunk / Chunk . java . patch <nl> @ @ - 34 , 7 + 34 , 7 @ @ <nl> } <nl> <nl> private Block func _ 150810 _ a ( int p _ 150810 _ 1 _ , int p _ 150810 _ 2 _ , int p _ 150810 _ 3 _ ) <nl> - @ @ - 653 , 16 + 656 , 20 @ @ <nl> + @ @ - 653 , 16 + 656 , 23 @ @ <nl> flag = j > = i1 ; <nl> } <nl> <nl> @ @ - 47 , 7 + 47 , 10 @ @ <nl> { <nl> if ( ! this . field _ 76637 _ e . field _ 72995 _ K ) <nl> { <nl> + + if ( iblockstate1 . func _ 177230 _ c ( ) ! = p _ 177436 _ 2 _ . func _ 177230 _ c ( ) ) / / Only fire block breaks when the block changes . <nl> block1 . func _ 180663 _ b ( this . field _ 76637 _ e , p _ 177436 _ 1 _ , iblockstate1 ) ; <nl> + + TileEntity te = this . func _ 177424 _ a ( p _ 177436 _ 1 _ , Chunk . EnumCreateEntityType . CHECK ) ; <nl> + + if ( te ! = null & & te . shouldRefresh ( this . field _ 76637 _ e , p _ 177436 _ 1 _ , iblockstate1 , p _ 177436 _ 2 _ ) ) this . field _ 76637 _ e . func _ 175713 _ t ( p _ 177436 _ 1 _ ) ; <nl> } <nl> - else if ( block1 instanceof ITileEntityProvider ) <nl> + else if ( block1 . hasTileEntity ( iblockstate1 ) ) <nl> @ @ - 57 , 7 + 60 , 7 @ @ <nl> this . field _ 76637 _ e . func _ 175713 _ t ( p _ 177436 _ 1 _ ) ; <nl> } <nl> } <nl> - @ @ - 679 , 8 + 686 , 7 @ @ <nl> + @ @ - 679 , 8 + 689 , 7 @ @ <nl> } <nl> else <nl> { <nl> @ @ - 67 , 7 + 70 , 7 @ @ <nl> <nl> if ( j1 > 0 ) <nl> { <nl> - @ @ - 702 , 28 + 708 , 18 @ @ <nl> + @ @ - 702 , 28 + 711 , 18 @ @ <nl> <nl> TileEntity tileentity ; <nl> <nl> @ @ - 98 , 7 + 101 , 7 @ @ <nl> this . field _ 76637 _ e . func _ 175690 _ a ( p _ 177436 _ 1 _ , tileentity ) ; <nl> } <nl> <nl> - @ @ - 826 , 6 + 822 , 7 @ @ <nl> + @ @ - 826 , 6 + 825 , 7 @ @ <nl> k = this . field _ 76645 _ j . length - 1 ; <nl> } <nl> <nl> @ @ - 106 , 7 + 109 , 7 @ @ <nl> p _ 76612 _ 1 _ . field _ 70175 _ ag = true ; <nl> p _ 76612 _ 1 _ . field _ 70176 _ ah = this . field _ 76635 _ g ; <nl> p _ 76612 _ 1 _ . field _ 70162 _ ai = k ; <nl> - @ @ - 864 , 13 + 861 , 20 @ @ <nl> + @ @ - 864 , 13 + 864 , 20 @ @ <nl> private TileEntity func _ 177422 _ i ( BlockPos p _ 177422 _ 1 _ ) <nl> { <nl> Block block = this . func _ 177428 _ a ( p _ 177422 _ 1 _ ) ; <nl> @ @ - 128 , 7 + 131 , 7 @ @ <nl> if ( tileentity = = null ) <nl> { <nl> if ( p _ 177424 _ 2 _ = = Chunk . EnumCreateEntityType . IMMEDIATE ) <nl> - @ @ - 883 , 11 + 887 , 6 @ @ <nl> + @ @ - 883 , 11 + 890 , 6 @ @ <nl> this . field _ 177447 _ w . add ( p _ 177424 _ 1 _ ) ; <nl> } <nl> } <nl> @ @ - 140 , 7 + 143 , 7 @ @ <nl> <nl> return tileentity ; <nl> } <nl> - @ @ - 907 , 7 + 906 , 7 @ @ <nl> + @ @ - 907 , 7 + 909 , 7 @ @ <nl> p _ 177426 _ 2 _ . func _ 145834 _ a ( this . field _ 76637 _ e ) ; <nl> p _ 177426 _ 2 _ . func _ 174878 _ a ( p _ 177426 _ 1 _ ) ; <nl> <nl> @ @ - 149 , 7 + 152 , 7 @ @ <nl> { <nl> if ( this . field _ 150816 _ i . containsKey ( p _ 177426 _ 1 _ ) ) <nl> { <nl> - @ @ - 949 , 6 + 948 , 7 @ @ <nl> + @ @ - 949 , 6 + 951 , 7 @ @ <nl> <nl> this . field _ 76637 _ e . func _ 175650 _ b ( this . field _ 76645 _ j [ i ] ) ; <nl> } <nl> @ @ - 157 , 7 + 160 , 7 @ @ <nl> } <nl> <nl> public void func _ 76623 _ d ( ) <nl> - @ @ - 966 , 6 + 966 , 7 @ @ <nl> + @ @ - 966 , 6 + 969 , 7 @ @ <nl> { <nl> this . field _ 76637 _ e . func _ 175681 _ c ( this . field _ 76645 _ j [ i ] ) ; <nl> } <nl> @ @ - 165 , 7 + 168 , 7 @ @ <nl> } <nl> <nl> public void func _ 76630 _ e ( ) <nl> - @ @ - 975 , 8 + 976 , 8 @ @ <nl> + @ @ - 975 , 8 + 979 , 8 @ @ <nl> <nl> public void func _ 177414 _ a ( Entity p _ 177414 _ 1 _ , AxisAlignedBB p _ 177414 _ 2 _ , List p _ 177414 _ 3 _ , Predicate p _ 177414 _ 4 _ ) <nl> { <nl> @ @ - 176 , 7 + 179 , 7 @ @ <nl> i = MathHelper . func _ 76125 _ a ( i , 0 , this . field _ 76645 _ j . length - 1 ) ; <nl> j = MathHelper . func _ 76125 _ a ( j , 0 , this . field _ 76645 _ j . length - 1 ) ; <nl> <nl> - @ @ - 1012 , 8 + 1013 , 8 @ @ <nl> + @ @ - 1012 , 8 + 1016 , 8 @ @ <nl> <nl> public void func _ 177430 _ a ( Class p _ 177430 _ 1 _ , AxisAlignedBB p _ 177430 _ 2 _ , List p _ 177430 _ 3 _ , Predicate p _ 177430 _ 4 _ ) <nl> { <nl> @ @ - 187 , 7 + 190 , 7 @ @ <nl> i = MathHelper . func _ 76125 _ a ( i , 0 , this . field _ 76645 _ j . length - 1 ) ; <nl> j = MathHelper . func _ 76125 _ a ( j , 0 , this . field _ 76645 _ j . length - 1 ) ; <nl> <nl> - @ @ - 1179 , 8 + 1180 , 10 @ @ <nl> + @ @ - 1179 , 8 + 1183 , 10 @ @ <nl> while ( ! this . field _ 177447 _ w . isEmpty ( ) ) <nl> { <nl> BlockPos blockpos = ( BlockPos ) this . field _ 177447 _ w . poll ( ) ; <nl> @ @ - 199 , 7 + 202 , 7 @ @ <nl> { <nl> TileEntity tileentity = this . func _ 177422 _ i ( blockpos ) ; <nl> this . field _ 76637 _ e . func _ 175690 _ a ( blockpos , tileentity ) ; <nl> - @ @ - 1242 , 6 + 1245 , 15 @ @ <nl> + @ @ - 1242 , 6 + 1248 , 15 @ @ <nl> @ SideOnly ( Side . CLIENT ) <nl> public void func _ 177439 _ a ( byte [ ] p _ 177439 _ 1 _ , int p _ 177439 _ 2 _ , boolean p _ 177439 _ 3 _ ) <nl> { <nl> @ @ - 215 , 7 + 218 , 7 @ @ <nl> int j = 0 ; <nl> boolean flag1 = ! this . field _ 76637 _ e . field _ 73011 _ w . func _ 177495 _ o ( ) ; <nl> int k ; <nl> - @ @ - 1311 , 13 + 1323 , 18 @ @ <nl> + @ @ - 1311 , 13 + 1326 , 18 @ @ <nl> this . field _ 150814 _ l = true ; <nl> this . field _ 76646 _ k = true ; <nl> this . func _ 76590 _ a ( ) ; <nl> @ @ - 235 , 7 + 238 , 7 @ @ <nl> } <nl> <nl> public BiomeGenBase func _ 177411 _ a ( BlockPos p _ 177411 _ 1 _ , WorldChunkManager p _ 177411 _ 2 _ ) <nl> - @ @ - 1644 , 4 + 1661 , 20 @ @ <nl> + @ @ - 1644 , 4 + 1664 , 20 @ @ <nl> <nl> private static final String _ _ OBFID = " CL _ 00002009 " ; <nl> }

TEST DIFF:
diff - - git a / patches / minecraft / net / minecraft / entity / player / EntityPlayerMP . java . patch b / patches / minecraft / net / minecraft / entity / player / EntityPlayerMP . java . patch 
 index 91bf0b3 . . cda8667 100644 
 - - - a / patches / minecraft / net / minecraft / entity / player / EntityPlayerMP . java . patch 
 + + + b / patches / minecraft / net / minecraft / entity / player / EntityPlayerMP . java . patch 
 @ @ - 27 , 17 + 27 , 7 @ @ 
 { 
 this . func _ 71053 _ j ( ) ; 
 this . field _ 71070 _ bA = this . field _ 71069 _ bz ; 
 - @ @ - 264 , 7 + 265 , 8 @ @ 
 - if ( chunk . func _ 150802 _ k ( ) ) 
 - { 
 - list . add ( chunk ) ; 
 - - list1 . addAll ( ( ( WorldServer ) this . field _ 70170 _ p ) . func _ 147486 _ a ( chunkcoordintpair . field _ 77276 _ a * 16 , 0 , chunkcoordintpair . field _ 77275 _ b * 16 , chunkcoordintpair . field _ 77276 _ a * 16 + 16 , 256 , chunkcoordintpair . field _ 77275 _ b * 16 + 16 ) ) ; 
 - + list1 . addAll ( ( ( WorldServer ) this . field _ 70170 _ p ) . func _ 147486 _ a ( chunkcoordintpair . field _ 77276 _ a * 16 , 0 , chunkcoordintpair . field _ 77275 _ b * 16 , chunkcoordintpair . field _ 77276 _ a * 16 + 16 , 256 , chunkcoordintpair . field _ 77275 _ b * 16 + 15 ) ) ; 
 - + / / BugFix : 16 makes it load an extra chunk , which isn ' t associated with a player , which makes it not unload unless a player walks near it . 
 - iterator1 . remove ( ) ; 
 - } 
 - } 
 - @ @ - 294 , 6 + 296 , 7 @ @ 
 + @ @ - 294 , 6 + 295 , 7 @ @ 
 for ( Chunk chunk1 : list ) 
 { 
 this . func _ 71121 _ q ( ) . func _ 73039 _ n ( ) . func _ 85172 _ a ( this , chunk1 ) ; 
 @ @ - 45 , 7 + 35 , 7 @ @ 
 } 
 } 
 } 
 - @ @ - 424 , 6 + 427 , 7 @ @ 
 + @ @ - 424 , 6 + 426 , 7 @ @ 
 
 public void func _ 70645 _ a ( DamageSource p _ 70645 _ 1 _ ) 
 { 
 @ @ - 53 , 7 + 43 , 7 @ @ 
 if ( this . field _ 70170 _ p . func _ 82736 _ K ( ) . func _ 82766 _ b ( " showDeathMessages " ) ) 
 { 
 Team team = this . func _ 96124 _ cp ( ) ; 
 - @ @ - 447 , 7 + 451 , 20 @ @ 
 + @ @ - 447 , 7 + 450 , 20 @ @ 
 
 if ( ! this . field _ 70170 _ p . func _ 82736 _ K ( ) . func _ 82766 _ b ( " keepInventory " ) ) 
 { 
 @ @ - 74 , 7 + 64 , 7 @ @ 
 } 
 
 for ( ScoreObjective scoreobjective : this . field _ 70170 _ p . func _ 96441 _ U ( ) . func _ 96520 _ a ( IScoreObjectiveCriteria . field _ 96642 _ c ) ) 
 - @ @ - 461 , 6 + 478 , 7 @ @ 
 + @ @ - 461 , 6 + 477 , 7 @ @ 
 if ( entitylivingbase ! = null ) 
 { 
 EntityList . EntityEggInfo entitylist $ entityegginfo = ( EntityList . EntityEggInfo ) EntityList . field _ 75627 _ a . get ( Integer . valueOf ( EntityList . func _ 75619 _ a ( entitylivingbase ) ) ) ; 
 @ @ - 82 , 7 + 72 , 7 @ @ 
 
 if ( entitylist $ entityegginfo ! = null ) 
 { 
 - @ @ - 831 , 6 + 849 , 7 @ @ 
 + @ @ - 831 , 6 + 848 , 7 @ @ 
 { 
 if ( p _ 71064 _ 1 _ ! = null ) 
 { 
 diff - - git a / patches / minecraft / net / minecraft / world / WorldServer . java . patch b / patches / minecraft / net / minecraft / world / WorldServer . java . patch 
 index b8e52a8 . . bb280aa 100644 
 - - - a / patches / minecraft / net / minecraft / world / WorldServer . java . patch 
 + + + b / patches / minecraft / net / minecraft / world / WorldServer . java . patch 
 @ @ - 127 , 23 + 127 , 24 @ @ 
 int k = 0 ; 
 
 if ( this . func _ 175707 _ a ( nextticklistentry1 . field _ 180282 _ a . func _ 177982 _ a ( - k , - k , - k ) , nextticklistentry1 . field _ 180282 _ a . func _ 177982 _ a ( k , k , k ) ) ) 
 - @ @ - 696 , 22 + 720 , 39 @ @ 
 + @ @ - 696 , 22 + 720 , 40 @ @ 
 { 
 List < TileEntity > list = Lists . < TileEntity > newArrayList ( ) ; 
 
 - for ( int i = 0 ; i < this . field _ 147482 _ g . size ( ) ; + + i ) 
 - + / / Forge : Optomize this loop to only grab from the chunks it needs 
 - + for ( int x = ( p _ 147486 _ 1 _ > > 4 ) ; x < = ( p _ 147486 _ 4 _ > > 4 ) ; x + + ) 
 + + / / Forge : Optimize this loop to only grab from the chunks it needs 
 + + for ( int x = p _ 147486 _ 1 _ ; x < p _ 147486 _ 4 _ ; x + = 16 ) 
 { 
 - TileEntity tileentity = ( TileEntity ) this . field _ 147482 _ g . get ( i ) ; 
 - BlockPos blockpos = tileentity . func _ 174877 _ v ( ) ; 
 - 
 - if ( blockpos . func _ 177958 _ n ( ) > = p _ 147486 _ 1 _ & & blockpos . func _ 177956 _ o ( ) > = p _ 147486 _ 2 _ & & blockpos . func _ 177952 _ p ( ) > = p _ 147486 _ 3 _ & & blockpos . func _ 177958 _ n ( ) < p _ 147486 _ 4 _ & & blockpos . func _ 177956 _ o ( ) < p _ 147486 _ 5 _ & & blockpos . func _ 177952 _ p ( ) < p _ 147486 _ 6 _ ) 
 - + for ( int z = ( p _ 147486 _ 3 _ > > 4 ) ; z < = ( p _ 147486 _ 6 _ > > 4 ) ; z + + ) 
 + + for ( int z = p _ 147486 _ 3 _ ; z < p _ 147486 _ 6 _ ; z + = 16 ) 
 { 
 - list . add ( tileentity ) ; 
 - + Chunk chunk = this . func _ 72964 _ e ( x , z ) ; 
 - + if ( chunk ! = null ) 
 + + if ( ! this . func _ 175680 _ a ( x > > 4 , z > > 4 , true ) ) continue ; / / Prevent loading extra chunks to just read data . This causes orphaned chunks that never unload . 
 + + Chunk chunk = this . func _ 72964 _ e ( x > > 4 , z > > 4 ) ; 
 + + if ( chunk ! = null & & ! chunk . func _ 76621 _ g ( ) ) 
 + { 
 + for ( TileEntity entity : chunk . func _ 177434 _ r ( ) . values ( ) ) 
 + { 
 @ @ - 151 , 7 + 152 , 7 @ @ 
 + { 
 + BlockPos pos = entity . func _ 174877 _ v ( ) ; 
 + if ( pos . func _ 177958 _ n ( ) > = p _ 147486 _ 1 _ & & pos . func _ 177956 _ o ( ) > = p _ 147486 _ 2 _ & & pos . func _ 177952 _ p ( ) > = p _ 147486 _ 3 _ & & 
 - + pos . func _ 177958 _ n ( ) < = p _ 147486 _ 4 _ & & pos . func _ 177956 _ o ( ) < = p _ 147486 _ 5 _ & & pos . func _ 177952 _ p ( ) < = p _ 147486 _ 6 _ ) 
 + + pos . func _ 177958 _ n ( ) < p _ 147486 _ 4 _ & & pos . func _ 177956 _ o ( ) < p _ 147486 _ 5 _ & & pos . func _ 177952 _ p ( ) < p _ 147486 _ 6 _ ) 
 + { 
 + list . add ( entity ) ; 
 + } 
 @ @ - 174 , 7 + 175 , 7 @ @ 
 return ! this . field _ 73061 _ a . func _ 175579 _ a ( this , p _ 175660 _ 2 _ , p _ 175660 _ 1 _ ) & & this . func _ 175723 _ af ( ) . func _ 177746 _ a ( p _ 175660 _ 2 _ ) ; 
 } 
 
 - @ @ - 777 , 6 + 818 , 7 @ @ 
 + @ @ - 777 , 6 + 819 , 7 @ @ 
 } 
 else 
 { 
 @ @ - 182 , 7 + 183 , 7 @ @ 
 this . field _ 72987 _ B = true ; 
 WorldChunkManager worldchunkmanager = this . field _ 73011 _ w . func _ 177499 _ m ( ) ; 
 List < BiomeGenBase > list = worldchunkmanager . func _ 76932 _ a ( ) ; 
 - @ @ - 822 , 7 + 864 , 7 @ @ 
 + @ @ - 822 , 7 + 865 , 7 @ @ 
 
 protected void func _ 73047 _ i ( ) 
 { 
 @ @ - 191 , 7 + 192 , 7 @ @ 
 
 for ( int i = 0 ; i < 10 ; + + i ) 
 { 
 - @ @ - 859 , 6 + 901 , 7 @ @ 
 + @ @ - 859 , 6 + 902 , 7 @ @ 
 } 
 
 this . field _ 73020 _ y . func _ 73151 _ a ( p _ 73044 _ 1 _ , p _ 73044 _ 2 _ ) ; 
 @ @ - 199 , 7 + 200 , 7 @ @ 
 
 for ( Chunk chunk : Lists . newArrayList ( this . field _ 73059 _ b . func _ 152380 _ a ( ) ) ) 
 { 
 - @ @ - 892 , 6 + 935 , 7 @ @ 
 + @ @ - 892 , 6 + 936 , 7 @ @ 
 this . field _ 72986 _ A . func _ 176135 _ e ( this . func _ 175723 _ af ( ) . func _ 177732 _ i ( ) ) ; 
 this . field _ 73019 _ z . func _ 75755 _ a ( this . field _ 72986 _ A , this . field _ 73061 _ a . func _ 71203 _ ab ( ) . func _ 72378 _ q ( ) ) ; 
 this . field _ 72988 _ C . func _ 75744 _ a ( ) ; 
 @ @ - 207 , 7 + 208 , 7 @ @ 
 } 
 
 public void func _ 72923 _ a ( Entity p _ 72923 _ 1 _ ) 
 - @ @ - 947 , 6 + 991 , 7 @ @ 
 + @ @ - 947 , 6 + 992 , 7 @ @ 
 public Explosion func _ 72885 _ a ( Entity p _ 72885 _ 1 _ , double p _ 72885 _ 2 _ , double p _ 72885 _ 4 _ , double p _ 72885 _ 6 _ , float p _ 72885 _ 8 _ , boolean p _ 72885 _ 9 _ , boolean p _ 72885 _ 10 _ ) 
 { 
 Explosion explosion = new Explosion ( this , p _ 72885 _ 1 _ , p _ 72885 _ 2 _ , p _ 72885 _ 4 _ , p _ 72885 _ 6 _ , p _ 72885 _ 8 _ , p _ 72885 _ 9 _ , p _ 72885 _ 10 _ ) ; 
 @ @ - 215 , 7 + 216 , 7 @ @ 
 explosion . func _ 77278 _ a ( ) ; 
 explosion . func _ 77279 _ a ( false ) ; 
 
 - @ @ - 1026 , 19 + 1071 , 23 @ @ 
 + @ @ - 1026 , 19 + 1072 , 23 @ @ 
 this . field _ 73061 _ a . func _ 71203 _ ab ( ) . func _ 148537 _ a ( new S2BPacketChangeGameState ( 8 , this . field _ 73017 _ q ) , this . field _ 73011 _ w . func _ 177502 _ q ( ) ) ; 
 } 
 
 @ @ - 243 , 7 + 244 , 7 @ @ 
 } 
 } 
 
 - @ @ - 1104 , 6 + 1153 , 11 @ @ 
 + @ @ - 1104 , 6 + 1154 , 11 @ @ 
 return this . field _ 73061 _ a . func _ 152345 _ ab ( ) ; 
 } 


NEAREST DIFF:
diff - - git a / patches / minecraft / net / minecraft / tileentity / TileEntity . java . patch b / patches / minecraft / net / minecraft / tileentity / TileEntity . java . patch 
 index 85b49af . . 17834bc 100644 
 - - - a / patches / minecraft / net / minecraft / tileentity / TileEntity . java . patch 
 + + + b / patches / minecraft / net / minecraft / tileentity / TileEntity . java . patch 
 @ @ - 39 , 7 + 39 , 7 @ @ 
 + * / 
 + public boolean shouldRefresh ( World world , BlockPos pos , IBlockState oldState , IBlockState newSate ) 
 + { 
 - + return ! isVanilla | | ( oldState ! = newSate ) ; 
 + + return ! isVanilla | | ( oldState . func _ 177230 _ c ( ) ! = newSate . func _ 177230 _ c ( ) ) ; 
 + } 
 + 
 + public boolean shouldRenderInPass ( int pass ) 
 diff - - git a / patches / minecraft / net / minecraft / world / chunk / Chunk . java . patch b / patches / minecraft / net / minecraft / world / chunk / Chunk . java . patch 
 index 7966f3c . . f5ec7e9 100644 
 - - - a / patches / minecraft / net / minecraft / world / chunk / Chunk . java . patch 
 + + + b / patches / minecraft / net / minecraft / world / chunk / Chunk . java . patch 
 @ @ - 34 , 7 + 34 , 7 @ @ 
 } 
 
 private Block func _ 150810 _ a ( int p _ 150810 _ 1 _ , int p _ 150810 _ 2 _ , int p _ 150810 _ 3 _ ) 
 - @ @ - 653 , 16 + 656 , 20 @ @ 
 + @ @ - 653 , 16 + 656 , 23 @ @ 
 flag = j > = i1 ; 
 } 
 
 @ @ - 47 , 7 + 47 , 10 @ @ 
 { 
 if ( ! this . field _ 76637 _ e . field _ 72995 _ K ) 
 { 
 + + if ( iblockstate1 . func _ 177230 _ c ( ) ! = p _ 177436 _ 2 _ . func _ 177230 _ c ( ) ) / / Only fire block breaks when the block changes . 
 block1 . func _ 180663 _ b ( this . field _ 76637 _ e , p _ 177436 _ 1 _ , iblockstate1 ) ; 
 + + TileEntity te = this . func _ 177424 _ a ( p _ 177436 _ 1 _ , Chunk . EnumCreateEntityType . CHECK ) ; 
 + + if ( te ! = null & & te . shouldRefresh ( this . field _ 76637 _ e , p _ 177436 _ 1 _ , iblockstate1 , p _ 177436 _ 2 _ ) ) this . field _ 76637 _ e . func _ 175713 _ t ( p _ 177436 _ 1 _ ) ; 
 } 
 - else if ( block1 instanceof ITileEntityProvider ) 
 + else if ( block1 . hasTileEntity ( iblockstate1 ) ) 
 @ @ - 57 , 7 + 60 , 7 @ @ 
 this . field _ 76637 _ e . func _ 175713 _ t ( p _ 177436 _ 1 _ ) ; 
 } 
 } 
 - @ @ - 679 , 8 + 686 , 7 @ @ 
 + @ @ - 679 , 8 + 689 , 7 @ @ 
 } 
 else 
 { 
 @ @ - 67 , 7 + 70 , 7 @ @ 
 
 if ( j1 > 0 ) 
 { 
 - @ @ - 702 , 28 + 708 , 18 @ @ 
 + @ @ - 702 , 28 + 711 , 18 @ @ 
 
 TileEntity tileentity ; 
 
 @ @ - 98 , 7 + 101 , 7 @ @ 
 this . field _ 76637 _ e . func _ 175690 _ a ( p _ 177436 _ 1 _ , tileentity ) ; 
 } 
 
 - @ @ - 826 , 6 + 822 , 7 @ @ 
 + @ @ - 826 , 6 + 825 , 7 @ @ 
 k = this . field _ 76645 _ j . length - 1 ; 
 } 
 
 @ @ - 106 , 7 + 109 , 7 @ @ 
 p _ 76612 _ 1 _ . field _ 70175 _ ag = true ; 
 p _ 76612 _ 1 _ . field _ 70176 _ ah = this . field _ 76635 _ g ; 
 p _ 76612 _ 1 _ . field _ 70162 _ ai = k ; 
 - @ @ - 864 , 13 + 861 , 20 @ @ 
 + @ @ - 864 , 13 + 864 , 20 @ @ 
 private TileEntity func _ 177422 _ i ( BlockPos p _ 177422 _ 1 _ ) 
 { 
 Block block = this . func _ 177428 _ a ( p _ 177422 _ 1 _ ) ; 
 @ @ - 128 , 7 + 131 , 7 @ @ 
 if ( tileentity = = null ) 
 { 
 if ( p _ 177424 _ 2 _ = = Chunk . EnumCreateEntityType . IMMEDIATE ) 
 - @ @ - 883 , 11 + 887 , 6 @ @ 
 + @ @ - 883 , 11 + 890 , 6 @ @ 
 this . field _ 177447 _ w . add ( p _ 177424 _ 1 _ ) ; 
 } 
 } 
 @ @ - 140 , 7 + 143 , 7 @ @ 
 
 return tileentity ; 
 } 
 - @ @ - 907 , 7 + 906 , 7 @ @ 
 + @ @ - 907 , 7 + 909 , 7 @ @ 
 p _ 177426 _ 2 _ . func _ 145834 _ a ( this . field _ 76637 _ e ) ; 
 p _ 177426 _ 2 _ . func _ 174878 _ a ( p _ 177426 _ 1 _ ) ; 
 
 @ @ - 149 , 7 + 152 , 7 @ @ 
 { 
 if ( this . field _ 150816 _ i . containsKey ( p _ 177426 _ 1 _ ) ) 
 { 
 - @ @ - 949 , 6 + 948 , 7 @ @ 
 + @ @ - 949 , 6 + 951 , 7 @ @ 
 
 this . field _ 76637 _ e . func _ 175650 _ b ( this . field _ 76645 _ j [ i ] ) ; 
 } 
 @ @ - 157 , 7 + 160 , 7 @ @ 
 } 
 
 public void func _ 76623 _ d ( ) 
 - @ @ - 966 , 6 + 966 , 7 @ @ 
 + @ @ - 966 , 6 + 969 , 7 @ @ 
 { 
 this . field _ 76637 _ e . func _ 175681 _ c ( this . field _ 76645 _ j [ i ] ) ; 
 } 
 @ @ - 165 , 7 + 168 , 7 @ @ 
 } 
 
 public void func _ 76630 _ e ( ) 
 - @ @ - 975 , 8 + 976 , 8 @ @ 
 + @ @ - 975 , 8 + 979 , 8 @ @ 
 
 public void func _ 177414 _ a ( Entity p _ 177414 _ 1 _ , AxisAlignedBB p _ 177414 _ 2 _ , List p _ 177414 _ 3 _ , Predicate p _ 177414 _ 4 _ ) 
 { 
 @ @ - 176 , 7 + 179 , 7 @ @ 
 i = MathHelper . func _ 76125 _ a ( i , 0 , this . field _ 76645 _ j . length - 1 ) ; 
 j = MathHelper . func _ 76125 _ a ( j , 0 , this . field _ 76645 _ j . length - 1 ) ; 
 
 - @ @ - 1012 , 8 + 1013 , 8 @ @ 
 + @ @ - 1012 , 8 + 1016 , 8 @ @ 
 
 public void func _ 177430 _ a ( Class p _ 177430 _ 1 _ , AxisAlignedBB p _ 177430 _ 2 _ , List p _ 177430 _ 3 _ , Predicate p _ 177430 _ 4 _ ) 
 { 
 @ @ - 187 , 7 + 190 , 7 @ @ 
 i = MathHelper . func _ 76125 _ a ( i , 0 , this . field _ 76645 _ j . length - 1 ) ; 
 j = MathHelper . func _ 76125 _ a ( j , 0 , this . field _ 76645 _ j . length - 1 ) ; 
 
 - @ @ - 1179 , 8 + 1180 , 10 @ @ 
 + @ @ - 1179 , 8 + 1183 , 10 @ @ 
 while ( ! this . field _ 177447 _ w . isEmpty ( ) ) 
 { 
 BlockPos blockpos = ( BlockPos ) this . field _ 177447 _ w . poll ( ) ; 
 @ @ - 199 , 7 + 202 , 7 @ @ 
 { 
 TileEntity tileentity = this . func _ 177422 _ i ( blockpos ) ; 
 this . field _ 76637 _ e . func _ 175690 _ a ( blockpos , tileentity ) ; 
 - @ @ - 1242 , 6 + 1245 , 15 @ @ 
 + @ @ - 1242 , 6 + 1248 , 15 @ @ 
 @ SideOnly ( Side . CLIENT ) 
 public void func _ 177439 _ a ( byte [ ] p _ 177439 _ 1 _ , int p _ 177439 _ 2 _ , boolean p _ 177439 _ 3 _ ) 
 { 
 @ @ - 215 , 7 + 218 , 7 @ @ 
 int j = 0 ; 
 boolean flag1 = ! this . field _ 76637 _ e . field _ 73011 _ w . func _ 177495 _ o ( ) ; 
 int k ; 
 - @ @ - 1311 , 13 + 1323 , 18 @ @ 
 + @ @ - 1311 , 13 + 1326 , 18 @ @ 
 this . field _ 150814 _ l = true ; 
 this . field _ 76646 _ k = true ; 
 this . func _ 76590 _ a ( ) ; 
 @ @ - 235 , 7 + 238 , 7 @ @ 
 } 
 
 public BiomeGenBase func _ 177411 _ a ( BlockPos p _ 177411 _ 1 _ , WorldChunkManager p _ 177411 _ 2 _ ) 
 - @ @ - 1644 , 4 + 1661 , 20 @ @ 
 + @ @ - 1644 , 4 + 1664 , 20 @ @ 
 
 private static final String _ _ OBFID = " CL _ 00002009 " ; 
 }
