BLEU SCORE: 0.015694957190569986

TEST MSG: Fire registry events before preinit and after construct .
GENERATED MSG: Only revert to frozen data on server shutdown on client . Should fix race condition exposed by # 4904

TEST DIFF (one line): diff - - git a / src / main / java / net / minecraftforge / fml / ModLoader . java b / src / main / java / net / minecraftforge / fml / ModLoader . java <nl> index e38e6f3 . . c4f6f62 100644 <nl> - - - a / src / main / java / net / minecraftforge / fml / ModLoader . java <nl> + + + b / src / main / java / net / minecraftforge / fml / ModLoader . java <nl> @ @ - 87 , 6 + 87 , 7 @ @ public class ModLoader <nl> dispatchAndHandleError ( LifecycleEventProvider . CONSTRUCT ) ; <nl> GameData . fireCreateRegistryEvents ( ) ; <nl> CapabilityManager . INSTANCE . injectCapabilities ( modList . getAllScanData ( ) ) ; <nl> + GameData . fireRegistryEvents ( ) ; <nl> dispatchAndHandleError ( LifecycleEventProvider . PREINIT ) ; <nl> DistExecutor . runWhenOn ( Dist . CLIENT , ModLoader : : fireClientEvents ) ; <nl> dispatchAndHandleError ( LifecycleEventProvider . SIDEDINIT ) ;
NEAREST DIFF (one line): diff - - git a / src / main / java / net / minecraftforge / fml / client / FMLClientHandler . java b / src / main / java / net / minecraftforge / fml / client / FMLClientHandler . java <nl> index 32e3bb7 . . 6dbedb1 100644 <nl> - - - a / src / main / java / net / minecraftforge / fml / client / FMLClientHandler . java <nl> + + + b / src / main / java / net / minecraftforge / fml / client / FMLClientHandler . java <nl> @ @ - 705 , 6 + 705 , 8 @ @ public class FMLClientHandler implements IFMLSidedHandler <nl> { <nl> / / ObfuscationReflectionHelper . setPrivateValue ( MinecraftServer . class , server , true , " field _ 71296 " + " _ Q " , " serverIs " + " Running " ) ; <nl> } <nl> + <nl> + GameData . revertToFrozen ( ) ; <nl> } <nl> <nl> @ Override <nl> diff - - git a / src / main / java / net / minecraftforge / fml / common / Loader . java b / src / main / java / net / minecraftforge / fml / common / Loader . java <nl> index 4617283 . . 95c182a 100644 <nl> - - - a / src / main / java / net / minecraftforge / fml / common / Loader . java <nl> + + + b / src / main / java / net / minecraftforge / fml / common / Loader . java <nl> @ @ - 864 , 7 + 864 , 6 @ @ public class Loader <nl> <nl> public void serverStopped ( ) <nl> { <nl> - GameData . revertToFrozen ( ) ; <nl> modController . distributeStateMessage ( LoaderState . SERVER _ STOPPED ) ; <nl> modController . transition ( LoaderState . SERVER _ STOPPED , true ) ; <nl> modController . transition ( LoaderState . AVAILABLE , true ) ;

TEST DIFF:
diff - - git a / src / main / java / net / minecraftforge / fml / ModLoader . java b / src / main / java / net / minecraftforge / fml / ModLoader . java 
 index e38e6f3 . . c4f6f62 100644 
 - - - a / src / main / java / net / minecraftforge / fml / ModLoader . java 
 + + + b / src / main / java / net / minecraftforge / fml / ModLoader . java 
 @ @ - 87 , 6 + 87 , 7 @ @ public class ModLoader 
 dispatchAndHandleError ( LifecycleEventProvider . CONSTRUCT ) ; 
 GameData . fireCreateRegistryEvents ( ) ; 
 CapabilityManager . INSTANCE . injectCapabilities ( modList . getAllScanData ( ) ) ; 
 + GameData . fireRegistryEvents ( ) ; 
 dispatchAndHandleError ( LifecycleEventProvider . PREINIT ) ; 
 DistExecutor . runWhenOn ( Dist . CLIENT , ModLoader : : fireClientEvents ) ; 
 dispatchAndHandleError ( LifecycleEventProvider . SIDEDINIT ) ;

NEAREST DIFF:
diff - - git a / src / main / java / net / minecraftforge / fml / client / FMLClientHandler . java b / src / main / java / net / minecraftforge / fml / client / FMLClientHandler . java 
 index 32e3bb7 . . 6dbedb1 100644 
 - - - a / src / main / java / net / minecraftforge / fml / client / FMLClientHandler . java 
 + + + b / src / main / java / net / minecraftforge / fml / client / FMLClientHandler . java 
 @ @ - 705 , 6 + 705 , 8 @ @ public class FMLClientHandler implements IFMLSidedHandler 
 { 
 / / ObfuscationReflectionHelper . setPrivateValue ( MinecraftServer . class , server , true , " field _ 71296 " + " _ Q " , " serverIs " + " Running " ) ; 
 } 
 + 
 + GameData . revertToFrozen ( ) ; 
 } 
 
 @ Override 
 diff - - git a / src / main / java / net / minecraftforge / fml / common / Loader . java b / src / main / java / net / minecraftforge / fml / common / Loader . java 
 index 4617283 . . 95c182a 100644 
 - - - a / src / main / java / net / minecraftforge / fml / common / Loader . java 
 + + + b / src / main / java / net / minecraftforge / fml / common / Loader . java 
 @ @ - 864 , 7 + 864 , 6 @ @ public class Loader 
 
 public void serverStopped ( ) 
 { 
 - GameData . revertToFrozen ( ) ; 
 modController . distributeStateMessage ( LoaderState . SERVER _ STOPPED ) ; 
 modController . transition ( LoaderState . SERVER _ STOPPED , true ) ; 
 modController . transition ( LoaderState . AVAILABLE , true ) ;
