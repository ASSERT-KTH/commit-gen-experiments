BLEU SCORE: 0.019822566267103433

TEST MSG: Much requested temporary hack for items and TESRs . Context : # 1582 , # 1597 , # 1713 , # 2058 and others .
GENERATED MSG: Added Breaking Animation for Smart Models , Checking each layer .

TEST DIFF (one line): diff - - git a / patches / minecraft / net / minecraft / client / renderer / tileentity / TileEntityItemStackRenderer . java . patch b / patches / minecraft / net / minecraft / client / renderer / tileentity / TileEntityItemStackRenderer . java . patch <nl> new file mode 100644 <nl> index 0000000 . . 3b547aa <nl> - - - / dev / null <nl> + + + b / patches / minecraft / net / minecraft / client / renderer / tileentity / TileEntityItemStackRenderer . java . patch <nl> @ @ - 0 , 0 + 1 , 10 @ @ <nl> + - - - . . / src - base / minecraft / net / minecraft / client / renderer / tileentity / TileEntityItemStackRenderer . java <nl> + + + + . . / src - work / minecraft / net / minecraft / client / renderer / tileentity / TileEntityItemStackRenderer . java <nl> + @ @ - 79 , 6 + 79 , 7 @ @ <nl> + { <nl> + TileEntityRendererDispatcher . field _ 147556 _ a . func _ 147549 _ a ( this . field _ 147718 _ c , 0 . 0D , 0 . 0D , 0 . 0D , 0 . 0F ) ; <nl> + } <nl> + + else if ( block ! = Blocks . field _ 150486 _ ae ) net . minecraftforge . client . ForgeHooksClient . renderTileItem ( p _ 179022 _ 1 _ . func _ 77973 _ b ( ) , p _ 179022 _ 1 _ . func _ 77960 _ j ( ) ) ; <nl> + else <nl> + { <nl> + TileEntityRendererDispatcher . field _ 147556 _ a . func _ 147549 _ a ( this . field _ 147717 _ b , 0 . 0D , 0 . 0D , 0 . 0D , 0 . 0F ) ; <nl> diff - - git a / src / main / java / net / minecraftforge / client / ForgeHooksClient . java b / src / main / java / net / minecraftforge / client / ForgeHooksClient . java <nl> index bd24a5f . . 90369a1 100644 <nl> - - - a / src / main / java / net / minecraftforge / client / ForgeHooksClient . java <nl> + + + b / src / main / java / net / minecraftforge / client / ForgeHooksClient . java <nl> @ @ - 7 , 6 + 7 , 7 @ @ import static org . lwjgl . opengl . GL20 . * ; <nl> <nl> import java . nio . ByteBuffer ; <nl> import java . nio . FloatBuffer ; <nl> + import java . util . Map ; <nl> <nl> import javax . vecmath . Matrix4f ; <nl> import javax . vecmath . Vector3d ; <nl> @ @ - 33 , 6 + 34 , 8 @ @ import net . minecraft . client . renderer . block . model . ItemTransformVec3f ; <nl> import net . minecraft . client . renderer . entity . RenderItem ; <nl> import net . minecraft . client . renderer . texture . TextureManager ; <nl> import net . minecraft . client . renderer . texture . TextureMap ; <nl> + import net . minecraft . client . renderer . tileentity . TileEntityRendererDispatcher ; <nl> + import net . minecraft . client . renderer . tileentity . TileEntitySpecialRenderer ; <nl> import net . minecraft . client . renderer . vertex . VertexFormatElement ; <nl> import net . minecraft . client . renderer . vertex . VertexFormatElement . EnumUsage ; <nl> import net . minecraft . client . resources . I18n ; <nl> @ @ - 44 , 7 + 47 , 9 @ @ import net . minecraft . client . settings . GameSettings ; <nl> import net . minecraft . entity . Entity ; <nl> import net . minecraft . entity . EntityLivingBase ; <nl> import net . minecraft . entity . player . EntityPlayer ; <nl> + import net . minecraft . item . Item ; <nl> import net . minecraft . item . ItemStack ; <nl> + import net . minecraft . tileentity . TileEntity ; <nl> import net . minecraft . util . BlockPos ; <nl> import net . minecraft . util . EnumChatFormatting ; <nl> import net . minecraft . util . EnumWorldBlockLayer ; <nl> @ @ - 79 , 6 + 84 , 8 @ @ import org . lwjgl . opengl . GL11 ; <nl> / / import static net . minecraftforge . client . IItemRenderer . ItemRenderType . * ; <nl> / / import static net . minecraftforge . client . IItemRenderer . ItemRendererHelper . * ; <nl> <nl> + import com . google . common . collect . Maps ; <nl> + <nl> public class ForgeHooksClient <nl> { <nl> / / private static final ResourceLocation ITEM _ GLINT = new ResourceLocation ( " textures / misc / enchanted _ item _ glint . png " ) ; <nl> @ @ - 678 , 4 + 685 , 30 @ @ public class ForgeHooksClient <nl> renderer . putColorRGBA ( renderer . getColorIndex ( i + 1 ) , ncr , ncg , ncb , nca ) ; <nl> } <nl> } <nl> + <nl> + private static Map < Pair < Item , Integer > , Class < ? extends TileEntity > > tileItemMap = Maps . newHashMap ( ) ; <nl> + <nl> + public static void renderTileItem ( Item item , int metadata ) <nl> + { <nl> + Class < ? extends TileEntity > tileClass = tileItemMap . get ( Pair . of ( item , <nl> + metadata ) ) ; <nl> + if ( tileClass ! = null ) <nl> + { <nl> + TileEntitySpecialRenderer r = TileEntityRendererDispatcher . instance <nl> + . getSpecialRendererByClass ( tileClass ) ; <nl> + if ( r ! = null ) <nl> + { <nl> + r . renderTileEntityAt ( null , 0 , 0 , 0 , 0 , - 1 ) ; <nl> + } <nl> + } <nl> + } <nl> + <nl> + / * * <nl> + * @ deprecated Will be removed as soon as possible , hopefully 1 . 9 . <nl> + * / <nl> + @ Deprecated <nl> + public static void registerTESRItemStack ( Item item , int metadata , Class < ? extends TileEntity > TileClass ) <nl> + { <nl> + tileItemMap . put ( Pair . of ( item , metadata ) , TileClass ) ; <nl> + } <nl> } <nl> diff - - git a / src / test / java / net / minecraftforge / debug / ItemTileDebug . java b / src / test / java / net / minecraftforge / debug / ItemTileDebug . java <nl> new file mode 100644 <nl> index 0000000 . . 7c2668c <nl> - - - / dev / null <nl> + + + b / src / test / java / net / minecraftforge / debug / ItemTileDebug . java <nl> @ @ - 0 , 0 + 1 , 137 @ @ <nl> + package net . minecraftforge . debug ; <nl> + <nl> + import net . minecraft . block . BlockContainer ; <nl> + import net . minecraft . block . material . Material ; <nl> + import net . minecraft . client . Minecraft ; <nl> + import net . minecraft . client . renderer . GlStateManager ; <nl> + import net . minecraft . client . renderer . texture . TextureAtlasSprite ; <nl> + import net . minecraft . client . renderer . tileentity . TileEntitySpecialRenderer ; <nl> + import net . minecraft . client . resources . model . IBakedModel ; <nl> + import net . minecraft . client . resources . model . ModelResourceLocation ; <nl> + import net . minecraft . creativetab . CreativeTabs ; <nl> + import net . minecraft . item . Item ; <nl> + import net . minecraft . tileentity . TileEntity ; <nl> + import net . minecraft . world . World ; <nl> + import net . minecraftforge . client . ForgeHooksClient ; <nl> + import net . minecraftforge . client . event . ModelBakeEvent ; <nl> + import net . minecraftforge . client . model . ModelLoader ; <nl> + import net . minecraftforge . common . MinecraftForge ; <nl> + import net . minecraftforge . debug . ModelBakeEventDebug . BakeEventHandler ; <nl> + import net . minecraftforge . debug . ModelBakeEventDebug . ClientProxy ; <nl> + import net . minecraftforge . debug . ModelBakeEventDebug . CustomModel ; <nl> + import net . minecraftforge . fml . client . registry . ClientRegistry ; <nl> + import net . minecraftforge . fml . common . Mod ; <nl> + import net . minecraftforge . fml . common . Mod . EventHandler ; <nl> + import net . minecraftforge . fml . common . SidedProxy ; <nl> + import net . minecraftforge . fml . common . event . FMLPreInitializationEvent ; <nl> + import net . minecraftforge . fml . common . eventhandler . SubscribeEvent ; <nl> + import net . minecraftforge . fml . common . registry . GameRegistry ; <nl> + import static org . lwjgl . opengl . GL11 . * ; <nl> + <nl> + @ Mod ( modid = ItemTileDebug . MODID ) <nl> + public class ItemTileDebug <nl> + { <nl> + public static final String MODID = " ForgeDebugItemTile " ; <nl> + <nl> + private static String blockName = MODID . toLowerCase ( ) + " : " + TestBlock . name ; <nl> + <nl> + @ SidedProxy ( serverSide = " net . minecraftforge . debug . ItemTileDebug $ CommonProxy " , clientSide = " net . minecraftforge . debug . ItemTileDebug $ ClientProxy " ) <nl> + public static CommonProxy proxy ; <nl> + <nl> + @ EventHandler <nl> + public void preInit ( FMLPreInitializationEvent event ) { proxy . preInit ( event ) ; } <nl> + <nl> + public static class CommonProxy <nl> + { <nl> + public void preInit ( FMLPreInitializationEvent event ) <nl> + { <nl> + GameRegistry . registerBlock ( TestBlock . instance , TestBlock . name ) ; <nl> + GameRegistry . registerTileEntity ( CustomTileEntity . class , MODID . toLowerCase ( ) + " : custom _ tile _ entity " ) ; <nl> + } <nl> + } <nl> + <nl> + public static class ClientProxy extends CommonProxy <nl> + { <nl> + private static ModelResourceLocation itemLocation = new ModelResourceLocation ( blockName , " inventory " ) ; <nl> + <nl> + @ Override <nl> + public void preInit ( FMLPreInitializationEvent event ) <nl> + { <nl> + super . preInit ( event ) ; <nl> + ClientRegistry . bindTileEntitySpecialRenderer ( CustomTileEntity . class , TestTESR . instance ) ; <nl> + Item item = Item . getItemFromBlock ( TestBlock . instance ) ; <nl> + ForgeHooksClient . registerTESRItemStack ( item , 0 , CustomTileEntity . class ) ; <nl> + ModelLoader . setCustomModelResourceLocation ( item , 0 , itemLocation ) ; <nl> + MinecraftForge . EVENT _ BUS . register ( BakeEventHandler . instance ) ; <nl> + } <nl> + } <nl> + <nl> + public static class BakeEventHandler <nl> + { <nl> + public static final BakeEventHandler instance = new BakeEventHandler ( ) ; <nl> + <nl> + private BakeEventHandler ( ) { } ; <nl> + <nl> + @ SubscribeEvent <nl> + public void onModelBakeEvent ( ModelBakeEvent event ) <nl> + { <nl> + event . modelManager . getBlockModelShapes ( ) . registerBuiltInBlocks ( TestBlock . instance ) ; <nl> + } <nl> + } <nl> + <nl> + public static class TestTESR extends TileEntitySpecialRenderer <nl> + { <nl> + private static final TestTESR instance = new TestTESR ( ) ; <nl> + <nl> + private TestTESR ( ) { } <nl> + <nl> + @ Override <nl> + public void renderTileEntityAt ( TileEntity p _ 180535 _ 1 _ , double x , double y , double z , float p _ 180535 _ 8 _ , int p _ 180535 _ 9 _ ) <nl> + { <nl> + glPushMatrix ( ) ; <nl> + glTranslated ( x , y , z ) ; <nl> + GlStateManager . disableTexture2D ( ) ; <nl> + GlStateManager . disableLighting ( ) ; <nl> + glColor4f ( . 2f , 1 , . 1f , 1 ) ; <nl> + glBegin ( GL _ QUADS ) ; <nl> + glVertex3f ( 0 , . 5f , 0 ) ; <nl> + glVertex3f ( 0 , . 5f , 1 ) ; <nl> + glVertex3f ( 1 , . 5f , 1 ) ; <nl> + glVertex3f ( 1 , . 5f , 0 ) ; <nl> + glEnd ( ) ; <nl> + glPopMatrix ( ) ; <nl> + GlStateManager . enableTexture2D ( ) ; <nl> + GlStateManager . enableLighting ( ) ; <nl> + } <nl> + } <nl> + <nl> + public static class TestBlock extends BlockContainer <nl> + { <nl> + public static final TestBlock instance = new TestBlock ( ) ; <nl> + public static final String name = " custom _ model _ block " ; <nl> + <nl> + private TestBlock ( ) <nl> + { <nl> + super ( Material . iron ) ; <nl> + setCreativeTab ( CreativeTabs . tabBlock ) ; <nl> + setUnlocalizedName ( MODID + " : " + name ) ; <nl> + } <nl> + <nl> + @ Override <nl> + public boolean isOpaqueCube ( ) { return false ; } <nl> + <nl> + @ Override <nl> + public boolean isFullCube ( ) { return false ; } <nl> + <nl> + @ Override <nl> + public boolean isVisuallyOpaque ( ) { return false ; } <nl> + <nl> + @ Override <nl> + public TileEntity createNewTileEntity ( World world , int meta ) <nl> + { <nl> + return new CustomTileEntity ( ) ; <nl> + } <nl> + } <nl> + <nl> + public static class CustomTileEntity extends TileEntity { } <nl> + } <nl> diff - - git a / src / test / resources / assets / forgedebugitemtile / models / item / custom _ model _ block . json b / src / test / resources / assets / forgedebugitemtile / models / item / custom _ model _ block . json <nl> new file mode 100644 <nl> index 0000000 . . 43a272a <nl> - - - / dev / null <nl> + + + b / src / test / resources / assets / forgedebugitemtile / models / item / custom _ model _ block . json <nl> @ @ - 0 , 0 + 1 , 3 @ @ <nl> + { <nl> + " parent " : " builtin / entity " <nl> + }
NEAREST DIFF (one line): diff - - git a / patches / minecraft / net / minecraft / client / renderer / BlockRendererDispatcher . java . patch b / patches / minecraft / net / minecraft / client / renderer / BlockRendererDispatcher . java . patch <nl> index a24be3d . . 2eef166 100644 <nl> - - - a / patches / minecraft / net / minecraft / client / renderer / BlockRendererDispatcher . java . patch <nl> + + + b / patches / minecraft / net / minecraft / client / renderer / BlockRendererDispatcher . java . patch <nl> @ @ - 1 , 6 + 1 , 31 @ @ <nl> - - - . . / src - base / minecraft / net / minecraft / client / renderer / BlockRendererDispatcher . java <nl> + + + . . / src - work / minecraft / net / minecraft / client / renderer / BlockRendererDispatcher . java <nl> - @ @ - 129 , 6 + 129 , 12 @ @ <nl> + @ @ - 49 , 6 + 49 , 24 @ @ <nl> + { <nl> + p _ 175020 _ 1 _ = block . func _ 176221 _ a ( p _ 175020 _ 1 _ , p _ 175020 _ 4 _ , p _ 175020 _ 2 _ ) ; <nl> + IBakedModel ibakedmodel = this . field _ 175028 _ a . func _ 178125 _ b ( p _ 175020 _ 1 _ ) ; <nl> + + <nl> + + if ( ibakedmodel instanceof net . minecraftforge . client . model . ISmartBlockModel ) <nl> + + { <nl> + + IBlockState extendedState = block . getExtendedState ( p _ 175020 _ 1 _ , p _ 175020 _ 4 _ , p _ 175020 _ 2 _ ) ; <nl> + + for ( net . minecraft . util . EnumWorldBlockLayer layer : net . minecraft . util . EnumWorldBlockLayer . values ( ) ) <nl> + + { <nl> + + if ( block . canRenderInLayer ( layer ) ) <nl> + + { <nl> + + net . minecraftforge . client . ForgeHooksClient . setRenderLayer ( layer ) ; <nl> + + <nl> + + IBakedModel targetLayer = ( ( net . minecraftforge . client . model . ISmartBlockModel ) ibakedmodel ) . handleBlockState ( extendedState ) ; <nl> + + IBakedModel damageModel = ( new SimpleBakedModel . Builder ( targetLayer , p _ 175020 _ 3 _ ) ) . func _ 177645 _ b ( ) ; <nl> + + this . field _ 175027 _ c . func _ 178259 _ a ( p _ 175020 _ 4 _ , damageModel , p _ 175020 _ 1 _ , p _ 175020 _ 2 _ , Tessellator . func _ 178181 _ a ( ) . func _ 178180 _ c ( ) ) ; <nl> + + } <nl> + + } <nl> + + return ; <nl> + + } <nl> + + <nl> + IBakedModel ibakedmodel1 = ( new SimpleBakedModel . Builder ( ibakedmodel , p _ 175020 _ 3 _ ) ) . func _ 177645 _ b ( ) ; <nl> + this . field _ 175027 _ c . func _ 178259 _ a ( p _ 175020 _ 4 _ , ibakedmodel1 , p _ 175020 _ 1 _ , p _ 175020 _ 2 _ , Tessellator . func _ 178181 _ a ( ) . func _ 178180 _ c ( ) ) ; <nl> + } <nl> + @ @ - 129 , 6 + 147 , 12 @ @ <nl> ibakedmodel = ( ( WeightedBakedModel ) ibakedmodel ) . func _ 177564 _ a ( MathHelper . func _ 180186 _ a ( p _ 175022 _ 3 _ ) ) ; <nl> } <nl> <nl> diff - - git a / src / test / java / net / minecraftforge / debug / LayerBreakingTest . java b / src / test / java / net / minecraftforge / debug / LayerBreakingTest . java <nl> new file mode 100644 <nl> index 0000000 . . 593101c <nl> - - - / dev / null <nl> + + + b / src / test / java / net / minecraftforge / debug / LayerBreakingTest . java <nl> @ @ - 0 , 0 + 1 , 265 @ @ <nl> + <nl> + package net . minecraftforge . debug ; <nl> + <nl> + import java . util . ArrayList ; <nl> + import java . util . Collections ; <nl> + import java . util . List ; <nl> + <nl> + import com . google . common . primitives . Ints ; <nl> + <nl> + import net . minecraft . block . Block ; <nl> + import net . minecraft . block . material . Material ; <nl> + import net . minecraft . block . state . IBlockState ; <nl> + import net . minecraft . client . Minecraft ; <nl> + import net . minecraft . client . renderer . block . model . BakedQuad ; <nl> + import net . minecraft . client . renderer . block . model . ItemCameraTransforms ; <nl> + import net . minecraft . client . renderer . texture . TextureAtlasSprite ; <nl> + import net . minecraft . client . renderer . vertex . VertexFormat ; <nl> + import net . minecraft . client . resources . model . IBakedModel ; <nl> + import net . minecraft . client . resources . model . ModelResourceLocation ; <nl> + import net . minecraft . creativetab . CreativeTabs ; <nl> + import net . minecraft . init . Blocks ; <nl> + import net . minecraft . util . EnumFacing ; <nl> + import net . minecraft . util . EnumWorldBlockLayer ; <nl> + import net . minecraftforge . client . event . ModelBakeEvent ; <nl> + import net . minecraftforge . client . model . IFlexibleBakedModel ; <nl> + import net . minecraftforge . client . model . IModelPart ; <nl> + import net . minecraftforge . client . model . IModelState ; <nl> + import net . minecraftforge . client . model . ISmartBlockModel ; <nl> + import net . minecraftforge . client . model . TRSRTransformation ; <nl> + import net . minecraftforge . common . MinecraftForge ; <nl> + import net . minecraftforge . fml . common . Mod ; <nl> + import net . minecraftforge . fml . common . Mod . EventHandler ; <nl> + import net . minecraftforge . fml . common . event . FMLInitializationEvent ; <nl> + import net . minecraftforge . fml . common . eventhandler . SubscribeEvent ; <nl> + import net . minecraftforge . fml . common . registry . GameRegistry ; <nl> + import net . minecraftforge . fml . relauncher . Side ; <nl> + <nl> + <nl> + @ SuppressWarnings ( " deprecation " ) <nl> + @ Mod ( modid = " LayerBreakingTest " , name = " LayerBreakingTest " , version = " 0 . 0 . 0 " ) <nl> + public class LayerBreakingTest <nl> + { <nl> + <nl> + public static final boolean ENABLE = true ; <nl> + public static TestBlock testBlock ; <nl> + <nl> + class TestBakedModel implements IFlexibleBakedModel <nl> + { <nl> + <nl> + TextureAtlasSprite texture ; <nl> + List < BakedQuad > list = new ArrayList < BakedQuad > ( ) ; <nl> + <nl> + private int [ ] vertexToInts ( <nl> + float x , <nl> + float y , <nl> + float z , <nl> + int color , <nl> + TextureAtlasSprite texture , <nl> + int u , <nl> + int v ) <nl> + { <nl> + return new int [ ] { Float . floatToRawIntBits ( x ) , Float . floatToRawIntBits ( y ) , Float . floatToRawIntBits ( z ) , color , Float . floatToRawIntBits ( texture . getInterpolatedU ( u ) ) , Float . floatToRawIntBits ( texture . getInterpolatedV ( v ) ) , 0 } ; <nl> + } <nl> + <nl> + public TestBakedModel ( <nl> + TextureAtlasSprite sprite , <nl> + boolean top ) <nl> + { <nl> + texture = sprite ; <nl> + if ( top ) <nl> + { <nl> + list . add ( new BakedQuad ( Ints . concat ( vertexToInts ( 0 . 5f , 1 . 0f , 0 , - 1 , texture , 8 , 0 ) , vertexToInts ( 0 . 5f , 1 . 0f , 1 , - 1 , texture , 8 , 16 ) , vertexToInts ( 1 , 1 . 0f , 1 , - 1 , texture , 16 , 16 ) , vertexToInts ( 1 , 1 . 0f , 0 , - 1 , texture , 16 , 0 ) ) , - 1 , EnumFacing . UP ) ) ; <nl> + } <nl> + else <nl> + { <nl> + list . add ( new BakedQuad ( Ints . concat ( vertexToInts ( 0 , 1 . 0f , 0 , - 1 , texture , 0 , 0 ) , vertexToInts ( 0 , 1 . 0f , 1 , - 1 , texture , 0 , 16 ) , vertexToInts ( 0 . 5f , 1 . 0f , 1 , - 1 , texture , 8 , 16 ) , vertexToInts ( 0 . 5f , 1 . 0f , 0 , - 1 , texture , 8 , 0 ) ) , - 1 , EnumFacing . DOWN ) ) ; <nl> + } <nl> + } <nl> + <nl> + @ Override <nl> + public boolean isAmbientOcclusion ( ) <nl> + { <nl> + return true ; <nl> + } <nl> + <nl> + @ Override <nl> + public boolean isGui3d ( ) <nl> + { <nl> + return true ; <nl> + } <nl> + <nl> + @ Override <nl> + public boolean isBuiltInRenderer ( ) <nl> + { <nl> + return false ; <nl> + } <nl> + <nl> + @ Override <nl> + public TextureAtlasSprite getTexture ( ) <nl> + { <nl> + return texture ; <nl> + } <nl> + <nl> + @ Override <nl> + public ItemCameraTransforms getItemCameraTransforms ( ) <nl> + { <nl> + return ItemCameraTransforms . DEFAULT ; <nl> + } <nl> + <nl> + @ Override <nl> + public List < BakedQuad > getFaceQuads ( <nl> + EnumFacing side ) <nl> + { <nl> + return Collections . emptyList ( ) ; <nl> + } <nl> + <nl> + @ Override <nl> + public List < BakedQuad > getGeneralQuads ( ) <nl> + { <nl> + return list ; <nl> + } <nl> + <nl> + @ Override <nl> + public VertexFormat getFormat ( ) <nl> + { <nl> + return null ; <nl> + } <nl> + <nl> + } ; <nl> + <nl> + class TestBlock extends Block <nl> + { <nl> + <nl> + protected TestBlock ( ) <nl> + { <nl> + super ( Material . glass ) ; <nl> + setHardness ( 7 ) ; <nl> + setCreativeTab ( CreativeTabs . tabBlock ) ; <nl> + } <nl> + <nl> + @ Override <nl> + public boolean isOpaqueCube ( ) <nl> + { <nl> + return false ; <nl> + } <nl> + <nl> + public boolean isFullCube ( ) <nl> + { <nl> + return false ; <nl> + } <nl> + <nl> + @ Override <nl> + public boolean canRenderInLayer ( <nl> + EnumWorldBlockLayer layer ) <nl> + { <nl> + return layer = = EnumWorldBlockLayer . SOLID | | layer = = EnumWorldBlockLayer . TRANSLUCENT ; <nl> + } <nl> + <nl> + } ; <nl> + <nl> + class SmartModel implements IBakedModel , ISmartBlockModel <nl> + { <nl> + <nl> + IFlexibleBakedModel solid ; <nl> + IFlexibleBakedModel translucent ; <nl> + <nl> + private class DefState implements IModelState <nl> + { <nl> + <nl> + @ Override <nl> + public TRSRTransformation apply ( <nl> + IModelPart part ) <nl> + { <nl> + return TRSRTransformation . identity ( ) ; <nl> + } <nl> + <nl> + } ; <nl> + <nl> + @ Override <nl> + public List getFaceQuads ( <nl> + EnumFacing p _ 177551 _ 1 _ ) <nl> + { <nl> + return Collections . emptyList ( ) ; <nl> + } <nl> + <nl> + @ Override <nl> + public List getGeneralQuads ( ) <nl> + { <nl> + return Collections . emptyList ( ) ; <nl> + } <nl> + <nl> + @ Override <nl> + public boolean isAmbientOcclusion ( ) <nl> + { <nl> + return true ; <nl> + } <nl> + <nl> + @ Override <nl> + public boolean isGui3d ( ) <nl> + { <nl> + return true ; <nl> + } <nl> + <nl> + @ Override <nl> + public boolean isBuiltInRenderer ( ) <nl> + { <nl> + return false ; <nl> + } <nl> + <nl> + @ Override <nl> + public TextureAtlasSprite getTexture ( ) <nl> + { <nl> + return null ; <nl> + } <nl> + <nl> + @ Override <nl> + public ItemCameraTransforms getItemCameraTransforms ( ) <nl> + { <nl> + return ItemCameraTransforms . DEFAULT ; <nl> + } <nl> + <nl> + @ Override <nl> + public IBakedModel handleBlockState ( <nl> + IBlockState state ) <nl> + { <nl> + if ( solid = = null ) <nl> + { <nl> + TextureAtlasSprite a = Minecraft . getMinecraft ( ) . getBlockRendererDispatcher ( ) . getBlockModelShapes ( ) . getModelForState ( Blocks . stained _ glass . getStateFromMeta ( 3 ) ) . getTexture ( ) ; <nl> + TextureAtlasSprite b = Minecraft . getMinecraft ( ) . getBlockRendererDispatcher ( ) . getBlockModelShapes ( ) . getModelForState ( Blocks . cobblestone . getDefaultState ( ) ) . getTexture ( ) ; <nl> + <nl> + translucent = new TestBakedModel ( a , true ) ; <nl> + solid = new TestBakedModel ( b , false ) ; <nl> + } <nl> + <nl> + if ( net . minecraftforge . client . MinecraftForgeClient . getRenderLayer ( ) = = EnumWorldBlockLayer . SOLID ) <nl> + { <nl> + return solid ; <nl> + } <nl> + else <nl> + { <nl> + return translucent ; <nl> + } <nl> + } <nl> + <nl> + } ; <nl> + <nl> + @ SubscribeEvent <nl> + public void onModelBakeEvent ( <nl> + ModelBakeEvent event ) <nl> + { <nl> + event . modelRegistry . putObject ( new ModelResourceLocation ( " LayerBreakingTest : LayerBreakingTest " ) , new SmartModel ( ) ) ; <nl> + } <nl> + <nl> + @ EventHandler <nl> + public void init ( <nl> + FMLInitializationEvent event ) <nl> + { <nl> + if ( ENABLE & & event . getSide ( ) = = Side . CLIENT ) <nl> + { <nl> + MinecraftForge . EVENT _ BUS . register ( this ) ; <nl> + GameRegistry . registerBlock ( testBlock = new TestBlock ( ) , " LayerBreakingTest " ) ; <nl> + } <nl> + } <nl> + <nl> + }

TEST DIFF:
diff - - git a / patches / minecraft / net / minecraft / client / renderer / tileentity / TileEntityItemStackRenderer . java . patch b / patches / minecraft / net / minecraft / client / renderer / tileentity / TileEntityItemStackRenderer . java . patch 
 new file mode 100644 
 index 0000000 . . 3b547aa 
 - - - / dev / null 
 + + + b / patches / minecraft / net / minecraft / client / renderer / tileentity / TileEntityItemStackRenderer . java . patch 
 @ @ - 0 , 0 + 1 , 10 @ @ 
 + - - - . . / src - base / minecraft / net / minecraft / client / renderer / tileentity / TileEntityItemStackRenderer . java 
 + + + + . . / src - work / minecraft / net / minecraft / client / renderer / tileentity / TileEntityItemStackRenderer . java 
 + @ @ - 79 , 6 + 79 , 7 @ @ 
 + { 
 + TileEntityRendererDispatcher . field _ 147556 _ a . func _ 147549 _ a ( this . field _ 147718 _ c , 0 . 0D , 0 . 0D , 0 . 0D , 0 . 0F ) ; 
 + } 
 + + else if ( block ! = Blocks . field _ 150486 _ ae ) net . minecraftforge . client . ForgeHooksClient . renderTileItem ( p _ 179022 _ 1 _ . func _ 77973 _ b ( ) , p _ 179022 _ 1 _ . func _ 77960 _ j ( ) ) ; 
 + else 
 + { 
 + TileEntityRendererDispatcher . field _ 147556 _ a . func _ 147549 _ a ( this . field _ 147717 _ b , 0 . 0D , 0 . 0D , 0 . 0D , 0 . 0F ) ; 
 diff - - git a / src / main / java / net / minecraftforge / client / ForgeHooksClient . java b / src / main / java / net / minecraftforge / client / ForgeHooksClient . java 
 index bd24a5f . . 90369a1 100644 
 - - - a / src / main / java / net / minecraftforge / client / ForgeHooksClient . java 
 + + + b / src / main / java / net / minecraftforge / client / ForgeHooksClient . java 
 @ @ - 7 , 6 + 7 , 7 @ @ import static org . lwjgl . opengl . GL20 . * ; 
 
 import java . nio . ByteBuffer ; 
 import java . nio . FloatBuffer ; 
 + import java . util . Map ; 
 
 import javax . vecmath . Matrix4f ; 
 import javax . vecmath . Vector3d ; 
 @ @ - 33 , 6 + 34 , 8 @ @ import net . minecraft . client . renderer . block . model . ItemTransformVec3f ; 
 import net . minecraft . client . renderer . entity . RenderItem ; 
 import net . minecraft . client . renderer . texture . TextureManager ; 
 import net . minecraft . client . renderer . texture . TextureMap ; 
 + import net . minecraft . client . renderer . tileentity . TileEntityRendererDispatcher ; 
 + import net . minecraft . client . renderer . tileentity . TileEntitySpecialRenderer ; 
 import net . minecraft . client . renderer . vertex . VertexFormatElement ; 
 import net . minecraft . client . renderer . vertex . VertexFormatElement . EnumUsage ; 
 import net . minecraft . client . resources . I18n ; 
 @ @ - 44 , 7 + 47 , 9 @ @ import net . minecraft . client . settings . GameSettings ; 
 import net . minecraft . entity . Entity ; 
 import net . minecraft . entity . EntityLivingBase ; 
 import net . minecraft . entity . player . EntityPlayer ; 
 + import net . minecraft . item . Item ; 
 import net . minecraft . item . ItemStack ; 
 + import net . minecraft . tileentity . TileEntity ; 
 import net . minecraft . util . BlockPos ; 
 import net . minecraft . util . EnumChatFormatting ; 
 import net . minecraft . util . EnumWorldBlockLayer ; 
 @ @ - 79 , 6 + 84 , 8 @ @ import org . lwjgl . opengl . GL11 ; 
 / / import static net . minecraftforge . client . IItemRenderer . ItemRenderType . * ; 
 / / import static net . minecraftforge . client . IItemRenderer . ItemRendererHelper . * ; 
 
 + import com . google . common . collect . Maps ; 
 + 
 public class ForgeHooksClient 
 { 
 / / private static final ResourceLocation ITEM _ GLINT = new ResourceLocation ( " textures / misc / enchanted _ item _ glint . png " ) ; 
 @ @ - 678 , 4 + 685 , 30 @ @ public class ForgeHooksClient 
 renderer . putColorRGBA ( renderer . getColorIndex ( i + 1 ) , ncr , ncg , ncb , nca ) ; 
 } 
 } 
 + 
 + private static Map < Pair < Item , Integer > , Class < ? extends TileEntity > > tileItemMap = Maps . newHashMap ( ) ; 
 + 
 + public static void renderTileItem ( Item item , int metadata ) 
 + { 
 + Class < ? extends TileEntity > tileClass = tileItemMap . get ( Pair . of ( item , 
 + metadata ) ) ; 
 + if ( tileClass ! = null ) 
 + { 
 + TileEntitySpecialRenderer r = TileEntityRendererDispatcher . instance 
 + . getSpecialRendererByClass ( tileClass ) ; 
 + if ( r ! = null ) 
 + { 
 + r . renderTileEntityAt ( null , 0 , 0 , 0 , 0 , - 1 ) ; 
 + } 
 + } 
 + } 
 + 
 + / * * 
 + * @ deprecated Will be removed as soon as possible , hopefully 1 . 9 . 
 + * / 
 + @ Deprecated 
 + public static void registerTESRItemStack ( Item item , int metadata , Class < ? extends TileEntity > TileClass ) 
 + { 
 + tileItemMap . put ( Pair . of ( item , metadata ) , TileClass ) ; 
 + } 
 } 
 diff - - git a / src / test / java / net / minecraftforge / debug / ItemTileDebug . java b / src / test / java / net / minecraftforge / debug / ItemTileDebug . java 
 new file mode 100644 
 index 0000000 . . 7c2668c 
 - - - / dev / null 
 + + + b / src / test / java / net / minecraftforge / debug / ItemTileDebug . java 
 @ @ - 0 , 0 + 1 , 137 @ @ 
 + package net . minecraftforge . debug ; 
 + 
 + import net . minecraft . block . BlockContainer ; 
 + import net . minecraft . block . material . Material ; 
 + import net . minecraft . client . Minecraft ; 
 + import net . minecraft . client . renderer . GlStateManager ; 
 + import net . minecraft . client . renderer . texture . TextureAtlasSprite ; 
 + import net . minecraft . client . renderer . tileentity . TileEntitySpecialRenderer ; 
 + import net . minecraft . client . resources . model . IBakedModel ; 
 + import net . minecraft . client . resources . model . ModelResourceLocation ; 
 + import net . minecraft . creativetab . CreativeTabs ; 
 + import net . minecraft . item . Item ; 
 + import net . minecraft . tileentity . TileEntity ; 
 + import net . minecraft . world . World ; 
 + import net . minecraftforge . client . ForgeHooksClient ; 
 + import net . minecraftforge . client . event . ModelBakeEvent ; 
 + import net . minecraftforge . client . model . ModelLoader ; 
 + import net . minecraftforge . common . MinecraftForge ; 
 + import net . minecraftforge . debug . ModelBakeEventDebug . BakeEventHandler ; 
 + import net . minecraftforge . debug . ModelBakeEventDebug . ClientProxy ; 
 + import net . minecraftforge . debug . ModelBakeEventDebug . CustomModel ; 
 + import net . minecraftforge . fml . client . registry . ClientRegistry ; 
 + import net . minecraftforge . fml . common . Mod ; 
 + import net . minecraftforge . fml . common . Mod . EventHandler ; 
 + import net . minecraftforge . fml . common . SidedProxy ; 
 + import net . minecraftforge . fml . common . event . FMLPreInitializationEvent ; 
 + import net . minecraftforge . fml . common . eventhandler . SubscribeEvent ; 
 + import net . minecraftforge . fml . common . registry . GameRegistry ; 
 + import static org . lwjgl . opengl . GL11 . * ; 
 + 
 + @ Mod ( modid = ItemTileDebug . MODID ) 
 + public class ItemTileDebug 
 + { 
 + public static final String MODID = " ForgeDebugItemTile " ; 
 + 
 + private static String blockName = MODID . toLowerCase ( ) + " : " + TestBlock . name ; 
 + 
 + @ SidedProxy ( serverSide = " net . minecraftforge . debug . ItemTileDebug $ CommonProxy " , clientSide = " net . minecraftforge . debug . ItemTileDebug $ ClientProxy " ) 
 + public static CommonProxy proxy ; 
 + 
 + @ EventHandler 
 + public void preInit ( FMLPreInitializationEvent event ) { proxy . preInit ( event ) ; } 
 + 
 + public static class CommonProxy 
 + { 
 + public void preInit ( FMLPreInitializationEvent event ) 
 + { 
 + GameRegistry . registerBlock ( TestBlock . instance , TestBlock . name ) ; 
 + GameRegistry . registerTileEntity ( CustomTileEntity . class , MODID . toLowerCase ( ) + " : custom _ tile _ entity " ) ; 
 + } 
 + } 
 + 
 + public static class ClientProxy extends CommonProxy 
 + { 
 + private static ModelResourceLocation itemLocation = new ModelResourceLocation ( blockName , " inventory " ) ; 
 + 
 + @ Override 
 + public void preInit ( FMLPreInitializationEvent event ) 
 + { 
 + super . preInit ( event ) ; 
 + ClientRegistry . bindTileEntitySpecialRenderer ( CustomTileEntity . class , TestTESR . instance ) ; 
 + Item item = Item . getItemFromBlock ( TestBlock . instance ) ; 
 + ForgeHooksClient . registerTESRItemStack ( item , 0 , CustomTileEntity . class ) ; 
 + ModelLoader . setCustomModelResourceLocation ( item , 0 , itemLocation ) ; 
 + MinecraftForge . EVENT _ BUS . register ( BakeEventHandler . instance ) ; 
 + } 
 + } 
 + 
 + public static class BakeEventHandler 
 + { 
 + public static final BakeEventHandler instance = new BakeEventHandler ( ) ; 
 + 
 + private BakeEventHandler ( ) { } ; 
 + 
 + @ SubscribeEvent 
 + public void onModelBakeEvent ( ModelBakeEvent event ) 
 + { 
 + event . modelManager . getBlockModelShapes ( ) . registerBuiltInBlocks ( TestBlock . instance ) ; 
 + } 
 + } 
 + 
 + public static class TestTESR extends TileEntitySpecialRenderer 
 + { 
 + private static final TestTESR instance = new TestTESR ( ) ; 
 + 
 + private TestTESR ( ) { } 
 + 
 + @ Override 
 + public void renderTileEntityAt ( TileEntity p _ 180535 _ 1 _ , double x , double y , double z , float p _ 180535 _ 8 _ , int p _ 180535 _ 9 _ ) 
 + { 
 + glPushMatrix ( ) ; 
 + glTranslated ( x , y , z ) ; 
 + GlStateManager . disableTexture2D ( ) ; 
 + GlStateManager . disableLighting ( ) ; 
 + glColor4f ( . 2f , 1 , . 1f , 1 ) ; 
 + glBegin ( GL _ QUADS ) ; 
 + glVertex3f ( 0 , . 5f , 0 ) ; 
 + glVertex3f ( 0 , . 5f , 1 ) ; 
 + glVertex3f ( 1 , . 5f , 1 ) ; 
 + glVertex3f ( 1 , . 5f , 0 ) ; 
 + glEnd ( ) ; 
 + glPopMatrix ( ) ; 
 + GlStateManager . enableTexture2D ( ) ; 
 + GlStateManager . enableLighting ( ) ; 
 + } 
 + } 
 + 
 + public static class TestBlock extends BlockContainer 
 + { 
 + public static final TestBlock instance = new TestBlock ( ) ; 
 + public static final String name = " custom _ model _ block " ; 
 + 
 + private TestBlock ( ) 
 + { 
 + super ( Material . iron ) ; 
 + setCreativeTab ( CreativeTabs . tabBlock ) ; 
 + setUnlocalizedName ( MODID + " : " + name ) ; 
 + } 
 + 
 + @ Override 
 + public boolean isOpaqueCube ( ) { return false ; } 
 + 
 + @ Override 
 + public boolean isFullCube ( ) { return false ; } 
 + 
 + @ Override 
 + public boolean isVisuallyOpaque ( ) { return false ; } 
 + 
 + @ Override 
 + public TileEntity createNewTileEntity ( World world , int meta ) 
 + { 
 + return new CustomTileEntity ( ) ; 
 + } 
 + } 
 + 
 + public static class CustomTileEntity extends TileEntity { } 
 + } 
 diff - - git a / src / test / resources / assets / forgedebugitemtile / models / item / custom _ model _ block . json b / src / test / resources / assets / forgedebugitemtile / models / item / custom _ model _ block . json 
 new file mode 100644 
 index 0000000 . . 43a272a 
 - - - / dev / null 
 + + + b / src / test / resources / assets / forgedebugitemtile / models / item / custom _ model _ block . json 
 @ @ - 0 , 0 + 1 , 3 @ @ 
 + { 
 + " parent " : " builtin / entity " 
 + }

NEAREST DIFF:
diff - - git a / patches / minecraft / net / minecraft / client / renderer / BlockRendererDispatcher . java . patch b / patches / minecraft / net / minecraft / client / renderer / BlockRendererDispatcher . java . patch 
 index a24be3d . . 2eef166 100644 
 - - - a / patches / minecraft / net / minecraft / client / renderer / BlockRendererDispatcher . java . patch 
 + + + b / patches / minecraft / net / minecraft / client / renderer / BlockRendererDispatcher . java . patch 
 @ @ - 1 , 6 + 1 , 31 @ @ 
 - - - . . / src - base / minecraft / net / minecraft / client / renderer / BlockRendererDispatcher . java 
 + + + . . / src - work / minecraft / net / minecraft / client / renderer / BlockRendererDispatcher . java 
 - @ @ - 129 , 6 + 129 , 12 @ @ 
 + @ @ - 49 , 6 + 49 , 24 @ @ 
 + { 
 + p _ 175020 _ 1 _ = block . func _ 176221 _ a ( p _ 175020 _ 1 _ , p _ 175020 _ 4 _ , p _ 175020 _ 2 _ ) ; 
 + IBakedModel ibakedmodel = this . field _ 175028 _ a . func _ 178125 _ b ( p _ 175020 _ 1 _ ) ; 
 + + 
 + + if ( ibakedmodel instanceof net . minecraftforge . client . model . ISmartBlockModel ) 
 + + { 
 + + IBlockState extendedState = block . getExtendedState ( p _ 175020 _ 1 _ , p _ 175020 _ 4 _ , p _ 175020 _ 2 _ ) ; 
 + + for ( net . minecraft . util . EnumWorldBlockLayer layer : net . minecraft . util . EnumWorldBlockLayer . values ( ) ) 
 + + { 
 + + if ( block . canRenderInLayer ( layer ) ) 
 + + { 
 + + net . minecraftforge . client . ForgeHooksClient . setRenderLayer ( layer ) ; 
 + + 
 + + IBakedModel targetLayer = ( ( net . minecraftforge . client . model . ISmartBlockModel ) ibakedmodel ) . handleBlockState ( extendedState ) ; 
 + + IBakedModel damageModel = ( new SimpleBakedModel . Builder ( targetLayer , p _ 175020 _ 3 _ ) ) . func _ 177645 _ b ( ) ; 
 + + this . field _ 175027 _ c . func _ 178259 _ a ( p _ 175020 _ 4 _ , damageModel , p _ 175020 _ 1 _ , p _ 175020 _ 2 _ , Tessellator . func _ 178181 _ a ( ) . func _ 178180 _ c ( ) ) ; 
 + + } 
 + + } 
 + + return ; 
 + + } 
 + + 
 + IBakedModel ibakedmodel1 = ( new SimpleBakedModel . Builder ( ibakedmodel , p _ 175020 _ 3 _ ) ) . func _ 177645 _ b ( ) ; 
 + this . field _ 175027 _ c . func _ 178259 _ a ( p _ 175020 _ 4 _ , ibakedmodel1 , p _ 175020 _ 1 _ , p _ 175020 _ 2 _ , Tessellator . func _ 178181 _ a ( ) . func _ 178180 _ c ( ) ) ; 
 + } 
 + @ @ - 129 , 6 + 147 , 12 @ @ 
 ibakedmodel = ( ( WeightedBakedModel ) ibakedmodel ) . func _ 177564 _ a ( MathHelper . func _ 180186 _ a ( p _ 175022 _ 3 _ ) ) ; 
 } 
 
 diff - - git a / src / test / java / net / minecraftforge / debug / LayerBreakingTest . java b / src / test / java / net / minecraftforge / debug / LayerBreakingTest . java 
 new file mode 100644 
 index 0000000 . . 593101c 
 - - - / dev / null 
 + + + b / src / test / java / net / minecraftforge / debug / LayerBreakingTest . java 
 @ @ - 0 , 0 + 1 , 265 @ @ 
 + 
 + package net . minecraftforge . debug ; 
 + 
 + import java . util . ArrayList ; 
 + import java . util . Collections ; 
 + import java . util . List ; 
 + 
 + import com . google . common . primitives . Ints ; 
 + 
 + import net . minecraft . block . Block ; 
 + import net . minecraft . block . material . Material ; 
 + import net . minecraft . block . state . IBlockState ; 
 + import net . minecraft . client . Minecraft ; 
 + import net . minecraft . client . renderer . block . model . BakedQuad ; 
 + import net . minecraft . client . renderer . block . model . ItemCameraTransforms ; 
 + import net . minecraft . client . renderer . texture . TextureAtlasSprite ; 
 + import net . minecraft . client . renderer . vertex . VertexFormat ; 
 + import net . minecraft . client . resources . model . IBakedModel ; 
 + import net . minecraft . client . resources . model . ModelResourceLocation ; 
 + import net . minecraft . creativetab . CreativeTabs ; 
 + import net . minecraft . init . Blocks ; 
 + import net . minecraft . util . EnumFacing ; 
 + import net . minecraft . util . EnumWorldBlockLayer ; 
 + import net . minecraftforge . client . event . ModelBakeEvent ; 
 + import net . minecraftforge . client . model . IFlexibleBakedModel ; 
 + import net . minecraftforge . client . model . IModelPart ; 
 + import net . minecraftforge . client . model . IModelState ; 
 + import net . minecraftforge . client . model . ISmartBlockModel ; 
 + import net . minecraftforge . client . model . TRSRTransformation ; 
 + import net . minecraftforge . common . MinecraftForge ; 
 + import net . minecraftforge . fml . common . Mod ; 
 + import net . minecraftforge . fml . common . Mod . EventHandler ; 
 + import net . minecraftforge . fml . common . event . FMLInitializationEvent ; 
 + import net . minecraftforge . fml . common . eventhandler . SubscribeEvent ; 
 + import net . minecraftforge . fml . common . registry . GameRegistry ; 
 + import net . minecraftforge . fml . relauncher . Side ; 
 + 
 + 
 + @ SuppressWarnings ( " deprecation " ) 
 + @ Mod ( modid = " LayerBreakingTest " , name = " LayerBreakingTest " , version = " 0 . 0 . 0 " ) 
 + public class LayerBreakingTest 
 + { 
 + 
 + public static final boolean ENABLE = true ; 
 + public static TestBlock testBlock ; 
 + 
 + class TestBakedModel implements IFlexibleBakedModel 
 + { 
 + 
 + TextureAtlasSprite texture ; 
 + List < BakedQuad > list = new ArrayList < BakedQuad > ( ) ; 
 + 
 + private int [ ] vertexToInts ( 
 + float x , 
 + float y , 
 + float z , 
 + int color , 
 + TextureAtlasSprite texture , 
 + int u , 
 + int v ) 
 + { 
 + return new int [ ] { Float . floatToRawIntBits ( x ) , Float . floatToRawIntBits ( y ) , Float . floatToRawIntBits ( z ) , color , Float . floatToRawIntBits ( texture . getInterpolatedU ( u ) ) , Float . floatToRawIntBits ( texture . getInterpolatedV ( v ) ) , 0 } ; 
 + } 
 + 
 + public TestBakedModel ( 
 + TextureAtlasSprite sprite , 
 + boolean top ) 
 + { 
 + texture = sprite ; 
 + if ( top ) 
 + { 
 + list . add ( new BakedQuad ( Ints . concat ( vertexToInts ( 0 . 5f , 1 . 0f , 0 , - 1 , texture , 8 , 0 ) , vertexToInts ( 0 . 5f , 1 . 0f , 1 , - 1 , texture , 8 , 16 ) , vertexToInts ( 1 , 1 . 0f , 1 , - 1 , texture , 16 , 16 ) , vertexToInts ( 1 , 1 . 0f , 0 , - 1 , texture , 16 , 0 ) ) , - 1 , EnumFacing . UP ) ) ; 
 + } 
 + else 
 + { 
 + list . add ( new BakedQuad ( Ints . concat ( vertexToInts ( 0 , 1 . 0f , 0 , - 1 , texture , 0 , 0 ) , vertexToInts ( 0 , 1 . 0f , 1 , - 1 , texture , 0 , 16 ) , vertexToInts ( 0 . 5f , 1 . 0f , 1 , - 1 , texture , 8 , 16 ) , vertexToInts ( 0 . 5f , 1 . 0f , 0 , - 1 , texture , 8 , 0 ) ) , - 1 , EnumFacing . DOWN ) ) ; 
 + } 
 + } 
 + 
 + @ Override 
 + public boolean isAmbientOcclusion ( ) 
 + { 
 + return true ; 
 + } 
 + 
 + @ Override 
 + public boolean isGui3d ( ) 
 + { 
 + return true ; 
 + } 
 + 
 + @ Override 
 + public boolean isBuiltInRenderer ( ) 
 + { 
 + return false ; 
 + } 
 + 
 + @ Override 
 + public TextureAtlasSprite getTexture ( ) 
 + { 
 + return texture ; 
 + } 
 + 
 + @ Override 
 + public ItemCameraTransforms getItemCameraTransforms ( ) 
 + { 
 + return ItemCameraTransforms . DEFAULT ; 
 + } 
 + 
 + @ Override 
 + public List < BakedQuad > getFaceQuads ( 
 + EnumFacing side ) 
 + { 
 + return Collections . emptyList ( ) ; 
 + } 
 + 
 + @ Override 
 + public List < BakedQuad > getGeneralQuads ( ) 
 + { 
 + return list ; 
 + } 
 + 
 + @ Override 
 + public VertexFormat getFormat ( ) 
 + { 
 + return null ; 
 + } 
 + 
 + } ; 
 + 
 + class TestBlock extends Block 
 + { 
 + 
 + protected TestBlock ( ) 
 + { 
 + super ( Material . glass ) ; 
 + setHardness ( 7 ) ; 
 + setCreativeTab ( CreativeTabs . tabBlock ) ; 
 + } 
 + 
 + @ Override 
 + public boolean isOpaqueCube ( ) 
 + { 
 + return false ; 
 + } 
 + 
 + public boolean isFullCube ( ) 
 + { 
 + return false ; 
 + } 
 + 
 + @ Override 
 + public boolean canRenderInLayer ( 
 + EnumWorldBlockLayer layer ) 
 + { 
 + return layer = = EnumWorldBlockLayer . SOLID | | layer = = EnumWorldBlockLayer . TRANSLUCENT ; 
 + } 
 + 
 + } ; 
 + 
 + class SmartModel implements IBakedModel , ISmartBlockModel 
 + { 
 + 
 + IFlexibleBakedModel solid ; 
 + IFlexibleBakedModel translucent ; 
 + 
 + private class DefState implements IModelState 
 + { 
 + 
 + @ Override 
 + public TRSRTransformation apply ( 
 + IModelPart part ) 
 + { 
 + return TRSRTransformation . identity ( ) ; 
 + } 
 + 
 + } ; 
 + 
 + @ Override 
 + public List getFaceQuads ( 
 + EnumFacing p _ 177551 _ 1 _ ) 
 + { 
 + return Collections . emptyList ( ) ; 
 + } 
 + 
 + @ Override 
 + public List getGeneralQuads ( ) 
 + { 
 + return Collections . emptyList ( ) ; 
 + } 
 + 
 + @ Override 
 + public boolean isAmbientOcclusion ( ) 
 + { 
 + return true ; 
 + } 
 + 
 + @ Override 
 + public boolean isGui3d ( ) 
 + { 
 + return true ; 
 + } 
 + 
 + @ Override 
 + public boolean isBuiltInRenderer ( ) 
 + { 
 + return false ; 
 + } 
 + 
 + @ Override 
 + public TextureAtlasSprite getTexture ( ) 
 + { 
 + return null ; 
 + } 
 + 
 + @ Override 
 + public ItemCameraTransforms getItemCameraTransforms ( ) 
 + { 
 + return ItemCameraTransforms . DEFAULT ; 
 + } 
 + 
 + @ Override 
 + public IBakedModel handleBlockState ( 
 + IBlockState state ) 
 + { 
 + if ( solid = = null ) 
 + { 
 + TextureAtlasSprite a = Minecraft . getMinecraft ( ) . getBlockRendererDispatcher ( ) . getBlockModelShapes ( ) . getModelForState ( Blocks . stained _ glass . getStateFromMeta ( 3 ) ) . getTexture ( ) ; 
 + TextureAtlasSprite b = Minecraft . getMinecraft ( ) . getBlockRendererDispatcher ( ) . getBlockModelShapes ( ) . getModelForState ( Blocks . cobblestone . getDefaultState ( ) ) . getTexture ( ) ; 
 + 
 + translucent = new TestBakedModel ( a , true ) ; 
 + solid = new TestBakedModel ( b , false ) ; 
 + } 
 + 
 + if ( net . minecraftforge . client . MinecraftForgeClient . getRenderLayer ( ) = = EnumWorldBlockLayer . SOLID ) 
 + { 
 + return solid ; 
 + } 
 + else 
 + { 
 + return translucent ; 
 + } 
 + } 
 + 
 + } ; 
 + 
 + @ SubscribeEvent 
 + public void onModelBakeEvent ( 
 + ModelBakeEvent event ) 
 + { 
 + event . modelRegistry . putObject ( new ModelResourceLocation ( " LayerBreakingTest : LayerBreakingTest " ) , new SmartModel ( ) ) ; 
 + } 
 + 
 + @ EventHandler 
 + public void init ( 
 + FMLInitializationEvent event ) 
 + { 
 + if ( ENABLE & & event . getSide ( ) = = Side . CLIENT ) 
 + { 
 + MinecraftForge . EVENT _ BUS . register ( this ) ; 
 + GameRegistry . registerBlock ( testBlock = new TestBlock ( ) , " LayerBreakingTest " ) ; 
 + } 
 + } 
 + 
 + }
