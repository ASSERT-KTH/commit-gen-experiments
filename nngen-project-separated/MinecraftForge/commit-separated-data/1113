BLEU SCORE: 0.02735488212061132

TEST MSG: Improve mod list GUI , add sort and search
GENERATED MSG: Move stuff around a bit - also tie range and enabled to options .

TEST DIFF (one line): diff - - git a / fml / src / main / java / net / minecraftforge / fml / client / GuiModList . java b / fml / src / main / java / net / minecraftforge / fml / client / GuiModList . java <nl> index d33a83d . . 39c1808 100644 <nl> - - - a / fml / src / main / java / net / minecraftforge / fml / client / GuiModList . java <nl> + + + b / fml / src / main / java / net / minecraftforge / fml / client / GuiModList . java <nl> @ @ - 19 , 6 + 19 , 9 @ @ import java . awt . image . BufferedImage ; <nl> import java . io . IOException ; <nl> import java . io . InputStream ; <nl> import java . util . ArrayList ; <nl> + import java . util . Collections ; <nl> + import java . util . Comparator ; <nl> + import java . util . List ; <nl> <nl> import javax . imageio . ImageIO ; <nl> <nl> @ @ - 26 , 6 + 29 , 7 @ @ import net . minecraft . client . Minecraft ; <nl> import net . minecraft . client . gui . FontRenderer ; <nl> import net . minecraft . client . gui . GuiButton ; <nl> import net . minecraft . client . gui . GuiScreen ; <nl> + import net . minecraft . client . gui . GuiTextField ; <nl> import net . minecraft . client . renderer . Tessellator ; <nl> import net . minecraft . client . renderer . WorldRenderer ; <nl> import net . minecraft . client . renderer . texture . DynamicTexture ; <nl> @ @ - 49 , 6 + 53 , 28 @ @ import com . google . common . base . Strings ; <nl> * / <nl> public class GuiModList extends GuiScreen <nl> { <nl> + private enum SortType <nl> + { <nl> + NORMAL ( 24 ) , A _ TO _ Z ( 25 ) , Z _ TO _ A ( 26 ) ; <nl> + <nl> + private int buttonID ; <nl> + <nl> + private SortType ( int buttonID ) <nl> + { <nl> + this . buttonID = buttonID ; <nl> + } <nl> + <nl> + public static SortType getTypeForButton ( GuiButton button ) <nl> + { <nl> + for ( SortType t : values ( ) ) { <nl> + if ( t . buttonID = = button . id ) { <nl> + return t ; <nl> + } <nl> + } <nl> + return null ; <nl> + } <nl> + } <nl> + <nl> private GuiScreen mainMenu ; <nl> private GuiSlotModList modList ; <nl> private int selected = - 1 ; <nl> @ @ - 59 , 6 + 85 , 15 @ @ public class GuiModList extends GuiScreen <nl> private GuiButton disableModButton ; <nl> private ResourceLocation cachedLogo ; <nl> private Dimension cachedLogoDimensions ; <nl> + <nl> + private int buttonMargin = 1 ; <nl> + private int numButtons = SortType . values ( ) . length ; <nl> + <nl> + private String lastFilterText = " " ; <nl> + <nl> + private GuiTextField search ; <nl> + private boolean sorted = false ; <nl> + private SortType sortType = SortType . NORMAL ; <nl> <nl> / * * <nl> * @ param mainMenu <nl> @ @ - 68 , 6 + 103 , 7 @ @ public class GuiModList extends GuiScreen <nl> this . mainMenu = mainMenu ; <nl> this . mods = new ArrayList < ModContainer > ( ) ; <nl> FMLClientHandler . instance ( ) . addSpecialModEntries ( mods ) ; <nl> + / / Add child mods to their parent ' s list <nl> for ( ModContainer mod : Loader . instance ( ) . getModList ( ) ) { <nl> if ( mod . getMetadata ( ) ! = null & & mod . getMetadata ( ) . parentMod = = null & & ! Strings . isNullOrEmpty ( mod . getMetadata ( ) . parent ) ) { <nl> String parentMod = mod . getMetadata ( ) . parent ; <nl> @ @ - 81 , 7 + 117 , 7 @ @ public class GuiModList extends GuiScreen <nl> } <nl> else if ( mod . getMetadata ( ) ! = null & & mod . getMetadata ( ) . parentMod ! = null ) <nl> { <nl> - 	 continue ; <nl> + continue ; <nl> } <nl> mods . add ( mod ) ; <nl> } <nl> @ @ - 96 , 21 + 132 , 133 @ @ public class GuiModList extends GuiScreen <nl> listWidth = Math . max ( listWidth , getFontRenderer ( ) . getStringWidth ( mod . getVersion ( ) ) + 10 ) ; <nl> } <nl> listWidth = Math . min ( listWidth , 150 ) ; <nl> - this . buttonList . add ( new GuiButton ( 6 , this . width / 2 - 75 , this . height - 38 , I18n . format ( " gui . done " ) ) ) ; <nl> - configModButton = new GuiButton ( 20 , 10 , this . height - 60 , this . listWidth , 20 , " Config " ) ; <nl> - disableModButton = new GuiButton ( 21 , 10 , this . height - 38 , this . listWidth , 20 , " Disable " ) ; <nl> - this . buttonList . add ( configModButton ) ; <nl> - this . buttonList . add ( disableModButton ) ; <nl> this . modList = new GuiSlotModList ( this , mods , listWidth ) ; <nl> this . modList . registerScrollButtons ( this . buttonList , 7 , 8 ) ; <nl> + <nl> + this . buttonList . add ( new GuiButton ( 6 , ( ( modList . right + this . width ) / 2 ) - 100 , this . height - 38 , I18n . format ( " gui . done " ) ) ) ; <nl> + configModButton = new GuiButton ( 20 , 10 , this . height - 49 , this . listWidth , 20 , " Config " ) ; <nl> + disableModButton = new GuiButton ( 21 , 10 , this . height - 27 , this . listWidth , 20 , " Disable " ) ; <nl> + this . buttonList . add ( configModButton ) ; <nl> + this . buttonList . add ( disableModButton ) ; <nl> + <nl> + search = new GuiTextField ( 0 , getFontRenderer ( ) , 12 , modList . bottom + 17 , modList . listWidth - 4 , 14 ) ; <nl> + search . setFocused ( true ) ; <nl> + search . setCanLoseFocus ( true ) ; <nl> + <nl> + int width = ( modList . listWidth / numButtons ) ; <nl> + int x = 10 , y = 10 ; <nl> + GuiButton normalSort = new GuiButton ( SortType . NORMAL . buttonID , x , y , width - buttonMargin , 20 , I18n . format ( " fml . menu . mods . normal " ) ) ; <nl> + normalSort . enabled = false ; <nl> + buttonList . add ( normalSort ) ; <nl> + x + = width + buttonMargin ; <nl> + buttonList . add ( new GuiButton ( SortType . A _ TO _ Z . buttonID , x , y , width - buttonMargin , 20 , " A - Z " ) ) ; <nl> + x + = width + buttonMargin ; <nl> + buttonList . add ( new GuiButton ( SortType . Z _ TO _ A . buttonID , x , y , width - buttonMargin , 20 , " Z - A " ) ) ; <nl> + } <nl> + <nl> + @ Override <nl> + protected void mouseClicked ( int x , int y , int button ) throws IOException <nl> + { <nl> + super . mouseClicked ( x , y , button ) ; <nl> + search . mouseClicked ( x , y , button ) ; <nl> + if ( button = = 1 & & x > = search . xPosition & & x < search . xPosition + this . width & & y > = search . yPosition & & y < search . yPosition + this . height ) { <nl> + search . setText ( " " ) ; <nl> + } <nl> + } <nl> + <nl> + @ Override <nl> + protected void keyTyped ( char c , int keyCode ) throws IOException <nl> + { <nl> + super . keyTyped ( c , keyCode ) ; <nl> + search . textboxKeyTyped ( c , keyCode ) ; <nl> + } <nl> + <nl> + @ Override <nl> + public void updateScreen ( ) <nl> + { <nl> + super . updateScreen ( ) ; <nl> + search . updateCursorCounter ( ) ; <nl> + <nl> + if ( ! search . getText ( ) . equals ( lastFilterText ) ) <nl> + { <nl> + reloadMods ( ) ; <nl> + sorted = false ; <nl> + } <nl> + <nl> + if ( ! sorted ) <nl> + { <nl> + switch ( sortType ) <nl> + { <nl> + case A _ TO _ Z : <nl> + Collections . sort ( modList . getMods ( ) , new Comparator < ModContainer > ( ) <nl> + { <nl> + @ Override <nl> + public int compare ( ModContainer o1 , ModContainer o2 ) <nl> + { <nl> + return o1 . getName ( ) . toLowerCase ( ) . compareTo ( o2 . getName ( ) . toLowerCase ( ) ) ; <nl> + } <nl> + } ) ; <nl> + break ; <nl> + case Z _ TO _ A : <nl> + Collections . sort ( modList . getMods ( ) , new Comparator < ModContainer > ( ) <nl> + { <nl> + @ Override <nl> + public int compare ( ModContainer o1 , ModContainer o2 ) <nl> + { <nl> + return o2 . getName ( ) . toLowerCase ( ) . compareTo ( o1 . getName ( ) . toLowerCase ( ) ) ; <nl> + } <nl> + } ) ; <nl> + break ; <nl> + default : <nl> + reloadMods ( ) ; <nl> + break ; <nl> + } <nl> + mods = modList . getMods ( ) ; <nl> + selected = modList . selectedIndex = mods . indexOf ( selectedMod ) ; <nl> + sorted = true ; <nl> + } <nl> + } <nl> + <nl> + private void reloadMods ( ) <nl> + { <nl> + ArrayList < ModContainer > mods = modList . getMods ( ) ; <nl> + mods . clear ( ) ; <nl> + for ( ModContainer m : Loader . instance ( ) . getActiveModList ( ) ) <nl> + { <nl> + / / If it passes the filter , and is not a child mod <nl> + if ( m . getName ( ) . toLowerCase ( ) . contains ( search . getText ( ) . toLowerCase ( ) ) & & m . getMetadata ( ) . parentMod = = null ) <nl> + { <nl> + mods . add ( m ) ; <nl> + } <nl> + } <nl> + this . mods = mods ; <nl> + lastFilterText = search . getText ( ) ; <nl> } <nl> <nl> @ Override <nl> protected void actionPerformed ( GuiButton button ) throws IOException { <nl> if ( button . enabled ) <nl> { <nl> - switch ( button . id ) <nl> + SortType type = SortType . getTypeForButton ( button ) ; <nl> + <nl> + if ( type ! = null ) <nl> { <nl> + for ( GuiButton b : ( List < GuiButton > ) buttonList ) <nl> + { <nl> + if ( SortType . getTypeForButton ( b ) ! = null ) <nl> + { <nl> + b . enabled = true ; <nl> + } <nl> + } <nl> + button . enabled = false ; <nl> + sorted = false ; <nl> + sortType = type ; <nl> + this . mods = modList . getMods ( ) ; <nl> + } <nl> + else <nl> + { <nl> + switch ( button . id ) <nl> + { <nl> case 6 : <nl> this . mc . displayGuiScreen ( this . mainMenu ) ; <nl> return ; <nl> @ @ - 126 , 6 + 274 , 7 @ @ public class GuiModList extends GuiScreen <nl> FMLLog . log ( Level . ERROR , e , " There was a critical issue trying to build the config GUI for % s " , selectedMod . getModId ( ) ) ; <nl> } <nl> return ; <nl> + } <nl> } <nl> } <nl> super . actionPerformed ( button ) ; <nl> @ @ - 274 , 6 + 423 , 11 @ @ public class GuiModList extends GuiScreen <nl> disableModButton . visible = false ; <nl> } <nl> super . drawScreen ( p _ 571 _ 1 _ , p _ 571 _ 2 _ , p _ 571 _ 3 _ ) ; <nl> + <nl> + String text = I18n . format ( " fml . menu . mods . search " ) ; <nl> + int x = ( ( 10 + modList . right ) / 2 ) - ( getFontRenderer ( ) . getStringWidth ( text ) / 2 ) ; <nl> + getFontRenderer ( ) . drawString ( text , x , modList . bottom + 5 , 0xFFFFFF ) ; <nl> + search . drawTextBox ( ) ; <nl> } <nl> <nl> Minecraft getMinecraftInstance ( ) { <nl> diff - - git a / fml / src / main / java / net / minecraftforge / fml / client / GuiScrollingList . java b / fml / src / main / java / net / minecraftforge / fml / client / GuiScrollingList . java <nl> index be38ab0 . . 5810d69 100644 <nl> - - - a / fml / src / main / java / net / minecraftforge / fml / client / GuiScrollingList . java <nl> + + + b / fml / src / main / java / net / minecraftforge / fml / client / GuiScrollingList . java <nl> @ @ - 31 , 7 + 31 , 7 @ @ public abstract class GuiScrollingList <nl> protected final int listHeight ; <nl> protected final int top ; <nl> protected final int bottom ; <nl> - private final int right ; <nl> + protected final int right ; <nl> protected final int left ; <nl> protected final int slotHeight ; <nl> private int scrollUpActionId ; <nl> @ @ - 41 , 7 + 41 , 7 @ @ public abstract class GuiScrollingList <nl> private float initialMouseClickY = - 2 . 0F ; <nl> private float scrollFactor ; <nl> private float scrollDistance ; <nl> - private int selectedIndex = - 1 ; <nl> + protected int selectedIndex = - 1 ; <nl> private long lastClickTime = 0L ; <nl> private boolean field _ 25123 _ p = true ; <nl> private boolean field _ 27262 _ q ; <nl> diff - - git a / fml / src / main / java / net / minecraftforge / fml / client / GuiSlotModList . java b / fml / src / main / java / net / minecraftforge / fml / client / GuiSlotModList . java <nl> index 69c489f . . 606dfdd 100644 <nl> - - - a / fml / src / main / java / net / minecraftforge / fml / client / GuiSlotModList . java <nl> + + + b / fml / src / main / java / net / minecraftforge / fml / client / GuiSlotModList . java <nl> @ @ - 16 , 8 + 16 , 8 @ @ import java . util . ArrayList ; <nl> <nl> import net . minecraft . client . renderer . Tessellator ; <nl> import net . minecraftforge . fml . common . Loader ; <nl> - import net . minecraftforge . fml . common . ModContainer ; <nl> import net . minecraftforge . fml . common . LoaderState . ModState ; <nl> + import net . minecraftforge . fml . common . ModContainer ; <nl> <nl> / * * <nl> * @ author cpw <nl> @ @ - 30 , 7 + 30 , 7 @ @ public class GuiSlotModList extends GuiScrollingList <nl> <nl> public GuiSlotModList ( GuiModList parent , ArrayList < ModContainer > mods , int listWidth ) <nl> { <nl> - super ( parent . getMinecraftInstance ( ) , listWidth , parent . height , 32 , parent . height - 66 + 4 , 10 , 35 ) ; <nl> + super ( parent . getMinecraftInstance ( ) , listWidth , parent . height , 32 , parent . height - 88 + 4 , 10 , 35 ) ; <nl> this . parent = parent ; <nl> this . mods = mods ; <nl> } <nl> @ @ - 64 , 6 + 64 , 11 @ @ public class GuiSlotModList extends GuiScrollingList <nl> { <nl> return ( this . getSize ( ) ) * 35 + 1 ; <nl> } <nl> + <nl> + ArrayList < ModContainer > getMods ( ) <nl> + { <nl> + return mods ; <nl> + } <nl> <nl> @ Override <nl> protected void drawSlot ( int listIndex , int var2 , int var3 , int var4 , Tessellator var5 ) <nl> diff - - git a / fml / src / main / resources / assets / fml / lang / en _ US . lang b / fml / src / main / resources / assets / fml / lang / en _ US . lang <nl> index 270d2ff . . 4ba2237 100644 <nl> - - - a / fml / src / main / resources / assets / fml / lang / en _ US . lang <nl> + + + b / fml / src / main / resources / assets / fml / lang / en _ US . lang <nl> @ @ - 82 , 4 + 82 , 6 @ @ fml . configgui . tooltip . default = [ default : % s ] <nl> fml . configgui . tooltip . defaultNumeric = [ range : % s ~ % s , default : % s ] <nl> <nl> fml . menu . mods = Mods <nl> + fml . menu . mods . normal = Normal <nl> + fml . menu . mods . search = Search : <nl> fml . menu . modoptions = Mod Options . . .
NEAREST DIFF (one line): diff - - git a / client / net / minecraftforge / client / ForgeHooksClient . java b / client / net / minecraftforge / client / ForgeHooksClient . java <nl> index 7c2ad32 . . dcba24b 100644 <nl> - - - a / client / net / minecraftforge / client / ForgeHooksClient . java <nl> + + + b / client / net / minecraftforge / client / ForgeHooksClient . java <nl> @ @ - 30 , 6 + 30 , 8 @ @ import net . minecraft . item . ItemStack ; <nl> import net . minecraft . util . MathHelper ; <nl> import net . minecraft . util . MovingObjectPosition ; <nl> import net . minecraft . util . ResourceLocation ; <nl> + import net . minecraft . world . World ; <nl> + import net . minecraft . world . biome . BiomeGenBase ; <nl> import net . minecraft . client . model . ModelBiped ; <nl> import net . minecraft . client . renderer . RenderBlocks ; <nl> import net . minecraft . client . renderer . RenderGlobal ; <nl> @ @ - 41 , 6 + 43 , 7 @ @ import net . minecraftforge . client . IItemRenderer . ItemRenderType ; <nl> import net . minecraftforge . client . event . DrawBlockHighlightEvent ; <nl> import net . minecraftforge . client . event . RenderWorldLastEvent ; <nl> import net . minecraftforge . client . event . TextureStitchEvent ; <nl> + import net . minecraftforge . common . ForgeDummyContainer ; <nl> import net . minecraftforge . common . MinecraftForge ; <nl> import net . minecraftforge . fluids . FluidRegistry ; <nl> import net . minecraftforge . fluids . RenderBlockFluid ; <nl> @ @ - 50 , 6 + 53 , 7 @ @ import static net . minecraftforge . client . IItemRenderer . ItemRendererHelper . * ; <nl> public class ForgeHooksClient <nl> { <nl> private static final ResourceLocation ITEM _ GLINT = new ResourceLocation ( " textures / misc / enchanted _ item _ glint . png " ) ; <nl> + <nl> static TextureManager engine ( ) <nl> { <nl> return FMLClientHandler . instance ( ) . getClient ( ) . renderEngine ; <nl> @ @ - 338 , 6 + 342 , 44 @ @ public class ForgeHooksClient <nl> return fovUpdateEvent . newfov ; <nl> } <nl> <nl> + private static int skyX , skyZ ; <nl> + <nl> + private static boolean skyInit ; <nl> + private static int skyRGBMultiplier ; <nl> + <nl> + public static int getSkyBlendColour ( World world , int playerX , int playerZ ) <nl> + { <nl> + if ( playerX = = skyX & & playerZ = = skyZ & & skyInit ) <nl> + { <nl> + return skyRGBMultiplier ; <nl> + } <nl> + skyInit = true ; <nl> + <nl> + int distance = Minecraft . getMinecraft ( ) . gameSettings . fancyGraphics ? ForgeDummyContainer . blendRanges [ Minecraft . getMinecraft ( ) . gameSettings . renderDistance ] : 0 ; <nl> + <nl> + int r = 0 ; <nl> + int g = 0 ; <nl> + int b = 0 ; <nl> + <nl> + for ( int x = - distance ; x < = distance ; + + x ) <nl> + { <nl> + for ( int z = - distance ; z < = distance ; + + z ) <nl> + { <nl> + BiomeGenBase biome = world . getBiomeGenForCoords ( playerX + x , playerZ + z ) ; <nl> + int colour = biome . getSkyColorByTemp ( biome . getFloatTemperature ( ) ) ; <nl> + r + = ( colour & 0xFF0000 ) > > 16 ; <nl> + g + = ( colour & 0x00FF00 ) > > 8 ; <nl> + b + = colour & 0x0000FF ; <nl> + } <nl> + } <nl> + <nl> + int multiplier = ( r / 1681 & 255 ) < < 16 | ( g / 1681 & 255 ) < < 8 | b / 1681 & 255 ; <nl> + <nl> + skyX = playerX ; <nl> + skyZ = playerZ ; <nl> + skyRGBMultiplier = multiplier ; <nl> + return skyRGBMultiplier ; <nl> + } <nl> / * * <nl> * Initialization of Forge Renderers . <nl> * / <nl> diff - - git a / common / net / minecraftforge / common / ForgeDummyContainer . java b / common / net / minecraftforge / common / ForgeDummyContainer . java <nl> index a8c2b27 . . 881f533 100644 <nl> - - - a / common / net / minecraftforge / common / ForgeDummyContainer . java <nl> + + + b / common / net / minecraftforge / common / ForgeDummyContainer . java <nl> @ @ - 51 , 6 + 51 , 8 @ @ public class ForgeDummyContainer extends DummyModContainer implements WorldAcces <nl> public static boolean disableStitchedFileSaving = false ; <nl> public static boolean forceDuplicateFluidBlockCrash = true ; <nl> public static boolean fullBoundingBoxLadders = false ; <nl> + <nl> + public static int [ ] blendRanges = { 20 , 15 , 10 , 5 } ; <nl> <nl> public ForgeDummyContainer ( ) <nl> { <nl> @ @ - 139 , 6 + 141 , 10 @ @ public class ForgeDummyContainer extends DummyModContainer implements WorldAcces <nl> FMLLog . warning ( " Disabling forced crashes on duplicate Fluid Blocks - USE AT YOUR OWN RISK " ) ; <nl> } <nl> <nl> + prop = config . get ( Configuration . CATEGORY _ GENERAL , " biomeSkyBlendRange " , new int [ ] { 20 , 15 , 10 , 5 } ) ; <nl> + prop . comment = " Control the range of sky blending for colored skies in biomes . " ; <nl> + blendRanges = prop . getIntList ( ) ; <nl> + <nl> if ( config . hasChanged ( ) ) <nl> { <nl> config . save ( ) ; <nl> diff - - git a / patches / minecraft / net / minecraft / world / World . java . patch b / patches / minecraft / net / minecraft / world / World . java . patch <nl> index 3b22a59 . . 88d9ad7 100644 <nl> - - - a / patches / minecraft / net / minecraft / world / World . java . patch <nl> + + + b / patches / minecraft / net / minecraft / world / World . java . patch <nl> @ @ - 7 , 12 + 7 , 13 @ @ <nl> import cpw . mods . fml . relauncher . Side ; <nl> import cpw . mods . fml . relauncher . SideOnly ; <nl> import java . util . ArrayList ; <nl> - @ @ - 53 , 8 + 54 , 32 @ @ <nl> + @ @ - 53 , 8 + 54 , 33 @ @ <nl> import net . minecraft . world . storage . MapStorage ; <nl> import net . minecraft . world . storage . WorldInfo ; <nl> <nl> + import com . google . common . collect . ImmutableSetMultimap ; <nl> + <nl> + + import net . minecraftforge . client . ForgeHooksClient ; <nl> + import net . minecraftforge . common . ForgeChunkManager ; <nl> + import net . minecraftforge . common . ForgeChunkManager . Ticket ; <nl> + import net . minecraftforge . common . ForgeDummyContainer ; <nl> @ @ - 40 , 7 + 41 , 7 @ @ <nl> / * * <nl> * boolean ; if true updates scheduled by scheduleBlockUpdate happen immediately <nl> * / <nl> - @ @ - 167 , 6 + 192 , 11 @ @ <nl> + @ @ - 167 , 6 + 193 , 11 @ @ <nl> * / <nl> public BiomeGenBase getBiomeGenForCoords ( int par1 , int par2 ) <nl> { <nl> @ @ - 52 , 7 + 53 , 7 @ @ <nl> if ( this . blockExists ( par1 , 0 , par2 ) ) <nl> { <nl> Chunk chunk = this . getChunkFromBlockCoords ( par1 , par2 ) ; <nl> - @ @ - 194 , 8 + 224 , 15 @ @ <nl> + @ @ - 194 , 8 + 225 , 15 @ @ <nl> this . theProfiler = par5Profiler ; <nl> this . worldInfo = new WorldInfo ( par4WorldSettings , par2Str ) ; <nl> this . provider = par3WorldProvider ; <nl> @ @ - 69 , 7 + 70 , 7 @ @ <nl> VillageCollection villagecollection = ( VillageCollection ) this . mapStorage . loadData ( VillageCollection . class , " villages " ) ; <nl> <nl> if ( villagecollection = = null ) <nl> - @ @ - 208 , 8 + 245 , 10 @ @ <nl> + @ @ - 208 , 8 + 246 , 10 @ @ <nl> this . villageCollectionObj = villagecollection ; <nl> this . villageCollectionObj . func _ 82566 _ a ( this ) ; <nl> } <nl> @ @ - 82 , 7 + 83 , 7 @ @ <nl> this . chunkProvider = this . createChunkProvider ( ) ; <nl> this . calculateInitialSkylight ( ) ; <nl> this . calculateInitialWeather ( ) ; <nl> - @ @ - 221 , 7 + 260 , 7 @ @ <nl> + @ @ - 221 , 7 + 261 , 7 @ @ <nl> this . lightUpdateBlockList = new int [ 32768 ] ; <nl> this . saveHandler = par1ISaveHandler ; <nl> this . theProfiler = par5Profiler ; <nl> @ @ - 91 , 7 + 92 , 7 @ @ <nl> this . worldLogAgent = par6ILogAgent ; <nl> this . worldInfo = par1ISaveHandler . loadWorldInfo ( ) ; <nl> <nl> - @ @ - 275 , 12 + 314 , 20 @ @ <nl> + @ @ - 275 , 12 + 315 , 20 @ @ <nl> this . worldInfo . setServerInitialized ( true ) ; <nl> } <nl> <nl> @ @ - 114 , 7 + 115 , 7 @ @ <nl> } <nl> else <nl> { <nl> - @ @ - 290 , 6 + 337 , 20 @ @ <nl> + @ @ - 290 , 6 + 338 , 20 @ @ <nl> <nl> this . calculateInitialSkylight ( ) ; <nl> this . calculateInitialWeather ( ) ; <nl> @ @ - 135 , 7 + 136 , 7 @ @ <nl> } <nl> <nl> / * * <nl> - @ @ - 373 , 7 + 434 , 8 @ @ <nl> + @ @ - 373 , 7 + 435 , 8 @ @ <nl> * / <nl> public boolean isAirBlock ( int par1 , int par2 , int par3 ) <nl> { <nl> @ @ - 145 , 7 + 146 , 7 @ @ <nl> } <nl> <nl> / * * <nl> - @ @ - 382 , 7 + 444 , 8 @ @ <nl> + @ @ - 382 , 7 + 445 , 8 @ @ <nl> public boolean blockHasTileEntity ( int par1 , int par2 , int par3 ) <nl> { <nl> int l = this . getBlockId ( par1 , par2 , par3 ) ; <nl> @ @ - 155 , 7 + 156 , 7 @ @ <nl> } <nl> <nl> / * * <nl> - @ @ - 1157 , 7 + 1220 , 7 @ @ <nl> + @ @ - 1157 , 7 + 1221 , 7 @ @ <nl> * / <nl> public boolean isDaytime ( ) <nl> { <nl> @ @ - 164 , 7 + 165 , 7 @ @ <nl> } <nl> <nl> / * * <nl> - @ @ - 1192 , 7 + 1255 , 7 @ @ <nl> + @ @ - 1192 , 7 + 1256 , 7 @ @ <nl> int l1 = this . getBlockMetadata ( l , i1 , j1 ) ; <nl> Block block = Block . blocksList [ k1 ] ; <nl> <nl> @ @ - 173 , 7 + 174 , 7 @ @ <nl> { <nl> MovingObjectPosition movingobjectposition = block . collisionRayTrace ( this , l , i1 , j1 , par1Vec3 , par2Vec3 ) ; <nl> <nl> - @ @ - 1392 , 6 + 1455 , 12 @ @ <nl> + @ @ - 1392 , 6 + 1456 , 12 @ @ <nl> * / <nl> public void playSoundAtEntity ( Entity par1Entity , String par2Str , float par3 , float par4 ) <nl> { <nl> @ @ - 186 , 7 + 187 , 7 @ @ <nl> if ( par1Entity ! = null & & par2Str ! = null ) <nl> { <nl> for ( int i = 0 ; i < this . worldAccesses . size ( ) ; + + i ) <nl> - @ @ - 1406 , 6 + 1475 , 12 @ @ <nl> + @ @ - 1406 , 6 + 1476 , 12 @ @ <nl> * / <nl> public void playSoundToNearExcept ( EntityPlayer par1EntityPlayer , String par2Str , float par3 , float par4 ) <nl> { <nl> @ @ - 199 , 7 + 200 , 7 @ @ <nl> if ( par1EntityPlayer ! = null & & par2Str ! = null ) <nl> { <nl> for ( int i = 0 ; i < this . worldAccesses . size ( ) ; + + i ) <nl> - @ @ - 1492 , 6 + 1567 , 11 @ @ <nl> + @ @ - 1492 , 6 + 1568 , 11 @ @ <nl> EntityPlayer entityplayer = ( EntityPlayer ) par1Entity ; <nl> this . playerEntities . add ( entityplayer ) ; <nl> this . updateAllPlayersSleepingFlag ( ) ; <nl> @ @ - 211 , 20 + 212 , 20 @ @ <nl> } <nl> <nl> this . getChunkFromChunkCoords ( i , j ) . addEntity ( par1Entity ) ; <nl> - @ @ - 1732 , 6 + 1812 , 12 @ @ <nl> - * Calculates the color for the skybox <nl> + @ @ - 1733 , 6 + 1814 , 12 @ @ <nl> * / <nl> public Vec3 getSkyColor ( Entity par1Entity , float par2 ) <nl> - + { <nl> + { <nl> + return provider . getSkyColor ( par1Entity , par2 ) ; <nl> + } <nl> + <nl> + @ SideOnly ( Side . CLIENT ) <nl> + public Vec3 getSkyColorBody ( Entity par1Entity , float par2 ) <nl> - { <nl> + + { <nl> float f1 = this . getCelestialAngle ( par2 ) ; <nl> float f2 = MathHelper . cos ( f1 * ( float ) Math . PI * 2 . 0F ) * 2 . 0F + 0 . 5F ; <nl> - @ @ - 1831 , 15 + 1831 , 31 @ @ <nl> + <nl> + @ @ - 1745 , 15 + 1832 , 15 @ @ <nl> { <nl> f2 = 1 . 0F ; <nl> } <nl> @ @ - 239 , 23 + 240 , 7 @ @ <nl> - float f5 = ( float ) ( k > > 8 & 255 ) / 255 . 0F ; <nl> - float f6 = ( float ) ( k & 255 ) / 255 . 0F ; <nl> + <nl> - + int r = 0 ; <nl> - + int g = 0 ; <nl> - + int b = 0 ; <nl> - + <nl> - + for ( int x = - 20 ; x < = 20 ; + + x ) <nl> - + { <nl> - + for ( int z = - 20 ; z < = 20 ; + + z ) <nl> - + { <nl> - + BiomeGenBase biome = this . getBiomeGenForCoords ( i + x , j + z ) ; <nl> - + int colour = biome . getSkyColorByTemp ( biome . getFloatTemperature ( ) ) ; <nl> - + r + = ( colour & 16711680 ) > > 16 ; <nl> - + g + = ( colour & 65280 ) > > 8 ; <nl> - + b + = colour & 255 ; <nl> - + } <nl> - + } <nl> - + <nl> - + int multiplier = ( r / 1681 & 255 ) < < 16 | ( g / 1681 & 255 ) < < 8 | b / 1681 & 255 ; <nl> + + int multiplier = ForgeHooksClient . getSkyBlendColour ( this , i , j ) ; <nl> + <nl> + float f4 = ( float ) ( multiplier > > 16 & 255 ) / 255 . 0F ; <nl> + float f5 = ( float ) ( multiplier > > 8 & 255 ) / 255 . 0F ; <nl> @ @ - 263 , 7 + 248 , 7 @ @ <nl> f4 * = f2 ; <nl> f5 * = f2 ; <nl> f6 * = f2 ; <nl> - @ @ - 1833 , 6 + 1919 , 12 @ @ <nl> + @ @ - 1833 , 6 + 1920 , 12 @ @ <nl> @ SideOnly ( Side . CLIENT ) <nl> public Vec3 getCloudColour ( float par1 ) <nl> { <nl> @ @ - 276 , 7 + 261 , 7 @ @ <nl> float f1 = this . getCelestialAngle ( par1 ) ; <nl> float f2 = MathHelper . cos ( f1 * ( float ) Math . PI * 2 . 0F ) * 2 . 0F + 0 . 5F ; <nl> <nl> - @ @ - 1904 , 6 + 1996 , 8 @ @ <nl> + @ @ - 1904 , 6 + 1997 , 8 @ @ <nl> public int getTopSolidOrLiquidBlock ( int par1 , int par2 ) <nl> { <nl> Chunk chunk = this . getChunkFromBlockCoords ( par1 , par2 ) ; <nl> @ @ - 285 , 7 + 270 , 7 @ @ <nl> int k = chunk . getTopFilledSegment ( ) + 15 ; <nl> par1 & = 15 ; <nl> <nl> - @ @ - 1911 , 7 + 2005 , 7 @ @ <nl> + @ @ - 1911 , 7 + 2006 , 7 @ @ <nl> { <nl> int l = chunk . getBlockID ( par1 , k , par2 ) ; <nl> <nl> @ @ - 294 , 7 + 279 , 7 @ @ <nl> { <nl> return k + 1 ; <nl> } <nl> - @ @ - 1926 , 6 + 2020 , 12 @ @ <nl> + @ @ - 1926 , 6 + 2021 , 12 @ @ <nl> * How bright are stars in the sky <nl> * / <nl> public float getStarBrightness ( float par1 ) <nl> @ @ - 307 , 7 + 292 , 7 @ @ <nl> { <nl> float f1 = this . getCelestialAngle ( par1 ) ; <nl> float f2 = 1 . 0F - ( MathHelper . cos ( f1 * ( float ) Math . PI * 2 . 0F ) * 2 . 0F + 0 . 25F ) ; <nl> - @ @ - 1990 , 7 + 2090 , 15 @ @ <nl> + @ @ - 1990 , 7 + 2091 , 15 @ @ <nl> entity . addEntityCrashInfo ( crashreportcategory ) ; <nl> } <nl> <nl> @ @ - 324 , 7 + 309 , 7 @ @ <nl> } <nl> <nl> if ( entity . isDead ) <nl> - @ @ - 2052 , 7 + 2160 , 16 @ @ <nl> + @ @ - 2052 , 7 + 2161 , 16 @ @ <nl> crashreport = CrashReport . makeCrashReport ( throwable1 , " Ticking entity " ) ; <nl> crashreportcategory = crashreport . makeCategory ( " Entity being ticked " ) ; <nl> entity . addEntityCrashInfo ( crashreportcategory ) ; <nl> @ @ - 342 , 7 + 327 , 7 @ @ <nl> } <nl> } <nl> <nl> - @ @ - 2095 , 7 + 2212 , 16 @ @ <nl> + @ @ - 2095 , 7 + 2213 , 16 @ @ <nl> crashreport = CrashReport . makeCrashReport ( throwable2 , " Ticking tile entity " ) ; <nl> crashreportcategory = crashreport . makeCategory ( " Tile entity being ticked " ) ; <nl> tileentity . func _ 85027 _ a ( crashreportcategory ) ; <nl> @ @ - 360 , 7 + 345 , 7 @ @ <nl> } <nl> } <nl> <nl> - @ @ - 2109 , 7 + 2235 , 7 @ @ <nl> + @ @ - 2109 , 7 + 2236 , 7 @ @ <nl> <nl> if ( chunk ! = null ) <nl> { <nl> @ @ - 369 , 7 + 354 , 7 @ @ <nl> } <nl> } <nl> } <nl> - @ @ - 2118 , 6 + 2244 , 10 @ @ <nl> + @ @ - 2118 , 6 + 2245 , 10 @ @ <nl> <nl> if ( ! this . entityRemoval . isEmpty ( ) ) <nl> { <nl> @ @ - 380 , 7 + 365 , 7 @ @ <nl> this . loadedTileEntityList . removeAll ( this . entityRemoval ) ; <nl> this . entityRemoval . clear ( ) ; <nl> } <nl> - @ @ - 2138 , 18 + 2268 , 18 @ @ <nl> + @ @ - 2138 , 18 + 2269 , 18 @ @ <nl> { <nl> this . loadedTileEntityList . add ( tileentity1 ) ; <nl> } <nl> @ @ - 403 , 7 + 388 , 7 @ @ <nl> } <nl> } <nl> <nl> - @ @ - 2162 , 13 + 2292 , 13 @ @ <nl> + @ @ - 2162 , 13 + 2293 , 13 @ @ <nl> <nl> public void addTileEntity ( Collection par1Collection ) <nl> { <nl> @ @ - 424 , 7 + 409 , 7 @ @ <nl> } <nl> } <nl> <nl> - @ @ - 2188 , 9 + 2318 , 17 @ @ <nl> + @ @ - 2188 , 9 + 2319 , 17 @ @ <nl> { <nl> int i = MathHelper . floor _ double ( par1Entity . posX ) ; <nl> int j = MathHelper . floor _ double ( par1Entity . posZ ) ; <nl> @ @ - 445 , 7 + 430 , 7 @ @ <nl> { <nl> par1Entity . lastTickPosX = par1Entity . posX ; <nl> par1Entity . lastTickPosY = par1Entity . posY ; <nl> - @ @ - 2424 , 6 + 2562 , 14 @ @ <nl> + @ @ - 2424 , 6 + 2563 , 14 @ @ <nl> { <nl> return true ; <nl> } <nl> @ @ - 460 , 7 + 445 , 7 @ @ <nl> } <nl> } <nl> } <nl> - @ @ - 2746 , 15 + 2892 , 16 @ @ <nl> + @ @ - 2746 , 15 + 2893 , 16 @ @ <nl> * / <nl> public void setBlockTileEntity ( int par1 , int par2 , int par3 , TileEntity par4TileEntity ) <nl> { <nl> @ @ - 486 , 7 + 471 , 7 @ @ <nl> while ( iterator . hasNext ( ) ) <nl> { <nl> TileEntity tileentity1 = ( TileEntity ) iterator . next ( ) ; <nl> - @ @ - 2765 , 20 + 2912 , 21 @ @ <nl> + @ @ - 2765 , 20 + 2913 , 21 @ @ <nl> iterator . remove ( ) ; <nl> } <nl> } <nl> @ @ - 519 , 7 + 504 , 7 @ @ <nl> } <nl> <nl> / * * <nl> - @ @ - 2786 , 28 + 2934 , 13 @ @ <nl> + @ @ - 2786 , 28 + 2935 , 13 @ @ <nl> * / <nl> public void removeBlockTileEntity ( int par1 , int par2 , int par3 ) <nl> { <nl> @ @ - 555 , 7 + 540 , 7 @ @ <nl> } <nl> <nl> / * * <nl> - @ @ - 2832 , 7 + 2965 , 8 @ @ <nl> + @ @ - 2832 , 7 + 2966 , 8 @ @ <nl> * / <nl> public boolean isBlockNormalCube ( int par1 , int par2 , int par3 ) <nl> { <nl> @ @ - 565 , 7 + 550 , 7 @ @ <nl> } <nl> <nl> public boolean isBlockFullCube ( int par1 , int par2 , int par3 ) <nl> - @ @ - 2855 , 16 + 2989 , 17 @ @ <nl> + @ @ - 2855 , 16 + 2990 , 17 @ @ <nl> * / <nl> public boolean doesBlockHaveSolidTopSurface ( int par1 , int par2 , int par3 ) <nl> { <nl> @ @ - 585 , 7 + 570 , 7 @ @ <nl> return par1Block = = null ? false : ( par1Block . blockMaterial . isOpaque ( ) & & par1Block . renderAsNormalBlock ( ) ? true : ( par1Block instanceof BlockStairs ? ( par2 & 4 ) = = 4 : ( par1Block instanceof BlockHalfSlab ? ( par2 & 8 ) = = 8 : ( par1Block instanceof BlockHopper ? true : ( par1Block instanceof BlockSnow ? ( par2 & 7 ) = = 7 : false ) ) ) ) ) ; <nl> } <nl> <nl> - @ @ - 2881 , 7 + 3016 , 7 @ @ <nl> + @ @ - 2881 , 7 + 3017 , 7 @ @ <nl> if ( chunk ! = null & & ! chunk . isEmpty ( ) ) <nl> { <nl> Block block = Block . blocksList [ this . getBlockId ( par1 , par2 , par3 ) ] ; <nl> @ @ - 594 , 7 + 579 , 7 @ @ <nl> } <nl> else <nl> { <nl> - @ @ - 2912 , 8 + 3047 , 7 @ @ <nl> + @ @ - 2912 , 8 + 3048 , 7 @ @ <nl> * / <nl> public void setAllowedSpawnTypes ( boolean par1 , boolean par2 ) <nl> { <nl> @ @ - 604 , 7 + 589 , 7 @ @ <nl> } <nl> <nl> / * * <nl> - @ @ - 2929 , 6 + 3063 , 11 @ @ <nl> + @ @ - 2929 , 6 + 3064 , 11 @ @ <nl> * / <nl> private void calculateInitialWeather ( ) <nl> { <nl> @ @ - 616 , 7 + 601 , 7 @ @ <nl> if ( this . worldInfo . isRaining ( ) ) <nl> { <nl> this . rainingStrength = 1 . 0F ; <nl> - @ @ - 2944 , 6 + 3083 , 11 @ @ <nl> + @ @ - 2944 , 6 + 3084 , 11 @ @ <nl> * Updates all weather states . <nl> * / <nl> protected void updateWeather ( ) <nl> @ @ - 628 , 7 + 613 , 7 @ @ <nl> { <nl> if ( ! this . provider . hasNoSky ) <nl> { <nl> - @ @ - 3041 , 12 + 3185 , 14 @ @ <nl> + @ @ - 3041 , 12 + 3186 , 14 @ @ <nl> <nl> public void toggleRain ( ) <nl> { <nl> @ @ - 644 , 7 + 629 , 7 @ @ <nl> this . theProfiler . startSection ( " buildList " ) ; <nl> int i ; <nl> EntityPlayer entityplayer ; <nl> - @ @ - 3153 , 6 + 3299 , 11 @ @ <nl> + @ @ - 3153 , 6 + 3300 , 11 @ @ <nl> * / <nl> public boolean canBlockFreeze ( int par1 , int par2 , int par3 , boolean par4 ) <nl> { <nl> @ @ - 656 , 7 + 641 , 7 @ @ <nl> BiomeGenBase biomegenbase = this . getBiomeGenForCoords ( par1 , par3 ) ; <nl> float f = biomegenbase . getFloatTemperature ( ) ; <nl> <nl> - @ @ - 3211 , 6 + 3362 , 11 @ @ <nl> + @ @ - 3211 , 6 + 3363 , 11 @ @ <nl> * / <nl> public boolean canSnowAt ( int par1 , int par2 , int par3 ) <nl> { <nl> @ @ - 668 , 7 + 653 , 7 @ @ <nl> BiomeGenBase biomegenbase = this . getBiomeGenForCoords ( par1 , par3 ) ; <nl> float f = biomegenbase . getFloatTemperature ( ) ; <nl> <nl> - @ @ - 3254 , 10 + 3410 , 12 @ @ <nl> + @ @ - 3254 , 10 + 3411 , 12 @ @ <nl> else <nl> { <nl> int l = this . getBlockId ( par1 , par2 , par3 ) ; <nl> @ @ - 685 , 7 + 670 , 7 @ @ <nl> { <nl> j1 = 1 ; <nl> } <nl> - @ @ - 3353 , 7 + 3511 , 9 @ @ <nl> + @ @ - 3353 , 7 + 3512 , 9 @ @ <nl> int j4 = i2 + Facing . offsetsXForSide [ i4 ] ; <nl> int k4 = j2 + Facing . offsetsYForSide [ i4 ] ; <nl> int l4 = k2 + Facing . offsetsZForSide [ i4 ] ; <nl> @ @ - 696 , 7 + 681 , 7 @ @ <nl> i3 = this . getSavedLightValue ( par1EnumSkyBlock , j4 , k4 , l4 ) ; <nl> <nl> if ( i3 = = l2 - i5 & & i1 < this . lightUpdateBlockList . length ) <nl> - @ @ - 3456 , 10 + 3616 , 10 @ @ <nl> + @ @ - 3456 , 10 + 3617 , 10 @ @ <nl> public List getEntitiesWithinAABBExcludingEntity ( Entity par1Entity , AxisAlignedBB par2AxisAlignedBB , IEntitySelector par3IEntitySelector ) <nl> { <nl> ArrayList arraylist = new ArrayList ( ) ; <nl> @ @ - 711 , 7 + 696 , 7 @ @ <nl> <nl> for ( int i1 = i ; i1 < = j ; + + i1 ) <nl> { <nl> - @ @ - 3485 , 10 + 3645 , 10 @ @ <nl> + @ @ - 3485 , 10 + 3646 , 10 @ @ <nl> <nl> public List selectEntitiesWithinAABB ( Class par1Class , AxisAlignedBB par2AxisAlignedBB , IEntitySelector par3IEntitySelector ) <nl> { <nl> @ @ - 726 , 7 + 711 , 7 @ @ <nl> ArrayList arraylist = new ArrayList ( ) ; <nl> <nl> for ( int i1 = i ; i1 < = j ; + + i1 ) <nl> - @ @ - 3582 , 11 + 3742 , 14 @ @ <nl> + @ @ - 3582 , 11 + 3743 , 14 @ @ <nl> * / <nl> public void addLoadedEntities ( List par1List ) <nl> { <nl> @ @ - 744 , 7 + 729 , 7 @ @ <nl> } <nl> } <nl> <nl> - @ @ - 3620 , 6 + 3783 , 11 @ @ <nl> + @ @ - 3620 , 6 + 3784 , 11 @ @ <nl> else <nl> { <nl> if ( block ! = null & & ( block = = Block . waterMoving | | block = = Block . waterStill | | block = = Block . lavaMoving | | block = = Block . lavaStill | | block = = Block . fire | | block . blockMaterial . isReplaceable ( ) ) ) <nl> @ @ - 756 , 7 + 741 , 7 @ @ <nl> { <nl> block = null ; <nl> } <nl> - @ @ - 3914 , 7 + 4082 , 7 @ @ <nl> + @ @ - 3914 , 7 + 4083 , 7 @ @ <nl> * / <nl> public long getSeed ( ) <nl> { <nl> @ @ - 765 , 7 + 750 , 7 @ @ <nl> } <nl> <nl> public long getTotalWorldTime ( ) <nl> - @ @ - 3924 , 7 + 4092 , 7 @ @ <nl> + @ @ - 3924 , 7 + 4093 , 7 @ @ <nl> <nl> public long getWorldTime ( ) <nl> { <nl> @ @ - 774 , 7 + 759 , 7 @ @ <nl> } <nl> <nl> / * * <nl> - @ @ - 3932 , 7 + 4100 , 7 @ @ <nl> + @ @ - 3932 , 7 + 4101 , 7 @ @ <nl> * / <nl> public void setWorldTime ( long par1 ) <nl> { <nl> @ @ - 783 , 7 + 768 , 7 @ @ <nl> } <nl> <nl> / * * <nl> - @ @ - 3940 , 13 + 4108 , 13 @ @ <nl> + @ @ - 3940 , 13 + 4109 , 13 @ @ <nl> * / <nl> public ChunkCoordinates getSpawnPoint ( ) <nl> { <nl> @ @ - 799 , 7 + 784 , 7 @ @ <nl> } <nl> <nl> @ SideOnly ( Side . CLIENT ) <nl> - @ @ - 3970 , 7 + 4138 , 10 @ @ <nl> + @ @ - 3970 , 7 + 4139 , 10 @ @ <nl> <nl> if ( ! this . loadedEntityList . contains ( par1Entity ) ) <nl> { <nl> @ @ - 811 , 7 + 796 , 7 @ @ <nl> } <nl> } <nl> <nl> - @ @ - 3978 , 6 + 4149 , 11 @ @ <nl> + @ @ - 3978 , 6 + 4150 , 11 @ @ <nl> * Called when checking if a certain block can be mined or not . The ' spawn safe zone ' check is located here . <nl> * / <nl> public boolean canMineBlock ( EntityPlayer par1EntityPlayer , int par2 , int par3 , int par4 ) <nl> @ @ - 823 , 7 + 808 , 7 @ @ <nl> { <nl> return true ; <nl> } <nl> - @ @ - 4098 , 8 + 4274 , 7 @ @ <nl> + @ @ - 4098 , 8 + 4275 , 7 @ @ <nl> * / <nl> public boolean isBlockHighHumidity ( int par1 , int par2 , int par3 ) <nl> { <nl> @ @ - 833 , 7 + 818 , 7 @ @ <nl> } <nl> <nl> / * * <nl> - @ @ - 4174 , 7 + 4349 , 7 @ @ <nl> + @ @ - 4174 , 7 + 4350 , 7 @ @ <nl> * / <nl> public int getHeight ( ) <nl> { <nl> @ @ - 842 , 7 + 827 , 7 @ @ <nl> } <nl> <nl> / * * <nl> - @ @ - 4182 , 7 + 4357 , 7 @ @ <nl> + @ @ - 4182 , 7 + 4358 , 7 @ @ <nl> * / <nl> public int getActualHeight ( ) <nl> { <nl> @ @ - 851 , 7 + 836 , 7 @ @ <nl> } <nl> <nl> public IUpdatePlayerListBox getMinecartSoundUpdater ( EntityMinecart par1EntityMinecart ) <nl> - @ @ - 4225 , 7 + 4400 , 7 @ @ <nl> + @ @ - 4225 , 7 + 4401 , 7 @ @ <nl> * / <nl> public double getHorizon ( ) <nl> { <nl> @ @ - 860 , 7 + 845 , 7 @ @ <nl> } <nl> <nl> / * * <nl> - @ @ - 4294 , 30 + 4469 , 28 @ @ <nl> + @ @ - 4294 , 30 + 4470 , 28 @ @ <nl> <nl> public void func _ 96440 _ m ( int par1 , int par2 , int par3 , int par4 ) <nl> { <nl> @ @ - 912 , 7 + 897 , 7 @ @ <nl> } <nl> } <nl> } <nl> - @ @ - 4363 , 4 + 4536 , 115 @ @ <nl> + @ @ - 4363 , 4 + 4537 , 115 @ @ <nl> <nl> return MathHelper . clamp _ float ( f , 0 . 0F , flag ? 1 . 5F : 1 . 0F ) ; <nl> }

TEST DIFF:
diff - - git a / fml / src / main / java / net / minecraftforge / fml / client / GuiModList . java b / fml / src / main / java / net / minecraftforge / fml / client / GuiModList . java 
 index d33a83d . . 39c1808 100644 
 - - - a / fml / src / main / java / net / minecraftforge / fml / client / GuiModList . java 
 + + + b / fml / src / main / java / net / minecraftforge / fml / client / GuiModList . java 
 @ @ - 19 , 6 + 19 , 9 @ @ import java . awt . image . BufferedImage ; 
 import java . io . IOException ; 
 import java . io . InputStream ; 
 import java . util . ArrayList ; 
 + import java . util . Collections ; 
 + import java . util . Comparator ; 
 + import java . util . List ; 
 
 import javax . imageio . ImageIO ; 
 
 @ @ - 26 , 6 + 29 , 7 @ @ import net . minecraft . client . Minecraft ; 
 import net . minecraft . client . gui . FontRenderer ; 
 import net . minecraft . client . gui . GuiButton ; 
 import net . minecraft . client . gui . GuiScreen ; 
 + import net . minecraft . client . gui . GuiTextField ; 
 import net . minecraft . client . renderer . Tessellator ; 
 import net . minecraft . client . renderer . WorldRenderer ; 
 import net . minecraft . client . renderer . texture . DynamicTexture ; 
 @ @ - 49 , 6 + 53 , 28 @ @ import com . google . common . base . Strings ; 
 * / 
 public class GuiModList extends GuiScreen 
 { 
 + private enum SortType 
 + { 
 + NORMAL ( 24 ) , A _ TO _ Z ( 25 ) , Z _ TO _ A ( 26 ) ; 
 + 
 + private int buttonID ; 
 + 
 + private SortType ( int buttonID ) 
 + { 
 + this . buttonID = buttonID ; 
 + } 
 + 
 + public static SortType getTypeForButton ( GuiButton button ) 
 + { 
 + for ( SortType t : values ( ) ) { 
 + if ( t . buttonID = = button . id ) { 
 + return t ; 
 + } 
 + } 
 + return null ; 
 + } 
 + } 
 + 
 private GuiScreen mainMenu ; 
 private GuiSlotModList modList ; 
 private int selected = - 1 ; 
 @ @ - 59 , 6 + 85 , 15 @ @ public class GuiModList extends GuiScreen 
 private GuiButton disableModButton ; 
 private ResourceLocation cachedLogo ; 
 private Dimension cachedLogoDimensions ; 
 + 
 + private int buttonMargin = 1 ; 
 + private int numButtons = SortType . values ( ) . length ; 
 + 
 + private String lastFilterText = " " ; 
 + 
 + private GuiTextField search ; 
 + private boolean sorted = false ; 
 + private SortType sortType = SortType . NORMAL ; 
 
 / * * 
 * @ param mainMenu 
 @ @ - 68 , 6 + 103 , 7 @ @ public class GuiModList extends GuiScreen 
 this . mainMenu = mainMenu ; 
 this . mods = new ArrayList < ModContainer > ( ) ; 
 FMLClientHandler . instance ( ) . addSpecialModEntries ( mods ) ; 
 + / / Add child mods to their parent ' s list 
 for ( ModContainer mod : Loader . instance ( ) . getModList ( ) ) { 
 if ( mod . getMetadata ( ) ! = null & & mod . getMetadata ( ) . parentMod = = null & & ! Strings . isNullOrEmpty ( mod . getMetadata ( ) . parent ) ) { 
 String parentMod = mod . getMetadata ( ) . parent ; 
 @ @ - 81 , 7 + 117 , 7 @ @ public class GuiModList extends GuiScreen 
 } 
 else if ( mod . getMetadata ( ) ! = null & & mod . getMetadata ( ) . parentMod ! = null ) 
 { 
 - 	 continue ; 
 + continue ; 
 } 
 mods . add ( mod ) ; 
 } 
 @ @ - 96 , 21 + 132 , 133 @ @ public class GuiModList extends GuiScreen 
 listWidth = Math . max ( listWidth , getFontRenderer ( ) . getStringWidth ( mod . getVersion ( ) ) + 10 ) ; 
 } 
 listWidth = Math . min ( listWidth , 150 ) ; 
 - this . buttonList . add ( new GuiButton ( 6 , this . width / 2 - 75 , this . height - 38 , I18n . format ( " gui . done " ) ) ) ; 
 - configModButton = new GuiButton ( 20 , 10 , this . height - 60 , this . listWidth , 20 , " Config " ) ; 
 - disableModButton = new GuiButton ( 21 , 10 , this . height - 38 , this . listWidth , 20 , " Disable " ) ; 
 - this . buttonList . add ( configModButton ) ; 
 - this . buttonList . add ( disableModButton ) ; 
 this . modList = new GuiSlotModList ( this , mods , listWidth ) ; 
 this . modList . registerScrollButtons ( this . buttonList , 7 , 8 ) ; 
 + 
 + this . buttonList . add ( new GuiButton ( 6 , ( ( modList . right + this . width ) / 2 ) - 100 , this . height - 38 , I18n . format ( " gui . done " ) ) ) ; 
 + configModButton = new GuiButton ( 20 , 10 , this . height - 49 , this . listWidth , 20 , " Config " ) ; 
 + disableModButton = new GuiButton ( 21 , 10 , this . height - 27 , this . listWidth , 20 , " Disable " ) ; 
 + this . buttonList . add ( configModButton ) ; 
 + this . buttonList . add ( disableModButton ) ; 
 + 
 + search = new GuiTextField ( 0 , getFontRenderer ( ) , 12 , modList . bottom + 17 , modList . listWidth - 4 , 14 ) ; 
 + search . setFocused ( true ) ; 
 + search . setCanLoseFocus ( true ) ; 
 + 
 + int width = ( modList . listWidth / numButtons ) ; 
 + int x = 10 , y = 10 ; 
 + GuiButton normalSort = new GuiButton ( SortType . NORMAL . buttonID , x , y , width - buttonMargin , 20 , I18n . format ( " fml . menu . mods . normal " ) ) ; 
 + normalSort . enabled = false ; 
 + buttonList . add ( normalSort ) ; 
 + x + = width + buttonMargin ; 
 + buttonList . add ( new GuiButton ( SortType . A _ TO _ Z . buttonID , x , y , width - buttonMargin , 20 , " A - Z " ) ) ; 
 + x + = width + buttonMargin ; 
 + buttonList . add ( new GuiButton ( SortType . Z _ TO _ A . buttonID , x , y , width - buttonMargin , 20 , " Z - A " ) ) ; 
 + } 
 + 
 + @ Override 
 + protected void mouseClicked ( int x , int y , int button ) throws IOException 
 + { 
 + super . mouseClicked ( x , y , button ) ; 
 + search . mouseClicked ( x , y , button ) ; 
 + if ( button = = 1 & & x > = search . xPosition & & x < search . xPosition + this . width & & y > = search . yPosition & & y < search . yPosition + this . height ) { 
 + search . setText ( " " ) ; 
 + } 
 + } 
 + 
 + @ Override 
 + protected void keyTyped ( char c , int keyCode ) throws IOException 
 + { 
 + super . keyTyped ( c , keyCode ) ; 
 + search . textboxKeyTyped ( c , keyCode ) ; 
 + } 
 + 
 + @ Override 
 + public void updateScreen ( ) 
 + { 
 + super . updateScreen ( ) ; 
 + search . updateCursorCounter ( ) ; 
 + 
 + if ( ! search . getText ( ) . equals ( lastFilterText ) ) 
 + { 
 + reloadMods ( ) ; 
 + sorted = false ; 
 + } 
 + 
 + if ( ! sorted ) 
 + { 
 + switch ( sortType ) 
 + { 
 + case A _ TO _ Z : 
 + Collections . sort ( modList . getMods ( ) , new Comparator < ModContainer > ( ) 
 + { 
 + @ Override 
 + public int compare ( ModContainer o1 , ModContainer o2 ) 
 + { 
 + return o1 . getName ( ) . toLowerCase ( ) . compareTo ( o2 . getName ( ) . toLowerCase ( ) ) ; 
 + } 
 + } ) ; 
 + break ; 
 + case Z _ TO _ A : 
 + Collections . sort ( modList . getMods ( ) , new Comparator < ModContainer > ( ) 
 + { 
 + @ Override 
 + public int compare ( ModContainer o1 , ModContainer o2 ) 
 + { 
 + return o2 . getName ( ) . toLowerCase ( ) . compareTo ( o1 . getName ( ) . toLowerCase ( ) ) ; 
 + } 
 + } ) ; 
 + break ; 
 + default : 
 + reloadMods ( ) ; 
 + break ; 
 + } 
 + mods = modList . getMods ( ) ; 
 + selected = modList . selectedIndex = mods . indexOf ( selectedMod ) ; 
 + sorted = true ; 
 + } 
 + } 
 + 
 + private void reloadMods ( ) 
 + { 
 + ArrayList < ModContainer > mods = modList . getMods ( ) ; 
 + mods . clear ( ) ; 
 + for ( ModContainer m : Loader . instance ( ) . getActiveModList ( ) ) 
 + { 
 + / / If it passes the filter , and is not a child mod 
 + if ( m . getName ( ) . toLowerCase ( ) . contains ( search . getText ( ) . toLowerCase ( ) ) & & m . getMetadata ( ) . parentMod = = null ) 
 + { 
 + mods . add ( m ) ; 
 + } 
 + } 
 + this . mods = mods ; 
 + lastFilterText = search . getText ( ) ; 
 } 
 
 @ Override 
 protected void actionPerformed ( GuiButton button ) throws IOException { 
 if ( button . enabled ) 
 { 
 - switch ( button . id ) 
 + SortType type = SortType . getTypeForButton ( button ) ; 
 + 
 + if ( type ! = null ) 
 { 
 + for ( GuiButton b : ( List < GuiButton > ) buttonList ) 
 + { 
 + if ( SortType . getTypeForButton ( b ) ! = null ) 
 + { 
 + b . enabled = true ; 
 + } 
 + } 
 + button . enabled = false ; 
 + sorted = false ; 
 + sortType = type ; 
 + this . mods = modList . getMods ( ) ; 
 + } 
 + else 
 + { 
 + switch ( button . id ) 
 + { 
 case 6 : 
 this . mc . displayGuiScreen ( this . mainMenu ) ; 
 return ; 
 @ @ - 126 , 6 + 274 , 7 @ @ public class GuiModList extends GuiScreen 
 FMLLog . log ( Level . ERROR , e , " There was a critical issue trying to build the config GUI for % s " , selectedMod . getModId ( ) ) ; 
 } 
 return ; 
 + } 
 } 
 } 
 super . actionPerformed ( button ) ; 
 @ @ - 274 , 6 + 423 , 11 @ @ public class GuiModList extends GuiScreen 
 disableModButton . visible = false ; 
 } 
 super . drawScreen ( p _ 571 _ 1 _ , p _ 571 _ 2 _ , p _ 571 _ 3 _ ) ; 
 + 
 + String text = I18n . format ( " fml . menu . mods . search " ) ; 
 + int x = ( ( 10 + modList . right ) / 2 ) - ( getFontRenderer ( ) . getStringWidth ( text ) / 2 ) ; 
 + getFontRenderer ( ) . drawString ( text , x , modList . bottom + 5 , 0xFFFFFF ) ; 
 + search . drawTextBox ( ) ; 
 } 
 
 Minecraft getMinecraftInstance ( ) { 
 diff - - git a / fml / src / main / java / net / minecraftforge / fml / client / GuiScrollingList . java b / fml / src / main / java / net / minecraftforge / fml / client / GuiScrollingList . java 
 index be38ab0 . . 5810d69 100644 
 - - - a / fml / src / main / java / net / minecraftforge / fml / client / GuiScrollingList . java 
 + + + b / fml / src / main / java / net / minecraftforge / fml / client / GuiScrollingList . java 
 @ @ - 31 , 7 + 31 , 7 @ @ public abstract class GuiScrollingList 
 protected final int listHeight ; 
 protected final int top ; 
 protected final int bottom ; 
 - private final int right ; 
 + protected final int right ; 
 protected final int left ; 
 protected final int slotHeight ; 
 private int scrollUpActionId ; 
 @ @ - 41 , 7 + 41 , 7 @ @ public abstract class GuiScrollingList 
 private float initialMouseClickY = - 2 . 0F ; 
 private float scrollFactor ; 
 private float scrollDistance ; 
 - private int selectedIndex = - 1 ; 
 + protected int selectedIndex = - 1 ; 
 private long lastClickTime = 0L ; 
 private boolean field _ 25123 _ p = true ; 
 private boolean field _ 27262 _ q ; 
 diff - - git a / fml / src / main / java / net / minecraftforge / fml / client / GuiSlotModList . java b / fml / src / main / java / net / minecraftforge / fml / client / GuiSlotModList . java 
 index 69c489f . . 606dfdd 100644 
 - - - a / fml / src / main / java / net / minecraftforge / fml / client / GuiSlotModList . java 
 + + + b / fml / src / main / java / net / minecraftforge / fml / client / GuiSlotModList . java 
 @ @ - 16 , 8 + 16 , 8 @ @ import java . util . ArrayList ; 
 
 import net . minecraft . client . renderer . Tessellator ; 
 import net . minecraftforge . fml . common . Loader ; 
 - import net . minecraftforge . fml . common . ModContainer ; 
 import net . minecraftforge . fml . common . LoaderState . ModState ; 
 + import net . minecraftforge . fml . common . ModContainer ; 
 
 / * * 
 * @ author cpw 
 @ @ - 30 , 7 + 30 , 7 @ @ public class GuiSlotModList extends GuiScrollingList 
 
 public GuiSlotModList ( GuiModList parent , ArrayList < ModContainer > mods , int listWidth ) 
 { 
 - super ( parent . getMinecraftInstance ( ) , listWidth , parent . height , 32 , parent . height - 66 + 4 , 10 , 35 ) ; 
 + super ( parent . getMinecraftInstance ( ) , listWidth , parent . height , 32 , parent . height - 88 + 4 , 10 , 35 ) ; 
 this . parent = parent ; 
 this . mods = mods ; 
 } 
 @ @ - 64 , 6 + 64 , 11 @ @ public class GuiSlotModList extends GuiScrollingList 
 { 
 return ( this . getSize ( ) ) * 35 + 1 ; 
 } 
 + 
 + ArrayList < ModContainer > getMods ( ) 
 + { 
 + return mods ; 
 + } 
 
 @ Override 
 protected void drawSlot ( int listIndex , int var2 , int var3 , int var4 , Tessellator var5 ) 
 diff - - git a / fml / src / main / resources / assets / fml / lang / en _ US . lang b / fml / src / main / resources / assets / fml / lang / en _ US . lang 
 index 270d2ff . . 4ba2237 100644 
 - - - a / fml / src / main / resources / assets / fml / lang / en _ US . lang 
 + + + b / fml / src / main / resources / assets / fml / lang / en _ US . lang 
 @ @ - 82 , 4 + 82 , 6 @ @ fml . configgui . tooltip . default = [ default : % s ] 
 fml . configgui . tooltip . defaultNumeric = [ range : % s ~ % s , default : % s ] 
 
 fml . menu . mods = Mods 
 + fml . menu . mods . normal = Normal 
 + fml . menu . mods . search = Search : 
 fml . menu . modoptions = Mod Options . . .

NEAREST DIFF:
diff - - git a / client / net / minecraftforge / client / ForgeHooksClient . java b / client / net / minecraftforge / client / ForgeHooksClient . java 
 index 7c2ad32 . . dcba24b 100644 
 - - - a / client / net / minecraftforge / client / ForgeHooksClient . java 
 + + + b / client / net / minecraftforge / client / ForgeHooksClient . java 
 @ @ - 30 , 6 + 30 , 8 @ @ import net . minecraft . item . ItemStack ; 
 import net . minecraft . util . MathHelper ; 
 import net . minecraft . util . MovingObjectPosition ; 
 import net . minecraft . util . ResourceLocation ; 
 + import net . minecraft . world . World ; 
 + import net . minecraft . world . biome . BiomeGenBase ; 
 import net . minecraft . client . model . ModelBiped ; 
 import net . minecraft . client . renderer . RenderBlocks ; 
 import net . minecraft . client . renderer . RenderGlobal ; 
 @ @ - 41 , 6 + 43 , 7 @ @ import net . minecraftforge . client . IItemRenderer . ItemRenderType ; 
 import net . minecraftforge . client . event . DrawBlockHighlightEvent ; 
 import net . minecraftforge . client . event . RenderWorldLastEvent ; 
 import net . minecraftforge . client . event . TextureStitchEvent ; 
 + import net . minecraftforge . common . ForgeDummyContainer ; 
 import net . minecraftforge . common . MinecraftForge ; 
 import net . minecraftforge . fluids . FluidRegistry ; 
 import net . minecraftforge . fluids . RenderBlockFluid ; 
 @ @ - 50 , 6 + 53 , 7 @ @ import static net . minecraftforge . client . IItemRenderer . ItemRendererHelper . * ; 
 public class ForgeHooksClient 
 { 
 private static final ResourceLocation ITEM _ GLINT = new ResourceLocation ( " textures / misc / enchanted _ item _ glint . png " ) ; 
 + 
 static TextureManager engine ( ) 
 { 
 return FMLClientHandler . instance ( ) . getClient ( ) . renderEngine ; 
 @ @ - 338 , 6 + 342 , 44 @ @ public class ForgeHooksClient 
 return fovUpdateEvent . newfov ; 
 } 
 
 + private static int skyX , skyZ ; 
 + 
 + private static boolean skyInit ; 
 + private static int skyRGBMultiplier ; 
 + 
 + public static int getSkyBlendColour ( World world , int playerX , int playerZ ) 
 + { 
 + if ( playerX = = skyX & & playerZ = = skyZ & & skyInit ) 
 + { 
 + return skyRGBMultiplier ; 
 + } 
 + skyInit = true ; 
 + 
 + int distance = Minecraft . getMinecraft ( ) . gameSettings . fancyGraphics ? ForgeDummyContainer . blendRanges [ Minecraft . getMinecraft ( ) . gameSettings . renderDistance ] : 0 ; 
 + 
 + int r = 0 ; 
 + int g = 0 ; 
 + int b = 0 ; 
 + 
 + for ( int x = - distance ; x < = distance ; + + x ) 
 + { 
 + for ( int z = - distance ; z < = distance ; + + z ) 
 + { 
 + BiomeGenBase biome = world . getBiomeGenForCoords ( playerX + x , playerZ + z ) ; 
 + int colour = biome . getSkyColorByTemp ( biome . getFloatTemperature ( ) ) ; 
 + r + = ( colour & 0xFF0000 ) > > 16 ; 
 + g + = ( colour & 0x00FF00 ) > > 8 ; 
 + b + = colour & 0x0000FF ; 
 + } 
 + } 
 + 
 + int multiplier = ( r / 1681 & 255 ) < < 16 | ( g / 1681 & 255 ) < < 8 | b / 1681 & 255 ; 
 + 
 + skyX = playerX ; 
 + skyZ = playerZ ; 
 + skyRGBMultiplier = multiplier ; 
 + return skyRGBMultiplier ; 
 + } 
 / * * 
 * Initialization of Forge Renderers . 
 * / 
 diff - - git a / common / net / minecraftforge / common / ForgeDummyContainer . java b / common / net / minecraftforge / common / ForgeDummyContainer . java 
 index a8c2b27 . . 881f533 100644 
 - - - a / common / net / minecraftforge / common / ForgeDummyContainer . java 
 + + + b / common / net / minecraftforge / common / ForgeDummyContainer . java 
 @ @ - 51 , 6 + 51 , 8 @ @ public class ForgeDummyContainer extends DummyModContainer implements WorldAcces 
 public static boolean disableStitchedFileSaving = false ; 
 public static boolean forceDuplicateFluidBlockCrash = true ; 
 public static boolean fullBoundingBoxLadders = false ; 
 + 
 + public static int [ ] blendRanges = { 20 , 15 , 10 , 5 } ; 
 
 public ForgeDummyContainer ( ) 
 { 
 @ @ - 139 , 6 + 141 , 10 @ @ public class ForgeDummyContainer extends DummyModContainer implements WorldAcces 
 FMLLog . warning ( " Disabling forced crashes on duplicate Fluid Blocks - USE AT YOUR OWN RISK " ) ; 
 } 
 
 + prop = config . get ( Configuration . CATEGORY _ GENERAL , " biomeSkyBlendRange " , new int [ ] { 20 , 15 , 10 , 5 } ) ; 
 + prop . comment = " Control the range of sky blending for colored skies in biomes . " ; 
 + blendRanges = prop . getIntList ( ) ; 
 + 
 if ( config . hasChanged ( ) ) 
 { 
 config . save ( ) ; 
 diff - - git a / patches / minecraft / net / minecraft / world / World . java . patch b / patches / minecraft / net / minecraft / world / World . java . patch 
 index 3b22a59 . . 88d9ad7 100644 
 - - - a / patches / minecraft / net / minecraft / world / World . java . patch 
 + + + b / patches / minecraft / net / minecraft / world / World . java . patch 
 @ @ - 7 , 12 + 7 , 13 @ @ 
 import cpw . mods . fml . relauncher . Side ; 
 import cpw . mods . fml . relauncher . SideOnly ; 
 import java . util . ArrayList ; 
 - @ @ - 53 , 8 + 54 , 32 @ @ 
 + @ @ - 53 , 8 + 54 , 33 @ @ 
 import net . minecraft . world . storage . MapStorage ; 
 import net . minecraft . world . storage . WorldInfo ; 
 
 + import com . google . common . collect . ImmutableSetMultimap ; 
 + 
 + + import net . minecraftforge . client . ForgeHooksClient ; 
 + import net . minecraftforge . common . ForgeChunkManager ; 
 + import net . minecraftforge . common . ForgeChunkManager . Ticket ; 
 + import net . minecraftforge . common . ForgeDummyContainer ; 
 @ @ - 40 , 7 + 41 , 7 @ @ 
 / * * 
 * boolean ; if true updates scheduled by scheduleBlockUpdate happen immediately 
 * / 
 - @ @ - 167 , 6 + 192 , 11 @ @ 
 + @ @ - 167 , 6 + 193 , 11 @ @ 
 * / 
 public BiomeGenBase getBiomeGenForCoords ( int par1 , int par2 ) 
 { 
 @ @ - 52 , 7 + 53 , 7 @ @ 
 if ( this . blockExists ( par1 , 0 , par2 ) ) 
 { 
 Chunk chunk = this . getChunkFromBlockCoords ( par1 , par2 ) ; 
 - @ @ - 194 , 8 + 224 , 15 @ @ 
 + @ @ - 194 , 8 + 225 , 15 @ @ 
 this . theProfiler = par5Profiler ; 
 this . worldInfo = new WorldInfo ( par4WorldSettings , par2Str ) ; 
 this . provider = par3WorldProvider ; 
 @ @ - 69 , 7 + 70 , 7 @ @ 
 VillageCollection villagecollection = ( VillageCollection ) this . mapStorage . loadData ( VillageCollection . class , " villages " ) ; 
 
 if ( villagecollection = = null ) 
 - @ @ - 208 , 8 + 245 , 10 @ @ 
 + @ @ - 208 , 8 + 246 , 10 @ @ 
 this . villageCollectionObj = villagecollection ; 
 this . villageCollectionObj . func _ 82566 _ a ( this ) ; 
 } 
 @ @ - 82 , 7 + 83 , 7 @ @ 
 this . chunkProvider = this . createChunkProvider ( ) ; 
 this . calculateInitialSkylight ( ) ; 
 this . calculateInitialWeather ( ) ; 
 - @ @ - 221 , 7 + 260 , 7 @ @ 
 + @ @ - 221 , 7 + 261 , 7 @ @ 
 this . lightUpdateBlockList = new int [ 32768 ] ; 
 this . saveHandler = par1ISaveHandler ; 
 this . theProfiler = par5Profiler ; 
 @ @ - 91 , 7 + 92 , 7 @ @ 
 this . worldLogAgent = par6ILogAgent ; 
 this . worldInfo = par1ISaveHandler . loadWorldInfo ( ) ; 
 
 - @ @ - 275 , 12 + 314 , 20 @ @ 
 + @ @ - 275 , 12 + 315 , 20 @ @ 
 this . worldInfo . setServerInitialized ( true ) ; 
 } 
 
 @ @ - 114 , 7 + 115 , 7 @ @ 
 } 
 else 
 { 
 - @ @ - 290 , 6 + 337 , 20 @ @ 
 + @ @ - 290 , 6 + 338 , 20 @ @ 
 
 this . calculateInitialSkylight ( ) ; 
 this . calculateInitialWeather ( ) ; 
 @ @ - 135 , 7 + 136 , 7 @ @ 
 } 
 
 / * * 
 - @ @ - 373 , 7 + 434 , 8 @ @ 
 + @ @ - 373 , 7 + 435 , 8 @ @ 
 * / 
 public boolean isAirBlock ( int par1 , int par2 , int par3 ) 
 { 
 @ @ - 145 , 7 + 146 , 7 @ @ 
 } 
 
 / * * 
 - @ @ - 382 , 7 + 444 , 8 @ @ 
 + @ @ - 382 , 7 + 445 , 8 @ @ 
 public boolean blockHasTileEntity ( int par1 , int par2 , int par3 ) 
 { 
 int l = this . getBlockId ( par1 , par2 , par3 ) ; 
 @ @ - 155 , 7 + 156 , 7 @ @ 
 } 
 
 / * * 
 - @ @ - 1157 , 7 + 1220 , 7 @ @ 
 + @ @ - 1157 , 7 + 1221 , 7 @ @ 
 * / 
 public boolean isDaytime ( ) 
 { 
 @ @ - 164 , 7 + 165 , 7 @ @ 
 } 
 
 / * * 
 - @ @ - 1192 , 7 + 1255 , 7 @ @ 
 + @ @ - 1192 , 7 + 1256 , 7 @ @ 
 int l1 = this . getBlockMetadata ( l , i1 , j1 ) ; 
 Block block = Block . blocksList [ k1 ] ; 
 
 @ @ - 173 , 7 + 174 , 7 @ @ 
 { 
 MovingObjectPosition movingobjectposition = block . collisionRayTrace ( this , l , i1 , j1 , par1Vec3 , par2Vec3 ) ; 
 
 - @ @ - 1392 , 6 + 1455 , 12 @ @ 
 + @ @ - 1392 , 6 + 1456 , 12 @ @ 
 * / 
 public void playSoundAtEntity ( Entity par1Entity , String par2Str , float par3 , float par4 ) 
 { 
 @ @ - 186 , 7 + 187 , 7 @ @ 
 if ( par1Entity ! = null & & par2Str ! = null ) 
 { 
 for ( int i = 0 ; i < this . worldAccesses . size ( ) ; + + i ) 
 - @ @ - 1406 , 6 + 1475 , 12 @ @ 
 + @ @ - 1406 , 6 + 1476 , 12 @ @ 
 * / 
 public void playSoundToNearExcept ( EntityPlayer par1EntityPlayer , String par2Str , float par3 , float par4 ) 
 { 
 @ @ - 199 , 7 + 200 , 7 @ @ 
 if ( par1EntityPlayer ! = null & & par2Str ! = null ) 
 { 
 for ( int i = 0 ; i < this . worldAccesses . size ( ) ; + + i ) 
 - @ @ - 1492 , 6 + 1567 , 11 @ @ 
 + @ @ - 1492 , 6 + 1568 , 11 @ @ 
 EntityPlayer entityplayer = ( EntityPlayer ) par1Entity ; 
 this . playerEntities . add ( entityplayer ) ; 
 this . updateAllPlayersSleepingFlag ( ) ; 
 @ @ - 211 , 20 + 212 , 20 @ @ 
 } 
 
 this . getChunkFromChunkCoords ( i , j ) . addEntity ( par1Entity ) ; 
 - @ @ - 1732 , 6 + 1812 , 12 @ @ 
 - * Calculates the color for the skybox 
 + @ @ - 1733 , 6 + 1814 , 12 @ @ 
 * / 
 public Vec3 getSkyColor ( Entity par1Entity , float par2 ) 
 - + { 
 + { 
 + return provider . getSkyColor ( par1Entity , par2 ) ; 
 + } 
 + 
 + @ SideOnly ( Side . CLIENT ) 
 + public Vec3 getSkyColorBody ( Entity par1Entity , float par2 ) 
 - { 
 + + { 
 float f1 = this . getCelestialAngle ( par2 ) ; 
 float f2 = MathHelper . cos ( f1 * ( float ) Math . PI * 2 . 0F ) * 2 . 0F + 0 . 5F ; 
 - @ @ - 1831 , 15 + 1831 , 31 @ @ 
 + 
 + @ @ - 1745 , 15 + 1832 , 15 @ @ 
 { 
 f2 = 1 . 0F ; 
 } 
 @ @ - 239 , 23 + 240 , 7 @ @ 
 - float f5 = ( float ) ( k > > 8 & 255 ) / 255 . 0F ; 
 - float f6 = ( float ) ( k & 255 ) / 255 . 0F ; 
 + 
 - + int r = 0 ; 
 - + int g = 0 ; 
 - + int b = 0 ; 
 - + 
 - + for ( int x = - 20 ; x < = 20 ; + + x ) 
 - + { 
 - + for ( int z = - 20 ; z < = 20 ; + + z ) 
 - + { 
 - + BiomeGenBase biome = this . getBiomeGenForCoords ( i + x , j + z ) ; 
 - + int colour = biome . getSkyColorByTemp ( biome . getFloatTemperature ( ) ) ; 
 - + r + = ( colour & 16711680 ) > > 16 ; 
 - + g + = ( colour & 65280 ) > > 8 ; 
 - + b + = colour & 255 ; 
 - + } 
 - + } 
 - + 
 - + int multiplier = ( r / 1681 & 255 ) < < 16 | ( g / 1681 & 255 ) < < 8 | b / 1681 & 255 ; 
 + + int multiplier = ForgeHooksClient . getSkyBlendColour ( this , i , j ) ; 
 + 
 + float f4 = ( float ) ( multiplier > > 16 & 255 ) / 255 . 0F ; 
 + float f5 = ( float ) ( multiplier > > 8 & 255 ) / 255 . 0F ; 
 @ @ - 263 , 7 + 248 , 7 @ @ 
 f4 * = f2 ; 
 f5 * = f2 ; 
 f6 * = f2 ; 
 - @ @ - 1833 , 6 + 1919 , 12 @ @ 
 + @ @ - 1833 , 6 + 1920 , 12 @ @ 
 @ SideOnly ( Side . CLIENT ) 
 public Vec3 getCloudColour ( float par1 ) 
 { 
 @ @ - 276 , 7 + 261 , 7 @ @ 
 float f1 = this . getCelestialAngle ( par1 ) ; 
 float f2 = MathHelper . cos ( f1 * ( float ) Math . PI * 2 . 0F ) * 2 . 0F + 0 . 5F ; 
 
 - @ @ - 1904 , 6 + 1996 , 8 @ @ 
 + @ @ - 1904 , 6 + 1997 , 8 @ @ 
 public int getTopSolidOrLiquidBlock ( int par1 , int par2 ) 
 { 
 Chunk chunk = this . getChunkFromBlockCoords ( par1 , par2 ) ; 
 @ @ - 285 , 7 + 270 , 7 @ @ 
 int k = chunk . getTopFilledSegment ( ) + 15 ; 
 par1 & = 15 ; 
 
 - @ @ - 1911 , 7 + 2005 , 7 @ @ 
 + @ @ - 1911 , 7 + 2006 , 7 @ @ 
 { 
 int l = chunk . getBlockID ( par1 , k , par2 ) ; 
 
 @ @ - 294 , 7 + 279 , 7 @ @ 
 { 
 return k + 1 ; 
 } 
 - @ @ - 1926 , 6 + 2020 , 12 @ @ 
 + @ @ - 1926 , 6 + 2021 , 12 @ @ 
 * How bright are stars in the sky 
 * / 
 public float getStarBrightness ( float par1 ) 
 @ @ - 307 , 7 + 292 , 7 @ @ 
 { 
 float f1 = this . getCelestialAngle ( par1 ) ; 
 float f2 = 1 . 0F - ( MathHelper . cos ( f1 * ( float ) Math . PI * 2 . 0F ) * 2 . 0F + 0 . 25F ) ; 
 - @ @ - 1990 , 7 + 2090 , 15 @ @ 
 + @ @ - 1990 , 7 + 2091 , 15 @ @ 
 entity . addEntityCrashInfo ( crashreportcategory ) ; 
 } 
 
 @ @ - 324 , 7 + 309 , 7 @ @ 
 } 
 
 if ( entity . isDead ) 
 - @ @ - 2052 , 7 + 2160 , 16 @ @ 
 + @ @ - 2052 , 7 + 2161 , 16 @ @ 
 crashreport = CrashReport . makeCrashReport ( throwable1 , " Ticking entity " ) ; 
 crashreportcategory = crashreport . makeCategory ( " Entity being ticked " ) ; 
 entity . addEntityCrashInfo ( crashreportcategory ) ; 
 @ @ - 342 , 7 + 327 , 7 @ @ 
 } 
 } 
 
 - @ @ - 2095 , 7 + 2212 , 16 @ @ 
 + @ @ - 2095 , 7 + 2213 , 16 @ @ 
 crashreport = CrashReport . makeCrashReport ( throwable2 , " Ticking tile entity " ) ; 
 crashreportcategory = crashreport . makeCategory ( " Tile entity being ticked " ) ; 
 tileentity . func _ 85027 _ a ( crashreportcategory ) ; 
 @ @ - 360 , 7 + 345 , 7 @ @ 
 } 
 } 
 
 - @ @ - 2109 , 7 + 2235 , 7 @ @ 
 + @ @ - 2109 , 7 + 2236 , 7 @ @ 
 
 if ( chunk ! = null ) 
 { 
 @ @ - 369 , 7 + 354 , 7 @ @ 
 } 
 } 
 } 
 - @ @ - 2118 , 6 + 2244 , 10 @ @ 
 + @ @ - 2118 , 6 + 2245 , 10 @ @ 
 
 if ( ! this . entityRemoval . isEmpty ( ) ) 
 { 
 @ @ - 380 , 7 + 365 , 7 @ @ 
 this . loadedTileEntityList . removeAll ( this . entityRemoval ) ; 
 this . entityRemoval . clear ( ) ; 
 } 
 - @ @ - 2138 , 18 + 2268 , 18 @ @ 
 + @ @ - 2138 , 18 + 2269 , 18 @ @ 
 { 
 this . loadedTileEntityList . add ( tileentity1 ) ; 
 } 
 @ @ - 403 , 7 + 388 , 7 @ @ 
 } 
 } 
 
 - @ @ - 2162 , 13 + 2292 , 13 @ @ 
 + @ @ - 2162 , 13 + 2293 , 13 @ @ 
 
 public void addTileEntity ( Collection par1Collection ) 
 { 
 @ @ - 424 , 7 + 409 , 7 @ @ 
 } 
 } 
 
 - @ @ - 2188 , 9 + 2318 , 17 @ @ 
 + @ @ - 2188 , 9 + 2319 , 17 @ @ 
 { 
 int i = MathHelper . floor _ double ( par1Entity . posX ) ; 
 int j = MathHelper . floor _ double ( par1Entity . posZ ) ; 
 @ @ - 445 , 7 + 430 , 7 @ @ 
 { 
 par1Entity . lastTickPosX = par1Entity . posX ; 
 par1Entity . lastTickPosY = par1Entity . posY ; 
 - @ @ - 2424 , 6 + 2562 , 14 @ @ 
 + @ @ - 2424 , 6 + 2563 , 14 @ @ 
 { 
 return true ; 
 } 
 @ @ - 460 , 7 + 445 , 7 @ @ 
 } 
 } 
 } 
 - @ @ - 2746 , 15 + 2892 , 16 @ @ 
 + @ @ - 2746 , 15 + 2893 , 16 @ @ 
 * / 
 public void setBlockTileEntity ( int par1 , int par2 , int par3 , TileEntity par4TileEntity ) 
 { 
 @ @ - 486 , 7 + 471 , 7 @ @ 
 while ( iterator . hasNext ( ) ) 
 { 
 TileEntity tileentity1 = ( TileEntity ) iterator . next ( ) ; 
 - @ @ - 2765 , 20 + 2912 , 21 @ @ 
 + @ @ - 2765 , 20 + 2913 , 21 @ @ 
 iterator . remove ( ) ; 
 } 
 } 
 @ @ - 519 , 7 + 504 , 7 @ @ 
 } 
 
 / * * 
 - @ @ - 2786 , 28 + 2934 , 13 @ @ 
 + @ @ - 2786 , 28 + 2935 , 13 @ @ 
 * / 
 public void removeBlockTileEntity ( int par1 , int par2 , int par3 ) 
 { 
 @ @ - 555 , 7 + 540 , 7 @ @ 
 } 
 
 / * * 
 - @ @ - 2832 , 7 + 2965 , 8 @ @ 
 + @ @ - 2832 , 7 + 2966 , 8 @ @ 
 * / 
 public boolean isBlockNormalCube ( int par1 , int par2 , int par3 ) 
 { 
 @ @ - 565 , 7 + 550 , 7 @ @ 
 } 
 
 public boolean isBlockFullCube ( int par1 , int par2 , int par3 ) 
 - @ @ - 2855 , 16 + 2989 , 17 @ @ 
 + @ @ - 2855 , 16 + 2990 , 17 @ @ 
 * / 
 public boolean doesBlockHaveSolidTopSurface ( int par1 , int par2 , int par3 ) 
 { 
 @ @ - 585 , 7 + 570 , 7 @ @ 
 return par1Block = = null ? false : ( par1Block . blockMaterial . isOpaque ( ) & & par1Block . renderAsNormalBlock ( ) ? true : ( par1Block instanceof BlockStairs ? ( par2 & 4 ) = = 4 : ( par1Block instanceof BlockHalfSlab ? ( par2 & 8 ) = = 8 : ( par1Block instanceof BlockHopper ? true : ( par1Block instanceof BlockSnow ? ( par2 & 7 ) = = 7 : false ) ) ) ) ) ; 
 } 
 
 - @ @ - 2881 , 7 + 3016 , 7 @ @ 
 + @ @ - 2881 , 7 + 3017 , 7 @ @ 
 if ( chunk ! = null & & ! chunk . isEmpty ( ) ) 
 { 
 Block block = Block . blocksList [ this . getBlockId ( par1 , par2 , par3 ) ] ; 
 @ @ - 594 , 7 + 579 , 7 @ @ 
 } 
 else 
 { 
 - @ @ - 2912 , 8 + 3047 , 7 @ @ 
 + @ @ - 2912 , 8 + 3048 , 7 @ @ 
 * / 
 public void setAllowedSpawnTypes ( boolean par1 , boolean par2 ) 
 { 
 @ @ - 604 , 7 + 589 , 7 @ @ 
 } 
 
 / * * 
 - @ @ - 2929 , 6 + 3063 , 11 @ @ 
 + @ @ - 2929 , 6 + 3064 , 11 @ @ 
 * / 
 private void calculateInitialWeather ( ) 
 { 
 @ @ - 616 , 7 + 601 , 7 @ @ 
 if ( this . worldInfo . isRaining ( ) ) 
 { 
 this . rainingStrength = 1 . 0F ; 
 - @ @ - 2944 , 6 + 3083 , 11 @ @ 
 + @ @ - 2944 , 6 + 3084 , 11 @ @ 
 * Updates all weather states . 
 * / 
 protected void updateWeather ( ) 
 @ @ - 628 , 7 + 613 , 7 @ @ 
 { 
 if ( ! this . provider . hasNoSky ) 
 { 
 - @ @ - 3041 , 12 + 3185 , 14 @ @ 
 + @ @ - 3041 , 12 + 3186 , 14 @ @ 
 
 public void toggleRain ( ) 
 { 
 @ @ - 644 , 7 + 629 , 7 @ @ 
 this . theProfiler . startSection ( " buildList " ) ; 
 int i ; 
 EntityPlayer entityplayer ; 
 - @ @ - 3153 , 6 + 3299 , 11 @ @ 
 + @ @ - 3153 , 6 + 3300 , 11 @ @ 
 * / 
 public boolean canBlockFreeze ( int par1 , int par2 , int par3 , boolean par4 ) 
 { 
 @ @ - 656 , 7 + 641 , 7 @ @ 
 BiomeGenBase biomegenbase = this . getBiomeGenForCoords ( par1 , par3 ) ; 
 float f = biomegenbase . getFloatTemperature ( ) ; 
 
 - @ @ - 3211 , 6 + 3362 , 11 @ @ 
 + @ @ - 3211 , 6 + 3363 , 11 @ @ 
 * / 
 public boolean canSnowAt ( int par1 , int par2 , int par3 ) 
 { 
 @ @ - 668 , 7 + 653 , 7 @ @ 
 BiomeGenBase biomegenbase = this . getBiomeGenForCoords ( par1 , par3 ) ; 
 float f = biomegenbase . getFloatTemperature ( ) ; 
 
 - @ @ - 3254 , 10 + 3410 , 12 @ @ 
 + @ @ - 3254 , 10 + 3411 , 12 @ @ 
 else 
 { 
 int l = this . getBlockId ( par1 , par2 , par3 ) ; 
 @ @ - 685 , 7 + 670 , 7 @ @ 
 { 
 j1 = 1 ; 
 } 
 - @ @ - 3353 , 7 + 3511 , 9 @ @ 
 + @ @ - 3353 , 7 + 3512 , 9 @ @ 
 int j4 = i2 + Facing . offsetsXForSide [ i4 ] ; 
 int k4 = j2 + Facing . offsetsYForSide [ i4 ] ; 
 int l4 = k2 + Facing . offsetsZForSide [ i4 ] ; 
 @ @ - 696 , 7 + 681 , 7 @ @ 
 i3 = this . getSavedLightValue ( par1EnumSkyBlock , j4 , k4 , l4 ) ; 
 
 if ( i3 = = l2 - i5 & & i1 < this . lightUpdateBlockList . length ) 
 - @ @ - 3456 , 10 + 3616 , 10 @ @ 
 + @ @ - 3456 , 10 + 3617 , 10 @ @ 
 public List getEntitiesWithinAABBExcludingEntity ( Entity par1Entity , AxisAlignedBB par2AxisAlignedBB , IEntitySelector par3IEntitySelector ) 
 { 
 ArrayList arraylist = new ArrayList ( ) ; 
 @ @ - 711 , 7 + 696 , 7 @ @ 
 
 for ( int i1 = i ; i1 < = j ; + + i1 ) 
 { 
 - @ @ - 3485 , 10 + 3645 , 10 @ @ 
 + @ @ - 3485 , 10 + 3646 , 10 @ @ 
 
 public List selectEntitiesWithinAABB ( Class par1Class , AxisAlignedBB par2AxisAlignedBB , IEntitySelector par3IEntitySelector ) 
 { 
 @ @ - 726 , 7 + 711 , 7 @ @ 
 ArrayList arraylist = new ArrayList ( ) ; 
 
 for ( int i1 = i ; i1 < = j ; + + i1 ) 
 - @ @ - 3582 , 11 + 3742 , 14 @ @ 
 + @ @ - 3582 , 11 + 3743 , 14 @ @ 
 * / 
 public void addLoadedEntities ( List par1List ) 
 { 
 @ @ - 744 , 7 + 729 , 7 @ @ 
 } 
 } 
 
 - @ @ - 3620 , 6 + 3783 , 11 @ @ 
 + @ @ - 3620 , 6 + 3784 , 11 @ @ 
 else 
 { 
 if ( block ! = null & & ( block = = Block . waterMoving | | block = = Block . waterStill | | block = = Block . lavaMoving | | block = = Block . lavaStill | | block = = Block . fire | | block . blockMaterial . isReplaceable ( ) ) ) 
 @ @ - 756 , 7 + 741 , 7 @ @ 
 { 
 block = null ; 
 } 
 - @ @ - 3914 , 7 + 4082 , 7 @ @ 
 + @ @ - 3914 , 7 + 4083 , 7 @ @ 
 * / 
 public long getSeed ( ) 
 { 
 @ @ - 765 , 7 + 750 , 7 @ @ 
 } 
 
 public long getTotalWorldTime ( ) 
 - @ @ - 3924 , 7 + 4092 , 7 @ @ 
 + @ @ - 3924 , 7 + 4093 , 7 @ @ 
 
 public long getWorldTime ( ) 
 { 
 @ @ - 774 , 7 + 759 , 7 @ @ 
 } 
 
 / * * 
 - @ @ - 3932 , 7 + 4100 , 7 @ @ 
 + @ @ - 3932 , 7 + 4101 , 7 @ @ 
 * / 
 public void setWorldTime ( long par1 ) 
 { 
 @ @ - 783 , 7 + 768 , 7 @ @ 
 } 
 
 / * * 
 - @ @ - 3940 , 13 + 4108 , 13 @ @ 
 + @ @ - 3940 , 13 + 4109 , 13 @ @ 
 * / 
 public ChunkCoordinates getSpawnPoint ( ) 
 { 
 @ @ - 799 , 7 + 784 , 7 @ @ 
 } 
 
 @ SideOnly ( Side . CLIENT ) 
 - @ @ - 3970 , 7 + 4138 , 10 @ @ 
 + @ @ - 3970 , 7 + 4139 , 10 @ @ 
 
 if ( ! this . loadedEntityList . contains ( par1Entity ) ) 
 { 
 @ @ - 811 , 7 + 796 , 7 @ @ 
 } 
 } 
 
 - @ @ - 3978 , 6 + 4149 , 11 @ @ 
 + @ @ - 3978 , 6 + 4150 , 11 @ @ 
 * Called when checking if a certain block can be mined or not . The ' spawn safe zone ' check is located here . 
 * / 
 public boolean canMineBlock ( EntityPlayer par1EntityPlayer , int par2 , int par3 , int par4 ) 
 @ @ - 823 , 7 + 808 , 7 @ @ 
 { 
 return true ; 
 } 
 - @ @ - 4098 , 8 + 4274 , 7 @ @ 
 + @ @ - 4098 , 8 + 4275 , 7 @ @ 
 * / 
 public boolean isBlockHighHumidity ( int par1 , int par2 , int par3 ) 
 { 
 @ @ - 833 , 7 + 818 , 7 @ @ 
 } 
 
 / * * 
 - @ @ - 4174 , 7 + 4349 , 7 @ @ 
 + @ @ - 4174 , 7 + 4350 , 7 @ @ 
 * / 
 public int getHeight ( ) 
 { 
 @ @ - 842 , 7 + 827 , 7 @ @ 
 } 
 
 / * * 
 - @ @ - 4182 , 7 + 4357 , 7 @ @ 
 + @ @ - 4182 , 7 + 4358 , 7 @ @ 
 * / 
 public int getActualHeight ( ) 
 { 
 @ @ - 851 , 7 + 836 , 7 @ @ 
 } 
 
 public IUpdatePlayerListBox getMinecartSoundUpdater ( EntityMinecart par1EntityMinecart ) 
 - @ @ - 4225 , 7 + 4400 , 7 @ @ 
 + @ @ - 4225 , 7 + 4401 , 7 @ @ 
 * / 
 public double getHorizon ( ) 
 { 
 @ @ - 860 , 7 + 845 , 7 @ @ 
 } 
 
 / * * 
 - @ @ - 4294 , 30 + 4469 , 28 @ @ 
 + @ @ - 4294 , 30 + 4470 , 28 @ @ 
 
 public void func _ 96440 _ m ( int par1 , int par2 , int par3 , int par4 ) 
 { 
 @ @ - 912 , 7 + 897 , 7 @ @ 
 } 
 } 
 } 
 - @ @ - 4363 , 4 + 4536 , 115 @ @ 
 + @ @ - 4363 , 4 + 4537 , 115 @ @ 
 
 return MathHelper . clamp _ float ( f , 0 . 0F , flag ? 1 . 5F : 1 . 0F ) ; 
 }
