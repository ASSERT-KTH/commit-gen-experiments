BLEU SCORE: 0.07101864697284951

TEST MSG: Fixed joint animation application correctly .
GENERATED MSG: Fixed joint hierarchy not being used fully in the animation system .

TEST DIFF (one line): diff - - git a / src / main / java / net / minecraftforge / common / model / animation / Clips . java b / src / main / java / net / minecraftforge / common / model / animation / Clips . java <nl> index 8528b33 . . 7955d8b 100644 <nl> - - - a / src / main / java / net / minecraftforge / common / model / animation / Clips . java <nl> + + + b / src / main / java / net / minecraftforge / common / model / animation / Clips . java <nl> @ @ - 282 , 15 + 282 , 14 @ @ public final class Clips <nl> return Optional . absent ( ) ; <nl> } <nl> IJoint joint = ( IJoint ) part . get ( ) ; <nl> + / / TODO : Cache clip application ? <nl> TRSRTransformation jointTransform = clip . apply ( joint ) . apply ( time ) . compose ( joint . getInvBindPose ( ) ) ; <nl> - Optional < TRSRTransformation > parentTransform = Optional . absent ( ) ; <nl> - if ( joint . getParent ( ) . isPresent ( ) ) <nl> + Optional < ? extends IJoint > parent = joint . getParent ( ) ; <nl> + while ( parent . isPresent ( ) ) <nl> { <nl> - parentTransform = apply ( Optional . of ( joint . getParent ( ) . get ( ) ) ) ; <nl> - } <nl> - if ( parentTransform . isPresent ( ) ) <nl> - { <nl> - jointTransform = parentTransform . get ( ) . compose ( jointTransform ) ; <nl> + TRSRTransformation parentTransform = clip . apply ( parent . get ( ) ) . apply ( time ) ; <nl> + jointTransform = parentTransform . compose ( jointTransform ) ; <nl> + parent = parent . get ( ) . getParent ( ) ; <nl> } <nl> return Optional . of ( jointTransform ) ; <nl> }
NEAREST DIFF (one line): diff - - git a / src / main / java / net / minecraftforge / common / model / animation / Clips . java b / src / main / java / net / minecraftforge / common / model / animation / Clips . java <nl> index 7f588db . . 8528b33 100644 <nl> - - - a / src / main / java / net / minecraftforge / common / model / animation / Clips . java <nl> + + + b / src / main / java / net / minecraftforge / common / model / animation / Clips . java <nl> @ @ - 282 , 11 + 282 , 17 @ @ public final class Clips <nl> return Optional . absent ( ) ; <nl> } <nl> IJoint joint = ( IJoint ) part . get ( ) ; <nl> - if ( ! joint . getParent ( ) . isPresent ( ) ) <nl> + TRSRTransformation jointTransform = clip . apply ( joint ) . apply ( time ) . compose ( joint . getInvBindPose ( ) ) ; <nl> + Optional < TRSRTransformation > parentTransform = Optional . absent ( ) ; <nl> + if ( joint . getParent ( ) . isPresent ( ) ) <nl> { <nl> - return Optional . of ( clip . apply ( joint ) . apply ( time ) . compose ( joint . getInvBindPose ( ) ) ) ; <nl> + parentTransform = apply ( Optional . of ( joint . getParent ( ) . get ( ) ) ) ; <nl> } <nl> - return Optional . of ( clip . apply ( joint . getParent ( ) . get ( ) ) . apply ( time ) . compose ( clip . apply ( joint ) . apply ( time ) ) . compose ( joint . getInvBindPose ( ) ) ) ; <nl> + if ( parentTransform . isPresent ( ) ) <nl> + { <nl> + jointTransform = parentTransform . get ( ) . compose ( jointTransform ) ; <nl> + } <nl> + return Optional . of ( jointTransform ) ; <nl> } <nl> } , clip . pastEvents ( lastPollTime , time ) ) ; <nl> }

TEST DIFF:
diff - - git a / src / main / java / net / minecraftforge / common / model / animation / Clips . java b / src / main / java / net / minecraftforge / common / model / animation / Clips . java 
 index 8528b33 . . 7955d8b 100644 
 - - - a / src / main / java / net / minecraftforge / common / model / animation / Clips . java 
 + + + b / src / main / java / net / minecraftforge / common / model / animation / Clips . java 
 @ @ - 282 , 15 + 282 , 14 @ @ public final class Clips 
 return Optional . absent ( ) ; 
 } 
 IJoint joint = ( IJoint ) part . get ( ) ; 
 + / / TODO : Cache clip application ? 
 TRSRTransformation jointTransform = clip . apply ( joint ) . apply ( time ) . compose ( joint . getInvBindPose ( ) ) ; 
 - Optional < TRSRTransformation > parentTransform = Optional . absent ( ) ; 
 - if ( joint . getParent ( ) . isPresent ( ) ) 
 + Optional < ? extends IJoint > parent = joint . getParent ( ) ; 
 + while ( parent . isPresent ( ) ) 
 { 
 - parentTransform = apply ( Optional . of ( joint . getParent ( ) . get ( ) ) ) ; 
 - } 
 - if ( parentTransform . isPresent ( ) ) 
 - { 
 - jointTransform = parentTransform . get ( ) . compose ( jointTransform ) ; 
 + TRSRTransformation parentTransform = clip . apply ( parent . get ( ) ) . apply ( time ) ; 
 + jointTransform = parentTransform . compose ( jointTransform ) ; 
 + parent = parent . get ( ) . getParent ( ) ; 
 } 
 return Optional . of ( jointTransform ) ; 
 }

NEAREST DIFF:
diff - - git a / src / main / java / net / minecraftforge / common / model / animation / Clips . java b / src / main / java / net / minecraftforge / common / model / animation / Clips . java 
 index 7f588db . . 8528b33 100644 
 - - - a / src / main / java / net / minecraftforge / common / model / animation / Clips . java 
 + + + b / src / main / java / net / minecraftforge / common / model / animation / Clips . java 
 @ @ - 282 , 11 + 282 , 17 @ @ public final class Clips 
 return Optional . absent ( ) ; 
 } 
 IJoint joint = ( IJoint ) part . get ( ) ; 
 - if ( ! joint . getParent ( ) . isPresent ( ) ) 
 + TRSRTransformation jointTransform = clip . apply ( joint ) . apply ( time ) . compose ( joint . getInvBindPose ( ) ) ; 
 + Optional < TRSRTransformation > parentTransform = Optional . absent ( ) ; 
 + if ( joint . getParent ( ) . isPresent ( ) ) 
 { 
 - return Optional . of ( clip . apply ( joint ) . apply ( time ) . compose ( joint . getInvBindPose ( ) ) ) ; 
 + parentTransform = apply ( Optional . of ( joint . getParent ( ) . get ( ) ) ) ; 
 } 
 - return Optional . of ( clip . apply ( joint . getParent ( ) . get ( ) ) . apply ( time ) . compose ( clip . apply ( joint ) . apply ( time ) ) . compose ( joint . getInvBindPose ( ) ) ) ; 
 + if ( parentTransform . isPresent ( ) ) 
 + { 
 + jointTransform = parentTransform . get ( ) . compose ( jointTransform ) ; 
 + } 
 + return Optional . of ( jointTransform ) ; 
 } 
 } , clip . pastEvents ( lastPollTime , time ) ) ; 
 }
