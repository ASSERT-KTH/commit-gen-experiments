BLEU SCORE: 0.018155431088372653

TEST MSG: IntegratedServer , World , EnumChatFormatting and EnumFacing
GENERATED MSG: Fix player push out of blocks clientside being hardcoded and not based on entity size .

TEST DIFF (one line): diff - - git a / patches / minecraft / net / minecraft / server / integrated / IntegratedServer . java . patch b / patches / minecraft / net / minecraft / server / integrated / IntegratedServer . java . patch <nl> index 60e46c1 . . 72385a8 100644 <nl> - - - a / patches / minecraft / net / minecraft / server / integrated / IntegratedServer . java . patch <nl> + + + b / patches / minecraft / net / minecraft / server / integrated / IntegratedServer . java . patch <nl> @ @ - 9 , 7 + 9 , 64 @ @ <nl> ISaveHandler isavehandler = this . getActiveAnvilConverter ( ) . getSaveLoader ( p _ 71247 _ 1 _ , true ) ; <nl> this . setResourcePackFromWorld ( this . getFolderName ( ) , isavehandler ) ; <nl> WorldInfo worldinfo = isavehandler . loadWorldInfo ( ) ; <nl> - @ @ - 142 , 9 + 140 , 10 @ @ <nl> + @ @ - 87 , 44 + 85 , 24 @ @ <nl> + worldinfo . setWorldName ( p _ 71247 _ 2 _ ) ; <nl> + } <nl> + <nl> + - for ( int i = 0 ; i < this . worldServers . length ; + + i ) <nl> + - { <nl> + - int j = 0 ; <nl> + + WorldServer overWorld = ( isDemo ( ) ? ( WorldServer ) ( new DemoWorldServer ( this , isavehandler , worldinfo , 0 , this . theProfiler ) ) . init ( ) : <nl> + + ( WorldServer ) ( new WorldServer ( this , isavehandler , worldinfo , 0 , this . theProfiler ) ) . init ( ) ) ; <nl> + + overWorld . initialize ( this . theWorldSettings ) ; <nl> + <nl> + - if ( i = = 1 ) <nl> + + for ( int dim : net . minecraftforge . common . DimensionManager . getStaticDimensionIDs ( ) ) <nl> + + { <nl> + + WorldServer world = ( dim = = 0 ? overWorld : ( WorldServer ) ( new WorldServerMulti ( this , isavehandler , dim , overWorld , this . theProfiler ) ) . init ( ) ) ; <nl> + + world . addWorldAccess ( new WorldManager ( this , world ) ) ; <nl> + + if ( ! this . isSinglePlayer ( ) ) <nl> + { <nl> + - j = - 1 ; <nl> + + world . getWorldInfo ( ) . setGameType ( getGameType ( ) ) ; <nl> + } <nl> + - <nl> + - if ( i = = 2 ) <nl> + - { <nl> + - j = 1 ; <nl> + - } <nl> + - <nl> + - if ( i = = 0 ) <nl> + - { <nl> + - if ( this . isDemo ( ) ) <nl> + - { <nl> + - this . worldServers [ i ] = ( WorldServer ) ( new DemoWorldServer ( this , isavehandler , worldinfo , j , this . theProfiler ) ) . init ( ) ; <nl> + - } <nl> + - else <nl> + - { <nl> + - this . worldServers [ i ] = ( WorldServer ) ( new WorldServer ( this , isavehandler , worldinfo , j , this . theProfiler ) ) . init ( ) ; <nl> + - } <nl> + - <nl> + - this . worldServers [ i ] . initialize ( this . theWorldSettings ) ; <nl> + - } <nl> + - else <nl> + - { <nl> + - this . worldServers [ i ] = ( WorldServer ) ( new WorldServerMulti ( this , isavehandler , j , this . worldServers [ 0 ] , this . theProfiler ) ) . init ( ) ; <nl> + - } <nl> + - <nl> + - this . worldServers [ i ] . addWorldAccess ( new WorldManager ( this , this . worldServers [ i ] ) ) ; <nl> + + net . minecraftforge . common . MinecraftForge . EVENT _ BUS . post ( new net . minecraftforge . event . world . WorldEvent . Load ( world ) ) ; <nl> + } <nl> + <nl> + - this . getConfigurationManager ( ) . setPlayerManager ( this . worldServers ) ; <nl> + + this . getConfigurationManager ( ) . setPlayerManager ( new WorldServer [ ] { overWorld } ) ; <nl> + <nl> + - if ( this . worldServers [ 0 ] . getWorldInfo ( ) . getDifficulty ( ) = = null ) <nl> + + if ( overWorld . getWorldInfo ( ) . getDifficulty ( ) = = null ) <nl> + { <nl> + this . setDifficultyForAllWorlds ( this . mc . gameSettings . difficulty ) ; <nl> + } <nl> + @ @ - 142 , 9 + 120 , 10 @ @ <nl> this . setAllowFlight ( true ) ; <nl> logger . info ( " Generating keypair " ) ; <nl> this . setKeyPair ( CryptManager . generateKeyPair ( ) ) ; <nl> @ @ - 21 , 7 + 78 , 7 @ @ <nl> } <nl> <nl> public void tick ( ) <nl> - @ @ - 217 , 6 + 216 , 7 @ @ <nl> + @ @ - 217 , 6 + 196 , 7 @ @ <nl> <nl> public EnumDifficulty getDifficulty ( ) <nl> { <nl> diff - - git a / patches / minecraft / net / minecraft / world / World . java . patch b / patches / minecraft / net / minecraft / world / World . java . patch <nl> new file mode 100644 <nl> index 0000000 . . d12e541 <nl> - - - / dev / null <nl> + + + b / patches / minecraft / net / minecraft / world / World . java . patch <nl> @ @ - 0 , 0 + 1 , 869 @ @ <nl> + - - - . . / src - base / minecraft / net / minecraft / world / World . java <nl> + + + + . . / src - work / minecraft / net / minecraft / world / World . java <nl> + @ @ - 57 , 6 + 57 , 13 @ @ <nl> + <nl> + public abstract class World implements IBlockAccess <nl> + { <nl> + + / * * <nl> + + * Used in the getEntitiesWithinAABB functions to expand the search area for entities . <nl> + + * Modders should change this variable to a higher value if it is less then the radius <nl> + + * of one of there entities . <nl> + + * / <nl> + + public static double MAX _ ENTITY _ RADIUS = 2 . 0D ; <nl> + + <nl> + private int field _ 181546 _ a = 63 ; <nl> + protected boolean scheduledUpdatesAreImmediate ; <nl> + public final List < Entity > loadedEntityList = Lists . < Entity > newArrayList ( ) ; <nl> + @ @ - 99 , 6 + 106 , 10 @ @ <nl> + int [ ] lightUpdateBlockList ; <nl> + private static final String _ _ OBFID = " CL _ 00000140 " ; <nl> + <nl> + + public boolean restoringBlockSnapshots = false ; <nl> + + public boolean captureBlockSnapshots = false ; <nl> + + public java . util . ArrayList < net . minecraftforge . common . util . BlockSnapshot > capturedBlockSnapshots = new java . util . ArrayList < net . minecraftforge . common . util . BlockSnapshot > ( ) ; <nl> + + <nl> + protected World ( ISaveHandler saveHandlerIn , WorldInfo info , WorldProvider providerIn , Profiler profilerIn , boolean client ) <nl> + { <nl> + this . ambientTickCountdown = this . rand . nextInt ( 12000 ) ; <nl> + @ @ - 111 , 6 + 122 , 7 @ @ <nl> + this . provider = providerIn ; <nl> + this . isRemote = client ; <nl> + this . worldBorder = providerIn . getWorldBorder ( ) ; <nl> + + perWorldStorage = new MapStorage ( ( ISaveHandler ) null ) ; <nl> + } <nl> + <nl> + public World init ( ) <nl> + @ @ - 120 , 6 + 132 , 11 @ @ <nl> + <nl> + public BiomeGenBase getBiomeGenForCoords ( final BlockPos pos ) <nl> + { <nl> + + return this . provider . getBiomeGenForCoords ( pos ) ; <nl> + + } <nl> + + <nl> + + public BiomeGenBase getBiomeGenForCoordsBody ( final BlockPos pos ) <nl> + + { <nl> + if ( this . isBlockLoaded ( pos ) ) <nl> + { <nl> + Chunk chunk = this . getChunkFromBlockCoords ( pos ) ; <nl> + @ @ - 186 , 7 + 203 , 7 @ @ <nl> + <nl> + public boolean isAirBlock ( BlockPos pos ) <nl> + { <nl> + - return this . getBlockState ( pos ) . getBlock ( ) . getMaterial ( ) = = Material . air ; <nl> + + return this . getBlockState ( pos ) . getBlock ( ) . isAir ( this , pos ) ; <nl> + } <nl> + <nl> + public boolean isBlockLoaded ( BlockPos pos ) <nl> + @ @ - 286 , 39 + 303 , 61 @ @ <nl> + { <nl> + Chunk chunk = this . getChunkFromBlockCoords ( pos ) ; <nl> + Block block = newState . getBlock ( ) ; <nl> + + <nl> + + net . minecraftforge . common . util . BlockSnapshot blockSnapshot = null ; <nl> + + if ( this . captureBlockSnapshots & & ! this . isRemote ) <nl> + + { <nl> + + blockSnapshot = net . minecraftforge . common . util . BlockSnapshot . getBlockSnapshot ( this , pos , flags ) ; <nl> + + this . capturedBlockSnapshots . add ( blockSnapshot ) ; <nl> + + } <nl> + + int oldLight = getBlockState ( pos ) . getBlock ( ) . getLightValue ( this , pos ) ; <nl> + + <nl> + IBlockState iblockstate = chunk . setBlockState ( pos , newState ) ; <nl> + <nl> + if ( iblockstate = = null ) <nl> + { <nl> + + if ( blockSnapshot ! = null ) this . capturedBlockSnapshots . remove ( blockSnapshot ) ; <nl> + return false ; <nl> + } <nl> + else <nl> + { <nl> + Block block1 = iblockstate . getBlock ( ) ; <nl> + <nl> + - if ( block . getLightOpacity ( ) ! = block1 . getLightOpacity ( ) | | block . getLightValue ( ) ! = block1 . getLightValue ( ) ) <nl> + + if ( block . getLightOpacity ( ) ! = block1 . getLightOpacity ( ) | | block . getLightValue ( this , pos ) ! = block1 . getLightValue ( ) ) <nl> + { <nl> + this . theProfiler . startSection ( " checkLight " ) ; <nl> + this . checkLight ( pos ) ; <nl> + this . theProfiler . endSection ( ) ; <nl> + } <nl> + <nl> + - if ( ( flags & 2 ) ! = 0 & & ( ! this . isRemote | | ( flags & 4 ) = = 0 ) & & chunk . isPopulated ( ) ) <nl> + + if ( blockSnapshot = = null ) / / Don ' t notify clients or update physics while capturing blockstates <nl> + { <nl> + - this . markBlockForUpdate ( pos ) ; <nl> + + this . markAndNotifyBlock ( pos , chunk , iblockstate , newState , flags ) ; / / Modularize client and physic updates <nl> + } <nl> + <nl> + + return true ; <nl> + + } <nl> + + } <nl> + + } <nl> + + <nl> + + / / Split off from original setBlockState ( BlockPos , IBlockState Block p _ 147465 _ 4 _ , int ) method in order to directly send client and physic updates <nl> + + public void markAndNotifyBlock ( BlockPos pos , Chunk chunk , IBlockState old , IBlockState new _ , int flags ) <nl> + + { <nl> + + if ( ( flags & 2 ) ! = 0 & & ( ! this . isRemote | | ( flags & 4 ) = = 0 ) & & ( chunk = = null | | chunk . isPopulated ( ) ) ) <nl> + + { <nl> + + this . markBlockForUpdate ( pos ) ; <nl> + + } <nl> + + { <nl> + + { <nl> + if ( ! this . isRemote & & ( flags & 1 ) ! = 0 ) <nl> + { <nl> + - this . notifyNeighborsRespectDebug ( pos , iblockstate . getBlock ( ) ) ; <nl> + + this . notifyNeighborsRespectDebug ( pos , new _ . getBlock ( ) ) ; <nl> + <nl> + - if ( block . hasComparatorInputOverride ( ) ) <nl> + + if ( new _ . getBlock ( ) . hasComparatorInputOverride ( ) ) <nl> + { <nl> + - this . updateComparatorOutputLevel ( pos , block ) ; <nl> + + this . updateComparatorOutputLevel ( pos , new _ . getBlock ( ) ) ; <nl> + } <nl> + } <nl> + - <nl> + - return true ; <nl> + } <nl> + } <nl> + } <nl> + @ @ - 406 , 6 + 445 , 9 @ @ <nl> + <nl> + public void notifyNeighborsOfStateChange ( BlockPos pos , Block blockType ) <nl> + { <nl> + + if ( net . minecraftforge . event . ForgeEventFactory . onNeighborNotify ( this , pos , this . getBlockState ( pos ) , java . util . EnumSet . allOf ( EnumFacing . class ) ) . isCanceled ( ) ) <nl> + + return ; <nl> + + <nl> + this . notifyBlockOfStateChange ( pos . west ( ) , blockType ) ; <nl> + this . notifyBlockOfStateChange ( pos . east ( ) , blockType ) ; <nl> + this . notifyBlockOfStateChange ( pos . down ( ) , blockType ) ; <nl> + @ @ - 416 , 6 + 458 , 11 @ @ <nl> + <nl> + public void notifyNeighborsOfStateExcept ( BlockPos pos , Block blockType , EnumFacing skipSide ) <nl> + { <nl> + + java . util . EnumSet < EnumFacing > directions = java . util . EnumSet . allOf ( EnumFacing . class ) ; <nl> + + directions . remove ( skipSide ) ; <nl> + + if ( net . minecraftforge . event . ForgeEventFactory . onNeighborNotify ( this , pos , this . getBlockState ( pos ) , directions ) . isCanceled ( ) ) <nl> + + return ; <nl> + + <nl> + if ( skipSide ! = EnumFacing . WEST ) <nl> + { <nl> + this . notifyBlockOfStateChange ( pos . west ( ) , blockType ) ; <nl> + @ @ - 780 , 7 + 827 , 7 @ @ <nl> + <nl> + public boolean isDaytime ( ) <nl> + { <nl> + - return this . skylightSubtracted < 4 ; <nl> + + return this . provider . isDaytime ( ) ; <nl> + } <nl> + <nl> + public MovingObjectPosition rayTraceBlocks ( Vec3 p _ 72933 _ 1 _ , Vec3 p _ 72933 _ 2 _ ) <nl> + @ @ - 975 , 6 + 1022 , 12 @ @ <nl> + <nl> + public void playSoundAtEntity ( Entity p _ 72956 _ 1 _ , String p _ 72956 _ 2 _ , float p _ 72956 _ 3 _ , float p _ 72956 _ 4 _ ) <nl> + { <nl> + + net . minecraftforge . event . entity . PlaySoundAtEntityEvent event = net . minecraftforge . event . ForgeEventFactory . onPlaySoundAtEntity ( p _ 72956 _ 1 _ , p _ 72956 _ 2 _ , p _ 72956 _ 3 _ , p _ 72956 _ 4 _ ) ; <nl> + + if ( event . isCanceled ( ) | | event . name = = null ) return ; <nl> + + p _ 72956 _ 2 _ = event . name ; <nl> + + p _ 72956 _ 3 _ = event . newVolume ; <nl> + + p _ 72956 _ 4 _ = event . newPitch ; <nl> + + <nl> + for ( int i = 0 ; i < this . worldAccesses . size ( ) ; + + i ) <nl> + { <nl> + ( ( IWorldAccess ) this . worldAccesses . get ( i ) ) . playSound ( p _ 72956 _ 2 _ , p _ 72956 _ 1 _ . posX , p _ 72956 _ 1 _ . posY , p _ 72956 _ 1 _ . posZ , p _ 72956 _ 3 _ , p _ 72956 _ 4 _ ) ; <nl> + @ @ - 983 , 6 + 1036 , 12 @ @ <nl> + <nl> + public void playSoundToNearExcept ( EntityPlayer p _ 85173 _ 1 _ , String p _ 85173 _ 2 _ , float p _ 85173 _ 3 _ , float p _ 85173 _ 4 _ ) <nl> + { <nl> + + net . minecraftforge . event . entity . PlaySoundAtEntityEvent event = net . minecraftforge . event . ForgeEventFactory . onPlaySoundAtEntity ( p _ 85173 _ 1 _ , p _ 85173 _ 2 _ , p _ 85173 _ 3 _ , p _ 85173 _ 4 _ ) ; <nl> + + if ( event . isCanceled ( ) | | event . name = = null ) return ; <nl> + + p _ 85173 _ 2 _ = event . name ; <nl> + + p _ 85173 _ 3 _ = event . newVolume ; <nl> + + p _ 85173 _ 4 _ = event . newPitch ; <nl> + + <nl> + for ( int i = 0 ; i < this . worldAccesses . size ( ) ; + + i ) <nl> + { <nl> + ( ( IWorldAccess ) this . worldAccesses . get ( i ) ) . playSoundToNearExcept ( p _ 85173 _ 1 _ , p _ 85173 _ 2 _ , p _ 85173 _ 1 _ . posX , p _ 85173 _ 1 _ . posY , p _ 85173 _ 1 _ . posZ , p _ 85173 _ 3 _ , p _ 85173 _ 4 _ ) ; <nl> + @ @ - 1036 , 6 + 1095 , 9 @ @ <nl> + <nl> + public boolean spawnEntityInWorld ( Entity p _ 72838 _ 1 _ ) <nl> + { <nl> + + / / do not drop any items while restoring blocksnapshots . Prevents dupes <nl> + + if ( ! this . isRemote & & ( p _ 72838 _ 1 _ = = null | | ( p _ 72838 _ 1 _ instanceof net . minecraft . entity . item . EntityItem & & this . restoringBlockSnapshots ) ) ) return false ; <nl> + + <nl> + int i = MathHelper . floor _ double ( p _ 72838 _ 1 _ . posX / 16 . 0D ) ; <nl> + int j = MathHelper . floor _ double ( p _ 72838 _ 1 _ . posZ / 16 . 0D ) ; <nl> + boolean flag = p _ 72838 _ 1 _ . forceSpawn ; <nl> + @ @ - 1058 , 6 + 1120 , 8 @ @ <nl> + this . updateAllPlayersSleepingFlag ( ) ; <nl> + } <nl> + <nl> + + if ( net . minecraftforge . common . MinecraftForge . EVENT _ BUS . post ( new net . minecraftforge . event . entity . EntityJoinWorldEvent ( p _ 72838 _ 1 _ , this ) ) & & ! flag ) return false ; <nl> + + <nl> + this . getChunkFromChunkCoords ( i , j ) . addEntity ( p _ 72838 _ 1 _ ) ; <nl> + this . loadedEntityList . add ( p _ 72838 _ 1 _ ) ; <nl> + this . onEntityAdded ( p _ 72838 _ 1 _ ) ; <nl> + @ @ - 1270 , 17 + 1334 , 29 @ @ <nl> + <nl> + public int calculateSkylightSubtracted ( float p _ 72967 _ 1 _ ) <nl> + { <nl> + + float f = provider . getSunBrightnessFactor ( p _ 72967 _ 1 _ ) ; <nl> + + f = 1 - f ; <nl> + + return ( int ) ( f * 11 ) ; <nl> + + } <nl> + + <nl> + + / * * <nl> + + * The current sun brightness factor for this dimension . <nl> + + * 0 . 0f means no light at all , and 1 . 0f means maximum sunlight . <nl> + + * Highly recommended for sunlight detection like solar panel . <nl> + + * <nl> + + * @ return The current brightness factor <nl> + + * * / <nl> + + public float getSunBrightnessFactor ( float p _ 72967 _ 1 _ ) <nl> + + { <nl> + float f = this . getCelestialAngle ( p _ 72967 _ 1 _ ) ; <nl> + float f1 = 1 . 0F - ( MathHelper . cos ( f * ( float ) Math . PI * 2 . 0F ) * 2 . 0F + 0 . 5F ) ; <nl> + f1 = MathHelper . clamp _ float ( f1 , 0 . 0F , 1 . 0F ) ; <nl> + f1 = 1 . 0F - f1 ; <nl> + f1 = ( float ) ( ( double ) f1 * ( 1 . 0D - ( double ) ( this . getRainStrength ( p _ 72967 _ 1 _ ) * 5 . 0F ) / 16 . 0D ) ) ; <nl> + f1 = ( float ) ( ( double ) f1 * ( 1 . 0D - ( double ) ( this . getThunderStrength ( p _ 72967 _ 1 _ ) * 5 . 0F ) / 16 . 0D ) ) ; <nl> + - f1 = 1 . 0F - f1 ; <nl> + - return ( int ) ( f1 * 11 . 0F ) ; <nl> + + return f1 ; <nl> + } <nl> + <nl> + - @ SideOnly ( Side . CLIENT ) <nl> + public void removeWorldAccess ( IWorldAccess p _ 72848 _ 1 _ ) <nl> + { <nl> + this . worldAccesses . remove ( p _ 72848 _ 1 _ ) ; <nl> + @ @ - 1289 , 6 + 1365 , 12 @ @ <nl> + @ SideOnly ( Side . CLIENT ) <nl> + public float getSunBrightness ( float p _ 72971 _ 1 _ ) <nl> + { <nl> + + return this . provider . getSunBrightness ( p _ 72971 _ 1 _ ) ; <nl> + + } <nl> + + <nl> + + @ SideOnly ( Side . CLIENT ) <nl> + + public float getSunBrightnessBody ( float p _ 72971 _ 1 _ ) <nl> + + { <nl> + float f = this . getCelestialAngle ( p _ 72971 _ 1 _ ) ; <nl> + float f1 = 1 . 0F - ( MathHelper . cos ( f * ( float ) Math . PI * 2 . 0F ) * 2 . 0F + 0 . 2F ) ; <nl> + f1 = MathHelper . clamp _ float ( f1 , 0 . 0F , 1 . 0F ) ; <nl> + @ @ - 1301 , 6 + 1383 , 12 @ @ <nl> + @ SideOnly ( Side . CLIENT ) <nl> + public Vec3 getSkyColor ( Entity p _ 72833 _ 1 _ , float p _ 72833 _ 2 _ ) <nl> + { <nl> + + return this . provider . getSkyColor ( p _ 72833 _ 1 _ , p _ 72833 _ 2 _ ) ; <nl> + + } <nl> + + <nl> + + @ SideOnly ( Side . CLIENT ) <nl> + + public Vec3 getSkyColorBody ( Entity p _ 72833 _ 1 _ , float p _ 72833 _ 2 _ ) <nl> + + { <nl> + float f = this . getCelestialAngle ( p _ 72833 _ 2 _ ) ; <nl> + float f1 = MathHelper . cos ( f * ( float ) Math . PI * 2 . 0F ) * 2 . 0F + 0 . 5F ; <nl> + f1 = MathHelper . clamp _ float ( f1 , 0 . 0F , 1 . 0F ) ; <nl> + @ @ - 1308 , 9 + 1396 , 7 @ @ <nl> + int j = MathHelper . floor _ double ( p _ 72833 _ 1 _ . posY ) ; <nl> + int k = MathHelper . floor _ double ( p _ 72833 _ 1 _ . posZ ) ; <nl> + BlockPos blockpos = new BlockPos ( i , j , k ) ; <nl> + - BiomeGenBase biomegenbase = this . getBiomeGenForCoords ( blockpos ) ; <nl> + - float f2 = biomegenbase . getFloatTemperature ( blockpos ) ; <nl> + - int l = biomegenbase . getSkyColorByTemp ( f2 ) ; <nl> + + int l = net . minecraftforge . client . ForgeHooksClient . getSkyBlendColour ( this , blockpos ) ; <nl> + float f3 = ( float ) ( l > > 16 & 255 ) / 255 . 0F ; <nl> + float f4 = ( float ) ( l > > 8 & 255 ) / 255 . 0F ; <nl> + float f5 = ( float ) ( l & 255 ) / 255 . 0F ; <nl> + @ @ - 1370 , 6 + 1456 , 11 @ @ <nl> + <nl> + public float getCurrentMoonPhaseFactor ( ) <nl> + { <nl> + + return provider . getCurrentMoonPhaseFactor ( ) ; <nl> + + } <nl> + + <nl> + + public float getCurrentMoonPhaseFactorBody ( ) <nl> + + { <nl> + return WorldProvider . moonPhaseFactors [ this . provider . getMoonPhase ( this . worldInfo . getWorldTime ( ) ) ] ; <nl> + } <nl> + <nl> + @ @ - 1382 , 6 + 1473 , 12 @ @ <nl> + @ SideOnly ( Side . CLIENT ) <nl> + public Vec3 getCloudColour ( float p _ 72824 _ 1 _ ) <nl> + { <nl> + + return this . provider . drawClouds ( p _ 72824 _ 1 _ ) ; <nl> + + } <nl> + + <nl> + + @ SideOnly ( Side . CLIENT ) <nl> + + public Vec3 drawCloudsBody ( float p _ 72824 _ 1 _ ) <nl> + + { <nl> + float f = this . getCelestialAngle ( p _ 72824 _ 1 _ ) ; <nl> + float f1 = MathHelper . cos ( f * ( float ) Math . PI * 2 . 0F ) * 2 . 0F + 0 . 5F ; <nl> + f1 = MathHelper . clamp _ float ( f1 , 0 . 0F , 1 . 0F ) ; <nl> + @ @ - 1437 , 9 + 1534 , 9 @ @ <nl> + for ( blockpos = new BlockPos ( pos . getX ( ) , chunk . getTopFilledSegment ( ) + 16 , pos . getZ ( ) ) ; blockpos . getY ( ) > = 0 ; blockpos = blockpos1 ) <nl> + { <nl> + blockpos1 = blockpos . down ( ) ; <nl> + - Material material = chunk . getBlock ( blockpos1 ) . getMaterial ( ) ; <nl> + + Block block = chunk . getBlock ( blockpos1 ) ; <nl> + <nl> + - if ( material . blocksMovement ( ) & & material ! = Material . leaves ) <nl> + + if ( block . getMaterial ( ) . blocksMovement ( ) & & ! block . isLeaves ( this , blockpos1 ) & & ! block . isFoliage ( this , blockpos1 ) ) <nl> + { <nl> + break ; <nl> + } <nl> + @ @ - 1451 , 6 + 1548 , 12 @ @ <nl> + @ SideOnly ( Side . CLIENT ) <nl> + public float getStarBrightness ( float p _ 72880 _ 1 _ ) <nl> + { <nl> + + return this . provider . getStarBrightness ( p _ 72880 _ 1 _ ) ; <nl> + + } <nl> + + <nl> + + @ SideOnly ( Side . CLIENT ) <nl> + + public float getStarBrightnessBody ( float p _ 72880 _ 1 _ ) <nl> + + { <nl> + float f = this . getCelestialAngle ( p _ 72880 _ 1 _ ) ; <nl> + float f1 = 1 . 0F - ( MathHelper . cos ( f * ( float ) Math . PI * 2 . 0F ) * 2 . 0F + 0 . 25F ) ; <nl> + f1 = MathHelper . clamp _ float ( f1 , 0 . 0F , 1 . 0F ) ; <nl> + @ @ - 1497 , 7 + 1600 , 15 @ @ <nl> + entity . addEntityCrashInfo ( crashreportcategory ) ; <nl> + } <nl> + <nl> + - throw new ReportedException ( crashreport ) ; <nl> + + if ( net . minecraftforge . common . ForgeModContainer . removeErroringEntities ) <nl> + + { <nl> + + net . minecraftforge . fml . common . FMLLog . severe ( crashreport . getCompleteReport ( ) ) ; <nl> + + removeEntity ( entity ) ; <nl> + + } <nl> + + else <nl> + + { <nl> + + throw new ReportedException ( crashreport ) ; <nl> + + } <nl> + } <nl> + <nl> + if ( entity . isDead ) <nl> + @ @ - 1557 , 7 + 1668 , 15 @ @ <nl> + CrashReport crashreport1 = CrashReport . makeCrashReport ( throwable1 , " Ticking entity " ) ; <nl> + CrashReportCategory crashreportcategory2 = crashreport1 . makeCategory ( " Entity being ticked " ) ; <nl> + entity2 . addEntityCrashInfo ( crashreportcategory2 ) ; <nl> + - throw new ReportedException ( crashreport1 ) ; <nl> + + if ( net . minecraftforge . common . ForgeModContainer . removeErroringEntities ) <nl> + + { <nl> + + net . minecraftforge . fml . common . FMLLog . severe ( crashreport1 . getCompleteReport ( ) ) ; <nl> + + removeEntity ( entity2 ) ; <nl> + + } <nl> + + else <nl> + + { <nl> + + throw new ReportedException ( crashreport1 ) ; <nl> + + } <nl> + } <nl> + } <nl> + <nl> + @ @ - 1604 , 7 + 1723 , 16 @ @ <nl> + CrashReport crashreport2 = CrashReport . makeCrashReport ( throwable , " Ticking block entity " ) ; <nl> + CrashReportCategory crashreportcategory1 = crashreport2 . makeCategory ( " Block entity being ticked " ) ; <nl> + tileentity . addInfoToCrashReport ( crashreportcategory1 ) ; <nl> + - throw new ReportedException ( crashreport2 ) ; <nl> + + if ( net . minecraftforge . common . ForgeModContainer . removeErroringTileEntities ) <nl> + + { <nl> + + net . minecraftforge . fml . common . FMLLog . severe ( crashreport2 . getCompleteReport ( ) ) ; <nl> + + tileentity . invalidate ( ) ; <nl> + + this . removeTileEntity ( tileentity . getPos ( ) ) ; <nl> + + } <nl> + + else <nl> + + { <nl> + + throw new ReportedException ( crashreport2 ) ; <nl> + + } <nl> + } <nl> + } <nl> + } <nl> + @ @ - 1621 , 15 + 1749 , 20 @ @ <nl> + } <nl> + } <nl> + <nl> + - this . processingLoadedTiles = false ; <nl> + - <nl> + if ( ! this . tileEntitiesToBeRemoved . isEmpty ( ) ) <nl> + { <nl> + + for ( Object tile : tileEntitiesToBeRemoved ) <nl> + + { <nl> + + ( ( TileEntity ) tile ) . onChunkUnload ( ) ; <nl> + + } <nl> + + <nl> + this . tickableTileEntities . removeAll ( this . tileEntitiesToBeRemoved ) ; <nl> + this . loadedTileEntityList . removeAll ( this . tileEntitiesToBeRemoved ) ; <nl> + this . tileEntitiesToBeRemoved . clear ( ) ; <nl> + } <nl> + <nl> + + this . processingLoadedTiles = false ; / / FML Move below remove to prevent CMEs <nl> + + <nl> + this . theProfiler . endStartSection ( " pendingBlockEntities " ) ; <nl> + <nl> + if ( ! this . addedTileEntityList . isEmpty ( ) ) <nl> + @ @ - 1663 , 7 + 1796 , 8 @ @ <nl> + <nl> + public boolean addTileEntity ( TileEntity tile ) <nl> + { <nl> + - boolean flag = this . loadedTileEntityList . add ( tile ) ; <nl> + + List < TileEntity > dest = processingLoadedTiles ? addedTileEntityList : loadedTileEntityList ; <nl> + + boolean flag = dest . add ( tile ) ; <nl> + <nl> + if ( flag & & tile instanceof ITickable ) <nl> + { <nl> + @ @ - 1702 , 9 + 1836 , 13 @ @ <nl> + { <nl> + int i = MathHelper . floor _ double ( p _ 72866 _ 1 _ . posX ) ; <nl> + int j = MathHelper . floor _ double ( p _ 72866 _ 1 _ . posZ ) ; <nl> + - int k = 32 ; <nl> + + boolean isForced = getPersistentChunks ( ) . containsKey ( new ChunkCoordIntPair ( i > > 4 , j > > 4 ) ) ; <nl> + + int k = isForced ? 0 : 32 ; <nl> + + boolean canUpdate = ! p _ 72866 _ 2 _ | | this . isAreaLoaded ( i - k , 0 , j - k , i + k , 0 , j + k , true ) ; <nl> + <nl> + - if ( ! p _ 72866 _ 2 _ | | this . isAreaLoaded ( i - k , 0 , j - k , i + k , 0 , j + k , true ) ) <nl> + + if ( ! canUpdate ) canUpdate = net . minecraftforge . event . ForgeEventFactory . canEntityUpdate ( p _ 72866 _ 1 _ ) ; <nl> + + <nl> + + if ( canUpdate ) <nl> + { <nl> + p _ 72866 _ 1 _ . lastTickPosX = p _ 72866 _ 1 _ . posX ; <nl> + p _ 72866 _ 1 _ . lastTickPosY = p _ 72866 _ 1 _ . posY ; <nl> + @ @ - 1832 , 7 + 1970 , 7 @ @ <nl> + { <nl> + Block block = this . getBlockState ( blockpos $ mutableblockpos . func _ 181079 _ c ( k1 , l1 , i2 ) ) . getBlock ( ) ; <nl> + <nl> + - if ( block . getMaterial ( ) ! = Material . air ) <nl> + + if ( ! block . isAir ( this , new BlockPos ( k1 , l1 , i2 ) ) ) <nl> + { <nl> + return true ; <nl> + } <nl> + @ @ - 1897 , 6 + 2035 , 10 @ @ <nl> + { <nl> + return true ; <nl> + } <nl> + + else if ( block . isBurning ( this , new BlockPos ( k1 , l1 , i2 ) ) ) <nl> + + { <nl> + + return true ; <nl> + + } <nl> + } <nl> + } <nl> + } <nl> + @ @ - 2037 , 6 + 2179 , 7 @ @ <nl> + public Explosion newExplosion ( Entity p _ 72885 _ 1 _ , double p _ 72885 _ 2 _ , double p _ 72885 _ 4 _ , double p _ 72885 _ 6 _ , float p _ 72885 _ 8 _ , boolean p _ 72885 _ 9 _ , boolean p _ 72885 _ 10 _ ) <nl> + { <nl> + Explosion explosion = new Explosion ( this , p _ 72885 _ 1 _ , p _ 72885 _ 2 _ , p _ 72885 _ 4 _ , p _ 72885 _ 6 _ , p _ 72885 _ 8 _ , p _ 72885 _ 9 _ , p _ 72885 _ 10 _ ) ; <nl> + + if ( net . minecraftforge . event . ForgeEventFactory . onExplosionStart ( this , explosion ) ) return explosion ; <nl> + explosion . doExplosionA ( ) ; <nl> + explosion . doExplosionB ( true ) ; <nl> + return explosion ; <nl> + @ @ - 2183 , 19 + 2326 , 27 @ @ <nl> + else <nl> + { <nl> + this . addTileEntity ( tileEntityIn ) ; <nl> + - this . getChunkFromBlockCoords ( pos ) . addTileEntity ( pos , tileEntityIn ) ; <nl> + + Chunk chunk = this . getChunkFromBlockCoords ( pos ) ; / / Forge add NPE protection <nl> + + if ( chunk ! = null ) chunk . addTileEntity ( pos , tileEntityIn ) ; <nl> + } <nl> + + this . updateComparatorOutputLevel ( pos , getBlockState ( pos ) . getBlock ( ) ) ; / / Notify neighbors of changes <nl> + } <nl> + } <nl> + <nl> + public void removeTileEntity ( BlockPos pos ) <nl> + { <nl> + + / / Chunk chunk = this . getChunkFromBlockCoords ( pos ) ; <nl> + + / / if ( chunk ! = null ) chunk . removeTileEntity ( pos ) ; <nl> + + / / Forge ToDO : Are these patches needed anymore ? <nl> + + <nl> + TileEntity tileentity = this . getTileEntity ( pos ) ; <nl> + <nl> + if ( tileentity ! = null & & this . processingLoadedTiles ) <nl> + { <nl> + tileentity . invalidate ( ) ; <nl> + this . addedTileEntityList . remove ( tileentity ) ; <nl> + + if ( ! ( tileentity instanceof ITickable ) ) / / Forge : If they are not tickable they wont be removed in the update loop . <nl> + + this . loadedTileEntityList . remove ( tileentity ) ; <nl> + } <nl> + else <nl> + { <nl> + @ @ - 2208 , 6 + 2359 , 7 @ @ <nl> + <nl> + this . getChunkFromBlockCoords ( pos ) . removeTileEntity ( pos ) ; <nl> + } <nl> + + this . updateComparatorOutputLevel ( pos , getBlockState ( pos ) . getBlock ( ) ) ; / / Notify neighbors of changes <nl> + } <nl> + <nl> + public void markTileEntityForRemoval ( TileEntity tileEntityIn ) <nl> + @ @ - 2226 , 7 + 2378 , 7 @ @ <nl> + { <nl> + IBlockState iblockstate = p _ 175683 _ 0 _ . getBlockState ( p _ 175683 _ 1 _ ) ; <nl> + Block block = iblockstate . getBlock ( ) ; <nl> + - return block . getMaterial ( ) . isOpaque ( ) & & block . isFullCube ( ) ? true : ( block instanceof BlockStairs ? iblockstate . getValue ( BlockStairs . HALF ) = = BlockStairs . EnumHalf . TOP : ( block instanceof BlockSlab ? iblockstate . getValue ( BlockSlab . HALF ) = = BlockSlab . EnumBlockHalf . TOP : ( block instanceof BlockHopper ? true : ( block instanceof BlockSnow ? ( ( Integer ) iblockstate . getValue ( BlockSnow . LAYERS ) ) . intValue ( ) = = 7 : false ) ) ) ) ; <nl> + + return block . isSideSolid ( p _ 175683 _ 0 _ , p _ 175683 _ 1 _ , EnumFacing . UP ) ; <nl> + } <nl> + <nl> + public boolean isBlockNormalCube ( BlockPos p _ 175677 _ 1 _ , boolean p _ 175677 _ 2 _ ) <nl> + @ @ - 2246 , 7 + 2398 , 7 @ @ <nl> + else <nl> + { <nl> + Block block = this . getBlockState ( p _ 175677 _ 1 _ ) . getBlock ( ) ; <nl> + - return block . getMaterial ( ) . isOpaque ( ) & & block . isFullCube ( ) ; <nl> + + return block . isNormalCube ( this , p _ 175677 _ 1 _ ) ; <nl> + } <nl> + } <nl> + } <nl> + @ @ - 2265 , 6 + 2417 , 7 @ @ <nl> + { <nl> + this . spawnHostileMobs = hostile ; <nl> + this . spawnPeacefulMobs = peaceful ; <nl> + + this . provider . setAllowedSpawnTypes ( hostile , peaceful ) ; <nl> + } <nl> + <nl> + public void tick ( ) <nl> + @ @ - 2274 , 6 + 2427 , 11 @ @ <nl> + <nl> + protected void calculateInitialWeather ( ) <nl> + { <nl> + + this . provider . calculateInitialWeather ( ) ; <nl> + + } <nl> + + <nl> + + public void calculateInitialWeatherBody ( ) <nl> + + { <nl> + if ( this . worldInfo . isRaining ( ) ) <nl> + { <nl> + this . rainingStrength = 1 . 0F ; <nl> + @ @ - 2287 , 6 + 2445 , 11 @ @ <nl> + <nl> + protected void updateWeather ( ) <nl> + { <nl> + + this . provider . updateWeather ( ) ; <nl> + + } <nl> + + <nl> + + public void updateWeatherBody ( ) <nl> + + { <nl> + if ( ! this . provider . getHasNoSky ( ) ) <nl> + { <nl> + if ( ! this . isRemote ) <nl> + @ @ - 2381 , 6 + 2544 , 7 @ @ <nl> + { <nl> + this . activeChunkSet . clear ( ) ; <nl> + this . theProfiler . startSection ( " buildList " ) ; <nl> + + this . activeChunkSet . addAll ( getPersistentChunks ( ) . keySet ( ) ) ; <nl> + <nl> + for ( int i = 0 ; i < this . playerEntities . size ( ) ; + + i ) <nl> + { <nl> + @ @ - 2438 , 7 + 2602 , 7 @ @ <nl> + j = j + p _ 147467 _ 1 _ ; <nl> + k = k + p _ 147467 _ 2 _ ; <nl> + <nl> + - if ( block . getMaterial ( ) = = Material . air & & this . getLight ( blockpos ) < = this . rand . nextInt ( 8 ) & & this . getLightFor ( EnumSkyBlock . SKY , blockpos ) < = 0 ) <nl> + + if ( block . isAir ( this , blockpos ) & & this . getLight ( blockpos ) < = this . rand . nextInt ( 8 ) & & this . getLightFor ( EnumSkyBlock . SKY , blockpos ) < = 0 ) <nl> + { <nl> + EntityPlayer entityplayer = this . getClosestPlayer ( ( double ) j + 0 . 5D , ( double ) l + 0 . 5D , ( double ) k + 0 . 5D , 8 . 0D ) ; <nl> + <nl> + @ @ - 2478 , 6 + 2642 , 11 @ @ <nl> + <nl> + public boolean canBlockFreeze ( BlockPos pos , boolean noWaterAdj ) <nl> + { <nl> + + return this . provider . canBlockFreeze ( pos , noWaterAdj ) ; <nl> + + } <nl> + + <nl> + + public boolean canBlockFreezeBody ( BlockPos pos , boolean noWaterAdj ) <nl> + + { <nl> + BiomeGenBase biomegenbase = this . getBiomeGenForCoords ( pos ) ; <nl> + float f = biomegenbase . getFloatTemperature ( pos ) ; <nl> + <nl> + @ @ - 2519 , 6 + 2688 , 11 @ @ <nl> + <nl> + public boolean canSnowAt ( BlockPos pos , boolean checkLight ) <nl> + { <nl> + + return this . provider . canSnowAt ( pos , checkLight ) ; <nl> + + } <nl> + + <nl> + + public boolean canSnowAtBody ( BlockPos pos , boolean checkLight ) <nl> + + { <nl> + BiomeGenBase biomegenbase = this . getBiomeGenForCoords ( pos ) ; <nl> + float f = biomegenbase . getFloatTemperature ( pos ) ; <nl> + <nl> + @ @ - 2536 , 7 + 2710 , 7 @ @ <nl> + { <nl> + Block block = this . getBlockState ( pos ) . getBlock ( ) ; <nl> + <nl> + - if ( block . getMaterial ( ) = = Material . air & & Blocks . snow _ layer . canPlaceBlockAt ( this , pos ) ) <nl> + + if ( block . isAir ( this , pos ) & & Blocks . snow _ layer . canPlaceBlockAt ( this , pos ) ) <nl> + { <nl> + return true ; <nl> + } <nl> + @ @ - 2568 , 10 + 2742 , 11 @ @ <nl> + else <nl> + { <nl> + Block block = this . getBlockState ( pos ) . getBlock ( ) ; <nl> + - int i = lightType = = EnumSkyBlock . SKY ? 0 : block . getLightValue ( ) ; <nl> + - int j = block . getLightOpacity ( ) ; <nl> + + int blockLight = block . getLightValue ( this , pos ) ; <nl> + + int i = lightType = = EnumSkyBlock . SKY ? 0 : blockLight ; <nl> + + int j = block . getLightOpacity ( this , pos ) ; <nl> + <nl> + - if ( j > = 15 & & block . getLightValue ( ) > 0 ) <nl> + + if ( j > = 15 & & blockLight > 0 ) <nl> + { <nl> + j = 1 ; <nl> + } <nl> + @ @ - 2771 , 10 + 2946 , 10 @ @ <nl> + public List < Entity > func _ 175674 _ a ( Entity entityIn , AxisAlignedBB p _ 175674 _ 2 _ , Predicate < ? super Entity > p _ 175674 _ 3 _ ) <nl> + { <nl> + List < Entity > list = Lists . < Entity > newArrayList ( ) ; <nl> + - int i = MathHelper . floor _ double ( ( p _ 175674 _ 2 _ . minX - 2 . 0D ) / 16 . 0D ) ; <nl> + - int j = MathHelper . floor _ double ( ( p _ 175674 _ 2 _ . maxX + 2 . 0D ) / 16 . 0D ) ; <nl> + - int k = MathHelper . floor _ double ( ( p _ 175674 _ 2 _ . minZ - 2 . 0D ) / 16 . 0D ) ; <nl> + - int l = MathHelper . floor _ double ( ( p _ 175674 _ 2 _ . maxZ + 2 . 0D ) / 16 . 0D ) ; <nl> + + int i = MathHelper . floor _ double ( ( p _ 175674 _ 2 _ . minX - MAX _ ENTITY _ RADIUS ) / 16 . 0D ) ; <nl> + + int j = MathHelper . floor _ double ( ( p _ 175674 _ 2 _ . maxX + MAX _ ENTITY _ RADIUS ) / 16 . 0D ) ; <nl> + + int k = MathHelper . floor _ double ( ( p _ 175674 _ 2 _ . minZ - MAX _ ENTITY _ RADIUS ) / 16 . 0D ) ; <nl> + + int l = MathHelper . floor _ double ( ( p _ 175674 _ 2 _ . maxZ + MAX _ ENTITY _ RADIUS ) / 16 . 0D ) ; <nl> + <nl> + for ( int i1 = i ; i1 < = j ; + + i1 ) <nl> + { <nl> + @ @ - 2827 , 10 + 3002 , 10 @ @ <nl> + <nl> + public < T extends Entity > List < T > getEntitiesWithinAABB ( Class < ? extends T > clazz , AxisAlignedBB aabb , Predicate < ? super T > filter ) <nl> + { <nl> + - int i = MathHelper . floor _ double ( ( aabb . minX - 2 . 0D ) / 16 . 0D ) ; <nl> + - int j = MathHelper . floor _ double ( ( aabb . maxX + 2 . 0D ) / 16 . 0D ) ; <nl> + - int k = MathHelper . floor _ double ( ( aabb . minZ - 2 . 0D ) / 16 . 0D ) ; <nl> + - int l = MathHelper . floor _ double ( ( aabb . maxZ + 2 . 0D ) / 16 . 0D ) ; <nl> + + int i = MathHelper . floor _ double ( ( aabb . minX - MAX _ ENTITY _ RADIUS ) / 16 . 0D ) ; <nl> + + int j = MathHelper . floor _ double ( ( aabb . maxX + MAX _ ENTITY _ RADIUS ) / 16 . 0D ) ; <nl> + + int k = MathHelper . floor _ double ( ( aabb . minZ - MAX _ ENTITY _ RADIUS ) / 16 . 0D ) ; <nl> + + int l = MathHelper . floor _ double ( ( aabb . maxZ + MAX _ ENTITY _ RADIUS ) / 16 . 0D ) ; <nl> + List < T > list = Lists . < T > newArrayList ( ) ; <nl> + <nl> + for ( int i1 = i ; i1 < = j ; + + i1 ) <nl> + @ @ - 2908 , 11 + 3083 , 13 @ @ <nl> + <nl> + public void loadEntities ( Collection < Entity > entityCollection ) <nl> + { <nl> + - this . loadedEntityList . addAll ( entityCollection ) ; <nl> + - <nl> + for ( Entity entity : entityCollection ) <nl> + { <nl> + - this . onEntityAdded ( entity ) ; <nl> + + if ( ! net . minecraftforge . common . MinecraftForge . EVENT _ BUS . post ( new net . minecraftforge . event . entity . EntityJoinWorldEvent ( entity , this ) ) ) <nl> + + { <nl> + + loadedEntityList . add ( entity ) ; <nl> + + this . onEntityAdded ( entity ) ; <nl> + + } <nl> + } <nl> + } <nl> + <nl> + @ @ - 2925 , 7 + 3102 , 9 @ @ <nl> + { <nl> + Block block = this . getBlockState ( p _ 175716 _ 2 _ ) . getBlock ( ) ; <nl> + AxisAlignedBB axisalignedbb = p _ 175716 _ 3 _ ? null : p _ 175716 _ 1 _ . getCollisionBoundingBox ( this , p _ 175716 _ 2 _ , p _ 175716 _ 1 _ . getDefaultState ( ) ) ; <nl> + - return axisalignedbb ! = null & & ! this . checkNoEntityCollision ( axisalignedbb , p _ 175716 _ 5 _ ) ? false : ( block . getMaterial ( ) = = Material . circuits & & p _ 175716 _ 1 _ = = Blocks . anvil ? true : block . getMaterial ( ) . isReplaceable ( ) & & p _ 175716 _ 1 _ . canReplace ( this , p _ 175716 _ 2 _ , p _ 175716 _ 4 _ , p _ 175716 _ 6 _ ) ) ; <nl> + + if ( axisalignedbb ! = null & & ! this . checkNoEntityCollision ( axisalignedbb , p _ 175716 _ 5 _ ) ) return false ; <nl> + + if ( block . getMaterial ( ) = = Material . circuits & & p _ 175716 _ 1 _ = = Blocks . anvil ) return true ; <nl> + + return block . isReplaceable ( this , p _ 175716 _ 2 _ ) & & p _ 175716 _ 1 _ . canReplace ( this , p _ 175716 _ 2 _ , p _ 175716 _ 4 _ , p _ 175716 _ 6 _ ) ; <nl> + } <nl> + <nl> + public int func _ 181545 _ F ( ) <nl> + @ @ - 3010 , 7 + 3189 , 7 @ @ <nl> + { <nl> + IBlockState iblockstate = this . getBlockState ( pos ) ; <nl> + Block block = iblockstate . getBlock ( ) ; <nl> + - return block . isNormalCube ( ) ? this . getStrongPower ( pos ) : block . isProvidingWeakPower ( this , pos , iblockstate , facing ) ; <nl> + + return block . shouldCheckWeakPower ( this , pos , facing ) ? this . getStrongPower ( pos ) : block . isProvidingWeakPower ( this , pos , iblockstate , facing ) ; <nl> + } <nl> + <nl> + public boolean isBlockPowered ( BlockPos pos ) <nl> + @ @ - 3137 , 7 + 3316 , 7 @ @ <nl> + <nl> + public long getSeed ( ) <nl> + { <nl> + - return this . worldInfo . getSeed ( ) ; <nl> + + return this . provider . getSeed ( ) ; <nl> + } <nl> + <nl> + public long getTotalWorldTime ( ) <nl> + @ @ - 3147 , 17 + 3326 , 17 @ @ <nl> + <nl> + public long getWorldTime ( ) <nl> + { <nl> + - return this . worldInfo . getWorldTime ( ) ; <nl> + + return this . provider . getWorldTime ( ) ; <nl> + } <nl> + <nl> + public void setWorldTime ( long time ) <nl> + { <nl> + - this . worldInfo . setWorldTime ( time ) ; <nl> + + this . provider . setWorldTime ( time ) ; <nl> + } <nl> + <nl> + public BlockPos getSpawnPoint ( ) <nl> + { <nl> + - BlockPos blockpos = new BlockPos ( this . worldInfo . getSpawnX ( ) , this . worldInfo . getSpawnY ( ) , this . worldInfo . getSpawnZ ( ) ) ; <nl> + + BlockPos blockpos = this . provider . getSpawnPoint ( ) ; <nl> + <nl> + if ( ! this . getWorldBorder ( ) . contains ( blockpos ) ) <nl> + { <nl> + @ @ - 3169 , 7 + 3348 , 7 @ @ <nl> + <nl> + public void setSpawnPoint ( BlockPos pos ) <nl> + { <nl> + - this . worldInfo . setSpawn ( pos ) ; <nl> + + this . provider . setSpawnPoint ( pos ) ; <nl> + } <nl> + <nl> + @ SideOnly ( Side . CLIENT ) <nl> + @ @ - 3189 , 12 + 3368 , 18 @ @ <nl> + <nl> + if ( ! this . loadedEntityList . contains ( entityIn ) ) <nl> + { <nl> + + if ( ! net . minecraftforge . common . MinecraftForge . EVENT _ BUS . post ( new net . minecraftforge . event . entity . EntityJoinWorldEvent ( entityIn , this ) ) ) <nl> + this . loadedEntityList . add ( entityIn ) ; <nl> + } <nl> + } <nl> + <nl> + public boolean isBlockModifiable ( EntityPlayer player , BlockPos pos ) <nl> + { <nl> + + return this . provider . canMineBlock ( player , pos ) ; <nl> + + } <nl> + + <nl> + + public boolean canMineBlockBody ( EntityPlayer player , BlockPos pos ) <nl> + + { <nl> + return true ; <nl> + } <nl> + <nl> + @ @ - 3288 , 8 + 3473 , 7 @ @ <nl> + <nl> + public boolean isBlockinHighHumidity ( BlockPos pos ) <nl> + { <nl> + - BiomeGenBase biomegenbase = this . getBiomeGenForCoords ( pos ) ; <nl> + - return biomegenbase . isHighHumidity ( ) ; <nl> + + return this . provider . isBlockHighHumidity ( pos ) ; <nl> + } <nl> + <nl> + public MapStorage getMapStorage ( ) <nl> + @ @ - 3348 , 12 + 3532 , 12 @ @ <nl> + <nl> + public int getHeight ( ) <nl> + { <nl> + - return 256 ; <nl> + + return this . provider . getHeight ( ) ; <nl> + } <nl> + <nl> + public int getActualHeight ( ) <nl> + { <nl> + - return this . provider . getHasNoSky ( ) ? 128 : 256 ; <nl> + + return this . provider . getActualHeight ( ) ; <nl> + } <nl> + <nl> + public Random setRandomSeed ( int p _ 72843 _ 1 _ , int p _ 72843 _ 2 _ , int p _ 72843 _ 3 _ ) <nl> + @ @ - 3410 , 7 + 3594 , 7 @ @ <nl> + @ SideOnly ( Side . CLIENT ) <nl> + public double getHorizon ( ) <nl> + { <nl> + - return this . worldInfo . getTerrainType ( ) = = WorldType . FLAT ? 0 . 0D : 63 . 0D ; <nl> + + return provider . getHorizon ( ) ; <nl> + } <nl> + <nl> + public void sendBlockBreakProgress ( int breakerId , BlockPos pos , int progress ) <nl> + @ @ - 3452 , 18 + 3636 , 14 @ @ <nl> + { <nl> + IBlockState iblockstate = this . getBlockState ( blockpos ) ; <nl> + <nl> + - if ( Blocks . unpowered _ comparator . isAssociated ( iblockstate . getBlock ( ) ) ) <nl> + + iblockstate . getBlock ( ) . onNeighborChange ( this , blockpos , pos ) ; <nl> + + if ( iblockstate . getBlock ( ) . isNormalCube ( this , blockpos ) ) <nl> + { <nl> + - iblockstate . getBlock ( ) . onNeighborBlockChange ( this , blockpos , iblockstate , blockIn ) ; <nl> + - } <nl> + - else if ( iblockstate . getBlock ( ) . isNormalCube ( ) ) <nl> + - { <nl> + - blockpos = blockpos . offset ( enumfacing ) ; <nl> + - iblockstate = this . getBlockState ( blockpos ) ; <nl> + - <nl> + - if ( Blocks . unpowered _ comparator . isAssociated ( iblockstate . getBlock ( ) ) ) <nl> + + BlockPos posOther = blockpos . offset ( enumfacing ) ; <nl> + + Block other = getBlockState ( posOther ) . getBlock ( ) ; <nl> + + if ( other . getWeakChanges ( this , posOther ) ) <nl> + { <nl> + - iblockstate . getBlock ( ) . onNeighborBlockChange ( this , blockpos , iblockstate , blockIn ) ; <nl> + + other . onNeighborChange ( this , posOther , pos ) ; <nl> + } <nl> + } <nl> + } <nl> + @ @ - 3533 , 4 + 3713 , 81 @ @ <nl> + int k = 128 ; <nl> + return i > = - k & & i < = k & & j > = - k & & j < = k ; <nl> + } <nl> + + <nl> + + / * = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = FORGE START = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = * / <nl> + + / * * <nl> + + * Determine if the given block is considered solid on the <nl> + + * specified side . Used by placement logic . <nl> + + * <nl> + + * @ param pos Block Position <nl> + + * @ param side The Side in question <nl> + + * @ return True if the side is solid <nl> + + * / <nl> + + public boolean isSideSolid ( BlockPos pos , EnumFacing side ) <nl> + + { <nl> + + return isSideSolid ( pos , side , false ) ; <nl> + + } <nl> + + <nl> + + / * * <nl> + + * Determine if the given block is considered solid on the <nl> + + * specified side . Used by placement logic . <nl> + + * <nl> + + * @ param pos Block Position <nl> + + * @ param side The Side in question <nl> + + * @ param _ default The default to return if the block doesn ' t exist . <nl> + + * @ return True if the side is solid <nl> + + * / <nl> + + @ Override <nl> + + public boolean isSideSolid ( BlockPos pos , EnumFacing side , boolean _ default ) <nl> + + { <nl> + + if ( ! this . isValid ( pos ) ) return _ default ; <nl> + + <nl> + + Chunk chunk = getChunkFromBlockCoords ( pos ) ; <nl> + + if ( chunk = = null | | chunk . isEmpty ( ) ) return _ default ; <nl> + + return getBlockState ( pos ) . getBlock ( ) . isSideSolid ( this , pos , side ) ; <nl> + + } <nl> + + <nl> + + / * * <nl> + + * Get the persistent chunks for this world <nl> + + * <nl> + + * @ return <nl> + + * / <nl> + + public com . google . common . collect . ImmutableSetMultimap < ChunkCoordIntPair , net . minecraftforge . common . ForgeChunkManager . Ticket > getPersistentChunks ( ) <nl> + + { <nl> + + return net . minecraftforge . common . ForgeChunkManager . getPersistentChunksFor ( this ) ; <nl> + + } <nl> + + <nl> + + / * * <nl> + + * Readded as it was removed , very useful helper function <nl> + + * <nl> + + * @ param pos Block position <nl> + + * @ return The blocks light opacity <nl> + + * / <nl> + + public int getBlockLightOpacity ( BlockPos pos ) <nl> + + { <nl> + + if ( ! this . isValid ( pos ) ) return 0 ; <nl> + + return getChunkFromBlockCoords ( pos ) . getBlockLightOpacity ( pos ) ; <nl> + + } <nl> + + <nl> + + / * * <nl> + + * Returns a count of entities that classify themselves as the specified creature type . <nl> + + * / <nl> + + public int countEntities ( net . minecraft . entity . EnumCreatureType type , boolean forSpawnCount ) <nl> + + { <nl> + + int count = 0 ; <nl> + + for ( int x = 0 ; x < loadedEntityList . size ( ) ; x + + ) <nl> + + { <nl> + + if ( ( ( Entity ) loadedEntityList . get ( x ) ) . isCreatureType ( type , forSpawnCount ) ) <nl> + + { <nl> + + count + + ; <nl> + + } <nl> + + } <nl> + + return count ; <nl> + + } <nl> + + <nl> + + protected MapStorage perWorldStorage ; / / Moved to a getter to simulate final without being final so we can load in subclasses . <nl> + + public MapStorage getPerWorldStorage ( ) <nl> + + { <nl> + + return perWorldStorage ; <nl> + + } <nl> + } <nl> diff - - git a / rejects / minecraft / net / minecraft / server / integrated / IntegratedServer . java . patch . rej b / rejects / minecraft / net / minecraft / server / integrated / IntegratedServer . java . patch . rej <nl> index 6fffb6b . . fe21c35 100644 <nl> - - - a / rejects / minecraft / net / minecraft / server / integrated / IntegratedServer . java . patch . rej <nl> + + + b / rejects / minecraft / net / minecraft / server / integrated / IntegratedServer . java . patch . rej <nl> @ @ - 1 , 61 + 1 , 4 @ @ <nl> - + + + + REJECTED PATCH 2 <nl> - { <nl> - worldinfo . setWorldName ( p _ 71247 _ 2 _ ) ; <nl> - } <nl> - + WorldServer overWorld = ( isDemo ( ) ? ( WorldServer ) ( new DemoWorldServer ( this , isavehandler , worldinfo , 0 , this . theProfiler ) ) . init ( ) : <nl> - + ( WorldServer ) ( new WorldServer ( this , isavehandler , worldinfo , 0 , this . theProfiler ) ) . init ( ) ) ; <nl> - + overWorld . initialize ( this . theWorldSettings ) ; <nl> - <nl> - - for ( int j = 0 ; j < this . worldServers . length ; + + j ) <nl> - + for ( int dim : net . minecraftforge . common . DimensionManager . getStaticDimensionIDs ( ) ) <nl> - { <nl> - - byte b0 = 0 ; <nl> - <nl> - - if ( j = = 1 ) <nl> - + WorldServer world = ( dim = = 0 ? overWorld : ( WorldServer ) ( new WorldServerMulti ( this , isavehandler , dim , overWorld , this . theProfiler ) ) . init ( ) ) ; <nl> - + world . addWorldAccess ( new WorldManager ( this , world ) ) ; <nl> - + if ( ! this . isSinglePlayer ( ) ) <nl> - { <nl> - - b0 = - 1 ; <nl> - + world . getWorldInfo ( ) . setGameType ( getGameType ( ) ) ; <nl> - } <nl> - - <nl> - - if ( j = = 2 ) <nl> - - { <nl> - - b0 = 1 ; <nl> - - } <nl> - - <nl> - - if ( j = = 0 ) <nl> - - { <nl> - - if ( this . isDemo ( ) ) <nl> - - { <nl> - - this . worldServers [ j ] = ( WorldServer ) ( new DemoWorldServer ( this , isavehandler , worldinfo , b0 , this . theProfiler ) ) . init ( ) ; <nl> - - } <nl> - - else <nl> - - { <nl> - - this . worldServers [ j ] = ( WorldServer ) ( new WorldServer ( this , isavehandler , worldinfo , b0 , this . theProfiler ) ) . init ( ) ; <nl> - - } <nl> - - <nl> - - this . worldServers [ j ] . initialize ( this . theWorldSettings ) ; <nl> - - } <nl> - - else <nl> - - { <nl> - - this . worldServers [ j ] = ( WorldServer ) ( new WorldServerMulti ( this , isavehandler , b0 , this . worldServers [ 0 ] , this . theProfiler ) ) . init ( ) ; <nl> - - } <nl> - - <nl> - - this . worldServers [ j ] . addWorldAccess ( new WorldManager ( this , this . worldServers [ j ] ) ) ; <nl> - + net . minecraftforge . common . MinecraftForge . EVENT _ BUS . post ( new net . minecraftforge . event . world . WorldEvent . Load ( world ) ) ; <nl> - } <nl> - <nl> - - this . getConfigurationManager ( ) . setPlayerManager ( this . worldServers ) ; <nl> - + this . getConfigurationManager ( ) . setPlayerManager ( new WorldServer [ ] { overWorld } ) ; <nl> - <nl> - - if ( this . worldServers [ 0 ] . getWorldInfo ( ) . getDifficulty ( ) = = null ) <nl> - + if ( overWorld . getWorldInfo ( ) . getDifficulty ( ) = = null ) <nl> - { <nl> - this . setDifficultyForAllWorlds ( this . mc . gameSettings . difficulty ) ; <nl> - } <nl> - + + + + END PATCH <nl> + / / This in now a method in Util , which does almost the same , do we need this still ? <nl> + + + + REJECTED PATCH 4 <nl> { <nl> try <nl> diff - - git a / rejects / minecraft / net / minecraft / util / EnumChatFormatting . java . patch . rej b / rejects / minecraft / net / minecraft / util / EnumChatFormatting . java . patch . rej <nl> deleted file mode 100644 <nl> index 3a23340 . . 0000000 <nl> - - - a / rejects / minecraft / net / minecraft / util / EnumChatFormatting . java . patch . rej <nl> + + + / dev / null <nl> @ @ - 1 , 9 + 0 , 0 @ @ <nl> - + + + + REJECTED PATCH 1 <nl> - return this . controlString ; <nl> - } <nl> - <nl> - - @ SideOnly ( Side . CLIENT ) <nl> - public static String getTextWithoutFormattingCodes ( String text ) <nl> - { <nl> - return text = = null ? null : formattingCodePattern . matcher ( text ) . replaceAll ( " " ) ; <nl> - + + + + END PATCH <nl> diff - - git a / rejects / minecraft / net / minecraft / util / EnumFacing . java . patch . rej b / rejects / minecraft / net / minecraft / util / EnumFacing . java . patch . rej <nl> deleted file mode 100644 <nl> index 81b2d78 . . 0000000 <nl> - - - a / rejects / minecraft / net / minecraft / util / EnumFacing . java . patch . rej <nl> + + + / dev / null <nl> @ @ - 1 , 10 + 0 , 0 @ @ <nl> - + + + + REJECTED PATCH 9 <nl> - } <nl> - } <nl> - <nl> - - public static enum Plane implements Predicate , Iterable { <nl> - + public static enum Plane implements Predicate , Iterable < EnumFacing > { / / Forge re - add generic because it just makes life easier . <nl> - HORIZONTAL , <nl> - VERTICAL ; <nl> - <nl> - + + + + END PATCH
NEAREST DIFF (one line): diff - - git a / patches / minecraft / net / minecraft / client / entity / EntityOtherPlayerMP . java . patch b / patches / minecraft / net / minecraft / client / entity / EntityOtherPlayerMP . java . patch <nl> new file mode 100644 <nl> index 0000000 . . d7119a1 <nl> - - - / dev / null <nl> + + + b / patches / minecraft / net / minecraft / client / entity / EntityOtherPlayerMP . java . patch <nl> @ @ - 0 , 0 + 1 , 61 @ @ <nl> + - - - . . / src _ base / minecraft / net / minecraft / client / entity / EntityOtherPlayerMP . java <nl> + + + + . . / src _ work / minecraft / net / minecraft / client / entity / EntityOtherPlayerMP . java <nl> + @ @ - 170 , 29 + 170 , 36 @ @ <nl> + } <nl> + } <nl> + <nl> + - public float getEyeHeight ( ) <nl> + + public void sendChatToPlayer ( ChatMessageComponent par1ChatMessageComponent ) <nl> + + { <nl> + + Minecraft . getMinecraft ( ) . ingameGUI . getChatGUI ( ) . printChatMessage ( par1ChatMessageComponent . toStringWithFormatting ( true ) ) ; <nl> + + } <nl> + + <nl> + + / * * <nl> + + * Returns true if the command sender is allowed to use the given command . <nl> + + * / <nl> + + public boolean canCommandSenderUseCommand ( int par1 , String par2Str ) <nl> + + { <nl> + + return false ; <nl> + + } <nl> + + <nl> + + / * * <nl> + + * Return the position for this command sender . <nl> + + * / <nl> + + public ChunkCoordinates getPlayerCoordinates ( ) <nl> + + { <nl> + + return new ChunkCoordinates ( MathHelper . floor _ double ( this . posX + 0 . 5D ) , MathHelper . floor _ double ( this . posY + 0 . 5D ) , MathHelper . floor _ double ( this . posZ + 0 . 5D ) ) ; <nl> + + } <nl> + + <nl> + + / * = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = FORGE START = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = * / <nl> + + <nl> + + / * * <nl> + + * Returns the default eye height of the player <nl> + + * @ return player default eye height <nl> + + * / <nl> + + @ Override <nl> + + public float getDefaultEyeHeight ( ) <nl> + { <nl> + return 1 . 82F ; <nl> + } <nl> + - <nl> + - public void sendChatToPlayer ( ChatMessageComponent par1ChatMessageComponent ) <nl> + - { <nl> + - Minecraft . getMinecraft ( ) . ingameGUI . getChatGUI ( ) . printChatMessage ( par1ChatMessageComponent . toStringWithFormatting ( true ) ) ; <nl> + - } <nl> + - <nl> + - / * * <nl> + - * Returns true if the command sender is allowed to use the given command . <nl> + - * / <nl> + - public boolean canCommandSenderUseCommand ( int par1 , String par2Str ) <nl> + - { <nl> + - return false ; <nl> + - } <nl> + - <nl> + - / * * <nl> + - * Return the position for this command sender . <nl> + - * / <nl> + - public ChunkCoordinates getPlayerCoordinates ( ) <nl> + - { <nl> + - return new ChunkCoordinates ( MathHelper . floor _ double ( this . posX + 0 . 5D ) , MathHelper . floor _ double ( this . posY + 0 . 5D ) , MathHelper . floor _ double ( this . posZ + 0 . 5D ) ) ; <nl> + - } <nl> + } <nl> diff - - git a / patches / minecraft / net / minecraft / client / entity / EntityPlayerSP . java . patch b / patches / minecraft / net / minecraft / client / entity / EntityPlayerSP . java . patch <nl> index eb71fca . . e401b0d 100644 <nl> - - - a / patches / minecraft / net / minecraft / client / entity / EntityPlayerSP . java . patch <nl> + + + b / patches / minecraft / net / minecraft / client / entity / EntityPlayerSP . java . patch <nl> @ @ - 9 , 7 + 9 , 77 @ @ <nl> <nl> @ SideOnly ( Side . CLIENT ) <nl> public class EntityPlayerSP extends AbstractClientPlayer <nl> - @ @ - 685 , 6 + 687 , 12 @ @ <nl> + @ @ - 570 , 18 + 572 , 63 @ @ <nl> + * / <nl> + protected boolean pushOutOfBlocks ( double par1 , double par3 , double par5 ) <nl> + { <nl> + + if ( this . noClip ) { return false ; } <nl> + int i = MathHelper . floor _ double ( par1 ) ; <nl> + int j = MathHelper . floor _ double ( par3 ) ; <nl> + int k = MathHelper . floor _ double ( par5 ) ; <nl> + double d3 = par1 - ( double ) i ; <nl> + double d4 = par5 - ( double ) k ; <nl> + <nl> + - if ( this . isBlockTranslucent ( i , j , k ) | | this . isBlockTranslucent ( i , j + 1 , k ) ) <nl> + - { <nl> + - boolean flag = ! this . isBlockTranslucent ( i - 1 , j , k ) & & ! this . isBlockTranslucent ( i - 1 , j + 1 , k ) ; <nl> + - boolean flag1 = ! this . isBlockTranslucent ( i + 1 , j , k ) & & ! this . isBlockTranslucent ( i + 1 , j + 1 , k ) ; <nl> + - boolean flag2 = ! this . isBlockTranslucent ( i , j , k - 1 ) & & ! this . isBlockTranslucent ( i , j + 1 , k - 1 ) ; <nl> + - boolean flag3 = ! this . isBlockTranslucent ( i , j , k + 1 ) & & ! this . isBlockTranslucent ( i , j + 1 , k + 1 ) ; <nl> + + int entHeight = Math . max ( Math . round ( this . height ) , 1 ) ; <nl> + + <nl> + + boolean inTranslucentBlock = true ; <nl> + + <nl> + + for ( int i1 = 0 ; i1 < entHeight ; i1 + + ) <nl> + + { <nl> + + if ( ! this . isBlockTranslucent ( i , j + i1 , k ) ) <nl> + + { <nl> + + inTranslucentBlock = false ; <nl> + + } <nl> + + } <nl> + + <nl> + + if ( inTranslucentBlock ) <nl> + + { <nl> + + boolean flag = true ; <nl> + + boolean flag1 = true ; <nl> + + boolean flag2 = true ; <nl> + + boolean flag3 = true ; <nl> + + for ( int i1 = 0 ; i1 < entHeight ; i1 + + ) <nl> + + { <nl> + + if ( this . isBlockTranslucent ( i - 1 , j + i1 , k ) ) <nl> + + { <nl> + + 	 flag = false ; <nl> + + 	 break ; <nl> + + } <nl> + + } <nl> + + for ( int i1 = 0 ; i1 < entHeight ; i1 + + ) <nl> + + { <nl> + + if ( this . isBlockTranslucent ( i + 1 , j + i1 , k ) ) <nl> + + { <nl> + + 	 flag1 = false ; <nl> + + 	 break ; <nl> + + } <nl> + + } <nl> + + for ( int i1 = 0 ; i1 < entHeight ; i1 + + ) <nl> + + { <nl> + + if ( this . isBlockTranslucent ( i , j + i1 , k - 1 ) ) <nl> + + { <nl> + + 	 flag2 = false ; <nl> + + 	 break ; <nl> + + } <nl> + + } <nl> + + for ( int i1 = 0 ; i1 < entHeight ; i1 + + ) <nl> + + { <nl> + + if ( this . isBlockTranslucent ( i , j + i1 , k + 1 ) ) <nl> + + { <nl> + + 	 flag3 = false ; <nl> + + 	 break ; <nl> + + } <nl> + + } <nl> + byte b0 = - 1 ; <nl> + double d5 = 9999 . 0D ; <nl> + <nl> + @ @ - 685 , 6 + 732 , 12 @ @ <nl> <nl> public void playSound ( String par1Str , float par2 , float par3 ) <nl> { <nl> diff - - git a / patches / minecraft / net / minecraft / entity / player / EntityPlayer . java . patch b / patches / minecraft / net / minecraft / entity / player / EntityPlayer . java . patch <nl> index 3247597 . . da35bc4 100644 <nl> - - - a / patches / minecraft / net / minecraft / entity / player / EntityPlayer . java . patch <nl> + + + b / patches / minecraft / net / minecraft / entity / player / EntityPlayer . java . patch <nl> @ @ - 48 , 7 + 48 , 15 @ @ <nl> <nl> / * * Holds the coordinate of the player when enter a minecraft to ride . * / <nl> private ChunkCoordinates startMinecartRidingCoordinate ; <nl> - @ @ - 267 , 6 + 285 , 7 @ @ <nl> + @ @ - 175 , 6 + 193 , 7 @ @ <nl> + this . setLocationAndAngles ( ( double ) chunkcoordinates . posX + 0 . 5D , ( double ) ( chunkcoordinates . posY + 1 ) , ( double ) chunkcoordinates . posZ + 0 . 5D , 0 . 0F , 0 . 0F ) ; <nl> + this . field _ 70741 _ aB = 180 . 0F ; <nl> + this . fireResistance = 20 ; <nl> + + this . eyeHeight = this . getDefaultEyeHeight ( ) ; <nl> + } <nl> + <nl> + protected void applyEntityAttributes ( ) <nl> + @ @ - 267 , 6 + 286 , 7 @ @ <nl> <nl> if ( itemstack = = this . itemInUse ) <nl> { <nl> @ @ - 56 , 7 + 64 , 7 @ @ <nl> if ( this . itemInUseCount < = 25 & & this . itemInUseCount % 4 = = 0 ) <nl> { <nl> this . updateItemUse ( itemstack , 5 ) ; <nl> - @ @ - 429 , 7 + 448 , 7 @ @ <nl> + @ @ - 429 , 7 + 449 , 7 @ @ <nl> vec31 . rotateAroundX ( - this . rotationPitch * ( float ) Math . PI / 180 . 0F ) ; <nl> vec31 . rotateAroundY ( - this . rotationYaw * ( float ) Math . PI / 180 . 0F ) ; <nl> vec31 = vec31 . addVector ( this . posX , this . posY + ( double ) this . getEyeHeight ( ) , this . posZ ) ; <nl> @ @ - 65 , 7 + 73 , 7 @ @ <nl> } <nl> <nl> this . playSound ( " random . eat " , 0 . 5F + 0 . 5F * ( float ) this . rand . nextInt ( 2 ) , ( this . rand . nextFloat ( ) - this . rand . nextFloat ( ) ) * 0 . 2F + 1 . 0F ) ; <nl> - @ @ - 537 , 11 + 556 , 11 @ @ <nl> + @ @ - 537 , 11 + 557 , 11 @ @ <nl> this . cameraYaw = 0 . 0F ; <nl> this . addMountedMovementStat ( this . posX - d0 , this . posY - d1 , this . posZ - d2 ) ; <nl> <nl> @ @ - 79 , 7 + 87 , 7 @ @ <nl> } <nl> } <nl> } <nl> - @ @ - 684 , 11 + 703 , 15 @ @ <nl> + @ @ - 684 , 11 + 704 , 15 @ @ <nl> * / <nl> public void onDeath ( DamageSource par1DamageSource ) <nl> { <nl> @ @ - 95 , 7 + 103 , 7 @ @ <nl> if ( this . username . equals ( " Notch " ) ) <nl> { <nl> this . dropPlayerItemWithRandomChoice ( new ItemStack ( Item . appleRed , 1 ) , true ) ; <nl> - @ @ - 697 , 6 + 720 , 20 @ @ <nl> + @ @ - 697 , 6 + 721 , 20 @ @ <nl> if ( ! this . worldObj . getGameRules ( ) . getGameRuleBooleanValue ( " keepInventory " ) ) <nl> { <nl> this . inventory . dropAllItems ( ) ; <nl> @ @ - 116 , 7 + 124 , 7 @ @ <nl> } <nl> <nl> if ( par1DamageSource ! = null ) <nl> - @ @ - 747 , 7 + 784 , 20 @ @ <nl> + @ @ - 747 , 7 + 785 , 20 @ @ <nl> * / <nl> public EntityItem dropOneItem ( boolean par1 ) <nl> { <nl> @ @ - 138 , 7 + 146 , 7 @ @ <nl> } <nl> <nl> / * * <nl> - @ @ - 756 , 7 + 806 , 7 @ @ <nl> + @ @ - 756 , 7 + 807 , 7 @ @ <nl> * / <nl> public EntityItem dropPlayerItem ( ItemStack par1ItemStack ) <nl> { <nl> @ @ - 147 , 7 + 155 , 7 @ @ <nl> } <nl> <nl> / * * <nl> - @ @ - 812 , 15 + 862 , 28 @ @ <nl> + @ @ - 812 , 15 + 863 , 28 @ @ <nl> * / <nl> public void joinEntityItemWithWorld ( EntityItem par1EntityItem ) <nl> { <nl> @ @ - 178 , 7 + 186 , 7 @ @ <nl> <nl> if ( f > 1 . 0F ) <nl> { <nl> - @ @ - 831 , 7 + 894 , 9 @ @ <nl> + @ @ - 831 , 7 + 895 , 9 @ @ <nl> { <nl> float f1 = ( float ) ( i * i + 1 ) ; <nl> <nl> @ @ - 189 , 7 + 197 , 7 @ @ <nl> { <nl> f + = f1 * 0 . 08F ; <nl> } <nl> - @ @ - 862 , 7 + 927 , 8 @ @ <nl> + @ @ - 862 , 7 + 928 , 8 @ @ <nl> f / = 5 . 0F ; <nl> } <nl> <nl> @ @ - 199 , 7 + 207 , 7 @ @ <nl> } <nl> <nl> / * * <nl> - @ @ - 870 , 7 + 936 , 7 @ @ <nl> + @ @ - 870 , 7 + 937 , 7 @ @ <nl> * / <nl> public boolean canHarvestBlock ( Block par1Block ) <nl> { <nl> @ @ - 208 , 7 + 216 , 7 @ @ <nl> } <nl> <nl> / * * <nl> - @ @ - 900 , 6 + 966 , 14 @ @ <nl> + @ @ - 900 , 6 + 967 , 14 @ @ <nl> this . spawnChunk = new ChunkCoordinates ( par1NBTTagCompound . getInteger ( " SpawnX " ) , par1NBTTagCompound . getInteger ( " SpawnY " ) , par1NBTTagCompound . getInteger ( " SpawnZ " ) ) ; <nl> this . spawnForced = par1NBTTagCompound . getBoolean ( " SpawnForced " ) ; <nl> } <nl> @ @ - 223 , 7 + 231 , 7 @ @ <nl> <nl> this . foodStats . readNBT ( par1NBTTagCompound ) ; <nl> this . capabilities . readCapabilitiesFromNBT ( par1NBTTagCompound ) ; <nl> - @ @ - 933 , 6 + 1007 , 21 @ @ <nl> + @ @ - 933 , 6 + 1008 , 21 @ @ <nl> par1NBTTagCompound . setInteger ( " SpawnZ " , this . spawnChunk . posZ ) ; <nl> par1NBTTagCompound . setBoolean ( " SpawnForced " , this . spawnForced ) ; <nl> } <nl> @ @ - 245 , 7 + 253 , 16 @ @ <nl> <nl> this . foodStats . writeNBT ( par1NBTTagCompound ) ; <nl> this . capabilities . writeCapabilitiesToNBT ( par1NBTTagCompound ) ; <nl> - @ @ - 980 , 6 + 1069 , 7 @ @ <nl> + @ @ - 964 , 7 + 1054 , 7 @ @ <nl> + <nl> + public float getEyeHeight ( ) <nl> + { <nl> + - return 0 . 12F ; <nl> + + return eyeHeight ; <nl> + } <nl> + <nl> + / * * <nl> + @ @ - 980 , 6 + 1070 , 7 @ @ <nl> * / <nl> public boolean attackEntityFrom ( DamageSource par1DamageSource , float par2 ) <nl> { <nl> @ @ - 253 , 7 + 270 , 7 @ @ <nl> if ( this . isEntityInvulnerable ( ) ) <nl> { <nl> return false ; <nl> - @ @ - 1092 , 12 + 1182 , 15 @ @ <nl> + @ @ - 1092 , 12 + 1183 , 15 @ @ <nl> { <nl> if ( ! this . isEntityInvulnerable ( ) ) <nl> { <nl> @ @ - 270 , 7 + 287 , 7 @ @ <nl> par2 = this . applyPotionDamageCalculations ( par1DamageSource , par2 ) ; <nl> float f1 = par2 ; <nl> par2 = Math . max ( par2 - this . getAbsorptionAmount ( ) , 0 . 0F ) ; <nl> - @ @ - 1147 , 6 + 1240 , 7 @ @ <nl> + @ @ - 1147 , 6 + 1241 , 7 @ @ <nl> <nl> public boolean interactWith ( Entity par1Entity ) <nl> { <nl> @ @ - 278 , 7 + 295 , 7 @ @ <nl> ItemStack itemstack = this . getCurrentEquippedItem ( ) ; <nl> ItemStack itemstack1 = itemstack ! = null ? itemstack . copy ( ) : null ; <nl> <nl> - @ @ - 1203 , 7 + 1297 , 9 @ @ <nl> + @ @ - 1203 , 7 + 1298 , 9 @ @ <nl> * / <nl> public void destroyCurrentEquippedItem ( ) <nl> { <nl> @ @ - 288 , 7 + 305 , 7 @ @ <nl> } <nl> <nl> / * * <nl> - @ @ - 1220 , 6 + 1316 , 15 @ @ <nl> + @ @ - 1220 , 6 + 1317 , 15 @ @ <nl> * / <nl> public void attackTargetEntityWithCurrentItem ( Entity par1Entity ) <nl> { <nl> @ @ - 304 , 7 + 321 , 7 @ @ <nl> if ( par1Entity . canAttackWithItem ( ) ) <nl> { <nl> if ( ! par1Entity . hitByEntity ( this ) ) <nl> - @ @ - 1373 , 6 + 1478 , 12 @ @ <nl> + @ @ - 1373 , 6 + 1479 , 12 @ @ <nl> * / <nl> public EnumStatus sleepInBedAt ( int par1 , int par2 , int par3 ) <nl> { <nl> @ @ - 317 , 7 + 334 , 7 @ @ <nl> if ( ! this . worldObj . isRemote ) <nl> { <nl> if ( this . isPlayerSleeping ( ) | | ! this . isEntityAlive ( ) ) <nl> - @ @ - 1417 , 6 + 1528 , 11 @ @ <nl> + @ @ - 1417 , 6 + 1529 , 11 @ @ <nl> { <nl> int l = this . worldObj . getBlockMetadata ( par1 , par2 , par3 ) ; <nl> int i1 = BlockBed . getDirection ( l ) ; <nl> @ @ - 329 , 7 + 346 , 7 @ @ <nl> float f = 0 . 5F ; <nl> float f1 = 0 . 5F ; <nl> <nl> - @ @ - 1487 , 10 + 1603 , 12 @ @ <nl> + @ @ - 1487 , 10 + 1604 , 12 @ @ <nl> ChunkCoordinates chunkcoordinates = this . playerLocation ; <nl> ChunkCoordinates chunkcoordinates1 = this . playerLocation ; <nl> <nl> @ @ - 346 , 7 + 363 , 7 @ @ <nl> <nl> if ( chunkcoordinates1 = = null ) <nl> { <nl> - @ @ - 1527 , 7 + 1645 , 9 @ @ <nl> + @ @ - 1527 , 7 + 1646 , 9 @ @ <nl> * / <nl> private boolean isInBed ( ) <nl> { <nl> @ @ - 357 , 7 + 374 , 7 @ @ <nl> } <nl> <nl> / * * <nl> - @ @ - 1542 , 9 + 1662 , 12 @ @ <nl> + @ @ - 1542 , 9 + 1663 , 12 @ @ <nl> ichunkprovider . loadChunk ( par1ChunkCoordinates . posX - 3 > > 4 , par1ChunkCoordinates . posZ + 3 > > 4 ) ; <nl> ichunkprovider . loadChunk ( par1ChunkCoordinates . posX + 3 > > 4 , par1ChunkCoordinates . posZ + 3 > > 4 ) ; <nl> <nl> @ @ - 373 , 7 + 390 , 7 @ @ <nl> return chunkcoordinates1 ; <nl> } <nl> else <nl> - @ @ - 1566 , 10 + 1689 , 13 @ @ <nl> + @ @ - 1566 , 10 + 1690 , 13 @ @ <nl> { <nl> if ( this . playerLocation ! = null ) <nl> { <nl> @ @ - 391 , 7 + 408 , 7 @ @ <nl> { <nl> case 0 : <nl> return 90 . 0F ; <nl> - @ @ - 1635 , 14 + 1761 , 40 @ @ <nl> + @ @ - 1635 , 14 + 1762 , 40 @ @ <nl> / * * <nl> * Returns the location of the bed the player will respawn at , or null if the player has not slept in a bed . <nl> * / <nl> @ @ - 436 , 7 + 453 , 7 @ @ <nl> } <nl> <nl> / * * <nl> - @ @ - 1650 , 6 + 1802 , 10 @ @ <nl> + @ @ - 1650 , 6 + 1803 , 10 @ @ <nl> * / <nl> public void setSpawnChunk ( ChunkCoordinates par1ChunkCoordinates , boolean par2 ) <nl> { <nl> @ @ - 447 , 7 + 464 , 7 @ @ <nl> if ( par1ChunkCoordinates ! = null ) <nl> { <nl> this . spawnChunk = new ChunkCoordinates ( par1ChunkCoordinates ) ; <nl> - @ @ - 1661 , 7 + 1817 , 32 @ @ <nl> + @ @ - 1661 , 7 + 1818 , 32 @ @ <nl> this . spawnForced = false ; <nl> } <nl> } <nl> @ @ - 481 , 7 + 498 , 7 @ @ <nl> / * * <nl> * Will trigger the specified trigger . <nl> * / <nl> - @ @ - 1843 , 6 + 2024 , 10 @ @ <nl> + @ @ - 1843 , 6 + 2025 , 10 @ @ <nl> <nl> super . fall ( par1 ) ; <nl> } <nl> @ @ - 492 , 7 + 509 , 7 @ @ <nl> } <nl> <nl> / * * <nl> - @ @ - 1884 , 7 + 2069 , 7 @ @ <nl> + @ @ - 1884 , 7 + 2070 , 7 @ @ <nl> { <nl> if ( par1ItemStack . getItem ( ) . requiresMultipleRenderPasses ( ) ) <nl> { <nl> @ @ - 501 , 7 + 518 , 7 @ @ <nl> } <nl> <nl> if ( this . itemInUse ! = null & & par1ItemStack . itemID = = Item . bow . itemID ) <nl> - @ @ - 1906 , 6 + 2091 , 7 @ @ <nl> + @ @ - 1906 , 6 + 2092 , 7 @ @ <nl> return Item . bow . getItemIconForUseDuration ( 0 ) ; <nl> } <nl> } <nl> @ @ - 509 , 7 + 526 , 7 @ @ <nl> } <nl> <nl> return icon ; <nl> - @ @ - 2127 , 7 + 2313 , 17 @ @ <nl> + @ @ - 2127 , 7 + 2314 , 17 @ @ <nl> this . setScore ( par1EntityPlayer . getScore ( ) ) ; <nl> } <nl> <nl> @ @ - 527 , 7 + 544 , 7 @ @ <nl> } <nl> <nl> / * * <nl> - @ @ - 2191 , 7 + 2387 , 14 @ @ <nl> + @ @ - 2191 , 7 + 2388 , 14 @ @ <nl> * / <nl> public void setCurrentItemOrArmor ( int par1 , ItemStack par2ItemStack ) <nl> { <nl> @ @ - 543 , 3 + 560 , 21 @ @ <nl> } <nl> <nl> @ SideOnly ( Side . CLIENT ) <nl> + @ @ - 2267 , 4 + 2471 , 17 @ @ <nl> + { <nl> + FMLNetworkHandler . openGui ( this , mod , modGuiId , world , x , y , z ) ; <nl> + } <nl> + + <nl> + + / * = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = FORGE START = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = * / <nl> + + <nl> + + public float eyeHeight ; <nl> + + <nl> + + / * * <nl> + + * Returns the default eye height of the player <nl> + + * @ return player default eye height <nl> + + * / <nl> + + public float getDefaultEyeHeight ( ) <nl> + + { <nl> + + return 0 . 12F ; <nl> + + } <nl> + } <nl> diff - - git a / patches / minecraft / net / minecraft / entity / player / EntityPlayerMP . java . patch b / patches / minecraft / net / minecraft / entity / player / EntityPlayerMP . java . patch <nl> index 577132e . . 1e197c8 100644 <nl> - - - a / patches / minecraft / net / minecraft / entity / player / EntityPlayerMP . java . patch <nl> + + + b / patches / minecraft / net / minecraft / entity / player / EntityPlayerMP . java . patch <nl> @ @ - 33 , 7 + 33 , 19 @ @ <nl> <nl> this . mcServer = par1MinecraftServer ; <nl> this . stepHeight = 0 . 0F ; <nl> - @ @ - 289 , 7 + 287 , 10 @ @ <nl> + @ @ - 239 , 11 + 237 , 6 @ @ <nl> + this . yOffset = 0 . 0F ; <nl> + } <nl> + <nl> + - public float getEyeHeight ( ) <nl> + - { <nl> + - return 1 . 62F ; <nl> + - } <nl> + - <nl> + / * * <nl> + * Called to update the entity ' s position / logic . <nl> + * / <nl> + @ @ - 289 , 7 + 282 , 10 @ @ <nl> if ( chunkcoordintpair ! = null & & this . worldObj . blockExists ( chunkcoordintpair . chunkXPos < < 4 , 0 , chunkcoordintpair . chunkZPos < < 4 ) ) <nl> { <nl> arraylist . add ( this . worldObj . getChunkFromChunkCoords ( chunkcoordintpair . chunkXPos , chunkcoordintpair . chunkZPos ) ) ; <nl> @ @ - 45 , 7 + 57 , 7 @ @ <nl> } <nl> } <nl> <nl> - @ @ - 310 , 6 + 311 , 7 @ @ <nl> + @ @ - 310 , 6 + 306 , 7 @ @ <nl> { <nl> Chunk chunk = ( Chunk ) iterator2 . next ( ) ; <nl> this . getServerForPlayer ( ) . getEntityTracker ( ) . func _ 85172 _ a ( this , chunk ) ; <nl> @ @ - 53 , 7 + 65 , 7 @ @ <nl> } <nl> } <nl> } <nl> - @ @ - 377 , 11 + 379 , 25 @ @ <nl> + @ @ - 377 , 11 + 374 , 25 @ @ <nl> * / <nl> public void onDeath ( DamageSource par1DamageSource ) <nl> { <nl> @ @ - 79 , 3 + 91 , 20 @ @ <nl> } <nl> <nl> Collection collection = this . worldObj . getScoreboard ( ) . func _ 96520 _ a ( ScoreObjectiveCriteria . deathCount ) ; <nl> + @ @ - 1043 , 4 + 1054 , 16 @ @ <nl> + { <nl> + return new ChunkCoordinates ( MathHelper . floor _ double ( this . posX ) , MathHelper . floor _ double ( this . posY + 0 . 5D ) , MathHelper . floor _ double ( this . posZ ) ) ; <nl> + } <nl> + + <nl> + + / * = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = FORGE START = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = * / <nl> + + <nl> + + / * * <nl> + + * Returns the default eye height of the player <nl> + + * @ return player default eye height <nl> + + * / <nl> + + @ Override <nl> + + public float getDefaultEyeHeight ( ) <nl> + + { <nl> + + return 1 . 62F ; <nl> + + } <nl> + }

TEST DIFF:
diff - - git a / patches / minecraft / net / minecraft / server / integrated / IntegratedServer . java . patch b / patches / minecraft / net / minecraft / server / integrated / IntegratedServer . java . patch 
 index 60e46c1 . . 72385a8 100644 
 - - - a / patches / minecraft / net / minecraft / server / integrated / IntegratedServer . java . patch 
 + + + b / patches / minecraft / net / minecraft / server / integrated / IntegratedServer . java . patch 
 @ @ - 9 , 7 + 9 , 64 @ @ 
 ISaveHandler isavehandler = this . getActiveAnvilConverter ( ) . getSaveLoader ( p _ 71247 _ 1 _ , true ) ; 
 this . setResourcePackFromWorld ( this . getFolderName ( ) , isavehandler ) ; 
 WorldInfo worldinfo = isavehandler . loadWorldInfo ( ) ; 
 - @ @ - 142 , 9 + 140 , 10 @ @ 
 + @ @ - 87 , 44 + 85 , 24 @ @ 
 + worldinfo . setWorldName ( p _ 71247 _ 2 _ ) ; 
 + } 
 + 
 + - for ( int i = 0 ; i < this . worldServers . length ; + + i ) 
 + - { 
 + - int j = 0 ; 
 + + WorldServer overWorld = ( isDemo ( ) ? ( WorldServer ) ( new DemoWorldServer ( this , isavehandler , worldinfo , 0 , this . theProfiler ) ) . init ( ) : 
 + + ( WorldServer ) ( new WorldServer ( this , isavehandler , worldinfo , 0 , this . theProfiler ) ) . init ( ) ) ; 
 + + overWorld . initialize ( this . theWorldSettings ) ; 
 + 
 + - if ( i = = 1 ) 
 + + for ( int dim : net . minecraftforge . common . DimensionManager . getStaticDimensionIDs ( ) ) 
 + + { 
 + + WorldServer world = ( dim = = 0 ? overWorld : ( WorldServer ) ( new WorldServerMulti ( this , isavehandler , dim , overWorld , this . theProfiler ) ) . init ( ) ) ; 
 + + world . addWorldAccess ( new WorldManager ( this , world ) ) ; 
 + + if ( ! this . isSinglePlayer ( ) ) 
 + { 
 + - j = - 1 ; 
 + + world . getWorldInfo ( ) . setGameType ( getGameType ( ) ) ; 
 + } 
 + - 
 + - if ( i = = 2 ) 
 + - { 
 + - j = 1 ; 
 + - } 
 + - 
 + - if ( i = = 0 ) 
 + - { 
 + - if ( this . isDemo ( ) ) 
 + - { 
 + - this . worldServers [ i ] = ( WorldServer ) ( new DemoWorldServer ( this , isavehandler , worldinfo , j , this . theProfiler ) ) . init ( ) ; 
 + - } 
 + - else 
 + - { 
 + - this . worldServers [ i ] = ( WorldServer ) ( new WorldServer ( this , isavehandler , worldinfo , j , this . theProfiler ) ) . init ( ) ; 
 + - } 
 + - 
 + - this . worldServers [ i ] . initialize ( this . theWorldSettings ) ; 
 + - } 
 + - else 
 + - { 
 + - this . worldServers [ i ] = ( WorldServer ) ( new WorldServerMulti ( this , isavehandler , j , this . worldServers [ 0 ] , this . theProfiler ) ) . init ( ) ; 
 + - } 
 + - 
 + - this . worldServers [ i ] . addWorldAccess ( new WorldManager ( this , this . worldServers [ i ] ) ) ; 
 + + net . minecraftforge . common . MinecraftForge . EVENT _ BUS . post ( new net . minecraftforge . event . world . WorldEvent . Load ( world ) ) ; 
 + } 
 + 
 + - this . getConfigurationManager ( ) . setPlayerManager ( this . worldServers ) ; 
 + + this . getConfigurationManager ( ) . setPlayerManager ( new WorldServer [ ] { overWorld } ) ; 
 + 
 + - if ( this . worldServers [ 0 ] . getWorldInfo ( ) . getDifficulty ( ) = = null ) 
 + + if ( overWorld . getWorldInfo ( ) . getDifficulty ( ) = = null ) 
 + { 
 + this . setDifficultyForAllWorlds ( this . mc . gameSettings . difficulty ) ; 
 + } 
 + @ @ - 142 , 9 + 120 , 10 @ @ 
 this . setAllowFlight ( true ) ; 
 logger . info ( " Generating keypair " ) ; 
 this . setKeyPair ( CryptManager . generateKeyPair ( ) ) ; 
 @ @ - 21 , 7 + 78 , 7 @ @ 
 } 
 
 public void tick ( ) 
 - @ @ - 217 , 6 + 216 , 7 @ @ 
 + @ @ - 217 , 6 + 196 , 7 @ @ 
 
 public EnumDifficulty getDifficulty ( ) 
 { 
 diff - - git a / patches / minecraft / net / minecraft / world / World . java . patch b / patches / minecraft / net / minecraft / world / World . java . patch 
 new file mode 100644 
 index 0000000 . . d12e541 
 - - - / dev / null 
 + + + b / patches / minecraft / net / minecraft / world / World . java . patch 
 @ @ - 0 , 0 + 1 , 869 @ @ 
 + - - - . . / src - base / minecraft / net / minecraft / world / World . java 
 + + + + . . / src - work / minecraft / net / minecraft / world / World . java 
 + @ @ - 57 , 6 + 57 , 13 @ @ 
 + 
 + public abstract class World implements IBlockAccess 
 + { 
 + + / * * 
 + + * Used in the getEntitiesWithinAABB functions to expand the search area for entities . 
 + + * Modders should change this variable to a higher value if it is less then the radius 
 + + * of one of there entities . 
 + + * / 
 + + public static double MAX _ ENTITY _ RADIUS = 2 . 0D ; 
 + + 
 + private int field _ 181546 _ a = 63 ; 
 + protected boolean scheduledUpdatesAreImmediate ; 
 + public final List < Entity > loadedEntityList = Lists . < Entity > newArrayList ( ) ; 
 + @ @ - 99 , 6 + 106 , 10 @ @ 
 + int [ ] lightUpdateBlockList ; 
 + private static final String _ _ OBFID = " CL _ 00000140 " ; 
 + 
 + + public boolean restoringBlockSnapshots = false ; 
 + + public boolean captureBlockSnapshots = false ; 
 + + public java . util . ArrayList < net . minecraftforge . common . util . BlockSnapshot > capturedBlockSnapshots = new java . util . ArrayList < net . minecraftforge . common . util . BlockSnapshot > ( ) ; 
 + + 
 + protected World ( ISaveHandler saveHandlerIn , WorldInfo info , WorldProvider providerIn , Profiler profilerIn , boolean client ) 
 + { 
 + this . ambientTickCountdown = this . rand . nextInt ( 12000 ) ; 
 + @ @ - 111 , 6 + 122 , 7 @ @ 
 + this . provider = providerIn ; 
 + this . isRemote = client ; 
 + this . worldBorder = providerIn . getWorldBorder ( ) ; 
 + + perWorldStorage = new MapStorage ( ( ISaveHandler ) null ) ; 
 + } 
 + 
 + public World init ( ) 
 + @ @ - 120 , 6 + 132 , 11 @ @ 
 + 
 + public BiomeGenBase getBiomeGenForCoords ( final BlockPos pos ) 
 + { 
 + + return this . provider . getBiomeGenForCoords ( pos ) ; 
 + + } 
 + + 
 + + public BiomeGenBase getBiomeGenForCoordsBody ( final BlockPos pos ) 
 + + { 
 + if ( this . isBlockLoaded ( pos ) ) 
 + { 
 + Chunk chunk = this . getChunkFromBlockCoords ( pos ) ; 
 + @ @ - 186 , 7 + 203 , 7 @ @ 
 + 
 + public boolean isAirBlock ( BlockPos pos ) 
 + { 
 + - return this . getBlockState ( pos ) . getBlock ( ) . getMaterial ( ) = = Material . air ; 
 + + return this . getBlockState ( pos ) . getBlock ( ) . isAir ( this , pos ) ; 
 + } 
 + 
 + public boolean isBlockLoaded ( BlockPos pos ) 
 + @ @ - 286 , 39 + 303 , 61 @ @ 
 + { 
 + Chunk chunk = this . getChunkFromBlockCoords ( pos ) ; 
 + Block block = newState . getBlock ( ) ; 
 + + 
 + + net . minecraftforge . common . util . BlockSnapshot blockSnapshot = null ; 
 + + if ( this . captureBlockSnapshots & & ! this . isRemote ) 
 + + { 
 + + blockSnapshot = net . minecraftforge . common . util . BlockSnapshot . getBlockSnapshot ( this , pos , flags ) ; 
 + + this . capturedBlockSnapshots . add ( blockSnapshot ) ; 
 + + } 
 + + int oldLight = getBlockState ( pos ) . getBlock ( ) . getLightValue ( this , pos ) ; 
 + + 
 + IBlockState iblockstate = chunk . setBlockState ( pos , newState ) ; 
 + 
 + if ( iblockstate = = null ) 
 + { 
 + + if ( blockSnapshot ! = null ) this . capturedBlockSnapshots . remove ( blockSnapshot ) ; 
 + return false ; 
 + } 
 + else 
 + { 
 + Block block1 = iblockstate . getBlock ( ) ; 
 + 
 + - if ( block . getLightOpacity ( ) ! = block1 . getLightOpacity ( ) | | block . getLightValue ( ) ! = block1 . getLightValue ( ) ) 
 + + if ( block . getLightOpacity ( ) ! = block1 . getLightOpacity ( ) | | block . getLightValue ( this , pos ) ! = block1 . getLightValue ( ) ) 
 + { 
 + this . theProfiler . startSection ( " checkLight " ) ; 
 + this . checkLight ( pos ) ; 
 + this . theProfiler . endSection ( ) ; 
 + } 
 + 
 + - if ( ( flags & 2 ) ! = 0 & & ( ! this . isRemote | | ( flags & 4 ) = = 0 ) & & chunk . isPopulated ( ) ) 
 + + if ( blockSnapshot = = null ) / / Don ' t notify clients or update physics while capturing blockstates 
 + { 
 + - this . markBlockForUpdate ( pos ) ; 
 + + this . markAndNotifyBlock ( pos , chunk , iblockstate , newState , flags ) ; / / Modularize client and physic updates 
 + } 
 + 
 + + return true ; 
 + + } 
 + + } 
 + + } 
 + + 
 + + / / Split off from original setBlockState ( BlockPos , IBlockState Block p _ 147465 _ 4 _ , int ) method in order to directly send client and physic updates 
 + + public void markAndNotifyBlock ( BlockPos pos , Chunk chunk , IBlockState old , IBlockState new _ , int flags ) 
 + + { 
 + + if ( ( flags & 2 ) ! = 0 & & ( ! this . isRemote | | ( flags & 4 ) = = 0 ) & & ( chunk = = null | | chunk . isPopulated ( ) ) ) 
 + + { 
 + + this . markBlockForUpdate ( pos ) ; 
 + + } 
 + + { 
 + + { 
 + if ( ! this . isRemote & & ( flags & 1 ) ! = 0 ) 
 + { 
 + - this . notifyNeighborsRespectDebug ( pos , iblockstate . getBlock ( ) ) ; 
 + + this . notifyNeighborsRespectDebug ( pos , new _ . getBlock ( ) ) ; 
 + 
 + - if ( block . hasComparatorInputOverride ( ) ) 
 + + if ( new _ . getBlock ( ) . hasComparatorInputOverride ( ) ) 
 + { 
 + - this . updateComparatorOutputLevel ( pos , block ) ; 
 + + this . updateComparatorOutputLevel ( pos , new _ . getBlock ( ) ) ; 
 + } 
 + } 
 + - 
 + - return true ; 
 + } 
 + } 
 + } 
 + @ @ - 406 , 6 + 445 , 9 @ @ 
 + 
 + public void notifyNeighborsOfStateChange ( BlockPos pos , Block blockType ) 
 + { 
 + + if ( net . minecraftforge . event . ForgeEventFactory . onNeighborNotify ( this , pos , this . getBlockState ( pos ) , java . util . EnumSet . allOf ( EnumFacing . class ) ) . isCanceled ( ) ) 
 + + return ; 
 + + 
 + this . notifyBlockOfStateChange ( pos . west ( ) , blockType ) ; 
 + this . notifyBlockOfStateChange ( pos . east ( ) , blockType ) ; 
 + this . notifyBlockOfStateChange ( pos . down ( ) , blockType ) ; 
 + @ @ - 416 , 6 + 458 , 11 @ @ 
 + 
 + public void notifyNeighborsOfStateExcept ( BlockPos pos , Block blockType , EnumFacing skipSide ) 
 + { 
 + + java . util . EnumSet < EnumFacing > directions = java . util . EnumSet . allOf ( EnumFacing . class ) ; 
 + + directions . remove ( skipSide ) ; 
 + + if ( net . minecraftforge . event . ForgeEventFactory . onNeighborNotify ( this , pos , this . getBlockState ( pos ) , directions ) . isCanceled ( ) ) 
 + + return ; 
 + + 
 + if ( skipSide ! = EnumFacing . WEST ) 
 + { 
 + this . notifyBlockOfStateChange ( pos . west ( ) , blockType ) ; 
 + @ @ - 780 , 7 + 827 , 7 @ @ 
 + 
 + public boolean isDaytime ( ) 
 + { 
 + - return this . skylightSubtracted < 4 ; 
 + + return this . provider . isDaytime ( ) ; 
 + } 
 + 
 + public MovingObjectPosition rayTraceBlocks ( Vec3 p _ 72933 _ 1 _ , Vec3 p _ 72933 _ 2 _ ) 
 + @ @ - 975 , 6 + 1022 , 12 @ @ 
 + 
 + public void playSoundAtEntity ( Entity p _ 72956 _ 1 _ , String p _ 72956 _ 2 _ , float p _ 72956 _ 3 _ , float p _ 72956 _ 4 _ ) 
 + { 
 + + net . minecraftforge . event . entity . PlaySoundAtEntityEvent event = net . minecraftforge . event . ForgeEventFactory . onPlaySoundAtEntity ( p _ 72956 _ 1 _ , p _ 72956 _ 2 _ , p _ 72956 _ 3 _ , p _ 72956 _ 4 _ ) ; 
 + + if ( event . isCanceled ( ) | | event . name = = null ) return ; 
 + + p _ 72956 _ 2 _ = event . name ; 
 + + p _ 72956 _ 3 _ = event . newVolume ; 
 + + p _ 72956 _ 4 _ = event . newPitch ; 
 + + 
 + for ( int i = 0 ; i < this . worldAccesses . size ( ) ; + + i ) 
 + { 
 + ( ( IWorldAccess ) this . worldAccesses . get ( i ) ) . playSound ( p _ 72956 _ 2 _ , p _ 72956 _ 1 _ . posX , p _ 72956 _ 1 _ . posY , p _ 72956 _ 1 _ . posZ , p _ 72956 _ 3 _ , p _ 72956 _ 4 _ ) ; 
 + @ @ - 983 , 6 + 1036 , 12 @ @ 
 + 
 + public void playSoundToNearExcept ( EntityPlayer p _ 85173 _ 1 _ , String p _ 85173 _ 2 _ , float p _ 85173 _ 3 _ , float p _ 85173 _ 4 _ ) 
 + { 
 + + net . minecraftforge . event . entity . PlaySoundAtEntityEvent event = net . minecraftforge . event . ForgeEventFactory . onPlaySoundAtEntity ( p _ 85173 _ 1 _ , p _ 85173 _ 2 _ , p _ 85173 _ 3 _ , p _ 85173 _ 4 _ ) ; 
 + + if ( event . isCanceled ( ) | | event . name = = null ) return ; 
 + + p _ 85173 _ 2 _ = event . name ; 
 + + p _ 85173 _ 3 _ = event . newVolume ; 
 + + p _ 85173 _ 4 _ = event . newPitch ; 
 + + 
 + for ( int i = 0 ; i < this . worldAccesses . size ( ) ; + + i ) 
 + { 
 + ( ( IWorldAccess ) this . worldAccesses . get ( i ) ) . playSoundToNearExcept ( p _ 85173 _ 1 _ , p _ 85173 _ 2 _ , p _ 85173 _ 1 _ . posX , p _ 85173 _ 1 _ . posY , p _ 85173 _ 1 _ . posZ , p _ 85173 _ 3 _ , p _ 85173 _ 4 _ ) ; 
 + @ @ - 1036 , 6 + 1095 , 9 @ @ 
 + 
 + public boolean spawnEntityInWorld ( Entity p _ 72838 _ 1 _ ) 
 + { 
 + + / / do not drop any items while restoring blocksnapshots . Prevents dupes 
 + + if ( ! this . isRemote & & ( p _ 72838 _ 1 _ = = null | | ( p _ 72838 _ 1 _ instanceof net . minecraft . entity . item . EntityItem & & this . restoringBlockSnapshots ) ) ) return false ; 
 + + 
 + int i = MathHelper . floor _ double ( p _ 72838 _ 1 _ . posX / 16 . 0D ) ; 
 + int j = MathHelper . floor _ double ( p _ 72838 _ 1 _ . posZ / 16 . 0D ) ; 
 + boolean flag = p _ 72838 _ 1 _ . forceSpawn ; 
 + @ @ - 1058 , 6 + 1120 , 8 @ @ 
 + this . updateAllPlayersSleepingFlag ( ) ; 
 + } 
 + 
 + + if ( net . minecraftforge . common . MinecraftForge . EVENT _ BUS . post ( new net . minecraftforge . event . entity . EntityJoinWorldEvent ( p _ 72838 _ 1 _ , this ) ) & & ! flag ) return false ; 
 + + 
 + this . getChunkFromChunkCoords ( i , j ) . addEntity ( p _ 72838 _ 1 _ ) ; 
 + this . loadedEntityList . add ( p _ 72838 _ 1 _ ) ; 
 + this . onEntityAdded ( p _ 72838 _ 1 _ ) ; 
 + @ @ - 1270 , 17 + 1334 , 29 @ @ 
 + 
 + public int calculateSkylightSubtracted ( float p _ 72967 _ 1 _ ) 
 + { 
 + + float f = provider . getSunBrightnessFactor ( p _ 72967 _ 1 _ ) ; 
 + + f = 1 - f ; 
 + + return ( int ) ( f * 11 ) ; 
 + + } 
 + + 
 + + / * * 
 + + * The current sun brightness factor for this dimension . 
 + + * 0 . 0f means no light at all , and 1 . 0f means maximum sunlight . 
 + + * Highly recommended for sunlight detection like solar panel . 
 + + * 
 + + * @ return The current brightness factor 
 + + * * / 
 + + public float getSunBrightnessFactor ( float p _ 72967 _ 1 _ ) 
 + + { 
 + float f = this . getCelestialAngle ( p _ 72967 _ 1 _ ) ; 
 + float f1 = 1 . 0F - ( MathHelper . cos ( f * ( float ) Math . PI * 2 . 0F ) * 2 . 0F + 0 . 5F ) ; 
 + f1 = MathHelper . clamp _ float ( f1 , 0 . 0F , 1 . 0F ) ; 
 + f1 = 1 . 0F - f1 ; 
 + f1 = ( float ) ( ( double ) f1 * ( 1 . 0D - ( double ) ( this . getRainStrength ( p _ 72967 _ 1 _ ) * 5 . 0F ) / 16 . 0D ) ) ; 
 + f1 = ( float ) ( ( double ) f1 * ( 1 . 0D - ( double ) ( this . getThunderStrength ( p _ 72967 _ 1 _ ) * 5 . 0F ) / 16 . 0D ) ) ; 
 + - f1 = 1 . 0F - f1 ; 
 + - return ( int ) ( f1 * 11 . 0F ) ; 
 + + return f1 ; 
 + } 
 + 
 + - @ SideOnly ( Side . CLIENT ) 
 + public void removeWorldAccess ( IWorldAccess p _ 72848 _ 1 _ ) 
 + { 
 + this . worldAccesses . remove ( p _ 72848 _ 1 _ ) ; 
 + @ @ - 1289 , 6 + 1365 , 12 @ @ 
 + @ SideOnly ( Side . CLIENT ) 
 + public float getSunBrightness ( float p _ 72971 _ 1 _ ) 
 + { 
 + + return this . provider . getSunBrightness ( p _ 72971 _ 1 _ ) ; 
 + + } 
 + + 
 + + @ SideOnly ( Side . CLIENT ) 
 + + public float getSunBrightnessBody ( float p _ 72971 _ 1 _ ) 
 + + { 
 + float f = this . getCelestialAngle ( p _ 72971 _ 1 _ ) ; 
 + float f1 = 1 . 0F - ( MathHelper . cos ( f * ( float ) Math . PI * 2 . 0F ) * 2 . 0F + 0 . 2F ) ; 
 + f1 = MathHelper . clamp _ float ( f1 , 0 . 0F , 1 . 0F ) ; 
 + @ @ - 1301 , 6 + 1383 , 12 @ @ 
 + @ SideOnly ( Side . CLIENT ) 
 + public Vec3 getSkyColor ( Entity p _ 72833 _ 1 _ , float p _ 72833 _ 2 _ ) 
 + { 
 + + return this . provider . getSkyColor ( p _ 72833 _ 1 _ , p _ 72833 _ 2 _ ) ; 
 + + } 
 + + 
 + + @ SideOnly ( Side . CLIENT ) 
 + + public Vec3 getSkyColorBody ( Entity p _ 72833 _ 1 _ , float p _ 72833 _ 2 _ ) 
 + + { 
 + float f = this . getCelestialAngle ( p _ 72833 _ 2 _ ) ; 
 + float f1 = MathHelper . cos ( f * ( float ) Math . PI * 2 . 0F ) * 2 . 0F + 0 . 5F ; 
 + f1 = MathHelper . clamp _ float ( f1 , 0 . 0F , 1 . 0F ) ; 
 + @ @ - 1308 , 9 + 1396 , 7 @ @ 
 + int j = MathHelper . floor _ double ( p _ 72833 _ 1 _ . posY ) ; 
 + int k = MathHelper . floor _ double ( p _ 72833 _ 1 _ . posZ ) ; 
 + BlockPos blockpos = new BlockPos ( i , j , k ) ; 
 + - BiomeGenBase biomegenbase = this . getBiomeGenForCoords ( blockpos ) ; 
 + - float f2 = biomegenbase . getFloatTemperature ( blockpos ) ; 
 + - int l = biomegenbase . getSkyColorByTemp ( f2 ) ; 
 + + int l = net . minecraftforge . client . ForgeHooksClient . getSkyBlendColour ( this , blockpos ) ; 
 + float f3 = ( float ) ( l > > 16 & 255 ) / 255 . 0F ; 
 + float f4 = ( float ) ( l > > 8 & 255 ) / 255 . 0F ; 
 + float f5 = ( float ) ( l & 255 ) / 255 . 0F ; 
 + @ @ - 1370 , 6 + 1456 , 11 @ @ 
 + 
 + public float getCurrentMoonPhaseFactor ( ) 
 + { 
 + + return provider . getCurrentMoonPhaseFactor ( ) ; 
 + + } 
 + + 
 + + public float getCurrentMoonPhaseFactorBody ( ) 
 + + { 
 + return WorldProvider . moonPhaseFactors [ this . provider . getMoonPhase ( this . worldInfo . getWorldTime ( ) ) ] ; 
 + } 
 + 
 + @ @ - 1382 , 6 + 1473 , 12 @ @ 
 + @ SideOnly ( Side . CLIENT ) 
 + public Vec3 getCloudColour ( float p _ 72824 _ 1 _ ) 
 + { 
 + + return this . provider . drawClouds ( p _ 72824 _ 1 _ ) ; 
 + + } 
 + + 
 + + @ SideOnly ( Side . CLIENT ) 
 + + public Vec3 drawCloudsBody ( float p _ 72824 _ 1 _ ) 
 + + { 
 + float f = this . getCelestialAngle ( p _ 72824 _ 1 _ ) ; 
 + float f1 = MathHelper . cos ( f * ( float ) Math . PI * 2 . 0F ) * 2 . 0F + 0 . 5F ; 
 + f1 = MathHelper . clamp _ float ( f1 , 0 . 0F , 1 . 0F ) ; 
 + @ @ - 1437 , 9 + 1534 , 9 @ @ 
 + for ( blockpos = new BlockPos ( pos . getX ( ) , chunk . getTopFilledSegment ( ) + 16 , pos . getZ ( ) ) ; blockpos . getY ( ) > = 0 ; blockpos = blockpos1 ) 
 + { 
 + blockpos1 = blockpos . down ( ) ; 
 + - Material material = chunk . getBlock ( blockpos1 ) . getMaterial ( ) ; 
 + + Block block = chunk . getBlock ( blockpos1 ) ; 
 + 
 + - if ( material . blocksMovement ( ) & & material ! = Material . leaves ) 
 + + if ( block . getMaterial ( ) . blocksMovement ( ) & & ! block . isLeaves ( this , blockpos1 ) & & ! block . isFoliage ( this , blockpos1 ) ) 
 + { 
 + break ; 
 + } 
 + @ @ - 1451 , 6 + 1548 , 12 @ @ 
 + @ SideOnly ( Side . CLIENT ) 
 + public float getStarBrightness ( float p _ 72880 _ 1 _ ) 
 + { 
 + + return this . provider . getStarBrightness ( p _ 72880 _ 1 _ ) ; 
 + + } 
 + + 
 + + @ SideOnly ( Side . CLIENT ) 
 + + public float getStarBrightnessBody ( float p _ 72880 _ 1 _ ) 
 + + { 
 + float f = this . getCelestialAngle ( p _ 72880 _ 1 _ ) ; 
 + float f1 = 1 . 0F - ( MathHelper . cos ( f * ( float ) Math . PI * 2 . 0F ) * 2 . 0F + 0 . 25F ) ; 
 + f1 = MathHelper . clamp _ float ( f1 , 0 . 0F , 1 . 0F ) ; 
 + @ @ - 1497 , 7 + 1600 , 15 @ @ 
 + entity . addEntityCrashInfo ( crashreportcategory ) ; 
 + } 
 + 
 + - throw new ReportedException ( crashreport ) ; 
 + + if ( net . minecraftforge . common . ForgeModContainer . removeErroringEntities ) 
 + + { 
 + + net . minecraftforge . fml . common . FMLLog . severe ( crashreport . getCompleteReport ( ) ) ; 
 + + removeEntity ( entity ) ; 
 + + } 
 + + else 
 + + { 
 + + throw new ReportedException ( crashreport ) ; 
 + + } 
 + } 
 + 
 + if ( entity . isDead ) 
 + @ @ - 1557 , 7 + 1668 , 15 @ @ 
 + CrashReport crashreport1 = CrashReport . makeCrashReport ( throwable1 , " Ticking entity " ) ; 
 + CrashReportCategory crashreportcategory2 = crashreport1 . makeCategory ( " Entity being ticked " ) ; 
 + entity2 . addEntityCrashInfo ( crashreportcategory2 ) ; 
 + - throw new ReportedException ( crashreport1 ) ; 
 + + if ( net . minecraftforge . common . ForgeModContainer . removeErroringEntities ) 
 + + { 
 + + net . minecraftforge . fml . common . FMLLog . severe ( crashreport1 . getCompleteReport ( ) ) ; 
 + + removeEntity ( entity2 ) ; 
 + + } 
 + + else 
 + + { 
 + + throw new ReportedException ( crashreport1 ) ; 
 + + } 
 + } 
 + } 
 + 
 + @ @ - 1604 , 7 + 1723 , 16 @ @ 
 + CrashReport crashreport2 = CrashReport . makeCrashReport ( throwable , " Ticking block entity " ) ; 
 + CrashReportCategory crashreportcategory1 = crashreport2 . makeCategory ( " Block entity being ticked " ) ; 
 + tileentity . addInfoToCrashReport ( crashreportcategory1 ) ; 
 + - throw new ReportedException ( crashreport2 ) ; 
 + + if ( net . minecraftforge . common . ForgeModContainer . removeErroringTileEntities ) 
 + + { 
 + + net . minecraftforge . fml . common . FMLLog . severe ( crashreport2 . getCompleteReport ( ) ) ; 
 + + tileentity . invalidate ( ) ; 
 + + this . removeTileEntity ( tileentity . getPos ( ) ) ; 
 + + } 
 + + else 
 + + { 
 + + throw new ReportedException ( crashreport2 ) ; 
 + + } 
 + } 
 + } 
 + } 
 + @ @ - 1621 , 15 + 1749 , 20 @ @ 
 + } 
 + } 
 + 
 + - this . processingLoadedTiles = false ; 
 + - 
 + if ( ! this . tileEntitiesToBeRemoved . isEmpty ( ) ) 
 + { 
 + + for ( Object tile : tileEntitiesToBeRemoved ) 
 + + { 
 + + ( ( TileEntity ) tile ) . onChunkUnload ( ) ; 
 + + } 
 + + 
 + this . tickableTileEntities . removeAll ( this . tileEntitiesToBeRemoved ) ; 
 + this . loadedTileEntityList . removeAll ( this . tileEntitiesToBeRemoved ) ; 
 + this . tileEntitiesToBeRemoved . clear ( ) ; 
 + } 
 + 
 + + this . processingLoadedTiles = false ; / / FML Move below remove to prevent CMEs 
 + + 
 + this . theProfiler . endStartSection ( " pendingBlockEntities " ) ; 
 + 
 + if ( ! this . addedTileEntityList . isEmpty ( ) ) 
 + @ @ - 1663 , 7 + 1796 , 8 @ @ 
 + 
 + public boolean addTileEntity ( TileEntity tile ) 
 + { 
 + - boolean flag = this . loadedTileEntityList . add ( tile ) ; 
 + + List < TileEntity > dest = processingLoadedTiles ? addedTileEntityList : loadedTileEntityList ; 
 + + boolean flag = dest . add ( tile ) ; 
 + 
 + if ( flag & & tile instanceof ITickable ) 
 + { 
 + @ @ - 1702 , 9 + 1836 , 13 @ @ 
 + { 
 + int i = MathHelper . floor _ double ( p _ 72866 _ 1 _ . posX ) ; 
 + int j = MathHelper . floor _ double ( p _ 72866 _ 1 _ . posZ ) ; 
 + - int k = 32 ; 
 + + boolean isForced = getPersistentChunks ( ) . containsKey ( new ChunkCoordIntPair ( i > > 4 , j > > 4 ) ) ; 
 + + int k = isForced ? 0 : 32 ; 
 + + boolean canUpdate = ! p _ 72866 _ 2 _ | | this . isAreaLoaded ( i - k , 0 , j - k , i + k , 0 , j + k , true ) ; 
 + 
 + - if ( ! p _ 72866 _ 2 _ | | this . isAreaLoaded ( i - k , 0 , j - k , i + k , 0 , j + k , true ) ) 
 + + if ( ! canUpdate ) canUpdate = net . minecraftforge . event . ForgeEventFactory . canEntityUpdate ( p _ 72866 _ 1 _ ) ; 
 + + 
 + + if ( canUpdate ) 
 + { 
 + p _ 72866 _ 1 _ . lastTickPosX = p _ 72866 _ 1 _ . posX ; 
 + p _ 72866 _ 1 _ . lastTickPosY = p _ 72866 _ 1 _ . posY ; 
 + @ @ - 1832 , 7 + 1970 , 7 @ @ 
 + { 
 + Block block = this . getBlockState ( blockpos $ mutableblockpos . func _ 181079 _ c ( k1 , l1 , i2 ) ) . getBlock ( ) ; 
 + 
 + - if ( block . getMaterial ( ) ! = Material . air ) 
 + + if ( ! block . isAir ( this , new BlockPos ( k1 , l1 , i2 ) ) ) 
 + { 
 + return true ; 
 + } 
 + @ @ - 1897 , 6 + 2035 , 10 @ @ 
 + { 
 + return true ; 
 + } 
 + + else if ( block . isBurning ( this , new BlockPos ( k1 , l1 , i2 ) ) ) 
 + + { 
 + + return true ; 
 + + } 
 + } 
 + } 
 + } 
 + @ @ - 2037 , 6 + 2179 , 7 @ @ 
 + public Explosion newExplosion ( Entity p _ 72885 _ 1 _ , double p _ 72885 _ 2 _ , double p _ 72885 _ 4 _ , double p _ 72885 _ 6 _ , float p _ 72885 _ 8 _ , boolean p _ 72885 _ 9 _ , boolean p _ 72885 _ 10 _ ) 
 + { 
 + Explosion explosion = new Explosion ( this , p _ 72885 _ 1 _ , p _ 72885 _ 2 _ , p _ 72885 _ 4 _ , p _ 72885 _ 6 _ , p _ 72885 _ 8 _ , p _ 72885 _ 9 _ , p _ 72885 _ 10 _ ) ; 
 + + if ( net . minecraftforge . event . ForgeEventFactory . onExplosionStart ( this , explosion ) ) return explosion ; 
 + explosion . doExplosionA ( ) ; 
 + explosion . doExplosionB ( true ) ; 
 + return explosion ; 
 + @ @ - 2183 , 19 + 2326 , 27 @ @ 
 + else 
 + { 
 + this . addTileEntity ( tileEntityIn ) ; 
 + - this . getChunkFromBlockCoords ( pos ) . addTileEntity ( pos , tileEntityIn ) ; 
 + + Chunk chunk = this . getChunkFromBlockCoords ( pos ) ; / / Forge add NPE protection 
 + + if ( chunk ! = null ) chunk . addTileEntity ( pos , tileEntityIn ) ; 
 + } 
 + + this . updateComparatorOutputLevel ( pos , getBlockState ( pos ) . getBlock ( ) ) ; / / Notify neighbors of changes 
 + } 
 + } 
 + 
 + public void removeTileEntity ( BlockPos pos ) 
 + { 
 + + / / Chunk chunk = this . getChunkFromBlockCoords ( pos ) ; 
 + + / / if ( chunk ! = null ) chunk . removeTileEntity ( pos ) ; 
 + + / / Forge ToDO : Are these patches needed anymore ? 
 + + 
 + TileEntity tileentity = this . getTileEntity ( pos ) ; 
 + 
 + if ( tileentity ! = null & & this . processingLoadedTiles ) 
 + { 
 + tileentity . invalidate ( ) ; 
 + this . addedTileEntityList . remove ( tileentity ) ; 
 + + if ( ! ( tileentity instanceof ITickable ) ) / / Forge : If they are not tickable they wont be removed in the update loop . 
 + + this . loadedTileEntityList . remove ( tileentity ) ; 
 + } 
 + else 
 + { 
 + @ @ - 2208 , 6 + 2359 , 7 @ @ 
 + 
 + this . getChunkFromBlockCoords ( pos ) . removeTileEntity ( pos ) ; 
 + } 
 + + this . updateComparatorOutputLevel ( pos , getBlockState ( pos ) . getBlock ( ) ) ; / / Notify neighbors of changes 
 + } 
 + 
 + public void markTileEntityForRemoval ( TileEntity tileEntityIn ) 
 + @ @ - 2226 , 7 + 2378 , 7 @ @ 
 + { 
 + IBlockState iblockstate = p _ 175683 _ 0 _ . getBlockState ( p _ 175683 _ 1 _ ) ; 
 + Block block = iblockstate . getBlock ( ) ; 
 + - return block . getMaterial ( ) . isOpaque ( ) & & block . isFullCube ( ) ? true : ( block instanceof BlockStairs ? iblockstate . getValue ( BlockStairs . HALF ) = = BlockStairs . EnumHalf . TOP : ( block instanceof BlockSlab ? iblockstate . getValue ( BlockSlab . HALF ) = = BlockSlab . EnumBlockHalf . TOP : ( block instanceof BlockHopper ? true : ( block instanceof BlockSnow ? ( ( Integer ) iblockstate . getValue ( BlockSnow . LAYERS ) ) . intValue ( ) = = 7 : false ) ) ) ) ; 
 + + return block . isSideSolid ( p _ 175683 _ 0 _ , p _ 175683 _ 1 _ , EnumFacing . UP ) ; 
 + } 
 + 
 + public boolean isBlockNormalCube ( BlockPos p _ 175677 _ 1 _ , boolean p _ 175677 _ 2 _ ) 
 + @ @ - 2246 , 7 + 2398 , 7 @ @ 
 + else 
 + { 
 + Block block = this . getBlockState ( p _ 175677 _ 1 _ ) . getBlock ( ) ; 
 + - return block . getMaterial ( ) . isOpaque ( ) & & block . isFullCube ( ) ; 
 + + return block . isNormalCube ( this , p _ 175677 _ 1 _ ) ; 
 + } 
 + } 
 + } 
 + @ @ - 2265 , 6 + 2417 , 7 @ @ 
 + { 
 + this . spawnHostileMobs = hostile ; 
 + this . spawnPeacefulMobs = peaceful ; 
 + + this . provider . setAllowedSpawnTypes ( hostile , peaceful ) ; 
 + } 
 + 
 + public void tick ( ) 
 + @ @ - 2274 , 6 + 2427 , 11 @ @ 
 + 
 + protected void calculateInitialWeather ( ) 
 + { 
 + + this . provider . calculateInitialWeather ( ) ; 
 + + } 
 + + 
 + + public void calculateInitialWeatherBody ( ) 
 + + { 
 + if ( this . worldInfo . isRaining ( ) ) 
 + { 
 + this . rainingStrength = 1 . 0F ; 
 + @ @ - 2287 , 6 + 2445 , 11 @ @ 
 + 
 + protected void updateWeather ( ) 
 + { 
 + + this . provider . updateWeather ( ) ; 
 + + } 
 + + 
 + + public void updateWeatherBody ( ) 
 + + { 
 + if ( ! this . provider . getHasNoSky ( ) ) 
 + { 
 + if ( ! this . isRemote ) 
 + @ @ - 2381 , 6 + 2544 , 7 @ @ 
 + { 
 + this . activeChunkSet . clear ( ) ; 
 + this . theProfiler . startSection ( " buildList " ) ; 
 + + this . activeChunkSet . addAll ( getPersistentChunks ( ) . keySet ( ) ) ; 
 + 
 + for ( int i = 0 ; i < this . playerEntities . size ( ) ; + + i ) 
 + { 
 + @ @ - 2438 , 7 + 2602 , 7 @ @ 
 + j = j + p _ 147467 _ 1 _ ; 
 + k = k + p _ 147467 _ 2 _ ; 
 + 
 + - if ( block . getMaterial ( ) = = Material . air & & this . getLight ( blockpos ) < = this . rand . nextInt ( 8 ) & & this . getLightFor ( EnumSkyBlock . SKY , blockpos ) < = 0 ) 
 + + if ( block . isAir ( this , blockpos ) & & this . getLight ( blockpos ) < = this . rand . nextInt ( 8 ) & & this . getLightFor ( EnumSkyBlock . SKY , blockpos ) < = 0 ) 
 + { 
 + EntityPlayer entityplayer = this . getClosestPlayer ( ( double ) j + 0 . 5D , ( double ) l + 0 . 5D , ( double ) k + 0 . 5D , 8 . 0D ) ; 
 + 
 + @ @ - 2478 , 6 + 2642 , 11 @ @ 
 + 
 + public boolean canBlockFreeze ( BlockPos pos , boolean noWaterAdj ) 
 + { 
 + + return this . provider . canBlockFreeze ( pos , noWaterAdj ) ; 
 + + } 
 + + 
 + + public boolean canBlockFreezeBody ( BlockPos pos , boolean noWaterAdj ) 
 + + { 
 + BiomeGenBase biomegenbase = this . getBiomeGenForCoords ( pos ) ; 
 + float f = biomegenbase . getFloatTemperature ( pos ) ; 
 + 
 + @ @ - 2519 , 6 + 2688 , 11 @ @ 
 + 
 + public boolean canSnowAt ( BlockPos pos , boolean checkLight ) 
 + { 
 + + return this . provider . canSnowAt ( pos , checkLight ) ; 
 + + } 
 + + 
 + + public boolean canSnowAtBody ( BlockPos pos , boolean checkLight ) 
 + + { 
 + BiomeGenBase biomegenbase = this . getBiomeGenForCoords ( pos ) ; 
 + float f = biomegenbase . getFloatTemperature ( pos ) ; 
 + 
 + @ @ - 2536 , 7 + 2710 , 7 @ @ 
 + { 
 + Block block = this . getBlockState ( pos ) . getBlock ( ) ; 
 + 
 + - if ( block . getMaterial ( ) = = Material . air & & Blocks . snow _ layer . canPlaceBlockAt ( this , pos ) ) 
 + + if ( block . isAir ( this , pos ) & & Blocks . snow _ layer . canPlaceBlockAt ( this , pos ) ) 
 + { 
 + return true ; 
 + } 
 + @ @ - 2568 , 10 + 2742 , 11 @ @ 
 + else 
 + { 
 + Block block = this . getBlockState ( pos ) . getBlock ( ) ; 
 + - int i = lightType = = EnumSkyBlock . SKY ? 0 : block . getLightValue ( ) ; 
 + - int j = block . getLightOpacity ( ) ; 
 + + int blockLight = block . getLightValue ( this , pos ) ; 
 + + int i = lightType = = EnumSkyBlock . SKY ? 0 : blockLight ; 
 + + int j = block . getLightOpacity ( this , pos ) ; 
 + 
 + - if ( j > = 15 & & block . getLightValue ( ) > 0 ) 
 + + if ( j > = 15 & & blockLight > 0 ) 
 + { 
 + j = 1 ; 
 + } 
 + @ @ - 2771 , 10 + 2946 , 10 @ @ 
 + public List < Entity > func _ 175674 _ a ( Entity entityIn , AxisAlignedBB p _ 175674 _ 2 _ , Predicate < ? super Entity > p _ 175674 _ 3 _ ) 
 + { 
 + List < Entity > list = Lists . < Entity > newArrayList ( ) ; 
 + - int i = MathHelper . floor _ double ( ( p _ 175674 _ 2 _ . minX - 2 . 0D ) / 16 . 0D ) ; 
 + - int j = MathHelper . floor _ double ( ( p _ 175674 _ 2 _ . maxX + 2 . 0D ) / 16 . 0D ) ; 
 + - int k = MathHelper . floor _ double ( ( p _ 175674 _ 2 _ . minZ - 2 . 0D ) / 16 . 0D ) ; 
 + - int l = MathHelper . floor _ double ( ( p _ 175674 _ 2 _ . maxZ + 2 . 0D ) / 16 . 0D ) ; 
 + + int i = MathHelper . floor _ double ( ( p _ 175674 _ 2 _ . minX - MAX _ ENTITY _ RADIUS ) / 16 . 0D ) ; 
 + + int j = MathHelper . floor _ double ( ( p _ 175674 _ 2 _ . maxX + MAX _ ENTITY _ RADIUS ) / 16 . 0D ) ; 
 + + int k = MathHelper . floor _ double ( ( p _ 175674 _ 2 _ . minZ - MAX _ ENTITY _ RADIUS ) / 16 . 0D ) ; 
 + + int l = MathHelper . floor _ double ( ( p _ 175674 _ 2 _ . maxZ + MAX _ ENTITY _ RADIUS ) / 16 . 0D ) ; 
 + 
 + for ( int i1 = i ; i1 < = j ; + + i1 ) 
 + { 
 + @ @ - 2827 , 10 + 3002 , 10 @ @ 
 + 
 + public < T extends Entity > List < T > getEntitiesWithinAABB ( Class < ? extends T > clazz , AxisAlignedBB aabb , Predicate < ? super T > filter ) 
 + { 
 + - int i = MathHelper . floor _ double ( ( aabb . minX - 2 . 0D ) / 16 . 0D ) ; 
 + - int j = MathHelper . floor _ double ( ( aabb . maxX + 2 . 0D ) / 16 . 0D ) ; 
 + - int k = MathHelper . floor _ double ( ( aabb . minZ - 2 . 0D ) / 16 . 0D ) ; 
 + - int l = MathHelper . floor _ double ( ( aabb . maxZ + 2 . 0D ) / 16 . 0D ) ; 
 + + int i = MathHelper . floor _ double ( ( aabb . minX - MAX _ ENTITY _ RADIUS ) / 16 . 0D ) ; 
 + + int j = MathHelper . floor _ double ( ( aabb . maxX + MAX _ ENTITY _ RADIUS ) / 16 . 0D ) ; 
 + + int k = MathHelper . floor _ double ( ( aabb . minZ - MAX _ ENTITY _ RADIUS ) / 16 . 0D ) ; 
 + + int l = MathHelper . floor _ double ( ( aabb . maxZ + MAX _ ENTITY _ RADIUS ) / 16 . 0D ) ; 
 + List < T > list = Lists . < T > newArrayList ( ) ; 
 + 
 + for ( int i1 = i ; i1 < = j ; + + i1 ) 
 + @ @ - 2908 , 11 + 3083 , 13 @ @ 
 + 
 + public void loadEntities ( Collection < Entity > entityCollection ) 
 + { 
 + - this . loadedEntityList . addAll ( entityCollection ) ; 
 + - 
 + for ( Entity entity : entityCollection ) 
 + { 
 + - this . onEntityAdded ( entity ) ; 
 + + if ( ! net . minecraftforge . common . MinecraftForge . EVENT _ BUS . post ( new net . minecraftforge . event . entity . EntityJoinWorldEvent ( entity , this ) ) ) 
 + + { 
 + + loadedEntityList . add ( entity ) ; 
 + + this . onEntityAdded ( entity ) ; 
 + + } 
 + } 
 + } 
 + 
 + @ @ - 2925 , 7 + 3102 , 9 @ @ 
 + { 
 + Block block = this . getBlockState ( p _ 175716 _ 2 _ ) . getBlock ( ) ; 
 + AxisAlignedBB axisalignedbb = p _ 175716 _ 3 _ ? null : p _ 175716 _ 1 _ . getCollisionBoundingBox ( this , p _ 175716 _ 2 _ , p _ 175716 _ 1 _ . getDefaultState ( ) ) ; 
 + - return axisalignedbb ! = null & & ! this . checkNoEntityCollision ( axisalignedbb , p _ 175716 _ 5 _ ) ? false : ( block . getMaterial ( ) = = Material . circuits & & p _ 175716 _ 1 _ = = Blocks . anvil ? true : block . getMaterial ( ) . isReplaceable ( ) & & p _ 175716 _ 1 _ . canReplace ( this , p _ 175716 _ 2 _ , p _ 175716 _ 4 _ , p _ 175716 _ 6 _ ) ) ; 
 + + if ( axisalignedbb ! = null & & ! this . checkNoEntityCollision ( axisalignedbb , p _ 175716 _ 5 _ ) ) return false ; 
 + + if ( block . getMaterial ( ) = = Material . circuits & & p _ 175716 _ 1 _ = = Blocks . anvil ) return true ; 
 + + return block . isReplaceable ( this , p _ 175716 _ 2 _ ) & & p _ 175716 _ 1 _ . canReplace ( this , p _ 175716 _ 2 _ , p _ 175716 _ 4 _ , p _ 175716 _ 6 _ ) ; 
 + } 
 + 
 + public int func _ 181545 _ F ( ) 
 + @ @ - 3010 , 7 + 3189 , 7 @ @ 
 + { 
 + IBlockState iblockstate = this . getBlockState ( pos ) ; 
 + Block block = iblockstate . getBlock ( ) ; 
 + - return block . isNormalCube ( ) ? this . getStrongPower ( pos ) : block . isProvidingWeakPower ( this , pos , iblockstate , facing ) ; 
 + + return block . shouldCheckWeakPower ( this , pos , facing ) ? this . getStrongPower ( pos ) : block . isProvidingWeakPower ( this , pos , iblockstate , facing ) ; 
 + } 
 + 
 + public boolean isBlockPowered ( BlockPos pos ) 
 + @ @ - 3137 , 7 + 3316 , 7 @ @ 
 + 
 + public long getSeed ( ) 
 + { 
 + - return this . worldInfo . getSeed ( ) ; 
 + + return this . provider . getSeed ( ) ; 
 + } 
 + 
 + public long getTotalWorldTime ( ) 
 + @ @ - 3147 , 17 + 3326 , 17 @ @ 
 + 
 + public long getWorldTime ( ) 
 + { 
 + - return this . worldInfo . getWorldTime ( ) ; 
 + + return this . provider . getWorldTime ( ) ; 
 + } 
 + 
 + public void setWorldTime ( long time ) 
 + { 
 + - this . worldInfo . setWorldTime ( time ) ; 
 + + this . provider . setWorldTime ( time ) ; 
 + } 
 + 
 + public BlockPos getSpawnPoint ( ) 
 + { 
 + - BlockPos blockpos = new BlockPos ( this . worldInfo . getSpawnX ( ) , this . worldInfo . getSpawnY ( ) , this . worldInfo . getSpawnZ ( ) ) ; 
 + + BlockPos blockpos = this . provider . getSpawnPoint ( ) ; 
 + 
 + if ( ! this . getWorldBorder ( ) . contains ( blockpos ) ) 
 + { 
 + @ @ - 3169 , 7 + 3348 , 7 @ @ 
 + 
 + public void setSpawnPoint ( BlockPos pos ) 
 + { 
 + - this . worldInfo . setSpawn ( pos ) ; 
 + + this . provider . setSpawnPoint ( pos ) ; 
 + } 
 + 
 + @ SideOnly ( Side . CLIENT ) 
 + @ @ - 3189 , 12 + 3368 , 18 @ @ 
 + 
 + if ( ! this . loadedEntityList . contains ( entityIn ) ) 
 + { 
 + + if ( ! net . minecraftforge . common . MinecraftForge . EVENT _ BUS . post ( new net . minecraftforge . event . entity . EntityJoinWorldEvent ( entityIn , this ) ) ) 
 + this . loadedEntityList . add ( entityIn ) ; 
 + } 
 + } 
 + 
 + public boolean isBlockModifiable ( EntityPlayer player , BlockPos pos ) 
 + { 
 + + return this . provider . canMineBlock ( player , pos ) ; 
 + + } 
 + + 
 + + public boolean canMineBlockBody ( EntityPlayer player , BlockPos pos ) 
 + + { 
 + return true ; 
 + } 
 + 
 + @ @ - 3288 , 8 + 3473 , 7 @ @ 
 + 
 + public boolean isBlockinHighHumidity ( BlockPos pos ) 
 + { 
 + - BiomeGenBase biomegenbase = this . getBiomeGenForCoords ( pos ) ; 
 + - return biomegenbase . isHighHumidity ( ) ; 
 + + return this . provider . isBlockHighHumidity ( pos ) ; 
 + } 
 + 
 + public MapStorage getMapStorage ( ) 
 + @ @ - 3348 , 12 + 3532 , 12 @ @ 
 + 
 + public int getHeight ( ) 
 + { 
 + - return 256 ; 
 + + return this . provider . getHeight ( ) ; 
 + } 
 + 
 + public int getActualHeight ( ) 
 + { 
 + - return this . provider . getHasNoSky ( ) ? 128 : 256 ; 
 + + return this . provider . getActualHeight ( ) ; 
 + } 
 + 
 + public Random setRandomSeed ( int p _ 72843 _ 1 _ , int p _ 72843 _ 2 _ , int p _ 72843 _ 3 _ ) 
 + @ @ - 3410 , 7 + 3594 , 7 @ @ 
 + @ SideOnly ( Side . CLIENT ) 
 + public double getHorizon ( ) 
 + { 
 + - return this . worldInfo . getTerrainType ( ) = = WorldType . FLAT ? 0 . 0D : 63 . 0D ; 
 + + return provider . getHorizon ( ) ; 
 + } 
 + 
 + public void sendBlockBreakProgress ( int breakerId , BlockPos pos , int progress ) 
 + @ @ - 3452 , 18 + 3636 , 14 @ @ 
 + { 
 + IBlockState iblockstate = this . getBlockState ( blockpos ) ; 
 + 
 + - if ( Blocks . unpowered _ comparator . isAssociated ( iblockstate . getBlock ( ) ) ) 
 + + iblockstate . getBlock ( ) . onNeighborChange ( this , blockpos , pos ) ; 
 + + if ( iblockstate . getBlock ( ) . isNormalCube ( this , blockpos ) ) 
 + { 
 + - iblockstate . getBlock ( ) . onNeighborBlockChange ( this , blockpos , iblockstate , blockIn ) ; 
 + - } 
 + - else if ( iblockstate . getBlock ( ) . isNormalCube ( ) ) 
 + - { 
 + - blockpos = blockpos . offset ( enumfacing ) ; 
 + - iblockstate = this . getBlockState ( blockpos ) ; 
 + - 
 + - if ( Blocks . unpowered _ comparator . isAssociated ( iblockstate . getBlock ( ) ) ) 
 + + BlockPos posOther = blockpos . offset ( enumfacing ) ; 
 + + Block other = getBlockState ( posOther ) . getBlock ( ) ; 
 + + if ( other . getWeakChanges ( this , posOther ) ) 
 + { 
 + - iblockstate . getBlock ( ) . onNeighborBlockChange ( this , blockpos , iblockstate , blockIn ) ; 
 + + other . onNeighborChange ( this , posOther , pos ) ; 
 + } 
 + } 
 + } 
 + @ @ - 3533 , 4 + 3713 , 81 @ @ 
 + int k = 128 ; 
 + return i > = - k & & i < = k & & j > = - k & & j < = k ; 
 + } 
 + + 
 + + / * = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = FORGE START = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = * / 
 + + / * * 
 + + * Determine if the given block is considered solid on the 
 + + * specified side . Used by placement logic . 
 + + * 
 + + * @ param pos Block Position 
 + + * @ param side The Side in question 
 + + * @ return True if the side is solid 
 + + * / 
 + + public boolean isSideSolid ( BlockPos pos , EnumFacing side ) 
 + + { 
 + + return isSideSolid ( pos , side , false ) ; 
 + + } 
 + + 
 + + / * * 
 + + * Determine if the given block is considered solid on the 
 + + * specified side . Used by placement logic . 
 + + * 
 + + * @ param pos Block Position 
 + + * @ param side The Side in question 
 + + * @ param _ default The default to return if the block doesn ' t exist . 
 + + * @ return True if the side is solid 
 + + * / 
 + + @ Override 
 + + public boolean isSideSolid ( BlockPos pos , EnumFacing side , boolean _ default ) 
 + + { 
 + + if ( ! this . isValid ( pos ) ) return _ default ; 
 + + 
 + + Chunk chunk = getChunkFromBlockCoords ( pos ) ; 
 + + if ( chunk = = null | | chunk . isEmpty ( ) ) return _ default ; 
 + + return getBlockState ( pos ) . getBlock ( ) . isSideSolid ( this , pos , side ) ; 
 + + } 
 + + 
 + + / * * 
 + + * Get the persistent chunks for this world 
 + + * 
 + + * @ return 
 + + * / 
 + + public com . google . common . collect . ImmutableSetMultimap < ChunkCoordIntPair , net . minecraftforge . common . ForgeChunkManager . Ticket > getPersistentChunks ( ) 
 + + { 
 + + return net . minecraftforge . common . ForgeChunkManager . getPersistentChunksFor ( this ) ; 
 + + } 
 + + 
 + + / * * 
 + + * Readded as it was removed , very useful helper function 
 + + * 
 + + * @ param pos Block position 
 + + * @ return The blocks light opacity 
 + + * / 
 + + public int getBlockLightOpacity ( BlockPos pos ) 
 + + { 
 + + if ( ! this . isValid ( pos ) ) return 0 ; 
 + + return getChunkFromBlockCoords ( pos ) . getBlockLightOpacity ( pos ) ; 
 + + } 
 + + 
 + + / * * 
 + + * Returns a count of entities that classify themselves as the specified creature type . 
 + + * / 
 + + public int countEntities ( net . minecraft . entity . EnumCreatureType type , boolean forSpawnCount ) 
 + + { 
 + + int count = 0 ; 
 + + for ( int x = 0 ; x < loadedEntityList . size ( ) ; x + + ) 
 + + { 
 + + if ( ( ( Entity ) loadedEntityList . get ( x ) ) . isCreatureType ( type , forSpawnCount ) ) 
 + + { 
 + + count + + ; 
 + + } 
 + + } 
 + + return count ; 
 + + } 
 + + 
 + + protected MapStorage perWorldStorage ; / / Moved to a getter to simulate final without being final so we can load in subclasses . 
 + + public MapStorage getPerWorldStorage ( ) 
 + + { 
 + + return perWorldStorage ; 
 + + } 
 + } 
 diff - - git a / rejects / minecraft / net / minecraft / server / integrated / IntegratedServer . java . patch . rej b / rejects / minecraft / net / minecraft / server / integrated / IntegratedServer . java . patch . rej 
 index 6fffb6b . . fe21c35 100644 
 - - - a / rejects / minecraft / net / minecraft / server / integrated / IntegratedServer . java . patch . rej 
 + + + b / rejects / minecraft / net / minecraft / server / integrated / IntegratedServer . java . patch . rej 
 @ @ - 1 , 61 + 1 , 4 @ @ 
 - + + + + REJECTED PATCH 2 
 - { 
 - worldinfo . setWorldName ( p _ 71247 _ 2 _ ) ; 
 - } 
 - + WorldServer overWorld = ( isDemo ( ) ? ( WorldServer ) ( new DemoWorldServer ( this , isavehandler , worldinfo , 0 , this . theProfiler ) ) . init ( ) : 
 - + ( WorldServer ) ( new WorldServer ( this , isavehandler , worldinfo , 0 , this . theProfiler ) ) . init ( ) ) ; 
 - + overWorld . initialize ( this . theWorldSettings ) ; 
 - 
 - - for ( int j = 0 ; j < this . worldServers . length ; + + j ) 
 - + for ( int dim : net . minecraftforge . common . DimensionManager . getStaticDimensionIDs ( ) ) 
 - { 
 - - byte b0 = 0 ; 
 - 
 - - if ( j = = 1 ) 
 - + WorldServer world = ( dim = = 0 ? overWorld : ( WorldServer ) ( new WorldServerMulti ( this , isavehandler , dim , overWorld , this . theProfiler ) ) . init ( ) ) ; 
 - + world . addWorldAccess ( new WorldManager ( this , world ) ) ; 
 - + if ( ! this . isSinglePlayer ( ) ) 
 - { 
 - - b0 = - 1 ; 
 - + world . getWorldInfo ( ) . setGameType ( getGameType ( ) ) ; 
 - } 
 - - 
 - - if ( j = = 2 ) 
 - - { 
 - - b0 = 1 ; 
 - - } 
 - - 
 - - if ( j = = 0 ) 
 - - { 
 - - if ( this . isDemo ( ) ) 
 - - { 
 - - this . worldServers [ j ] = ( WorldServer ) ( new DemoWorldServer ( this , isavehandler , worldinfo , b0 , this . theProfiler ) ) . init ( ) ; 
 - - } 
 - - else 
 - - { 
 - - this . worldServers [ j ] = ( WorldServer ) ( new WorldServer ( this , isavehandler , worldinfo , b0 , this . theProfiler ) ) . init ( ) ; 
 - - } 
 - - 
 - - this . worldServers [ j ] . initialize ( this . theWorldSettings ) ; 
 - - } 
 - - else 
 - - { 
 - - this . worldServers [ j ] = ( WorldServer ) ( new WorldServerMulti ( this , isavehandler , b0 , this . worldServers [ 0 ] , this . theProfiler ) ) . init ( ) ; 
 - - } 
 - - 
 - - this . worldServers [ j ] . addWorldAccess ( new WorldManager ( this , this . worldServers [ j ] ) ) ; 
 - + net . minecraftforge . common . MinecraftForge . EVENT _ BUS . post ( new net . minecraftforge . event . world . WorldEvent . Load ( world ) ) ; 
 - } 
 - 
 - - this . getConfigurationManager ( ) . setPlayerManager ( this . worldServers ) ; 
 - + this . getConfigurationManager ( ) . setPlayerManager ( new WorldServer [ ] { overWorld } ) ; 
 - 
 - - if ( this . worldServers [ 0 ] . getWorldInfo ( ) . getDifficulty ( ) = = null ) 
 - + if ( overWorld . getWorldInfo ( ) . getDifficulty ( ) = = null ) 
 - { 
 - this . setDifficultyForAllWorlds ( this . mc . gameSettings . difficulty ) ; 
 - } 
 - + + + + END PATCH 
 + / / This in now a method in Util , which does almost the same , do we need this still ? 
 + + + + REJECTED PATCH 4 
 { 
 try 
 diff - - git a / rejects / minecraft / net / minecraft / util / EnumChatFormatting . java . patch . rej b / rejects / minecraft / net / minecraft / util / EnumChatFormatting . java . patch . rej 
 deleted file mode 100644 
 index 3a23340 . . 0000000 
 - - - a / rejects / minecraft / net / minecraft / util / EnumChatFormatting . java . patch . rej 
 + + + / dev / null 
 @ @ - 1 , 9 + 0 , 0 @ @ 
 - + + + + REJECTED PATCH 1 
 - return this . controlString ; 
 - } 
 - 
 - - @ SideOnly ( Side . CLIENT ) 
 - public static String getTextWithoutFormattingCodes ( String text ) 
 - { 
 - return text = = null ? null : formattingCodePattern . matcher ( text ) . replaceAll ( " " ) ; 
 - + + + + END PATCH 
 diff - - git a / rejects / minecraft / net / minecraft / util / EnumFacing . java . patch . rej b / rejects / minecraft / net / minecraft / util / EnumFacing . java . patch . rej 
 deleted file mode 100644 
 index 81b2d78 . . 0000000 
 - - - a / rejects / minecraft / net / minecraft / util / EnumFacing . java . patch . rej 
 + + + / dev / null 
 @ @ - 1 , 10 + 0 , 0 @ @ 
 - + + + + REJECTED PATCH 9 
 - } 
 - } 
 - 
 - - public static enum Plane implements Predicate , Iterable { 
 - + public static enum Plane implements Predicate , Iterable < EnumFacing > { / / Forge re - add generic because it just makes life easier . 
 - HORIZONTAL , 
 - VERTICAL ; 
 - 
 - + + + + END PATCH

NEAREST DIFF:
diff - - git a / patches / minecraft / net / minecraft / client / entity / EntityOtherPlayerMP . java . patch b / patches / minecraft / net / minecraft / client / entity / EntityOtherPlayerMP . java . patch 
 new file mode 100644 
 index 0000000 . . d7119a1 
 - - - / dev / null 
 + + + b / patches / minecraft / net / minecraft / client / entity / EntityOtherPlayerMP . java . patch 
 @ @ - 0 , 0 + 1 , 61 @ @ 
 + - - - . . / src _ base / minecraft / net / minecraft / client / entity / EntityOtherPlayerMP . java 
 + + + + . . / src _ work / minecraft / net / minecraft / client / entity / EntityOtherPlayerMP . java 
 + @ @ - 170 , 29 + 170 , 36 @ @ 
 + } 
 + } 
 + 
 + - public float getEyeHeight ( ) 
 + + public void sendChatToPlayer ( ChatMessageComponent par1ChatMessageComponent ) 
 + + { 
 + + Minecraft . getMinecraft ( ) . ingameGUI . getChatGUI ( ) . printChatMessage ( par1ChatMessageComponent . toStringWithFormatting ( true ) ) ; 
 + + } 
 + + 
 + + / * * 
 + + * Returns true if the command sender is allowed to use the given command . 
 + + * / 
 + + public boolean canCommandSenderUseCommand ( int par1 , String par2Str ) 
 + + { 
 + + return false ; 
 + + } 
 + + 
 + + / * * 
 + + * Return the position for this command sender . 
 + + * / 
 + + public ChunkCoordinates getPlayerCoordinates ( ) 
 + + { 
 + + return new ChunkCoordinates ( MathHelper . floor _ double ( this . posX + 0 . 5D ) , MathHelper . floor _ double ( this . posY + 0 . 5D ) , MathHelper . floor _ double ( this . posZ + 0 . 5D ) ) ; 
 + + } 
 + + 
 + + / * = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = FORGE START = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = * / 
 + + 
 + + / * * 
 + + * Returns the default eye height of the player 
 + + * @ return player default eye height 
 + + * / 
 + + @ Override 
 + + public float getDefaultEyeHeight ( ) 
 + { 
 + return 1 . 82F ; 
 + } 
 + - 
 + - public void sendChatToPlayer ( ChatMessageComponent par1ChatMessageComponent ) 
 + - { 
 + - Minecraft . getMinecraft ( ) . ingameGUI . getChatGUI ( ) . printChatMessage ( par1ChatMessageComponent . toStringWithFormatting ( true ) ) ; 
 + - } 
 + - 
 + - / * * 
 + - * Returns true if the command sender is allowed to use the given command . 
 + - * / 
 + - public boolean canCommandSenderUseCommand ( int par1 , String par2Str ) 
 + - { 
 + - return false ; 
 + - } 
 + - 
 + - / * * 
 + - * Return the position for this command sender . 
 + - * / 
 + - public ChunkCoordinates getPlayerCoordinates ( ) 
 + - { 
 + - return new ChunkCoordinates ( MathHelper . floor _ double ( this . posX + 0 . 5D ) , MathHelper . floor _ double ( this . posY + 0 . 5D ) , MathHelper . floor _ double ( this . posZ + 0 . 5D ) ) ; 
 + - } 
 + } 
 diff - - git a / patches / minecraft / net / minecraft / client / entity / EntityPlayerSP . java . patch b / patches / minecraft / net / minecraft / client / entity / EntityPlayerSP . java . patch 
 index eb71fca . . e401b0d 100644 
 - - - a / patches / minecraft / net / minecraft / client / entity / EntityPlayerSP . java . patch 
 + + + b / patches / minecraft / net / minecraft / client / entity / EntityPlayerSP . java . patch 
 @ @ - 9 , 7 + 9 , 77 @ @ 
 
 @ SideOnly ( Side . CLIENT ) 
 public class EntityPlayerSP extends AbstractClientPlayer 
 - @ @ - 685 , 6 + 687 , 12 @ @ 
 + @ @ - 570 , 18 + 572 , 63 @ @ 
 + * / 
 + protected boolean pushOutOfBlocks ( double par1 , double par3 , double par5 ) 
 + { 
 + + if ( this . noClip ) { return false ; } 
 + int i = MathHelper . floor _ double ( par1 ) ; 
 + int j = MathHelper . floor _ double ( par3 ) ; 
 + int k = MathHelper . floor _ double ( par5 ) ; 
 + double d3 = par1 - ( double ) i ; 
 + double d4 = par5 - ( double ) k ; 
 + 
 + - if ( this . isBlockTranslucent ( i , j , k ) | | this . isBlockTranslucent ( i , j + 1 , k ) ) 
 + - { 
 + - boolean flag = ! this . isBlockTranslucent ( i - 1 , j , k ) & & ! this . isBlockTranslucent ( i - 1 , j + 1 , k ) ; 
 + - boolean flag1 = ! this . isBlockTranslucent ( i + 1 , j , k ) & & ! this . isBlockTranslucent ( i + 1 , j + 1 , k ) ; 
 + - boolean flag2 = ! this . isBlockTranslucent ( i , j , k - 1 ) & & ! this . isBlockTranslucent ( i , j + 1 , k - 1 ) ; 
 + - boolean flag3 = ! this . isBlockTranslucent ( i , j , k + 1 ) & & ! this . isBlockTranslucent ( i , j + 1 , k + 1 ) ; 
 + + int entHeight = Math . max ( Math . round ( this . height ) , 1 ) ; 
 + + 
 + + boolean inTranslucentBlock = true ; 
 + + 
 + + for ( int i1 = 0 ; i1 < entHeight ; i1 + + ) 
 + + { 
 + + if ( ! this . isBlockTranslucent ( i , j + i1 , k ) ) 
 + + { 
 + + inTranslucentBlock = false ; 
 + + } 
 + + } 
 + + 
 + + if ( inTranslucentBlock ) 
 + + { 
 + + boolean flag = true ; 
 + + boolean flag1 = true ; 
 + + boolean flag2 = true ; 
 + + boolean flag3 = true ; 
 + + for ( int i1 = 0 ; i1 < entHeight ; i1 + + ) 
 + + { 
 + + if ( this . isBlockTranslucent ( i - 1 , j + i1 , k ) ) 
 + + { 
 + + 	 flag = false ; 
 + + 	 break ; 
 + + } 
 + + } 
 + + for ( int i1 = 0 ; i1 < entHeight ; i1 + + ) 
 + + { 
 + + if ( this . isBlockTranslucent ( i + 1 , j + i1 , k ) ) 
 + + { 
 + + 	 flag1 = false ; 
 + + 	 break ; 
 + + } 
 + + } 
 + + for ( int i1 = 0 ; i1 < entHeight ; i1 + + ) 
 + + { 
 + + if ( this . isBlockTranslucent ( i , j + i1 , k - 1 ) ) 
 + + { 
 + + 	 flag2 = false ; 
 + + 	 break ; 
 + + } 
 + + } 
 + + for ( int i1 = 0 ; i1 < entHeight ; i1 + + ) 
 + + { 
 + + if ( this . isBlockTranslucent ( i , j + i1 , k + 1 ) ) 
 + + { 
 + + 	 flag3 = false ; 
 + + 	 break ; 
 + + } 
 + + } 
 + byte b0 = - 1 ; 
 + double d5 = 9999 . 0D ; 
 + 
 + @ @ - 685 , 6 + 732 , 12 @ @ 
 
 public void playSound ( String par1Str , float par2 , float par3 ) 
 { 
 diff - - git a / patches / minecraft / net / minecraft / entity / player / EntityPlayer . java . patch b / patches / minecraft / net / minecraft / entity / player / EntityPlayer . java . patch 
 index 3247597 . . da35bc4 100644 
 - - - a / patches / minecraft / net / minecraft / entity / player / EntityPlayer . java . patch 
 + + + b / patches / minecraft / net / minecraft / entity / player / EntityPlayer . java . patch 
 @ @ - 48 , 7 + 48 , 15 @ @ 
 
 / * * Holds the coordinate of the player when enter a minecraft to ride . * / 
 private ChunkCoordinates startMinecartRidingCoordinate ; 
 - @ @ - 267 , 6 + 285 , 7 @ @ 
 + @ @ - 175 , 6 + 193 , 7 @ @ 
 + this . setLocationAndAngles ( ( double ) chunkcoordinates . posX + 0 . 5D , ( double ) ( chunkcoordinates . posY + 1 ) , ( double ) chunkcoordinates . posZ + 0 . 5D , 0 . 0F , 0 . 0F ) ; 
 + this . field _ 70741 _ aB = 180 . 0F ; 
 + this . fireResistance = 20 ; 
 + + this . eyeHeight = this . getDefaultEyeHeight ( ) ; 
 + } 
 + 
 + protected void applyEntityAttributes ( ) 
 + @ @ - 267 , 6 + 286 , 7 @ @ 
 
 if ( itemstack = = this . itemInUse ) 
 { 
 @ @ - 56 , 7 + 64 , 7 @ @ 
 if ( this . itemInUseCount < = 25 & & this . itemInUseCount % 4 = = 0 ) 
 { 
 this . updateItemUse ( itemstack , 5 ) ; 
 - @ @ - 429 , 7 + 448 , 7 @ @ 
 + @ @ - 429 , 7 + 449 , 7 @ @ 
 vec31 . rotateAroundX ( - this . rotationPitch * ( float ) Math . PI / 180 . 0F ) ; 
 vec31 . rotateAroundY ( - this . rotationYaw * ( float ) Math . PI / 180 . 0F ) ; 
 vec31 = vec31 . addVector ( this . posX , this . posY + ( double ) this . getEyeHeight ( ) , this . posZ ) ; 
 @ @ - 65 , 7 + 73 , 7 @ @ 
 } 
 
 this . playSound ( " random . eat " , 0 . 5F + 0 . 5F * ( float ) this . rand . nextInt ( 2 ) , ( this . rand . nextFloat ( ) - this . rand . nextFloat ( ) ) * 0 . 2F + 1 . 0F ) ; 
 - @ @ - 537 , 11 + 556 , 11 @ @ 
 + @ @ - 537 , 11 + 557 , 11 @ @ 
 this . cameraYaw = 0 . 0F ; 
 this . addMountedMovementStat ( this . posX - d0 , this . posY - d1 , this . posZ - d2 ) ; 
 
 @ @ - 79 , 7 + 87 , 7 @ @ 
 } 
 } 
 } 
 - @ @ - 684 , 11 + 703 , 15 @ @ 
 + @ @ - 684 , 11 + 704 , 15 @ @ 
 * / 
 public void onDeath ( DamageSource par1DamageSource ) 
 { 
 @ @ - 95 , 7 + 103 , 7 @ @ 
 if ( this . username . equals ( " Notch " ) ) 
 { 
 this . dropPlayerItemWithRandomChoice ( new ItemStack ( Item . appleRed , 1 ) , true ) ; 
 - @ @ - 697 , 6 + 720 , 20 @ @ 
 + @ @ - 697 , 6 + 721 , 20 @ @ 
 if ( ! this . worldObj . getGameRules ( ) . getGameRuleBooleanValue ( " keepInventory " ) ) 
 { 
 this . inventory . dropAllItems ( ) ; 
 @ @ - 116 , 7 + 124 , 7 @ @ 
 } 
 
 if ( par1DamageSource ! = null ) 
 - @ @ - 747 , 7 + 784 , 20 @ @ 
 + @ @ - 747 , 7 + 785 , 20 @ @ 
 * / 
 public EntityItem dropOneItem ( boolean par1 ) 
 { 
 @ @ - 138 , 7 + 146 , 7 @ @ 
 } 
 
 / * * 
 - @ @ - 756 , 7 + 806 , 7 @ @ 
 + @ @ - 756 , 7 + 807 , 7 @ @ 
 * / 
 public EntityItem dropPlayerItem ( ItemStack par1ItemStack ) 
 { 
 @ @ - 147 , 7 + 155 , 7 @ @ 
 } 
 
 / * * 
 - @ @ - 812 , 15 + 862 , 28 @ @ 
 + @ @ - 812 , 15 + 863 , 28 @ @ 
 * / 
 public void joinEntityItemWithWorld ( EntityItem par1EntityItem ) 
 { 
 @ @ - 178 , 7 + 186 , 7 @ @ 
 
 if ( f > 1 . 0F ) 
 { 
 - @ @ - 831 , 7 + 894 , 9 @ @ 
 + @ @ - 831 , 7 + 895 , 9 @ @ 
 { 
 float f1 = ( float ) ( i * i + 1 ) ; 
 
 @ @ - 189 , 7 + 197 , 7 @ @ 
 { 
 f + = f1 * 0 . 08F ; 
 } 
 - @ @ - 862 , 7 + 927 , 8 @ @ 
 + @ @ - 862 , 7 + 928 , 8 @ @ 
 f / = 5 . 0F ; 
 } 
 
 @ @ - 199 , 7 + 207 , 7 @ @ 
 } 
 
 / * * 
 - @ @ - 870 , 7 + 936 , 7 @ @ 
 + @ @ - 870 , 7 + 937 , 7 @ @ 
 * / 
 public boolean canHarvestBlock ( Block par1Block ) 
 { 
 @ @ - 208 , 7 + 216 , 7 @ @ 
 } 
 
 / * * 
 - @ @ - 900 , 6 + 966 , 14 @ @ 
 + @ @ - 900 , 6 + 967 , 14 @ @ 
 this . spawnChunk = new ChunkCoordinates ( par1NBTTagCompound . getInteger ( " SpawnX " ) , par1NBTTagCompound . getInteger ( " SpawnY " ) , par1NBTTagCompound . getInteger ( " SpawnZ " ) ) ; 
 this . spawnForced = par1NBTTagCompound . getBoolean ( " SpawnForced " ) ; 
 } 
 @ @ - 223 , 7 + 231 , 7 @ @ 
 
 this . foodStats . readNBT ( par1NBTTagCompound ) ; 
 this . capabilities . readCapabilitiesFromNBT ( par1NBTTagCompound ) ; 
 - @ @ - 933 , 6 + 1007 , 21 @ @ 
 + @ @ - 933 , 6 + 1008 , 21 @ @ 
 par1NBTTagCompound . setInteger ( " SpawnZ " , this . spawnChunk . posZ ) ; 
 par1NBTTagCompound . setBoolean ( " SpawnForced " , this . spawnForced ) ; 
 } 
 @ @ - 245 , 7 + 253 , 16 @ @ 
 
 this . foodStats . writeNBT ( par1NBTTagCompound ) ; 
 this . capabilities . writeCapabilitiesToNBT ( par1NBTTagCompound ) ; 
 - @ @ - 980 , 6 + 1069 , 7 @ @ 
 + @ @ - 964 , 7 + 1054 , 7 @ @ 
 + 
 + public float getEyeHeight ( ) 
 + { 
 + - return 0 . 12F ; 
 + + return eyeHeight ; 
 + } 
 + 
 + / * * 
 + @ @ - 980 , 6 + 1070 , 7 @ @ 
 * / 
 public boolean attackEntityFrom ( DamageSource par1DamageSource , float par2 ) 
 { 
 @ @ - 253 , 7 + 270 , 7 @ @ 
 if ( this . isEntityInvulnerable ( ) ) 
 { 
 return false ; 
 - @ @ - 1092 , 12 + 1182 , 15 @ @ 
 + @ @ - 1092 , 12 + 1183 , 15 @ @ 
 { 
 if ( ! this . isEntityInvulnerable ( ) ) 
 { 
 @ @ - 270 , 7 + 287 , 7 @ @ 
 par2 = this . applyPotionDamageCalculations ( par1DamageSource , par2 ) ; 
 float f1 = par2 ; 
 par2 = Math . max ( par2 - this . getAbsorptionAmount ( ) , 0 . 0F ) ; 
 - @ @ - 1147 , 6 + 1240 , 7 @ @ 
 + @ @ - 1147 , 6 + 1241 , 7 @ @ 
 
 public boolean interactWith ( Entity par1Entity ) 
 { 
 @ @ - 278 , 7 + 295 , 7 @ @ 
 ItemStack itemstack = this . getCurrentEquippedItem ( ) ; 
 ItemStack itemstack1 = itemstack ! = null ? itemstack . copy ( ) : null ; 
 
 - @ @ - 1203 , 7 + 1297 , 9 @ @ 
 + @ @ - 1203 , 7 + 1298 , 9 @ @ 
 * / 
 public void destroyCurrentEquippedItem ( ) 
 { 
 @ @ - 288 , 7 + 305 , 7 @ @ 
 } 
 
 / * * 
 - @ @ - 1220 , 6 + 1316 , 15 @ @ 
 + @ @ - 1220 , 6 + 1317 , 15 @ @ 
 * / 
 public void attackTargetEntityWithCurrentItem ( Entity par1Entity ) 
 { 
 @ @ - 304 , 7 + 321 , 7 @ @ 
 if ( par1Entity . canAttackWithItem ( ) ) 
 { 
 if ( ! par1Entity . hitByEntity ( this ) ) 
 - @ @ - 1373 , 6 + 1478 , 12 @ @ 
 + @ @ - 1373 , 6 + 1479 , 12 @ @ 
 * / 
 public EnumStatus sleepInBedAt ( int par1 , int par2 , int par3 ) 
 { 
 @ @ - 317 , 7 + 334 , 7 @ @ 
 if ( ! this . worldObj . isRemote ) 
 { 
 if ( this . isPlayerSleeping ( ) | | ! this . isEntityAlive ( ) ) 
 - @ @ - 1417 , 6 + 1528 , 11 @ @ 
 + @ @ - 1417 , 6 + 1529 , 11 @ @ 
 { 
 int l = this . worldObj . getBlockMetadata ( par1 , par2 , par3 ) ; 
 int i1 = BlockBed . getDirection ( l ) ; 
 @ @ - 329 , 7 + 346 , 7 @ @ 
 float f = 0 . 5F ; 
 float f1 = 0 . 5F ; 
 
 - @ @ - 1487 , 10 + 1603 , 12 @ @ 
 + @ @ - 1487 , 10 + 1604 , 12 @ @ 
 ChunkCoordinates chunkcoordinates = this . playerLocation ; 
 ChunkCoordinates chunkcoordinates1 = this . playerLocation ; 
 
 @ @ - 346 , 7 + 363 , 7 @ @ 
 
 if ( chunkcoordinates1 = = null ) 
 { 
 - @ @ - 1527 , 7 + 1645 , 9 @ @ 
 + @ @ - 1527 , 7 + 1646 , 9 @ @ 
 * / 
 private boolean isInBed ( ) 
 { 
 @ @ - 357 , 7 + 374 , 7 @ @ 
 } 
 
 / * * 
 - @ @ - 1542 , 9 + 1662 , 12 @ @ 
 + @ @ - 1542 , 9 + 1663 , 12 @ @ 
 ichunkprovider . loadChunk ( par1ChunkCoordinates . posX - 3 > > 4 , par1ChunkCoordinates . posZ + 3 > > 4 ) ; 
 ichunkprovider . loadChunk ( par1ChunkCoordinates . posX + 3 > > 4 , par1ChunkCoordinates . posZ + 3 > > 4 ) ; 
 
 @ @ - 373 , 7 + 390 , 7 @ @ 
 return chunkcoordinates1 ; 
 } 
 else 
 - @ @ - 1566 , 10 + 1689 , 13 @ @ 
 + @ @ - 1566 , 10 + 1690 , 13 @ @ 
 { 
 if ( this . playerLocation ! = null ) 
 { 
 @ @ - 391 , 7 + 408 , 7 @ @ 
 { 
 case 0 : 
 return 90 . 0F ; 
 - @ @ - 1635 , 14 + 1761 , 40 @ @ 
 + @ @ - 1635 , 14 + 1762 , 40 @ @ 
 / * * 
 * Returns the location of the bed the player will respawn at , or null if the player has not slept in a bed . 
 * / 
 @ @ - 436 , 7 + 453 , 7 @ @ 
 } 
 
 / * * 
 - @ @ - 1650 , 6 + 1802 , 10 @ @ 
 + @ @ - 1650 , 6 + 1803 , 10 @ @ 
 * / 
 public void setSpawnChunk ( ChunkCoordinates par1ChunkCoordinates , boolean par2 ) 
 { 
 @ @ - 447 , 7 + 464 , 7 @ @ 
 if ( par1ChunkCoordinates ! = null ) 
 { 
 this . spawnChunk = new ChunkCoordinates ( par1ChunkCoordinates ) ; 
 - @ @ - 1661 , 7 + 1817 , 32 @ @ 
 + @ @ - 1661 , 7 + 1818 , 32 @ @ 
 this . spawnForced = false ; 
 } 
 } 
 @ @ - 481 , 7 + 498 , 7 @ @ 
 / * * 
 * Will trigger the specified trigger . 
 * / 
 - @ @ - 1843 , 6 + 2024 , 10 @ @ 
 + @ @ - 1843 , 6 + 2025 , 10 @ @ 
 
 super . fall ( par1 ) ; 
 } 
 @ @ - 492 , 7 + 509 , 7 @ @ 
 } 
 
 / * * 
 - @ @ - 1884 , 7 + 2069 , 7 @ @ 
 + @ @ - 1884 , 7 + 2070 , 7 @ @ 
 { 
 if ( par1ItemStack . getItem ( ) . requiresMultipleRenderPasses ( ) ) 
 { 
 @ @ - 501 , 7 + 518 , 7 @ @ 
 } 
 
 if ( this . itemInUse ! = null & & par1ItemStack . itemID = = Item . bow . itemID ) 
 - @ @ - 1906 , 6 + 2091 , 7 @ @ 
 + @ @ - 1906 , 6 + 2092 , 7 @ @ 
 return Item . bow . getItemIconForUseDuration ( 0 ) ; 
 } 
 } 
 @ @ - 509 , 7 + 526 , 7 @ @ 
 } 
 
 return icon ; 
 - @ @ - 2127 , 7 + 2313 , 17 @ @ 
 + @ @ - 2127 , 7 + 2314 , 17 @ @ 
 this . setScore ( par1EntityPlayer . getScore ( ) ) ; 
 } 
 
 @ @ - 527 , 7 + 544 , 7 @ @ 
 } 
 
 / * * 
 - @ @ - 2191 , 7 + 2387 , 14 @ @ 
 + @ @ - 2191 , 7 + 2388 , 14 @ @ 
 * / 
 public void setCurrentItemOrArmor ( int par1 , ItemStack par2ItemStack ) 
 { 
 @ @ - 543 , 3 + 560 , 21 @ @ 
 } 
 
 @ SideOnly ( Side . CLIENT ) 
 + @ @ - 2267 , 4 + 2471 , 17 @ @ 
 + { 
 + FMLNetworkHandler . openGui ( this , mod , modGuiId , world , x , y , z ) ; 
 + } 
 + + 
 + + / * = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = FORGE START = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = * / 
 + + 
 + + public float eyeHeight ; 
 + + 
 + + / * * 
 + + * Returns the default eye height of the player 
 + + * @ return player default eye height 
 + + * / 
 + + public float getDefaultEyeHeight ( ) 
 + + { 
 + + return 0 . 12F ; 
 + + } 
 + } 
 diff - - git a / patches / minecraft / net / minecraft / entity / player / EntityPlayerMP . java . patch b / patches / minecraft / net / minecraft / entity / player / EntityPlayerMP . java . patch 
 index 577132e . . 1e197c8 100644 
 - - - a / patches / minecraft / net / minecraft / entity / player / EntityPlayerMP . java . patch 
 + + + b / patches / minecraft / net / minecraft / entity / player / EntityPlayerMP . java . patch 
 @ @ - 33 , 7 + 33 , 19 @ @ 
 
 this . mcServer = par1MinecraftServer ; 
 this . stepHeight = 0 . 0F ; 
 - @ @ - 289 , 7 + 287 , 10 @ @ 
 + @ @ - 239 , 11 + 237 , 6 @ @ 
 + this . yOffset = 0 . 0F ; 
 + } 
 + 
 + - public float getEyeHeight ( ) 
 + - { 
 + - return 1 . 62F ; 
 + - } 
 + - 
 + / * * 
 + * Called to update the entity ' s position / logic . 
 + * / 
 + @ @ - 289 , 7 + 282 , 10 @ @ 
 if ( chunkcoordintpair ! = null & & this . worldObj . blockExists ( chunkcoordintpair . chunkXPos < < 4 , 0 , chunkcoordintpair . chunkZPos < < 4 ) ) 
 { 
 arraylist . add ( this . worldObj . getChunkFromChunkCoords ( chunkcoordintpair . chunkXPos , chunkcoordintpair . chunkZPos ) ) ; 
 @ @ - 45 , 7 + 57 , 7 @ @ 
 } 
 } 
 
 - @ @ - 310 , 6 + 311 , 7 @ @ 
 + @ @ - 310 , 6 + 306 , 7 @ @ 
 { 
 Chunk chunk = ( Chunk ) iterator2 . next ( ) ; 
 this . getServerForPlayer ( ) . getEntityTracker ( ) . func _ 85172 _ a ( this , chunk ) ; 
 @ @ - 53 , 7 + 65 , 7 @ @ 
 } 
 } 
 } 
 - @ @ - 377 , 11 + 379 , 25 @ @ 
 + @ @ - 377 , 11 + 374 , 25 @ @ 
 * / 
 public void onDeath ( DamageSource par1DamageSource ) 
 { 
 @ @ - 79 , 3 + 91 , 20 @ @ 
 } 
 
 Collection collection = this . worldObj . getScoreboard ( ) . func _ 96520 _ a ( ScoreObjectiveCriteria . deathCount ) ; 
 + @ @ - 1043 , 4 + 1054 , 16 @ @ 
 + { 
 + return new ChunkCoordinates ( MathHelper . floor _ double ( this . posX ) , MathHelper . floor _ double ( this . posY + 0 . 5D ) , MathHelper . floor _ double ( this . posZ ) ) ; 
 + } 
 + + 
 + + / * = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = FORGE START = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = * / 
 + + 
 + + / * * 
 + + * Returns the default eye height of the player 
 + + * @ return player default eye height 
 + + * / 
 + + @ Override 
 + + public float getDefaultEyeHeight ( ) 
 + + { 
 + + return 1 . 62F ; 
 + + } 
 + }
