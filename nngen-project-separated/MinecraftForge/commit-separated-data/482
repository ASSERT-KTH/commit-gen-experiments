BLEU SCORE: 0.0016018537822016692

TEST MSG: Add LootTableManager to the LootTableLoadEvent
GENERATED MSG: Fix up the setHandeled / setHandled for events , it is now a generalized setResult , the meaning of which is defined by each event .

TEST DIFF (one line): diff - - git a / patches / minecraft / net / minecraft / world / storage / loot / LootTableManager . java . patch b / patches / minecraft / net / minecraft / world / storage / loot / LootTableManager . java . patch <nl> index 8aaf224 . . 8aa0caf 100644 <nl> - - - a / patches / minecraft / net / minecraft / world / storage / loot / LootTableManager . java . patch <nl> + + + b / patches / minecraft / net / minecraft / world / storage / loot / LootTableManager . java . patch <nl> @ @ - 5 , 7 + 5 , 7 @ @ <nl> try <nl> { <nl> - return ( LootTable ) LootTableManager . field _ 186526 _ b . fromJson ( s , LootTable . class ) ; <nl> - + return net . minecraftforge . common . ForgeHooks . loadLootTable ( LootTableManager . field _ 186526 _ b , p _ 186517 _ 1 _ , s , true ) ; <nl> + + return net . minecraftforge . common . ForgeHooks . loadLootTable ( LootTableManager . field _ 186526 _ b , p _ 186517 _ 1 _ , s , true , LootTableManager . this ) ; <nl> } <nl> catch ( JsonParseException jsonparseexception ) <nl> { <nl> @ @ - 14 , 7 + 14 , 7 @ @ <nl> try <nl> { <nl> - return ( LootTable ) LootTableManager . field _ 186526 _ b . fromJson ( s , LootTable . class ) ; <nl> - + return net . minecraftforge . common . ForgeHooks . loadLootTable ( LootTableManager . field _ 186526 _ b , p _ 186518 _ 1 _ , s , false ) ; <nl> + + return net . minecraftforge . common . ForgeHooks . loadLootTable ( LootTableManager . field _ 186526 _ b , p _ 186518 _ 1 _ , s , false , LootTableManager . this ) ; <nl> } <nl> catch ( JsonParseException jsonparseexception ) <nl> { <nl> diff - - git a / src / main / java / net / minecraftforge / common / ForgeHooks . java b / src / main / java / net / minecraftforge / common / ForgeHooks . java <nl> index 4fa6049 . . c15f298 100644 <nl> - - - a / src / main / java / net / minecraftforge / common / ForgeHooks . java <nl> + + + b / src / main / java / net / minecraftforge / common / ForgeHooks . java <nl> @ @ - 93 , 6 + 93 , 7 @ @ import net . minecraft . world . EnumDifficulty ; <nl> import net . minecraft . world . GameType ; <nl> import net . minecraft . world . storage . loot . LootEntry ; <nl> import net . minecraft . world . storage . loot . LootTable ; <nl> + import net . minecraft . world . storage . loot . LootTableManager ; <nl> import net . minecraft . world . storage . loot . conditions . LootCondition ; <nl> import net . minecraftforge . common . util . BlockSnapshot ; <nl> import net . minecraftforge . event . AnvilUpdateEvent ; <nl> @ @ - 1092 , 14 + 1093 , 22 @ @ public class ForgeHooks <nl> LootTableContext ctx = lootContext . get ( ) . peek ( ) ; <nl> <nl> if ( ctx = = null ) <nl> - throw new JsonParseException ( " Invalid call stack , could to grab json context ! " ) ; / / Show I throw this ? Do we care about custom deserializers outside the manager ? <nl> + throw new JsonParseException ( " Invalid call stack , could not grab json context ! " ) ; / / Should I throw this ? Do we care about custom deserializers outside the manager ? <nl> <nl> return ctx ; <nl> } <nl> <nl> - @ Nullable <nl> + / / TODO : remove <nl> + / * * @ deprecated use { @ link ForgeHooks # loadLootTable ( Gson , ResourceLocation , String , boolean , LootTableManager ) } * / <nl> + @ Deprecated <nl> public static LootTable loadLootTable ( Gson gson , ResourceLocation name , String data , boolean custom ) <nl> { <nl> + return loadLootTable ( gson , name , data , custom , null ) ; <nl> + } <nl> + <nl> + @ Nullable <nl> + public static LootTable loadLootTable ( Gson gson , ResourceLocation name , String data , boolean custom , LootTableManager lootTableManager ) <nl> + { <nl> Deque < LootTableContext > que = lootContext . get ( ) ; <nl> if ( que = = null ) <nl> { <nl> @ @ - 1121 , 7 + 1130 , 7 @ @ public class ForgeHooks <nl> } <nl> <nl> if ( ! custom ) <nl> - ret = ForgeEventFactory . loadLootTable ( name , ret ) ; <nl> + ret = ForgeEventFactory . loadLootTable ( name , ret , lootTableManager ) ; <nl> <nl> if ( ret ! = null ) <nl> ret . freeze ( ) ; <nl> diff - - git a / src / main / java / net / minecraftforge / event / ForgeEventFactory . java b / src / main / java / net / minecraftforge / event / ForgeEventFactory . java <nl> index 238a886 . . 1646e84 100644 <nl> - - - a / src / main / java / net / minecraftforge / event / ForgeEventFactory . java <nl> + + + b / src / main / java / net / minecraftforge / event / ForgeEventFactory . java <nl> @ @ - 64 , 6 + 64 , 7 @ @ import net . minecraft . world . chunk . IChunkGenerator ; <nl> import net . minecraft . world . storage . IPlayerFileData ; <nl> import net . minecraft . world . storage . SaveHandler ; <nl> import net . minecraft . world . storage . loot . LootTable ; <nl> + import net . minecraft . world . storage . loot . LootTableManager ; <nl> import net . minecraftforge . client . event . ClientChatEvent ; <nl> import net . minecraftforge . client . event . ClientChatReceivedEvent ; <nl> import net . minecraftforge . client . event . RenderBlockOverlayEvent ; <nl> @ @ - 645 , 9 + 646 , 18 @ @ public class ForgeEventFactory <nl> MinecraftForge . EVENT _ BUS . post ( pre ? new PopulateChunkEvent . Pre ( gen , world , rand , x , z , hasVillageGenerated ) : new PopulateChunkEvent . Post ( gen , world , rand , x , z , hasVillageGenerated ) ) ; <nl> } <nl> <nl> + / * * <nl> + * @ deprecated Use { @ link # loadLootTable ( ResourceLocation , LootTable , LootTableManager ) } < br > <nl> + * / <nl> + @ Deprecated <nl> public static LootTable loadLootTable ( ResourceLocation name , LootTable table ) <nl> { <nl> - LootTableLoadEvent event = new LootTableLoadEvent ( name , table ) ; <nl> + return loadLootTable ( name , table , null ) ; <nl> + } <nl> + <nl> + public static LootTable loadLootTable ( ResourceLocation name , LootTable table , LootTableManager lootTableManager ) <nl> + { <nl> + LootTableLoadEvent event = new LootTableLoadEvent ( name , table , lootTableManager ) ; <nl> if ( MinecraftForge . EVENT _ BUS . post ( event ) ) <nl> return LootTable . EMPTY _ LOOT _ TABLE ; <nl> return event . getTable ( ) ; <nl> diff - - git a / src / main / java / net / minecraftforge / event / LootTableLoadEvent . java b / src / main / java / net / minecraftforge / event / LootTableLoadEvent . java <nl> index b190077 . . 0f6dc1b 100644 <nl> - - - a / src / main / java / net / minecraftforge / event / LootTableLoadEvent . java <nl> + + + b / src / main / java / net / minecraftforge / event / LootTableLoadEvent . java <nl> @ @ - 21 , 6 + 21 , 7 @ @ package net . minecraftforge . event ; <nl> <nl> import net . minecraft . util . ResourceLocation ; <nl> import net . minecraft . world . storage . loot . LootTable ; <nl> + import net . minecraft . world . storage . loot . LootTableManager ; <nl> import net . minecraftforge . fml . common . eventhandler . Cancelable ; <nl> import net . minecraftforge . fml . common . eventhandler . Event ; <nl> <nl> @ @ - 38 , 11 + 39 , 21 @ @ public class LootTableLoadEvent extends Event <nl> { <nl> private final ResourceLocation name ; <nl> private LootTable table ; <nl> + private LootTableManager lootTableManager ; <nl> <nl> - public LootTableLoadEvent ( ResourceLocation name , LootTable table ) <nl> + / * * <nl> + * @ deprecated Use { @ link # LootTableLoadEvent ( ResourceLocation , LootTable , LootTableManager ) } < br > <nl> + * / <nl> + @ Deprecated <nl> + public LootTableLoadEvent ( ResourceLocation name , LootTable table ) { <nl> + this ( name , table , null ) ; <nl> + } <nl> + <nl> + public LootTableLoadEvent ( ResourceLocation name , LootTable table , LootTableManager lootTableManager ) <nl> { <nl> this . name = name ; <nl> this . table = table ; <nl> + this . lootTableManager = lootTableManager ; <nl> } <nl> <nl> public ResourceLocation getName ( ) <nl> @ @ - 55 , 6 + 66 , 11 @ @ public class LootTableLoadEvent extends Event <nl> return this . table ; <nl> } <nl> <nl> + public LootTableManager getLootTableManager ( ) <nl> + { <nl> + return this . lootTableManager ; <nl> + } <nl> + <nl> public void setTable ( LootTable table ) <nl> { <nl> this . table = table ; <nl> diff - - git a / src / test / java / net / minecraftforge / test / LootTableLoadEventTest . java b / src / test / java / net / minecraftforge / test / LootTableLoadEventTest . java <nl> new file mode 100644 <nl> index 0000000 . . aa544ae <nl> - - - / dev / null <nl> + + + b / src / test / java / net / minecraftforge / test / LootTableLoadEventTest . java <nl> @ @ - 0 , 0 + 1 , 32 @ @ <nl> + package net . minecraftforge . test ; <nl> + <nl> + import net . minecraft . util . ResourceLocation ; <nl> + import net . minecraft . world . storage . loot . LootTable ; <nl> + import net . minecraft . world . storage . loot . LootTableList ; <nl> + import net . minecraftforge . common . MinecraftForge ; <nl> + import net . minecraftforge . event . LootTableLoadEvent ; <nl> + import net . minecraftforge . fml . common . Mod ; <nl> + import net . minecraftforge . fml . common . Mod . EventHandler ; <nl> + import net . minecraftforge . fml . common . event . FMLInitializationEvent ; <nl> + import net . minecraftforge . fml . common . eventhandler . SubscribeEvent ; <nl> + <nl> + @ Mod ( modid = LootTableLoadEventTest . MODID , name = " LootTableLoadEventTest " , version = " 1 . 0 " , acceptableRemoteVersions = " * " ) <nl> + public class LootTableLoadEventTest { <nl> + public static final String MODID = " loottable _ load _ event _ test " ; <nl> + <nl> + @ EventHandler <nl> + public void init ( FMLInitializationEvent event ) <nl> + { <nl> + MinecraftForge . EVENT _ BUS . register ( this ) ; <nl> + } <nl> + <nl> + @ SubscribeEvent <nl> + public void onLootTableLoadEvent ( LootTableLoadEvent event ) <nl> + { <nl> + if ( LootTableList . CHESTS _ SPAWN _ BONUS _ CHEST . equals ( event . getName ( ) ) ) { <nl> + ResourceLocation loc = new ResourceLocation ( MODID , " chests / custom _ spawn _ bonus _ chest " ) ; <nl> + LootTable customLootTable = event . getLootTableManager ( ) . getLootTableFromLocation ( loc ) ; <nl> + event . setTable ( customLootTable ) ; <nl> + } <nl> + } <nl> + } <nl> diff - - git a / src / test / resources / assets / loottable _ load _ event _ test / loot _ tables / chests / custom _ spawn _ bonus _ chest . json b / src / test / resources / assets / loottable _ load _ event _ test / loot _ tables / chests / custom _ spawn _ bonus _ chest . json <nl> new file mode 100644 <nl> index 0000000 . . 60fdd88 <nl> - - - / dev / null <nl> + + + b / src / test / resources / assets / loottable _ load _ event _ test / loot _ tables / chests / custom _ spawn _ bonus _ chest . json <nl> @ @ - 0 , 0 + 1 , 146 @ @ <nl> + { <nl> + " pools " : [ <nl> + { <nl> + " name " : " custom - spawn - chest - 1 " , <nl> + " rolls " : 1 , <nl> + " entries " : [ <nl> + { <nl> + " type " : " item " , <nl> + " name " : " minecraft : diamond _ axe " , <nl> + " weight " : 1 <nl> + } , <nl> + { <nl> + " type " : " item " , <nl> + " name " : " minecraft : iron _ axe " , <nl> + " weight " : 3 <nl> + } <nl> + ] <nl> + } , <nl> + { <nl> + " name " : " custom - spawn - chest - 2 " , <nl> + " rolls " : 1 , <nl> + " entries " : [ <nl> + { <nl> + " type " : " item " , <nl> + " name " : " minecraft : diamond _ pickaxe " , <nl> + " weight " : 1 <nl> + } , <nl> + { <nl> + " type " : " item " , <nl> + " name " : " minecraft : iron _ pickaxe " , <nl> + " weight " : 3 <nl> + } <nl> + ] <nl> + } , <nl> + { <nl> + " name " : " custom - spawn - chest - 3 " , <nl> + " rolls " : 3 , <nl> + " entries " : [ <nl> + { <nl> + " type " : " item " , <nl> + " name " : " minecraft : golden _ apple " , <nl> + " weight " : 5 , <nl> + " functions " : [ <nl> + { <nl> + " function " : " minecraft : set _ count " , <nl> + " count " : { <nl> + " min " : 1 , <nl> + " max " : 2 <nl> + } <nl> + } <nl> + ] <nl> + } , <nl> + { <nl> + " type " : " item " , <nl> + " name " : " minecraft : beef " , <nl> + " weight " : 3 , <nl> + " functions " : [ <nl> + { <nl> + " function " : " minecraft : set _ count " , <nl> + " count " : { <nl> + " min " : 1 , <nl> + " max " : 2 <nl> + } <nl> + } <nl> + ] <nl> + } <nl> + ] <nl> + } , <nl> + { <nl> + " name " : " custom - spawn - chest - 4 " , <nl> + " rolls " : 4 , <nl> + " entries " : [ <nl> + { <nl> + " type " : " item " , <nl> + " name " : " minecraft : stick " , <nl> + " weight " : 10 , <nl> + " functions " : [ <nl> + { <nl> + " function " : " minecraft : set _ count " , <nl> + " count " : { <nl> + " min " : 1 , <nl> + " max " : 24 <nl> + } <nl> + } <nl> + ] <nl> + } , <nl> + { <nl> + " type " : " item " , <nl> + " name " : " minecraft : planks " , <nl> + " weight " : 10 , <nl> + " functions " : [ <nl> + { <nl> + " function " : " minecraft : set _ count " , <nl> + " count " : { <nl> + " min " : 1 , <nl> + " max " : 24 <nl> + } <nl> + } <nl> + ] <nl> + } , <nl> + { <nl> + " type " : " item " , <nl> + " name " : " minecraft : log " , <nl> + " weight " : 10 , <nl> + " functions " : [ <nl> + { <nl> + " function " : " minecraft : set _ count " , <nl> + " count " : { <nl> + " min " : 1 , <nl> + " max " : 3 <nl> + } <nl> + } , <nl> + { <nl> + " function " : " minecraft : set _ data " , <nl> + " data " : { <nl> + " min " : 0 , <nl> + " max " : 3 <nl> + } <nl> + } <nl> + ] <nl> + } , <nl> + { <nl> + " type " : " item " , <nl> + " name " : " minecraft : log2 " , <nl> + " weight " : 10 , <nl> + " functions " : [ <nl> + { <nl> + " function " : " minecraft : set _ count " , <nl> + " count " : { <nl> + " min " : 1 , <nl> + " max " : 3 <nl> + } <nl> + } , <nl> + { <nl> + " function " : " minecraft : set _ data " , <nl> + " data " : { <nl> + " min " : 0 , <nl> + " max " : 1 <nl> + } <nl> + } <nl> + ] <nl> + } <nl> + ] <nl> + } <nl> + ] <nl> + } <nl> \ No newline at end of file
NEAREST DIFF (one line): diff - - git a / common / net / minecraftforge / event / Event . java b / common / net / minecraftforge / event / Event . java <nl> index 15947ca . . bd530ae 100644 <nl> - - - a / common / net / minecraftforge / event / Event . java <nl> + + + b / common / net / minecraftforge / event / Event . java <nl> @ @ - 1 , 11 + 1 , 21 @ @ <nl> package net . minecraftforge . event ; <nl> <nl> + import static java . lang . annotation . ElementType . TYPE ; <nl> + import static java . lang . annotation . RetentionPolicy . RUNTIME ; <nl> + <nl> + import java . lang . annotation . Retention ; <nl> + import java . lang . annotation . Target ; <nl> + <nl> <nl> / * * <nl> * Base Event class that all other events are derived from <nl> * / <nl> public class Event <nl> { <nl> + @ Retention ( value = RUNTIME ) <nl> + @ Target ( value = TYPE ) <nl> + public @ interface HasResult { } <nl> + <nl> public enum Result <nl> { <nl> DENY , <nl> @ @ - 15 , 25 + 25 , 31 @ @ public class Event <nl> <nl> private boolean isCanceled = false ; <nl> private final boolean isCancelable ; <nl> + private Result result = Result . DEFAULT ; <nl> + private final boolean hasResult ; <nl> private static ListenerList listeners = new ListenerList ( ) ; <nl> <nl> public Event ( ) <nl> { <nl> setup ( ) ; <nl> + isCancelable = hasAnnotation ( Cancelable . class ) ; <nl> + hasResult = hasAnnotation ( HasResult . class ) ; <nl> + } <nl> + <nl> + private boolean hasAnnotation ( Class annotation ) <nl> + { <nl> Class cls = this . getClass ( ) ; <nl> - boolean found = false ; <nl> while ( cls ! = Event . class ) <nl> { <nl> if ( cls . isAnnotationPresent ( Cancelable . class ) ) <nl> { <nl> - found = true ; <nl> - break ; <nl> + return true ; <nl> } <nl> cls = cls . getSuperclass ( ) ; <nl> } <nl> - isCancelable = found ; <nl> + return false ; <nl> } <nl> - <nl> + <nl> / * * <nl> * Determine if this function is cancelable at all . <nl> * @ return If access to setCanceled should be allowed <nl> @ @ - 42 , 7 + 58 , 7 @ @ public class Event <nl> { <nl> return isCancelable ; <nl> } <nl> - <nl> + <nl> / * * <nl> * Determine if this event is canceled and should stop executing . <nl> * @ return The current canceled state <nl> @ @ - 51 , 7 + 67 , 7 @ @ public class Event <nl> { <nl> return isCanceled ; <nl> } <nl> - <nl> + <nl> / * * <nl> * Sets the state of this event , not all events are cancelable , and any attempt to <nl> * cancel a event that can ' t be will result in a IllegalArgumentException . <nl> @ @ - 68 , 7 + 84 , 35 @ @ public class Event <nl> } <nl> isCanceled = cancel ; <nl> } <nl> - <nl> + <nl> + / * * <nl> + * Determines if this event expects a significant result value . <nl> + * / <nl> + public boolean hasResult ( ) <nl> + { <nl> + return hasResult ; <nl> + } <nl> + <nl> + / * * <nl> + * Returns the value set as the result of this event <nl> + * / <nl> + public Result getResult ( ) <nl> + { <nl> + return result ; <nl> + } <nl> + <nl> + / * * <nl> + * Sets the result value for this event , not all events can have a result set , and any attempt to <nl> + * set a result for a event that isn ' t expecting it will result in a IllegalArgumentException . <nl> + * <nl> + * The functionality of setting the result is defined on a per - event bases . <nl> + * <nl> + * @ param value The new result <nl> + * / <nl> + public void setResult ( Result value ) <nl> + { <nl> + result = value ; <nl> + } <nl> / * * <nl> * Called by the base constructor , this is used by ASM generated <nl> * event classes to setup various functionality such as the listener ' s list . <nl> diff - - git a / common / net / minecraftforge / event / entity / UseHoeEvent . java b / common / net / minecraftforge / event / entity / UseHoeEvent . java <nl> deleted file mode 100644 <nl> index c012c91 . . 0000000 <nl> - - - a / common / net / minecraftforge / event / entity / UseHoeEvent . java <nl> + + + / dev / null <nl> @ @ - 1 , 40 + 0 , 0 @ @ <nl> - package net . minecraftforge . event . entity ; <nl> - <nl> - import net . minecraft . src . EntityPlayer ; <nl> - import net . minecraft . src . ItemStack ; <nl> - import net . minecraft . src . World ; <nl> - import net . minecraftforge . event . Cancelable ; <nl> - import net . minecraftforge . event . entity . player . PlayerEvent ; <nl> - <nl> - @ Cancelable <nl> - public class UseHoeEvent extends PlayerEvent <nl> - { <nl> - <nl> - public final ItemStack current ; <nl> - public final World world ; <nl> - public final int x ; <nl> - public final int y ; <nl> - public final int z ; <nl> - <nl> - private boolean handeled = false ; <nl> - <nl> - public UseHoeEvent ( EntityPlayer player , ItemStack current , World world , int x , int y , int z ) <nl> - { <nl> - super ( player ) ; <nl> - this . current = current ; <nl> - this . world = world ; <nl> - this . x = x ; <nl> - this . y = y ; <nl> - this . z = z ; <nl> - } <nl> - <nl> - public boolean isHandeled ( ) <nl> - { <nl> - return handeled ; <nl> - } <nl> - <nl> - public void setHandeled ( ) <nl> - { <nl> - handeled = true ; <nl> - } <nl> - } <nl> diff - - git a / common / net / minecraftforge / event / entity / living / LivingSpecialSpawnEvent . java b / common / net / minecraftforge / event / entity / living / LivingSpecialSpawnEvent . java <nl> index f6e555e . . 2186967 100644 <nl> - - - a / common / net / minecraftforge / event / entity / living / LivingSpecialSpawnEvent . java <nl> + + + b / common / net / minecraftforge / event / entity / living / LivingSpecialSpawnEvent . java <nl> @ @ - 2 , 7 + 2 , 9 @ @ package net . minecraftforge . event . entity . living ; <nl> <nl> import net . minecraft . src . EntityLiving ; <nl> import net . minecraft . src . World ; <nl> + import net . minecraftforge . event . Cancelable ; <nl> <nl> + @ Cancelable <nl> public class LivingSpecialSpawnEvent extends LivingEvent <nl> { <nl> public final World world ; <nl> @ @ - 19 , 14 + 21 , 4 @ @ public class LivingSpecialSpawnEvent extends LivingEvent <nl> this . y = y ; <nl> this . z = z ; <nl> } <nl> - <nl> - public void setHandeled ( ) <nl> - { <nl> - handeled = true ; <nl> - } <nl> - <nl> - public boolean isHandeled ( ) <nl> - { <nl> - return handeled ; <nl> - } <nl> } <nl> diff - - git a / common / net / minecraftforge / event / entity / player / BonemealEvent . java b / common / net / minecraftforge / event / entity / player / BonemealEvent . java <nl> index 8126d71 . . 894d431 100644 <nl> - - - a / common / net / minecraftforge / event / entity / player / BonemealEvent . java <nl> + + + b / common / net / minecraftforge / event / entity / player / BonemealEvent . java <nl> @ @ - 3 , 16 + 3 , 27 @ @ package net . minecraftforge . event . entity . player ; <nl> import net . minecraft . src . EntityPlayer ; <nl> import net . minecraft . src . World ; <nl> import net . minecraftforge . event . Cancelable ; <nl> + import net . minecraftforge . event . Event ; <nl> <nl> @ Cancelable <nl> + @ Event . HasResult <nl> public class BonemealEvent extends PlayerEvent <nl> { <nl> + / * * <nl> + * This event is called when a player attempts to use Bonemeal on a block . <nl> + * It can be canceled to completely prevent any further processing . <nl> + * <nl> + * You can also set the result to ALLOW to mark the event as processed <nl> + * and use up a bonemeal from the stack but do no further processing . <nl> + * <nl> + * setResult ( ALLOW ) is the same as the old setHandeled ( ) <nl> + * / <nl> + <nl> public final World world ; <nl> public final int ID ; <nl> public final int X ; <nl> public final int Y ; <nl> public final int Z ; <nl> - private boolean handeled = false ; <nl> <nl> public BonemealEvent ( EntityPlayer player , World world , int id , int x , int y , int z ) <nl> { <nl> @ @ - 23 , 14 + 34 , 4 @ @ public class BonemealEvent extends PlayerEvent <nl> this . Y = y ; <nl> this . Z = z ; <nl> } <nl> - <nl> - public void setHandeled ( ) <nl> - { <nl> - handeled = true ; <nl> - } <nl> - <nl> - public boolean isHandeled ( ) <nl> - { <nl> - return handeled ; <nl> - } <nl> } <nl> diff - - git a / common / net / minecraftforge / event / entity / player / EntityItemPickupEvent . java b / common / net / minecraftforge / event / entity / player / EntityItemPickupEvent . java <nl> index 5d2156e . . 8a690dc 100644 <nl> - - - a / common / net / minecraftforge / event / entity / player / EntityItemPickupEvent . java <nl> + + + b / common / net / minecraftforge / event / entity / player / EntityItemPickupEvent . java <nl> @ @ - 4 , 26 + 4 , 29 @ @ import net . minecraft . src . Entity ; <nl> import net . minecraft . src . EntityItem ; <nl> import net . minecraft . src . EntityPlayer ; <nl> import net . minecraftforge . event . Cancelable ; <nl> + import net . minecraftforge . event . Event ; <nl> <nl> @ Cancelable <nl> + @ Event . HasResult <nl> public class EntityItemPickupEvent extends PlayerEvent <nl> { <nl> + / * * <nl> + * This event is called when a player collides with a EntityItem on the ground . <nl> + * The event can be canceled , and no further processing will be done . <nl> + * <nl> + * You can set the result of this event to ALLOW which will trigger the <nl> + * processing of achievements , FML ' s event , play the sound , and kill the <nl> + * entity if all the items are picked up . <nl> + * <nl> + * setResult ( ALLOW ) is the same as the old setHandled ( ) <nl> + * / <nl> + <nl> public final EntityItem item ; <nl> private boolean handled = false ; <nl> - <nl> + <nl> public EntityItemPickupEvent ( EntityPlayer player , EntityItem item ) <nl> { <nl> super ( player ) ; <nl> this . item = item ; <nl> } <nl> - <nl> - public boolean isHandled ( ) <nl> - { <nl> - return handled ; <nl> - } <nl> - <nl> - public void setHandled ( ) <nl> - { <nl> - handled = true ; <nl> - } <nl> } <nl> diff - - git a / common / net / minecraftforge / event / entity / player / FillBucketEvent . java b / common / net / minecraftforge / event / entity / player / FillBucketEvent . java <nl> index c110fba . . e09b454 100644 <nl> - - - a / common / net / minecraftforge / event / entity / player / FillBucketEvent . java <nl> + + + b / common / net / minecraftforge / event / entity / player / FillBucketEvent . java <nl> @ @ - 5 , 17 + 5 , 28 @ @ import net . minecraft . src . ItemStack ; <nl> import net . minecraft . src . MovingObjectPosition ; <nl> import net . minecraft . src . World ; <nl> import net . minecraftforge . event . Cancelable ; <nl> + import net . minecraftforge . event . Event ; <nl> <nl> @ Cancelable <nl> + @ Event . HasResult <nl> public class FillBucketEvent extends PlayerEvent <nl> { <nl> + / * * <nl> + * This event is fired when a player attempts to use a Empty bucket , it <nl> + * can be canceled to completely prevent any further processing . <nl> + * <nl> + * If you set the result to ' ALLOW ' , it means that you have processed <nl> + * the event and wants the basic functionality of adding the new <nl> + * ItemStack to your inventory and reducing the stack size to process . <nl> + * setResult ( ALLOW ) is the same as the old setHandeled ( ) ; <nl> + * / <nl> + <nl> public final ItemStack current ; <nl> public final World world ; <nl> public final MovingObjectPosition target ; <nl> - <nl> + <nl> public ItemStack result ; <nl> - private boolean handeled = false ; <nl> - <nl> + <nl> public FillBucketEvent ( EntityPlayer player , ItemStack current , World world , MovingObjectPosition target ) <nl> { <nl> super ( player ) ; <nl> @ @ - 23 , 14 + 34 , 4 @ @ public class FillBucketEvent extends PlayerEvent <nl> this . world = world ; <nl> this . target = target ; <nl> } <nl> - <nl> - public boolean isHandeled ( ) <nl> - { <nl> - return handeled ; <nl> - } <nl> - <nl> - public void setHandeled ( ) <nl> - { <nl> - handeled = true ; <nl> - } <nl> } <nl> diff - - git a / common / net / minecraftforge / event / entity / player / UseHoeEvent . java b / common / net / minecraftforge / event / entity / player / UseHoeEvent . java <nl> new file mode 100644 <nl> index 0000000 . . ac8793b <nl> - - - / dev / null <nl> + + + b / common / net / minecraftforge / event / entity / player / UseHoeEvent . java <nl> @ @ - 0 , 0 + 1 , 40 @ @ <nl> + package net . minecraftforge . event . entity . player ; <nl> + <nl> + import net . minecraft . src . EntityPlayer ; <nl> + import net . minecraft . src . ItemStack ; <nl> + import net . minecraft . src . World ; <nl> + import net . minecraftforge . event . Cancelable ; <nl> + import net . minecraftforge . event . Event ; <nl> + <nl> + @ Cancelable <nl> + @ Event . HasResult <nl> + public class UseHoeEvent extends PlayerEvent <nl> + { <nl> + / * * <nl> + * This event is fired when a player attempts to use a Hoe on a block , it <nl> + * can be canceled to completely prevent any further processing . <nl> + * <nl> + * You can also set the result to ALLOW to mark the event as processed <nl> + * and damage the hoe . <nl> + * <nl> + * setResult ( ALLOW ) is the same as the old setHandeled ( ) ; <nl> + * / <nl> + <nl> + public final ItemStack current ; <nl> + public final World world ; <nl> + public final int x ; <nl> + public final int y ; <nl> + public final int z ; <nl> + <nl> + private boolean handeled = false ; <nl> + <nl> + public UseHoeEvent ( EntityPlayer player , ItemStack current , World world , int x , int y , int z ) <nl> + { <nl> + super ( player ) ; <nl> + this . current = current ; <nl> + this . world = world ; <nl> + this . x = x ; <nl> + this . y = y ; <nl> + this . z = z ; <nl> + } <nl> + } <nl> diff - - git a / patches / common / net / minecraft / src / EntityItem . java . patch b / patches / common / net / minecraft / src / EntityItem . java . patch <nl> index a038362 . . 4e2edaf 100644 <nl> - - - a / patches / common / net / minecraft / src / EntityItem . java . patch <nl> + + + b / patches / common / net / minecraft / src / EntityItem . java . patch <nl> @ @ - 1 , 17 + 1 , 18 @ @ <nl> - - - . . / src _ base / common / net / minecraft / src / EntityItem . java <nl> + + + . . / src _ work / common / net / minecraft / src / EntityItem . java <nl> - @ @ - 1 , 6 + 1 , 10 @ @ <nl> + @ @ - 1 , 6 + 1 , 11 @ @ <nl> package net . minecraft . src ; <nl> <nl> import java . util . Iterator ; <nl> + <nl> + import net . minecraftforge . common . MinecraftForge ; <nl> + + import net . minecraftforge . event . Event . Result ; <nl> + import net . minecraftforge . event . entity . item . ItemExpireEvent ; <nl> + import net . minecraftforge . event . entity . player . EntityItemPickupEvent ; <nl> <nl> import cpw . mods . fml . common . registry . GameRegistry ; <nl> <nl> - @ @ - 20 , 6 + 24 , 11 @ @ <nl> + @ @ - 20 , 6 + 25 , 11 @ @ <nl> <nl> / * * The EntityItem ' s random initial float height . * / <nl> public float hoverStart = ( float ) ( Math . random ( ) * Math . PI * 2 . 0D ) ; <nl> @ @ - 23 , 7 + 24 , 7 @ @ <nl> <nl> public EntityItem ( World par1World , double par2 , double par4 , double par6 , ItemStack par8ItemStack ) <nl> { <nl> - @ @ - 32 , 6 + 41 , 7 @ @ <nl> + @ @ - 32 , 6 + 42 , 7 @ @ <nl> this . motionX = ( double ) ( ( float ) ( Math . random ( ) * 0 . 20000000298023224D - 0 . 10000000149011612D ) ) ; <nl> this . motionY = 0 . 20000000298023224D ; <nl> this . motionZ = ( double ) ( ( float ) ( Math . random ( ) * 0 . 20000000298023224D - 0 . 10000000149011612D ) ) ; <nl> @ @ - 31 , 7 + 32 , 7 @ @ <nl> } <nl> <nl> / * * <nl> - @ @ - 118 , 7 + 128 , 20 @ @ <nl> + @ @ - 118 , 7 + 129 , 20 @ @ <nl> <nl> + + this . age ; <nl> <nl> @ @ - 53 , 7 + 54 , 7 @ @ <nl> { <nl> this . setDead ( ) ; <nl> } <nl> - @ @ - 215 , 6 + 238 , 7 @ @ <nl> + @ @ - 215 , 6 + 239 , 7 @ @ <nl> { <nl> par1NBTTagCompound . setShort ( " Health " , ( short ) ( ( byte ) this . health ) ) ; <nl> par1NBTTagCompound . setShort ( " Age " , ( short ) this . age ) ; <nl> @ @ - 61 , 7 + 62 , 7 @ @ <nl> <nl> if ( this . item ! = null ) <nl> { <nl> - @ @ - 232 , 10 + 256 , 15 @ @ <nl> + @ @ - 232 , 10 + 257 , 15 @ @ <nl> NBTTagCompound var2 = par1NBTTagCompound . getCompoundTag ( " Item " ) ; <nl> this . item = ItemStack . loadItemStackFromNBT ( var2 ) ; <nl> <nl> @ @ - 78 , 7 + 79 , 7 @ @ <nl> } <nl> <nl> / * * <nl> - @ @ - 245 , 9 + 274 , 21 @ @ <nl> + @ @ - 245 , 9 + 275 , 21 @ @ <nl> { <nl> if ( ! this . worldObj . isRemote ) <nl> { <nl> @ @ - 97 , 7 + 98 , 7 @ @ <nl> int var2 = this . item . stackSize ; <nl> <nl> - if ( this . delayBeforeCanPickup = = 0 & & par1EntityPlayer . inventory . addItemStackToInventory ( this . item ) ) <nl> - + if ( this . delayBeforeCanPickup < = 0 & & ( event . isHandled ( ) | | var2 < = 0 | | par1EntityPlayer . inventory . addItemStackToInventory ( this . item ) ) ) <nl> + + if ( this . delayBeforeCanPickup < = 0 & & ( event . getResult ( ) = = Result . ALLOW | | var2 < = 0 | | par1EntityPlayer . inventory . addItemStackToInventory ( this . item ) ) ) <nl> { <nl> if ( this . item . itemID = = Block . wood . blockID ) <nl> { <nl> diff - - git a / patches / common / net / minecraft / src / ItemBucket . java . patch b / patches / common / net / minecraft / src / ItemBucket . java . patch <nl> index 4da9c72 . . f6b0a12 100644 <nl> - - - a / patches / common / net / minecraft / src / ItemBucket . java . patch <nl> + + + b / patches / common / net / minecraft / src / ItemBucket . java . patch <nl> @ @ - 1 , 14 + 1 , 15 @ @ <nl> - - - . . / src _ base / common / net / minecraft / src / ItemBucket . java <nl> + + + . . / src _ work / common / net / minecraft / src / ItemBucket . java <nl> - @ @ - 1 , 4 + 1 , 7 @ @ <nl> + @ @ - 1 , 4 + 1 , 8 @ @ <nl> package net . minecraft . src ; <nl> + <nl> + import net . minecraftforge . common . MinecraftForge ; <nl> + + import net . minecraftforge . event . Event ; <nl> + import net . minecraftforge . event . entity . player . FillBucketEvent ; <nl> <nl> public class ItemBucket extends Item <nl> { <nl> - @ @ - 31 , 6 + 34 , 32 @ @ <nl> + @ @ - 31 , 6 + 35 , 32 @ @ <nl> } <nl> else <nl> { <nl> @ @ - 18 , 7 + 19 , 7 @ @ <nl> + return par1ItemStack ; <nl> + } <nl> + <nl> - + if ( event . isHandeled ( ) ) <nl> + + if ( event . getResult ( ) = = Event . Result . ALLOW ) <nl> + { <nl> + if ( par3EntityPlayer . capabilities . isCreativeMode ) <nl> + { <nl> diff - - git a / patches / common / net / minecraft / src / ItemDye . java . patch b / patches / common / net / minecraft / src / ItemDye . java . patch <nl> index c8c7ef6 . . 9df29f0 100644 <nl> - - - a / patches / common / net / minecraft / src / ItemDye . java . patch <nl> + + + b / patches / common / net / minecraft / src / ItemDye . java . patch <nl> @ @ - 1 , 17 + 1 , 18 @ @ <nl> - - - . . / src _ base / common / net / minecraft / src / ItemDye . java <nl> + + + . . / src _ work / common / net / minecraft / src / ItemDye . java <nl> - @ @ - 3 , 6 + 3 , 10 @ @ <nl> + @ @ - 3 , 6 + 3 , 11 @ @ <nl> import cpw . mods . fml . common . Side ; <nl> import cpw . mods . fml . common . asm . SideOnly ; <nl> import java . util . List ; <nl> + <nl> + import net . minecraftforge . common . ForgeHooks ; <nl> + import net . minecraftforge . common . MinecraftForge ; <nl> + + import net . minecraftforge . event . Event . Result ; <nl> + import net . minecraftforge . event . entity . player . BonemealEvent ; <nl> <nl> public class ItemDye extends Item <nl> { <nl> - @ @ - 53 , 6 + 57 , 21 @ @ <nl> + @ @ - 53 , 6 + 58 , 21 @ @ <nl> if ( par1ItemStack . getItemDamage ( ) = = 15 ) <nl> { <nl> var11 = par3World . getBlockId ( par4 , par5 , par6 ) ; <nl> @ @ - 22 , 9 + 23 , 9 @ @ <nl> + return false ; <nl> + } <nl> + <nl> - + if ( event . isHandeled ( ) ) <nl> + + if ( event . getResult ( ) = = Result . ALLOW ) <nl> + { <nl> - + if ( ! par3World . isRemote ) <nl> + + if ( ! par3World . isRemote ) <nl> + { <nl> + par1ItemStack . stackSize - - ; <nl> + } <nl> @ @ - 33 , 7 + 34 , 7 @ @ <nl> <nl> if ( var11 = = Block . sapling . blockID ) <nl> { <nl> - @ @ - 152 , 16 + 171 , 9 @ @ <nl> + @ @ - 152 , 16 + 172 , 9 @ @ <nl> par3World . setBlockAndMetadataWithNotify ( var13 , var14 , var15 , Block . tallGrass . blockID , 1 ) ; <nl> } <nl> } <nl> diff - - git a / patches / common / net / minecraft / src / ItemHoe . java . patch b / patches / common / net / minecraft / src / ItemHoe . java . patch <nl> index 6565cee . . 4605d0c 100644 <nl> - - - a / patches / common / net / minecraft / src / ItemHoe . java . patch <nl> + + + b / patches / common / net / minecraft / src / ItemHoe . java . patch <nl> @ @ - 1 , 14 + 1 , 15 @ @ <nl> - - - . . / src _ base / common / net / minecraft / src / ItemHoe . java <nl> + + + . . / src _ work / common / net / minecraft / src / ItemHoe . java <nl> - @ @ - 1 , 5 + 1 , 7 @ @ <nl> + @ @ - 1 , 5 + 1 , 8 @ @ <nl> package net . minecraft . src ; <nl> <nl> + import net . minecraftforge . common . MinecraftForge ; <nl> - + import net . minecraftforge . event . entity . UseHoeEvent ; <nl> + + import net . minecraftforge . event . Event . Result ; <nl> + + import net . minecraftforge . event . entity . player . UseHoeEvent ; <nl> import cpw . mods . fml . common . Side ; <nl> import cpw . mods . fml . common . asm . SideOnly ; <nl> <nl> - @ @ - 28 , 6 + 30 , 17 @ @ <nl> + @ @ - 28 , 6 + 31 , 18 @ @ <nl> } <nl> else <nl> { <nl> @ @ - 17 , 7 + 18 , 8 @ @ <nl> + { <nl> + return false ; <nl> + } <nl> - + if ( event . isHandeled ( ) ) <nl> + + <nl> + + if ( event . getResult ( ) = = Result . ALLOW ) <nl> + { <nl> + par1ItemStack . damageItem ( 1 , par2EntityPlayer ) ; <nl> + return true ; <nl> diff - - git a / patches / common / net / minecraft / src / SpawnerAnimals . java . patch b / patches / common / net / minecraft / src / SpawnerAnimals . java . patch <nl> index f5726b9 . . fffe071 100644 <nl> - - - a / patches / common / net / minecraft / src / SpawnerAnimals . java . patch <nl> + + + b / patches / common / net / minecraft / src / SpawnerAnimals . java . patch <nl> @ @ - 35 , 13 + 35 , 11 @ @ <nl> } <nl> } <nl> <nl> - @ @ - 216 , 6 + 225 , 13 @ @ <nl> + @ @ - 216 , 6 + 225 , 11 @ @ <nl> * / <nl> private static void creatureSpecificInit ( EntityLiving par0EntityLiving , World par1World , float par2 , float par3 , float par4 ) <nl> { <nl> - + LivingSpecialSpawnEvent event = new LivingSpecialSpawnEvent ( par0EntityLiving , par1World , par2 , par3 , par4 ) ; <nl> - + MinecraftForge . EVENT _ BUS . post ( event ) ; <nl> - + if ( event . isHandeled ( ) ) <nl> + + if ( MinecraftForge . EVENT _ BUS . post ( new LivingSpecialSpawnEvent ( par0EntityLiving , par1World , par2 , par3 , par4 ) ) ) <nl> + { <nl> + return ; <nl> + }

TEST DIFF:
diff - - git a / patches / minecraft / net / minecraft / world / storage / loot / LootTableManager . java . patch b / patches / minecraft / net / minecraft / world / storage / loot / LootTableManager . java . patch 
 index 8aaf224 . . 8aa0caf 100644 
 - - - a / patches / minecraft / net / minecraft / world / storage / loot / LootTableManager . java . patch 
 + + + b / patches / minecraft / net / minecraft / world / storage / loot / LootTableManager . java . patch 
 @ @ - 5 , 7 + 5 , 7 @ @ 
 try 
 { 
 - return ( LootTable ) LootTableManager . field _ 186526 _ b . fromJson ( s , LootTable . class ) ; 
 - + return net . minecraftforge . common . ForgeHooks . loadLootTable ( LootTableManager . field _ 186526 _ b , p _ 186517 _ 1 _ , s , true ) ; 
 + + return net . minecraftforge . common . ForgeHooks . loadLootTable ( LootTableManager . field _ 186526 _ b , p _ 186517 _ 1 _ , s , true , LootTableManager . this ) ; 
 } 
 catch ( JsonParseException jsonparseexception ) 
 { 
 @ @ - 14 , 7 + 14 , 7 @ @ 
 try 
 { 
 - return ( LootTable ) LootTableManager . field _ 186526 _ b . fromJson ( s , LootTable . class ) ; 
 - + return net . minecraftforge . common . ForgeHooks . loadLootTable ( LootTableManager . field _ 186526 _ b , p _ 186518 _ 1 _ , s , false ) ; 
 + + return net . minecraftforge . common . ForgeHooks . loadLootTable ( LootTableManager . field _ 186526 _ b , p _ 186518 _ 1 _ , s , false , LootTableManager . this ) ; 
 } 
 catch ( JsonParseException jsonparseexception ) 
 { 
 diff - - git a / src / main / java / net / minecraftforge / common / ForgeHooks . java b / src / main / java / net / minecraftforge / common / ForgeHooks . java 
 index 4fa6049 . . c15f298 100644 
 - - - a / src / main / java / net / minecraftforge / common / ForgeHooks . java 
 + + + b / src / main / java / net / minecraftforge / common / ForgeHooks . java 
 @ @ - 93 , 6 + 93 , 7 @ @ import net . minecraft . world . EnumDifficulty ; 
 import net . minecraft . world . GameType ; 
 import net . minecraft . world . storage . loot . LootEntry ; 
 import net . minecraft . world . storage . loot . LootTable ; 
 + import net . minecraft . world . storage . loot . LootTableManager ; 
 import net . minecraft . world . storage . loot . conditions . LootCondition ; 
 import net . minecraftforge . common . util . BlockSnapshot ; 
 import net . minecraftforge . event . AnvilUpdateEvent ; 
 @ @ - 1092 , 14 + 1093 , 22 @ @ public class ForgeHooks 
 LootTableContext ctx = lootContext . get ( ) . peek ( ) ; 
 
 if ( ctx = = null ) 
 - throw new JsonParseException ( " Invalid call stack , could to grab json context ! " ) ; / / Show I throw this ? Do we care about custom deserializers outside the manager ? 
 + throw new JsonParseException ( " Invalid call stack , could not grab json context ! " ) ; / / Should I throw this ? Do we care about custom deserializers outside the manager ? 
 
 return ctx ; 
 } 
 
 - @ Nullable 
 + / / TODO : remove 
 + / * * @ deprecated use { @ link ForgeHooks # loadLootTable ( Gson , ResourceLocation , String , boolean , LootTableManager ) } * / 
 + @ Deprecated 
 public static LootTable loadLootTable ( Gson gson , ResourceLocation name , String data , boolean custom ) 
 { 
 + return loadLootTable ( gson , name , data , custom , null ) ; 
 + } 
 + 
 + @ Nullable 
 + public static LootTable loadLootTable ( Gson gson , ResourceLocation name , String data , boolean custom , LootTableManager lootTableManager ) 
 + { 
 Deque < LootTableContext > que = lootContext . get ( ) ; 
 if ( que = = null ) 
 { 
 @ @ - 1121 , 7 + 1130 , 7 @ @ public class ForgeHooks 
 } 
 
 if ( ! custom ) 
 - ret = ForgeEventFactory . loadLootTable ( name , ret ) ; 
 + ret = ForgeEventFactory . loadLootTable ( name , ret , lootTableManager ) ; 
 
 if ( ret ! = null ) 
 ret . freeze ( ) ; 
 diff - - git a / src / main / java / net / minecraftforge / event / ForgeEventFactory . java b / src / main / java / net / minecraftforge / event / ForgeEventFactory . java 
 index 238a886 . . 1646e84 100644 
 - - - a / src / main / java / net / minecraftforge / event / ForgeEventFactory . java 
 + + + b / src / main / java / net / minecraftforge / event / ForgeEventFactory . java 
 @ @ - 64 , 6 + 64 , 7 @ @ import net . minecraft . world . chunk . IChunkGenerator ; 
 import net . minecraft . world . storage . IPlayerFileData ; 
 import net . minecraft . world . storage . SaveHandler ; 
 import net . minecraft . world . storage . loot . LootTable ; 
 + import net . minecraft . world . storage . loot . LootTableManager ; 
 import net . minecraftforge . client . event . ClientChatEvent ; 
 import net . minecraftforge . client . event . ClientChatReceivedEvent ; 
 import net . minecraftforge . client . event . RenderBlockOverlayEvent ; 
 @ @ - 645 , 9 + 646 , 18 @ @ public class ForgeEventFactory 
 MinecraftForge . EVENT _ BUS . post ( pre ? new PopulateChunkEvent . Pre ( gen , world , rand , x , z , hasVillageGenerated ) : new PopulateChunkEvent . Post ( gen , world , rand , x , z , hasVillageGenerated ) ) ; 
 } 
 
 + / * * 
 + * @ deprecated Use { @ link # loadLootTable ( ResourceLocation , LootTable , LootTableManager ) } < br > 
 + * / 
 + @ Deprecated 
 public static LootTable loadLootTable ( ResourceLocation name , LootTable table ) 
 { 
 - LootTableLoadEvent event = new LootTableLoadEvent ( name , table ) ; 
 + return loadLootTable ( name , table , null ) ; 
 + } 
 + 
 + public static LootTable loadLootTable ( ResourceLocation name , LootTable table , LootTableManager lootTableManager ) 
 + { 
 + LootTableLoadEvent event = new LootTableLoadEvent ( name , table , lootTableManager ) ; 
 if ( MinecraftForge . EVENT _ BUS . post ( event ) ) 
 return LootTable . EMPTY _ LOOT _ TABLE ; 
 return event . getTable ( ) ; 
 diff - - git a / src / main / java / net / minecraftforge / event / LootTableLoadEvent . java b / src / main / java / net / minecraftforge / event / LootTableLoadEvent . java 
 index b190077 . . 0f6dc1b 100644 
 - - - a / src / main / java / net / minecraftforge / event / LootTableLoadEvent . java 
 + + + b / src / main / java / net / minecraftforge / event / LootTableLoadEvent . java 
 @ @ - 21 , 6 + 21 , 7 @ @ package net . minecraftforge . event ; 
 
 import net . minecraft . util . ResourceLocation ; 
 import net . minecraft . world . storage . loot . LootTable ; 
 + import net . minecraft . world . storage . loot . LootTableManager ; 
 import net . minecraftforge . fml . common . eventhandler . Cancelable ; 
 import net . minecraftforge . fml . common . eventhandler . Event ; 
 
 @ @ - 38 , 11 + 39 , 21 @ @ public class LootTableLoadEvent extends Event 
 { 
 private final ResourceLocation name ; 
 private LootTable table ; 
 + private LootTableManager lootTableManager ; 
 
 - public LootTableLoadEvent ( ResourceLocation name , LootTable table ) 
 + / * * 
 + * @ deprecated Use { @ link # LootTableLoadEvent ( ResourceLocation , LootTable , LootTableManager ) } < br > 
 + * / 
 + @ Deprecated 
 + public LootTableLoadEvent ( ResourceLocation name , LootTable table ) { 
 + this ( name , table , null ) ; 
 + } 
 + 
 + public LootTableLoadEvent ( ResourceLocation name , LootTable table , LootTableManager lootTableManager ) 
 { 
 this . name = name ; 
 this . table = table ; 
 + this . lootTableManager = lootTableManager ; 
 } 
 
 public ResourceLocation getName ( ) 
 @ @ - 55 , 6 + 66 , 11 @ @ public class LootTableLoadEvent extends Event 
 return this . table ; 
 } 
 
 + public LootTableManager getLootTableManager ( ) 
 + { 
 + return this . lootTableManager ; 
 + } 
 + 
 public void setTable ( LootTable table ) 
 { 
 this . table = table ; 
 diff - - git a / src / test / java / net / minecraftforge / test / LootTableLoadEventTest . java b / src / test / java / net / minecraftforge / test / LootTableLoadEventTest . java 
 new file mode 100644 
 index 0000000 . . aa544ae 
 - - - / dev / null 
 + + + b / src / test / java / net / minecraftforge / test / LootTableLoadEventTest . java 
 @ @ - 0 , 0 + 1 , 32 @ @ 
 + package net . minecraftforge . test ; 
 + 
 + import net . minecraft . util . ResourceLocation ; 
 + import net . minecraft . world . storage . loot . LootTable ; 
 + import net . minecraft . world . storage . loot . LootTableList ; 
 + import net . minecraftforge . common . MinecraftForge ; 
 + import net . minecraftforge . event . LootTableLoadEvent ; 
 + import net . minecraftforge . fml . common . Mod ; 
 + import net . minecraftforge . fml . common . Mod . EventHandler ; 
 + import net . minecraftforge . fml . common . event . FMLInitializationEvent ; 
 + import net . minecraftforge . fml . common . eventhandler . SubscribeEvent ; 
 + 
 + @ Mod ( modid = LootTableLoadEventTest . MODID , name = " LootTableLoadEventTest " , version = " 1 . 0 " , acceptableRemoteVersions = " * " ) 
 + public class LootTableLoadEventTest { 
 + public static final String MODID = " loottable _ load _ event _ test " ; 
 + 
 + @ EventHandler 
 + public void init ( FMLInitializationEvent event ) 
 + { 
 + MinecraftForge . EVENT _ BUS . register ( this ) ; 
 + } 
 + 
 + @ SubscribeEvent 
 + public void onLootTableLoadEvent ( LootTableLoadEvent event ) 
 + { 
 + if ( LootTableList . CHESTS _ SPAWN _ BONUS _ CHEST . equals ( event . getName ( ) ) ) { 
 + ResourceLocation loc = new ResourceLocation ( MODID , " chests / custom _ spawn _ bonus _ chest " ) ; 
 + LootTable customLootTable = event . getLootTableManager ( ) . getLootTableFromLocation ( loc ) ; 
 + event . setTable ( customLootTable ) ; 
 + } 
 + } 
 + } 
 diff - - git a / src / test / resources / assets / loottable _ load _ event _ test / loot _ tables / chests / custom _ spawn _ bonus _ chest . json b / src / test / resources / assets / loottable _ load _ event _ test / loot _ tables / chests / custom _ spawn _ bonus _ chest . json 
 new file mode 100644 
 index 0000000 . . 60fdd88 
 - - - / dev / null 
 + + + b / src / test / resources / assets / loottable _ load _ event _ test / loot _ tables / chests / custom _ spawn _ bonus _ chest . json 
 @ @ - 0 , 0 + 1 , 146 @ @ 
 + { 
 + " pools " : [ 
 + { 
 + " name " : " custom - spawn - chest - 1 " , 
 + " rolls " : 1 , 
 + " entries " : [ 
 + { 
 + " type " : " item " , 
 + " name " : " minecraft : diamond _ axe " , 
 + " weight " : 1 
 + } , 
 + { 
 + " type " : " item " , 
 + " name " : " minecraft : iron _ axe " , 
 + " weight " : 3 
 + } 
 + ] 
 + } , 
 + { 
 + " name " : " custom - spawn - chest - 2 " , 
 + " rolls " : 1 , 
 + " entries " : [ 
 + { 
 + " type " : " item " , 
 + " name " : " minecraft : diamond _ pickaxe " , 
 + " weight " : 1 
 + } , 
 + { 
 + " type " : " item " , 
 + " name " : " minecraft : iron _ pickaxe " , 
 + " weight " : 3 
 + } 
 + ] 
 + } , 
 + { 
 + " name " : " custom - spawn - chest - 3 " , 
 + " rolls " : 3 , 
 + " entries " : [ 
 + { 
 + " type " : " item " , 
 + " name " : " minecraft : golden _ apple " , 
 + " weight " : 5 , 
 + " functions " : [ 
 + { 
 + " function " : " minecraft : set _ count " , 
 + " count " : { 
 + " min " : 1 , 
 + " max " : 2 
 + } 
 + } 
 + ] 
 + } , 
 + { 
 + " type " : " item " , 
 + " name " : " minecraft : beef " , 
 + " weight " : 3 , 
 + " functions " : [ 
 + { 
 + " function " : " minecraft : set _ count " , 
 + " count " : { 
 + " min " : 1 , 
 + " max " : 2 
 + } 
 + } 
 + ] 
 + } 
 + ] 
 + } , 
 + { 
 + " name " : " custom - spawn - chest - 4 " , 
 + " rolls " : 4 , 
 + " entries " : [ 
 + { 
 + " type " : " item " , 
 + " name " : " minecraft : stick " , 
 + " weight " : 10 , 
 + " functions " : [ 
 + { 
 + " function " : " minecraft : set _ count " , 
 + " count " : { 
 + " min " : 1 , 
 + " max " : 24 
 + } 
 + } 
 + ] 
 + } , 
 + { 
 + " type " : " item " , 
 + " name " : " minecraft : planks " , 
 + " weight " : 10 , 
 + " functions " : [ 
 + { 
 + " function " : " minecraft : set _ count " , 
 + " count " : { 
 + " min " : 1 , 
 + " max " : 24 
 + } 
 + } 
 + ] 
 + } , 
 + { 
 + " type " : " item " , 
 + " name " : " minecraft : log " , 
 + " weight " : 10 , 
 + " functions " : [ 
 + { 
 + " function " : " minecraft : set _ count " , 
 + " count " : { 
 + " min " : 1 , 
 + " max " : 3 
 + } 
 + } , 
 + { 
 + " function " : " minecraft : set _ data " , 
 + " data " : { 
 + " min " : 0 , 
 + " max " : 3 
 + } 
 + } 
 + ] 
 + } , 
 + { 
 + " type " : " item " , 
 + " name " : " minecraft : log2 " , 
 + " weight " : 10 , 
 + " functions " : [ 
 + { 
 + " function " : " minecraft : set _ count " , 
 + " count " : { 
 + " min " : 1 , 
 + " max " : 3 
 + } 
 + } , 
 + { 
 + " function " : " minecraft : set _ data " , 
 + " data " : { 
 + " min " : 0 , 
 + " max " : 1 
 + } 
 + } 
 + ] 
 + } 
 + ] 
 + } 
 + ] 
 + } 
 \ No newline at end of file

NEAREST DIFF:
diff - - git a / common / net / minecraftforge / event / Event . java b / common / net / minecraftforge / event / Event . java 
 index 15947ca . . bd530ae 100644 
 - - - a / common / net / minecraftforge / event / Event . java 
 + + + b / common / net / minecraftforge / event / Event . java 
 @ @ - 1 , 11 + 1 , 21 @ @ 
 package net . minecraftforge . event ; 
 
 + import static java . lang . annotation . ElementType . TYPE ; 
 + import static java . lang . annotation . RetentionPolicy . RUNTIME ; 
 + 
 + import java . lang . annotation . Retention ; 
 + import java . lang . annotation . Target ; 
 + 
 
 / * * 
 * Base Event class that all other events are derived from 
 * / 
 public class Event 
 { 
 + @ Retention ( value = RUNTIME ) 
 + @ Target ( value = TYPE ) 
 + public @ interface HasResult { } 
 + 
 public enum Result 
 { 
 DENY , 
 @ @ - 15 , 25 + 25 , 31 @ @ public class Event 
 
 private boolean isCanceled = false ; 
 private final boolean isCancelable ; 
 + private Result result = Result . DEFAULT ; 
 + private final boolean hasResult ; 
 private static ListenerList listeners = new ListenerList ( ) ; 
 
 public Event ( ) 
 { 
 setup ( ) ; 
 + isCancelable = hasAnnotation ( Cancelable . class ) ; 
 + hasResult = hasAnnotation ( HasResult . class ) ; 
 + } 
 + 
 + private boolean hasAnnotation ( Class annotation ) 
 + { 
 Class cls = this . getClass ( ) ; 
 - boolean found = false ; 
 while ( cls ! = Event . class ) 
 { 
 if ( cls . isAnnotationPresent ( Cancelable . class ) ) 
 { 
 - found = true ; 
 - break ; 
 + return true ; 
 } 
 cls = cls . getSuperclass ( ) ; 
 } 
 - isCancelable = found ; 
 + return false ; 
 } 
 - 
 + 
 / * * 
 * Determine if this function is cancelable at all . 
 * @ return If access to setCanceled should be allowed 
 @ @ - 42 , 7 + 58 , 7 @ @ public class Event 
 { 
 return isCancelable ; 
 } 
 - 
 + 
 / * * 
 * Determine if this event is canceled and should stop executing . 
 * @ return The current canceled state 
 @ @ - 51 , 7 + 67 , 7 @ @ public class Event 
 { 
 return isCanceled ; 
 } 
 - 
 + 
 / * * 
 * Sets the state of this event , not all events are cancelable , and any attempt to 
 * cancel a event that can ' t be will result in a IllegalArgumentException . 
 @ @ - 68 , 7 + 84 , 35 @ @ public class Event 
 } 
 isCanceled = cancel ; 
 } 
 - 
 + 
 + / * * 
 + * Determines if this event expects a significant result value . 
 + * / 
 + public boolean hasResult ( ) 
 + { 
 + return hasResult ; 
 + } 
 + 
 + / * * 
 + * Returns the value set as the result of this event 
 + * / 
 + public Result getResult ( ) 
 + { 
 + return result ; 
 + } 
 + 
 + / * * 
 + * Sets the result value for this event , not all events can have a result set , and any attempt to 
 + * set a result for a event that isn ' t expecting it will result in a IllegalArgumentException . 
 + * 
 + * The functionality of setting the result is defined on a per - event bases . 
 + * 
 + * @ param value The new result 
 + * / 
 + public void setResult ( Result value ) 
 + { 
 + result = value ; 
 + } 
 / * * 
 * Called by the base constructor , this is used by ASM generated 
 * event classes to setup various functionality such as the listener ' s list . 
 diff - - git a / common / net / minecraftforge / event / entity / UseHoeEvent . java b / common / net / minecraftforge / event / entity / UseHoeEvent . java 
 deleted file mode 100644 
 index c012c91 . . 0000000 
 - - - a / common / net / minecraftforge / event / entity / UseHoeEvent . java 
 + + + / dev / null 
 @ @ - 1 , 40 + 0 , 0 @ @ 
 - package net . minecraftforge . event . entity ; 
 - 
 - import net . minecraft . src . EntityPlayer ; 
 - import net . minecraft . src . ItemStack ; 
 - import net . minecraft . src . World ; 
 - import net . minecraftforge . event . Cancelable ; 
 - import net . minecraftforge . event . entity . player . PlayerEvent ; 
 - 
 - @ Cancelable 
 - public class UseHoeEvent extends PlayerEvent 
 - { 
 - 
 - public final ItemStack current ; 
 - public final World world ; 
 - public final int x ; 
 - public final int y ; 
 - public final int z ; 
 - 
 - private boolean handeled = false ; 
 - 
 - public UseHoeEvent ( EntityPlayer player , ItemStack current , World world , int x , int y , int z ) 
 - { 
 - super ( player ) ; 
 - this . current = current ; 
 - this . world = world ; 
 - this . x = x ; 
 - this . y = y ; 
 - this . z = z ; 
 - } 
 - 
 - public boolean isHandeled ( ) 
 - { 
 - return handeled ; 
 - } 
 - 
 - public void setHandeled ( ) 
 - { 
 - handeled = true ; 
 - } 
 - } 
 diff - - git a / common / net / minecraftforge / event / entity / living / LivingSpecialSpawnEvent . java b / common / net / minecraftforge / event / entity / living / LivingSpecialSpawnEvent . java 
 index f6e555e . . 2186967 100644 
 - - - a / common / net / minecraftforge / event / entity / living / LivingSpecialSpawnEvent . java 
 + + + b / common / net / minecraftforge / event / entity / living / LivingSpecialSpawnEvent . java 
 @ @ - 2 , 7 + 2 , 9 @ @ package net . minecraftforge . event . entity . living ; 
 
 import net . minecraft . src . EntityLiving ; 
 import net . minecraft . src . World ; 
 + import net . minecraftforge . event . Cancelable ; 
 
 + @ Cancelable 
 public class LivingSpecialSpawnEvent extends LivingEvent 
 { 
 public final World world ; 
 @ @ - 19 , 14 + 21 , 4 @ @ public class LivingSpecialSpawnEvent extends LivingEvent 
 this . y = y ; 
 this . z = z ; 
 } 
 - 
 - public void setHandeled ( ) 
 - { 
 - handeled = true ; 
 - } 
 - 
 - public boolean isHandeled ( ) 
 - { 
 - return handeled ; 
 - } 
 } 
 diff - - git a / common / net / minecraftforge / event / entity / player / BonemealEvent . java b / common / net / minecraftforge / event / entity / player / BonemealEvent . java 
 index 8126d71 . . 894d431 100644 
 - - - a / common / net / minecraftforge / event / entity / player / BonemealEvent . java 
 + + + b / common / net / minecraftforge / event / entity / player / BonemealEvent . java 
 @ @ - 3 , 16 + 3 , 27 @ @ package net . minecraftforge . event . entity . player ; 
 import net . minecraft . src . EntityPlayer ; 
 import net . minecraft . src . World ; 
 import net . minecraftforge . event . Cancelable ; 
 + import net . minecraftforge . event . Event ; 
 
 @ Cancelable 
 + @ Event . HasResult 
 public class BonemealEvent extends PlayerEvent 
 { 
 + / * * 
 + * This event is called when a player attempts to use Bonemeal on a block . 
 + * It can be canceled to completely prevent any further processing . 
 + * 
 + * You can also set the result to ALLOW to mark the event as processed 
 + * and use up a bonemeal from the stack but do no further processing . 
 + * 
 + * setResult ( ALLOW ) is the same as the old setHandeled ( ) 
 + * / 
 + 
 public final World world ; 
 public final int ID ; 
 public final int X ; 
 public final int Y ; 
 public final int Z ; 
 - private boolean handeled = false ; 
 
 public BonemealEvent ( EntityPlayer player , World world , int id , int x , int y , int z ) 
 { 
 @ @ - 23 , 14 + 34 , 4 @ @ public class BonemealEvent extends PlayerEvent 
 this . Y = y ; 
 this . Z = z ; 
 } 
 - 
 - public void setHandeled ( ) 
 - { 
 - handeled = true ; 
 - } 
 - 
 - public boolean isHandeled ( ) 
 - { 
 - return handeled ; 
 - } 
 } 
 diff - - git a / common / net / minecraftforge / event / entity / player / EntityItemPickupEvent . java b / common / net / minecraftforge / event / entity / player / EntityItemPickupEvent . java 
 index 5d2156e . . 8a690dc 100644 
 - - - a / common / net / minecraftforge / event / entity / player / EntityItemPickupEvent . java 
 + + + b / common / net / minecraftforge / event / entity / player / EntityItemPickupEvent . java 
 @ @ - 4 , 26 + 4 , 29 @ @ import net . minecraft . src . Entity ; 
 import net . minecraft . src . EntityItem ; 
 import net . minecraft . src . EntityPlayer ; 
 import net . minecraftforge . event . Cancelable ; 
 + import net . minecraftforge . event . Event ; 
 
 @ Cancelable 
 + @ Event . HasResult 
 public class EntityItemPickupEvent extends PlayerEvent 
 { 
 + / * * 
 + * This event is called when a player collides with a EntityItem on the ground . 
 + * The event can be canceled , and no further processing will be done . 
 + * 
 + * You can set the result of this event to ALLOW which will trigger the 
 + * processing of achievements , FML ' s event , play the sound , and kill the 
 + * entity if all the items are picked up . 
 + * 
 + * setResult ( ALLOW ) is the same as the old setHandled ( ) 
 + * / 
 + 
 public final EntityItem item ; 
 private boolean handled = false ; 
 - 
 + 
 public EntityItemPickupEvent ( EntityPlayer player , EntityItem item ) 
 { 
 super ( player ) ; 
 this . item = item ; 
 } 
 - 
 - public boolean isHandled ( ) 
 - { 
 - return handled ; 
 - } 
 - 
 - public void setHandled ( ) 
 - { 
 - handled = true ; 
 - } 
 } 
 diff - - git a / common / net / minecraftforge / event / entity / player / FillBucketEvent . java b / common / net / minecraftforge / event / entity / player / FillBucketEvent . java 
 index c110fba . . e09b454 100644 
 - - - a / common / net / minecraftforge / event / entity / player / FillBucketEvent . java 
 + + + b / common / net / minecraftforge / event / entity / player / FillBucketEvent . java 
 @ @ - 5 , 17 + 5 , 28 @ @ import net . minecraft . src . ItemStack ; 
 import net . minecraft . src . MovingObjectPosition ; 
 import net . minecraft . src . World ; 
 import net . minecraftforge . event . Cancelable ; 
 + import net . minecraftforge . event . Event ; 
 
 @ Cancelable 
 + @ Event . HasResult 
 public class FillBucketEvent extends PlayerEvent 
 { 
 + / * * 
 + * This event is fired when a player attempts to use a Empty bucket , it 
 + * can be canceled to completely prevent any further processing . 
 + * 
 + * If you set the result to ' ALLOW ' , it means that you have processed 
 + * the event and wants the basic functionality of adding the new 
 + * ItemStack to your inventory and reducing the stack size to process . 
 + * setResult ( ALLOW ) is the same as the old setHandeled ( ) ; 
 + * / 
 + 
 public final ItemStack current ; 
 public final World world ; 
 public final MovingObjectPosition target ; 
 - 
 + 
 public ItemStack result ; 
 - private boolean handeled = false ; 
 - 
 + 
 public FillBucketEvent ( EntityPlayer player , ItemStack current , World world , MovingObjectPosition target ) 
 { 
 super ( player ) ; 
 @ @ - 23 , 14 + 34 , 4 @ @ public class FillBucketEvent extends PlayerEvent 
 this . world = world ; 
 this . target = target ; 
 } 
 - 
 - public boolean isHandeled ( ) 
 - { 
 - return handeled ; 
 - } 
 - 
 - public void setHandeled ( ) 
 - { 
 - handeled = true ; 
 - } 
 } 
 diff - - git a / common / net / minecraftforge / event / entity / player / UseHoeEvent . java b / common / net / minecraftforge / event / entity / player / UseHoeEvent . java 
 new file mode 100644 
 index 0000000 . . ac8793b 
 - - - / dev / null 
 + + + b / common / net / minecraftforge / event / entity / player / UseHoeEvent . java 
 @ @ - 0 , 0 + 1 , 40 @ @ 
 + package net . minecraftforge . event . entity . player ; 
 + 
 + import net . minecraft . src . EntityPlayer ; 
 + import net . minecraft . src . ItemStack ; 
 + import net . minecraft . src . World ; 
 + import net . minecraftforge . event . Cancelable ; 
 + import net . minecraftforge . event . Event ; 
 + 
 + @ Cancelable 
 + @ Event . HasResult 
 + public class UseHoeEvent extends PlayerEvent 
 + { 
 + / * * 
 + * This event is fired when a player attempts to use a Hoe on a block , it 
 + * can be canceled to completely prevent any further processing . 
 + * 
 + * You can also set the result to ALLOW to mark the event as processed 
 + * and damage the hoe . 
 + * 
 + * setResult ( ALLOW ) is the same as the old setHandeled ( ) ; 
 + * / 
 + 
 + public final ItemStack current ; 
 + public final World world ; 
 + public final int x ; 
 + public final int y ; 
 + public final int z ; 
 + 
 + private boolean handeled = false ; 
 + 
 + public UseHoeEvent ( EntityPlayer player , ItemStack current , World world , int x , int y , int z ) 
 + { 
 + super ( player ) ; 
 + this . current = current ; 
 + this . world = world ; 
 + this . x = x ; 
 + this . y = y ; 
 + this . z = z ; 
 + } 
 + } 
 diff - - git a / patches / common / net / minecraft / src / EntityItem . java . patch b / patches / common / net / minecraft / src / EntityItem . java . patch 
 index a038362 . . 4e2edaf 100644 
 - - - a / patches / common / net / minecraft / src / EntityItem . java . patch 
 + + + b / patches / common / net / minecraft / src / EntityItem . java . patch 
 @ @ - 1 , 17 + 1 , 18 @ @ 
 - - - . . / src _ base / common / net / minecraft / src / EntityItem . java 
 + + + . . / src _ work / common / net / minecraft / src / EntityItem . java 
 - @ @ - 1 , 6 + 1 , 10 @ @ 
 + @ @ - 1 , 6 + 1 , 11 @ @ 
 package net . minecraft . src ; 
 
 import java . util . Iterator ; 
 + 
 + import net . minecraftforge . common . MinecraftForge ; 
 + + import net . minecraftforge . event . Event . Result ; 
 + import net . minecraftforge . event . entity . item . ItemExpireEvent ; 
 + import net . minecraftforge . event . entity . player . EntityItemPickupEvent ; 
 
 import cpw . mods . fml . common . registry . GameRegistry ; 
 
 - @ @ - 20 , 6 + 24 , 11 @ @ 
 + @ @ - 20 , 6 + 25 , 11 @ @ 
 
 / * * The EntityItem ' s random initial float height . * / 
 public float hoverStart = ( float ) ( Math . random ( ) * Math . PI * 2 . 0D ) ; 
 @ @ - 23 , 7 + 24 , 7 @ @ 
 
 public EntityItem ( World par1World , double par2 , double par4 , double par6 , ItemStack par8ItemStack ) 
 { 
 - @ @ - 32 , 6 + 41 , 7 @ @ 
 + @ @ - 32 , 6 + 42 , 7 @ @ 
 this . motionX = ( double ) ( ( float ) ( Math . random ( ) * 0 . 20000000298023224D - 0 . 10000000149011612D ) ) ; 
 this . motionY = 0 . 20000000298023224D ; 
 this . motionZ = ( double ) ( ( float ) ( Math . random ( ) * 0 . 20000000298023224D - 0 . 10000000149011612D ) ) ; 
 @ @ - 31 , 7 + 32 , 7 @ @ 
 } 
 
 / * * 
 - @ @ - 118 , 7 + 128 , 20 @ @ 
 + @ @ - 118 , 7 + 129 , 20 @ @ 
 
 + + this . age ; 
 
 @ @ - 53 , 7 + 54 , 7 @ @ 
 { 
 this . setDead ( ) ; 
 } 
 - @ @ - 215 , 6 + 238 , 7 @ @ 
 + @ @ - 215 , 6 + 239 , 7 @ @ 
 { 
 par1NBTTagCompound . setShort ( " Health " , ( short ) ( ( byte ) this . health ) ) ; 
 par1NBTTagCompound . setShort ( " Age " , ( short ) this . age ) ; 
 @ @ - 61 , 7 + 62 , 7 @ @ 
 
 if ( this . item ! = null ) 
 { 
 - @ @ - 232 , 10 + 256 , 15 @ @ 
 + @ @ - 232 , 10 + 257 , 15 @ @ 
 NBTTagCompound var2 = par1NBTTagCompound . getCompoundTag ( " Item " ) ; 
 this . item = ItemStack . loadItemStackFromNBT ( var2 ) ; 
 
 @ @ - 78 , 7 + 79 , 7 @ @ 
 } 
 
 / * * 
 - @ @ - 245 , 9 + 274 , 21 @ @ 
 + @ @ - 245 , 9 + 275 , 21 @ @ 
 { 
 if ( ! this . worldObj . isRemote ) 
 { 
 @ @ - 97 , 7 + 98 , 7 @ @ 
 int var2 = this . item . stackSize ; 
 
 - if ( this . delayBeforeCanPickup = = 0 & & par1EntityPlayer . inventory . addItemStackToInventory ( this . item ) ) 
 - + if ( this . delayBeforeCanPickup < = 0 & & ( event . isHandled ( ) | | var2 < = 0 | | par1EntityPlayer . inventory . addItemStackToInventory ( this . item ) ) ) 
 + + if ( this . delayBeforeCanPickup < = 0 & & ( event . getResult ( ) = = Result . ALLOW | | var2 < = 0 | | par1EntityPlayer . inventory . addItemStackToInventory ( this . item ) ) ) 
 { 
 if ( this . item . itemID = = Block . wood . blockID ) 
 { 
 diff - - git a / patches / common / net / minecraft / src / ItemBucket . java . patch b / patches / common / net / minecraft / src / ItemBucket . java . patch 
 index 4da9c72 . . f6b0a12 100644 
 - - - a / patches / common / net / minecraft / src / ItemBucket . java . patch 
 + + + b / patches / common / net / minecraft / src / ItemBucket . java . patch 
 @ @ - 1 , 14 + 1 , 15 @ @ 
 - - - . . / src _ base / common / net / minecraft / src / ItemBucket . java 
 + + + . . / src _ work / common / net / minecraft / src / ItemBucket . java 
 - @ @ - 1 , 4 + 1 , 7 @ @ 
 + @ @ - 1 , 4 + 1 , 8 @ @ 
 package net . minecraft . src ; 
 + 
 + import net . minecraftforge . common . MinecraftForge ; 
 + + import net . minecraftforge . event . Event ; 
 + import net . minecraftforge . event . entity . player . FillBucketEvent ; 
 
 public class ItemBucket extends Item 
 { 
 - @ @ - 31 , 6 + 34 , 32 @ @ 
 + @ @ - 31 , 6 + 35 , 32 @ @ 
 } 
 else 
 { 
 @ @ - 18 , 7 + 19 , 7 @ @ 
 + return par1ItemStack ; 
 + } 
 + 
 - + if ( event . isHandeled ( ) ) 
 + + if ( event . getResult ( ) = = Event . Result . ALLOW ) 
 + { 
 + if ( par3EntityPlayer . capabilities . isCreativeMode ) 
 + { 
 diff - - git a / patches / common / net / minecraft / src / ItemDye . java . patch b / patches / common / net / minecraft / src / ItemDye . java . patch 
 index c8c7ef6 . . 9df29f0 100644 
 - - - a / patches / common / net / minecraft / src / ItemDye . java . patch 
 + + + b / patches / common / net / minecraft / src / ItemDye . java . patch 
 @ @ - 1 , 17 + 1 , 18 @ @ 
 - - - . . / src _ base / common / net / minecraft / src / ItemDye . java 
 + + + . . / src _ work / common / net / minecraft / src / ItemDye . java 
 - @ @ - 3 , 6 + 3 , 10 @ @ 
 + @ @ - 3 , 6 + 3 , 11 @ @ 
 import cpw . mods . fml . common . Side ; 
 import cpw . mods . fml . common . asm . SideOnly ; 
 import java . util . List ; 
 + 
 + import net . minecraftforge . common . ForgeHooks ; 
 + import net . minecraftforge . common . MinecraftForge ; 
 + + import net . minecraftforge . event . Event . Result ; 
 + import net . minecraftforge . event . entity . player . BonemealEvent ; 
 
 public class ItemDye extends Item 
 { 
 - @ @ - 53 , 6 + 57 , 21 @ @ 
 + @ @ - 53 , 6 + 58 , 21 @ @ 
 if ( par1ItemStack . getItemDamage ( ) = = 15 ) 
 { 
 var11 = par3World . getBlockId ( par4 , par5 , par6 ) ; 
 @ @ - 22 , 9 + 23 , 9 @ @ 
 + return false ; 
 + } 
 + 
 - + if ( event . isHandeled ( ) ) 
 + + if ( event . getResult ( ) = = Result . ALLOW ) 
 + { 
 - + if ( ! par3World . isRemote ) 
 + + if ( ! par3World . isRemote ) 
 + { 
 + par1ItemStack . stackSize - - ; 
 + } 
 @ @ - 33 , 7 + 34 , 7 @ @ 
 
 if ( var11 = = Block . sapling . blockID ) 
 { 
 - @ @ - 152 , 16 + 171 , 9 @ @ 
 + @ @ - 152 , 16 + 172 , 9 @ @ 
 par3World . setBlockAndMetadataWithNotify ( var13 , var14 , var15 , Block . tallGrass . blockID , 1 ) ; 
 } 
 } 
 diff - - git a / patches / common / net / minecraft / src / ItemHoe . java . patch b / patches / common / net / minecraft / src / ItemHoe . java . patch 
 index 6565cee . . 4605d0c 100644 
 - - - a / patches / common / net / minecraft / src / ItemHoe . java . patch 
 + + + b / patches / common / net / minecraft / src / ItemHoe . java . patch 
 @ @ - 1 , 14 + 1 , 15 @ @ 
 - - - . . / src _ base / common / net / minecraft / src / ItemHoe . java 
 + + + . . / src _ work / common / net / minecraft / src / ItemHoe . java 
 - @ @ - 1 , 5 + 1 , 7 @ @ 
 + @ @ - 1 , 5 + 1 , 8 @ @ 
 package net . minecraft . src ; 
 
 + import net . minecraftforge . common . MinecraftForge ; 
 - + import net . minecraftforge . event . entity . UseHoeEvent ; 
 + + import net . minecraftforge . event . Event . Result ; 
 + + import net . minecraftforge . event . entity . player . UseHoeEvent ; 
 import cpw . mods . fml . common . Side ; 
 import cpw . mods . fml . common . asm . SideOnly ; 
 
 - @ @ - 28 , 6 + 30 , 17 @ @ 
 + @ @ - 28 , 6 + 31 , 18 @ @ 
 } 
 else 
 { 
 @ @ - 17 , 7 + 18 , 8 @ @ 
 + { 
 + return false ; 
 + } 
 - + if ( event . isHandeled ( ) ) 
 + + 
 + + if ( event . getResult ( ) = = Result . ALLOW ) 
 + { 
 + par1ItemStack . damageItem ( 1 , par2EntityPlayer ) ; 
 + return true ; 
 diff - - git a / patches / common / net / minecraft / src / SpawnerAnimals . java . patch b / patches / common / net / minecraft / src / SpawnerAnimals . java . patch 
 index f5726b9 . . fffe071 100644 
 - - - a / patches / common / net / minecraft / src / SpawnerAnimals . java . patch 
 + + + b / patches / common / net / minecraft / src / SpawnerAnimals . java . patch 
 @ @ - 35 , 13 + 35 , 11 @ @ 
 } 
 } 
 
 - @ @ - 216 , 6 + 225 , 13 @ @ 
 + @ @ - 216 , 6 + 225 , 11 @ @ 
 * / 
 private static void creatureSpecificInit ( EntityLiving par0EntityLiving , World par1World , float par2 , float par3 , float par4 ) 
 { 
 - + LivingSpecialSpawnEvent event = new LivingSpecialSpawnEvent ( par0EntityLiving , par1World , par2 , par3 , par4 ) ; 
 - + MinecraftForge . EVENT _ BUS . post ( event ) ; 
 - + if ( event . isHandeled ( ) ) 
 + + if ( MinecraftForge . EVENT _ BUS . post ( new LivingSpecialSpawnEvent ( par0EntityLiving , par1World , par2 , par3 , par4 ) ) ) 
 + { 
 + return ; 
 + }
