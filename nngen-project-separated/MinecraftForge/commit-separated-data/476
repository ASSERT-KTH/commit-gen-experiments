BLEU SCORE: 0.041961149062965476

TEST MSG: Fix invulnerable items becoming invisible client side MC - 53850
GENERATED MSG: Fix broken EntityItem merging for Items with capabilities

TEST DIFF (one line): diff - - git a / patches / minecraft / net / minecraft / entity / item / EntityItem . java . patch b / patches / minecraft / net / minecraft / entity / item / EntityItem . java . patch <nl> index 9083ab2 . . 8bba8e8 100644 <nl> - - - a / patches / minecraft / net / minecraft / entity / item / EntityItem . java . patch <nl> + + + b / patches / minecraft / net / minecraft / entity / item / EntityItem . java . patch <nl> @ @ - 57 , 7 + 57 , 15 @ @ <nl> else <nl> { <nl> itemstack1 . func _ 190917 _ f ( itemstack . func _ 190916 _ E ( ) ) ; <nl> - @ @ - 316 , 6 + 335 , 7 @ @ <nl> + @ @ - 284 , 6 + 303 , 7 @ @ <nl> + <nl> + public boolean func _ 70097 _ a ( DamageSource p _ 70097 _ 1 _ , float p _ 70097 _ 2 _ ) <nl> + { <nl> + + if ( this . field _ 70170 _ p . field _ 72995 _ K | | this . field _ 70128 _ L ) return false ; / / Forge : Fixes MC - 53850 <nl> + if ( this . func _ 180431 _ b ( p _ 70097 _ 1 _ ) ) <nl> + { <nl> + return false ; <nl> + @ @ - 316 , 6 + 336 , 7 @ @ <nl> p _ 70014 _ 1 _ . func _ 74777 _ a ( " Health " , ( short ) this . field _ 70291 _ e ) ; <nl> p _ 70014 _ 1 _ . func _ 74777 _ a ( " Age " , ( short ) this . field _ 70292 _ b ) ; <nl> p _ 70014 _ 1 _ . func _ 74777 _ a ( " PickupDelay " , ( short ) this . field _ 145804 _ b ) ; <nl> @ @ - 65 , 7 + 73 , 7 @ @ <nl> <nl> if ( this . func _ 145800 _ j ( ) ! = null ) <nl> { <nl> - @ @ - 360 , 17 + 380 , 22 @ @ <nl> + @ @ - 360 , 17 + 381 , 22 @ @ <nl> { <nl> this . func _ 70106 _ y ( ) ; <nl> } <nl> @ @ - 89 , 7 + 97 , 7 @ @ <nl> { <nl> if ( item = = Item . func _ 150898 _ a ( Blocks . field _ 150364 _ r ) ) <nl> { <nl> - @ @ - 407 , 6 + 432 , 7 @ @ <nl> + @ @ - 407 , 6 + 433 , 7 @ @ <nl> } <nl> } <nl> <nl> @ @ - 97 , 7 + 105 , 7 @ @ <nl> p _ 70100 _ 1 _ . func _ 71001 _ a ( this , i ) ; <nl> <nl> if ( itemstack . func _ 190926 _ b ( ) ) <nl> - @ @ - 513 , 6 + 539 , 6 @ @ <nl> + @ @ - 513 , 6 + 540 , 6 @ @ <nl> public void func _ 174870 _ v ( ) <nl> { <nl> this . func _ 174871 _ r ( ) ; <nl> diff - - git a / patches / minecraft / net / minecraft / entity / item / EntityXPOrb . java . patch b / patches / minecraft / net / minecraft / entity / item / EntityXPOrb . java . patch <nl> index 3279db9 . . dd711a5 100644 <nl> - - - a / patches / minecraft / net / minecraft / entity / item / EntityXPOrb . java . patch <nl> + + + b / patches / minecraft / net / minecraft / entity / item / EntityXPOrb . java . patch <nl> @ @ - 1 , 6 + 1 , 14 @ @ <nl> - - - . . / src - base / minecraft / net / minecraft / entity / item / EntityXPOrb . java <nl> + + + . . / src - work / minecraft / net / minecraft / entity / item / EntityXPOrb . java <nl> - @ @ - 208 , 6 + 208 , 7 @ @ <nl> + @ @ - 170 , 6 + 170 , 7 @ @ <nl> + <nl> + public boolean func _ 70097 _ a ( DamageSource p _ 70097 _ 1 _ , float p _ 70097 _ 2 _ ) <nl> + { <nl> + + if ( this . field _ 70170 _ p . field _ 72995 _ K | | this . field _ 70128 _ L ) return false ; / / Forge : Fixes MC - 53850 <nl> + if ( this . func _ 180431 _ b ( p _ 70097 _ 1 _ ) ) <nl> + { <nl> + return false ; <nl> + @ @ - 208 , 6 + 209 , 7 @ @ <nl> { <nl> if ( this . field _ 70532 _ c = = 0 & & p _ 70100 _ 1 _ . field _ 71090 _ bL = = 0 ) <nl> {
NEAREST DIFF (one line): diff - - git a / patches / minecraft / net / minecraft / entity / item / EntityItem . java . patch b / patches / minecraft / net / minecraft / entity / item / EntityItem . java . patch <nl> index 6ef7111 . . 8adc92b 100644 <nl> - - - a / patches / minecraft / net / minecraft / entity / item / EntityItem . java . patch <nl> + + + b / patches / minecraft / net / minecraft / entity / item / EntityItem . java . patch <nl> @ @ - 47 , 7 + 47 , 18 @ @ <nl> this . func _ 70106 _ y ( ) ; <nl> } <nl> } <nl> - @ @ - 280 , 6 + 296 , 7 @ @ <nl> + @ @ - 196 , 6 + 212 , 10 @ @ <nl> + { <nl> + return false ; <nl> + } <nl> + + else if ( ! itemstack . areCapsCompatible ( itemstack1 ) ) <nl> + + { <nl> + + return false ; <nl> + + } <nl> + else <nl> + { <nl> + itemstack1 . field _ 77994 _ a + = itemstack . field _ 77994 _ a ; <nl> + @ @ - 280 , 6 + 300 , 7 @ @ <nl> p _ 70014 _ 1 _ . func _ 74777 _ a ( " Health " , ( short ) this . field _ 70291 _ e ) ; <nl> p _ 70014 _ 1 _ . func _ 74777 _ a ( " Age " , ( short ) this . field _ 70292 _ b ) ; <nl> p _ 70014 _ 1 _ . func _ 74777 _ a ( " PickupDelay " , ( short ) this . field _ 145804 _ b ) ; <nl> @ @ - 55 , 7 + 66 , 7 @ @ <nl> <nl> if ( this . func _ 145800 _ j ( ) ! = null ) <nl> { <nl> - @ @ - 320 , 20 + 337 , 23 @ @ <nl> + @ @ - 320 , 20 + 341 , 23 @ @ <nl> NBTTagCompound nbttagcompound = p _ 70037 _ 1 _ . func _ 74775 _ l ( " Item " ) ; <nl> this . func _ 92058 _ a ( ItemStack . func _ 77949 _ a ( nbttagcompound ) ) ; <nl> <nl> @ @ - 84 , 7 + 95 , 7 @ @ <nl> { <nl> if ( itemstack . func _ 77973 _ b ( ) = = Item . func _ 150898 _ a ( Blocks . field _ 150364 _ r ) ) <nl> { <nl> - @ @ - 370 , 6 + 390 , 7 @ @ <nl> + @ @ - 370 , 6 + 394 , 7 @ @ <nl> } <nl> } <nl> <nl> @ @ - 92 , 7 + 103 , 7 @ @ <nl> if ( ! this . func _ 174814 _ R ( ) ) <nl> { <nl> this . field _ 70170 _ p . func _ 184148 _ a ( ( EntityPlayer ) null , p _ 70100 _ 1 _ . field _ 70165 _ t , p _ 70100 _ 1 _ . field _ 70163 _ u , p _ 70100 _ 1 _ . field _ 70161 _ v , SoundEvents . field _ 187638 _ cR , SoundCategory . PLAYERS , 0 . 2F , ( ( this . field _ 70146 _ Z . nextFloat ( ) - this . field _ 70146 _ Z . nextFloat ( ) ) * 0 . 7F + 1 . 0F ) * 2 . 0F ) ; <nl> - @ @ - 416 , 11 + 437 , 6 @ @ <nl> + @ @ - 416 , 11 + 441 , 6 @ @ <nl> <nl> if ( itemstack = = null ) <nl> { <nl> @ @ - 104 , 7 + 115 , 7 @ @ <nl> return new ItemStack ( Blocks . field _ 150348 _ b ) ; <nl> } <nl> else <nl> - @ @ - 494 , 6 + 510 , 6 @ @ <nl> + @ @ - 494 , 6 + 514 , 6 @ @ <nl> public void func _ 174870 _ v ( ) <nl> { <nl> this . func _ 174871 _ r ( ) ; <nl> diff - - git a / patches / minecraft / net / minecraft / item / ItemStack . java . patch b / patches / minecraft / net / minecraft / item / ItemStack . java . patch <nl> index 8d9ed7a . . 136028c 100644 <nl> - - - a / patches / minecraft / net / minecraft / item / ItemStack . java . patch <nl> + + + b / patches / minecraft / net / minecraft / item / ItemStack . java . patch <nl> @ @ - 234 , 7 + 234 , 7 @ @ <nl> this . field _ 151002 _ e = p _ 150996 _ 1 _ ; <nl> } <nl> <nl> - @ @ - 991 , 4 + 1026 , 26 @ @ <nl> + @ @ - 991 , 4 + 1026 , 45 @ @ <nl> return false ; <nl> } <nl> } <nl> @ @ - 260 , 4 + 260 , 23 @ @ <nl> + this . func _ 77955 _ b ( ret ) ; <nl> + return ret ; <nl> + } <nl> + + <nl> + + public boolean areCapsCompatible ( ItemStack other ) <nl> + + { <nl> + + if ( this . capabilities = = null ) <nl> + + { <nl> + + if ( other . capabilities = = null ) <nl> + + { <nl> + + return true ; <nl> + + } <nl> + + else <nl> + + { <nl> + + return other . capabilities . areCompatible ( null ) ; <nl> + + } <nl> + + } <nl> + + else <nl> + + { <nl> + + return this . capabilities . areCompatible ( other . capabilities ) ; <nl> + + } <nl> + + } <nl> }

TEST DIFF:
diff - - git a / patches / minecraft / net / minecraft / entity / item / EntityItem . java . patch b / patches / minecraft / net / minecraft / entity / item / EntityItem . java . patch 
 index 9083ab2 . . 8bba8e8 100644 
 - - - a / patches / minecraft / net / minecraft / entity / item / EntityItem . java . patch 
 + + + b / patches / minecraft / net / minecraft / entity / item / EntityItem . java . patch 
 @ @ - 57 , 7 + 57 , 15 @ @ 
 else 
 { 
 itemstack1 . func _ 190917 _ f ( itemstack . func _ 190916 _ E ( ) ) ; 
 - @ @ - 316 , 6 + 335 , 7 @ @ 
 + @ @ - 284 , 6 + 303 , 7 @ @ 
 + 
 + public boolean func _ 70097 _ a ( DamageSource p _ 70097 _ 1 _ , float p _ 70097 _ 2 _ ) 
 + { 
 + + if ( this . field _ 70170 _ p . field _ 72995 _ K | | this . field _ 70128 _ L ) return false ; / / Forge : Fixes MC - 53850 
 + if ( this . func _ 180431 _ b ( p _ 70097 _ 1 _ ) ) 
 + { 
 + return false ; 
 + @ @ - 316 , 6 + 336 , 7 @ @ 
 p _ 70014 _ 1 _ . func _ 74777 _ a ( " Health " , ( short ) this . field _ 70291 _ e ) ; 
 p _ 70014 _ 1 _ . func _ 74777 _ a ( " Age " , ( short ) this . field _ 70292 _ b ) ; 
 p _ 70014 _ 1 _ . func _ 74777 _ a ( " PickupDelay " , ( short ) this . field _ 145804 _ b ) ; 
 @ @ - 65 , 7 + 73 , 7 @ @ 
 
 if ( this . func _ 145800 _ j ( ) ! = null ) 
 { 
 - @ @ - 360 , 17 + 380 , 22 @ @ 
 + @ @ - 360 , 17 + 381 , 22 @ @ 
 { 
 this . func _ 70106 _ y ( ) ; 
 } 
 @ @ - 89 , 7 + 97 , 7 @ @ 
 { 
 if ( item = = Item . func _ 150898 _ a ( Blocks . field _ 150364 _ r ) ) 
 { 
 - @ @ - 407 , 6 + 432 , 7 @ @ 
 + @ @ - 407 , 6 + 433 , 7 @ @ 
 } 
 } 
 
 @ @ - 97 , 7 + 105 , 7 @ @ 
 p _ 70100 _ 1 _ . func _ 71001 _ a ( this , i ) ; 
 
 if ( itemstack . func _ 190926 _ b ( ) ) 
 - @ @ - 513 , 6 + 539 , 6 @ @ 
 + @ @ - 513 , 6 + 540 , 6 @ @ 
 public void func _ 174870 _ v ( ) 
 { 
 this . func _ 174871 _ r ( ) ; 
 diff - - git a / patches / minecraft / net / minecraft / entity / item / EntityXPOrb . java . patch b / patches / minecraft / net / minecraft / entity / item / EntityXPOrb . java . patch 
 index 3279db9 . . dd711a5 100644 
 - - - a / patches / minecraft / net / minecraft / entity / item / EntityXPOrb . java . patch 
 + + + b / patches / minecraft / net / minecraft / entity / item / EntityXPOrb . java . patch 
 @ @ - 1 , 6 + 1 , 14 @ @ 
 - - - . . / src - base / minecraft / net / minecraft / entity / item / EntityXPOrb . java 
 + + + . . / src - work / minecraft / net / minecraft / entity / item / EntityXPOrb . java 
 - @ @ - 208 , 6 + 208 , 7 @ @ 
 + @ @ - 170 , 6 + 170 , 7 @ @ 
 + 
 + public boolean func _ 70097 _ a ( DamageSource p _ 70097 _ 1 _ , float p _ 70097 _ 2 _ ) 
 + { 
 + + if ( this . field _ 70170 _ p . field _ 72995 _ K | | this . field _ 70128 _ L ) return false ; / / Forge : Fixes MC - 53850 
 + if ( this . func _ 180431 _ b ( p _ 70097 _ 1 _ ) ) 
 + { 
 + return false ; 
 + @ @ - 208 , 6 + 209 , 7 @ @ 
 { 
 if ( this . field _ 70532 _ c = = 0 & & p _ 70100 _ 1 _ . field _ 71090 _ bL = = 0 ) 
 {

NEAREST DIFF:
diff - - git a / patches / minecraft / net / minecraft / entity / item / EntityItem . java . patch b / patches / minecraft / net / minecraft / entity / item / EntityItem . java . patch 
 index 6ef7111 . . 8adc92b 100644 
 - - - a / patches / minecraft / net / minecraft / entity / item / EntityItem . java . patch 
 + + + b / patches / minecraft / net / minecraft / entity / item / EntityItem . java . patch 
 @ @ - 47 , 7 + 47 , 18 @ @ 
 this . func _ 70106 _ y ( ) ; 
 } 
 } 
 - @ @ - 280 , 6 + 296 , 7 @ @ 
 + @ @ - 196 , 6 + 212 , 10 @ @ 
 + { 
 + return false ; 
 + } 
 + + else if ( ! itemstack . areCapsCompatible ( itemstack1 ) ) 
 + + { 
 + + return false ; 
 + + } 
 + else 
 + { 
 + itemstack1 . field _ 77994 _ a + = itemstack . field _ 77994 _ a ; 
 + @ @ - 280 , 6 + 300 , 7 @ @ 
 p _ 70014 _ 1 _ . func _ 74777 _ a ( " Health " , ( short ) this . field _ 70291 _ e ) ; 
 p _ 70014 _ 1 _ . func _ 74777 _ a ( " Age " , ( short ) this . field _ 70292 _ b ) ; 
 p _ 70014 _ 1 _ . func _ 74777 _ a ( " PickupDelay " , ( short ) this . field _ 145804 _ b ) ; 
 @ @ - 55 , 7 + 66 , 7 @ @ 
 
 if ( this . func _ 145800 _ j ( ) ! = null ) 
 { 
 - @ @ - 320 , 20 + 337 , 23 @ @ 
 + @ @ - 320 , 20 + 341 , 23 @ @ 
 NBTTagCompound nbttagcompound = p _ 70037 _ 1 _ . func _ 74775 _ l ( " Item " ) ; 
 this . func _ 92058 _ a ( ItemStack . func _ 77949 _ a ( nbttagcompound ) ) ; 
 
 @ @ - 84 , 7 + 95 , 7 @ @ 
 { 
 if ( itemstack . func _ 77973 _ b ( ) = = Item . func _ 150898 _ a ( Blocks . field _ 150364 _ r ) ) 
 { 
 - @ @ - 370 , 6 + 390 , 7 @ @ 
 + @ @ - 370 , 6 + 394 , 7 @ @ 
 } 
 } 
 
 @ @ - 92 , 7 + 103 , 7 @ @ 
 if ( ! this . func _ 174814 _ R ( ) ) 
 { 
 this . field _ 70170 _ p . func _ 184148 _ a ( ( EntityPlayer ) null , p _ 70100 _ 1 _ . field _ 70165 _ t , p _ 70100 _ 1 _ . field _ 70163 _ u , p _ 70100 _ 1 _ . field _ 70161 _ v , SoundEvents . field _ 187638 _ cR , SoundCategory . PLAYERS , 0 . 2F , ( ( this . field _ 70146 _ Z . nextFloat ( ) - this . field _ 70146 _ Z . nextFloat ( ) ) * 0 . 7F + 1 . 0F ) * 2 . 0F ) ; 
 - @ @ - 416 , 11 + 437 , 6 @ @ 
 + @ @ - 416 , 11 + 441 , 6 @ @ 
 
 if ( itemstack = = null ) 
 { 
 @ @ - 104 , 7 + 115 , 7 @ @ 
 return new ItemStack ( Blocks . field _ 150348 _ b ) ; 
 } 
 else 
 - @ @ - 494 , 6 + 510 , 6 @ @ 
 + @ @ - 494 , 6 + 514 , 6 @ @ 
 public void func _ 174870 _ v ( ) 
 { 
 this . func _ 174871 _ r ( ) ; 
 diff - - git a / patches / minecraft / net / minecraft / item / ItemStack . java . patch b / patches / minecraft / net / minecraft / item / ItemStack . java . patch 
 index 8d9ed7a . . 136028c 100644 
 - - - a / patches / minecraft / net / minecraft / item / ItemStack . java . patch 
 + + + b / patches / minecraft / net / minecraft / item / ItemStack . java . patch 
 @ @ - 234 , 7 + 234 , 7 @ @ 
 this . field _ 151002 _ e = p _ 150996 _ 1 _ ; 
 } 
 
 - @ @ - 991 , 4 + 1026 , 26 @ @ 
 + @ @ - 991 , 4 + 1026 , 45 @ @ 
 return false ; 
 } 
 } 
 @ @ - 260 , 4 + 260 , 23 @ @ 
 + this . func _ 77955 _ b ( ret ) ; 
 + return ret ; 
 + } 
 + + 
 + + public boolean areCapsCompatible ( ItemStack other ) 
 + + { 
 + + if ( this . capabilities = = null ) 
 + + { 
 + + if ( other . capabilities = = null ) 
 + + { 
 + + return true ; 
 + + } 
 + + else 
 + + { 
 + + return other . capabilities . areCompatible ( null ) ; 
 + + } 
 + + } 
 + + else 
 + + { 
 + + return this . capabilities . areCompatible ( other . capabilities ) ; 
 + + } 
 + + } 
 }
