BLEU SCORE: 0.0021771450140035953

TEST MSG: Some more forge code fixes
GENERATED MSG: Be noisy when API is in a coremod . It ' ll never work and modders should realize that fact .

TEST DIFF (one line): diff - - git a / src / main / java / net / minecraftforge / client / model / MultiModel . java b / src / main / java / net / minecraftforge / client / model / MultiModel . java <nl> index 6280f59 . . 28b3884 100644 <nl> - - - a / src / main / java / net / minecraftforge / client / model / MultiModel . java <nl> + + + b / src / main / java / net / minecraftforge / client / model / MultiModel . java <nl> @ @ - 142 , 7 + 142 , 7 @ @ public class MultiModel implements IModel <nl> { <nl> quads . addAll ( bakedPart . func _ 188616 _ a ( null , null , 0 ) ) ; <nl> } <nl> - builder . put ( Optional . absent ( ) , quads . build ( ) ) ; <nl> + builder . put ( Optional . < EnumFacing > absent ( ) , quads . build ( ) ) ; <nl> this . quads = builder . build ( ) ; <nl> } <nl> return quads . get ( Optional . fromNullable ( side ) ) ; <nl> diff - - git a / src / main / java / net / minecraftforge / common / ForgeInternalHandler . java b / src / main / java / net / minecraftforge / common / ForgeInternalHandler . java <nl> index f1a0f24 . . a7eb78d 100644 <nl> - - - a / src / main / java / net / minecraftforge / common / ForgeInternalHandler . java <nl> + + + b / src / main / java / net / minecraftforge / common / ForgeInternalHandler . java <nl> @ @ - 1 , 5 + 1 , 7 @ @ <nl> package net . minecraftforge . common ; <nl> <nl> + import com . google . common . base . Optional ; <nl> + import net . minecraft . network . datasync . DataSerializers ; <nl> import net . minecraftforge . fml . common . FMLLog ; <nl> import net . minecraftforge . fml . common . eventhandler . EventPriority ; <nl> import net . minecraftforge . fml . common . eventhandler . SubscribeEvent ; <nl> @ @ - 25 , 7 + 27 , 7 @ @ public class ForgeInternalHandler <nl> Entity entity = event . entity ; <nl> if ( entity . getClass ( ) . equals ( EntityItem . class ) ) <nl> { <nl> - ItemStack stack = entity . getDataWatcher ( ) . getWatchableObjectItemStack ( 10 ) ; <nl> + ItemStack stack = ( ( EntityItem ) entity ) . getEntityItem ( ) ; <nl> <nl> if ( stack = = null ) <nl> { <nl> diff - - git a / src / main / java / net / minecraftforge / common / WorldSpecificSaveHandler . java b / src / main / java / net / minecraftforge / common / WorldSpecificSaveHandler . java <nl> index 1e6044d . . 8d649ae 100644 <nl> - - - a / src / main / java / net / minecraftforge / common / WorldSpecificSaveHandler . java <nl> + + + b / src / main / java / net / minecraftforge / common / WorldSpecificSaveHandler . java <nl> @ @ - 3 , 6 + 3 , 7 @ @ package net . minecraftforge . common ; <nl> import java . io . File ; <nl> import java . io . IOException ; <nl> <nl> + import net . minecraft . world . gen . structure . template . TemplateManager ; <nl> import org . apache . logging . log4j . Level ; <nl> <nl> import com . google . common . io . Files ; <nl> @ @ - 38 , 7 + 39 , 6 @ @ public class WorldSpecificSaveHandler implements ISaveHandler <nl> @ Override public void saveWorldInfo ( WorldInfo var1 ) { parent . saveWorldInfo ( var1 ) ; } <nl> @ Override public IPlayerFileData getPlayerNBTManager ( ) { return parent . getPlayerNBTManager ( ) ; } <nl> @ Override public void flush ( ) { parent . flush ( ) ; } <nl> - @ Override public String getWorldDirectoryName ( ) { return parent . getWorldDirectoryName ( ) ; } <nl> @ Override public File getWorldDirectory ( ) { return parent . getWorldDirectory ( ) ; } <nl> <nl> @ Override <nl> @ @ - 68 , 4 + 68 , 10 @ @ public class WorldSpecificSaveHandler implements ISaveHandler <nl> return file ; <nl> } <nl> <nl> + @ Override <nl> + public TemplateManager func _ 186340 _ h ( ) <nl> + { <nl> + return parent . func _ 186340 _ h ( ) ; <nl> + } <nl> + <nl> } <nl> diff - - git a / src / main / java / net / minecraftforge / common / util / BlockSnapshot . java b / src / main / java / net / minecraftforge / common / util / BlockSnapshot . java <nl> index a3566af . . 467eaa0 100644 <nl> - - - a / src / main / java / net / minecraftforge / common / util / BlockSnapshot . java <nl> + + + b / src / main / java / net / minecraftforge / common / util / BlockSnapshot . java <nl> @ @ - 139 , 7 + 139 , 7 @ @ public class BlockSnapshot implements Serializable <nl> public TileEntity getTileEntity ( ) <nl> { <nl> if ( nbt ! = null ) <nl> - return TileEntity . createAndLoadEntity ( nbt ) ; <nl> + return TileEntity . func _ 184246 _ b ( getWorld ( ) . getMinecraftServer ( ) , nbt ) ; <nl> else return null ; <nl> } <nl> <nl> @ @ - 170 , 7 + 170 , 7 @ @ public class BlockSnapshot implements Serializable <nl> } <nl> <nl> world . setBlockState ( pos , replaced , applyPhysics ? 3 : 2 ) ; <nl> - world . markBlockForUpdate ( pos ) ; <nl> + world . func _ 184138 _ a ( pos , current , replaced , applyPhysics ? 3 : 2 ) ; <nl> TileEntity te = null ; <nl> if ( nbt ! = null ) <nl> { <nl> @ @ - 205 , 7 + 205 , 7 @ @ public class BlockSnapshot implements Serializable <nl> } <nl> <nl> world . setBlockState ( pos , replaced , applyPhysics ? 3 : 2 ) ; <nl> - world . markBlockForUpdate ( pos ) ; <nl> + world . func _ 184138 _ a ( pos , current , replaced , applyPhysics ? 3 : 2 ) ; <nl> TileEntity te = null ; <nl> if ( nbt ! = null ) <nl> {
NEAREST DIFF (one line): diff - - git a / src / main / java / net / minecraftforge / fml / common / Loader . java b / src / main / java / net / minecraftforge / fml / common / Loader . java <nl> index 14ee5d1 . . b58949b 100644 <nl> - - - a / src / main / java / net / minecraftforge / fml / common / Loader . java <nl> + + + b / src / main / java / net / minecraftforge / fml / common / Loader . java <nl> @ @ - 639 , 7 + 639 , 7 @ @ public class Loader <nl> return " 8 . 0 . 99 . 99 " ; <nl> } <nl> <nl> - public ClassLoader getModClassLoader ( ) <nl> + public ModClassLoader getModClassLoader ( ) <nl> { <nl> return modClassLoader ; <nl> } <nl> diff - - git a / src / main / java / net / minecraftforge / fml / common / ModAPIManager . java b / src / main / java / net / minecraftforge / fml / common / ModAPIManager . java <nl> index 4f4d8b2 . . 5733190 100644 <nl> - - - a / src / main / java / net / minecraftforge / fml / common / ModAPIManager . java <nl> + + + b / src / main / java / net / minecraftforge / fml / common / ModAPIManager . java <nl> @ @ - 90 , 6 + 90 , 9 @ @ public class ModAPIManager { <nl> <nl> public void validate ( String providedAPI , String apiOwner , String apiVersion ) <nl> { <nl> + if ( Loader . instance ( ) . getModClassLoader ( ) . containsSource ( this . getSource ( ) ) ) { <nl> + FMLLog . bigWarning ( " The API % s from source % s is loaded from an incompatible classloader . THIS WILL NOT WORK ! " , providedAPI , this . getSource ( ) . getAbsolutePath ( ) ) ; <nl> + } <nl> / / TODO Compare this annotation data to the one we first found . Maybe barf if there is inconsistency ? <nl> } <nl> <nl> diff - - git a / src / main / java / net / minecraftforge / fml / common / ModClassLoader . java b / src / main / java / net / minecraftforge / fml / common / ModClassLoader . java <nl> index 161f936 . . 854ff23 100644 <nl> - - - a / src / main / java / net / minecraftforge / fml / common / ModClassLoader . java <nl> + + + b / src / main / java / net / minecraftforge / fml / common / ModClassLoader . java <nl> @ @ - 19 , 6 + 19 , 7 @ @ import java . net . URISyntaxException ; <nl> import java . net . URL ; <nl> import java . net . URLClassLoader ; <nl> import java . util . ArrayList ; <nl> + import java . util . Arrays ; <nl> import java . util . List ; <nl> import java . util . Set ; <nl> <nl> @ @ - 30 , 6 + 31 , 7 @ @ import net . minecraftforge . fml . common . discovery . ASMDataTable ; <nl> import org . apache . logging . log4j . Level ; <nl> <nl> import com . google . common . collect . ImmutableList ; <nl> + import com . google . common . collect . Lists ; <nl> <nl> / * * <nl> * A simple delegating class loader used to load mods into the system <nl> @ @ - 42 , 6 + 44 , 7 @ @ public class ModClassLoader extends URLClassLoader <nl> { <nl> private static final List < String > STANDARD _ LIBRARIES = ImmutableList . of ( " jinput . jar " , " lwjgl . jar " , " lwjgl _ util . jar " , " rt . jar " ) ; <nl> private LaunchClassLoader mainClassLoader ; <nl> + private List < File > sources ; <nl> <nl> public ModClassLoader ( ClassLoader parent ) { <nl> super ( new URL [ 0 ] , null ) ; <nl> @ @ - 52 , 6 + 55 , 7 @ @ public class ModClassLoader extends URLClassLoader <nl> { <nl> URL url = modFile . toURI ( ) . toURL ( ) ; <nl> mainClassLoader . addURL ( url ) ; <nl> + this . sources . add ( modFile ) ; <nl> } <nl> <nl> @ Override <nl> @ @ - 148 , 4 + 152 , 20 @ @ public class ModClassLoader extends URLClassLoader <nl> modAPI . initTable ( dataTable ) ; <nl> return modAPI ; <nl> } <nl> + <nl> + List < URL > parentURLs = null ; <nl> + public boolean containsSource ( File source ) <nl> + { <nl> + if ( parentURLs = = null ) { <nl> + parentURLs = Arrays . asList ( mainClassLoader . getURLs ( ) ) ; <nl> + } <nl> + try <nl> + { <nl> + return parentURLs . contains ( source . toURI ( ) . toURL ( ) ) ; <nl> + } catch ( MalformedURLException e ) <nl> + { <nl> + / / shouldn ' t happen <nl> + return false ; <nl> + } <nl> + } <nl> }

TEST DIFF:
diff - - git a / src / main / java / net / minecraftforge / client / model / MultiModel . java b / src / main / java / net / minecraftforge / client / model / MultiModel . java 
 index 6280f59 . . 28b3884 100644 
 - - - a / src / main / java / net / minecraftforge / client / model / MultiModel . java 
 + + + b / src / main / java / net / minecraftforge / client / model / MultiModel . java 
 @ @ - 142 , 7 + 142 , 7 @ @ public class MultiModel implements IModel 
 { 
 quads . addAll ( bakedPart . func _ 188616 _ a ( null , null , 0 ) ) ; 
 } 
 - builder . put ( Optional . absent ( ) , quads . build ( ) ) ; 
 + builder . put ( Optional . < EnumFacing > absent ( ) , quads . build ( ) ) ; 
 this . quads = builder . build ( ) ; 
 } 
 return quads . get ( Optional . fromNullable ( side ) ) ; 
 diff - - git a / src / main / java / net / minecraftforge / common / ForgeInternalHandler . java b / src / main / java / net / minecraftforge / common / ForgeInternalHandler . java 
 index f1a0f24 . . a7eb78d 100644 
 - - - a / src / main / java / net / minecraftforge / common / ForgeInternalHandler . java 
 + + + b / src / main / java / net / minecraftforge / common / ForgeInternalHandler . java 
 @ @ - 1 , 5 + 1 , 7 @ @ 
 package net . minecraftforge . common ; 
 
 + import com . google . common . base . Optional ; 
 + import net . minecraft . network . datasync . DataSerializers ; 
 import net . minecraftforge . fml . common . FMLLog ; 
 import net . minecraftforge . fml . common . eventhandler . EventPriority ; 
 import net . minecraftforge . fml . common . eventhandler . SubscribeEvent ; 
 @ @ - 25 , 7 + 27 , 7 @ @ public class ForgeInternalHandler 
 Entity entity = event . entity ; 
 if ( entity . getClass ( ) . equals ( EntityItem . class ) ) 
 { 
 - ItemStack stack = entity . getDataWatcher ( ) . getWatchableObjectItemStack ( 10 ) ; 
 + ItemStack stack = ( ( EntityItem ) entity ) . getEntityItem ( ) ; 
 
 if ( stack = = null ) 
 { 
 diff - - git a / src / main / java / net / minecraftforge / common / WorldSpecificSaveHandler . java b / src / main / java / net / minecraftforge / common / WorldSpecificSaveHandler . java 
 index 1e6044d . . 8d649ae 100644 
 - - - a / src / main / java / net / minecraftforge / common / WorldSpecificSaveHandler . java 
 + + + b / src / main / java / net / minecraftforge / common / WorldSpecificSaveHandler . java 
 @ @ - 3 , 6 + 3 , 7 @ @ package net . minecraftforge . common ; 
 import java . io . File ; 
 import java . io . IOException ; 
 
 + import net . minecraft . world . gen . structure . template . TemplateManager ; 
 import org . apache . logging . log4j . Level ; 
 
 import com . google . common . io . Files ; 
 @ @ - 38 , 7 + 39 , 6 @ @ public class WorldSpecificSaveHandler implements ISaveHandler 
 @ Override public void saveWorldInfo ( WorldInfo var1 ) { parent . saveWorldInfo ( var1 ) ; } 
 @ Override public IPlayerFileData getPlayerNBTManager ( ) { return parent . getPlayerNBTManager ( ) ; } 
 @ Override public void flush ( ) { parent . flush ( ) ; } 
 - @ Override public String getWorldDirectoryName ( ) { return parent . getWorldDirectoryName ( ) ; } 
 @ Override public File getWorldDirectory ( ) { return parent . getWorldDirectory ( ) ; } 
 
 @ Override 
 @ @ - 68 , 4 + 68 , 10 @ @ public class WorldSpecificSaveHandler implements ISaveHandler 
 return file ; 
 } 
 
 + @ Override 
 + public TemplateManager func _ 186340 _ h ( ) 
 + { 
 + return parent . func _ 186340 _ h ( ) ; 
 + } 
 + 
 } 
 diff - - git a / src / main / java / net / minecraftforge / common / util / BlockSnapshot . java b / src / main / java / net / minecraftforge / common / util / BlockSnapshot . java 
 index a3566af . . 467eaa0 100644 
 - - - a / src / main / java / net / minecraftforge / common / util / BlockSnapshot . java 
 + + + b / src / main / java / net / minecraftforge / common / util / BlockSnapshot . java 
 @ @ - 139 , 7 + 139 , 7 @ @ public class BlockSnapshot implements Serializable 
 public TileEntity getTileEntity ( ) 
 { 
 if ( nbt ! = null ) 
 - return TileEntity . createAndLoadEntity ( nbt ) ; 
 + return TileEntity . func _ 184246 _ b ( getWorld ( ) . getMinecraftServer ( ) , nbt ) ; 
 else return null ; 
 } 
 
 @ @ - 170 , 7 + 170 , 7 @ @ public class BlockSnapshot implements Serializable 
 } 
 
 world . setBlockState ( pos , replaced , applyPhysics ? 3 : 2 ) ; 
 - world . markBlockForUpdate ( pos ) ; 
 + world . func _ 184138 _ a ( pos , current , replaced , applyPhysics ? 3 : 2 ) ; 
 TileEntity te = null ; 
 if ( nbt ! = null ) 
 { 
 @ @ - 205 , 7 + 205 , 7 @ @ public class BlockSnapshot implements Serializable 
 } 
 
 world . setBlockState ( pos , replaced , applyPhysics ? 3 : 2 ) ; 
 - world . markBlockForUpdate ( pos ) ; 
 + world . func _ 184138 _ a ( pos , current , replaced , applyPhysics ? 3 : 2 ) ; 
 TileEntity te = null ; 
 if ( nbt ! = null ) 
 {

NEAREST DIFF:
diff - - git a / src / main / java / net / minecraftforge / fml / common / Loader . java b / src / main / java / net / minecraftforge / fml / common / Loader . java 
 index 14ee5d1 . . b58949b 100644 
 - - - a / src / main / java / net / minecraftforge / fml / common / Loader . java 
 + + + b / src / main / java / net / minecraftforge / fml / common / Loader . java 
 @ @ - 639 , 7 + 639 , 7 @ @ public class Loader 
 return " 8 . 0 . 99 . 99 " ; 
 } 
 
 - public ClassLoader getModClassLoader ( ) 
 + public ModClassLoader getModClassLoader ( ) 
 { 
 return modClassLoader ; 
 } 
 diff - - git a / src / main / java / net / minecraftforge / fml / common / ModAPIManager . java b / src / main / java / net / minecraftforge / fml / common / ModAPIManager . java 
 index 4f4d8b2 . . 5733190 100644 
 - - - a / src / main / java / net / minecraftforge / fml / common / ModAPIManager . java 
 + + + b / src / main / java / net / minecraftforge / fml / common / ModAPIManager . java 
 @ @ - 90 , 6 + 90 , 9 @ @ public class ModAPIManager { 
 
 public void validate ( String providedAPI , String apiOwner , String apiVersion ) 
 { 
 + if ( Loader . instance ( ) . getModClassLoader ( ) . containsSource ( this . getSource ( ) ) ) { 
 + FMLLog . bigWarning ( " The API % s from source % s is loaded from an incompatible classloader . THIS WILL NOT WORK ! " , providedAPI , this . getSource ( ) . getAbsolutePath ( ) ) ; 
 + } 
 / / TODO Compare this annotation data to the one we first found . Maybe barf if there is inconsistency ? 
 } 
 
 diff - - git a / src / main / java / net / minecraftforge / fml / common / ModClassLoader . java b / src / main / java / net / minecraftforge / fml / common / ModClassLoader . java 
 index 161f936 . . 854ff23 100644 
 - - - a / src / main / java / net / minecraftforge / fml / common / ModClassLoader . java 
 + + + b / src / main / java / net / minecraftforge / fml / common / ModClassLoader . java 
 @ @ - 19 , 6 + 19 , 7 @ @ import java . net . URISyntaxException ; 
 import java . net . URL ; 
 import java . net . URLClassLoader ; 
 import java . util . ArrayList ; 
 + import java . util . Arrays ; 
 import java . util . List ; 
 import java . util . Set ; 
 
 @ @ - 30 , 6 + 31 , 7 @ @ import net . minecraftforge . fml . common . discovery . ASMDataTable ; 
 import org . apache . logging . log4j . Level ; 
 
 import com . google . common . collect . ImmutableList ; 
 + import com . google . common . collect . Lists ; 
 
 / * * 
 * A simple delegating class loader used to load mods into the system 
 @ @ - 42 , 6 + 44 , 7 @ @ public class ModClassLoader extends URLClassLoader 
 { 
 private static final List < String > STANDARD _ LIBRARIES = ImmutableList . of ( " jinput . jar " , " lwjgl . jar " , " lwjgl _ util . jar " , " rt . jar " ) ; 
 private LaunchClassLoader mainClassLoader ; 
 + private List < File > sources ; 
 
 public ModClassLoader ( ClassLoader parent ) { 
 super ( new URL [ 0 ] , null ) ; 
 @ @ - 52 , 6 + 55 , 7 @ @ public class ModClassLoader extends URLClassLoader 
 { 
 URL url = modFile . toURI ( ) . toURL ( ) ; 
 mainClassLoader . addURL ( url ) ; 
 + this . sources . add ( modFile ) ; 
 } 
 
 @ Override 
 @ @ - 148 , 4 + 152 , 20 @ @ public class ModClassLoader extends URLClassLoader 
 modAPI . initTable ( dataTable ) ; 
 return modAPI ; 
 } 
 + 
 + List < URL > parentURLs = null ; 
 + public boolean containsSource ( File source ) 
 + { 
 + if ( parentURLs = = null ) { 
 + parentURLs = Arrays . asList ( mainClassLoader . getURLs ( ) ) ; 
 + } 
 + try 
 + { 
 + return parentURLs . contains ( source . toURI ( ) . toURL ( ) ) ; 
 + } catch ( MalformedURLException e ) 
 + { 
 + / / shouldn ' t happen 
 + return false ; 
 + } 
 + } 
 }
