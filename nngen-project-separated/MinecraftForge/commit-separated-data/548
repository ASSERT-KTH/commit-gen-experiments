BLEU SCORE: 0.04767707020457096

TEST MSG: [ 1 . 11 ] Add canApplyAtEnchantmentTable to Item
GENERATED MSG: Add ItemStack sensitive version of getItemEnchantability

TEST DIFF (one line): diff - - git a / patches / minecraft / net / minecraft / client / gui / GuiEnchantment . java . patch b / patches / minecraft / net / minecraft / client / gui / GuiEnchantment . java . patch <nl> new file mode 100644 <nl> index 0000000 . . bd222a5 <nl> - - - / dev / null <nl> + + + b / patches / minecraft / net / minecraft / client / gui / GuiEnchantment . java . patch <nl> @ @ - 0 , 0 + 1 , 26 @ @ <nl> + - - - . . / src - base / minecraft / net / minecraft / client / gui / GuiEnchantment . java <nl> + + + + . . / src - work / minecraft / net / minecraft / client / gui / GuiEnchantment . java <nl> + @ @ - 171 , 7 + 171 , 7 @ @ <nl> + FontRenderer fontrenderer = this . field _ 146297 _ k . field _ 71464 _ q ; <nl> + int i2 = 6839882 ; <nl> + <nl> + - if ( ( k < l + 1 | | this . field _ 146297 _ k . field _ 71439 _ g . field _ 71068 _ ca < k1 ) & & ! this . field _ 146297 _ k . field _ 71439 _ g . field _ 71075 _ bZ . field _ 75098 _ d ) <nl> + + if ( ( ( k < l + 1 | | this . field _ 146297 _ k . field _ 71439 _ g . field _ 71068 _ ca < k1 ) & & ! this . field _ 146297 _ k . field _ 71439 _ g . field _ 71075 _ bZ . field _ 75098 _ d ) | | this . field _ 147075 _ G . field _ 185001 _ h [ l ] = = - 1 ) / / Forge : render buttons as disabled when enchantable but enchantability not met on lower levels <nl> + { <nl> + this . func _ 73729 _ b ( i1 , j + 14 + 19 * l , 0 , 185 , 108 , 19 ) ; <nl> + this . func _ 73729 _ b ( i1 + 1 , j + 15 + 19 * l , 16 * l , 239 , 16 , 16 ) ; <nl> + @ @ - 217 , 11 + 217 , 12 @ @ <nl> + int l = this . field _ 147075 _ G . field _ 185002 _ i [ j ] ; <nl> + int i1 = j + 1 ; <nl> + <nl> + - if ( this . func _ 146978 _ c ( 60 , 14 + 19 * j , 108 , 17 , p _ 73863 _ 1 _ , p _ 73863 _ 2 _ ) & & k > 0 & & l > = 0 & & enchantment ! = null ) <nl> + + if ( this . func _ 146978 _ c ( 60 , 14 + 19 * j , 108 , 17 , p _ 73863 _ 1 _ , p _ 73863 _ 2 _ ) & & k > 0 ) <nl> + { <nl> + List < String > list = Lists . < String > newArrayList ( ) ; <nl> + - list . add ( " " + TextFormatting . WHITE + TextFormatting . ITALIC + I18n . func _ 135052 _ a ( " container . enchant . clue " , new Object [ ] { enchantment . func _ 77316 _ c ( l ) } ) ) ; <nl> + + list . add ( " " + TextFormatting . WHITE + TextFormatting . ITALIC + I18n . func _ 135052 _ a ( " container . enchant . clue " , new Object [ ] { enchantment = = null ? " " : enchantment . func _ 77316 _ c ( l ) } ) ) ; <nl> + <nl> + + if ( enchantment = = null ) java . util . Collections . addAll ( list , " " , TextFormatting . RED + I18n . func _ 135052 _ a ( " forge . container . enchant . limitedEnchantability " ) ) ; else <nl> + if ( ! flag ) <nl> + { <nl> + list . add ( " " ) ; <nl> diff - - git a / patches / minecraft / net / minecraft / enchantment / Enchantment . java . patch b / patches / minecraft / net / minecraft / enchantment / Enchantment . java . patch <nl> index 487d39a . . 953607e 100644 <nl> - - - a / patches / minecraft / net / minecraft / enchantment / Enchantment . java . patch <nl> + + + b / patches / minecraft / net / minecraft / enchantment / Enchantment . java . patch <nl> @ @ - 33 , 7 + 33 , 7 @ @ <nl> + * / <nl> + public boolean canApplyAtEnchantingTable ( ItemStack stack ) <nl> + { <nl> - + return this . field _ 77351 _ y . func _ 77557 _ a ( stack . func _ 77973 _ b ( ) ) ; <nl> + + return stack . func _ 77973 _ b ( ) . canApplyAtEnchantingTable ( stack , this ) ; <nl> + } <nl> + <nl> + / * * <nl> diff - - git a / patches / minecraft / net / minecraft / item / Item . java . patch b / patches / minecraft / net / minecraft / item / Item . java . patch <nl> index 3909962 . . 4396e6a 100644 <nl> - - - a / patches / minecraft / net / minecraft / item / Item . java . patch <nl> + + + b / patches / minecraft / net / minecraft / item / Item . java . patch <nl> @ @ - 60 , 7 + 60 , 7 @ @ <nl> return p _ 77621 _ 1 _ . func _ 147447 _ a ( vec3d , vec3d1 , p _ 77621 _ 3 _ , ! p _ 77621 _ 3 _ , false ) ; <nl> } <nl> <nl> - @ @ - 433 , 11 + 440 , 600 @ @ <nl> + @ @ - 433 , 11 + 440 , 613 @ @ <nl> return false ; <nl> } <nl> <nl> @ @ - 585 , 6 + 585 , 19 @ @ <nl> + } <nl> + <nl> + / * * <nl> + + * Checks whether an item can be enchanted with a certain enchantment . This applies specifically to enchanting an item in the enchanting table and is called when retrieving the list of possible enchantments for an item . <nl> + + * Enchantments may additionally ( or exclusively ) be doing their own checks in { @ link net . minecraft . enchantment . Enchantment # canApplyAtEnchantingTable ( ItemStack ) } ; check the individual implementation for reference . <nl> + + * By default this will check if the enchantment type is valid for this item type . <nl> + + * @ param stack the item stack to be enchanted <nl> + + * @ param enchantment the enchantment to be applied <nl> + + * @ return true if the enchantment can be applied to this item <nl> + + * / <nl> + + public boolean canApplyAtEnchantingTable ( ItemStack stack , net . minecraft . enchantment . Enchantment enchantment ) <nl> + + { <nl> + + return enchantment . field _ 77351 _ y . func _ 77557 _ a ( stack . func _ 77973 _ b ( ) ) ; <nl> + + } <nl> + + <nl> + + / * * <nl> + * Whether this Item can be used as a payment to activate the vanilla beacon . <nl> + * @ param stack the ItemStack <nl> + * @ return true if this Item can be used <nl> @ @ - 661 , 7 + 674 , 7 @ @ <nl> public static void func _ 150900 _ l ( ) <nl> { <nl> func _ 179214 _ a ( Blocks . field _ 150350 _ a , new ItemAir ( Blocks . field _ 150350 _ a ) ) ; <nl> - @ @ - 971 , 6 + 1567 , 8 @ @ <nl> + @ @ - 971 , 6 + 1580 , 8 @ @ <nl> private final float field _ 78010 _ h ; <nl> private final float field _ 78011 _ i ; <nl> private final int field _ 78008 _ j ; <nl> @ @ - 670 , 7 + 683 , 7 @ @ <nl> <nl> private ToolMaterial ( int p _ i1874 _ 3 _ , int p _ i1874 _ 4 _ , float p _ i1874 _ 5 _ , float p _ i1874 _ 6 _ , int p _ i1874 _ 7 _ ) <nl> { <nl> - @ @ - 1006 , 9 + 1604 , 26 @ @ <nl> + @ @ - 1006 , 9 + 1617 , 26 @ @ <nl> return this . field _ 78008 _ j ; <nl> } <nl> <nl> diff - - git a / src / main / resources / assets / forge / lang / en _ US . lang b / src / main / resources / assets / forge / lang / en _ US . lang <nl> index 02c81a5 . . fcee7bc 100644 <nl> - - - a / src / main / resources / assets / forge / lang / en _ US . lang <nl> + + + b / src / main / resources / assets / forge / lang / en _ US . lang <nl> @ @ - 182 , 4 + 182 , 6 @ @ fml . messages . version . restriction . bounded = between % s and % s <nl> fml . button . visitjavadownloads = Oracle Java SE Downloads <nl> fml . button . continue = Continue <nl> fml . button . open . mods . folder = Open Mods Folder <nl> - fml . button . open . file = Open % s <nl> \ No newline at end of file <nl> + fml . button . open . file = Open % s <nl> + <nl> + forge . container . enchant . limitedEnchantability = Limited Enchantability <nl> \ No newline at end of file <nl> diff - - git a / src / test / java / net / minecraftforge / test / CanApplyAtEnchantingTableTest . java b / src / test / java / net / minecraftforge / test / CanApplyAtEnchantingTableTest . java <nl> new file mode 100644 <nl> index 0000000 . . 3984142 <nl> - - - / dev / null <nl> + + + b / src / test / java / net / minecraftforge / test / CanApplyAtEnchantingTableTest . java <nl> @ @ - 0 , 0 + 1 , 44 @ @ <nl> + package net . minecraftforge . test ; <nl> + <nl> + import net . minecraft . enchantment . Enchantment ; <nl> + import net . minecraft . init . Enchantments ; <nl> + import net . minecraft . item . Item ; <nl> + import net . minecraft . item . ItemStack ; <nl> + import net . minecraftforge . fml . common . Mod ; <nl> + import net . minecraftforge . fml . common . event . FMLPreInitializationEvent ; <nl> + import net . minecraftforge . fml . common . registry . GameRegistry ; <nl> + <nl> + @ Mod ( modid = " canapplyatenchantingtabletest " , name = " CanApplyAtEnchantingTableTest " , version = " 0 . 0 . 0 " ) <nl> + public class CanApplyAtEnchantingTableTest <nl> + { <nl> + public static final boolean ENABLE = true ; <nl> + <nl> + public static final Item testItem = new Item ( ) <nl> + { <nl> + public boolean isItemTool ( ItemStack stack ) <nl> + { <nl> + return true ; <nl> + } <nl> + <nl> + @ Override <nl> + public int getItemEnchantability ( ) <nl> + { <nl> + return 30 ; <nl> + } <nl> + <nl> + @ Override <nl> + public boolean canApplyAtEnchantingTable ( ItemStack stack , Enchantment enchantment ) <nl> + { <nl> + return super . canApplyAtEnchantingTable ( stack , enchantment ) | | enchantment = = Enchantments . FORTUNE ; <nl> + } <nl> + } ; <nl> + <nl> + @ Mod . EventHandler <nl> + public void preInit ( FMLPreInitializationEvent event ) <nl> + { <nl> + if ( ENABLE ) <nl> + { <nl> + GameRegistry . register ( testItem . setRegistryName ( " test _ item " ) . setUnlocalizedName ( " FortuneEnchantableOnly " ) . setMaxStackSize ( 1 ) ) ; <nl> + } <nl> + } <nl> + }
NEAREST DIFF (one line): diff - - git a / patches / minecraft / net / minecraft / enchantment / EnchantmentHelper . java . patch b / patches / minecraft / net / minecraft / enchantment / EnchantmentHelper . java . patch <nl> index 2d22d33 . . 242648e 100644 <nl> - - - a / patches / minecraft / net / minecraft / enchantment / EnchantmentHelper . java . patch <nl> + + + b / patches / minecraft / net / minecraft / enchantment / EnchantmentHelper . java . patch <nl> @ @ - 1 , 5 + 1 , 23 @ @ <nl> - - - . . / src - base / minecraft / net / minecraft / enchantment / EnchantmentHelper . java <nl> + + + . . / src - work / minecraft / net / minecraft / enchantment / EnchantmentHelper . java <nl> + @ @ - 293 , 7 + 293 , 7 @ @ <nl> + public static int func _ 77514 _ a ( Random p _ 77514 _ 0 _ , int p _ 77514 _ 1 _ , int p _ 77514 _ 2 _ , ItemStack p _ 77514 _ 3 _ ) <nl> + { <nl> + Item item = p _ 77514 _ 3 _ . func _ 77973 _ b ( ) ; <nl> + - int k = item . func _ 77619 _ b ( ) ; <nl> + + int k = item . getItemEnchantability ( p _ 77514 _ 3 _ ) ; <nl> + <nl> + if ( k < = 0 ) <nl> + { <nl> + @ @ - 346 , 7 + 346 , 7 @ @ <nl> + public static List func _ 77513 _ b ( Random p _ 77513 _ 0 _ , ItemStack p _ 77513 _ 1 _ , int p _ 77513 _ 2 _ ) <nl> + { <nl> + Item item = p _ 77513 _ 1 _ . func _ 77973 _ b ( ) ; <nl> + - int j = item . func _ 77619 _ b ( ) ; <nl> + + int j = item . getItemEnchantability ( p _ 77513 _ 1 _ ) ; <nl> + <nl> + if ( j < = 0 ) <nl> + { <nl> @ @ - 435 , 7 + 435 , 8 @ @ <nl> { <nl> Enchantment enchantment = aenchantment [ k ] ; <nl> diff - - git a / patches / minecraft / net / minecraft / item / Item . java . patch b / patches / minecraft / net / minecraft / item / Item . java . patch <nl> index fe62de3 . . 684dd0d 100644 <nl> - - - a / patches / minecraft / net / minecraft / item / Item . java . patch <nl> + + + b / patches / minecraft / net / minecraft / item / Item . java . patch <nl> @ @ - 104 , 7 + 104 , 7 @ @ <nl> public Multimap func _ 111205 _ h ( ) <nl> { <nl> return HashMultimap . create ( ) ; <nl> - @ @ - 726 , 6 + 744 , 570 @ @ <nl> + @ @ - 726 , 6 + 744 , 581 @ @ <nl> return this . field _ 111218 _ cA = = null ? " MISSING _ ICON _ ITEM _ " + field _ 150901 _ e . func _ 148757 _ b ( this ) + " _ " + this . field _ 77774 _ bZ : this . field _ 111218 _ cA ; <nl> } <nl> <nl> @ @ - 670 , 12 + 670 , 23 @ @ <nl> + Integer ret = toolClasses . get ( toolClass ) ; <nl> + return ret = = null ? - 1 : ret ; <nl> + } <nl> + + <nl> + + / * * <nl> + + * ItemStack sensitive version of getItemEnchantability <nl> + + * <nl> + + * @ param stack The ItemStack <nl> + + * @ return the item echantability value <nl> + + * / <nl> + + public int getItemEnchantability ( ItemStack stack ) <nl> + + { <nl> + + return func _ 77619 _ b ( ) ; <nl> + + } <nl> + / * = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = FORGE END = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = * / <nl> + <nl> public static enum ToolMaterial <nl> { <nl> WOOD ( 0 , 59 , 2 . 0F , 0 . 0F , 15 ) , <nl> - @ @ - 741 , 6 + 1323 , 9 @ @ <nl> + @ @ - 741 , 6 + 1334 , 9 @ @ <nl> <nl> private static final String _ _ OBFID = " CL _ 00000042 " ; <nl> <nl> @ @ - 685 , 7 + 696 , 7 @ @ <nl> private ToolMaterial ( int p _ i1874 _ 3 _ , int p _ i1874 _ 4 _ , float p _ i1874 _ 5 _ , float p _ i1874 _ 6 _ , int p _ i1874 _ 7 _ ) <nl> { <nl> this . field _ 78001 _ f = p _ i1874 _ 3 _ ; <nl> - @ @ - 777 , 7 + 1362 , 15 @ @ <nl> + @ @ - 777 , 7 + 1373 , 15 @ @ <nl> <nl> public Item func _ 150995 _ f ( ) <nl> {

TEST DIFF:
diff - - git a / patches / minecraft / net / minecraft / client / gui / GuiEnchantment . java . patch b / patches / minecraft / net / minecraft / client / gui / GuiEnchantment . java . patch 
 new file mode 100644 
 index 0000000 . . bd222a5 
 - - - / dev / null 
 + + + b / patches / minecraft / net / minecraft / client / gui / GuiEnchantment . java . patch 
 @ @ - 0 , 0 + 1 , 26 @ @ 
 + - - - . . / src - base / minecraft / net / minecraft / client / gui / GuiEnchantment . java 
 + + + + . . / src - work / minecraft / net / minecraft / client / gui / GuiEnchantment . java 
 + @ @ - 171 , 7 + 171 , 7 @ @ 
 + FontRenderer fontrenderer = this . field _ 146297 _ k . field _ 71464 _ q ; 
 + int i2 = 6839882 ; 
 + 
 + - if ( ( k < l + 1 | | this . field _ 146297 _ k . field _ 71439 _ g . field _ 71068 _ ca < k1 ) & & ! this . field _ 146297 _ k . field _ 71439 _ g . field _ 71075 _ bZ . field _ 75098 _ d ) 
 + + if ( ( ( k < l + 1 | | this . field _ 146297 _ k . field _ 71439 _ g . field _ 71068 _ ca < k1 ) & & ! this . field _ 146297 _ k . field _ 71439 _ g . field _ 71075 _ bZ . field _ 75098 _ d ) | | this . field _ 147075 _ G . field _ 185001 _ h [ l ] = = - 1 ) / / Forge : render buttons as disabled when enchantable but enchantability not met on lower levels 
 + { 
 + this . func _ 73729 _ b ( i1 , j + 14 + 19 * l , 0 , 185 , 108 , 19 ) ; 
 + this . func _ 73729 _ b ( i1 + 1 , j + 15 + 19 * l , 16 * l , 239 , 16 , 16 ) ; 
 + @ @ - 217 , 11 + 217 , 12 @ @ 
 + int l = this . field _ 147075 _ G . field _ 185002 _ i [ j ] ; 
 + int i1 = j + 1 ; 
 + 
 + - if ( this . func _ 146978 _ c ( 60 , 14 + 19 * j , 108 , 17 , p _ 73863 _ 1 _ , p _ 73863 _ 2 _ ) & & k > 0 & & l > = 0 & & enchantment ! = null ) 
 + + if ( this . func _ 146978 _ c ( 60 , 14 + 19 * j , 108 , 17 , p _ 73863 _ 1 _ , p _ 73863 _ 2 _ ) & & k > 0 ) 
 + { 
 + List < String > list = Lists . < String > newArrayList ( ) ; 
 + - list . add ( " " + TextFormatting . WHITE + TextFormatting . ITALIC + I18n . func _ 135052 _ a ( " container . enchant . clue " , new Object [ ] { enchantment . func _ 77316 _ c ( l ) } ) ) ; 
 + + list . add ( " " + TextFormatting . WHITE + TextFormatting . ITALIC + I18n . func _ 135052 _ a ( " container . enchant . clue " , new Object [ ] { enchantment = = null ? " " : enchantment . func _ 77316 _ c ( l ) } ) ) ; 
 + 
 + + if ( enchantment = = null ) java . util . Collections . addAll ( list , " " , TextFormatting . RED + I18n . func _ 135052 _ a ( " forge . container . enchant . limitedEnchantability " ) ) ; else 
 + if ( ! flag ) 
 + { 
 + list . add ( " " ) ; 
 diff - - git a / patches / minecraft / net / minecraft / enchantment / Enchantment . java . patch b / patches / minecraft / net / minecraft / enchantment / Enchantment . java . patch 
 index 487d39a . . 953607e 100644 
 - - - a / patches / minecraft / net / minecraft / enchantment / Enchantment . java . patch 
 + + + b / patches / minecraft / net / minecraft / enchantment / Enchantment . java . patch 
 @ @ - 33 , 7 + 33 , 7 @ @ 
 + * / 
 + public boolean canApplyAtEnchantingTable ( ItemStack stack ) 
 + { 
 - + return this . field _ 77351 _ y . func _ 77557 _ a ( stack . func _ 77973 _ b ( ) ) ; 
 + + return stack . func _ 77973 _ b ( ) . canApplyAtEnchantingTable ( stack , this ) ; 
 + } 
 + 
 + / * * 
 diff - - git a / patches / minecraft / net / minecraft / item / Item . java . patch b / patches / minecraft / net / minecraft / item / Item . java . patch 
 index 3909962 . . 4396e6a 100644 
 - - - a / patches / minecraft / net / minecraft / item / Item . java . patch 
 + + + b / patches / minecraft / net / minecraft / item / Item . java . patch 
 @ @ - 60 , 7 + 60 , 7 @ @ 
 return p _ 77621 _ 1 _ . func _ 147447 _ a ( vec3d , vec3d1 , p _ 77621 _ 3 _ , ! p _ 77621 _ 3 _ , false ) ; 
 } 
 
 - @ @ - 433 , 11 + 440 , 600 @ @ 
 + @ @ - 433 , 11 + 440 , 613 @ @ 
 return false ; 
 } 
 
 @ @ - 585 , 6 + 585 , 19 @ @ 
 + } 
 + 
 + / * * 
 + + * Checks whether an item can be enchanted with a certain enchantment . This applies specifically to enchanting an item in the enchanting table and is called when retrieving the list of possible enchantments for an item . 
 + + * Enchantments may additionally ( or exclusively ) be doing their own checks in { @ link net . minecraft . enchantment . Enchantment # canApplyAtEnchantingTable ( ItemStack ) } ; check the individual implementation for reference . 
 + + * By default this will check if the enchantment type is valid for this item type . 
 + + * @ param stack the item stack to be enchanted 
 + + * @ param enchantment the enchantment to be applied 
 + + * @ return true if the enchantment can be applied to this item 
 + + * / 
 + + public boolean canApplyAtEnchantingTable ( ItemStack stack , net . minecraft . enchantment . Enchantment enchantment ) 
 + + { 
 + + return enchantment . field _ 77351 _ y . func _ 77557 _ a ( stack . func _ 77973 _ b ( ) ) ; 
 + + } 
 + + 
 + + / * * 
 + * Whether this Item can be used as a payment to activate the vanilla beacon . 
 + * @ param stack the ItemStack 
 + * @ return true if this Item can be used 
 @ @ - 661 , 7 + 674 , 7 @ @ 
 public static void func _ 150900 _ l ( ) 
 { 
 func _ 179214 _ a ( Blocks . field _ 150350 _ a , new ItemAir ( Blocks . field _ 150350 _ a ) ) ; 
 - @ @ - 971 , 6 + 1567 , 8 @ @ 
 + @ @ - 971 , 6 + 1580 , 8 @ @ 
 private final float field _ 78010 _ h ; 
 private final float field _ 78011 _ i ; 
 private final int field _ 78008 _ j ; 
 @ @ - 670 , 7 + 683 , 7 @ @ 
 
 private ToolMaterial ( int p _ i1874 _ 3 _ , int p _ i1874 _ 4 _ , float p _ i1874 _ 5 _ , float p _ i1874 _ 6 _ , int p _ i1874 _ 7 _ ) 
 { 
 - @ @ - 1006 , 9 + 1604 , 26 @ @ 
 + @ @ - 1006 , 9 + 1617 , 26 @ @ 
 return this . field _ 78008 _ j ; 
 } 
 
 diff - - git a / src / main / resources / assets / forge / lang / en _ US . lang b / src / main / resources / assets / forge / lang / en _ US . lang 
 index 02c81a5 . . fcee7bc 100644 
 - - - a / src / main / resources / assets / forge / lang / en _ US . lang 
 + + + b / src / main / resources / assets / forge / lang / en _ US . lang 
 @ @ - 182 , 4 + 182 , 6 @ @ fml . messages . version . restriction . bounded = between % s and % s 
 fml . button . visitjavadownloads = Oracle Java SE Downloads 
 fml . button . continue = Continue 
 fml . button . open . mods . folder = Open Mods Folder 
 - fml . button . open . file = Open % s 
 \ No newline at end of file 
 + fml . button . open . file = Open % s 
 + 
 + forge . container . enchant . limitedEnchantability = Limited Enchantability 
 \ No newline at end of file 
 diff - - git a / src / test / java / net / minecraftforge / test / CanApplyAtEnchantingTableTest . java b / src / test / java / net / minecraftforge / test / CanApplyAtEnchantingTableTest . java 
 new file mode 100644 
 index 0000000 . . 3984142 
 - - - / dev / null 
 + + + b / src / test / java / net / minecraftforge / test / CanApplyAtEnchantingTableTest . java 
 @ @ - 0 , 0 + 1 , 44 @ @ 
 + package net . minecraftforge . test ; 
 + 
 + import net . minecraft . enchantment . Enchantment ; 
 + import net . minecraft . init . Enchantments ; 
 + import net . minecraft . item . Item ; 
 + import net . minecraft . item . ItemStack ; 
 + import net . minecraftforge . fml . common . Mod ; 
 + import net . minecraftforge . fml . common . event . FMLPreInitializationEvent ; 
 + import net . minecraftforge . fml . common . registry . GameRegistry ; 
 + 
 + @ Mod ( modid = " canapplyatenchantingtabletest " , name = " CanApplyAtEnchantingTableTest " , version = " 0 . 0 . 0 " ) 
 + public class CanApplyAtEnchantingTableTest 
 + { 
 + public static final boolean ENABLE = true ; 
 + 
 + public static final Item testItem = new Item ( ) 
 + { 
 + public boolean isItemTool ( ItemStack stack ) 
 + { 
 + return true ; 
 + } 
 + 
 + @ Override 
 + public int getItemEnchantability ( ) 
 + { 
 + return 30 ; 
 + } 
 + 
 + @ Override 
 + public boolean canApplyAtEnchantingTable ( ItemStack stack , Enchantment enchantment ) 
 + { 
 + return super . canApplyAtEnchantingTable ( stack , enchantment ) | | enchantment = = Enchantments . FORTUNE ; 
 + } 
 + } ; 
 + 
 + @ Mod . EventHandler 
 + public void preInit ( FMLPreInitializationEvent event ) 
 + { 
 + if ( ENABLE ) 
 + { 
 + GameRegistry . register ( testItem . setRegistryName ( " test _ item " ) . setUnlocalizedName ( " FortuneEnchantableOnly " ) . setMaxStackSize ( 1 ) ) ; 
 + } 
 + } 
 + }

NEAREST DIFF:
diff - - git a / patches / minecraft / net / minecraft / enchantment / EnchantmentHelper . java . patch b / patches / minecraft / net / minecraft / enchantment / EnchantmentHelper . java . patch 
 index 2d22d33 . . 242648e 100644 
 - - - a / patches / minecraft / net / minecraft / enchantment / EnchantmentHelper . java . patch 
 + + + b / patches / minecraft / net / minecraft / enchantment / EnchantmentHelper . java . patch 
 @ @ - 1 , 5 + 1 , 23 @ @ 
 - - - . . / src - base / minecraft / net / minecraft / enchantment / EnchantmentHelper . java 
 + + + . . / src - work / minecraft / net / minecraft / enchantment / EnchantmentHelper . java 
 + @ @ - 293 , 7 + 293 , 7 @ @ 
 + public static int func _ 77514 _ a ( Random p _ 77514 _ 0 _ , int p _ 77514 _ 1 _ , int p _ 77514 _ 2 _ , ItemStack p _ 77514 _ 3 _ ) 
 + { 
 + Item item = p _ 77514 _ 3 _ . func _ 77973 _ b ( ) ; 
 + - int k = item . func _ 77619 _ b ( ) ; 
 + + int k = item . getItemEnchantability ( p _ 77514 _ 3 _ ) ; 
 + 
 + if ( k < = 0 ) 
 + { 
 + @ @ - 346 , 7 + 346 , 7 @ @ 
 + public static List func _ 77513 _ b ( Random p _ 77513 _ 0 _ , ItemStack p _ 77513 _ 1 _ , int p _ 77513 _ 2 _ ) 
 + { 
 + Item item = p _ 77513 _ 1 _ . func _ 77973 _ b ( ) ; 
 + - int j = item . func _ 77619 _ b ( ) ; 
 + + int j = item . getItemEnchantability ( p _ 77513 _ 1 _ ) ; 
 + 
 + if ( j < = 0 ) 
 + { 
 @ @ - 435 , 7 + 435 , 8 @ @ 
 { 
 Enchantment enchantment = aenchantment [ k ] ; 
 diff - - git a / patches / minecraft / net / minecraft / item / Item . java . patch b / patches / minecraft / net / minecraft / item / Item . java . patch 
 index fe62de3 . . 684dd0d 100644 
 - - - a / patches / minecraft / net / minecraft / item / Item . java . patch 
 + + + b / patches / minecraft / net / minecraft / item / Item . java . patch 
 @ @ - 104 , 7 + 104 , 7 @ @ 
 public Multimap func _ 111205 _ h ( ) 
 { 
 return HashMultimap . create ( ) ; 
 - @ @ - 726 , 6 + 744 , 570 @ @ 
 + @ @ - 726 , 6 + 744 , 581 @ @ 
 return this . field _ 111218 _ cA = = null ? " MISSING _ ICON _ ITEM _ " + field _ 150901 _ e . func _ 148757 _ b ( this ) + " _ " + this . field _ 77774 _ bZ : this . field _ 111218 _ cA ; 
 } 
 
 @ @ - 670 , 12 + 670 , 23 @ @ 
 + Integer ret = toolClasses . get ( toolClass ) ; 
 + return ret = = null ? - 1 : ret ; 
 + } 
 + + 
 + + / * * 
 + + * ItemStack sensitive version of getItemEnchantability 
 + + * 
 + + * @ param stack The ItemStack 
 + + * @ return the item echantability value 
 + + * / 
 + + public int getItemEnchantability ( ItemStack stack ) 
 + + { 
 + + return func _ 77619 _ b ( ) ; 
 + + } 
 + / * = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = FORGE END = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = * / 
 + 
 public static enum ToolMaterial 
 { 
 WOOD ( 0 , 59 , 2 . 0F , 0 . 0F , 15 ) , 
 - @ @ - 741 , 6 + 1323 , 9 @ @ 
 + @ @ - 741 , 6 + 1334 , 9 @ @ 
 
 private static final String _ _ OBFID = " CL _ 00000042 " ; 
 
 @ @ - 685 , 7 + 696 , 7 @ @ 
 private ToolMaterial ( int p _ i1874 _ 3 _ , int p _ i1874 _ 4 _ , float p _ i1874 _ 5 _ , float p _ i1874 _ 6 _ , int p _ i1874 _ 7 _ ) 
 { 
 this . field _ 78001 _ f = p _ i1874 _ 3 _ ; 
 - @ @ - 777 , 7 + 1362 , 15 @ @ 
 + @ @ - 777 , 7 + 1373 , 15 @ @ 
 
 public Item func _ 150995 _ f ( ) 
 {
