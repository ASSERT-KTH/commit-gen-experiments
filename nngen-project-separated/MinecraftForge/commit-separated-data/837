BLEU SCORE: 0.010783469846969963

TEST MSG: Fix the entity shader hook
GENERATED MSG: Fixed color disabling not working for forge pipeline . Closes # 2286 .

TEST DIFF (one line): diff - - git a / patches / minecraft / net / minecraft / client / renderer / EntityRenderer . java . patch b / patches / minecraft / net / minecraft / client / renderer / EntityRenderer . java . patch <nl> index 35a1f9c . . 8ee9bcf 100644 <nl> - - - a / patches / minecraft / net / minecraft / client / renderer / EntityRenderer . java . patch <nl> + + + b / patches / minecraft / net / minecraft / client / renderer / EntityRenderer . java . patch <nl> @ @ - 4 , 7 + 4 , 7 @ @ <nl> { <nl> this . func _ 175069 _ a ( new ResourceLocation ( " shaders / post / invert . json " ) ) ; <nl> } <nl> - + else net . minecraftforge . client . ForgeHooksClient . loadEntityShader ( p _ 175066 _ 1 _ . getClass ( ) , this ) ; <nl> + + else net . minecraftforge . client . ForgeHooksClient . loadEntityShader ( p _ 175066 _ 1 _ , this ) ; <nl> } <nl> } <nl> <nl> diff - - git a / src / main / java / net / minecraftforge / client / ForgeHooksClient . java b / src / main / java / net / minecraftforge / client / ForgeHooksClient . java <nl> index 1641e96 . . 5b8cfea 100644 <nl> - - - a / src / main / java / net / minecraftforge / client / ForgeHooksClient . java <nl> + + + b / src / main / java / net / minecraftforge / client / ForgeHooksClient . java <nl> @ @ - 575 , 12 + 575 , 15 @ @ public class ForgeHooksClient <nl> return Optional . of ( new TRSRTransformation ( matrix ) ) ; <nl> } <nl> <nl> - public static void loadEntityShader ( Class < ? extends Entity > entityClass , EntityRenderer entityRenderer ) <nl> + public static void loadEntityShader ( Entity entity , EntityRenderer entityRenderer ) <nl> { <nl> - ResourceLocation shader = ClientRegistry . getEntityShader ( entityClass ) ; <nl> - if ( shader ! = null ) <nl> + if ( entity ! = null ) <nl> { <nl> - entityRenderer . loadShader ( shader ) ; <nl> + ResourceLocation shader = ClientRegistry . getEntityShader ( entity . getClass ( ) ) ; <nl> + if ( shader ! = null ) <nl> + { <nl> + entityRenderer . loadShader ( shader ) ; <nl> + } <nl> } <nl> } <nl> }
NEAREST DIFF (one line): diff - - git a / patches / minecraft / net / minecraft / client / renderer / WorldRenderer . java . patch b / patches / minecraft / net / minecraft / client / renderer / WorldRenderer . java . patch <nl> index 4b2f9e3 . . 65b5937 100644 <nl> - - - a / patches / minecraft / net / minecraft / client / renderer / WorldRenderer . java . patch <nl> + + + b / patches / minecraft / net / minecraft / client / renderer / WorldRenderer . java . patch <nl> @ @ - 1 , 6 + 1 , 6 @ @ <nl> - - - . . / src - base / minecraft / net / minecraft / client / renderer / WorldRenderer . java <nl> + + + . . / src - work / minecraft / net / minecraft / client / renderer / WorldRenderer . java <nl> - @ @ - 578 , 6 + 578 , 11 @ @ <nl> + @ @ - 578 , 6 + 578 , 16 @ @ <nl> } <nl> } <nl> <nl> @ @ - 9 , 6 + 9 , 11 @ @ <nl> + this . func _ 181670 _ b ( field _ 179011 _ q . func _ 177338 _ f ( ) / * / 4 * 4 * / ) ; <nl> + } <nl> + <nl> + + public boolean isColorDisabled ( ) <nl> + + { <nl> + + return field _ 78939 _ q ; <nl> + + } <nl> + + <nl> @ SideOnly ( Side . CLIENT ) <nl> public class State <nl> { <nl> diff - - git a / src / main / java / net / minecraftforge / client / model / pipeline / WorldRendererConsumer . java b / src / main / java / net / minecraftforge / client / model / pipeline / WorldRendererConsumer . java <nl> index fea7dff . . 3d268bf 100644 <nl> - - - a / src / main / java / net / minecraftforge / client / model / pipeline / WorldRendererConsumer . java <nl> + + + b / src / main / java / net / minecraftforge / client / model / pipeline / WorldRendererConsumer . java <nl> @ @ - 4 , 6 + 4 , 7 @ @ import java . util . Arrays ; <nl> <nl> import net . minecraft . client . renderer . WorldRenderer ; <nl> import net . minecraft . client . renderer . vertex . VertexFormat ; <nl> + import net . minecraft . client . renderer . vertex . VertexFormatElement . EnumUsage ; <nl> import net . minecraft . util . BlockPos ; <nl> import net . minecraft . util . EnumFacing ; <nl> <nl> @ @ - 12 , 6 + 13 , 7 @ @ import net . minecraft . util . EnumFacing ; <nl> * / <nl> public class WorldRendererConsumer implements IVertexConsumer <nl> { <nl> + private static final float [ ] dummyColor = new float [ ] { 1 , 1 , 1 , 1 } ; <nl> private final WorldRenderer renderer ; <nl> private final int [ ] quadData ; <nl> private int v = 0 ; <nl> @ @ - 31 , 8 + 33 , 13 @ @ public class WorldRendererConsumer implements IVertexConsumer <nl> <nl> public void put ( int e , float . . . data ) <nl> { <nl> - LightUtil . pack ( data , quadData , getVertexFormat ( ) , v , e ) ; <nl> - if ( e = = getVertexFormat ( ) . getElementCount ( ) - 1 ) <nl> + VertexFormat format = getVertexFormat ( ) ; <nl> + if ( renderer . isColorDisabled ( ) & & format . getElement ( e ) . getUsage ( ) = = EnumUsage . COLOR ) <nl> + { <nl> + data = dummyColor ; <nl> + } <nl> + LightUtil . pack ( data , quadData , format , v , e ) ; <nl> + if ( e = = format . getElementCount ( ) - 1 ) <nl> { <nl> v + + ; <nl> if ( v = = 4 )

TEST DIFF:
diff - - git a / patches / minecraft / net / minecraft / client / renderer / EntityRenderer . java . patch b / patches / minecraft / net / minecraft / client / renderer / EntityRenderer . java . patch 
 index 35a1f9c . . 8ee9bcf 100644 
 - - - a / patches / minecraft / net / minecraft / client / renderer / EntityRenderer . java . patch 
 + + + b / patches / minecraft / net / minecraft / client / renderer / EntityRenderer . java . patch 
 @ @ - 4 , 7 + 4 , 7 @ @ 
 { 
 this . func _ 175069 _ a ( new ResourceLocation ( " shaders / post / invert . json " ) ) ; 
 } 
 - + else net . minecraftforge . client . ForgeHooksClient . loadEntityShader ( p _ 175066 _ 1 _ . getClass ( ) , this ) ; 
 + + else net . minecraftforge . client . ForgeHooksClient . loadEntityShader ( p _ 175066 _ 1 _ , this ) ; 
 } 
 } 
 
 diff - - git a / src / main / java / net / minecraftforge / client / ForgeHooksClient . java b / src / main / java / net / minecraftforge / client / ForgeHooksClient . java 
 index 1641e96 . . 5b8cfea 100644 
 - - - a / src / main / java / net / minecraftforge / client / ForgeHooksClient . java 
 + + + b / src / main / java / net / minecraftforge / client / ForgeHooksClient . java 
 @ @ - 575 , 12 + 575 , 15 @ @ public class ForgeHooksClient 
 return Optional . of ( new TRSRTransformation ( matrix ) ) ; 
 } 
 
 - public static void loadEntityShader ( Class < ? extends Entity > entityClass , EntityRenderer entityRenderer ) 
 + public static void loadEntityShader ( Entity entity , EntityRenderer entityRenderer ) 
 { 
 - ResourceLocation shader = ClientRegistry . getEntityShader ( entityClass ) ; 
 - if ( shader ! = null ) 
 + if ( entity ! = null ) 
 { 
 - entityRenderer . loadShader ( shader ) ; 
 + ResourceLocation shader = ClientRegistry . getEntityShader ( entity . getClass ( ) ) ; 
 + if ( shader ! = null ) 
 + { 
 + entityRenderer . loadShader ( shader ) ; 
 + } 
 } 
 } 
 }

NEAREST DIFF:
diff - - git a / patches / minecraft / net / minecraft / client / renderer / WorldRenderer . java . patch b / patches / minecraft / net / minecraft / client / renderer / WorldRenderer . java . patch 
 index 4b2f9e3 . . 65b5937 100644 
 - - - a / patches / minecraft / net / minecraft / client / renderer / WorldRenderer . java . patch 
 + + + b / patches / minecraft / net / minecraft / client / renderer / WorldRenderer . java . patch 
 @ @ - 1 , 6 + 1 , 6 @ @ 
 - - - . . / src - base / minecraft / net / minecraft / client / renderer / WorldRenderer . java 
 + + + . . / src - work / minecraft / net / minecraft / client / renderer / WorldRenderer . java 
 - @ @ - 578 , 6 + 578 , 11 @ @ 
 + @ @ - 578 , 6 + 578 , 16 @ @ 
 } 
 } 
 
 @ @ - 9 , 6 + 9 , 11 @ @ 
 + this . func _ 181670 _ b ( field _ 179011 _ q . func _ 177338 _ f ( ) / * / 4 * 4 * / ) ; 
 + } 
 + 
 + + public boolean isColorDisabled ( ) 
 + + { 
 + + return field _ 78939 _ q ; 
 + + } 
 + + 
 @ SideOnly ( Side . CLIENT ) 
 public class State 
 { 
 diff - - git a / src / main / java / net / minecraftforge / client / model / pipeline / WorldRendererConsumer . java b / src / main / java / net / minecraftforge / client / model / pipeline / WorldRendererConsumer . java 
 index fea7dff . . 3d268bf 100644 
 - - - a / src / main / java / net / minecraftforge / client / model / pipeline / WorldRendererConsumer . java 
 + + + b / src / main / java / net / minecraftforge / client / model / pipeline / WorldRendererConsumer . java 
 @ @ - 4 , 6 + 4 , 7 @ @ import java . util . Arrays ; 
 
 import net . minecraft . client . renderer . WorldRenderer ; 
 import net . minecraft . client . renderer . vertex . VertexFormat ; 
 + import net . minecraft . client . renderer . vertex . VertexFormatElement . EnumUsage ; 
 import net . minecraft . util . BlockPos ; 
 import net . minecraft . util . EnumFacing ; 
 
 @ @ - 12 , 6 + 13 , 7 @ @ import net . minecraft . util . EnumFacing ; 
 * / 
 public class WorldRendererConsumer implements IVertexConsumer 
 { 
 + private static final float [ ] dummyColor = new float [ ] { 1 , 1 , 1 , 1 } ; 
 private final WorldRenderer renderer ; 
 private final int [ ] quadData ; 
 private int v = 0 ; 
 @ @ - 31 , 8 + 33 , 13 @ @ public class WorldRendererConsumer implements IVertexConsumer 
 
 public void put ( int e , float . . . data ) 
 { 
 - LightUtil . pack ( data , quadData , getVertexFormat ( ) , v , e ) ; 
 - if ( e = = getVertexFormat ( ) . getElementCount ( ) - 1 ) 
 + VertexFormat format = getVertexFormat ( ) ; 
 + if ( renderer . isColorDisabled ( ) & & format . getElement ( e ) . getUsage ( ) = = EnumUsage . COLOR ) 
 + { 
 + data = dummyColor ; 
 + } 
 + LightUtil . pack ( data , quadData , format , v , e ) ; 
 + if ( e = = format . getElementCount ( ) - 1 ) 
 { 
 v + + ; 
 if ( v = = 4 )
