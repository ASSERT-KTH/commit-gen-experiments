BLEU SCORE: 0.005820564441072186

TEST MSG: Add support for custom entity selectors in commands
GENERATED MSG: Fix up the setHandeled / setHandled for events , it is now a generalized setResult , the meaning of which is defined by each event .

TEST DIFF (one line): diff - - git a / patches / minecraft / net / minecraft / command / EntitySelector . java . patch b / patches / minecraft / net / minecraft / command / EntitySelector . java . patch <nl> index 7780106 . . c95b86b 100644 <nl> - - - a / patches / minecraft / net / minecraft / command / EntitySelector . java . patch <nl> + + + b / patches / minecraft / net / minecraft / command / EntitySelector . java . patch <nl> @ @ - 5 , 10 + 5 , 18 @ @ <nl> public class EntitySelector <nl> { <nl> - private static final Pattern field _ 82389 _ a = Pattern . compile ( " ^ @ ( [ pare ] ) ( ? : \ \ [ ( [ \ \ w = , ! - ] * ) \ \ ] ) ? $ " ) ; <nl> - + private static final Pattern field _ 82389 _ a = Pattern . compile ( " ^ @ ( [ pare ] ) ( ? : \ \ [ ( [ \ \ w \ \ . = , ! - ] * ) \ \ ] ) ? $ " ) ; / / FORGE : allow . in entity selectors <nl> + + private static final Pattern field _ 82389 _ a = Pattern . compile ( " ^ @ ( [ pare ] ) ( ? : \ \ [ ( [ \ \ w \ \ . : = , ! - ] * ) \ \ ] ) ? $ " ) ; / / FORGE : allow ' . ' and ' : ' in entity selectors <nl> private static final Pattern field _ 82387 _ b = Pattern . compile ( " \ \ G ( [ - ! ] ? [ \ \ w - ] * ) ( ? : $ | , ) " ) ; <nl> - private static final Pattern field _ 82388 _ c = Pattern . compile ( " \ \ G ( \ \ w + ) = ( [ - ! ] ? [ \ \ w - ] * ) ( ? : $ | , ) " ) ; <nl> - + private static final Pattern field _ 82388 _ c = Pattern . compile ( " \ \ G ( \ \ w + ) = ( [ - ! ] ? [ \ \ w \ \ . - ] * ) ( ? : $ | , ) " ) ; / / FORGE : allow . in entity selectors <nl> + + private static final Pattern field _ 82388 _ c = Pattern . compile ( " \ \ G ( [ \ \ w : ] + ) = ( [ - ! ] ? [ \ \ w \ \ . - ] * ) ( ? : $ | , ) " ) ; / / FORGE : allow ' : ' in arguments and ' . ' in value of entity selectors <nl> private static final Set < String > field _ 179666 _ d = Sets . newHashSet ( new String [ ] { " x " , " y " , " z " , " dx " , " dy " , " dz " , " rm " , " r " } ) ; <nl> <nl> @ Nullable <nl> + @ @ - 111 , 6 + 111 , 7 @ @ <nl> + list2 . addAll ( func _ 184951 _ f ( map ) ) ; <nl> + list2 . addAll ( func _ 180698 _ a ( map , vec3d ) ) ; <nl> + list2 . addAll ( func _ 179662 _ g ( map ) ) ; <nl> + + list2 . addAll ( net . minecraftforge . event . ForgeEventFactory . gatherEntitySelectors ( map , s , p _ 179656 _ 0 _ , vec3d ) ) ; <nl> + list1 . addAll ( func _ 179660 _ a ( map , p _ 179656 _ 2 _ , list2 , s , world , blockpos ) ) ; <nl> + } <nl> + } <nl> diff - - git a / src / main / java / net / minecraftforge / event / EntitySelectorEvent . java b / src / main / java / net / minecraftforge / event / EntitySelectorEvent . java <nl> new file mode 100644 <nl> index 0000000 . . c2aefdd <nl> - - - / dev / null <nl> + + + b / src / main / java / net / minecraftforge / event / EntitySelectorEvent . java <nl> @ @ - 0 , 0 + 1 , 121 @ @ <nl> + / * <nl> + * Minecraft Forge <nl> + * Copyright ( c ) 2016 . <nl> + * <nl> + * This library is free software ; you can redistribute it and / or <nl> + * modify it under the terms of the GNU Lesser General Public <nl> + * License as published by the Free Software Foundation version 2 . 1 <nl> + * of the License . <nl> + * <nl> + * This library is distributed in the hope that it will be useful , <nl> + * but WITHOUT ANY WARRANTY ; without even the implied warranty of <nl> + * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE . See the GNU <nl> + * Lesser General Public License for more details . <nl> + * <nl> + * You should have received a copy of the GNU Lesser General Public <nl> + * License along with this library ; if not , write to the Free Software <nl> + * Foundation , Inc . , 51 Franklin Street , Fifth Floor , Boston , MA 02110 - 1301 USA <nl> + * / <nl> + <nl> + package net . minecraftforge . event ; <nl> + <nl> + import com . google . common . base . Predicate ; <nl> + import com . google . common . collect . Lists ; <nl> + import net . minecraft . command . EntitySelector ; <nl> + import net . minecraft . command . ICommandSender ; <nl> + import net . minecraft . entity . Entity ; <nl> + import net . minecraft . util . math . Vec3d ; <nl> + import net . minecraftforge . common . MinecraftForge ; <nl> + import net . minecraftforge . fml . common . eventhandler . Event ; <nl> + <nl> + import java . util . List ; <nl> + import java . util . Map ; <nl> + <nl> + / * * <nl> + * EntitySelectorEvent is fired whenever Minecraft collects entity selectors . <nl> + * This happens ( one or multiple times ) when you use something like @ a [ gamemode = 1 ] in a command . < br > <nl> + * This event is fired via { @ link ForgeEventFactory # gatherEntitySelectors ( Map , String , ICommandSender , Vec3d ) } , <nl> + * which is executed in { @ link net . minecraft . command . EntitySelector # matchEntities ( ICommandSender , String , Class ) } < br > <nl> + * < br > <nl> + * This event is not cancelable and does not have a result . < br > <nl> + * < br > <nl> + * This event is fired on the { @ link MinecraftForge # EVENT _ BUS } <nl> + * / <nl> + public class EntitySelectorEvent extends Event <nl> + { <nl> + <nl> + private final Map < String , String > map ; <nl> + private final String mainSelector ; <nl> + private final ICommandSender sender ; <nl> + private final Vec3d position ; <nl> + private final List < Predicate < Entity > > selectors ; <nl> + <nl> + public EntitySelectorEvent ( Map < String , String > map , String mainSelector , ICommandSender sender , Vec3d position ) <nl> + { <nl> + this . map = map ; <nl> + this . mainSelector = mainSelector ; <nl> + this . sender = sender ; <nl> + this . position = position ; <nl> + selectors = Lists . newArrayList ( ) ; <nl> + } <nl> + <nl> + / * * <nl> + * Add your custom selector . <nl> + * It is recommend to use " modid : name " , if checking for own arguments , to avoid inter - mod interference ( e . g . " @ a [ Forge : timeplayed = 100 ] " ) . <nl> + * <nl> + * @ param selector Your custom predicate <nl> + * / <nl> + public void addPredicate ( Predicate < Entity > selector ) <nl> + { <nl> + if ( selector = = null ) <nl> + { <nl> + throw new NullPointerException ( " Attempted to add null predicate as entity selector " ) ; <nl> + } <nl> + selectors . add ( selector ) ; <nl> + } <nl> + <nl> + / * * <nl> + * @ return The main selector used ( e . g . ' a ' for all players or ' e ' for all entities ) <nl> + * / <nl> + public String getMainSelector ( ) <nl> + { <nl> + return mainSelector ; <nl> + } <nl> + <nl> + / * * <nl> + * Example : " @ a [ test = true ] " would result in a map with " test " = > " true " <nl> + * <nl> + * @ return The argument map . Maps all given argument names with its value . <nl> + * / <nl> + public Map < String , String > getArgumentMap ( ) <nl> + { <nl> + return map ; <nl> + } <nl> + <nl> + / * * <nl> + * See { @ link EntitySelector # getPosFromArguments ( Map , Vec3d ) } <nl> + * <nl> + * @ return A position either specified in the selector arguments or by the players position . <nl> + * / <nl> + public Vec3d getPosition ( ) <nl> + { <nl> + return position ; <nl> + } <nl> + <nl> + / * * <nl> + * @ return The sender of the command . <nl> + * / <nl> + public ICommandSender getSender ( ) <nl> + { <nl> + return sender ; <nl> + } <nl> + <nl> + / * * <nl> + * @ return The list of added custom selectors <nl> + * / <nl> + List < Predicate < Entity > > getSelectors ( ) <nl> + { <nl> + return selectors ; <nl> + } <nl> + <nl> + } <nl> diff - - git a / src / main / java / net / minecraftforge / event / ForgeEventFactory . java b / src / main / java / net / minecraftforge / event / ForgeEventFactory . java <nl> index 5aa9ee0 . . 73d3419 100644 <nl> - - - a / src / main / java / net / minecraftforge / event / ForgeEventFactory . java <nl> + + + b / src / main / java / net / minecraftforge / event / ForgeEventFactory . java <nl> @ @ - 22 , 9 + 22 , 12 @ @ package net . minecraftforge . event ; <nl> import java . io . File ; <nl> import java . util . EnumSet ; <nl> import java . util . List ; <nl> + import java . util . Map ; <nl> import java . util . Random ; <nl> <nl> + import com . google . common . base . Predicate ; <nl> import net . minecraft . block . state . IBlockState ; <nl> + import net . minecraft . command . ICommandSender ; <nl> import net . minecraft . entity . Entity ; <nl> import net . minecraft . entity . EntityLiving ; <nl> import net . minecraft . entity . EntityLivingBase ; <nl> @ @ - 242 , 6 + 245 , 13 @ @ public class ForgeEventFactory <nl> return event . getDisplayname ( ) ; <nl> } <nl> <nl> + public static List < Predicate < Entity > > gatherEntitySelectors ( Map < String , String > map , String mainSelector , ICommandSender sender , Vec3d position ) <nl> + { <nl> + EntitySelectorEvent event = new EntitySelectorEvent ( map , mainSelector , sender , position ) ; <nl> + MinecraftForge . EVENT _ BUS . post ( event ) ; <nl> + return event . getSelectors ( ) ; <nl> + } <nl> + <nl> public static float fireBlockHarvesting ( List < ItemStack > drops , World world , BlockPos pos , IBlockState state , int fortune , float dropChance , boolean silkTouch , EntityPlayer player ) <nl> { <nl> BlockEvent . HarvestDropsEvent event = new BlockEvent . HarvestDropsEvent ( world , pos , state , fortune , dropChance , drops , player , silkTouch ) ;
NEAREST DIFF (one line): diff - - git a / common / net / minecraftforge / event / Event . java b / common / net / minecraftforge / event / Event . java <nl> index 15947ca . . bd530ae 100644 <nl> - - - a / common / net / minecraftforge / event / Event . java <nl> + + + b / common / net / minecraftforge / event / Event . java <nl> @ @ - 1 , 11 + 1 , 21 @ @ <nl> package net . minecraftforge . event ; <nl> <nl> + import static java . lang . annotation . ElementType . TYPE ; <nl> + import static java . lang . annotation . RetentionPolicy . RUNTIME ; <nl> + <nl> + import java . lang . annotation . Retention ; <nl> + import java . lang . annotation . Target ; <nl> + <nl> <nl> / * * <nl> * Base Event class that all other events are derived from <nl> * / <nl> public class Event <nl> { <nl> + @ Retention ( value = RUNTIME ) <nl> + @ Target ( value = TYPE ) <nl> + public @ interface HasResult { } <nl> + <nl> public enum Result <nl> { <nl> DENY , <nl> @ @ - 15 , 25 + 25 , 31 @ @ public class Event <nl> <nl> private boolean isCanceled = false ; <nl> private final boolean isCancelable ; <nl> + private Result result = Result . DEFAULT ; <nl> + private final boolean hasResult ; <nl> private static ListenerList listeners = new ListenerList ( ) ; <nl> <nl> public Event ( ) <nl> { <nl> setup ( ) ; <nl> + isCancelable = hasAnnotation ( Cancelable . class ) ; <nl> + hasResult = hasAnnotation ( HasResult . class ) ; <nl> + } <nl> + <nl> + private boolean hasAnnotation ( Class annotation ) <nl> + { <nl> Class cls = this . getClass ( ) ; <nl> - boolean found = false ; <nl> while ( cls ! = Event . class ) <nl> { <nl> if ( cls . isAnnotationPresent ( Cancelable . class ) ) <nl> { <nl> - found = true ; <nl> - break ; <nl> + return true ; <nl> } <nl> cls = cls . getSuperclass ( ) ; <nl> } <nl> - isCancelable = found ; <nl> + return false ; <nl> } <nl> - <nl> + <nl> / * * <nl> * Determine if this function is cancelable at all . <nl> * @ return If access to setCanceled should be allowed <nl> @ @ - 42 , 7 + 58 , 7 @ @ public class Event <nl> { <nl> return isCancelable ; <nl> } <nl> - <nl> + <nl> / * * <nl> * Determine if this event is canceled and should stop executing . <nl> * @ return The current canceled state <nl> @ @ - 51 , 7 + 67 , 7 @ @ public class Event <nl> { <nl> return isCanceled ; <nl> } <nl> - <nl> + <nl> / * * <nl> * Sets the state of this event , not all events are cancelable , and any attempt to <nl> * cancel a event that can ' t be will result in a IllegalArgumentException . <nl> @ @ - 68 , 7 + 84 , 35 @ @ public class Event <nl> } <nl> isCanceled = cancel ; <nl> } <nl> - <nl> + <nl> + / * * <nl> + * Determines if this event expects a significant result value . <nl> + * / <nl> + public boolean hasResult ( ) <nl> + { <nl> + return hasResult ; <nl> + } <nl> + <nl> + / * * <nl> + * Returns the value set as the result of this event <nl> + * / <nl> + public Result getResult ( ) <nl> + { <nl> + return result ; <nl> + } <nl> + <nl> + / * * <nl> + * Sets the result value for this event , not all events can have a result set , and any attempt to <nl> + * set a result for a event that isn ' t expecting it will result in a IllegalArgumentException . <nl> + * <nl> + * The functionality of setting the result is defined on a per - event bases . <nl> + * <nl> + * @ param value The new result <nl> + * / <nl> + public void setResult ( Result value ) <nl> + { <nl> + result = value ; <nl> + } <nl> / * * <nl> * Called by the base constructor , this is used by ASM generated <nl> * event classes to setup various functionality such as the listener ' s list . <nl> diff - - git a / common / net / minecraftforge / event / entity / UseHoeEvent . java b / common / net / minecraftforge / event / entity / UseHoeEvent . java <nl> deleted file mode 100644 <nl> index c012c91 . . 0000000 <nl> - - - a / common / net / minecraftforge / event / entity / UseHoeEvent . java <nl> + + + / dev / null <nl> @ @ - 1 , 40 + 0 , 0 @ @ <nl> - package net . minecraftforge . event . entity ; <nl> - <nl> - import net . minecraft . src . EntityPlayer ; <nl> - import net . minecraft . src . ItemStack ; <nl> - import net . minecraft . src . World ; <nl> - import net . minecraftforge . event . Cancelable ; <nl> - import net . minecraftforge . event . entity . player . PlayerEvent ; <nl> - <nl> - @ Cancelable <nl> - public class UseHoeEvent extends PlayerEvent <nl> - { <nl> - <nl> - public final ItemStack current ; <nl> - public final World world ; <nl> - public final int x ; <nl> - public final int y ; <nl> - public final int z ; <nl> - <nl> - private boolean handeled = false ; <nl> - <nl> - public UseHoeEvent ( EntityPlayer player , ItemStack current , World world , int x , int y , int z ) <nl> - { <nl> - super ( player ) ; <nl> - this . current = current ; <nl> - this . world = world ; <nl> - this . x = x ; <nl> - this . y = y ; <nl> - this . z = z ; <nl> - } <nl> - <nl> - public boolean isHandeled ( ) <nl> - { <nl> - return handeled ; <nl> - } <nl> - <nl> - public void setHandeled ( ) <nl> - { <nl> - handeled = true ; <nl> - } <nl> - } <nl> diff - - git a / common / net / minecraftforge / event / entity / living / LivingSpecialSpawnEvent . java b / common / net / minecraftforge / event / entity / living / LivingSpecialSpawnEvent . java <nl> index f6e555e . . 2186967 100644 <nl> - - - a / common / net / minecraftforge / event / entity / living / LivingSpecialSpawnEvent . java <nl> + + + b / common / net / minecraftforge / event / entity / living / LivingSpecialSpawnEvent . java <nl> @ @ - 2 , 7 + 2 , 9 @ @ package net . minecraftforge . event . entity . living ; <nl> <nl> import net . minecraft . src . EntityLiving ; <nl> import net . minecraft . src . World ; <nl> + import net . minecraftforge . event . Cancelable ; <nl> <nl> + @ Cancelable <nl> public class LivingSpecialSpawnEvent extends LivingEvent <nl> { <nl> public final World world ; <nl> @ @ - 19 , 14 + 21 , 4 @ @ public class LivingSpecialSpawnEvent extends LivingEvent <nl> this . y = y ; <nl> this . z = z ; <nl> } <nl> - <nl> - public void setHandeled ( ) <nl> - { <nl> - handeled = true ; <nl> - } <nl> - <nl> - public boolean isHandeled ( ) <nl> - { <nl> - return handeled ; <nl> - } <nl> } <nl> diff - - git a / common / net / minecraftforge / event / entity / player / BonemealEvent . java b / common / net / minecraftforge / event / entity / player / BonemealEvent . java <nl> index 8126d71 . . 894d431 100644 <nl> - - - a / common / net / minecraftforge / event / entity / player / BonemealEvent . java <nl> + + + b / common / net / minecraftforge / event / entity / player / BonemealEvent . java <nl> @ @ - 3 , 16 + 3 , 27 @ @ package net . minecraftforge . event . entity . player ; <nl> import net . minecraft . src . EntityPlayer ; <nl> import net . minecraft . src . World ; <nl> import net . minecraftforge . event . Cancelable ; <nl> + import net . minecraftforge . event . Event ; <nl> <nl> @ Cancelable <nl> + @ Event . HasResult <nl> public class BonemealEvent extends PlayerEvent <nl> { <nl> + / * * <nl> + * This event is called when a player attempts to use Bonemeal on a block . <nl> + * It can be canceled to completely prevent any further processing . <nl> + * <nl> + * You can also set the result to ALLOW to mark the event as processed <nl> + * and use up a bonemeal from the stack but do no further processing . <nl> + * <nl> + * setResult ( ALLOW ) is the same as the old setHandeled ( ) <nl> + * / <nl> + <nl> public final World world ; <nl> public final int ID ; <nl> public final int X ; <nl> public final int Y ; <nl> public final int Z ; <nl> - private boolean handeled = false ; <nl> <nl> public BonemealEvent ( EntityPlayer player , World world , int id , int x , int y , int z ) <nl> { <nl> @ @ - 23 , 14 + 34 , 4 @ @ public class BonemealEvent extends PlayerEvent <nl> this . Y = y ; <nl> this . Z = z ; <nl> } <nl> - <nl> - public void setHandeled ( ) <nl> - { <nl> - handeled = true ; <nl> - } <nl> - <nl> - public boolean isHandeled ( ) <nl> - { <nl> - return handeled ; <nl> - } <nl> } <nl> diff - - git a / common / net / minecraftforge / event / entity / player / EntityItemPickupEvent . java b / common / net / minecraftforge / event / entity / player / EntityItemPickupEvent . java <nl> index 5d2156e . . 8a690dc 100644 <nl> - - - a / common / net / minecraftforge / event / entity / player / EntityItemPickupEvent . java <nl> + + + b / common / net / minecraftforge / event / entity / player / EntityItemPickupEvent . java <nl> @ @ - 4 , 26 + 4 , 29 @ @ import net . minecraft . src . Entity ; <nl> import net . minecraft . src . EntityItem ; <nl> import net . minecraft . src . EntityPlayer ; <nl> import net . minecraftforge . event . Cancelable ; <nl> + import net . minecraftforge . event . Event ; <nl> <nl> @ Cancelable <nl> + @ Event . HasResult <nl> public class EntityItemPickupEvent extends PlayerEvent <nl> { <nl> + / * * <nl> + * This event is called when a player collides with a EntityItem on the ground . <nl> + * The event can be canceled , and no further processing will be done . <nl> + * <nl> + * You can set the result of this event to ALLOW which will trigger the <nl> + * processing of achievements , FML ' s event , play the sound , and kill the <nl> + * entity if all the items are picked up . <nl> + * <nl> + * setResult ( ALLOW ) is the same as the old setHandled ( ) <nl> + * / <nl> + <nl> public final EntityItem item ; <nl> private boolean handled = false ; <nl> - <nl> + <nl> public EntityItemPickupEvent ( EntityPlayer player , EntityItem item ) <nl> { <nl> super ( player ) ; <nl> this . item = item ; <nl> } <nl> - <nl> - public boolean isHandled ( ) <nl> - { <nl> - return handled ; <nl> - } <nl> - <nl> - public void setHandled ( ) <nl> - { <nl> - handled = true ; <nl> - } <nl> } <nl> diff - - git a / common / net / minecraftforge / event / entity / player / FillBucketEvent . java b / common / net / minecraftforge / event / entity / player / FillBucketEvent . java <nl> index c110fba . . e09b454 100644 <nl> - - - a / common / net / minecraftforge / event / entity / player / FillBucketEvent . java <nl> + + + b / common / net / minecraftforge / event / entity / player / FillBucketEvent . java <nl> @ @ - 5 , 17 + 5 , 28 @ @ import net . minecraft . src . ItemStack ; <nl> import net . minecraft . src . MovingObjectPosition ; <nl> import net . minecraft . src . World ; <nl> import net . minecraftforge . event . Cancelable ; <nl> + import net . minecraftforge . event . Event ; <nl> <nl> @ Cancelable <nl> + @ Event . HasResult <nl> public class FillBucketEvent extends PlayerEvent <nl> { <nl> + / * * <nl> + * This event is fired when a player attempts to use a Empty bucket , it <nl> + * can be canceled to completely prevent any further processing . <nl> + * <nl> + * If you set the result to ' ALLOW ' , it means that you have processed <nl> + * the event and wants the basic functionality of adding the new <nl> + * ItemStack to your inventory and reducing the stack size to process . <nl> + * setResult ( ALLOW ) is the same as the old setHandeled ( ) ; <nl> + * / <nl> + <nl> public final ItemStack current ; <nl> public final World world ; <nl> public final MovingObjectPosition target ; <nl> - <nl> + <nl> public ItemStack result ; <nl> - private boolean handeled = false ; <nl> - <nl> + <nl> public FillBucketEvent ( EntityPlayer player , ItemStack current , World world , MovingObjectPosition target ) <nl> { <nl> super ( player ) ; <nl> @ @ - 23 , 14 + 34 , 4 @ @ public class FillBucketEvent extends PlayerEvent <nl> this . world = world ; <nl> this . target = target ; <nl> } <nl> - <nl> - public boolean isHandeled ( ) <nl> - { <nl> - return handeled ; <nl> - } <nl> - <nl> - public void setHandeled ( ) <nl> - { <nl> - handeled = true ; <nl> - } <nl> } <nl> diff - - git a / common / net / minecraftforge / event / entity / player / UseHoeEvent . java b / common / net / minecraftforge / event / entity / player / UseHoeEvent . java <nl> new file mode 100644 <nl> index 0000000 . . ac8793b <nl> - - - / dev / null <nl> + + + b / common / net / minecraftforge / event / entity / player / UseHoeEvent . java <nl> @ @ - 0 , 0 + 1 , 40 @ @ <nl> + package net . minecraftforge . event . entity . player ; <nl> + <nl> + import net . minecraft . src . EntityPlayer ; <nl> + import net . minecraft . src . ItemStack ; <nl> + import net . minecraft . src . World ; <nl> + import net . minecraftforge . event . Cancelable ; <nl> + import net . minecraftforge . event . Event ; <nl> + <nl> + @ Cancelable <nl> + @ Event . HasResult <nl> + public class UseHoeEvent extends PlayerEvent <nl> + { <nl> + / * * <nl> + * This event is fired when a player attempts to use a Hoe on a block , it <nl> + * can be canceled to completely prevent any further processing . <nl> + * <nl> + * You can also set the result to ALLOW to mark the event as processed <nl> + * and damage the hoe . <nl> + * <nl> + * setResult ( ALLOW ) is the same as the old setHandeled ( ) ; <nl> + * / <nl> + <nl> + public final ItemStack current ; <nl> + public final World world ; <nl> + public final int x ; <nl> + public final int y ; <nl> + public final int z ; <nl> + <nl> + private boolean handeled = false ; <nl> + <nl> + public UseHoeEvent ( EntityPlayer player , ItemStack current , World world , int x , int y , int z ) <nl> + { <nl> + super ( player ) ; <nl> + this . current = current ; <nl> + this . world = world ; <nl> + this . x = x ; <nl> + this . y = y ; <nl> + this . z = z ; <nl> + } <nl> + } <nl> diff - - git a / patches / common / net / minecraft / src / EntityItem . java . patch b / patches / common / net / minecraft / src / EntityItem . java . patch <nl> index a038362 . . 4e2edaf 100644 <nl> - - - a / patches / common / net / minecraft / src / EntityItem . java . patch <nl> + + + b / patches / common / net / minecraft / src / EntityItem . java . patch <nl> @ @ - 1 , 17 + 1 , 18 @ @ <nl> - - - . . / src _ base / common / net / minecraft / src / EntityItem . java <nl> + + + . . / src _ work / common / net / minecraft / src / EntityItem . java <nl> - @ @ - 1 , 6 + 1 , 10 @ @ <nl> + @ @ - 1 , 6 + 1 , 11 @ @ <nl> package net . minecraft . src ; <nl> <nl> import java . util . Iterator ; <nl> + <nl> + import net . minecraftforge . common . MinecraftForge ; <nl> + + import net . minecraftforge . event . Event . Result ; <nl> + import net . minecraftforge . event . entity . item . ItemExpireEvent ; <nl> + import net . minecraftforge . event . entity . player . EntityItemPickupEvent ; <nl> <nl> import cpw . mods . fml . common . registry . GameRegistry ; <nl> <nl> - @ @ - 20 , 6 + 24 , 11 @ @ <nl> + @ @ - 20 , 6 + 25 , 11 @ @ <nl> <nl> / * * The EntityItem ' s random initial float height . * / <nl> public float hoverStart = ( float ) ( Math . random ( ) * Math . PI * 2 . 0D ) ; <nl> @ @ - 23 , 7 + 24 , 7 @ @ <nl> <nl> public EntityItem ( World par1World , double par2 , double par4 , double par6 , ItemStack par8ItemStack ) <nl> { <nl> - @ @ - 32 , 6 + 41 , 7 @ @ <nl> + @ @ - 32 , 6 + 42 , 7 @ @ <nl> this . motionX = ( double ) ( ( float ) ( Math . random ( ) * 0 . 20000000298023224D - 0 . 10000000149011612D ) ) ; <nl> this . motionY = 0 . 20000000298023224D ; <nl> this . motionZ = ( double ) ( ( float ) ( Math . random ( ) * 0 . 20000000298023224D - 0 . 10000000149011612D ) ) ; <nl> @ @ - 31 , 7 + 32 , 7 @ @ <nl> } <nl> <nl> / * * <nl> - @ @ - 118 , 7 + 128 , 20 @ @ <nl> + @ @ - 118 , 7 + 129 , 20 @ @ <nl> <nl> + + this . age ; <nl> <nl> @ @ - 53 , 7 + 54 , 7 @ @ <nl> { <nl> this . setDead ( ) ; <nl> } <nl> - @ @ - 215 , 6 + 238 , 7 @ @ <nl> + @ @ - 215 , 6 + 239 , 7 @ @ <nl> { <nl> par1NBTTagCompound . setShort ( " Health " , ( short ) ( ( byte ) this . health ) ) ; <nl> par1NBTTagCompound . setShort ( " Age " , ( short ) this . age ) ; <nl> @ @ - 61 , 7 + 62 , 7 @ @ <nl> <nl> if ( this . item ! = null ) <nl> { <nl> - @ @ - 232 , 10 + 256 , 15 @ @ <nl> + @ @ - 232 , 10 + 257 , 15 @ @ <nl> NBTTagCompound var2 = par1NBTTagCompound . getCompoundTag ( " Item " ) ; <nl> this . item = ItemStack . loadItemStackFromNBT ( var2 ) ; <nl> <nl> @ @ - 78 , 7 + 79 , 7 @ @ <nl> } <nl> <nl> / * * <nl> - @ @ - 245 , 9 + 274 , 21 @ @ <nl> + @ @ - 245 , 9 + 275 , 21 @ @ <nl> { <nl> if ( ! this . worldObj . isRemote ) <nl> { <nl> @ @ - 97 , 7 + 98 , 7 @ @ <nl> int var2 = this . item . stackSize ; <nl> <nl> - if ( this . delayBeforeCanPickup = = 0 & & par1EntityPlayer . inventory . addItemStackToInventory ( this . item ) ) <nl> - + if ( this . delayBeforeCanPickup < = 0 & & ( event . isHandled ( ) | | var2 < = 0 | | par1EntityPlayer . inventory . addItemStackToInventory ( this . item ) ) ) <nl> + + if ( this . delayBeforeCanPickup < = 0 & & ( event . getResult ( ) = = Result . ALLOW | | var2 < = 0 | | par1EntityPlayer . inventory . addItemStackToInventory ( this . item ) ) ) <nl> { <nl> if ( this . item . itemID = = Block . wood . blockID ) <nl> { <nl> diff - - git a / patches / common / net / minecraft / src / ItemBucket . java . patch b / patches / common / net / minecraft / src / ItemBucket . java . patch <nl> index 4da9c72 . . f6b0a12 100644 <nl> - - - a / patches / common / net / minecraft / src / ItemBucket . java . patch <nl> + + + b / patches / common / net / minecraft / src / ItemBucket . java . patch <nl> @ @ - 1 , 14 + 1 , 15 @ @ <nl> - - - . . / src _ base / common / net / minecraft / src / ItemBucket . java <nl> + + + . . / src _ work / common / net / minecraft / src / ItemBucket . java <nl> - @ @ - 1 , 4 + 1 , 7 @ @ <nl> + @ @ - 1 , 4 + 1 , 8 @ @ <nl> package net . minecraft . src ; <nl> + <nl> + import net . minecraftforge . common . MinecraftForge ; <nl> + + import net . minecraftforge . event . Event ; <nl> + import net . minecraftforge . event . entity . player . FillBucketEvent ; <nl> <nl> public class ItemBucket extends Item <nl> { <nl> - @ @ - 31 , 6 + 34 , 32 @ @ <nl> + @ @ - 31 , 6 + 35 , 32 @ @ <nl> } <nl> else <nl> { <nl> @ @ - 18 , 7 + 19 , 7 @ @ <nl> + return par1ItemStack ; <nl> + } <nl> + <nl> - + if ( event . isHandeled ( ) ) <nl> + + if ( event . getResult ( ) = = Event . Result . ALLOW ) <nl> + { <nl> + if ( par3EntityPlayer . capabilities . isCreativeMode ) <nl> + { <nl> diff - - git a / patches / common / net / minecraft / src / ItemDye . java . patch b / patches / common / net / minecraft / src / ItemDye . java . patch <nl> index c8c7ef6 . . 9df29f0 100644 <nl> - - - a / patches / common / net / minecraft / src / ItemDye . java . patch <nl> + + + b / patches / common / net / minecraft / src / ItemDye . java . patch <nl> @ @ - 1 , 17 + 1 , 18 @ @ <nl> - - - . . / src _ base / common / net / minecraft / src / ItemDye . java <nl> + + + . . / src _ work / common / net / minecraft / src / ItemDye . java <nl> - @ @ - 3 , 6 + 3 , 10 @ @ <nl> + @ @ - 3 , 6 + 3 , 11 @ @ <nl> import cpw . mods . fml . common . Side ; <nl> import cpw . mods . fml . common . asm . SideOnly ; <nl> import java . util . List ; <nl> + <nl> + import net . minecraftforge . common . ForgeHooks ; <nl> + import net . minecraftforge . common . MinecraftForge ; <nl> + + import net . minecraftforge . event . Event . Result ; <nl> + import net . minecraftforge . event . entity . player . BonemealEvent ; <nl> <nl> public class ItemDye extends Item <nl> { <nl> - @ @ - 53 , 6 + 57 , 21 @ @ <nl> + @ @ - 53 , 6 + 58 , 21 @ @ <nl> if ( par1ItemStack . getItemDamage ( ) = = 15 ) <nl> { <nl> var11 = par3World . getBlockId ( par4 , par5 , par6 ) ; <nl> @ @ - 22 , 9 + 23 , 9 @ @ <nl> + return false ; <nl> + } <nl> + <nl> - + if ( event . isHandeled ( ) ) <nl> + + if ( event . getResult ( ) = = Result . ALLOW ) <nl> + { <nl> - + if ( ! par3World . isRemote ) <nl> + + if ( ! par3World . isRemote ) <nl> + { <nl> + par1ItemStack . stackSize - - ; <nl> + } <nl> @ @ - 33 , 7 + 34 , 7 @ @ <nl> <nl> if ( var11 = = Block . sapling . blockID ) <nl> { <nl> - @ @ - 152 , 16 + 171 , 9 @ @ <nl> + @ @ - 152 , 16 + 172 , 9 @ @ <nl> par3World . setBlockAndMetadataWithNotify ( var13 , var14 , var15 , Block . tallGrass . blockID , 1 ) ; <nl> } <nl> } <nl> diff - - git a / patches / common / net / minecraft / src / ItemHoe . java . patch b / patches / common / net / minecraft / src / ItemHoe . java . patch <nl> index 6565cee . . 4605d0c 100644 <nl> - - - a / patches / common / net / minecraft / src / ItemHoe . java . patch <nl> + + + b / patches / common / net / minecraft / src / ItemHoe . java . patch <nl> @ @ - 1 , 14 + 1 , 15 @ @ <nl> - - - . . / src _ base / common / net / minecraft / src / ItemHoe . java <nl> + + + . . / src _ work / common / net / minecraft / src / ItemHoe . java <nl> - @ @ - 1 , 5 + 1 , 7 @ @ <nl> + @ @ - 1 , 5 + 1 , 8 @ @ <nl> package net . minecraft . src ; <nl> <nl> + import net . minecraftforge . common . MinecraftForge ; <nl> - + import net . minecraftforge . event . entity . UseHoeEvent ; <nl> + + import net . minecraftforge . event . Event . Result ; <nl> + + import net . minecraftforge . event . entity . player . UseHoeEvent ; <nl> import cpw . mods . fml . common . Side ; <nl> import cpw . mods . fml . common . asm . SideOnly ; <nl> <nl> - @ @ - 28 , 6 + 30 , 17 @ @ <nl> + @ @ - 28 , 6 + 31 , 18 @ @ <nl> } <nl> else <nl> { <nl> @ @ - 17 , 7 + 18 , 8 @ @ <nl> + { <nl> + return false ; <nl> + } <nl> - + if ( event . isHandeled ( ) ) <nl> + + <nl> + + if ( event . getResult ( ) = = Result . ALLOW ) <nl> + { <nl> + par1ItemStack . damageItem ( 1 , par2EntityPlayer ) ; <nl> + return true ; <nl> diff - - git a / patches / common / net / minecraft / src / SpawnerAnimals . java . patch b / patches / common / net / minecraft / src / SpawnerAnimals . java . patch <nl> index f5726b9 . . fffe071 100644 <nl> - - - a / patches / common / net / minecraft / src / SpawnerAnimals . java . patch <nl> + + + b / patches / common / net / minecraft / src / SpawnerAnimals . java . patch <nl> @ @ - 35 , 13 + 35 , 11 @ @ <nl> } <nl> } <nl> <nl> - @ @ - 216 , 6 + 225 , 13 @ @ <nl> + @ @ - 216 , 6 + 225 , 11 @ @ <nl> * / <nl> private static void creatureSpecificInit ( EntityLiving par0EntityLiving , World par1World , float par2 , float par3 , float par4 ) <nl> { <nl> - + LivingSpecialSpawnEvent event = new LivingSpecialSpawnEvent ( par0EntityLiving , par1World , par2 , par3 , par4 ) ; <nl> - + MinecraftForge . EVENT _ BUS . post ( event ) ; <nl> - + if ( event . isHandeled ( ) ) <nl> + + if ( MinecraftForge . EVENT _ BUS . post ( new LivingSpecialSpawnEvent ( par0EntityLiving , par1World , par2 , par3 , par4 ) ) ) <nl> + { <nl> + return ; <nl> + }

TEST DIFF:
diff - - git a / patches / minecraft / net / minecraft / command / EntitySelector . java . patch b / patches / minecraft / net / minecraft / command / EntitySelector . java . patch 
 index 7780106 . . c95b86b 100644 
 - - - a / patches / minecraft / net / minecraft / command / EntitySelector . java . patch 
 + + + b / patches / minecraft / net / minecraft / command / EntitySelector . java . patch 
 @ @ - 5 , 10 + 5 , 18 @ @ 
 public class EntitySelector 
 { 
 - private static final Pattern field _ 82389 _ a = Pattern . compile ( " ^ @ ( [ pare ] ) ( ? : \ \ [ ( [ \ \ w = , ! - ] * ) \ \ ] ) ? $ " ) ; 
 - + private static final Pattern field _ 82389 _ a = Pattern . compile ( " ^ @ ( [ pare ] ) ( ? : \ \ [ ( [ \ \ w \ \ . = , ! - ] * ) \ \ ] ) ? $ " ) ; / / FORGE : allow . in entity selectors 
 + + private static final Pattern field _ 82389 _ a = Pattern . compile ( " ^ @ ( [ pare ] ) ( ? : \ \ [ ( [ \ \ w \ \ . : = , ! - ] * ) \ \ ] ) ? $ " ) ; / / FORGE : allow ' . ' and ' : ' in entity selectors 
 private static final Pattern field _ 82387 _ b = Pattern . compile ( " \ \ G ( [ - ! ] ? [ \ \ w - ] * ) ( ? : $ | , ) " ) ; 
 - private static final Pattern field _ 82388 _ c = Pattern . compile ( " \ \ G ( \ \ w + ) = ( [ - ! ] ? [ \ \ w - ] * ) ( ? : $ | , ) " ) ; 
 - + private static final Pattern field _ 82388 _ c = Pattern . compile ( " \ \ G ( \ \ w + ) = ( [ - ! ] ? [ \ \ w \ \ . - ] * ) ( ? : $ | , ) " ) ; / / FORGE : allow . in entity selectors 
 + + private static final Pattern field _ 82388 _ c = Pattern . compile ( " \ \ G ( [ \ \ w : ] + ) = ( [ - ! ] ? [ \ \ w \ \ . - ] * ) ( ? : $ | , ) " ) ; / / FORGE : allow ' : ' in arguments and ' . ' in value of entity selectors 
 private static final Set < String > field _ 179666 _ d = Sets . newHashSet ( new String [ ] { " x " , " y " , " z " , " dx " , " dy " , " dz " , " rm " , " r " } ) ; 
 
 @ Nullable 
 + @ @ - 111 , 6 + 111 , 7 @ @ 
 + list2 . addAll ( func _ 184951 _ f ( map ) ) ; 
 + list2 . addAll ( func _ 180698 _ a ( map , vec3d ) ) ; 
 + list2 . addAll ( func _ 179662 _ g ( map ) ) ; 
 + + list2 . addAll ( net . minecraftforge . event . ForgeEventFactory . gatherEntitySelectors ( map , s , p _ 179656 _ 0 _ , vec3d ) ) ; 
 + list1 . addAll ( func _ 179660 _ a ( map , p _ 179656 _ 2 _ , list2 , s , world , blockpos ) ) ; 
 + } 
 + } 
 diff - - git a / src / main / java / net / minecraftforge / event / EntitySelectorEvent . java b / src / main / java / net / minecraftforge / event / EntitySelectorEvent . java 
 new file mode 100644 
 index 0000000 . . c2aefdd 
 - - - / dev / null 
 + + + b / src / main / java / net / minecraftforge / event / EntitySelectorEvent . java 
 @ @ - 0 , 0 + 1 , 121 @ @ 
 + / * 
 + * Minecraft Forge 
 + * Copyright ( c ) 2016 . 
 + * 
 + * This library is free software ; you can redistribute it and / or 
 + * modify it under the terms of the GNU Lesser General Public 
 + * License as published by the Free Software Foundation version 2 . 1 
 + * of the License . 
 + * 
 + * This library is distributed in the hope that it will be useful , 
 + * but WITHOUT ANY WARRANTY ; without even the implied warranty of 
 + * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE . See the GNU 
 + * Lesser General Public License for more details . 
 + * 
 + * You should have received a copy of the GNU Lesser General Public 
 + * License along with this library ; if not , write to the Free Software 
 + * Foundation , Inc . , 51 Franklin Street , Fifth Floor , Boston , MA 02110 - 1301 USA 
 + * / 
 + 
 + package net . minecraftforge . event ; 
 + 
 + import com . google . common . base . Predicate ; 
 + import com . google . common . collect . Lists ; 
 + import net . minecraft . command . EntitySelector ; 
 + import net . minecraft . command . ICommandSender ; 
 + import net . minecraft . entity . Entity ; 
 + import net . minecraft . util . math . Vec3d ; 
 + import net . minecraftforge . common . MinecraftForge ; 
 + import net . minecraftforge . fml . common . eventhandler . Event ; 
 + 
 + import java . util . List ; 
 + import java . util . Map ; 
 + 
 + / * * 
 + * EntitySelectorEvent is fired whenever Minecraft collects entity selectors . 
 + * This happens ( one or multiple times ) when you use something like @ a [ gamemode = 1 ] in a command . < br > 
 + * This event is fired via { @ link ForgeEventFactory # gatherEntitySelectors ( Map , String , ICommandSender , Vec3d ) } , 
 + * which is executed in { @ link net . minecraft . command . EntitySelector # matchEntities ( ICommandSender , String , Class ) } < br > 
 + * < br > 
 + * This event is not cancelable and does not have a result . < br > 
 + * < br > 
 + * This event is fired on the { @ link MinecraftForge # EVENT _ BUS } 
 + * / 
 + public class EntitySelectorEvent extends Event 
 + { 
 + 
 + private final Map < String , String > map ; 
 + private final String mainSelector ; 
 + private final ICommandSender sender ; 
 + private final Vec3d position ; 
 + private final List < Predicate < Entity > > selectors ; 
 + 
 + public EntitySelectorEvent ( Map < String , String > map , String mainSelector , ICommandSender sender , Vec3d position ) 
 + { 
 + this . map = map ; 
 + this . mainSelector = mainSelector ; 
 + this . sender = sender ; 
 + this . position = position ; 
 + selectors = Lists . newArrayList ( ) ; 
 + } 
 + 
 + / * * 
 + * Add your custom selector . 
 + * It is recommend to use " modid : name " , if checking for own arguments , to avoid inter - mod interference ( e . g . " @ a [ Forge : timeplayed = 100 ] " ) . 
 + * 
 + * @ param selector Your custom predicate 
 + * / 
 + public void addPredicate ( Predicate < Entity > selector ) 
 + { 
 + if ( selector = = null ) 
 + { 
 + throw new NullPointerException ( " Attempted to add null predicate as entity selector " ) ; 
 + } 
 + selectors . add ( selector ) ; 
 + } 
 + 
 + / * * 
 + * @ return The main selector used ( e . g . ' a ' for all players or ' e ' for all entities ) 
 + * / 
 + public String getMainSelector ( ) 
 + { 
 + return mainSelector ; 
 + } 
 + 
 + / * * 
 + * Example : " @ a [ test = true ] " would result in a map with " test " = > " true " 
 + * 
 + * @ return The argument map . Maps all given argument names with its value . 
 + * / 
 + public Map < String , String > getArgumentMap ( ) 
 + { 
 + return map ; 
 + } 
 + 
 + / * * 
 + * See { @ link EntitySelector # getPosFromArguments ( Map , Vec3d ) } 
 + * 
 + * @ return A position either specified in the selector arguments or by the players position . 
 + * / 
 + public Vec3d getPosition ( ) 
 + { 
 + return position ; 
 + } 
 + 
 + / * * 
 + * @ return The sender of the command . 
 + * / 
 + public ICommandSender getSender ( ) 
 + { 
 + return sender ; 
 + } 
 + 
 + / * * 
 + * @ return The list of added custom selectors 
 + * / 
 + List < Predicate < Entity > > getSelectors ( ) 
 + { 
 + return selectors ; 
 + } 
 + 
 + } 
 diff - - git a / src / main / java / net / minecraftforge / event / ForgeEventFactory . java b / src / main / java / net / minecraftforge / event / ForgeEventFactory . java 
 index 5aa9ee0 . . 73d3419 100644 
 - - - a / src / main / java / net / minecraftforge / event / ForgeEventFactory . java 
 + + + b / src / main / java / net / minecraftforge / event / ForgeEventFactory . java 
 @ @ - 22 , 9 + 22 , 12 @ @ package net . minecraftforge . event ; 
 import java . io . File ; 
 import java . util . EnumSet ; 
 import java . util . List ; 
 + import java . util . Map ; 
 import java . util . Random ; 
 
 + import com . google . common . base . Predicate ; 
 import net . minecraft . block . state . IBlockState ; 
 + import net . minecraft . command . ICommandSender ; 
 import net . minecraft . entity . Entity ; 
 import net . minecraft . entity . EntityLiving ; 
 import net . minecraft . entity . EntityLivingBase ; 
 @ @ - 242 , 6 + 245 , 13 @ @ public class ForgeEventFactory 
 return event . getDisplayname ( ) ; 
 } 
 
 + public static List < Predicate < Entity > > gatherEntitySelectors ( Map < String , String > map , String mainSelector , ICommandSender sender , Vec3d position ) 
 + { 
 + EntitySelectorEvent event = new EntitySelectorEvent ( map , mainSelector , sender , position ) ; 
 + MinecraftForge . EVENT _ BUS . post ( event ) ; 
 + return event . getSelectors ( ) ; 
 + } 
 + 
 public static float fireBlockHarvesting ( List < ItemStack > drops , World world , BlockPos pos , IBlockState state , int fortune , float dropChance , boolean silkTouch , EntityPlayer player ) 
 { 
 BlockEvent . HarvestDropsEvent event = new BlockEvent . HarvestDropsEvent ( world , pos , state , fortune , dropChance , drops , player , silkTouch ) ;

NEAREST DIFF:
diff - - git a / common / net / minecraftforge / event / Event . java b / common / net / minecraftforge / event / Event . java 
 index 15947ca . . bd530ae 100644 
 - - - a / common / net / minecraftforge / event / Event . java 
 + + + b / common / net / minecraftforge / event / Event . java 
 @ @ - 1 , 11 + 1 , 21 @ @ 
 package net . minecraftforge . event ; 
 
 + import static java . lang . annotation . ElementType . TYPE ; 
 + import static java . lang . annotation . RetentionPolicy . RUNTIME ; 
 + 
 + import java . lang . annotation . Retention ; 
 + import java . lang . annotation . Target ; 
 + 
 
 / * * 
 * Base Event class that all other events are derived from 
 * / 
 public class Event 
 { 
 + @ Retention ( value = RUNTIME ) 
 + @ Target ( value = TYPE ) 
 + public @ interface HasResult { } 
 + 
 public enum Result 
 { 
 DENY , 
 @ @ - 15 , 25 + 25 , 31 @ @ public class Event 
 
 private boolean isCanceled = false ; 
 private final boolean isCancelable ; 
 + private Result result = Result . DEFAULT ; 
 + private final boolean hasResult ; 
 private static ListenerList listeners = new ListenerList ( ) ; 
 
 public Event ( ) 
 { 
 setup ( ) ; 
 + isCancelable = hasAnnotation ( Cancelable . class ) ; 
 + hasResult = hasAnnotation ( HasResult . class ) ; 
 + } 
 + 
 + private boolean hasAnnotation ( Class annotation ) 
 + { 
 Class cls = this . getClass ( ) ; 
 - boolean found = false ; 
 while ( cls ! = Event . class ) 
 { 
 if ( cls . isAnnotationPresent ( Cancelable . class ) ) 
 { 
 - found = true ; 
 - break ; 
 + return true ; 
 } 
 cls = cls . getSuperclass ( ) ; 
 } 
 - isCancelable = found ; 
 + return false ; 
 } 
 - 
 + 
 / * * 
 * Determine if this function is cancelable at all . 
 * @ return If access to setCanceled should be allowed 
 @ @ - 42 , 7 + 58 , 7 @ @ public class Event 
 { 
 return isCancelable ; 
 } 
 - 
 + 
 / * * 
 * Determine if this event is canceled and should stop executing . 
 * @ return The current canceled state 
 @ @ - 51 , 7 + 67 , 7 @ @ public class Event 
 { 
 return isCanceled ; 
 } 
 - 
 + 
 / * * 
 * Sets the state of this event , not all events are cancelable , and any attempt to 
 * cancel a event that can ' t be will result in a IllegalArgumentException . 
 @ @ - 68 , 7 + 84 , 35 @ @ public class Event 
 } 
 isCanceled = cancel ; 
 } 
 - 
 + 
 + / * * 
 + * Determines if this event expects a significant result value . 
 + * / 
 + public boolean hasResult ( ) 
 + { 
 + return hasResult ; 
 + } 
 + 
 + / * * 
 + * Returns the value set as the result of this event 
 + * / 
 + public Result getResult ( ) 
 + { 
 + return result ; 
 + } 
 + 
 + / * * 
 + * Sets the result value for this event , not all events can have a result set , and any attempt to 
 + * set a result for a event that isn ' t expecting it will result in a IllegalArgumentException . 
 + * 
 + * The functionality of setting the result is defined on a per - event bases . 
 + * 
 + * @ param value The new result 
 + * / 
 + public void setResult ( Result value ) 
 + { 
 + result = value ; 
 + } 
 / * * 
 * Called by the base constructor , this is used by ASM generated 
 * event classes to setup various functionality such as the listener ' s list . 
 diff - - git a / common / net / minecraftforge / event / entity / UseHoeEvent . java b / common / net / minecraftforge / event / entity / UseHoeEvent . java 
 deleted file mode 100644 
 index c012c91 . . 0000000 
 - - - a / common / net / minecraftforge / event / entity / UseHoeEvent . java 
 + + + / dev / null 
 @ @ - 1 , 40 + 0 , 0 @ @ 
 - package net . minecraftforge . event . entity ; 
 - 
 - import net . minecraft . src . EntityPlayer ; 
 - import net . minecraft . src . ItemStack ; 
 - import net . minecraft . src . World ; 
 - import net . minecraftforge . event . Cancelable ; 
 - import net . minecraftforge . event . entity . player . PlayerEvent ; 
 - 
 - @ Cancelable 
 - public class UseHoeEvent extends PlayerEvent 
 - { 
 - 
 - public final ItemStack current ; 
 - public final World world ; 
 - public final int x ; 
 - public final int y ; 
 - public final int z ; 
 - 
 - private boolean handeled = false ; 
 - 
 - public UseHoeEvent ( EntityPlayer player , ItemStack current , World world , int x , int y , int z ) 
 - { 
 - super ( player ) ; 
 - this . current = current ; 
 - this . world = world ; 
 - this . x = x ; 
 - this . y = y ; 
 - this . z = z ; 
 - } 
 - 
 - public boolean isHandeled ( ) 
 - { 
 - return handeled ; 
 - } 
 - 
 - public void setHandeled ( ) 
 - { 
 - handeled = true ; 
 - } 
 - } 
 diff - - git a / common / net / minecraftforge / event / entity / living / LivingSpecialSpawnEvent . java b / common / net / minecraftforge / event / entity / living / LivingSpecialSpawnEvent . java 
 index f6e555e . . 2186967 100644 
 - - - a / common / net / minecraftforge / event / entity / living / LivingSpecialSpawnEvent . java 
 + + + b / common / net / minecraftforge / event / entity / living / LivingSpecialSpawnEvent . java 
 @ @ - 2 , 7 + 2 , 9 @ @ package net . minecraftforge . event . entity . living ; 
 
 import net . minecraft . src . EntityLiving ; 
 import net . minecraft . src . World ; 
 + import net . minecraftforge . event . Cancelable ; 
 
 + @ Cancelable 
 public class LivingSpecialSpawnEvent extends LivingEvent 
 { 
 public final World world ; 
 @ @ - 19 , 14 + 21 , 4 @ @ public class LivingSpecialSpawnEvent extends LivingEvent 
 this . y = y ; 
 this . z = z ; 
 } 
 - 
 - public void setHandeled ( ) 
 - { 
 - handeled = true ; 
 - } 
 - 
 - public boolean isHandeled ( ) 
 - { 
 - return handeled ; 
 - } 
 } 
 diff - - git a / common / net / minecraftforge / event / entity / player / BonemealEvent . java b / common / net / minecraftforge / event / entity / player / BonemealEvent . java 
 index 8126d71 . . 894d431 100644 
 - - - a / common / net / minecraftforge / event / entity / player / BonemealEvent . java 
 + + + b / common / net / minecraftforge / event / entity / player / BonemealEvent . java 
 @ @ - 3 , 16 + 3 , 27 @ @ package net . minecraftforge . event . entity . player ; 
 import net . minecraft . src . EntityPlayer ; 
 import net . minecraft . src . World ; 
 import net . minecraftforge . event . Cancelable ; 
 + import net . minecraftforge . event . Event ; 
 
 @ Cancelable 
 + @ Event . HasResult 
 public class BonemealEvent extends PlayerEvent 
 { 
 + / * * 
 + * This event is called when a player attempts to use Bonemeal on a block . 
 + * It can be canceled to completely prevent any further processing . 
 + * 
 + * You can also set the result to ALLOW to mark the event as processed 
 + * and use up a bonemeal from the stack but do no further processing . 
 + * 
 + * setResult ( ALLOW ) is the same as the old setHandeled ( ) 
 + * / 
 + 
 public final World world ; 
 public final int ID ; 
 public final int X ; 
 public final int Y ; 
 public final int Z ; 
 - private boolean handeled = false ; 
 
 public BonemealEvent ( EntityPlayer player , World world , int id , int x , int y , int z ) 
 { 
 @ @ - 23 , 14 + 34 , 4 @ @ public class BonemealEvent extends PlayerEvent 
 this . Y = y ; 
 this . Z = z ; 
 } 
 - 
 - public void setHandeled ( ) 
 - { 
 - handeled = true ; 
 - } 
 - 
 - public boolean isHandeled ( ) 
 - { 
 - return handeled ; 
 - } 
 } 
 diff - - git a / common / net / minecraftforge / event / entity / player / EntityItemPickupEvent . java b / common / net / minecraftforge / event / entity / player / EntityItemPickupEvent . java 
 index 5d2156e . . 8a690dc 100644 
 - - - a / common / net / minecraftforge / event / entity / player / EntityItemPickupEvent . java 
 + + + b / common / net / minecraftforge / event / entity / player / EntityItemPickupEvent . java 
 @ @ - 4 , 26 + 4 , 29 @ @ import net . minecraft . src . Entity ; 
 import net . minecraft . src . EntityItem ; 
 import net . minecraft . src . EntityPlayer ; 
 import net . minecraftforge . event . Cancelable ; 
 + import net . minecraftforge . event . Event ; 
 
 @ Cancelable 
 + @ Event . HasResult 
 public class EntityItemPickupEvent extends PlayerEvent 
 { 
 + / * * 
 + * This event is called when a player collides with a EntityItem on the ground . 
 + * The event can be canceled , and no further processing will be done . 
 + * 
 + * You can set the result of this event to ALLOW which will trigger the 
 + * processing of achievements , FML ' s event , play the sound , and kill the 
 + * entity if all the items are picked up . 
 + * 
 + * setResult ( ALLOW ) is the same as the old setHandled ( ) 
 + * / 
 + 
 public final EntityItem item ; 
 private boolean handled = false ; 
 - 
 + 
 public EntityItemPickupEvent ( EntityPlayer player , EntityItem item ) 
 { 
 super ( player ) ; 
 this . item = item ; 
 } 
 - 
 - public boolean isHandled ( ) 
 - { 
 - return handled ; 
 - } 
 - 
 - public void setHandled ( ) 
 - { 
 - handled = true ; 
 - } 
 } 
 diff - - git a / common / net / minecraftforge / event / entity / player / FillBucketEvent . java b / common / net / minecraftforge / event / entity / player / FillBucketEvent . java 
 index c110fba . . e09b454 100644 
 - - - a / common / net / minecraftforge / event / entity / player / FillBucketEvent . java 
 + + + b / common / net / minecraftforge / event / entity / player / FillBucketEvent . java 
 @ @ - 5 , 17 + 5 , 28 @ @ import net . minecraft . src . ItemStack ; 
 import net . minecraft . src . MovingObjectPosition ; 
 import net . minecraft . src . World ; 
 import net . minecraftforge . event . Cancelable ; 
 + import net . minecraftforge . event . Event ; 
 
 @ Cancelable 
 + @ Event . HasResult 
 public class FillBucketEvent extends PlayerEvent 
 { 
 + / * * 
 + * This event is fired when a player attempts to use a Empty bucket , it 
 + * can be canceled to completely prevent any further processing . 
 + * 
 + * If you set the result to ' ALLOW ' , it means that you have processed 
 + * the event and wants the basic functionality of adding the new 
 + * ItemStack to your inventory and reducing the stack size to process . 
 + * setResult ( ALLOW ) is the same as the old setHandeled ( ) ; 
 + * / 
 + 
 public final ItemStack current ; 
 public final World world ; 
 public final MovingObjectPosition target ; 
 - 
 + 
 public ItemStack result ; 
 - private boolean handeled = false ; 
 - 
 + 
 public FillBucketEvent ( EntityPlayer player , ItemStack current , World world , MovingObjectPosition target ) 
 { 
 super ( player ) ; 
 @ @ - 23 , 14 + 34 , 4 @ @ public class FillBucketEvent extends PlayerEvent 
 this . world = world ; 
 this . target = target ; 
 } 
 - 
 - public boolean isHandeled ( ) 
 - { 
 - return handeled ; 
 - } 
 - 
 - public void setHandeled ( ) 
 - { 
 - handeled = true ; 
 - } 
 } 
 diff - - git a / common / net / minecraftforge / event / entity / player / UseHoeEvent . java b / common / net / minecraftforge / event / entity / player / UseHoeEvent . java 
 new file mode 100644 
 index 0000000 . . ac8793b 
 - - - / dev / null 
 + + + b / common / net / minecraftforge / event / entity / player / UseHoeEvent . java 
 @ @ - 0 , 0 + 1 , 40 @ @ 
 + package net . minecraftforge . event . entity . player ; 
 + 
 + import net . minecraft . src . EntityPlayer ; 
 + import net . minecraft . src . ItemStack ; 
 + import net . minecraft . src . World ; 
 + import net . minecraftforge . event . Cancelable ; 
 + import net . minecraftforge . event . Event ; 
 + 
 + @ Cancelable 
 + @ Event . HasResult 
 + public class UseHoeEvent extends PlayerEvent 
 + { 
 + / * * 
 + * This event is fired when a player attempts to use a Hoe on a block , it 
 + * can be canceled to completely prevent any further processing . 
 + * 
 + * You can also set the result to ALLOW to mark the event as processed 
 + * and damage the hoe . 
 + * 
 + * setResult ( ALLOW ) is the same as the old setHandeled ( ) ; 
 + * / 
 + 
 + public final ItemStack current ; 
 + public final World world ; 
 + public final int x ; 
 + public final int y ; 
 + public final int z ; 
 + 
 + private boolean handeled = false ; 
 + 
 + public UseHoeEvent ( EntityPlayer player , ItemStack current , World world , int x , int y , int z ) 
 + { 
 + super ( player ) ; 
 + this . current = current ; 
 + this . world = world ; 
 + this . x = x ; 
 + this . y = y ; 
 + this . z = z ; 
 + } 
 + } 
 diff - - git a / patches / common / net / minecraft / src / EntityItem . java . patch b / patches / common / net / minecraft / src / EntityItem . java . patch 
 index a038362 . . 4e2edaf 100644 
 - - - a / patches / common / net / minecraft / src / EntityItem . java . patch 
 + + + b / patches / common / net / minecraft / src / EntityItem . java . patch 
 @ @ - 1 , 17 + 1 , 18 @ @ 
 - - - . . / src _ base / common / net / minecraft / src / EntityItem . java 
 + + + . . / src _ work / common / net / minecraft / src / EntityItem . java 
 - @ @ - 1 , 6 + 1 , 10 @ @ 
 + @ @ - 1 , 6 + 1 , 11 @ @ 
 package net . minecraft . src ; 
 
 import java . util . Iterator ; 
 + 
 + import net . minecraftforge . common . MinecraftForge ; 
 + + import net . minecraftforge . event . Event . Result ; 
 + import net . minecraftforge . event . entity . item . ItemExpireEvent ; 
 + import net . minecraftforge . event . entity . player . EntityItemPickupEvent ; 
 
 import cpw . mods . fml . common . registry . GameRegistry ; 
 
 - @ @ - 20 , 6 + 24 , 11 @ @ 
 + @ @ - 20 , 6 + 25 , 11 @ @ 
 
 / * * The EntityItem ' s random initial float height . * / 
 public float hoverStart = ( float ) ( Math . random ( ) * Math . PI * 2 . 0D ) ; 
 @ @ - 23 , 7 + 24 , 7 @ @ 
 
 public EntityItem ( World par1World , double par2 , double par4 , double par6 , ItemStack par8ItemStack ) 
 { 
 - @ @ - 32 , 6 + 41 , 7 @ @ 
 + @ @ - 32 , 6 + 42 , 7 @ @ 
 this . motionX = ( double ) ( ( float ) ( Math . random ( ) * 0 . 20000000298023224D - 0 . 10000000149011612D ) ) ; 
 this . motionY = 0 . 20000000298023224D ; 
 this . motionZ = ( double ) ( ( float ) ( Math . random ( ) * 0 . 20000000298023224D - 0 . 10000000149011612D ) ) ; 
 @ @ - 31 , 7 + 32 , 7 @ @ 
 } 
 
 / * * 
 - @ @ - 118 , 7 + 128 , 20 @ @ 
 + @ @ - 118 , 7 + 129 , 20 @ @ 
 
 + + this . age ; 
 
 @ @ - 53 , 7 + 54 , 7 @ @ 
 { 
 this . setDead ( ) ; 
 } 
 - @ @ - 215 , 6 + 238 , 7 @ @ 
 + @ @ - 215 , 6 + 239 , 7 @ @ 
 { 
 par1NBTTagCompound . setShort ( " Health " , ( short ) ( ( byte ) this . health ) ) ; 
 par1NBTTagCompound . setShort ( " Age " , ( short ) this . age ) ; 
 @ @ - 61 , 7 + 62 , 7 @ @ 
 
 if ( this . item ! = null ) 
 { 
 - @ @ - 232 , 10 + 256 , 15 @ @ 
 + @ @ - 232 , 10 + 257 , 15 @ @ 
 NBTTagCompound var2 = par1NBTTagCompound . getCompoundTag ( " Item " ) ; 
 this . item = ItemStack . loadItemStackFromNBT ( var2 ) ; 
 
 @ @ - 78 , 7 + 79 , 7 @ @ 
 } 
 
 / * * 
 - @ @ - 245 , 9 + 274 , 21 @ @ 
 + @ @ - 245 , 9 + 275 , 21 @ @ 
 { 
 if ( ! this . worldObj . isRemote ) 
 { 
 @ @ - 97 , 7 + 98 , 7 @ @ 
 int var2 = this . item . stackSize ; 
 
 - if ( this . delayBeforeCanPickup = = 0 & & par1EntityPlayer . inventory . addItemStackToInventory ( this . item ) ) 
 - + if ( this . delayBeforeCanPickup < = 0 & & ( event . isHandled ( ) | | var2 < = 0 | | par1EntityPlayer . inventory . addItemStackToInventory ( this . item ) ) ) 
 + + if ( this . delayBeforeCanPickup < = 0 & & ( event . getResult ( ) = = Result . ALLOW | | var2 < = 0 | | par1EntityPlayer . inventory . addItemStackToInventory ( this . item ) ) ) 
 { 
 if ( this . item . itemID = = Block . wood . blockID ) 
 { 
 diff - - git a / patches / common / net / minecraft / src / ItemBucket . java . patch b / patches / common / net / minecraft / src / ItemBucket . java . patch 
 index 4da9c72 . . f6b0a12 100644 
 - - - a / patches / common / net / minecraft / src / ItemBucket . java . patch 
 + + + b / patches / common / net / minecraft / src / ItemBucket . java . patch 
 @ @ - 1 , 14 + 1 , 15 @ @ 
 - - - . . / src _ base / common / net / minecraft / src / ItemBucket . java 
 + + + . . / src _ work / common / net / minecraft / src / ItemBucket . java 
 - @ @ - 1 , 4 + 1 , 7 @ @ 
 + @ @ - 1 , 4 + 1 , 8 @ @ 
 package net . minecraft . src ; 
 + 
 + import net . minecraftforge . common . MinecraftForge ; 
 + + import net . minecraftforge . event . Event ; 
 + import net . minecraftforge . event . entity . player . FillBucketEvent ; 
 
 public class ItemBucket extends Item 
 { 
 - @ @ - 31 , 6 + 34 , 32 @ @ 
 + @ @ - 31 , 6 + 35 , 32 @ @ 
 } 
 else 
 { 
 @ @ - 18 , 7 + 19 , 7 @ @ 
 + return par1ItemStack ; 
 + } 
 + 
 - + if ( event . isHandeled ( ) ) 
 + + if ( event . getResult ( ) = = Event . Result . ALLOW ) 
 + { 
 + if ( par3EntityPlayer . capabilities . isCreativeMode ) 
 + { 
 diff - - git a / patches / common / net / minecraft / src / ItemDye . java . patch b / patches / common / net / minecraft / src / ItemDye . java . patch 
 index c8c7ef6 . . 9df29f0 100644 
 - - - a / patches / common / net / minecraft / src / ItemDye . java . patch 
 + + + b / patches / common / net / minecraft / src / ItemDye . java . patch 
 @ @ - 1 , 17 + 1 , 18 @ @ 
 - - - . . / src _ base / common / net / minecraft / src / ItemDye . java 
 + + + . . / src _ work / common / net / minecraft / src / ItemDye . java 
 - @ @ - 3 , 6 + 3 , 10 @ @ 
 + @ @ - 3 , 6 + 3 , 11 @ @ 
 import cpw . mods . fml . common . Side ; 
 import cpw . mods . fml . common . asm . SideOnly ; 
 import java . util . List ; 
 + 
 + import net . minecraftforge . common . ForgeHooks ; 
 + import net . minecraftforge . common . MinecraftForge ; 
 + + import net . minecraftforge . event . Event . Result ; 
 + import net . minecraftforge . event . entity . player . BonemealEvent ; 
 
 public class ItemDye extends Item 
 { 
 - @ @ - 53 , 6 + 57 , 21 @ @ 
 + @ @ - 53 , 6 + 58 , 21 @ @ 
 if ( par1ItemStack . getItemDamage ( ) = = 15 ) 
 { 
 var11 = par3World . getBlockId ( par4 , par5 , par6 ) ; 
 @ @ - 22 , 9 + 23 , 9 @ @ 
 + return false ; 
 + } 
 + 
 - + if ( event . isHandeled ( ) ) 
 + + if ( event . getResult ( ) = = Result . ALLOW ) 
 + { 
 - + if ( ! par3World . isRemote ) 
 + + if ( ! par3World . isRemote ) 
 + { 
 + par1ItemStack . stackSize - - ; 
 + } 
 @ @ - 33 , 7 + 34 , 7 @ @ 
 
 if ( var11 = = Block . sapling . blockID ) 
 { 
 - @ @ - 152 , 16 + 171 , 9 @ @ 
 + @ @ - 152 , 16 + 172 , 9 @ @ 
 par3World . setBlockAndMetadataWithNotify ( var13 , var14 , var15 , Block . tallGrass . blockID , 1 ) ; 
 } 
 } 
 diff - - git a / patches / common / net / minecraft / src / ItemHoe . java . patch b / patches / common / net / minecraft / src / ItemHoe . java . patch 
 index 6565cee . . 4605d0c 100644 
 - - - a / patches / common / net / minecraft / src / ItemHoe . java . patch 
 + + + b / patches / common / net / minecraft / src / ItemHoe . java . patch 
 @ @ - 1 , 14 + 1 , 15 @ @ 
 - - - . . / src _ base / common / net / minecraft / src / ItemHoe . java 
 + + + . . / src _ work / common / net / minecraft / src / ItemHoe . java 
 - @ @ - 1 , 5 + 1 , 7 @ @ 
 + @ @ - 1 , 5 + 1 , 8 @ @ 
 package net . minecraft . src ; 
 
 + import net . minecraftforge . common . MinecraftForge ; 
 - + import net . minecraftforge . event . entity . UseHoeEvent ; 
 + + import net . minecraftforge . event . Event . Result ; 
 + + import net . minecraftforge . event . entity . player . UseHoeEvent ; 
 import cpw . mods . fml . common . Side ; 
 import cpw . mods . fml . common . asm . SideOnly ; 
 
 - @ @ - 28 , 6 + 30 , 17 @ @ 
 + @ @ - 28 , 6 + 31 , 18 @ @ 
 } 
 else 
 { 
 @ @ - 17 , 7 + 18 , 8 @ @ 
 + { 
 + return false ; 
 + } 
 - + if ( event . isHandeled ( ) ) 
 + + 
 + + if ( event . getResult ( ) = = Result . ALLOW ) 
 + { 
 + par1ItemStack . damageItem ( 1 , par2EntityPlayer ) ; 
 + return true ; 
 diff - - git a / patches / common / net / minecraft / src / SpawnerAnimals . java . patch b / patches / common / net / minecraft / src / SpawnerAnimals . java . patch 
 index f5726b9 . . fffe071 100644 
 - - - a / patches / common / net / minecraft / src / SpawnerAnimals . java . patch 
 + + + b / patches / common / net / minecraft / src / SpawnerAnimals . java . patch 
 @ @ - 35 , 13 + 35 , 11 @ @ 
 } 
 } 
 
 - @ @ - 216 , 6 + 225 , 13 @ @ 
 + @ @ - 216 , 6 + 225 , 11 @ @ 
 * / 
 private static void creatureSpecificInit ( EntityLiving par0EntityLiving , World par1World , float par2 , float par3 , float par4 ) 
 { 
 - + LivingSpecialSpawnEvent event = new LivingSpecialSpawnEvent ( par0EntityLiving , par1World , par2 , par3 , par4 ) ; 
 - + MinecraftForge . EVENT _ BUS . post ( event ) ; 
 - + if ( event . isHandeled ( ) ) 
 + + if ( MinecraftForge . EVENT _ BUS . post ( new LivingSpecialSpawnEvent ( par0EntityLiving , par1World , par2 , par3 , par4 ) ) ) 
 + { 
 + return ; 
 + }
