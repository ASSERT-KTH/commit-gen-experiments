BLEU SCORE: 0.02139089632303349

TEST MSG: Make SpawnPlacementType extensible , remove from ArmorMaterial
GENERATED MSG: Call Looting Event on player death and loot table drops

TEST DIFF (one line): diff - - git a / patches / minecraft / net / minecraft / entity / EntitySpawnPlacementRegistry . java . patch b / patches / minecraft / net / minecraft / entity / EntitySpawnPlacementRegistry . java . patch <nl> index a864acc . . 63c0763 100644 <nl> - - - a / patches / minecraft / net / minecraft / entity / EntitySpawnPlacementRegistry . java . patch <nl> + + + b / patches / minecraft / net / minecraft / entity / EntitySpawnPlacementRegistry . java . patch <nl> @ @ - 8 , 13 + 8 , 17 @ @ <nl> field _ 209347 _ a . put ( p _ 209346 _ 0 _ , new EntitySpawnPlacementRegistry . Entry ( p _ 209346 _ 2 _ , p _ 209346 _ 1 _ , p _ 209346 _ 3 _ ) ) ; <nl> } <nl> <nl> - @ @ - 109 , 5 + 110 , 20 @ @ <nl> - public static enum SpawnPlacementType { <nl> + @ @ - 106 , 8 + 107 , 23 @ @ <nl> + } <nl> + } <nl> + <nl> + - public static enum SpawnPlacementType { <nl> + + public static enum SpawnPlacementType implements net . minecraftforge . common . IExtensibleEnum { <nl> ON _ GROUND , <nl> IN _ WATER ; <nl> + <nl> + public static SpawnPlacementType create ( String name , net . minecraftforge . common . util . TriPredicate < net . minecraft . world . IWorldReaderBase , net . minecraft . util . math . BlockPos , EntityType < ? extends EntityLiving > > predicate ) { <nl> - + return null ; <nl> + + throw new IllegalStateException ( " Enum not extended " ) ; <nl> + } <nl> + <nl> + private net . minecraftforge . common . util . TriPredicate < net . minecraft . world . IWorldReaderBase , net . minecraft . util . math . BlockPos , EntityType < ? extends EntityLiving > > predicate ; <nl> diff - - git a / patches / minecraft / net / minecraft / item / ArmorMaterial . java . patch b / patches / minecraft / net / minecraft / item / ArmorMaterial . java . patch <nl> deleted file mode 100644 <nl> index e03ab01 . . 0000000 <nl> - - - a / patches / minecraft / net / minecraft / item / ArmorMaterial . java . patch <nl> + + + / dev / null <nl> @ @ - 1 , 20 + 0 , 0 @ @ <nl> - - - - a / net / minecraft / item / ArmorMaterial . java <nl> - + + + b / net / minecraft / item / ArmorMaterial . java <nl> - @ @ - 10 , 7 + 10 , 7 @ @ <nl> - import net . minecraftforge . api . distmarker . Dist ; <nl> - import net . minecraftforge . api . distmarker . OnlyIn ; <nl> - <nl> - - public enum ArmorMaterial implements IArmorMaterial { <nl> - + public enum ArmorMaterial implements IArmorMaterial , net . minecraftforge . common . IExtensibleEnum { <nl> - LEATHER ( " leather " , 5 , new int [ ] { 1 , 2 , 3 , 1 } , 15 , SoundEvents . field _ 187728 _ s , 0 . 0F , ( ) - > { <nl> - return Ingredient . func _ 199804 _ a ( Items . field _ 151116 _ aA ) ; <nl> - } ) , <nl> - @ @ - 77 , 4 + 77 , 8 @ @ <nl> - public float func _ 200901 _ e ( ) { <nl> - return this . field _ 189417 _ k ; <nl> - } <nl> - + <nl> - + public static ArmorMaterial create ( String name , String p _ i48533 _ 3 _ , int p _ i48533 _ 4 _ , int [ ] p _ i48533 _ 5 _ , int p _ i48533 _ 6 _ , SoundEvent p _ i48533 _ 7 _ , float p _ i48533 _ 8 _ , Supplier < Ingredient > p _ i48533 _ 9 _ ) { <nl> - + throw new IllegalStateException ( " Enum not extended " ) ; <nl> - + } <nl> - }
NEAREST DIFF (one line): diff - - git a / patches / minecraft / net / minecraft / entity / EntityLivingBase . java . patch b / patches / minecraft / net / minecraft / entity / EntityLivingBase . java . patch <nl> index 77601b5 . . a2846fd 100644 <nl> - - - a / patches / minecraft / net / minecraft / entity / EntityLivingBase . java . patch <nl> + + + b / patches / minecraft / net / minecraft / entity / EntityLivingBase . java . patch <nl> @ @ - 76 , 15 + 76 , 20 @ @ <nl> if ( ! this . field _ 70729 _ aU ) <nl> { <nl> Entity entity = p _ 70645 _ 1 _ . func _ 76346 _ g ( ) ; <nl> - @ @ - 1069 , 12 + 1075 , 26 @ @ <nl> - { <nl> - i = EnchantmentHelper . func _ 185283 _ h ( ( EntityLivingBase ) entity ) ; <nl> - } <nl> - + i = net . minecraftforge . common . ForgeHooks . getLootingLevel ( this , p _ 70645 _ 1 _ , i ) ; <nl> + @ @ - 1063 , 18 + 1069 , 26 @ @ <nl> <nl> + if ( ! this . field _ 70170 _ p . field _ 72995 _ K ) <nl> + { <nl> + - int i = 0 ; <nl> + + int i = net . minecraftforge . common . ForgeHooks . getLootingLevel ( this , entity , p _ 70645 _ 1 _ ) ; <nl> + <nl> + - if ( entity instanceof EntityPlayer ) <nl> + - { <nl> + - i = EnchantmentHelper . func _ 185283 _ h ( ( EntityLivingBase ) entity ) ; <nl> + - } <nl> + captureDrops = true ; <nl> + capturedDrops . clear ( ) ; <nl> - + <nl> + <nl> if ( this . func _ 146066 _ aG ( ) & & this . field _ 70170 _ p . func _ 82736 _ K ( ) . func _ 82766 _ b ( " doMobLoot " ) ) <nl> { <nl> boolean flag = this . field _ 70718 _ bc > 0 ; <nl> diff - - git a / patches / minecraft / net / minecraft / world / storage / loot / LootContext . java . patch b / patches / minecraft / net / minecraft / world / storage / loot / LootContext . java . patch <nl> index 448ddce . . 779ac13 100644 <nl> - - - a / patches / minecraft / net / minecraft / world / storage / loot / LootContext . java . patch <nl> + + + b / patches / minecraft / net / minecraft / world / storage / loot / LootContext . java . patch <nl> @ @ - 1 , 6 + 1 , 6 @ @ <nl> - - - . . / src - base / minecraft / net / minecraft / world / storage / loot / LootContext . java <nl> + + + . . / src - work / minecraft / net / minecraft / world / storage / loot / LootContext . java <nl> - @ @ - 89 , 6 + 89 , 11 @ @ <nl> + @ @ - 89 , 6 + 89 , 16 @ @ <nl> } <nl> } <nl> <nl> @ @ - 9 , 6 + 9 , 11 @ @ <nl> + return field _ 186499 _ b ; <nl> + } <nl> + <nl> + + public int getLootingModifier ( ) <nl> + + { <nl> + + return net . minecraftforge . common . ForgeHooks . getLootingLevel ( func _ 186493 _ a ( ) , func _ 186492 _ c ( ) , field _ 186503 _ f ) ; <nl> + + } <nl> + + <nl> public static class Builder <nl> { <nl> private final WorldServer field _ 186474 _ a ; <nl> diff - - git a / patches / minecraft / net / minecraft / world / storage / loot / conditions / RandomChanceWithLooting . java . patch b / patches / minecraft / net / minecraft / world / storage / loot / conditions / RandomChanceWithLooting . java . patch <nl> new file mode 100644 <nl> index 0000000 . . 22ab3c8 <nl> - - - / dev / null <nl> + + + b / patches / minecraft / net / minecraft / world / storage / loot / conditions / RandomChanceWithLooting . java . patch <nl> @ @ - 0 , 0 + 1 , 17 @ @ <nl> + - - - . . / src - base / minecraft / net / minecraft / world / storage / loot / conditions / RandomChanceWithLooting . java <nl> + + + + . . / src - work / minecraft / net / minecraft / world / storage / loot / conditions / RandomChanceWithLooting . java <nl> + @ @ - 23 , 13 + 23 , 8 @ @ <nl> + <nl> + public boolean func _ 186618 _ a ( Random p _ 186618 _ 1 _ , LootContext p _ 186618 _ 2 _ ) <nl> + { <nl> + - int i = 0 ; <nl> + + int i = p _ 186618 _ 2 _ . getLootingModifier ( ) ; <nl> + <nl> + - if ( p _ 186618 _ 2 _ . func _ 186492 _ c ( ) instanceof EntityLivingBase ) <nl> + - { <nl> + - i = EnchantmentHelper . func _ 185283 _ h ( ( EntityLivingBase ) p _ 186618 _ 2 _ . func _ 186492 _ c ( ) ) ; <nl> + - } <nl> + - <nl> + return p _ 186618 _ 1 _ . nextFloat ( ) < this . field _ 186627 _ a + ( float ) i * this . field _ 186628 _ b ; <nl> + } <nl> + <nl> diff - - git a / patches / minecraft / net / minecraft / world / storage / loot / functions / LootingEnchantBonus . java . patch b / patches / minecraft / net / minecraft / world / storage / loot / functions / LootingEnchantBonus . java . patch <nl> new file mode 100644 <nl> index 0000000 . . c6bf543 <nl> - - - / dev / null <nl> + + + b / patches / minecraft / net / minecraft / world / storage / loot / functions / LootingEnchantBonus . java . patch <nl> @ @ - 0 , 0 + 1 , 11 @ @ <nl> + - - - . . / src - base / minecraft / net / minecraft / world / storage / loot / functions / LootingEnchantBonus . java <nl> + + + + . . / src - work / minecraft / net / minecraft / world / storage / loot / functions / LootingEnchantBonus . java <nl> + @ @ - 32 , 7 + 32 , 7 @ @ <nl> + <nl> + if ( entity instanceof EntityLivingBase ) <nl> + { <nl> + - int i = EnchantmentHelper . func _ 185283 _ h ( ( EntityLivingBase ) entity ) ; <nl> + + int i = p _ 186553 _ 3 _ . getLootingModifier ( ) ; <nl> + <nl> + if ( i = = 0 ) <nl> + { <nl> diff - - git a / src / main / java / net / minecraftforge / common / ForgeHooks . java b / src / main / java / net / minecraftforge / common / ForgeHooks . java <nl> index 11c336f . . 290cf88 100644 <nl> - - - a / src / main / java / net / minecraftforge / common / ForgeHooks . java <nl> + + + b / src / main / java / net / minecraftforge / common / ForgeHooks . java <nl> @ @ - 43 , 6 + 43 , 7 @ @ import net . minecraft . block . material . Material ; <nl> import net . minecraft . block . state . IBlockState ; <nl> import net . minecraft . client . Minecraft ; <nl> import net . minecraft . client . gui . GuiScreen ; <nl> + import net . minecraft . enchantment . EnchantmentHelper ; <nl> import net . minecraft . entity . Entity ; <nl> import net . minecraft . entity . EntityList ; <nl> import net . minecraft . entity . EntityLivingBase ; <nl> @ @ - 518 , 7 + 519 , 22 @ @ public class ForgeHooks <nl> return ( MinecraftForge . EVENT _ BUS . post ( event ) ? null : new float [ ] { event . getDistance ( ) , event . getDamageMultiplier ( ) } ) ; <nl> } <nl> <nl> - public static int getLootingLevel ( EntityLivingBase target , DamageSource cause , int level ) { <nl> + public static int getLootingLevel ( Entity target , Entity killer , DamageSource cause ) <nl> + { <nl> + int looting = 0 ; <nl> + if ( killer instanceof EntityLivingBase ) <nl> + { <nl> + looting = EnchantmentHelper . getLootingModifier ( ( EntityLivingBase ) killer ) ; <nl> + } <nl> + if ( target instanceof EntityLivingBase ) <nl> + { <nl> + looting = getLootingLevel ( ( EntityLivingBase ) target , cause , looting ) ; <nl> + } <nl> + return looting ; <nl> + } <nl> + <nl> + public static int getLootingLevel ( EntityLivingBase target , DamageSource cause , int level ) <nl> + { <nl> LootingLevelEvent event = new LootingLevelEvent ( target , cause , level ) ; <nl> MinecraftForge . EVENT _ BUS . post ( event ) ; <nl> return event . getLootingLevel ( ) ; <nl> diff - - git a / src / main / java / net / minecraftforge / event / entity / player / PlayerDropsEvent . java b / src / main / java / net / minecraftforge / event / entity / player / PlayerDropsEvent . java <nl> index f68ea05 . . 6aa3454 100644 <nl> - - - a / src / main / java / net / minecraftforge / event / entity / player / PlayerDropsEvent . java <nl> + + + b / src / main / java / net / minecraftforge / event / entity / player / PlayerDropsEvent . java <nl> @ @ - 21 , 9 + 21 , 9 @ @ package net . minecraftforge . event . entity . player ; <nl> <nl> import java . util . List ; <nl> <nl> + import net . minecraftforge . common . ForgeHooks ; <nl> import net . minecraftforge . fml . common . eventhandler . Cancelable ; <nl> <nl> - import net . minecraft . enchantment . EnchantmentHelper ; <nl> import net . minecraft . entity . item . EntityItem ; <nl> import net . minecraft . entity . player . EntityPlayer ; <nl> import net . minecraft . util . DamageSource ; <nl> @ @ - 48 , 10 + 48 , 7 @ @ public class PlayerDropsEvent extends LivingDropsEvent <nl> * / <nl> public PlayerDropsEvent ( EntityPlayer entity , DamageSource source , List < EntityItem > drops , boolean recentlyHit ) <nl> { <nl> - super ( entity , source , drops , <nl> - ( source . getEntity ( ) instanceof EntityPlayer ) ? <nl> - EnchantmentHelper . getLootingModifier ( ( ( EntityPlayer ) source . getEntity ( ) ) ) : 0 , <nl> - recentlyHit ) ; <nl> + super ( entity , source , drops , ForgeHooks . getLootingLevel ( entity , source . getEntity ( ) , source ) , recentlyHit ) ; <nl> <nl> this . entityPlayer = entity ; <nl> }

TEST DIFF:
diff - - git a / patches / minecraft / net / minecraft / entity / EntitySpawnPlacementRegistry . java . patch b / patches / minecraft / net / minecraft / entity / EntitySpawnPlacementRegistry . java . patch 
 index a864acc . . 63c0763 100644 
 - - - a / patches / minecraft / net / minecraft / entity / EntitySpawnPlacementRegistry . java . patch 
 + + + b / patches / minecraft / net / minecraft / entity / EntitySpawnPlacementRegistry . java . patch 
 @ @ - 8 , 13 + 8 , 17 @ @ 
 field _ 209347 _ a . put ( p _ 209346 _ 0 _ , new EntitySpawnPlacementRegistry . Entry ( p _ 209346 _ 2 _ , p _ 209346 _ 1 _ , p _ 209346 _ 3 _ ) ) ; 
 } 
 
 - @ @ - 109 , 5 + 110 , 20 @ @ 
 - public static enum SpawnPlacementType { 
 + @ @ - 106 , 8 + 107 , 23 @ @ 
 + } 
 + } 
 + 
 + - public static enum SpawnPlacementType { 
 + + public static enum SpawnPlacementType implements net . minecraftforge . common . IExtensibleEnum { 
 ON _ GROUND , 
 IN _ WATER ; 
 + 
 + public static SpawnPlacementType create ( String name , net . minecraftforge . common . util . TriPredicate < net . minecraft . world . IWorldReaderBase , net . minecraft . util . math . BlockPos , EntityType < ? extends EntityLiving > > predicate ) { 
 - + return null ; 
 + + throw new IllegalStateException ( " Enum not extended " ) ; 
 + } 
 + 
 + private net . minecraftforge . common . util . TriPredicate < net . minecraft . world . IWorldReaderBase , net . minecraft . util . math . BlockPos , EntityType < ? extends EntityLiving > > predicate ; 
 diff - - git a / patches / minecraft / net / minecraft / item / ArmorMaterial . java . patch b / patches / minecraft / net / minecraft / item / ArmorMaterial . java . patch 
 deleted file mode 100644 
 index e03ab01 . . 0000000 
 - - - a / patches / minecraft / net / minecraft / item / ArmorMaterial . java . patch 
 + + + / dev / null 
 @ @ - 1 , 20 + 0 , 0 @ @ 
 - - - - a / net / minecraft / item / ArmorMaterial . java 
 - + + + b / net / minecraft / item / ArmorMaterial . java 
 - @ @ - 10 , 7 + 10 , 7 @ @ 
 - import net . minecraftforge . api . distmarker . Dist ; 
 - import net . minecraftforge . api . distmarker . OnlyIn ; 
 - 
 - - public enum ArmorMaterial implements IArmorMaterial { 
 - + public enum ArmorMaterial implements IArmorMaterial , net . minecraftforge . common . IExtensibleEnum { 
 - LEATHER ( " leather " , 5 , new int [ ] { 1 , 2 , 3 , 1 } , 15 , SoundEvents . field _ 187728 _ s , 0 . 0F , ( ) - > { 
 - return Ingredient . func _ 199804 _ a ( Items . field _ 151116 _ aA ) ; 
 - } ) , 
 - @ @ - 77 , 4 + 77 , 8 @ @ 
 - public float func _ 200901 _ e ( ) { 
 - return this . field _ 189417 _ k ; 
 - } 
 - + 
 - + public static ArmorMaterial create ( String name , String p _ i48533 _ 3 _ , int p _ i48533 _ 4 _ , int [ ] p _ i48533 _ 5 _ , int p _ i48533 _ 6 _ , SoundEvent p _ i48533 _ 7 _ , float p _ i48533 _ 8 _ , Supplier < Ingredient > p _ i48533 _ 9 _ ) { 
 - + throw new IllegalStateException ( " Enum not extended " ) ; 
 - + } 
 - }

NEAREST DIFF:
diff - - git a / patches / minecraft / net / minecraft / entity / EntityLivingBase . java . patch b / patches / minecraft / net / minecraft / entity / EntityLivingBase . java . patch 
 index 77601b5 . . a2846fd 100644 
 - - - a / patches / minecraft / net / minecraft / entity / EntityLivingBase . java . patch 
 + + + b / patches / minecraft / net / minecraft / entity / EntityLivingBase . java . patch 
 @ @ - 76 , 15 + 76 , 20 @ @ 
 if ( ! this . field _ 70729 _ aU ) 
 { 
 Entity entity = p _ 70645 _ 1 _ . func _ 76346 _ g ( ) ; 
 - @ @ - 1069 , 12 + 1075 , 26 @ @ 
 - { 
 - i = EnchantmentHelper . func _ 185283 _ h ( ( EntityLivingBase ) entity ) ; 
 - } 
 - + i = net . minecraftforge . common . ForgeHooks . getLootingLevel ( this , p _ 70645 _ 1 _ , i ) ; 
 + @ @ - 1063 , 18 + 1069 , 26 @ @ 
 
 + if ( ! this . field _ 70170 _ p . field _ 72995 _ K ) 
 + { 
 + - int i = 0 ; 
 + + int i = net . minecraftforge . common . ForgeHooks . getLootingLevel ( this , entity , p _ 70645 _ 1 _ ) ; 
 + 
 + - if ( entity instanceof EntityPlayer ) 
 + - { 
 + - i = EnchantmentHelper . func _ 185283 _ h ( ( EntityLivingBase ) entity ) ; 
 + - } 
 + captureDrops = true ; 
 + capturedDrops . clear ( ) ; 
 - + 
 + 
 if ( this . func _ 146066 _ aG ( ) & & this . field _ 70170 _ p . func _ 82736 _ K ( ) . func _ 82766 _ b ( " doMobLoot " ) ) 
 { 
 boolean flag = this . field _ 70718 _ bc > 0 ; 
 diff - - git a / patches / minecraft / net / minecraft / world / storage / loot / LootContext . java . patch b / patches / minecraft / net / minecraft / world / storage / loot / LootContext . java . patch 
 index 448ddce . . 779ac13 100644 
 - - - a / patches / minecraft / net / minecraft / world / storage / loot / LootContext . java . patch 
 + + + b / patches / minecraft / net / minecraft / world / storage / loot / LootContext . java . patch 
 @ @ - 1 , 6 + 1 , 6 @ @ 
 - - - . . / src - base / minecraft / net / minecraft / world / storage / loot / LootContext . java 
 + + + . . / src - work / minecraft / net / minecraft / world / storage / loot / LootContext . java 
 - @ @ - 89 , 6 + 89 , 11 @ @ 
 + @ @ - 89 , 6 + 89 , 16 @ @ 
 } 
 } 
 
 @ @ - 9 , 6 + 9 , 11 @ @ 
 + return field _ 186499 _ b ; 
 + } 
 + 
 + + public int getLootingModifier ( ) 
 + + { 
 + + return net . minecraftforge . common . ForgeHooks . getLootingLevel ( func _ 186493 _ a ( ) , func _ 186492 _ c ( ) , field _ 186503 _ f ) ; 
 + + } 
 + + 
 public static class Builder 
 { 
 private final WorldServer field _ 186474 _ a ; 
 diff - - git a / patches / minecraft / net / minecraft / world / storage / loot / conditions / RandomChanceWithLooting . java . patch b / patches / minecraft / net / minecraft / world / storage / loot / conditions / RandomChanceWithLooting . java . patch 
 new file mode 100644 
 index 0000000 . . 22ab3c8 
 - - - / dev / null 
 + + + b / patches / minecraft / net / minecraft / world / storage / loot / conditions / RandomChanceWithLooting . java . patch 
 @ @ - 0 , 0 + 1 , 17 @ @ 
 + - - - . . / src - base / minecraft / net / minecraft / world / storage / loot / conditions / RandomChanceWithLooting . java 
 + + + + . . / src - work / minecraft / net / minecraft / world / storage / loot / conditions / RandomChanceWithLooting . java 
 + @ @ - 23 , 13 + 23 , 8 @ @ 
 + 
 + public boolean func _ 186618 _ a ( Random p _ 186618 _ 1 _ , LootContext p _ 186618 _ 2 _ ) 
 + { 
 + - int i = 0 ; 
 + + int i = p _ 186618 _ 2 _ . getLootingModifier ( ) ; 
 + 
 + - if ( p _ 186618 _ 2 _ . func _ 186492 _ c ( ) instanceof EntityLivingBase ) 
 + - { 
 + - i = EnchantmentHelper . func _ 185283 _ h ( ( EntityLivingBase ) p _ 186618 _ 2 _ . func _ 186492 _ c ( ) ) ; 
 + - } 
 + - 
 + return p _ 186618 _ 1 _ . nextFloat ( ) < this . field _ 186627 _ a + ( float ) i * this . field _ 186628 _ b ; 
 + } 
 + 
 diff - - git a / patches / minecraft / net / minecraft / world / storage / loot / functions / LootingEnchantBonus . java . patch b / patches / minecraft / net / minecraft / world / storage / loot / functions / LootingEnchantBonus . java . patch 
 new file mode 100644 
 index 0000000 . . c6bf543 
 - - - / dev / null 
 + + + b / patches / minecraft / net / minecraft / world / storage / loot / functions / LootingEnchantBonus . java . patch 
 @ @ - 0 , 0 + 1 , 11 @ @ 
 + - - - . . / src - base / minecraft / net / minecraft / world / storage / loot / functions / LootingEnchantBonus . java 
 + + + + . . / src - work / minecraft / net / minecraft / world / storage / loot / functions / LootingEnchantBonus . java 
 + @ @ - 32 , 7 + 32 , 7 @ @ 
 + 
 + if ( entity instanceof EntityLivingBase ) 
 + { 
 + - int i = EnchantmentHelper . func _ 185283 _ h ( ( EntityLivingBase ) entity ) ; 
 + + int i = p _ 186553 _ 3 _ . getLootingModifier ( ) ; 
 + 
 + if ( i = = 0 ) 
 + { 
 diff - - git a / src / main / java / net / minecraftforge / common / ForgeHooks . java b / src / main / java / net / minecraftforge / common / ForgeHooks . java 
 index 11c336f . . 290cf88 100644 
 - - - a / src / main / java / net / minecraftforge / common / ForgeHooks . java 
 + + + b / src / main / java / net / minecraftforge / common / ForgeHooks . java 
 @ @ - 43 , 6 + 43 , 7 @ @ import net . minecraft . block . material . Material ; 
 import net . minecraft . block . state . IBlockState ; 
 import net . minecraft . client . Minecraft ; 
 import net . minecraft . client . gui . GuiScreen ; 
 + import net . minecraft . enchantment . EnchantmentHelper ; 
 import net . minecraft . entity . Entity ; 
 import net . minecraft . entity . EntityList ; 
 import net . minecraft . entity . EntityLivingBase ; 
 @ @ - 518 , 7 + 519 , 22 @ @ public class ForgeHooks 
 return ( MinecraftForge . EVENT _ BUS . post ( event ) ? null : new float [ ] { event . getDistance ( ) , event . getDamageMultiplier ( ) } ) ; 
 } 
 
 - public static int getLootingLevel ( EntityLivingBase target , DamageSource cause , int level ) { 
 + public static int getLootingLevel ( Entity target , Entity killer , DamageSource cause ) 
 + { 
 + int looting = 0 ; 
 + if ( killer instanceof EntityLivingBase ) 
 + { 
 + looting = EnchantmentHelper . getLootingModifier ( ( EntityLivingBase ) killer ) ; 
 + } 
 + if ( target instanceof EntityLivingBase ) 
 + { 
 + looting = getLootingLevel ( ( EntityLivingBase ) target , cause , looting ) ; 
 + } 
 + return looting ; 
 + } 
 + 
 + public static int getLootingLevel ( EntityLivingBase target , DamageSource cause , int level ) 
 + { 
 LootingLevelEvent event = new LootingLevelEvent ( target , cause , level ) ; 
 MinecraftForge . EVENT _ BUS . post ( event ) ; 
 return event . getLootingLevel ( ) ; 
 diff - - git a / src / main / java / net / minecraftforge / event / entity / player / PlayerDropsEvent . java b / src / main / java / net / minecraftforge / event / entity / player / PlayerDropsEvent . java 
 index f68ea05 . . 6aa3454 100644 
 - - - a / src / main / java / net / minecraftforge / event / entity / player / PlayerDropsEvent . java 
 + + + b / src / main / java / net / minecraftforge / event / entity / player / PlayerDropsEvent . java 
 @ @ - 21 , 9 + 21 , 9 @ @ package net . minecraftforge . event . entity . player ; 
 
 import java . util . List ; 
 
 + import net . minecraftforge . common . ForgeHooks ; 
 import net . minecraftforge . fml . common . eventhandler . Cancelable ; 
 
 - import net . minecraft . enchantment . EnchantmentHelper ; 
 import net . minecraft . entity . item . EntityItem ; 
 import net . minecraft . entity . player . EntityPlayer ; 
 import net . minecraft . util . DamageSource ; 
 @ @ - 48 , 10 + 48 , 7 @ @ public class PlayerDropsEvent extends LivingDropsEvent 
 * / 
 public PlayerDropsEvent ( EntityPlayer entity , DamageSource source , List < EntityItem > drops , boolean recentlyHit ) 
 { 
 - super ( entity , source , drops , 
 - ( source . getEntity ( ) instanceof EntityPlayer ) ? 
 - EnchantmentHelper . getLootingModifier ( ( ( EntityPlayer ) source . getEntity ( ) ) ) : 0 , 
 - recentlyHit ) ; 
 + super ( entity , source , drops , ForgeHooks . getLootingLevel ( entity , source . getEntity ( ) , source ) , recentlyHit ) ; 
 
 this . entityPlayer = entity ; 
 }
