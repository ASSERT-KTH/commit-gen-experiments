BLEU SCORE: 0.010545465939340198

TEST MSG: Fix setTileEntity causing the world to remove the new and old tile entities . Closes # 2164
GENERATED MSG: Replace Forge ' s ` BlockPos # getImmutable ` method with the included ` BlockPos # toImmutable ` ( func _ 185334 _ h ) , while keeping the override in PooledMutableBlockPos to prevent mutable leaks .

TEST DIFF (one line): diff - - git a / patches / minecraft / net / minecraft / world / World . java . patch b / patches / minecraft / net / minecraft / world / World . java . patch <nl> index 283a366 . . 872c37a 100644 <nl> - - - a / patches / minecraft / net / minecraft / world / World . java . patch <nl> + + + b / patches / minecraft / net / minecraft / world / World . java . patch <nl> @ @ - 364 , 7 + 364 , 16 @ @ <nl> throw new ReportedException ( crashreport2 ) ; <nl> } <nl> } <nl> - @ @ - 1707 , 15 + 1826 , 20 @ @ <nl> + @ @ - 1702 , 20 + 1821 , 28 @ @ <nl> + <nl> + if ( this . func _ 175667 _ e ( tileentity . func _ 174877 _ v ( ) ) ) <nl> + { <nl> + - this . func _ 175726 _ f ( tileentity . func _ 174877 _ v ( ) ) . func _ 177425 _ e ( tileentity . func _ 174877 _ v ( ) ) ; <nl> + + / / Forge : Bugfix : If we set the tile entity it immediately sets it in the chunk , so we could be desyned <nl> + + Chunk chunk = this . func _ 175726 _ f ( tileentity . func _ 174877 _ v ( ) ) ; <nl> + + if ( chunk . func _ 177424 _ a ( tileentity . func _ 174877 _ v ( ) , net . minecraft . world . chunk . Chunk . EnumCreateEntityType . CHECK ) = = tileentity ) <nl> + + chunk . func _ 177425 _ e ( tileentity . func _ 174877 _ v ( ) ) ; <nl> + } <nl> } <nl> } <nl> <nl> @ @ - 387 , 7 + 396 , 7 @ @ <nl> this . field _ 72984 _ F . func _ 76318 _ c ( " pendingBlockEntities " ) ; <nl> <nl> if ( ! this . field _ 147484 _ a . isEmpty ( ) ) <nl> - @ @ - 1754 , 7 + 1878 , 8 @ @ <nl> + @ @ - 1754 , 7 + 1881 , 8 @ @ <nl> <nl> public boolean func _ 175700 _ a ( TileEntity p _ 175700 _ 1 _ ) <nl> { <nl> @ @ - 397 , 7 + 406 , 7 @ @ <nl> <nl> if ( flag & & p _ 175700 _ 1 _ instanceof ITickable ) <nl> { <nl> - @ @ - 1788 , 9 + 1913 , 13 @ @ <nl> + @ @ - 1788 , 9 + 1916 , 13 @ @ <nl> { <nl> int i = MathHelper . func _ 76128 _ c ( p _ 72866 _ 1 _ . field _ 70165 _ t ) ; <nl> int j = MathHelper . func _ 76128 _ c ( p _ 72866 _ 1 _ . field _ 70161 _ v ) ; <nl> @ @ - 413 , 7 + 422 , 7 @ @ <nl> { <nl> p _ 72866 _ 1 _ . field _ 70142 _ S = p _ 72866 _ 1 _ . field _ 70165 _ t ; <nl> p _ 72866 _ 1 _ . field _ 70137 _ T = p _ 72866 _ 1 _ . field _ 70163 _ u ; <nl> - @ @ - 1989 , 6 + 2118 , 10 @ @ <nl> + @ @ - 1989 , 6 + 2121 , 10 @ @ <nl> blockpos $ pooledmutableblockpos . func _ 185344 _ t ( ) ; <nl> return true ; <nl> } <nl> @ @ - 424 , 7 + 433 , 7 @ @ <nl> } <nl> } <nl> } <nl> - @ @ - 2028 , 6 + 2161 , 16 @ @ <nl> + @ @ - 2028 , 6 + 2164 , 16 @ @ <nl> IBlockState iblockstate = this . func _ 180495 _ p ( blockpos $ pooledmutableblockpos ) ; <nl> Block block = iblockstate . func _ 177230 _ c ( ) ; <nl> <nl> @ @ - 441 , 7 + 450 , 7 @ @ <nl> if ( iblockstate . func _ 185904 _ a ( ) = = p _ 72918 _ 2 _ ) <nl> { <nl> double d0 = ( double ) ( ( float ) ( l1 + 1 ) - BlockLiquid . func _ 149801 _ b ( ( ( Integer ) iblockstate . func _ 177229 _ b ( BlockLiquid . field _ 176367 _ b ) ) . intValue ( ) ) ) ; <nl> - @ @ - 2104 , 6 + 2247 , 9 @ @ <nl> + @ @ - 2104 , 6 + 2250 , 9 @ @ <nl> { <nl> IBlockState iblockstate = this . func _ 180495 _ p ( blockpos $ pooledmutableblockpos . func _ 185343 _ d ( k1 , l1 , i2 ) ) ; <nl> <nl> @ @ - 451 , 7 + 460 , 7 @ @ <nl> if ( iblockstate . func _ 185904 _ a ( ) = = p _ 72830 _ 2 _ ) <nl> { <nl> int j2 = ( ( Integer ) iblockstate . func _ 177229 _ b ( BlockLiquid . field _ 176367 _ b ) ) . intValue ( ) ; <nl> - @ @ - 2136 , 6 + 2282 , 7 @ @ <nl> + @ @ - 2136 , 6 + 2285 , 7 @ @ <nl> public Explosion func _ 72885 _ a ( @ Nullable Entity p _ 72885 _ 1 _ , double p _ 72885 _ 2 _ , double p _ 72885 _ 4 _ , double p _ 72885 _ 6 _ , float p _ 72885 _ 8 _ , boolean p _ 72885 _ 9 _ , boolean p _ 72885 _ 10 _ ) <nl> { <nl> Explosion explosion = new Explosion ( this , p _ 72885 _ 1 _ , p _ 72885 _ 2 _ , p _ 72885 _ 4 _ , p _ 72885 _ 6 _ , p _ 72885 _ 8 _ , p _ 72885 _ 9 _ , p _ 72885 _ 10 _ ) ; <nl> @ @ - 459 , 7 + 468 , 7 @ @ <nl> explosion . func _ 77278 _ a ( ) ; <nl> explosion . func _ 77279 _ a ( true ) ; <nl> return explosion ; <nl> - @ @ - 2258 , 6 + 2405 , 7 @ @ <nl> + @ @ - 2258 , 6 + 2408 , 7 @ @ <nl> <nl> public void func _ 175690 _ a ( BlockPos p _ 175690 _ 1 _ , @ Nullable TileEntity p _ 175690 _ 2 _ ) <nl> { <nl> @ @ - 467 , 7 + 476 , 7 @ @ <nl> if ( ! this . func _ 189509 _ E ( p _ 175690 _ 1 _ ) ) <nl> { <nl> if ( p _ 175690 _ 2 _ ! = null & & ! p _ 175690 _ 2 _ . func _ 145837 _ r ( ) ) <nl> - @ @ - 2283 , 8 + 2431 , 10 @ @ <nl> + @ @ - 2283 , 8 + 2434 , 10 @ @ <nl> else <nl> { <nl> this . func _ 175700 _ a ( p _ 175690 _ 2 _ ) ; <nl> @ @ - 479 , 7 + 488 , 7 @ @ <nl> } <nl> } <nl> } <nl> - @ @ - 2297 , 6 + 2447 , 8 @ @ <nl> + @ @ - 2297 , 6 + 2450 , 8 @ @ <nl> { <nl> tileentity . func _ 145843 _ s ( ) ; <nl> this . field _ 147484 _ a . remove ( tileentity ) ; <nl> @ @ - 488 , 7 + 497 , 7 @ @ <nl> } <nl> else <nl> { <nl> - @ @ - 2309 , 6 + 2461 , 7 @ @ <nl> + @ @ - 2309 , 6 + 2464 , 7 @ @ <nl> <nl> this . func _ 175726 _ f ( p _ 175713 _ 1 _ ) . func _ 177425 _ e ( p _ 175713 _ 1 _ ) ; <nl> } <nl> @ @ - 496 , 7 + 505 , 7 @ @ <nl> } <nl> <nl> public void func _ 147457 _ a ( TileEntity p _ 147457 _ 1 _ ) <nl> - @ @ - 2335 , 7 + 2488 , 7 @ @ <nl> + @ @ - 2335 , 7 + 2491 , 7 @ @ <nl> if ( chunk ! = null & & ! chunk . func _ 76621 _ g ( ) ) <nl> { <nl> IBlockState iblockstate = this . func _ 180495 _ p ( p _ 175677 _ 1 _ ) ; <nl> @ @ - 505 , 7 + 514 , 7 @ @ <nl> } <nl> else <nl> { <nl> - @ @ - 2358 , 6 + 2511 , 7 @ @ <nl> + @ @ - 2358 , 6 + 2514 , 7 @ @ <nl> { <nl> this . field _ 72985 _ G = p _ 72891 _ 1 _ ; <nl> this . field _ 72992 _ H = p _ 72891 _ 2 _ ; <nl> @ @ - 513 , 7 + 522 , 7 @ @ <nl> } <nl> <nl> public void func _ 72835 _ b ( ) <nl> - @ @ - 2367 , 6 + 2521 , 11 @ @ <nl> + @ @ - 2367 , 6 + 2524 , 11 @ @ <nl> <nl> protected void func _ 72947 _ a ( ) <nl> { <nl> @ @ - 525 , 7 + 534 , 7 @ @ <nl> if ( this . field _ 72986 _ A . func _ 76059 _ o ( ) ) <nl> { <nl> this . field _ 73004 _ o = 1 . 0F ; <nl> - @ @ - 2380 , 6 + 2539 , 11 @ @ <nl> + @ @ - 2380 , 6 + 2542 , 11 @ @ <nl> <nl> protected void func _ 72979 _ l ( ) <nl> { <nl> @ @ - 537 , 7 + 546 , 7 @ @ <nl> if ( ! this . field _ 73011 _ w . func _ 177495 _ o ( ) ) <nl> { <nl> if ( ! this . field _ 72995 _ K ) <nl> - @ @ - 2499 , 6 + 2663 , 11 @ @ <nl> + @ @ - 2499 , 6 + 2666 , 11 @ @ <nl> <nl> public boolean func _ 175670 _ e ( BlockPos p _ 175670 _ 1 _ , boolean p _ 175670 _ 2 _ ) <nl> { <nl> @ @ - 549 , 7 + 558 , 7 @ @ <nl> Biome biome = this . func _ 180494 _ b ( p _ 175670 _ 1 _ ) ; <nl> float f = biome . func _ 180626 _ a ( p _ 175670 _ 1 _ ) ; <nl> <nl> - @ @ - 2540 , 6 + 2709 , 11 @ @ <nl> + @ @ - 2540 , 6 + 2712 , 11 @ @ <nl> <nl> public boolean func _ 175708 _ f ( BlockPos p _ 175708 _ 1 _ , boolean p _ 175708 _ 2 _ ) <nl> { <nl> @ @ - 561 , 7 + 570 , 7 @ @ <nl> Biome biome = this . func _ 180494 _ b ( p _ 175708 _ 1 _ ) ; <nl> float f = biome . func _ 180626 _ a ( p _ 175708 _ 1 _ ) ; <nl> <nl> - @ @ - 2557 , 7 + 2731 , 7 @ @ <nl> + @ @ - 2557 , 7 + 2734 , 7 @ @ <nl> { <nl> IBlockState iblockstate = this . func _ 180495 _ p ( p _ 175708 _ 1 _ ) ; <nl> <nl> @ @ - 570 , 7 + 579 , 7 @ @ <nl> { <nl> return true ; <nl> } <nl> - @ @ - 2589 , 10 + 2763 , 11 @ @ <nl> + @ @ - 2589 , 10 + 2766 , 11 @ @ <nl> else <nl> { <nl> IBlockState iblockstate = this . func _ 180495 _ p ( p _ 175638 _ 1 _ ) ; <nl> @ @ - 585 , 7 + 594 , 7 @ @ <nl> { <nl> j = 1 ; <nl> } <nl> - @ @ - 2691 , 7 + 2866 , 7 @ @ <nl> + @ @ - 2691 , 7 + 2869 , 7 @ @ <nl> int j4 = j2 + enumfacing . func _ 96559 _ d ( ) ; <nl> int k4 = k2 + enumfacing . func _ 82599 _ e ( ) ; <nl> blockpos $ pooledmutableblockpos . func _ 185343 _ d ( i4 , j4 , k4 ) ; <nl> @ @ - 594 , 7 + 603 , 7 @ @ <nl> i3 = this . func _ 175642 _ b ( p _ 180500 _ 1 _ , blockpos $ pooledmutableblockpos ) ; <nl> <nl> if ( i3 = = l2 - l4 & & j < this . field _ 72994 _ J . length ) <nl> - @ @ - 2799 , 10 + 2974 , 10 @ @ <nl> + @ @ - 2799 , 10 + 2977 , 10 @ @ <nl> public List < Entity > func _ 175674 _ a ( @ Nullable Entity p _ 175674 _ 1 _ , AxisAlignedBB p _ 175674 _ 2 _ , @ Nullable Predicate < ? super Entity > p _ 175674 _ 3 _ ) <nl> { <nl> List < Entity > list = Lists . < Entity > newArrayList ( ) ; <nl> @ @ - 609 , 7 + 618 , 7 @ @ <nl> <nl> for ( int i1 = i ; i1 < = j ; + + i1 ) <nl> { <nl> - @ @ - 2855 , 10 + 3030 , 10 @ @ <nl> + @ @ - 2855 , 10 + 3033 , 10 @ @ <nl> <nl> public < T extends Entity > List < T > func _ 175647 _ a ( Class < ? extends T > p _ 175647 _ 1 _ , AxisAlignedBB p _ 175647 _ 2 _ , @ Nullable Predicate < ? super T > p _ 175647 _ 3 _ ) <nl> { <nl> @ @ - 624 , 7 + 633 , 7 @ @ <nl> List < T > list = Lists . < T > newArrayList ( ) ; <nl> <nl> for ( int i1 = i ; i1 < j ; + + i1 ) <nl> - @ @ - 2938 , 11 + 3113 , 13 @ @ <nl> + @ @ - 2938 , 11 + 3116 , 13 @ @ <nl> <nl> public void func _ 175650 _ b ( Collection < Entity > p _ 175650 _ 1 _ ) <nl> { <nl> @ @ - 641 , 7 + 650 , 7 @ @ <nl> } <nl> } <nl> <nl> - @ @ - 2955 , 7 + 3132 , 7 @ @ <nl> + @ @ - 2955 , 7 + 3135 , 7 @ @ <nl> { <nl> IBlockState iblockstate = this . func _ 180495 _ p ( p _ 175716 _ 2 _ ) ; <nl> AxisAlignedBB axisalignedbb = p _ 175716 _ 3 _ ? null : p _ 175716 _ 1 _ . func _ 176223 _ P ( ) . func _ 185890 _ d ( this , p _ 175716 _ 2 _ ) ; <nl> @ @ - 650 , 7 + 659 , 7 @ @ <nl> } <nl> <nl> public int func _ 181545 _ F ( ) <nl> - @ @ - 3038 , 7 + 3215 , 7 @ @ <nl> + @ @ - 3038 , 7 + 3218 , 7 @ @ <nl> public int func _ 175651 _ c ( BlockPos p _ 175651 _ 1 _ , EnumFacing p _ 175651 _ 2 _ ) <nl> { <nl> IBlockState iblockstate = this . func _ 180495 _ p ( p _ 175651 _ 1 _ ) ; <nl> @ @ - 659 , 7 + 668 , 7 @ @ <nl> } <nl> <nl> public boolean func _ 175640 _ z ( BlockPos p _ 175640 _ 1 _ ) <nl> - @ @ - 3235 , 7 + 3412 , 7 @ @ <nl> + @ @ - 3235 , 7 + 3415 , 7 @ @ <nl> <nl> public long func _ 72905 _ C ( ) <nl> { <nl> @ @ - 668 , 7 + 677 , 7 @ @ <nl> } <nl> <nl> public long func _ 82737 _ E ( ) <nl> - @ @ - 3245 , 17 + 3422 , 17 @ @ <nl> + @ @ - 3245 , 17 + 3425 , 17 @ @ <nl> <nl> public long func _ 72820 _ D ( ) <nl> { <nl> @ @ - 689 , 7 + 698 , 7 @ @ <nl> <nl> if ( ! this . func _ 175723 _ af ( ) . func _ 177746 _ a ( blockpos ) ) <nl> { <nl> - @ @ - 3267 , 7 + 3444 , 7 @ @ <nl> + @ @ - 3267 , 7 + 3447 , 7 @ @ <nl> <nl> public void func _ 175652 _ B ( BlockPos p _ 175652 _ 1 _ ) <nl> { <nl> @ @ - 698 , 7 + 707 , 7 @ @ <nl> } <nl> <nl> @ SideOnly ( Side . CLIENT ) <nl> - @ @ - 3287 , 12 + 3464 , 18 @ @ <nl> + @ @ - 3287 , 12 + 3467 , 18 @ @ <nl> <nl> if ( ! this . field _ 72996 _ f . contains ( p _ 72897 _ 1 _ ) ) <nl> { <nl> @ @ - 717 , 7 + 726 , 7 @ @ <nl> return true ; <nl> } <nl> <nl> - @ @ - 3386 , 8 + 3569 , 7 @ @ <nl> + @ @ - 3386 , 8 + 3572 , 7 @ @ <nl> <nl> public boolean func _ 180502 _ D ( BlockPos p _ 180502 _ 1 _ ) <nl> { <nl> @ @ - 727 , 7 + 736 , 7 @ @ <nl> } <nl> <nl> @ Nullable <nl> - @ @ - 3448 , 12 + 3630 , 12 @ @ <nl> + @ @ - 3448 , 12 + 3633 , 12 @ @ <nl> <nl> public int func _ 72800 _ K ( ) <nl> { <nl> @ @ - 742 , 7 + 751 , 7 @ @ <nl> } <nl> <nl> public Random func _ 72843 _ D ( int p _ 72843 _ 1 _ , int p _ 72843 _ 2 _ , int p _ 72843 _ 3 _ ) <nl> - @ @ - 3503 , 7 + 3685 , 7 @ @ <nl> + @ @ - 3503 , 7 + 3688 , 7 @ @ <nl> @ SideOnly ( Side . CLIENT ) <nl> public double func _ 72919 _ O ( ) <nl> { <nl> @ @ - 751 , 7 + 760 , 7 @ @ <nl> } <nl> <nl> public void func _ 175715 _ c ( int p _ 175715 _ 1 _ , BlockPos p _ 175715 _ 2 _ , int p _ 175715 _ 3 _ ) <nl> - @ @ - 3537 , 7 + 3719 , 7 @ @ <nl> + @ @ - 3537 , 7 + 3722 , 7 @ @ <nl> <nl> public void func _ 175666 _ e ( BlockPos p _ 175666 _ 1 _ , Block p _ 175666 _ 2 _ ) <nl> { <nl> @ @ - 760 , 7 + 769 , 7 @ @ <nl> { <nl> BlockPos blockpos = p _ 175666 _ 1 _ . func _ 177972 _ a ( enumfacing ) ; <nl> <nl> - @ @ - 3545 , 18 + 3727 , 14 @ @ <nl> + @ @ - 3545 , 18 + 3730 , 14 @ @ <nl> { <nl> IBlockState iblockstate = this . func _ 180495 _ p ( blockpos ) ; <nl> <nl> @ @ - 783 , 7 + 792 , 7 @ @ <nl> } <nl> } <nl> } <nl> - @ @ - 3622 , 6 + 3800 , 87 @ @ <nl> + @ @ - 3622 , 6 + 3803 , 87 @ @ <nl> return i > = - k & & i < = k & & j > = - k & & j < = k ; <nl> } <nl>
NEAREST DIFF (one line): diff - - git a / patches / minecraft / net / minecraft / util / math / BlockPos . java . patch b / patches / minecraft / net / minecraft / util / math / BlockPos . java . patch <nl> index 70319c0 . . 33fca8b 100644 <nl> - - - a / patches / minecraft / net / minecraft / util / math / BlockPos . java . patch <nl> + + + b / patches / minecraft / net / minecraft / util / math / BlockPos . java . patch <nl> @ @ - 1 , 41 + 1 , 11 @ @ <nl> - - - . . / src - base / minecraft / net / minecraft / util / math / BlockPos . java <nl> + + + . . / src - work / minecraft / net / minecraft / util / math / BlockPos . java <nl> - @ @ - 270 , 6 + 270 , 21 @ @ <nl> - } ; <nl> - } <nl> - <nl> - + / * * <nl> - + * Returns a version of this BlockPos that is guaranteed to be Immutable . <nl> - + * In most cases this will return ' this ' , but if ' this ' is an instance of <nl> - + * MutableBlockPos it will return a new instance of BlockPos with the same values . <nl> - + * <nl> - + * When storing a parameter given to you for an extended period of time , make sure you <nl> - + * use this in case the value is changed internally . <nl> - + * <nl> - + * @ return An immutable BlockPos . <nl> - + * / <nl> - + public BlockPos getImmutable ( ) <nl> - + { <nl> - + return this ; <nl> - + } <nl> - + <nl> - public static final class MutableBlockPos extends BlockPos <nl> - { <nl> - private int field _ 177997 _ b ; <nl> - @ @ - 333 , 6 + 348 , 8 @ @ <nl> - { <nl> - return new BlockPos ( this ) ; <nl> - } <nl> - + <nl> - + @ Override public BlockPos getImmutable ( ) { return new BlockPos ( this ) ; } <nl> - } <nl> - <nl> - public static final class PooledMutableBlockPos extends BlockPos <nl> - @ @ - 443 , 5 + 460 , 7 @ @ <nl> + @ @ - 443 , 5 + 443 , 8 @ @ <nl> { <nl> return this . func _ 185343 _ d ( this . field _ 185347 _ c + p _ 185341 _ 1 _ . func _ 82601 _ c ( ) , this . field _ 185348 _ d + p _ 185341 _ 1 _ . func _ 96559 _ d ( ) , this . field _ 185349 _ e + p _ 185341 _ 1 _ . func _ 82599 _ e ( ) ) ; <nl> } <nl> + <nl> - + @ Override public BlockPos getImmutable ( ) { return new BlockPos ( this ) ; } <nl> + + / / This method can safely be removed once vanilla adds it - MC - 100165 <nl> + + @ Override public BlockPos func _ 185334 _ h ( ) { return new BlockPos ( this ) ; } <nl> } <nl> } <nl> diff - - git a / patches / minecraft / net / minecraft / world / World . java . patch b / patches / minecraft / net / minecraft / world / World . java . patch <nl> index 9164dab . . cae7214 100644 <nl> - - - a / patches / minecraft / net / minecraft / world / World . java . patch <nl> + + + b / patches / minecraft / net / minecraft / world / World . java . patch <nl> @ @ - 550 , 7 + 550 , 15 @ @ <nl> explosion . func _ 77278 _ a ( ) ; <nl> explosion . func _ 77279 _ a ( true ) ; <nl> return explosion ; <nl> - @ @ - 2276 , 19 + 2423 , 27 @ @ <nl> + @ @ - 2253 , 6 + 2400 , 7 @ @ <nl> + <nl> + public void func _ 175690 _ a ( BlockPos p _ 175690 _ 1 _ , TileEntity p _ 175690 _ 2 _ ) <nl> + { <nl> + + p _ 175690 _ 1 _ = p _ 175690 _ 1 _ . func _ 185334 _ h ( ) ; / / Forge - prevent mutable BlockPos leaks <nl> + if ( p _ 175690 _ 2 _ ! = null & & ! p _ 175690 _ 2 _ . func _ 145837 _ r ( ) ) <nl> + { <nl> + if ( this . field _ 147481 _ N ) <nl> + @ @ - 2276 , 19 + 2424 , 27 @ @ <nl> else <nl> { <nl> this . func _ 175700 _ a ( p _ 175690 _ 2 _ ) ; <nl> @ @ - 579 , 7 + 587 , 7 @ @ <nl> } <nl> else <nl> { <nl> - @ @ - 2301 , 6 + 2456 , 7 @ @ <nl> + @ @ - 2301 , 6 + 2457 , 7 @ @ <nl> <nl> this . func _ 175726 _ f ( p _ 175713 _ 1 _ ) . func _ 177425 _ e ( p _ 175713 _ 1 _ ) ; <nl> } <nl> @ @ - 587 , 7 + 595 , 7 @ @ <nl> } <nl> <nl> public void func _ 147457 _ a ( TileEntity p _ 147457 _ 1 _ ) <nl> - @ @ - 2327 , 7 + 2483 , 7 @ @ <nl> + @ @ - 2327 , 7 + 2484 , 7 @ @ <nl> if ( chunk ! = null & & ! chunk . func _ 76621 _ g ( ) ) <nl> { <nl> IBlockState iblockstate = this . func _ 180495 _ p ( p _ 175677 _ 1 _ ) ; <nl> @ @ - 596 , 7 + 604 , 7 @ @ <nl> } <nl> else <nl> { <nl> - @ @ - 2350 , 6 + 2506 , 7 @ @ <nl> + @ @ - 2350 , 6 + 2507 , 7 @ @ <nl> { <nl> this . field _ 72985 _ G = p _ 72891 _ 1 _ ; <nl> this . field _ 72992 _ H = p _ 72891 _ 2 _ ; <nl> @ @ - 604 , 7 + 612 , 7 @ @ <nl> } <nl> <nl> public void func _ 72835 _ b ( ) <nl> - @ @ - 2359 , 6 + 2516 , 11 @ @ <nl> + @ @ - 2359 , 6 + 2517 , 11 @ @ <nl> <nl> protected void func _ 72947 _ a ( ) <nl> { <nl> @ @ - 616 , 7 + 624 , 7 @ @ <nl> if ( this . field _ 72986 _ A . func _ 76059 _ o ( ) ) <nl> { <nl> this . field _ 73004 _ o = 1 . 0F ; <nl> - @ @ - 2372 , 6 + 2534 , 11 @ @ <nl> + @ @ - 2372 , 6 + 2535 , 11 @ @ <nl> <nl> protected void func _ 72979 _ l ( ) <nl> { <nl> @ @ - 628 , 7 + 636 , 7 @ @ <nl> if ( ! this . field _ 73011 _ w . func _ 177495 _ o ( ) ) <nl> { <nl> if ( ! this . field _ 72995 _ K ) <nl> - @ @ - 2491 , 28 + 2658 , 33 @ @ <nl> + @ @ - 2491 , 28 + 2659 , 33 @ @ <nl> <nl> public boolean func _ 175670 _ e ( BlockPos p _ 175670 _ 1 _ , boolean p _ 175670 _ 2 _ ) <nl> { <nl> @ @ - 668 , 7 + 676 , 7 @ @ <nl> <nl> if ( ! flag ) <nl> { <nl> - @ @ - 2532 , 24 + 2704 , 29 @ @ <nl> + @ @ - 2532 , 24 + 2705 , 29 @ @ <nl> <nl> public boolean func _ 175708 _ f ( BlockPos p _ 175708 _ 1 _ , boolean p _ 175708 _ 2 _ ) <nl> { <nl> @ @ - 704 , 7 + 712 , 7 @ @ <nl> { <nl> return true ; <nl> } <nl> - @ @ - 2581 , 10 + 2758 , 11 @ @ <nl> + @ @ - 2581 , 10 + 2759 , 11 @ @ <nl> else <nl> { <nl> IBlockState iblockstate = this . func _ 180495 _ p ( p _ 175638 _ 1 _ ) ; <nl> @ @ - 719 , 7 + 727 , 7 @ @ <nl> { <nl> j = 1 ; <nl> } <nl> - @ @ - 2683 , 7 + 2861 , 7 @ @ <nl> + @ @ - 2683 , 7 + 2862 , 7 @ @ <nl> int j4 = j2 + enumfacing . func _ 96559 _ d ( ) ; <nl> int k4 = k2 + enumfacing . func _ 82599 _ e ( ) ; <nl> blockpos $ pooledmutableblockpos . func _ 185343 _ d ( i4 , j4 , k4 ) ; <nl> @ @ - 728 , 7 + 736 , 7 @ @ <nl> i3 = this . func _ 175642 _ b ( p _ 180500 _ 1 _ , blockpos $ pooledmutableblockpos ) ; <nl> <nl> if ( i3 = = l2 - l4 & & j < this . field _ 72994 _ J . length ) <nl> - @ @ - 2789 , 10 + 2967 , 10 @ @ <nl> + @ @ - 2789 , 10 + 2968 , 10 @ @ <nl> public List < Entity > func _ 175674 _ a ( Entity p _ 175674 _ 1 _ , AxisAlignedBB p _ 175674 _ 2 _ , Predicate < ? super Entity > p _ 175674 _ 3 _ ) <nl> { <nl> List < Entity > list = Lists . < Entity > newArrayList ( ) ; <nl> @ @ - 743 , 7 + 751 , 7 @ @ <nl> <nl> for ( int i1 = i ; i1 < = j ; + + i1 ) <nl> { <nl> - @ @ - 2845 , 10 + 3023 , 10 @ @ <nl> + @ @ - 2845 , 10 + 3024 , 10 @ @ <nl> <nl> public < T extends Entity > List < T > func _ 175647 _ a ( Class < ? extends T > p _ 175647 _ 1 _ , AxisAlignedBB p _ 175647 _ 2 _ , Predicate < ? super T > p _ 175647 _ 3 _ ) <nl> { <nl> @ @ - 758 , 7 + 766 , 7 @ @ <nl> List < T > list = Lists . < T > newArrayList ( ) ; <nl> <nl> for ( int i1 = i ; i1 < j ; + + i1 ) <nl> - @ @ - 2926 , 11 + 3104 , 13 @ @ <nl> + @ @ - 2926 , 11 + 3105 , 13 @ @ <nl> <nl> public void func _ 175650 _ b ( Collection < Entity > p _ 175650 _ 1 _ ) <nl> { <nl> @ @ - 775 , 7 + 783 , 7 @ @ <nl> } <nl> } <nl> <nl> - @ @ - 2943 , 7 + 3123 , 7 @ @ <nl> + @ @ - 2943 , 7 + 3124 , 7 @ @ <nl> { <nl> IBlockState iblockstate = this . func _ 180495 _ p ( p _ 175716 _ 2 _ ) ; <nl> AxisAlignedBB axisalignedbb = p _ 175716 _ 3 _ ? null : p _ 175716 _ 1 _ . func _ 176223 _ P ( ) . func _ 185890 _ d ( this , p _ 175716 _ 2 _ ) ; <nl> @ @ - 784 , 7 + 792 , 7 @ @ <nl> } <nl> <nl> public int func _ 181545 _ F ( ) <nl> - @ @ - 3026 , 7 + 3206 , 7 @ @ <nl> + @ @ - 3026 , 7 + 3207 , 7 @ @ <nl> public int func _ 175651 _ c ( BlockPos p _ 175651 _ 1 _ , EnumFacing p _ 175651 _ 2 _ ) <nl> { <nl> IBlockState iblockstate = this . func _ 180495 _ p ( p _ 175651 _ 1 _ ) ; <nl> @ @ - 793 , 7 + 801 , 7 @ @ <nl> } <nl> <nl> public boolean func _ 175640 _ z ( BlockPos p _ 175640 _ 1 _ ) <nl> - @ @ - 3215 , 7 + 3395 , 7 @ @ <nl> + @ @ - 3215 , 7 + 3396 , 7 @ @ <nl> <nl> public long func _ 72905 _ C ( ) <nl> { <nl> @ @ - 802 , 7 + 810 , 7 @ @ <nl> } <nl> <nl> public long func _ 82737 _ E ( ) <nl> - @ @ - 3225 , 17 + 3405 , 17 @ @ <nl> + @ @ - 3225 , 17 + 3406 , 17 @ @ <nl> <nl> public long func _ 72820 _ D ( ) <nl> { <nl> @ @ - 823 , 7 + 831 , 7 @ @ <nl> <nl> if ( ! this . func _ 175723 _ af ( ) . func _ 177746 _ a ( blockpos ) ) <nl> { <nl> - @ @ - 3247 , 7 + 3427 , 7 @ @ <nl> + @ @ - 3247 , 7 + 3428 , 7 @ @ <nl> <nl> public void func _ 175652 _ B ( BlockPos p _ 175652 _ 1 _ ) <nl> { <nl> @ @ - 832 , 7 + 840 , 7 @ @ <nl> } <nl> <nl> @ SideOnly ( Side . CLIENT ) <nl> - @ @ - 3267 , 12 + 3447 , 18 @ @ <nl> + @ @ - 3267 , 12 + 3448 , 18 @ @ <nl> <nl> if ( ! this . field _ 72996 _ f . contains ( p _ 72897 _ 1 _ ) ) <nl> { <nl> @ @ - 851 , 7 + 859 , 7 @ @ <nl> return true ; <nl> } <nl> <nl> - @ @ - 3366 , 8 + 3552 , 7 @ @ <nl> + @ @ - 3366 , 8 + 3553 , 7 @ @ <nl> <nl> public boolean func _ 180502 _ D ( BlockPos p _ 180502 _ 1 _ ) <nl> { <nl> @ @ - 861 , 7 + 869 , 7 @ @ <nl> } <nl> <nl> public MapStorage func _ 175693 _ T ( ) <nl> - @ @ - 3426 , 12 + 3611 , 12 @ @ <nl> + @ @ - 3426 , 12 + 3612 , 12 @ @ <nl> <nl> public int func _ 72800 _ K ( ) <nl> { <nl> @ @ - 876 , 7 + 884 , 7 @ @ <nl> } <nl> <nl> public Random func _ 72843 _ D ( int p _ 72843 _ 1 _ , int p _ 72843 _ 2 _ , int p _ 72843 _ 3 _ ) <nl> - @ @ - 3481 , 7 + 3666 , 7 @ @ <nl> + @ @ - 3481 , 7 + 3667 , 7 @ @ <nl> @ SideOnly ( Side . CLIENT ) <nl> public double func _ 72919 _ O ( ) <nl> { <nl> @ @ - 885 , 7 + 893 , 7 @ @ <nl> } <nl> <nl> public void func _ 175715 _ c ( int p _ 175715 _ 1 _ , BlockPos p _ 175715 _ 2 _ , int p _ 175715 _ 3 _ ) <nl> - @ @ - 3515 , 7 + 3700 , 7 @ @ <nl> + @ @ - 3515 , 7 + 3701 , 7 @ @ <nl> <nl> public void func _ 175666 _ e ( BlockPos p _ 175666 _ 1 _ , Block p _ 175666 _ 2 _ ) <nl> { <nl> @ @ - 894 , 7 + 902 , 7 @ @ <nl> { <nl> BlockPos blockpos = p _ 175666 _ 1 _ . func _ 177972 _ a ( enumfacing ) ; <nl> <nl> - @ @ - 3523 , 18 + 3708 , 14 @ @ <nl> + @ @ - 3523 , 18 + 3709 , 14 @ @ <nl> { <nl> IBlockState iblockstate = this . func _ 180495 _ p ( blockpos ) ; <nl> <nl> @ @ - 917 , 7 + 925 , 7 @ @ <nl> } <nl> } <nl> } <nl> - @ @ - 3600 , 6 + 3781 , 87 @ @ <nl> + @ @ - 3600 , 6 + 3782 , 87 @ @ <nl> return i > = - k & & i < = k & & j > = - k & & j < = k ; <nl> } <nl> <nl> diff - - git a / patches / minecraft / net / minecraft / world / chunk / Chunk . java . patch b / patches / minecraft / net / minecraft / world / chunk / Chunk . java . patch <nl> index 7db81e4 . . 71b1ade 100644 <nl> - - - a / patches / minecraft / net / minecraft / world / chunk / Chunk . java . patch <nl> + + + b / patches / minecraft / net / minecraft / world / chunk / Chunk . java . patch <nl> @ @ - 129 , 7 + 129 , 7 @ @ <nl> else if ( p _ 177424 _ 2 _ = = Chunk . EnumCreateEntityType . QUEUED ) <nl> { <nl> - this . field _ 177447 _ w . add ( p _ 177424 _ 1 _ ) ; <nl> - + this . field _ 177447 _ w . add ( p _ 177424 _ 1 _ . getImmutable ( ) ) ; <nl> + + this . field _ 177447 _ w . add ( p _ 177424 _ 1 _ . func _ 185334 _ h ( ) ) ; <nl> } <nl> } <nl> - else if ( tileentity . func _ 145837 _ r ( ) ) <nl> diff - - git a / src / main / java / net / minecraftforge / common / util / BlockSnapshot . java b / src / main / java / net / minecraftforge / common / util / BlockSnapshot . java <nl> index 1e29527 . . d1a2618 100644 <nl> - - - a / src / main / java / net / minecraftforge / common / util / BlockSnapshot . java <nl> + + + b / src / main / java / net / minecraftforge / common / util / BlockSnapshot . java <nl> @ @ - 58 , 7 + 58 , 7 @ @ public class BlockSnapshot implements Serializable <nl> { <nl> this . setWorld ( world ) ; <nl> this . dimId = world . provider . getDimension ( ) ; <nl> - this . pos = pos . getImmutable ( ) ; <nl> + this . pos = pos . toImmutable ( ) ; <nl> this . setReplacedBlock ( state ) ; <nl> this . registryName = new ResourceLocation ( state . getBlock ( ) . getRegistryName ( ) ) ; <nl> this . meta = state . getBlock ( ) . getMetaFromState ( state ) ; <nl> @ @ - 82 , 7 + 82 , 7 @ @ public class BlockSnapshot implements Serializable <nl> public BlockSnapshot ( int dimension , BlockPos pos , String modId , String blockName , int meta , int flag , NBTTagCompound nbt ) <nl> { <nl> this . dimId = dimension ; <nl> - this . pos = pos . getImmutable ( ) ; <nl> + this . pos = pos . toImmutable ( ) ; <nl> this . setFlag ( flag ) ; <nl> this . registryName = new ResourceLocation ( modId , blockName ) ; <nl> this . meta = meta ;

TEST DIFF:
diff - - git a / patches / minecraft / net / minecraft / world / World . java . patch b / patches / minecraft / net / minecraft / world / World . java . patch 
 index 283a366 . . 872c37a 100644 
 - - - a / patches / minecraft / net / minecraft / world / World . java . patch 
 + + + b / patches / minecraft / net / minecraft / world / World . java . patch 
 @ @ - 364 , 7 + 364 , 16 @ @ 
 throw new ReportedException ( crashreport2 ) ; 
 } 
 } 
 - @ @ - 1707 , 15 + 1826 , 20 @ @ 
 + @ @ - 1702 , 20 + 1821 , 28 @ @ 
 + 
 + if ( this . func _ 175667 _ e ( tileentity . func _ 174877 _ v ( ) ) ) 
 + { 
 + - this . func _ 175726 _ f ( tileentity . func _ 174877 _ v ( ) ) . func _ 177425 _ e ( tileentity . func _ 174877 _ v ( ) ) ; 
 + + / / Forge : Bugfix : If we set the tile entity it immediately sets it in the chunk , so we could be desyned 
 + + Chunk chunk = this . func _ 175726 _ f ( tileentity . func _ 174877 _ v ( ) ) ; 
 + + if ( chunk . func _ 177424 _ a ( tileentity . func _ 174877 _ v ( ) , net . minecraft . world . chunk . Chunk . EnumCreateEntityType . CHECK ) = = tileentity ) 
 + + chunk . func _ 177425 _ e ( tileentity . func _ 174877 _ v ( ) ) ; 
 + } 
 } 
 } 
 
 @ @ - 387 , 7 + 396 , 7 @ @ 
 this . field _ 72984 _ F . func _ 76318 _ c ( " pendingBlockEntities " ) ; 
 
 if ( ! this . field _ 147484 _ a . isEmpty ( ) ) 
 - @ @ - 1754 , 7 + 1878 , 8 @ @ 
 + @ @ - 1754 , 7 + 1881 , 8 @ @ 
 
 public boolean func _ 175700 _ a ( TileEntity p _ 175700 _ 1 _ ) 
 { 
 @ @ - 397 , 7 + 406 , 7 @ @ 
 
 if ( flag & & p _ 175700 _ 1 _ instanceof ITickable ) 
 { 
 - @ @ - 1788 , 9 + 1913 , 13 @ @ 
 + @ @ - 1788 , 9 + 1916 , 13 @ @ 
 { 
 int i = MathHelper . func _ 76128 _ c ( p _ 72866 _ 1 _ . field _ 70165 _ t ) ; 
 int j = MathHelper . func _ 76128 _ c ( p _ 72866 _ 1 _ . field _ 70161 _ v ) ; 
 @ @ - 413 , 7 + 422 , 7 @ @ 
 { 
 p _ 72866 _ 1 _ . field _ 70142 _ S = p _ 72866 _ 1 _ . field _ 70165 _ t ; 
 p _ 72866 _ 1 _ . field _ 70137 _ T = p _ 72866 _ 1 _ . field _ 70163 _ u ; 
 - @ @ - 1989 , 6 + 2118 , 10 @ @ 
 + @ @ - 1989 , 6 + 2121 , 10 @ @ 
 blockpos $ pooledmutableblockpos . func _ 185344 _ t ( ) ; 
 return true ; 
 } 
 @ @ - 424 , 7 + 433 , 7 @ @ 
 } 
 } 
 } 
 - @ @ - 2028 , 6 + 2161 , 16 @ @ 
 + @ @ - 2028 , 6 + 2164 , 16 @ @ 
 IBlockState iblockstate = this . func _ 180495 _ p ( blockpos $ pooledmutableblockpos ) ; 
 Block block = iblockstate . func _ 177230 _ c ( ) ; 
 
 @ @ - 441 , 7 + 450 , 7 @ @ 
 if ( iblockstate . func _ 185904 _ a ( ) = = p _ 72918 _ 2 _ ) 
 { 
 double d0 = ( double ) ( ( float ) ( l1 + 1 ) - BlockLiquid . func _ 149801 _ b ( ( ( Integer ) iblockstate . func _ 177229 _ b ( BlockLiquid . field _ 176367 _ b ) ) . intValue ( ) ) ) ; 
 - @ @ - 2104 , 6 + 2247 , 9 @ @ 
 + @ @ - 2104 , 6 + 2250 , 9 @ @ 
 { 
 IBlockState iblockstate = this . func _ 180495 _ p ( blockpos $ pooledmutableblockpos . func _ 185343 _ d ( k1 , l1 , i2 ) ) ; 
 
 @ @ - 451 , 7 + 460 , 7 @ @ 
 if ( iblockstate . func _ 185904 _ a ( ) = = p _ 72830 _ 2 _ ) 
 { 
 int j2 = ( ( Integer ) iblockstate . func _ 177229 _ b ( BlockLiquid . field _ 176367 _ b ) ) . intValue ( ) ; 
 - @ @ - 2136 , 6 + 2282 , 7 @ @ 
 + @ @ - 2136 , 6 + 2285 , 7 @ @ 
 public Explosion func _ 72885 _ a ( @ Nullable Entity p _ 72885 _ 1 _ , double p _ 72885 _ 2 _ , double p _ 72885 _ 4 _ , double p _ 72885 _ 6 _ , float p _ 72885 _ 8 _ , boolean p _ 72885 _ 9 _ , boolean p _ 72885 _ 10 _ ) 
 { 
 Explosion explosion = new Explosion ( this , p _ 72885 _ 1 _ , p _ 72885 _ 2 _ , p _ 72885 _ 4 _ , p _ 72885 _ 6 _ , p _ 72885 _ 8 _ , p _ 72885 _ 9 _ , p _ 72885 _ 10 _ ) ; 
 @ @ - 459 , 7 + 468 , 7 @ @ 
 explosion . func _ 77278 _ a ( ) ; 
 explosion . func _ 77279 _ a ( true ) ; 
 return explosion ; 
 - @ @ - 2258 , 6 + 2405 , 7 @ @ 
 + @ @ - 2258 , 6 + 2408 , 7 @ @ 
 
 public void func _ 175690 _ a ( BlockPos p _ 175690 _ 1 _ , @ Nullable TileEntity p _ 175690 _ 2 _ ) 
 { 
 @ @ - 467 , 7 + 476 , 7 @ @ 
 if ( ! this . func _ 189509 _ E ( p _ 175690 _ 1 _ ) ) 
 { 
 if ( p _ 175690 _ 2 _ ! = null & & ! p _ 175690 _ 2 _ . func _ 145837 _ r ( ) ) 
 - @ @ - 2283 , 8 + 2431 , 10 @ @ 
 + @ @ - 2283 , 8 + 2434 , 10 @ @ 
 else 
 { 
 this . func _ 175700 _ a ( p _ 175690 _ 2 _ ) ; 
 @ @ - 479 , 7 + 488 , 7 @ @ 
 } 
 } 
 } 
 - @ @ - 2297 , 6 + 2447 , 8 @ @ 
 + @ @ - 2297 , 6 + 2450 , 8 @ @ 
 { 
 tileentity . func _ 145843 _ s ( ) ; 
 this . field _ 147484 _ a . remove ( tileentity ) ; 
 @ @ - 488 , 7 + 497 , 7 @ @ 
 } 
 else 
 { 
 - @ @ - 2309 , 6 + 2461 , 7 @ @ 
 + @ @ - 2309 , 6 + 2464 , 7 @ @ 
 
 this . func _ 175726 _ f ( p _ 175713 _ 1 _ ) . func _ 177425 _ e ( p _ 175713 _ 1 _ ) ; 
 } 
 @ @ - 496 , 7 + 505 , 7 @ @ 
 } 
 
 public void func _ 147457 _ a ( TileEntity p _ 147457 _ 1 _ ) 
 - @ @ - 2335 , 7 + 2488 , 7 @ @ 
 + @ @ - 2335 , 7 + 2491 , 7 @ @ 
 if ( chunk ! = null & & ! chunk . func _ 76621 _ g ( ) ) 
 { 
 IBlockState iblockstate = this . func _ 180495 _ p ( p _ 175677 _ 1 _ ) ; 
 @ @ - 505 , 7 + 514 , 7 @ @ 
 } 
 else 
 { 
 - @ @ - 2358 , 6 + 2511 , 7 @ @ 
 + @ @ - 2358 , 6 + 2514 , 7 @ @ 
 { 
 this . field _ 72985 _ G = p _ 72891 _ 1 _ ; 
 this . field _ 72992 _ H = p _ 72891 _ 2 _ ; 
 @ @ - 513 , 7 + 522 , 7 @ @ 
 } 
 
 public void func _ 72835 _ b ( ) 
 - @ @ - 2367 , 6 + 2521 , 11 @ @ 
 + @ @ - 2367 , 6 + 2524 , 11 @ @ 
 
 protected void func _ 72947 _ a ( ) 
 { 
 @ @ - 525 , 7 + 534 , 7 @ @ 
 if ( this . field _ 72986 _ A . func _ 76059 _ o ( ) ) 
 { 
 this . field _ 73004 _ o = 1 . 0F ; 
 - @ @ - 2380 , 6 + 2539 , 11 @ @ 
 + @ @ - 2380 , 6 + 2542 , 11 @ @ 
 
 protected void func _ 72979 _ l ( ) 
 { 
 @ @ - 537 , 7 + 546 , 7 @ @ 
 if ( ! this . field _ 73011 _ w . func _ 177495 _ o ( ) ) 
 { 
 if ( ! this . field _ 72995 _ K ) 
 - @ @ - 2499 , 6 + 2663 , 11 @ @ 
 + @ @ - 2499 , 6 + 2666 , 11 @ @ 
 
 public boolean func _ 175670 _ e ( BlockPos p _ 175670 _ 1 _ , boolean p _ 175670 _ 2 _ ) 
 { 
 @ @ - 549 , 7 + 558 , 7 @ @ 
 Biome biome = this . func _ 180494 _ b ( p _ 175670 _ 1 _ ) ; 
 float f = biome . func _ 180626 _ a ( p _ 175670 _ 1 _ ) ; 
 
 - @ @ - 2540 , 6 + 2709 , 11 @ @ 
 + @ @ - 2540 , 6 + 2712 , 11 @ @ 
 
 public boolean func _ 175708 _ f ( BlockPos p _ 175708 _ 1 _ , boolean p _ 175708 _ 2 _ ) 
 { 
 @ @ - 561 , 7 + 570 , 7 @ @ 
 Biome biome = this . func _ 180494 _ b ( p _ 175708 _ 1 _ ) ; 
 float f = biome . func _ 180626 _ a ( p _ 175708 _ 1 _ ) ; 
 
 - @ @ - 2557 , 7 + 2731 , 7 @ @ 
 + @ @ - 2557 , 7 + 2734 , 7 @ @ 
 { 
 IBlockState iblockstate = this . func _ 180495 _ p ( p _ 175708 _ 1 _ ) ; 
 
 @ @ - 570 , 7 + 579 , 7 @ @ 
 { 
 return true ; 
 } 
 - @ @ - 2589 , 10 + 2763 , 11 @ @ 
 + @ @ - 2589 , 10 + 2766 , 11 @ @ 
 else 
 { 
 IBlockState iblockstate = this . func _ 180495 _ p ( p _ 175638 _ 1 _ ) ; 
 @ @ - 585 , 7 + 594 , 7 @ @ 
 { 
 j = 1 ; 
 } 
 - @ @ - 2691 , 7 + 2866 , 7 @ @ 
 + @ @ - 2691 , 7 + 2869 , 7 @ @ 
 int j4 = j2 + enumfacing . func _ 96559 _ d ( ) ; 
 int k4 = k2 + enumfacing . func _ 82599 _ e ( ) ; 
 blockpos $ pooledmutableblockpos . func _ 185343 _ d ( i4 , j4 , k4 ) ; 
 @ @ - 594 , 7 + 603 , 7 @ @ 
 i3 = this . func _ 175642 _ b ( p _ 180500 _ 1 _ , blockpos $ pooledmutableblockpos ) ; 
 
 if ( i3 = = l2 - l4 & & j < this . field _ 72994 _ J . length ) 
 - @ @ - 2799 , 10 + 2974 , 10 @ @ 
 + @ @ - 2799 , 10 + 2977 , 10 @ @ 
 public List < Entity > func _ 175674 _ a ( @ Nullable Entity p _ 175674 _ 1 _ , AxisAlignedBB p _ 175674 _ 2 _ , @ Nullable Predicate < ? super Entity > p _ 175674 _ 3 _ ) 
 { 
 List < Entity > list = Lists . < Entity > newArrayList ( ) ; 
 @ @ - 609 , 7 + 618 , 7 @ @ 
 
 for ( int i1 = i ; i1 < = j ; + + i1 ) 
 { 
 - @ @ - 2855 , 10 + 3030 , 10 @ @ 
 + @ @ - 2855 , 10 + 3033 , 10 @ @ 
 
 public < T extends Entity > List < T > func _ 175647 _ a ( Class < ? extends T > p _ 175647 _ 1 _ , AxisAlignedBB p _ 175647 _ 2 _ , @ Nullable Predicate < ? super T > p _ 175647 _ 3 _ ) 
 { 
 @ @ - 624 , 7 + 633 , 7 @ @ 
 List < T > list = Lists . < T > newArrayList ( ) ; 
 
 for ( int i1 = i ; i1 < j ; + + i1 ) 
 - @ @ - 2938 , 11 + 3113 , 13 @ @ 
 + @ @ - 2938 , 11 + 3116 , 13 @ @ 
 
 public void func _ 175650 _ b ( Collection < Entity > p _ 175650 _ 1 _ ) 
 { 
 @ @ - 641 , 7 + 650 , 7 @ @ 
 } 
 } 
 
 - @ @ - 2955 , 7 + 3132 , 7 @ @ 
 + @ @ - 2955 , 7 + 3135 , 7 @ @ 
 { 
 IBlockState iblockstate = this . func _ 180495 _ p ( p _ 175716 _ 2 _ ) ; 
 AxisAlignedBB axisalignedbb = p _ 175716 _ 3 _ ? null : p _ 175716 _ 1 _ . func _ 176223 _ P ( ) . func _ 185890 _ d ( this , p _ 175716 _ 2 _ ) ; 
 @ @ - 650 , 7 + 659 , 7 @ @ 
 } 
 
 public int func _ 181545 _ F ( ) 
 - @ @ - 3038 , 7 + 3215 , 7 @ @ 
 + @ @ - 3038 , 7 + 3218 , 7 @ @ 
 public int func _ 175651 _ c ( BlockPos p _ 175651 _ 1 _ , EnumFacing p _ 175651 _ 2 _ ) 
 { 
 IBlockState iblockstate = this . func _ 180495 _ p ( p _ 175651 _ 1 _ ) ; 
 @ @ - 659 , 7 + 668 , 7 @ @ 
 } 
 
 public boolean func _ 175640 _ z ( BlockPos p _ 175640 _ 1 _ ) 
 - @ @ - 3235 , 7 + 3412 , 7 @ @ 
 + @ @ - 3235 , 7 + 3415 , 7 @ @ 
 
 public long func _ 72905 _ C ( ) 
 { 
 @ @ - 668 , 7 + 677 , 7 @ @ 
 } 
 
 public long func _ 82737 _ E ( ) 
 - @ @ - 3245 , 17 + 3422 , 17 @ @ 
 + @ @ - 3245 , 17 + 3425 , 17 @ @ 
 
 public long func _ 72820 _ D ( ) 
 { 
 @ @ - 689 , 7 + 698 , 7 @ @ 
 
 if ( ! this . func _ 175723 _ af ( ) . func _ 177746 _ a ( blockpos ) ) 
 { 
 - @ @ - 3267 , 7 + 3444 , 7 @ @ 
 + @ @ - 3267 , 7 + 3447 , 7 @ @ 
 
 public void func _ 175652 _ B ( BlockPos p _ 175652 _ 1 _ ) 
 { 
 @ @ - 698 , 7 + 707 , 7 @ @ 
 } 
 
 @ SideOnly ( Side . CLIENT ) 
 - @ @ - 3287 , 12 + 3464 , 18 @ @ 
 + @ @ - 3287 , 12 + 3467 , 18 @ @ 
 
 if ( ! this . field _ 72996 _ f . contains ( p _ 72897 _ 1 _ ) ) 
 { 
 @ @ - 717 , 7 + 726 , 7 @ @ 
 return true ; 
 } 
 
 - @ @ - 3386 , 8 + 3569 , 7 @ @ 
 + @ @ - 3386 , 8 + 3572 , 7 @ @ 
 
 public boolean func _ 180502 _ D ( BlockPos p _ 180502 _ 1 _ ) 
 { 
 @ @ - 727 , 7 + 736 , 7 @ @ 
 } 
 
 @ Nullable 
 - @ @ - 3448 , 12 + 3630 , 12 @ @ 
 + @ @ - 3448 , 12 + 3633 , 12 @ @ 
 
 public int func _ 72800 _ K ( ) 
 { 
 @ @ - 742 , 7 + 751 , 7 @ @ 
 } 
 
 public Random func _ 72843 _ D ( int p _ 72843 _ 1 _ , int p _ 72843 _ 2 _ , int p _ 72843 _ 3 _ ) 
 - @ @ - 3503 , 7 + 3685 , 7 @ @ 
 + @ @ - 3503 , 7 + 3688 , 7 @ @ 
 @ SideOnly ( Side . CLIENT ) 
 public double func _ 72919 _ O ( ) 
 { 
 @ @ - 751 , 7 + 760 , 7 @ @ 
 } 
 
 public void func _ 175715 _ c ( int p _ 175715 _ 1 _ , BlockPos p _ 175715 _ 2 _ , int p _ 175715 _ 3 _ ) 
 - @ @ - 3537 , 7 + 3719 , 7 @ @ 
 + @ @ - 3537 , 7 + 3722 , 7 @ @ 
 
 public void func _ 175666 _ e ( BlockPos p _ 175666 _ 1 _ , Block p _ 175666 _ 2 _ ) 
 { 
 @ @ - 760 , 7 + 769 , 7 @ @ 
 { 
 BlockPos blockpos = p _ 175666 _ 1 _ . func _ 177972 _ a ( enumfacing ) ; 
 
 - @ @ - 3545 , 18 + 3727 , 14 @ @ 
 + @ @ - 3545 , 18 + 3730 , 14 @ @ 
 { 
 IBlockState iblockstate = this . func _ 180495 _ p ( blockpos ) ; 
 
 @ @ - 783 , 7 + 792 , 7 @ @ 
 } 
 } 
 } 
 - @ @ - 3622 , 6 + 3800 , 87 @ @ 
 + @ @ - 3622 , 6 + 3803 , 87 @ @ 
 return i > = - k & & i < = k & & j > = - k & & j < = k ; 
 } 


NEAREST DIFF:
diff - - git a / patches / minecraft / net / minecraft / util / math / BlockPos . java . patch b / patches / minecraft / net / minecraft / util / math / BlockPos . java . patch 
 index 70319c0 . . 33fca8b 100644 
 - - - a / patches / minecraft / net / minecraft / util / math / BlockPos . java . patch 
 + + + b / patches / minecraft / net / minecraft / util / math / BlockPos . java . patch 
 @ @ - 1 , 41 + 1 , 11 @ @ 
 - - - . . / src - base / minecraft / net / minecraft / util / math / BlockPos . java 
 + + + . . / src - work / minecraft / net / minecraft / util / math / BlockPos . java 
 - @ @ - 270 , 6 + 270 , 21 @ @ 
 - } ; 
 - } 
 - 
 - + / * * 
 - + * Returns a version of this BlockPos that is guaranteed to be Immutable . 
 - + * In most cases this will return ' this ' , but if ' this ' is an instance of 
 - + * MutableBlockPos it will return a new instance of BlockPos with the same values . 
 - + * 
 - + * When storing a parameter given to you for an extended period of time , make sure you 
 - + * use this in case the value is changed internally . 
 - + * 
 - + * @ return An immutable BlockPos . 
 - + * / 
 - + public BlockPos getImmutable ( ) 
 - + { 
 - + return this ; 
 - + } 
 - + 
 - public static final class MutableBlockPos extends BlockPos 
 - { 
 - private int field _ 177997 _ b ; 
 - @ @ - 333 , 6 + 348 , 8 @ @ 
 - { 
 - return new BlockPos ( this ) ; 
 - } 
 - + 
 - + @ Override public BlockPos getImmutable ( ) { return new BlockPos ( this ) ; } 
 - } 
 - 
 - public static final class PooledMutableBlockPos extends BlockPos 
 - @ @ - 443 , 5 + 460 , 7 @ @ 
 + @ @ - 443 , 5 + 443 , 8 @ @ 
 { 
 return this . func _ 185343 _ d ( this . field _ 185347 _ c + p _ 185341 _ 1 _ . func _ 82601 _ c ( ) , this . field _ 185348 _ d + p _ 185341 _ 1 _ . func _ 96559 _ d ( ) , this . field _ 185349 _ e + p _ 185341 _ 1 _ . func _ 82599 _ e ( ) ) ; 
 } 
 + 
 - + @ Override public BlockPos getImmutable ( ) { return new BlockPos ( this ) ; } 
 + + / / This method can safely be removed once vanilla adds it - MC - 100165 
 + + @ Override public BlockPos func _ 185334 _ h ( ) { return new BlockPos ( this ) ; } 
 } 
 } 
 diff - - git a / patches / minecraft / net / minecraft / world / World . java . patch b / patches / minecraft / net / minecraft / world / World . java . patch 
 index 9164dab . . cae7214 100644 
 - - - a / patches / minecraft / net / minecraft / world / World . java . patch 
 + + + b / patches / minecraft / net / minecraft / world / World . java . patch 
 @ @ - 550 , 7 + 550 , 15 @ @ 
 explosion . func _ 77278 _ a ( ) ; 
 explosion . func _ 77279 _ a ( true ) ; 
 return explosion ; 
 - @ @ - 2276 , 19 + 2423 , 27 @ @ 
 + @ @ - 2253 , 6 + 2400 , 7 @ @ 
 + 
 + public void func _ 175690 _ a ( BlockPos p _ 175690 _ 1 _ , TileEntity p _ 175690 _ 2 _ ) 
 + { 
 + + p _ 175690 _ 1 _ = p _ 175690 _ 1 _ . func _ 185334 _ h ( ) ; / / Forge - prevent mutable BlockPos leaks 
 + if ( p _ 175690 _ 2 _ ! = null & & ! p _ 175690 _ 2 _ . func _ 145837 _ r ( ) ) 
 + { 
 + if ( this . field _ 147481 _ N ) 
 + @ @ - 2276 , 19 + 2424 , 27 @ @ 
 else 
 { 
 this . func _ 175700 _ a ( p _ 175690 _ 2 _ ) ; 
 @ @ - 579 , 7 + 587 , 7 @ @ 
 } 
 else 
 { 
 - @ @ - 2301 , 6 + 2456 , 7 @ @ 
 + @ @ - 2301 , 6 + 2457 , 7 @ @ 
 
 this . func _ 175726 _ f ( p _ 175713 _ 1 _ ) . func _ 177425 _ e ( p _ 175713 _ 1 _ ) ; 
 } 
 @ @ - 587 , 7 + 595 , 7 @ @ 
 } 
 
 public void func _ 147457 _ a ( TileEntity p _ 147457 _ 1 _ ) 
 - @ @ - 2327 , 7 + 2483 , 7 @ @ 
 + @ @ - 2327 , 7 + 2484 , 7 @ @ 
 if ( chunk ! = null & & ! chunk . func _ 76621 _ g ( ) ) 
 { 
 IBlockState iblockstate = this . func _ 180495 _ p ( p _ 175677 _ 1 _ ) ; 
 @ @ - 596 , 7 + 604 , 7 @ @ 
 } 
 else 
 { 
 - @ @ - 2350 , 6 + 2506 , 7 @ @ 
 + @ @ - 2350 , 6 + 2507 , 7 @ @ 
 { 
 this . field _ 72985 _ G = p _ 72891 _ 1 _ ; 
 this . field _ 72992 _ H = p _ 72891 _ 2 _ ; 
 @ @ - 604 , 7 + 612 , 7 @ @ 
 } 
 
 public void func _ 72835 _ b ( ) 
 - @ @ - 2359 , 6 + 2516 , 11 @ @ 
 + @ @ - 2359 , 6 + 2517 , 11 @ @ 
 
 protected void func _ 72947 _ a ( ) 
 { 
 @ @ - 616 , 7 + 624 , 7 @ @ 
 if ( this . field _ 72986 _ A . func _ 76059 _ o ( ) ) 
 { 
 this . field _ 73004 _ o = 1 . 0F ; 
 - @ @ - 2372 , 6 + 2534 , 11 @ @ 
 + @ @ - 2372 , 6 + 2535 , 11 @ @ 
 
 protected void func _ 72979 _ l ( ) 
 { 
 @ @ - 628 , 7 + 636 , 7 @ @ 
 if ( ! this . field _ 73011 _ w . func _ 177495 _ o ( ) ) 
 { 
 if ( ! this . field _ 72995 _ K ) 
 - @ @ - 2491 , 28 + 2658 , 33 @ @ 
 + @ @ - 2491 , 28 + 2659 , 33 @ @ 
 
 public boolean func _ 175670 _ e ( BlockPos p _ 175670 _ 1 _ , boolean p _ 175670 _ 2 _ ) 
 { 
 @ @ - 668 , 7 + 676 , 7 @ @ 
 
 if ( ! flag ) 
 { 
 - @ @ - 2532 , 24 + 2704 , 29 @ @ 
 + @ @ - 2532 , 24 + 2705 , 29 @ @ 
 
 public boolean func _ 175708 _ f ( BlockPos p _ 175708 _ 1 _ , boolean p _ 175708 _ 2 _ ) 
 { 
 @ @ - 704 , 7 + 712 , 7 @ @ 
 { 
 return true ; 
 } 
 - @ @ - 2581 , 10 + 2758 , 11 @ @ 
 + @ @ - 2581 , 10 + 2759 , 11 @ @ 
 else 
 { 
 IBlockState iblockstate = this . func _ 180495 _ p ( p _ 175638 _ 1 _ ) ; 
 @ @ - 719 , 7 + 727 , 7 @ @ 
 { 
 j = 1 ; 
 } 
 - @ @ - 2683 , 7 + 2861 , 7 @ @ 
 + @ @ - 2683 , 7 + 2862 , 7 @ @ 
 int j4 = j2 + enumfacing . func _ 96559 _ d ( ) ; 
 int k4 = k2 + enumfacing . func _ 82599 _ e ( ) ; 
 blockpos $ pooledmutableblockpos . func _ 185343 _ d ( i4 , j4 , k4 ) ; 
 @ @ - 728 , 7 + 736 , 7 @ @ 
 i3 = this . func _ 175642 _ b ( p _ 180500 _ 1 _ , blockpos $ pooledmutableblockpos ) ; 
 
 if ( i3 = = l2 - l4 & & j < this . field _ 72994 _ J . length ) 
 - @ @ - 2789 , 10 + 2967 , 10 @ @ 
 + @ @ - 2789 , 10 + 2968 , 10 @ @ 
 public List < Entity > func _ 175674 _ a ( Entity p _ 175674 _ 1 _ , AxisAlignedBB p _ 175674 _ 2 _ , Predicate < ? super Entity > p _ 175674 _ 3 _ ) 
 { 
 List < Entity > list = Lists . < Entity > newArrayList ( ) ; 
 @ @ - 743 , 7 + 751 , 7 @ @ 
 
 for ( int i1 = i ; i1 < = j ; + + i1 ) 
 { 
 - @ @ - 2845 , 10 + 3023 , 10 @ @ 
 + @ @ - 2845 , 10 + 3024 , 10 @ @ 
 
 public < T extends Entity > List < T > func _ 175647 _ a ( Class < ? extends T > p _ 175647 _ 1 _ , AxisAlignedBB p _ 175647 _ 2 _ , Predicate < ? super T > p _ 175647 _ 3 _ ) 
 { 
 @ @ - 758 , 7 + 766 , 7 @ @ 
 List < T > list = Lists . < T > newArrayList ( ) ; 
 
 for ( int i1 = i ; i1 < j ; + + i1 ) 
 - @ @ - 2926 , 11 + 3104 , 13 @ @ 
 + @ @ - 2926 , 11 + 3105 , 13 @ @ 
 
 public void func _ 175650 _ b ( Collection < Entity > p _ 175650 _ 1 _ ) 
 { 
 @ @ - 775 , 7 + 783 , 7 @ @ 
 } 
 } 
 
 - @ @ - 2943 , 7 + 3123 , 7 @ @ 
 + @ @ - 2943 , 7 + 3124 , 7 @ @ 
 { 
 IBlockState iblockstate = this . func _ 180495 _ p ( p _ 175716 _ 2 _ ) ; 
 AxisAlignedBB axisalignedbb = p _ 175716 _ 3 _ ? null : p _ 175716 _ 1 _ . func _ 176223 _ P ( ) . func _ 185890 _ d ( this , p _ 175716 _ 2 _ ) ; 
 @ @ - 784 , 7 + 792 , 7 @ @ 
 } 
 
 public int func _ 181545 _ F ( ) 
 - @ @ - 3026 , 7 + 3206 , 7 @ @ 
 + @ @ - 3026 , 7 + 3207 , 7 @ @ 
 public int func _ 175651 _ c ( BlockPos p _ 175651 _ 1 _ , EnumFacing p _ 175651 _ 2 _ ) 
 { 
 IBlockState iblockstate = this . func _ 180495 _ p ( p _ 175651 _ 1 _ ) ; 
 @ @ - 793 , 7 + 801 , 7 @ @ 
 } 
 
 public boolean func _ 175640 _ z ( BlockPos p _ 175640 _ 1 _ ) 
 - @ @ - 3215 , 7 + 3395 , 7 @ @ 
 + @ @ - 3215 , 7 + 3396 , 7 @ @ 
 
 public long func _ 72905 _ C ( ) 
 { 
 @ @ - 802 , 7 + 810 , 7 @ @ 
 } 
 
 public long func _ 82737 _ E ( ) 
 - @ @ - 3225 , 17 + 3405 , 17 @ @ 
 + @ @ - 3225 , 17 + 3406 , 17 @ @ 
 
 public long func _ 72820 _ D ( ) 
 { 
 @ @ - 823 , 7 + 831 , 7 @ @ 
 
 if ( ! this . func _ 175723 _ af ( ) . func _ 177746 _ a ( blockpos ) ) 
 { 
 - @ @ - 3247 , 7 + 3427 , 7 @ @ 
 + @ @ - 3247 , 7 + 3428 , 7 @ @ 
 
 public void func _ 175652 _ B ( BlockPos p _ 175652 _ 1 _ ) 
 { 
 @ @ - 832 , 7 + 840 , 7 @ @ 
 } 
 
 @ SideOnly ( Side . CLIENT ) 
 - @ @ - 3267 , 12 + 3447 , 18 @ @ 
 + @ @ - 3267 , 12 + 3448 , 18 @ @ 
 
 if ( ! this . field _ 72996 _ f . contains ( p _ 72897 _ 1 _ ) ) 
 { 
 @ @ - 851 , 7 + 859 , 7 @ @ 
 return true ; 
 } 
 
 - @ @ - 3366 , 8 + 3552 , 7 @ @ 
 + @ @ - 3366 , 8 + 3553 , 7 @ @ 
 
 public boolean func _ 180502 _ D ( BlockPos p _ 180502 _ 1 _ ) 
 { 
 @ @ - 861 , 7 + 869 , 7 @ @ 
 } 
 
 public MapStorage func _ 175693 _ T ( ) 
 - @ @ - 3426 , 12 + 3611 , 12 @ @ 
 + @ @ - 3426 , 12 + 3612 , 12 @ @ 
 
 public int func _ 72800 _ K ( ) 
 { 
 @ @ - 876 , 7 + 884 , 7 @ @ 
 } 
 
 public Random func _ 72843 _ D ( int p _ 72843 _ 1 _ , int p _ 72843 _ 2 _ , int p _ 72843 _ 3 _ ) 
 - @ @ - 3481 , 7 + 3666 , 7 @ @ 
 + @ @ - 3481 , 7 + 3667 , 7 @ @ 
 @ SideOnly ( Side . CLIENT ) 
 public double func _ 72919 _ O ( ) 
 { 
 @ @ - 885 , 7 + 893 , 7 @ @ 
 } 
 
 public void func _ 175715 _ c ( int p _ 175715 _ 1 _ , BlockPos p _ 175715 _ 2 _ , int p _ 175715 _ 3 _ ) 
 - @ @ - 3515 , 7 + 3700 , 7 @ @ 
 + @ @ - 3515 , 7 + 3701 , 7 @ @ 
 
 public void func _ 175666 _ e ( BlockPos p _ 175666 _ 1 _ , Block p _ 175666 _ 2 _ ) 
 { 
 @ @ - 894 , 7 + 902 , 7 @ @ 
 { 
 BlockPos blockpos = p _ 175666 _ 1 _ . func _ 177972 _ a ( enumfacing ) ; 
 
 - @ @ - 3523 , 18 + 3708 , 14 @ @ 
 + @ @ - 3523 , 18 + 3709 , 14 @ @ 
 { 
 IBlockState iblockstate = this . func _ 180495 _ p ( blockpos ) ; 
 
 @ @ - 917 , 7 + 925 , 7 @ @ 
 } 
 } 
 } 
 - @ @ - 3600 , 6 + 3781 , 87 @ @ 
 + @ @ - 3600 , 6 + 3782 , 87 @ @ 
 return i > = - k & & i < = k & & j > = - k & & j < = k ; 
 } 
 
 diff - - git a / patches / minecraft / net / minecraft / world / chunk / Chunk . java . patch b / patches / minecraft / net / minecraft / world / chunk / Chunk . java . patch 
 index 7db81e4 . . 71b1ade 100644 
 - - - a / patches / minecraft / net / minecraft / world / chunk / Chunk . java . patch 
 + + + b / patches / minecraft / net / minecraft / world / chunk / Chunk . java . patch 
 @ @ - 129 , 7 + 129 , 7 @ @ 
 else if ( p _ 177424 _ 2 _ = = Chunk . EnumCreateEntityType . QUEUED ) 
 { 
 - this . field _ 177447 _ w . add ( p _ 177424 _ 1 _ ) ; 
 - + this . field _ 177447 _ w . add ( p _ 177424 _ 1 _ . getImmutable ( ) ) ; 
 + + this . field _ 177447 _ w . add ( p _ 177424 _ 1 _ . func _ 185334 _ h ( ) ) ; 
 } 
 } 
 - else if ( tileentity . func _ 145837 _ r ( ) ) 
 diff - - git a / src / main / java / net / minecraftforge / common / util / BlockSnapshot . java b / src / main / java / net / minecraftforge / common / util / BlockSnapshot . java 
 index 1e29527 . . d1a2618 100644 
 - - - a / src / main / java / net / minecraftforge / common / util / BlockSnapshot . java 
 + + + b / src / main / java / net / minecraftforge / common / util / BlockSnapshot . java 
 @ @ - 58 , 7 + 58 , 7 @ @ public class BlockSnapshot implements Serializable 
 { 
 this . setWorld ( world ) ; 
 this . dimId = world . provider . getDimension ( ) ; 
 - this . pos = pos . getImmutable ( ) ; 
 + this . pos = pos . toImmutable ( ) ; 
 this . setReplacedBlock ( state ) ; 
 this . registryName = new ResourceLocation ( state . getBlock ( ) . getRegistryName ( ) ) ; 
 this . meta = state . getBlock ( ) . getMetaFromState ( state ) ; 
 @ @ - 82 , 7 + 82 , 7 @ @ public class BlockSnapshot implements Serializable 
 public BlockSnapshot ( int dimension , BlockPos pos , String modId , String blockName , int meta , int flag , NBTTagCompound nbt ) 
 { 
 this . dimId = dimension ; 
 - this . pos = pos . getImmutable ( ) ; 
 + this . pos = pos . toImmutable ( ) ; 
 this . setFlag ( flag ) ; 
 this . registryName = new ResourceLocation ( modId , blockName ) ; 
 this . meta = meta ;
