BLEU SCORE: 0.00791526856301914

TEST MSG: Fixed normal calculation for vanilla models , fixed the grass darkening and simular issues .
GENERATED MSG: Attempt to allocate a 8 - bit stencil buffer when creating Minecraft ' s display context . If that throws an error it will revert back to it ' s default values .

TEST DIFF (one line): diff - - git a / src / main / java / net / minecraftforge / client / ForgeHooksClient . java b / src / main / java / net / minecraftforge / client / ForgeHooksClient . java <nl> index 64b008d . . 885ec49 100644 <nl> - - - a / src / main / java / net / minecraftforge / client / ForgeHooksClient . java <nl> + + + b / src / main / java / net / minecraftforge / client / ForgeHooksClient . java <nl> @ @ - 11 , 6 + 11 , 7 @ @ import java . util . Map ; <nl> <nl> import javax . vecmath . Matrix4f ; <nl> import javax . vecmath . Vector3d ; <nl> + import javax . vecmath . Vector3f ; <nl> import javax . vecmath . Vector4f ; <nl> <nl> import net . minecraft . block . Block ; <nl> @ @ - 713 , 11 + 714 , 23 @ @ public class ForgeHooksClient <nl> tileItemMap . put ( Pair . of ( item , metadata ) , TileClass ) ; <nl> } <nl> <nl> + / * * <nl> + * internal , relies on fixed format of FaceBakery <nl> + * / <nl> public static void fillNormal ( int [ ] faceData , EnumFacing facing ) <nl> { <nl> - int x = ( ( byte ) ( facing . getFrontOffsetX ( ) * 127 ) ) & 0xFF ; <nl> - int y = ( ( byte ) ( facing . getFrontOffsetY ( ) * 127 ) ) & 0xFF ; <nl> - int z = ( ( byte ) ( facing . getFrontOffsetZ ( ) * 127 ) ) & 0xFF ; <nl> + Vector3f v1 = new Vector3f ( faceData [ 3 * 7 + 0 ] , faceData [ 3 * 7 + 1 ] , faceData [ 3 * 7 + 2 ] ) ; <nl> + Vector3f t = new Vector3f ( faceData [ 1 * 7 + 0 ] , faceData [ 1 * 7 + 1 ] , faceData [ 1 * 7 + 2 ] ) ; <nl> + Vector3f v2 = new Vector3f ( faceData [ 2 * 7 + 0 ] , faceData [ 2 * 7 + 1 ] , faceData [ 2 * 7 + 2 ] ) ; <nl> + v1 . sub ( t ) ; <nl> + t . set ( faceData [ 0 * 7 + 0 ] , faceData [ 0 * 7 + 1 ] , faceData [ 0 * 7 + 2 ] ) ; <nl> + v2 . sub ( t ) ; <nl> + v1 . cross ( v2 , v1 ) ; <nl> + v1 . normalize ( ) ; <nl> + <nl> + int x = ( ( byte ) ( v1 . x * 127 ) ) & 0xFF ; <nl> + int y = ( ( byte ) ( v1 . y * 127 ) ) & 0xFF ; <nl> + int z = ( ( byte ) ( v1 . z * 127 ) ) & 0xFF ; <nl> for ( int i = 0 ; i < 4 ; i + + ) <nl> { <nl> faceData [ i * 7 + 6 ] = x | ( y < < 0x08 ) | ( z < < 0x10 ) ;
NEAREST DIFF (one line): diff - - git a / client / net / minecraftforge / client / ForgeHooksClient . java b / client / net / minecraftforge / client / ForgeHooksClient . java <nl> index a5a0aaf . . c359b97 100644 <nl> - - - a / client / net / minecraftforge / client / ForgeHooksClient . java <nl> + + + b / client / net / minecraftforge / client / ForgeHooksClient . java <nl> @ @ - 4 , 8 + 4 , 11 @ @ import java . util . HashMap ; <nl> import java . util . Random ; <nl> import java . util . TreeSet ; <nl> <nl> + import org . lwjgl . LWJGLException ; <nl> + import org . lwjgl . opengl . Display ; <nl> import org . lwjgl . opengl . GL11 ; <nl> import org . lwjgl . opengl . GL12 ; <nl> + import org . lwjgl . opengl . PixelFormat ; <nl> <nl> import cpw . mods . fml . client . FMLClientHandler ; <nl> <nl> @ @ - 284 , 4 + 287 , 21 @ @ public class ForgeHooksClient <nl> ModelBiped modelbiped = itemStack . getItem ( ) . getArmorModel ( entityLiving , itemStack , slotID ) ; <nl> return modelbiped = = null ? _ default : modelbiped ; <nl> } <nl> + <nl> + static int stencilBits = 0 ; <nl> + public static void createDisplay ( ) throws LWJGLException <nl> + { <nl> + PixelFormat format = new PixelFormat ( ) . withDepthBits ( 24 ) ; <nl> + try <nl> + { <nl> + / / TODO : Figure out how to determine the max bits . <nl> + Display . create ( format . withStencilBits ( 8 ) ) ; <nl> + stencilBits = 8 ; <nl> + } <nl> + catch ( LWJGLException e ) <nl> + { <nl> + Display . create ( format ) ; <nl> + stencilBits = 0 ; <nl> + } <nl> + } <nl> } <nl> diff - - git a / client / net / minecraftforge / client / MinecraftForgeClient . java b / client / net / minecraftforge / client / MinecraftForgeClient . java <nl> index f8cba9c . . b26d5e3 100644 <nl> - - - a / client / net / minecraftforge / client / MinecraftForgeClient . java <nl> + + + b / client / net / minecraftforge / client / MinecraftForgeClient . java <nl> @ @ - 56 , 4 + 56 , 9 @ @ public class MinecraftForgeClient <nl> { <nl> return ForgeHooksClient . renderPass ; <nl> } <nl> + <nl> + public int getStencilBits ( ) <nl> + { <nl> + return ForgeHooksClient . stencilBits ; <nl> + } <nl> } <nl> diff - - git a / patches / minecraft / net / minecraft / client / Minecraft . java . patch b / patches / minecraft / net / minecraft / client / Minecraft . java . patch <nl> index af12291 . . e5d5988 100644 <nl> - - - a / patches / minecraft / net / minecraft / client / Minecraft . java . patch <nl> + + + b / patches / minecraft / net / minecraft / client / Minecraft . java . patch <nl> @ @ - 1 , 9 + 1 , 10 @ @ <nl> - - - . . / src _ base / minecraft / net / minecraft / client / Minecraft . java <nl> + + + . . / src _ work / minecraft / net / minecraft / client / Minecraft . java <nl> - @ @ - 123 , 6 + 123 , 13 @ @ <nl> + @ @ - 123 , 6 + 123 , 14 @ @ <nl> <nl> import com . google . common . collect . MapDifference ; <nl> <nl> + + import net . minecraftforge . client . ForgeHooksClient ; <nl> + import net . minecraftforge . client . GuiIngameForge ; <nl> + import net . minecraftforge . common . ForgeHooks ; <nl> + import net . minecraftforge . common . MinecraftForge ; <nl> @ @ - 14 , 7 + 15 , 16 @ @ <nl> @ SideOnly ( Side . CLIENT ) <nl> public abstract class Minecraft implements Runnable , IPlayerUsage <nl> { <nl> - @ @ - 450 , 7 + 457 , 7 @ @ <nl> + @ @ - 372 , 7 + 380 , 7 @ @ <nl> + <nl> + try <nl> + { <nl> + - Display . create ( ( new PixelFormat ( ) ) . withDepthBits ( 24 ) ) ; <nl> + + ForgeHooksClient . createDisplay ( ) ; <nl> + } <nl> + catch ( LWJGLException lwjglexception ) <nl> + { <nl> + @ @ - 450 , 7 + 458 , 7 @ @ <nl> } <nl> <nl> this . checkGLError ( " Post startup " ) ; <nl> @ @ - 23 , 7 + 33 , 7 @ @ <nl> <nl> if ( this . serverName ! = null ) <nl> { <nl> - @ @ - 1238 , 7 + 1245 , 7 @ @ <nl> + @ @ - 1238 , 7 + 1246 , 7 @ @ <nl> <nl> if ( this . thePlayer . canCurrentToolHarvestBlock ( j , k , l ) ) <nl> { <nl> @ @ - 32 , 7 + 42 , 7 @ @ <nl> this . thePlayer . swingItem ( ) ; <nl> } <nl> } <nl> - @ @ - 1304 , 7 + 1311 , 8 @ @ <nl> + @ @ - 1304 , 7 + 1312 , 8 @ @ <nl> { <nl> int j1 = itemstack ! = null ? itemstack . stackSize : 0 ; <nl> <nl> @ @ - 42 , 7 + 52 , 7 @ @ <nl> { <nl> flag = false ; <nl> this . thePlayer . swingItem ( ) ; <nl> - @ @ - 1330 , 7 + 1338 , 8 @ @ <nl> + @ @ - 1330 , 7 + 1339 , 8 @ @ <nl> { <nl> ItemStack itemstack1 = this . thePlayer . inventory . getCurrentItem ( ) ; <nl> <nl> @ @ - 52 , 7 + 62 , 7 @ @ <nl> { <nl> this . entityRenderer . itemRenderer . resetEquippedProgress2 ( ) ; <nl> } <nl> - @ @ - 2010 , 6 + 2019 , 11 @ @ <nl> + @ @ - 2010 , 6 + 2020 , 11 @ @ <nl> { <nl> this . statFileWriter . syncStats ( ) ; <nl> <nl> @ @ - 64 , 7 + 74 , 7 @ @ <nl> if ( par1WorldClient = = null ) <nl> { <nl> NetClientHandler netclienthandler = this . getNetHandler ( ) ; <nl> - @ @ - 2027 , 6 + 2041 , 18 @ @ <nl> + @ @ - 2027 , 6 + 2042 , 18 @ @ <nl> if ( this . theIntegratedServer ! = null ) <nl> { <nl> this . theIntegratedServer . initiateShutdown ( ) ; <nl> @ @ - 83 , 7 + 93 , 7 @ @ <nl> } <nl> <nl> this . theIntegratedServer = null ; <nl> - @ @ - 2354 , 103 + 2380 , 12 @ @ <nl> + @ @ - 2354 , 103 + 2381 , 12 @ @ <nl> if ( this . objectMouseOver ! = null ) <nl> { <nl> boolean flag = this . thePlayer . capabilities . isCreativeMode ; <nl> @ @ - 191 , 7 + 201 , 7 @ @ <nl> <nl> if ( flag ) <nl> { <nl> - @ @ - 2539 , 11 + 2474 , 18 @ @ <nl> + @ @ - 2539 , 11 + 2475 , 18 @ @ <nl> par1PlayerUsageSnooper . addData ( " gl _ max _ texture _ size " , Integer . valueOf ( getGLMaximumTextureSize ( ) ) ) ; <nl> } <nl> <nl> @ @ - 210 , 7 + 220 , 7 @ @ <nl> for ( int i = 16384 ; i > 0 ; i > > = 1 ) <nl> { <nl> GL11 . glTexImage2D ( GL11 . GL _ PROXY _ TEXTURE _ 2D , 0 , GL11 . GL _ RGBA , i , i , 0 , GL11 . GL _ RGBA , GL11 . GL _ UNSIGNED _ BYTE , ( ByteBuffer ) null ) ; <nl> - @ @ - 2551 , 6 + 2493 , 7 @ @ <nl> + @ @ - 2551 , 6 + 2494 , 7 @ @ <nl> <nl> if ( j ! = 0 ) <nl> {

TEST DIFF:
diff - - git a / src / main / java / net / minecraftforge / client / ForgeHooksClient . java b / src / main / java / net / minecraftforge / client / ForgeHooksClient . java 
 index 64b008d . . 885ec49 100644 
 - - - a / src / main / java / net / minecraftforge / client / ForgeHooksClient . java 
 + + + b / src / main / java / net / minecraftforge / client / ForgeHooksClient . java 
 @ @ - 11 , 6 + 11 , 7 @ @ import java . util . Map ; 
 
 import javax . vecmath . Matrix4f ; 
 import javax . vecmath . Vector3d ; 
 + import javax . vecmath . Vector3f ; 
 import javax . vecmath . Vector4f ; 
 
 import net . minecraft . block . Block ; 
 @ @ - 713 , 11 + 714 , 23 @ @ public class ForgeHooksClient 
 tileItemMap . put ( Pair . of ( item , metadata ) , TileClass ) ; 
 } 
 
 + / * * 
 + * internal , relies on fixed format of FaceBakery 
 + * / 
 public static void fillNormal ( int [ ] faceData , EnumFacing facing ) 
 { 
 - int x = ( ( byte ) ( facing . getFrontOffsetX ( ) * 127 ) ) & 0xFF ; 
 - int y = ( ( byte ) ( facing . getFrontOffsetY ( ) * 127 ) ) & 0xFF ; 
 - int z = ( ( byte ) ( facing . getFrontOffsetZ ( ) * 127 ) ) & 0xFF ; 
 + Vector3f v1 = new Vector3f ( faceData [ 3 * 7 + 0 ] , faceData [ 3 * 7 + 1 ] , faceData [ 3 * 7 + 2 ] ) ; 
 + Vector3f t = new Vector3f ( faceData [ 1 * 7 + 0 ] , faceData [ 1 * 7 + 1 ] , faceData [ 1 * 7 + 2 ] ) ; 
 + Vector3f v2 = new Vector3f ( faceData [ 2 * 7 + 0 ] , faceData [ 2 * 7 + 1 ] , faceData [ 2 * 7 + 2 ] ) ; 
 + v1 . sub ( t ) ; 
 + t . set ( faceData [ 0 * 7 + 0 ] , faceData [ 0 * 7 + 1 ] , faceData [ 0 * 7 + 2 ] ) ; 
 + v2 . sub ( t ) ; 
 + v1 . cross ( v2 , v1 ) ; 
 + v1 . normalize ( ) ; 
 + 
 + int x = ( ( byte ) ( v1 . x * 127 ) ) & 0xFF ; 
 + int y = ( ( byte ) ( v1 . y * 127 ) ) & 0xFF ; 
 + int z = ( ( byte ) ( v1 . z * 127 ) ) & 0xFF ; 
 for ( int i = 0 ; i < 4 ; i + + ) 
 { 
 faceData [ i * 7 + 6 ] = x | ( y < < 0x08 ) | ( z < < 0x10 ) ;

NEAREST DIFF:
diff - - git a / client / net / minecraftforge / client / ForgeHooksClient . java b / client / net / minecraftforge / client / ForgeHooksClient . java 
 index a5a0aaf . . c359b97 100644 
 - - - a / client / net / minecraftforge / client / ForgeHooksClient . java 
 + + + b / client / net / minecraftforge / client / ForgeHooksClient . java 
 @ @ - 4 , 8 + 4 , 11 @ @ import java . util . HashMap ; 
 import java . util . Random ; 
 import java . util . TreeSet ; 
 
 + import org . lwjgl . LWJGLException ; 
 + import org . lwjgl . opengl . Display ; 
 import org . lwjgl . opengl . GL11 ; 
 import org . lwjgl . opengl . GL12 ; 
 + import org . lwjgl . opengl . PixelFormat ; 
 
 import cpw . mods . fml . client . FMLClientHandler ; 
 
 @ @ - 284 , 4 + 287 , 21 @ @ public class ForgeHooksClient 
 ModelBiped modelbiped = itemStack . getItem ( ) . getArmorModel ( entityLiving , itemStack , slotID ) ; 
 return modelbiped = = null ? _ default : modelbiped ; 
 } 
 + 
 + static int stencilBits = 0 ; 
 + public static void createDisplay ( ) throws LWJGLException 
 + { 
 + PixelFormat format = new PixelFormat ( ) . withDepthBits ( 24 ) ; 
 + try 
 + { 
 + / / TODO : Figure out how to determine the max bits . 
 + Display . create ( format . withStencilBits ( 8 ) ) ; 
 + stencilBits = 8 ; 
 + } 
 + catch ( LWJGLException e ) 
 + { 
 + Display . create ( format ) ; 
 + stencilBits = 0 ; 
 + } 
 + } 
 } 
 diff - - git a / client / net / minecraftforge / client / MinecraftForgeClient . java b / client / net / minecraftforge / client / MinecraftForgeClient . java 
 index f8cba9c . . b26d5e3 100644 
 - - - a / client / net / minecraftforge / client / MinecraftForgeClient . java 
 + + + b / client / net / minecraftforge / client / MinecraftForgeClient . java 
 @ @ - 56 , 4 + 56 , 9 @ @ public class MinecraftForgeClient 
 { 
 return ForgeHooksClient . renderPass ; 
 } 
 + 
 + public int getStencilBits ( ) 
 + { 
 + return ForgeHooksClient . stencilBits ; 
 + } 
 } 
 diff - - git a / patches / minecraft / net / minecraft / client / Minecraft . java . patch b / patches / minecraft / net / minecraft / client / Minecraft . java . patch 
 index af12291 . . e5d5988 100644 
 - - - a / patches / minecraft / net / minecraft / client / Minecraft . java . patch 
 + + + b / patches / minecraft / net / minecraft / client / Minecraft . java . patch 
 @ @ - 1 , 9 + 1 , 10 @ @ 
 - - - . . / src _ base / minecraft / net / minecraft / client / Minecraft . java 
 + + + . . / src _ work / minecraft / net / minecraft / client / Minecraft . java 
 - @ @ - 123 , 6 + 123 , 13 @ @ 
 + @ @ - 123 , 6 + 123 , 14 @ @ 
 
 import com . google . common . collect . MapDifference ; 
 
 + + import net . minecraftforge . client . ForgeHooksClient ; 
 + import net . minecraftforge . client . GuiIngameForge ; 
 + import net . minecraftforge . common . ForgeHooks ; 
 + import net . minecraftforge . common . MinecraftForge ; 
 @ @ - 14 , 7 + 15 , 16 @ @ 
 @ SideOnly ( Side . CLIENT ) 
 public abstract class Minecraft implements Runnable , IPlayerUsage 
 { 
 - @ @ - 450 , 7 + 457 , 7 @ @ 
 + @ @ - 372 , 7 + 380 , 7 @ @ 
 + 
 + try 
 + { 
 + - Display . create ( ( new PixelFormat ( ) ) . withDepthBits ( 24 ) ) ; 
 + + ForgeHooksClient . createDisplay ( ) ; 
 + } 
 + catch ( LWJGLException lwjglexception ) 
 + { 
 + @ @ - 450 , 7 + 458 , 7 @ @ 
 } 
 
 this . checkGLError ( " Post startup " ) ; 
 @ @ - 23 , 7 + 33 , 7 @ @ 
 
 if ( this . serverName ! = null ) 
 { 
 - @ @ - 1238 , 7 + 1245 , 7 @ @ 
 + @ @ - 1238 , 7 + 1246 , 7 @ @ 
 
 if ( this . thePlayer . canCurrentToolHarvestBlock ( j , k , l ) ) 
 { 
 @ @ - 32 , 7 + 42 , 7 @ @ 
 this . thePlayer . swingItem ( ) ; 
 } 
 } 
 - @ @ - 1304 , 7 + 1311 , 8 @ @ 
 + @ @ - 1304 , 7 + 1312 , 8 @ @ 
 { 
 int j1 = itemstack ! = null ? itemstack . stackSize : 0 ; 
 
 @ @ - 42 , 7 + 52 , 7 @ @ 
 { 
 flag = false ; 
 this . thePlayer . swingItem ( ) ; 
 - @ @ - 1330 , 7 + 1338 , 8 @ @ 
 + @ @ - 1330 , 7 + 1339 , 8 @ @ 
 { 
 ItemStack itemstack1 = this . thePlayer . inventory . getCurrentItem ( ) ; 
 
 @ @ - 52 , 7 + 62 , 7 @ @ 
 { 
 this . entityRenderer . itemRenderer . resetEquippedProgress2 ( ) ; 
 } 
 - @ @ - 2010 , 6 + 2019 , 11 @ @ 
 + @ @ - 2010 , 6 + 2020 , 11 @ @ 
 { 
 this . statFileWriter . syncStats ( ) ; 
 
 @ @ - 64 , 7 + 74 , 7 @ @ 
 if ( par1WorldClient = = null ) 
 { 
 NetClientHandler netclienthandler = this . getNetHandler ( ) ; 
 - @ @ - 2027 , 6 + 2041 , 18 @ @ 
 + @ @ - 2027 , 6 + 2042 , 18 @ @ 
 if ( this . theIntegratedServer ! = null ) 
 { 
 this . theIntegratedServer . initiateShutdown ( ) ; 
 @ @ - 83 , 7 + 93 , 7 @ @ 
 } 
 
 this . theIntegratedServer = null ; 
 - @ @ - 2354 , 103 + 2380 , 12 @ @ 
 + @ @ - 2354 , 103 + 2381 , 12 @ @ 
 if ( this . objectMouseOver ! = null ) 
 { 
 boolean flag = this . thePlayer . capabilities . isCreativeMode ; 
 @ @ - 191 , 7 + 201 , 7 @ @ 
 
 if ( flag ) 
 { 
 - @ @ - 2539 , 11 + 2474 , 18 @ @ 
 + @ @ - 2539 , 11 + 2475 , 18 @ @ 
 par1PlayerUsageSnooper . addData ( " gl _ max _ texture _ size " , Integer . valueOf ( getGLMaximumTextureSize ( ) ) ) ; 
 } 
 
 @ @ - 210 , 7 + 220 , 7 @ @ 
 for ( int i = 16384 ; i > 0 ; i > > = 1 ) 
 { 
 GL11 . glTexImage2D ( GL11 . GL _ PROXY _ TEXTURE _ 2D , 0 , GL11 . GL _ RGBA , i , i , 0 , GL11 . GL _ RGBA , GL11 . GL _ UNSIGNED _ BYTE , ( ByteBuffer ) null ) ; 
 - @ @ - 2551 , 6 + 2493 , 7 @ @ 
 + @ @ - 2551 , 6 + 2494 , 7 @ @ 
 
 if ( j ! = 0 ) 
 {
