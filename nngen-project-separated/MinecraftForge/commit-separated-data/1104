BLEU SCORE: 0.0367352656298894

TEST MSG: Enhance output of common FML errors in crash reports and server GUI .
GENERATED MSG: Config GUIs in the modlist now work .

TEST DIFF (one line): diff - - git a / fml / src / main / java / net / minecraftforge / fml / client / CustomModLoadingErrorDisplayException . java b / fml / src / main / java / net / minecraftforge / fml / client / CustomModLoadingErrorDisplayException . java <nl> index 9d6c15a . . 607c3c5 100644 <nl> - - - a / fml / src / main / java / net / minecraftforge / fml / client / CustomModLoadingErrorDisplayException . java <nl> + + + b / fml / src / main / java / net / minecraftforge / fml / client / CustomModLoadingErrorDisplayException . java <nl> @ @ - 14 , 6 + 14 , 7 @ @ package net . minecraftforge . fml . client ; <nl> <nl> import net . minecraft . client . gui . FontRenderer ; <nl> import net . minecraft . client . gui . GuiErrorScreen ; <nl> + import net . minecraftforge . fml . common . EnhancedRuntimeException ; <nl> import net . minecraftforge . fml . common . IFMLHandledException ; <nl> import net . minecraftforge . fml . relauncher . Side ; <nl> import net . minecraftforge . fml . relauncher . SideOnly ; <nl> @ @ - 29 , 16 + 30 , 16 @ @ import net . minecraftforge . fml . relauncher . SideOnly ; <nl> * <nl> * / <nl> @ SideOnly ( Side . CLIENT ) <nl> - public abstract class CustomModLoadingErrorDisplayException extends RuntimeException implements IFMLHandledException <nl> + public abstract class CustomModLoadingErrorDisplayException extends EnhancedRuntimeException implements IFMLHandledException <nl> { <nl> public CustomModLoadingErrorDisplayException ( ) { <nl> } <nl> - <nl> + <nl> public CustomModLoadingErrorDisplayException ( String message , Throwable cause ) <nl> { <nl> super ( message , cause ) ; <nl> } <nl> - <nl> + <nl> private static final long serialVersionUID = 1L ; <nl> <nl> / * * <nl> @ @ - 62 , 4 + 63 , 6 @ @ public abstract class CustomModLoadingErrorDisplayException extends RuntimeExcep <nl> * @ param tickTime tick time <nl> * / <nl> public abstract void drawScreen ( GuiErrorScreen errorScreen , FontRenderer fontRenderer , int mouseRelX , int mouseRelY , float tickTime ) ; <nl> + <nl> + @ Override public void printStackTrace ( EnhancedRuntimeException . WrappedPrintStream s ) { } ; / / Do Nothing unless the modder wants to . <nl> } <nl> diff - - git a / fml / src / main / java / net / minecraftforge / fml / common / DuplicateModsFoundException . java b / fml / src / main / java / net / minecraftforge / fml / common / DuplicateModsFoundException . java <nl> index 92d28d1 . . e9e4f0a 100644 <nl> - - - a / fml / src / main / java / net / minecraftforge / fml / common / DuplicateModsFoundException . java <nl> + + + b / fml / src / main / java / net / minecraftforge / fml / common / DuplicateModsFoundException . java <nl> @ @ - 13 , 6 + 13 , 9 @ @ <nl> package net . minecraftforge . fml . common ; <nl> <nl> import java . io . File ; <nl> + import java . util . Map . Entry ; <nl> + <nl> + import net . minecraftforge . fml . common . EnhancedRuntimeException . WrappedPrintStream ; <nl> <nl> import com . google . common . collect . SetMultimap ; <nl> <nl> @ @ - 24 , 4 + 27 , 14 @ @ public class DuplicateModsFoundException extends LoaderException { <nl> 	 	 this . dupes = dupes ; <nl> 	 } <nl> <nl> + 	 @ Override <nl> + 	 protected void printStackTrace ( WrappedPrintStream stream ) <nl> + 	 { <nl> + 	 stream . println ( " Duplicate Mods : " ) ; <nl> + 	 for ( Entry < ModContainer , File > e : dupes . entries ( ) ) <nl> + 	 { <nl> + 	 stream . println ( String . format ( " \ t % s : % s " , e . getKey ( ) . getModId ( ) , e . getValue ( ) . getAbsolutePath ( ) ) ) ; <nl> + 	 } <nl> + 	 stream . println ( " " ) ; <nl> + 	 } <nl> } <nl> diff - - git a / fml / src / main / java / net / minecraftforge / fml / common / EnhancedRuntimeException . java b / fml / src / main / java / net / minecraftforge / fml / common / EnhancedRuntimeException . java <nl> new file mode 100644 <nl> index 0000000 . . 6910bf7 <nl> - - - / dev / null <nl> + + + b / fml / src / main / java / net / minecraftforge / fml / common / EnhancedRuntimeException . java <nl> @ @ - 0 , 0 + 1 , 92 @ @ <nl> + / * <nl> + * Forge Mod Loader <nl> + * Copyright ( c ) 2012 - 2016 Forge Dev LLC . <nl> + * All rights reserved . This program and the accompanying materials <nl> + * are made available under the terms of the GNU Lesser Public License v2 . 1 <nl> + * which accompanies this distribution , and is available at <nl> + * http : / / www . gnu . org / licenses / old - licenses / gpl - 2 . 0 . html <nl> + * / <nl> + package net . minecraftforge . fml . common ; <nl> + <nl> + import java . io . PrintStream ; <nl> + import java . io . PrintWriter ; <nl> + import java . io . StringWriter ; <nl> + <nl> + / * * <nl> + * RuntimeException that gives subclasses the simple opportunity to write extra data when printing the stack trace . <nl> + * Mainly a helper class as printsStackTrace has multiple signatures . <nl> + * / <nl> + public abstract class EnhancedRuntimeException extends RuntimeException <nl> + { <nl> + private static final long serialVersionUID = 1L ; <nl> + <nl> + public EnhancedRuntimeException ( ) { super ( ) ; } <nl> + public EnhancedRuntimeException ( String message ) { super ( message ) ; } <nl> + public EnhancedRuntimeException ( String message , Throwable cause ) { super ( message , cause ) ; } <nl> + public EnhancedRuntimeException ( Throwable cause ) { super ( cause ) ; } <nl> + protected EnhancedRuntimeException ( String message , Throwable cause , boolean enableSuppression , boolean writableStackTrace ) { <nl> + super ( message , cause , enableSuppression , writableStackTrace ) ; <nl> + } <nl> + <nl> + @ Override <nl> + public String getMessage ( ) <nl> + { <nl> + StackTraceElement [ ] stack = Thread . currentThread ( ) . getStackTrace ( ) ; <nl> + if ( stack . length > 2 & & stack [ 2 ] . getClassName ( ) . startsWith ( " org . apache . logging . log4j . " ) ) <nl> + { <nl> + / / This is a bit of a hack to force ourselves to be able to give a extended description when log4j prints this out . <nl> + / / Sadly this text is displayed AFTER the initial exception line , and before the stack trace . But as the intention <nl> + / / is to print this to the end user this is what we need to do . <nl> + final StringWriter buf = new StringWriter ( ) ; <nl> + <nl> + String msg = super . getMessage ( ) ; <nl> + if ( msg ! = null ) <nl> + buf . append ( msg ) ; <nl> + <nl> + buf . append ( ' \ n ' ) ; <nl> + this . printStackTrace ( new WrappedPrintStream ( ) <nl> + { <nl> + @ Override <nl> + void println ( String line ) <nl> + { <nl> + buf . append ( line ) . append ( ' \ n ' ) ; <nl> + } <nl> + } ) ; <nl> + return buf . toString ( ) ; <nl> + } <nl> + return super . getMessage ( ) ; <nl> + } <nl> + <nl> + @ Override <nl> + public void printStackTrace ( final PrintWriter s ) <nl> + { <nl> + printStackTrace ( new WrappedPrintStream ( ) <nl> + { <nl> + @ Override <nl> + void println ( String line ) <nl> + { <nl> + s . println ( line ) ; <nl> + } <nl> + } ) ; <nl> + super . printStackTrace ( s ) ; <nl> + } <nl> + public void printStackTrace ( final PrintStream s ) <nl> + { <nl> + printStackTrace ( new WrappedPrintStream ( ) <nl> + { <nl> + @ Override <nl> + void println ( String line ) <nl> + { <nl> + s . println ( line ) ; <nl> + } <nl> + } ) ; <nl> + super . printStackTrace ( s ) ; <nl> + } <nl> + <nl> + protected abstract void printStackTrace ( WrappedPrintStream stream ) ; <nl> + <nl> + public static abstract class WrappedPrintStream <nl> + { <nl> + abstract void println ( String line ) ; <nl> + } <nl> + } <nl> diff - - git a / fml / src / main / java / net / minecraftforge / fml / common / ILanguageAdapter . java b / fml / src / main / java / net / minecraftforge / fml / common / ILanguageAdapter . java <nl> index ab0b4cb . . 9b14eff 100644 <nl> - - - a / fml / src / main / java / net / minecraftforge / fml / common / ILanguageAdapter . java <nl> + + + b / fml / src / main / java / net / minecraftforge / fml / common / ILanguageAdapter . java <nl> @ @ - 97 , 7 + 97 , 7 @ @ public interface ILanguageAdapter { <nl> <nl> / / If we come here we could not find a setter for this proxy . <nl> FMLLog . severe ( " Failed loading proxy into % s . % s , could not find setter function . Did you declare the field with ' val ' instead of ' var ' ? " , proxyTarget . getSimpleName ( ) , target . getName ( ) ) ; <nl> - throw new LoaderException ( ) ; <nl> + throw new LoaderException ( String . format ( " Failed loading proxy into % s . % s , could not find setter function . Did you declare the field with ' val ' instead of ' var ' ? " , proxyTarget . getSimpleName ( ) , target . getName ( ) ) ) ; <nl> } <nl> <nl> @ Override <nl> @ @ - 142 , 7 + 142 , 7 @ @ public interface ILanguageAdapter { <nl> if ( ! target . getType ( ) . isAssignableFrom ( proxy . getClass ( ) ) ) <nl> { <nl> FMLLog . severe ( " Attempted to load a proxy type % s into % s . % s , but the types don ' t match " , targetType , proxyTarget . getSimpleName ( ) , target . getName ( ) ) ; <nl> - throw new LoaderException ( ) ; <nl> + throw new LoaderException ( String . format ( " Attempted to load a proxy type % s into % s . % s , but the types don ' t match " , targetType , proxyTarget . getSimpleName ( ) , target . getName ( ) ) ) ; <nl> } <nl> <nl> setProxy ( target , proxyTarget , proxy ) ; <nl> diff - - git a / fml / src / main / java / net / minecraftforge / fml / common / Loader . java b / fml / src / main / java / net / minecraftforge / fml / common / Loader . java <nl> index b415b11 . . b8dcd72 100644 <nl> - - - a / fml / src / main / java / net / minecraftforge / fml / common / Loader . java <nl> + + + b / fml / src / main / java / net / minecraftforge / fml / common / Loader . java <nl> @ @ - 183 , 7 + 183 , 7 @ @ public class Loader <nl> if ( ! mccversion . equals ( MC _ VERSION ) ) <nl> { <nl> FMLLog . severe ( " This version of FML is built for Minecraft % s , we have detected Minecraft % s in your minecraft jar file " , mccversion , MC _ VERSION ) ; <nl> - throw new LoaderException ( ) ; <nl> + throw new LoaderException ( String . format ( " This version of FML is built for Minecraft % s , we have detected Minecraft % s in your minecraft jar file " , mccversion , MC _ VERSION ) ) ; <nl> } <nl> <nl> minecraft = new MinecraftDummyContainer ( MC _ VERSION ) ; <nl> @ @ - 419 , 7 + 419 , 7 @ @ public class Loader <nl> if ( ! dirMade ) <nl> { <nl> FMLLog . severe ( " Unable to create the mod directory % s " , canonicalModsPath ) ; <nl> - throw new LoaderException ( ) ; <nl> + throw new LoaderException ( String . format ( " Unable to create the mod directory % s " , canonicalModsPath ) ) ; <nl> } <nl> FMLLog . info ( " Mod directory created successfully " ) ; <nl> } <nl> @ @ - 677 , 7 + 677 , 7 @ @ public class Loader <nl> if ( parseFailure ) <nl> { <nl> FMLLog . log ( Level . WARN , " Unable to parse dependency string % s " , dependencyString ) ; <nl> - throw new LoaderException ( ) ; <nl> + throw new LoaderException ( String . format ( " Unable to parse dependency string % s " , dependencyString ) ) ; <nl> } <nl> } <nl> <nl> diff - - git a / fml / src / main / java / net / minecraftforge / fml / common / LoaderException . java b / fml / src / main / java / net / minecraftforge / fml / common / LoaderException . java <nl> index edce3d7 . . ba212b4 100644 <nl> - - - a / fml / src / main / java / net / minecraftforge / fml / common / LoaderException . java <nl> + + + b / fml / src / main / java / net / minecraftforge / fml / common / LoaderException . java <nl> @ @ - 5 , 14 + 5 , 14 @ @ <nl> * are made available under the terms of the GNU Lesser Public License v2 . 1 <nl> * which accompanies this distribution , and is available at <nl> * http : / / www . gnu . org / licenses / old - licenses / gpl - 2 . 0 . html <nl> - * <nl> + * <nl> * Contributors : <nl> * cpw - implementation <nl> * / <nl> <nl> package net . minecraftforge . fml . common ; <nl> <nl> - public class LoaderException extends RuntimeException <nl> + public class LoaderException extends EnhancedRuntimeException <nl> { <nl> / * * <nl> * <nl> @ @ - 27 , 4 + 27 , 10 @ @ public class LoaderException extends RuntimeException <nl> public LoaderException ( ) <nl> { <nl> } <nl> + public LoaderException ( String message ) <nl> + { <nl> + super ( message ) ; <nl> + } <nl> + <nl> + @ Override protected void printStackTrace ( WrappedPrintStream stream ) { } <nl> } <nl> diff - - git a / fml / src / main / java / net / minecraftforge / fml / common / MissingModsException . java b / fml / src / main / java / net / minecraftforge / fml / common / MissingModsException . java <nl> index cafbbe1 . . 5d268e5 100644 <nl> - - - a / fml / src / main / java / net / minecraftforge / fml / common / MissingModsException . java <nl> + + + b / fml / src / main / java / net / minecraftforge / fml / common / MissingModsException . java <nl> @ @ - 14 , 9 + 14 , 10 @ @ package net . minecraftforge . fml . common ; <nl> <nl> import java . util . Set ; <nl> <nl> + import net . minecraftforge . fml . common . EnhancedRuntimeException . WrappedPrintStream ; <nl> import net . minecraftforge . fml . common . versioning . ArtifactVersion ; <nl> <nl> - public class MissingModsException extends RuntimeException <nl> + public class MissingModsException extends EnhancedRuntimeException <nl> { <nl> private static final long serialVersionUID = 1L ; <nl> public final Set < ArtifactVersion > missingMods ; <nl> @ @ - 26 , 4 + 27 , 15 @ @ public class MissingModsException extends RuntimeException <nl> super ( String . format ( " Mod % s ( % s ) requires % s " , id , name , missingMods ) ) ; <nl> this . missingMods = missingMods ; <nl> } <nl> + <nl> + @ Override <nl> + protected void printStackTrace ( WrappedPrintStream stream ) <nl> + { <nl> + stream . println ( " Missing Mods : " ) ; <nl> + for ( ArtifactVersion v : missingMods ) <nl> + { <nl> + stream . println ( String . format ( " \ t % s : % s " , v . getLabel ( ) , v . getRangeString ( ) ) ) ; <nl> + } <nl> + stream . println ( " " ) ; <nl> + } <nl> } <nl> diff - - git a / fml / src / main / java / net / minecraftforge / fml / common / ProxyInjector . java b / fml / src / main / java / net / minecraftforge / fml / common / ProxyInjector . java <nl> index 63947fd . . bfd116d 100644 <nl> - - - a / fml / src / main / java / net / minecraftforge / fml / common / ProxyInjector . java <nl> + + + b / fml / src / main / java / net / minecraftforge / fml / common / ProxyInjector . java <nl> @ @ - 46 , 7 + 46 , 7 @ @ public class ProxyInjector <nl> { <nl> / / Impossible ? <nl> FMLLog . severe ( " Attempted to load a proxy type into % s . % s but the field was not found " , targ . getClassName ( ) , targ . getObjectName ( ) ) ; <nl> - throw new LoaderException ( ) ; <nl> + throw new LoaderException ( String . format ( " Attempted to load a proxy type into % s . % s but the field was not found " , targ . getClassName ( ) , targ . getObjectName ( ) ) ) ; <nl> } <nl> target . setAccessible ( true ) ; <nl> <nl> @ @ - 62 , 12 + 62 , 12 @ @ public class ProxyInjector <nl> if ( languageAdapter . supportsStatics ( ) & & ( target . getModifiers ( ) & Modifier . STATIC ) = = 0 ) <nl> { <nl> FMLLog . severe ( " Attempted to load a proxy type % s into % s . % s , but the field is not static " , targetType , targ . getClassName ( ) , targ . getObjectName ( ) ) ; <nl> - throw new LoaderException ( ) ; <nl> + throw new LoaderException ( String . format ( " Attempted to load a proxy type % s into % s . % s , but the field is not static " , targetType , targ . getClassName ( ) , targ . getObjectName ( ) ) ) ; <nl> } <nl> if ( ! target . getType ( ) . isAssignableFrom ( proxy . getClass ( ) ) ) <nl> { <nl> FMLLog . severe ( " Attempted to load a proxy type % s into % s . % s , but the types don ' t match " , targetType , targ . getClassName ( ) , targ . getObjectName ( ) ) ; <nl> - throw new LoaderException ( ) ; <nl> + throw new LoaderException ( String . format ( " Attempted to load a proxy type % s into % s . % s , but the types don ' t match " , targetType , targ . getClassName ( ) , targ . getObjectName ( ) ) ) ; <nl> } <nl> languageAdapter . setProxy ( target , proxyTarget , proxy ) ; <nl> } <nl> diff - - git a / fml / src / main / java / net / minecraftforge / fml / common / network / internal / EntitySpawnHandler . java b / fml / src / main / java / net / minecraftforge / fml / common / network / internal / EntitySpawnHandler . java <nl> index bf5eb7b . . 88370df 100644 <nl> - - - a / fml / src / main / java / net / minecraftforge / fml / common / network / internal / EntitySpawnHandler . java <nl> + + + b / fml / src / main / java / net / minecraftforge / fml / common / network / internal / EntitySpawnHandler . java <nl> @ @ - 80 , 6 + 80 , 11 @ @ public class EntitySpawnHandler extends SimpleChannelInboundHandler < FMLMessage . E <nl> { <nl> ModContainer mc = Loader . instance ( ) . getIndexedModList ( ) . get ( spawnMsg . modId ) ; <nl> EntityRegistration er = EntityRegistry . instance ( ) . lookupModSpawn ( mc , spawnMsg . modEntityTypeId ) ; <nl> + if ( er = = null ) <nl> + { <nl> + throw new RuntimeException ( " Could not spawn mod entity ModID : " + spawnMsg . modId + " EntityID : " + spawnMsg . modEntityTypeId + <nl> + " at ( " + spawnMsg . scaledX + " , " + spawnMsg . scaledY + " , " + spawnMsg . scaledZ + " ) Please contact mod author or server admin . " ) ; <nl> + } <nl> WorldClient wc = FMLClientHandler . instance ( ) . getWorldClient ( ) ; <nl> Class < ? extends Entity > cls = er . getEntityClass ( ) ; <nl> try <nl> @ @ - 138 , 7 + 143 , 7 @ @ public class EntitySpawnHandler extends SimpleChannelInboundHandler < FMLMessage . E <nl> wc . addEntityToWorld ( spawnMsg . entityId , entity ) ; <nl> } catch ( Exception e ) <nl> { <nl> - FMLLog . log ( Level . ERROR , e , " A severe problem occurred during the spawning of an entity " ) ; <nl> + FMLLog . log ( Level . ERROR , e , " A severe problem occurred during the spawning of an entity at ( " + spawnMsg . scaledX + " , " + spawnMsg . scaledY + " , " + spawnMsg . scaledZ + " ) " ) ; <nl> throw Throwables . propagate ( e ) ; <nl> } <nl> } <nl> diff - - git a / fml / src / main / java / net / minecraftforge / fml / common / registry / IncompatibleSubstitutionException . java b / fml / src / main / java / net / minecraftforge / fml / common / registry / IncompatibleSubstitutionException . java <nl> index cf0a097 . . b40b341 100644 <nl> - - - a / fml / src / main / java / net / minecraftforge / fml / common / registry / IncompatibleSubstitutionException . java <nl> + + + b / fml / src / main / java / net / minecraftforge / fml / common / registry / IncompatibleSubstitutionException . java <nl> @ @ - 3 , 6 + 3 , 7 @ @ package net . minecraftforge . fml . common . registry ; <nl> public class IncompatibleSubstitutionException extends RuntimeException { <nl> public IncompatibleSubstitutionException ( String fromName , Object replacement , Object original ) <nl> { <nl> + super ( String . format ( " The substitute % s for % s ( type % s ) is type incompatible . " , replacement . getClass ( ) . getName ( ) , fromName , original . getClass ( ) . getName ( ) ) ) ; <nl> } <nl> <nl> private static final long serialVersionUID = 1L ;
NEAREST DIFF (one line): diff - - git a / fml / src / main / java / cpw / mods / fml / client / FMLClientHandler . java b / fml / src / main / java / cpw / mods / fml / client / FMLClientHandler . java <nl> index 92b5838 . . 40366bc 100644 <nl> - - - a / fml / src / main / java / cpw / mods / fml / client / FMLClientHandler . java <nl> + + + b / fml / src / main / java / cpw / mods / fml / client / FMLClientHandler . java <nl> @ @ - 36 , 7 + 36 , 10 @ @ import net . minecraft . network . INetHandler ; <nl> import net . minecraft . network . NetworkManager ; <nl> import net . minecraft . server . MinecraftServer ; <nl> import org . apache . logging . log4j . Level ; <nl> + import com . google . common . base . Strings ; <nl> import com . google . common . base . Throwables ; <nl> + import com . google . common . collect . BiMap ; <nl> + import com . google . common . collect . HashBiMap ; <nl> import com . google . common . collect . ImmutableList ; <nl> import com . google . common . collect . ImmutableMap ; <nl> import com . google . common . collect . Maps ; <nl> @ @ - 119 , 6 + 122 , 8 @ @ public class FMLClientHandler implements IFMLSidedHandler <nl> <nl> private Map < String , IResourcePack > resourcePackMap ; <nl> <nl> + private BiMap < ModContainer , IModGuiFactory > guiFactories ; <nl> + <nl> / * * <nl> * Called to start the whole game off <nl> * <nl> @ @ - 239 , 6 + 244 , 26 @ @ public class FMLClientHandler implements IFMLSidedHandler <nl> / / Reload resources <nl> / / client . func _ 110436 _ a ( ) ; <nl> RenderingRegistry . instance ( ) . loadEntityRenderers ( ( Map < Class < ? extends Entity > , Render > ) RenderManager . field _ 78727 _ a . field _ 78729 _ o ) ; <nl> + guiFactories = HashBiMap . create ( ) ; <nl> + for ( ModContainer mc : Loader . instance ( ) . getActiveModList ( ) ) <nl> + { <nl> + String className = mc . getGuiClassName ( ) ; <nl> + if ( Strings . isNullOrEmpty ( className ) ) <nl> + { <nl> + continue ; <nl> + } <nl> + try <nl> + { <nl> + Class < ? > clazz = Class . forName ( className , true , Loader . instance ( ) . getModClassLoader ( ) ) ; <nl> + Class < ? extends IModGuiFactory > guiClassFactory = clazz . asSubclass ( IModGuiFactory . class ) ; <nl> + IModGuiFactory guiFactory = guiClassFactory . newInstance ( ) ; <nl> + guiFactory . initialize ( client ) ; <nl> + guiFactories . put ( mc , guiFactory ) ; <nl> + } catch ( Exception e ) <nl> + { <nl> + FMLLog . log ( Level . ERROR , e , " A critical error occurred instantiating the gui factory for mod % s " , mc . getModId ( ) ) ; <nl> + } <nl> + } <nl> loading = false ; <nl> } <nl> <nl> @ @ - 514 , 4 + 539 , 9 @ @ public class FMLClientHandler implements IFMLSidedHandler <nl> { <nl> showGuiScreen ( new GuiIngameModOptions ( guiIngameMenu ) ) ; <nl> } <nl> + <nl> + public IModGuiFactory getGuiFactoryFor ( ModContainer selectedMod ) <nl> + { <nl> + return guiFactories . get ( selectedMod ) ; <nl> + } <nl> } <nl> diff - - git a / fml / src / main / java / cpw / mods / fml / client / FMLConfigGuiFactory . java b / fml / src / main / java / cpw / mods / fml / client / FMLConfigGuiFactory . java <nl> new file mode 100644 <nl> index 0000000 . . aff7969 <nl> - - - / dev / null <nl> + + + b / fml / src / main / java / cpw / mods / fml / client / FMLConfigGuiFactory . java <nl> @ @ - 0 , 0 + 1 , 70 @ @ <nl> + package cpw . mods . fml . client ; <nl> + <nl> + import java . util . Set ; <nl> + import net . minecraft . client . Minecraft ; <nl> + import net . minecraft . client . gui . GuiButton ; <nl> + import net . minecraft . client . gui . GuiScreen ; <nl> + import net . minecraft . client . resources . I18n ; <nl> + <nl> + public class FMLConfigGuiFactory implements IModGuiFactory { <nl> + public static class FMLConfigGuiScreen extends GuiScreen { <nl> + private GuiScreen parent ; <nl> + <nl> + public FMLConfigGuiScreen ( GuiScreen parent ) <nl> + { <nl> + this . parent = parent ; <nl> + } <nl> + <nl> + @ SuppressWarnings ( " unchecked " ) <nl> + @ Override <nl> + public void func _ 73866 _ w _ ( ) <nl> + { <nl> + this . field _ 146292 _ n . add ( new GuiButton ( 1 , this . field _ 146294 _ l / 2 - 75 , this . field _ 146295 _ m - 38 , I18n . func _ 135052 _ a ( " gui . done " ) ) ) ; <nl> + } <nl> + <nl> + @ Override <nl> + protected void func _ 146284 _ a ( GuiButton p _ 73875 _ 1 _ ) <nl> + { <nl> + if ( p _ 73875 _ 1 _ . field _ 146124 _ l & & p _ 73875 _ 1 _ . field _ 146127 _ k = = 1 ) <nl> + { <nl> + FMLClientHandler . instance ( ) . showGuiScreen ( parent ) ; <nl> + } <nl> + } <nl> + <nl> + @ Override <nl> + public void func _ 73863 _ a ( int p _ 73863 _ 1 _ , int p _ 73863 _ 2 _ , float p _ 73863 _ 3 _ ) <nl> + { <nl> + this . func _ 146276 _ q _ ( ) ; <nl> + this . func _ 73732 _ a ( this . field _ 146289 _ q , " Forge Mod Loader test config screen " , this . field _ 146294 _ l / 2 , 40 , 0xFFFFFF ) ; <nl> + super . func _ 73863 _ a ( p _ 73863 _ 1 _ , p _ 73863 _ 2 _ , p _ 73863 _ 3 _ ) ; <nl> + } <nl> + <nl> + } <nl> + private Minecraft minecraft ; <nl> + @ Override <nl> + public void initialize ( Minecraft minecraftInstance ) <nl> + { <nl> + this . minecraft = minecraftInstance ; <nl> + } <nl> + <nl> + @ Override <nl> + public Class < ? extends GuiScreen > mainConfigGuiClass ( ) <nl> + { <nl> + return FMLConfigGuiScreen . class ; <nl> + } <nl> + <nl> + @ Override <nl> + public Set < RuntimeOptionCategoryElement > runtimeGuiCategories ( ) <nl> + { <nl> + / / TODO Auto - generated method stub <nl> + return null ; <nl> + } <nl> + <nl> + @ Override <nl> + public RuntimeOptionGuiHandler getHandlerFor ( RuntimeOptionCategoryElement element ) <nl> + { <nl> + / / TODO Auto - generated method stub <nl> + return null ; <nl> + } <nl> + <nl> + } <nl> diff - - git a / fml / src / main / java / cpw / mods / fml / client / GuiModList . java b / fml / src / main / java / cpw / mods / fml / client / GuiModList . java <nl> index 9a7958f . . b83ca71 100644 <nl> - - - a / fml / src / main / java / cpw / mods / fml / client / GuiModList . java <nl> + + + b / fml / src / main / java / cpw / mods / fml / client / GuiModList . java <nl> @ @ - 33 , 10 + 33 , 12 @ @ import net . minecraft . client . resources . I18n ; <nl> import net . minecraft . client . resources . IResourcePack ; <nl> import net . minecraft . util . ResourceLocation ; <nl> <nl> + import org . apache . logging . log4j . Level ; <nl> import org . lwjgl . opengl . GL11 ; <nl> <nl> import com . google . common . base . Strings ; <nl> <nl> + import cpw . mods . fml . common . FMLLog ; <nl> import cpw . mods . fml . common . Loader ; <nl> import cpw . mods . fml . common . ModContainer ; <nl> import cpw . mods . fml . common . ModContainer . Disableable ; <nl> @ @ - 93 , 8 + 95 , 8 @ @ public class GuiModList extends GuiScreen <nl> } <nl> listWidth = Math . min ( listWidth , 150 ) ; <nl> this . field _ 146292 _ n . add ( new GuiButton ( 6 , this . field _ 146294 _ l / 2 - 75 , this . field _ 146295 _ m - 38 , I18n . func _ 135052 _ a ( " gui . done " ) ) ) ; <nl> - configModButton = new GuiButton ( 7 , 10 , this . field _ 146295 _ m - 60 , this . listWidth , 20 , " Config " ) ; <nl> - disableModButton = new GuiButton ( 8 , 10 , this . field _ 146295 _ m - 38 , this . listWidth , 20 , " Disable " ) ; <nl> + configModButton = new GuiButton ( 20 , 10 , this . field _ 146295 _ m - 60 , this . listWidth , 20 , " Config " ) ; <nl> + disableModButton = new GuiButton ( 21 , 10 , this . field _ 146295 _ m - 38 , this . listWidth , 20 , " Disable " ) ; <nl> this . field _ 146292 _ n . add ( configModButton ) ; <nl> this . field _ 146292 _ n . add ( disableModButton ) ; <nl> this . modList = new GuiSlotModList ( this , mods , listWidth ) ; <nl> @ @ - 110 , 6 + 112 , 18 @ @ public class GuiModList extends GuiScreen <nl> case 6 : <nl> this . field _ 146297 _ k . func _ 147108 _ a ( this . mainMenu ) ; <nl> return ; <nl> + case 20 : <nl> + try <nl> + { <nl> + IModGuiFactory guiFactory = FMLClientHandler . instance ( ) . getGuiFactoryFor ( selectedMod ) ; <nl> + GuiScreen newScreen = guiFactory . mainConfigGuiClass ( ) . getConstructor ( GuiScreen . class ) . newInstance ( this ) ; <nl> + this . field _ 146297 _ k . func _ 147108 _ a ( newScreen ) ; <nl> + } <nl> + catch ( Exception e ) <nl> + { <nl> + FMLLog . log ( Level . ERROR , e , " There was a critical issue trying to build the config GUI for % s " , selectedMod . getModId ( ) ) ; <nl> + } <nl> + return ; <nl> } <nl> } <nl> super . func _ 146284 _ a ( button ) ; <nl> @ @ - 222 , 6 + 236 , 17 @ @ public class GuiModList extends GuiScreen <nl> disableModButton . field _ 146125 _ m = true ; <nl> disableModButton . field _ 146124 _ l = false ; <nl> } <nl> + IModGuiFactory guiFactory = FMLClientHandler . instance ( ) . getGuiFactoryFor ( selectedMod ) ; <nl> + if ( guiFactory = = null | | guiFactory . mainConfigGuiClass ( ) = = null ) <nl> + { <nl> + configModButton . field _ 146125 _ m = true ; <nl> + configModButton . field _ 146124 _ l = false ; <nl> + } <nl> + else <nl> + { <nl> + configModButton . field _ 146125 _ m = true ; <nl> + configModButton . field _ 146124 _ l = true ; <nl> + } <nl> } else { <nl> offset = ( this . listWidth + this . field _ 146294 _ l ) / 2 ; <nl> this . func _ 73732 _ a ( this . field _ 146289 _ q , selectedMod . getName ( ) , offset , 35 , 0xFFFFFF ) ; <nl> diff - - git a / fml / src / main / java / cpw / mods / fml / client / IModGuiFactory . java b / fml / src / main / java / cpw / mods / fml / client / IModGuiFactory . java <nl> new file mode 100644 <nl> index 0000000 . . 0e7fa18 <nl> - - - / dev / null <nl> + + + b / fml / src / main / java / cpw / mods / fml / client / IModGuiFactory . java <nl> @ @ - 0 , 0 + 1 , 127 @ @ <nl> + package cpw . mods . fml . client ; <nl> + <nl> + import java . util . Set ; <nl> + import net . minecraft . client . Minecraft ; <nl> + import net . minecraft . client . gui . GuiScreen ; <nl> + <nl> + public interface IModGuiFactory { <nl> + / * * <nl> + * Called when instantiated to initialize with the active minecraft instance . <nl> + * <nl> + * @ param minecraftInstance the instance <nl> + * / <nl> + public void initialize ( Minecraft minecraftInstance ) ; <nl> + / * * <nl> + * Return the name of a class extending { @ link GuiScreen } . This class will <nl> + * be instantiated when the " config " button is pressed in the mod list . It will <nl> + * have a single argument constructor - the " parent " screen , the same as all <nl> + * Minecraft GUIs . The expected behaviour is that this screen will replace the <nl> + * " mod list " screen completely , and will return to the mod list screen through <nl> + * the parent link , once the appropriate action is taken from the config screen . <nl> + * <nl> + * A null from this method indicates that the mod does not provide a " config " <nl> + * button GUI screen , and the config button will be hidden / disabled . <nl> + * <nl> + * This config GUI is anticipated to provide configuration to the mod in a friendly <nl> + * visual way . It should not be abused to set internals such as IDs ( they ' re gonna <nl> + * keep disappearing anyway ) , but rather , interesting behaviours . This config GUI <nl> + * is never run when a server game is running , and should be used to configure <nl> + * desired behaviours that affect server state . Costs , mod game modes , stuff like that <nl> + * can be changed here . <nl> + * <nl> + * @ return A class that will be instantiated on clicks on the config button <nl> + * or null if no GUI is desired . <nl> + * / <nl> + public Class < ? extends GuiScreen > mainConfigGuiClass ( ) ; <nl> + <nl> + <nl> + / * * <nl> + * Return a list of the " runtime " categories this mod wishes to populate with <nl> + * GUI elements . <nl> + * <nl> + * Runtime categories are created on demand and organized in a ' lite ' tree format . <nl> + * The parent represents the parent node in the tree . There is one special parent <nl> + * ' Help ' that will always list first , and is generally meant to provide Help type <nl> + * content for mods . The remaining parents will sort alphabetically , though <nl> + * this may change if there is a lot of alphabetic abuse . " AAA " is probably never a valid <nl> + * category parent . <nl> + * <nl> + * Runtime configuration itself falls into two flavours : in - game help , which is <nl> + * generally non interactive except for the text it wishes to show , and client - only <nl> + * affecting behaviours . This would include things like toggling minimaps , or cheat modes <nl> + * or anything NOT affecting the behaviour of the server . Please don ' t abuse this to <nl> + * change the state of the server in any way , this is intended to behave identically <nl> + * when the server is local or remote . <nl> + * <nl> + * @ return the set of options this mod wishes to have available , or empty if none <nl> + * / <nl> + public Set < RuntimeOptionCategoryElement > runtimeGuiCategories ( ) ; <nl> + <nl> + / * * <nl> + * Return an instance of a { @ link RuntimeOptionGuiHandler } that handles painting the <nl> + * right hand side option screen for the specified { @ link RuntimeOptionCategoryElement } . <nl> + * <nl> + * @ param element The element we wish to paint for <nl> + * @ return The Handler for painting it <nl> + * / <nl> + public RuntimeOptionGuiHandler getHandlerFor ( RuntimeOptionCategoryElement element ) ; <nl> + <nl> + / * * <nl> + * Represents an option category and entry in the runtime gui options list . <nl> + * <nl> + * @ author cpw <nl> + * <nl> + * / <nl> + public static class RuntimeOptionCategoryElement { <nl> + public final String parent ; <nl> + public final String child ; <nl> + <nl> + public RuntimeOptionCategoryElement ( String parent , String child ) <nl> + { <nl> + this . parent = parent ; <nl> + this . child = child ; <nl> + } <nl> + } <nl> + <nl> + / * * <nl> + * Responsible for painting the mod specific section of runtime options GUI for a particular category <nl> + * <nl> + * @ author cpw <nl> + * <nl> + * / <nl> + public interface RuntimeOptionGuiHandler { <nl> + / * * <nl> + * Called to add widgets to the screen , such as buttons . <nl> + * GUI identifier numbers should start at 100 and increase . <nl> + * The callback will be through { @ link # actionCallback ( int ) } <nl> + * <nl> + * @ param x X <nl> + * @ param y Y <nl> + * @ param w width <nl> + * @ param h height <nl> + * / <nl> + public void addWidgets ( int x , int y , int w , int h ) ; <nl> + <nl> + / * * <nl> + * Called to paint the rectangle specified . <nl> + * @ param x X <nl> + * @ param y Y <nl> + * @ param w width <nl> + * @ param h height <nl> + * / <nl> + public void paint ( int x , int y , int w , int h ) ; <nl> + <nl> + / * * <nl> + * Called if a widget with id > = 100 is fired . <nl> + * <nl> + * @ param actionId the actionId of the firing widget <nl> + * / <nl> + public void actionCallback ( int actionId ) ; <nl> + <nl> + / * * <nl> + * Called when this handler is about to go away ( probably replaced by another one , or closing the <nl> + * option screen ) <nl> + * / <nl> + public void close ( ) ; <nl> + } <nl> + } <nl> diff - - git a / fml / src / main / java / cpw / mods / fml / common / DummyModContainer . java b / fml / src / main / java / cpw / mods / fml / common / DummyModContainer . java <nl> index f31a7a1 . . e603187 100644 <nl> - - - a / fml / src / main / java / cpw / mods / fml / common / DummyModContainer . java <nl> + + + b / fml / src / main / java / cpw / mods / fml / common / DummyModContainer . java <nl> @ @ - 186 , 4 + 186 , 10 @ @ public class DummyModContainer implements ModContainer <nl> { <nl> return Disableable . NEVER ; <nl> } <nl> + <nl> + @ Override <nl> + public String getGuiClassName ( ) <nl> + { <nl> + return null ; <nl> + } <nl> } <nl> diff - - git a / fml / src / main / java / cpw / mods / fml / common / FMLContainer . java b / fml / src / main / java / cpw / mods / fml / common / FMLContainer . java <nl> index a55cbe8 . . f406442 100644 <nl> - - - a / fml / src / main / java / cpw / mods / fml / common / FMLContainer . java <nl> + + + b / fml / src / main / java / cpw / mods / fml / common / FMLContainer . java <nl> @ @ - 215 , 4 + 215 , 10 @ @ public class FMLContainer extends DummyModContainer implements WorldAccessContai <nl> { <nl> return getSource ( ) . isDirectory ( ) ? FMLFolderResourcePack . class : FMLFileResourcePack . class ; <nl> } <nl> + <nl> + @ Override <nl> + public String getGuiClassName ( ) <nl> + { <nl> + return " cpw . mods . fml . client . FMLConfigGuiFactory " ; <nl> + } <nl> } <nl> diff - - git a / fml / src / main / java / cpw / mods / fml / common / FMLModContainer . java b / fml / src / main / java / cpw / mods / fml / common / FMLModContainer . java <nl> index 3729f43 . . 50b24ae 100644 <nl> - - - a / fml / src / main / java / cpw / mods / fml / common / FMLModContainer . java <nl> + + + b / fml / src / main / java / cpw / mods / fml / common / FMLModContainer . java <nl> @ @ - 616 , 4 + 616 , 10 @ @ public class FMLModContainer implements ModContainer <nl> { <nl> return disableability ; <nl> } <nl> + <nl> + @ Override <nl> + public String getGuiClassName ( ) <nl> + { <nl> + return ( String ) descriptor . get ( " guiFactory " ) ; <nl> + } <nl> } <nl> diff - - git a / fml / src / main / java / cpw / mods / fml / common / InjectedModContainer . java b / fml / src / main / java / cpw / mods / fml / common / InjectedModContainer . java <nl> index b02e254 . . f4acf41 100644 <nl> - - - a / fml / src / main / java / cpw / mods / fml / common / InjectedModContainer . java <nl> + + + b / fml / src / main / java / cpw / mods / fml / common / InjectedModContainer . java <nl> @ @ - 174 , 4 + 174 , 10 @ @ public class InjectedModContainer implements ModContainer <nl> { <nl> return wrappedContainer . canBeDisabled ( ) ; <nl> } <nl> + <nl> + @ Override <nl> + public String getGuiClassName ( ) <nl> + { <nl> + return wrappedContainer . getGuiClassName ( ) ; <nl> + } <nl> } <nl> diff - - git a / fml / src / main / java / cpw / mods / fml / common / Mod . java b / fml / src / main / java / cpw / mods / fml / common / Mod . java <nl> index 9d9ebf1 . . cab2511 100644 <nl> - - - a / fml / src / main / java / cpw / mods / fml / common / Mod . java <nl> + + + b / fml / src / main / java / cpw / mods / fml / common / Mod . java <nl> @ @ - 17 , 6 + 17 , 7 @ @ import java . lang . annotation . Retention ; <nl> import java . lang . annotation . RetentionPolicy ; <nl> import java . lang . annotation . Target ; <nl> <nl> + import cpw . mods . fml . client . IModGuiFactory ; <nl> import cpw . mods . fml . common . event . FMLEvent ; <nl> import cpw . mods . fml . common . event . FMLFingerprintViolationEvent ; <nl> import cpw . mods . fml . common . event . FMLInitializationEvent ; <nl> @ @ - 149 , 10 + 150 , 20 @ @ public @ interface Mod <nl> * ( minimap mods , graphical tweak mods ) then you can set true here and receive the FMLDeactivationEvent to perform deactivation <nl> * tasks . <nl> * This does not affect administrative disabling through the system property fml . modStates or the config file fmlModState . properties . <nl> + * The mod will only be deactivated outside of a running game world - FML will never allow mod deactivation whilst a game server <nl> + * is running . <nl> * <nl> - * @ return if I can be deactivated whilst the game is running . <nl> + * @ return if this mod can be deactivated whilst the game is open . <nl> * / <nl> boolean canBeDeactivated ( ) default false ; <nl> + <nl> + / * * <nl> + * An optional GUI factory for this mod . This is the name of a class implementing { @ link IModGuiFactory } that will be instantiated <nl> + * on the client side , and will have certain configuration / options guis requested from it . <nl> + * <nl> + * @ return The name of a class implementing { @ link IModGuiFactory } <nl> + * / <nl> + String guiFactory ( ) default " " ; <nl> / * * <nl> * A list of custom properties for this mod . Completely up to the mod author if / when they <nl> * want to put anything in here . <nl> diff - - git a / fml / src / main / java / cpw / mods / fml / common / ModContainer . java b / fml / src / main / java / cpw / mods / fml / common / ModContainer . java <nl> index 47cc223 . . 1641788 100644 <nl> - - - a / fml / src / main / java / cpw / mods / fml / common / ModContainer . java <nl> + + + b / fml / src / main / java / cpw / mods / fml / common / ModContainer . java <nl> @ @ - 143 , 4 + 143 , 6 @ @ public interface ModContainer <nl> Map < String , String > getSharedModDescriptor ( ) ; <nl> <nl> Disableable canBeDisabled ( ) ; <nl> + <nl> + String getGuiClassName ( ) ; <nl> }

TEST DIFF:
diff - - git a / fml / src / main / java / net / minecraftforge / fml / client / CustomModLoadingErrorDisplayException . java b / fml / src / main / java / net / minecraftforge / fml / client / CustomModLoadingErrorDisplayException . java 
 index 9d6c15a . . 607c3c5 100644 
 - - - a / fml / src / main / java / net / minecraftforge / fml / client / CustomModLoadingErrorDisplayException . java 
 + + + b / fml / src / main / java / net / minecraftforge / fml / client / CustomModLoadingErrorDisplayException . java 
 @ @ - 14 , 6 + 14 , 7 @ @ package net . minecraftforge . fml . client ; 
 
 import net . minecraft . client . gui . FontRenderer ; 
 import net . minecraft . client . gui . GuiErrorScreen ; 
 + import net . minecraftforge . fml . common . EnhancedRuntimeException ; 
 import net . minecraftforge . fml . common . IFMLHandledException ; 
 import net . minecraftforge . fml . relauncher . Side ; 
 import net . minecraftforge . fml . relauncher . SideOnly ; 
 @ @ - 29 , 16 + 30 , 16 @ @ import net . minecraftforge . fml . relauncher . SideOnly ; 
 * 
 * / 
 @ SideOnly ( Side . CLIENT ) 
 - public abstract class CustomModLoadingErrorDisplayException extends RuntimeException implements IFMLHandledException 
 + public abstract class CustomModLoadingErrorDisplayException extends EnhancedRuntimeException implements IFMLHandledException 
 { 
 public CustomModLoadingErrorDisplayException ( ) { 
 } 
 - 
 + 
 public CustomModLoadingErrorDisplayException ( String message , Throwable cause ) 
 { 
 super ( message , cause ) ; 
 } 
 - 
 + 
 private static final long serialVersionUID = 1L ; 
 
 / * * 
 @ @ - 62 , 4 + 63 , 6 @ @ public abstract class CustomModLoadingErrorDisplayException extends RuntimeExcep 
 * @ param tickTime tick time 
 * / 
 public abstract void drawScreen ( GuiErrorScreen errorScreen , FontRenderer fontRenderer , int mouseRelX , int mouseRelY , float tickTime ) ; 
 + 
 + @ Override public void printStackTrace ( EnhancedRuntimeException . WrappedPrintStream s ) { } ; / / Do Nothing unless the modder wants to . 
 } 
 diff - - git a / fml / src / main / java / net / minecraftforge / fml / common / DuplicateModsFoundException . java b / fml / src / main / java / net / minecraftforge / fml / common / DuplicateModsFoundException . java 
 index 92d28d1 . . e9e4f0a 100644 
 - - - a / fml / src / main / java / net / minecraftforge / fml / common / DuplicateModsFoundException . java 
 + + + b / fml / src / main / java / net / minecraftforge / fml / common / DuplicateModsFoundException . java 
 @ @ - 13 , 6 + 13 , 9 @ @ 
 package net . minecraftforge . fml . common ; 
 
 import java . io . File ; 
 + import java . util . Map . Entry ; 
 + 
 + import net . minecraftforge . fml . common . EnhancedRuntimeException . WrappedPrintStream ; 
 
 import com . google . common . collect . SetMultimap ; 
 
 @ @ - 24 , 4 + 27 , 14 @ @ public class DuplicateModsFoundException extends LoaderException { 
 	 	 this . dupes = dupes ; 
 	 } 
 
 + 	 @ Override 
 + 	 protected void printStackTrace ( WrappedPrintStream stream ) 
 + 	 { 
 + 	 stream . println ( " Duplicate Mods : " ) ; 
 + 	 for ( Entry < ModContainer , File > e : dupes . entries ( ) ) 
 + 	 { 
 + 	 stream . println ( String . format ( " \ t % s : % s " , e . getKey ( ) . getModId ( ) , e . getValue ( ) . getAbsolutePath ( ) ) ) ; 
 + 	 } 
 + 	 stream . println ( " " ) ; 
 + 	 } 
 } 
 diff - - git a / fml / src / main / java / net / minecraftforge / fml / common / EnhancedRuntimeException . java b / fml / src / main / java / net / minecraftforge / fml / common / EnhancedRuntimeException . java 
 new file mode 100644 
 index 0000000 . . 6910bf7 
 - - - / dev / null 
 + + + b / fml / src / main / java / net / minecraftforge / fml / common / EnhancedRuntimeException . java 
 @ @ - 0 , 0 + 1 , 92 @ @ 
 + / * 
 + * Forge Mod Loader 
 + * Copyright ( c ) 2012 - 2016 Forge Dev LLC . 
 + * All rights reserved . This program and the accompanying materials 
 + * are made available under the terms of the GNU Lesser Public License v2 . 1 
 + * which accompanies this distribution , and is available at 
 + * http : / / www . gnu . org / licenses / old - licenses / gpl - 2 . 0 . html 
 + * / 
 + package net . minecraftforge . fml . common ; 
 + 
 + import java . io . PrintStream ; 
 + import java . io . PrintWriter ; 
 + import java . io . StringWriter ; 
 + 
 + / * * 
 + * RuntimeException that gives subclasses the simple opportunity to write extra data when printing the stack trace . 
 + * Mainly a helper class as printsStackTrace has multiple signatures . 
 + * / 
 + public abstract class EnhancedRuntimeException extends RuntimeException 
 + { 
 + private static final long serialVersionUID = 1L ; 
 + 
 + public EnhancedRuntimeException ( ) { super ( ) ; } 
 + public EnhancedRuntimeException ( String message ) { super ( message ) ; } 
 + public EnhancedRuntimeException ( String message , Throwable cause ) { super ( message , cause ) ; } 
 + public EnhancedRuntimeException ( Throwable cause ) { super ( cause ) ; } 
 + protected EnhancedRuntimeException ( String message , Throwable cause , boolean enableSuppression , boolean writableStackTrace ) { 
 + super ( message , cause , enableSuppression , writableStackTrace ) ; 
 + } 
 + 
 + @ Override 
 + public String getMessage ( ) 
 + { 
 + StackTraceElement [ ] stack = Thread . currentThread ( ) . getStackTrace ( ) ; 
 + if ( stack . length > 2 & & stack [ 2 ] . getClassName ( ) . startsWith ( " org . apache . logging . log4j . " ) ) 
 + { 
 + / / This is a bit of a hack to force ourselves to be able to give a extended description when log4j prints this out . 
 + / / Sadly this text is displayed AFTER the initial exception line , and before the stack trace . But as the intention 
 + / / is to print this to the end user this is what we need to do . 
 + final StringWriter buf = new StringWriter ( ) ; 
 + 
 + String msg = super . getMessage ( ) ; 
 + if ( msg ! = null ) 
 + buf . append ( msg ) ; 
 + 
 + buf . append ( ' \ n ' ) ; 
 + this . printStackTrace ( new WrappedPrintStream ( ) 
 + { 
 + @ Override 
 + void println ( String line ) 
 + { 
 + buf . append ( line ) . append ( ' \ n ' ) ; 
 + } 
 + } ) ; 
 + return buf . toString ( ) ; 
 + } 
 + return super . getMessage ( ) ; 
 + } 
 + 
 + @ Override 
 + public void printStackTrace ( final PrintWriter s ) 
 + { 
 + printStackTrace ( new WrappedPrintStream ( ) 
 + { 
 + @ Override 
 + void println ( String line ) 
 + { 
 + s . println ( line ) ; 
 + } 
 + } ) ; 
 + super . printStackTrace ( s ) ; 
 + } 
 + public void printStackTrace ( final PrintStream s ) 
 + { 
 + printStackTrace ( new WrappedPrintStream ( ) 
 + { 
 + @ Override 
 + void println ( String line ) 
 + { 
 + s . println ( line ) ; 
 + } 
 + } ) ; 
 + super . printStackTrace ( s ) ; 
 + } 
 + 
 + protected abstract void printStackTrace ( WrappedPrintStream stream ) ; 
 + 
 + public static abstract class WrappedPrintStream 
 + { 
 + abstract void println ( String line ) ; 
 + } 
 + } 
 diff - - git a / fml / src / main / java / net / minecraftforge / fml / common / ILanguageAdapter . java b / fml / src / main / java / net / minecraftforge / fml / common / ILanguageAdapter . java 
 index ab0b4cb . . 9b14eff 100644 
 - - - a / fml / src / main / java / net / minecraftforge / fml / common / ILanguageAdapter . java 
 + + + b / fml / src / main / java / net / minecraftforge / fml / common / ILanguageAdapter . java 
 @ @ - 97 , 7 + 97 , 7 @ @ public interface ILanguageAdapter { 
 
 / / If we come here we could not find a setter for this proxy . 
 FMLLog . severe ( " Failed loading proxy into % s . % s , could not find setter function . Did you declare the field with ' val ' instead of ' var ' ? " , proxyTarget . getSimpleName ( ) , target . getName ( ) ) ; 
 - throw new LoaderException ( ) ; 
 + throw new LoaderException ( String . format ( " Failed loading proxy into % s . % s , could not find setter function . Did you declare the field with ' val ' instead of ' var ' ? " , proxyTarget . getSimpleName ( ) , target . getName ( ) ) ) ; 
 } 
 
 @ Override 
 @ @ - 142 , 7 + 142 , 7 @ @ public interface ILanguageAdapter { 
 if ( ! target . getType ( ) . isAssignableFrom ( proxy . getClass ( ) ) ) 
 { 
 FMLLog . severe ( " Attempted to load a proxy type % s into % s . % s , but the types don ' t match " , targetType , proxyTarget . getSimpleName ( ) , target . getName ( ) ) ; 
 - throw new LoaderException ( ) ; 
 + throw new LoaderException ( String . format ( " Attempted to load a proxy type % s into % s . % s , but the types don ' t match " , targetType , proxyTarget . getSimpleName ( ) , target . getName ( ) ) ) ; 
 } 
 
 setProxy ( target , proxyTarget , proxy ) ; 
 diff - - git a / fml / src / main / java / net / minecraftforge / fml / common / Loader . java b / fml / src / main / java / net / minecraftforge / fml / common / Loader . java 
 index b415b11 . . b8dcd72 100644 
 - - - a / fml / src / main / java / net / minecraftforge / fml / common / Loader . java 
 + + + b / fml / src / main / java / net / minecraftforge / fml / common / Loader . java 
 @ @ - 183 , 7 + 183 , 7 @ @ public class Loader 
 if ( ! mccversion . equals ( MC _ VERSION ) ) 
 { 
 FMLLog . severe ( " This version of FML is built for Minecraft % s , we have detected Minecraft % s in your minecraft jar file " , mccversion , MC _ VERSION ) ; 
 - throw new LoaderException ( ) ; 
 + throw new LoaderException ( String . format ( " This version of FML is built for Minecraft % s , we have detected Minecraft % s in your minecraft jar file " , mccversion , MC _ VERSION ) ) ; 
 } 
 
 minecraft = new MinecraftDummyContainer ( MC _ VERSION ) ; 
 @ @ - 419 , 7 + 419 , 7 @ @ public class Loader 
 if ( ! dirMade ) 
 { 
 FMLLog . severe ( " Unable to create the mod directory % s " , canonicalModsPath ) ; 
 - throw new LoaderException ( ) ; 
 + throw new LoaderException ( String . format ( " Unable to create the mod directory % s " , canonicalModsPath ) ) ; 
 } 
 FMLLog . info ( " Mod directory created successfully " ) ; 
 } 
 @ @ - 677 , 7 + 677 , 7 @ @ public class Loader 
 if ( parseFailure ) 
 { 
 FMLLog . log ( Level . WARN , " Unable to parse dependency string % s " , dependencyString ) ; 
 - throw new LoaderException ( ) ; 
 + throw new LoaderException ( String . format ( " Unable to parse dependency string % s " , dependencyString ) ) ; 
 } 
 } 
 
 diff - - git a / fml / src / main / java / net / minecraftforge / fml / common / LoaderException . java b / fml / src / main / java / net / minecraftforge / fml / common / LoaderException . java 
 index edce3d7 . . ba212b4 100644 
 - - - a / fml / src / main / java / net / minecraftforge / fml / common / LoaderException . java 
 + + + b / fml / src / main / java / net / minecraftforge / fml / common / LoaderException . java 
 @ @ - 5 , 14 + 5 , 14 @ @ 
 * are made available under the terms of the GNU Lesser Public License v2 . 1 
 * which accompanies this distribution , and is available at 
 * http : / / www . gnu . org / licenses / old - licenses / gpl - 2 . 0 . html 
 - * 
 + * 
 * Contributors : 
 * cpw - implementation 
 * / 
 
 package net . minecraftforge . fml . common ; 
 
 - public class LoaderException extends RuntimeException 
 + public class LoaderException extends EnhancedRuntimeException 
 { 
 / * * 
 * 
 @ @ - 27 , 4 + 27 , 10 @ @ public class LoaderException extends RuntimeException 
 public LoaderException ( ) 
 { 
 } 
 + public LoaderException ( String message ) 
 + { 
 + super ( message ) ; 
 + } 
 + 
 + @ Override protected void printStackTrace ( WrappedPrintStream stream ) { } 
 } 
 diff - - git a / fml / src / main / java / net / minecraftforge / fml / common / MissingModsException . java b / fml / src / main / java / net / minecraftforge / fml / common / MissingModsException . java 
 index cafbbe1 . . 5d268e5 100644 
 - - - a / fml / src / main / java / net / minecraftforge / fml / common / MissingModsException . java 
 + + + b / fml / src / main / java / net / minecraftforge / fml / common / MissingModsException . java 
 @ @ - 14 , 9 + 14 , 10 @ @ package net . minecraftforge . fml . common ; 
 
 import java . util . Set ; 
 
 + import net . minecraftforge . fml . common . EnhancedRuntimeException . WrappedPrintStream ; 
 import net . minecraftforge . fml . common . versioning . ArtifactVersion ; 
 
 - public class MissingModsException extends RuntimeException 
 + public class MissingModsException extends EnhancedRuntimeException 
 { 
 private static final long serialVersionUID = 1L ; 
 public final Set < ArtifactVersion > missingMods ; 
 @ @ - 26 , 4 + 27 , 15 @ @ public class MissingModsException extends RuntimeException 
 super ( String . format ( " Mod % s ( % s ) requires % s " , id , name , missingMods ) ) ; 
 this . missingMods = missingMods ; 
 } 
 + 
 + @ Override 
 + protected void printStackTrace ( WrappedPrintStream stream ) 
 + { 
 + stream . println ( " Missing Mods : " ) ; 
 + for ( ArtifactVersion v : missingMods ) 
 + { 
 + stream . println ( String . format ( " \ t % s : % s " , v . getLabel ( ) , v . getRangeString ( ) ) ) ; 
 + } 
 + stream . println ( " " ) ; 
 + } 
 } 
 diff - - git a / fml / src / main / java / net / minecraftforge / fml / common / ProxyInjector . java b / fml / src / main / java / net / minecraftforge / fml / common / ProxyInjector . java 
 index 63947fd . . bfd116d 100644 
 - - - a / fml / src / main / java / net / minecraftforge / fml / common / ProxyInjector . java 
 + + + b / fml / src / main / java / net / minecraftforge / fml / common / ProxyInjector . java 
 @ @ - 46 , 7 + 46 , 7 @ @ public class ProxyInjector 
 { 
 / / Impossible ? 
 FMLLog . severe ( " Attempted to load a proxy type into % s . % s but the field was not found " , targ . getClassName ( ) , targ . getObjectName ( ) ) ; 
 - throw new LoaderException ( ) ; 
 + throw new LoaderException ( String . format ( " Attempted to load a proxy type into % s . % s but the field was not found " , targ . getClassName ( ) , targ . getObjectName ( ) ) ) ; 
 } 
 target . setAccessible ( true ) ; 
 
 @ @ - 62 , 12 + 62 , 12 @ @ public class ProxyInjector 
 if ( languageAdapter . supportsStatics ( ) & & ( target . getModifiers ( ) & Modifier . STATIC ) = = 0 ) 
 { 
 FMLLog . severe ( " Attempted to load a proxy type % s into % s . % s , but the field is not static " , targetType , targ . getClassName ( ) , targ . getObjectName ( ) ) ; 
 - throw new LoaderException ( ) ; 
 + throw new LoaderException ( String . format ( " Attempted to load a proxy type % s into % s . % s , but the field is not static " , targetType , targ . getClassName ( ) , targ . getObjectName ( ) ) ) ; 
 } 
 if ( ! target . getType ( ) . isAssignableFrom ( proxy . getClass ( ) ) ) 
 { 
 FMLLog . severe ( " Attempted to load a proxy type % s into % s . % s , but the types don ' t match " , targetType , targ . getClassName ( ) , targ . getObjectName ( ) ) ; 
 - throw new LoaderException ( ) ; 
 + throw new LoaderException ( String . format ( " Attempted to load a proxy type % s into % s . % s , but the types don ' t match " , targetType , targ . getClassName ( ) , targ . getObjectName ( ) ) ) ; 
 } 
 languageAdapter . setProxy ( target , proxyTarget , proxy ) ; 
 } 
 diff - - git a / fml / src / main / java / net / minecraftforge / fml / common / network / internal / EntitySpawnHandler . java b / fml / src / main / java / net / minecraftforge / fml / common / network / internal / EntitySpawnHandler . java 
 index bf5eb7b . . 88370df 100644 
 - - - a / fml / src / main / java / net / minecraftforge / fml / common / network / internal / EntitySpawnHandler . java 
 + + + b / fml / src / main / java / net / minecraftforge / fml / common / network / internal / EntitySpawnHandler . java 
 @ @ - 80 , 6 + 80 , 11 @ @ public class EntitySpawnHandler extends SimpleChannelInboundHandler < FMLMessage . E 
 { 
 ModContainer mc = Loader . instance ( ) . getIndexedModList ( ) . get ( spawnMsg . modId ) ; 
 EntityRegistration er = EntityRegistry . instance ( ) . lookupModSpawn ( mc , spawnMsg . modEntityTypeId ) ; 
 + if ( er = = null ) 
 + { 
 + throw new RuntimeException ( " Could not spawn mod entity ModID : " + spawnMsg . modId + " EntityID : " + spawnMsg . modEntityTypeId + 
 + " at ( " + spawnMsg . scaledX + " , " + spawnMsg . scaledY + " , " + spawnMsg . scaledZ + " ) Please contact mod author or server admin . " ) ; 
 + } 
 WorldClient wc = FMLClientHandler . instance ( ) . getWorldClient ( ) ; 
 Class < ? extends Entity > cls = er . getEntityClass ( ) ; 
 try 
 @ @ - 138 , 7 + 143 , 7 @ @ public class EntitySpawnHandler extends SimpleChannelInboundHandler < FMLMessage . E 
 wc . addEntityToWorld ( spawnMsg . entityId , entity ) ; 
 } catch ( Exception e ) 
 { 
 - FMLLog . log ( Level . ERROR , e , " A severe problem occurred during the spawning of an entity " ) ; 
 + FMLLog . log ( Level . ERROR , e , " A severe problem occurred during the spawning of an entity at ( " + spawnMsg . scaledX + " , " + spawnMsg . scaledY + " , " + spawnMsg . scaledZ + " ) " ) ; 
 throw Throwables . propagate ( e ) ; 
 } 
 } 
 diff - - git a / fml / src / main / java / net / minecraftforge / fml / common / registry / IncompatibleSubstitutionException . java b / fml / src / main / java / net / minecraftforge / fml / common / registry / IncompatibleSubstitutionException . java 
 index cf0a097 . . b40b341 100644 
 - - - a / fml / src / main / java / net / minecraftforge / fml / common / registry / IncompatibleSubstitutionException . java 
 + + + b / fml / src / main / java / net / minecraftforge / fml / common / registry / IncompatibleSubstitutionException . java 
 @ @ - 3 , 6 + 3 , 7 @ @ package net . minecraftforge . fml . common . registry ; 
 public class IncompatibleSubstitutionException extends RuntimeException { 
 public IncompatibleSubstitutionException ( String fromName , Object replacement , Object original ) 
 { 
 + super ( String . format ( " The substitute % s for % s ( type % s ) is type incompatible . " , replacement . getClass ( ) . getName ( ) , fromName , original . getClass ( ) . getName ( ) ) ) ; 
 } 
 
 private static final long serialVersionUID = 1L ;

NEAREST DIFF:
diff - - git a / fml / src / main / java / cpw / mods / fml / client / FMLClientHandler . java b / fml / src / main / java / cpw / mods / fml / client / FMLClientHandler . java 
 index 92b5838 . . 40366bc 100644 
 - - - a / fml / src / main / java / cpw / mods / fml / client / FMLClientHandler . java 
 + + + b / fml / src / main / java / cpw / mods / fml / client / FMLClientHandler . java 
 @ @ - 36 , 7 + 36 , 10 @ @ import net . minecraft . network . INetHandler ; 
 import net . minecraft . network . NetworkManager ; 
 import net . minecraft . server . MinecraftServer ; 
 import org . apache . logging . log4j . Level ; 
 + import com . google . common . base . Strings ; 
 import com . google . common . base . Throwables ; 
 + import com . google . common . collect . BiMap ; 
 + import com . google . common . collect . HashBiMap ; 
 import com . google . common . collect . ImmutableList ; 
 import com . google . common . collect . ImmutableMap ; 
 import com . google . common . collect . Maps ; 
 @ @ - 119 , 6 + 122 , 8 @ @ public class FMLClientHandler implements IFMLSidedHandler 
 
 private Map < String , IResourcePack > resourcePackMap ; 
 
 + private BiMap < ModContainer , IModGuiFactory > guiFactories ; 
 + 
 / * * 
 * Called to start the whole game off 
 * 
 @ @ - 239 , 6 + 244 , 26 @ @ public class FMLClientHandler implements IFMLSidedHandler 
 / / Reload resources 
 / / client . func _ 110436 _ a ( ) ; 
 RenderingRegistry . instance ( ) . loadEntityRenderers ( ( Map < Class < ? extends Entity > , Render > ) RenderManager . field _ 78727 _ a . field _ 78729 _ o ) ; 
 + guiFactories = HashBiMap . create ( ) ; 
 + for ( ModContainer mc : Loader . instance ( ) . getActiveModList ( ) ) 
 + { 
 + String className = mc . getGuiClassName ( ) ; 
 + if ( Strings . isNullOrEmpty ( className ) ) 
 + { 
 + continue ; 
 + } 
 + try 
 + { 
 + Class < ? > clazz = Class . forName ( className , true , Loader . instance ( ) . getModClassLoader ( ) ) ; 
 + Class < ? extends IModGuiFactory > guiClassFactory = clazz . asSubclass ( IModGuiFactory . class ) ; 
 + IModGuiFactory guiFactory = guiClassFactory . newInstance ( ) ; 
 + guiFactory . initialize ( client ) ; 
 + guiFactories . put ( mc , guiFactory ) ; 
 + } catch ( Exception e ) 
 + { 
 + FMLLog . log ( Level . ERROR , e , " A critical error occurred instantiating the gui factory for mod % s " , mc . getModId ( ) ) ; 
 + } 
 + } 
 loading = false ; 
 } 
 
 @ @ - 514 , 4 + 539 , 9 @ @ public class FMLClientHandler implements IFMLSidedHandler 
 { 
 showGuiScreen ( new GuiIngameModOptions ( guiIngameMenu ) ) ; 
 } 
 + 
 + public IModGuiFactory getGuiFactoryFor ( ModContainer selectedMod ) 
 + { 
 + return guiFactories . get ( selectedMod ) ; 
 + } 
 } 
 diff - - git a / fml / src / main / java / cpw / mods / fml / client / FMLConfigGuiFactory . java b / fml / src / main / java / cpw / mods / fml / client / FMLConfigGuiFactory . java 
 new file mode 100644 
 index 0000000 . . aff7969 
 - - - / dev / null 
 + + + b / fml / src / main / java / cpw / mods / fml / client / FMLConfigGuiFactory . java 
 @ @ - 0 , 0 + 1 , 70 @ @ 
 + package cpw . mods . fml . client ; 
 + 
 + import java . util . Set ; 
 + import net . minecraft . client . Minecraft ; 
 + import net . minecraft . client . gui . GuiButton ; 
 + import net . minecraft . client . gui . GuiScreen ; 
 + import net . minecraft . client . resources . I18n ; 
 + 
 + public class FMLConfigGuiFactory implements IModGuiFactory { 
 + public static class FMLConfigGuiScreen extends GuiScreen { 
 + private GuiScreen parent ; 
 + 
 + public FMLConfigGuiScreen ( GuiScreen parent ) 
 + { 
 + this . parent = parent ; 
 + } 
 + 
 + @ SuppressWarnings ( " unchecked " ) 
 + @ Override 
 + public void func _ 73866 _ w _ ( ) 
 + { 
 + this . field _ 146292 _ n . add ( new GuiButton ( 1 , this . field _ 146294 _ l / 2 - 75 , this . field _ 146295 _ m - 38 , I18n . func _ 135052 _ a ( " gui . done " ) ) ) ; 
 + } 
 + 
 + @ Override 
 + protected void func _ 146284 _ a ( GuiButton p _ 73875 _ 1 _ ) 
 + { 
 + if ( p _ 73875 _ 1 _ . field _ 146124 _ l & & p _ 73875 _ 1 _ . field _ 146127 _ k = = 1 ) 
 + { 
 + FMLClientHandler . instance ( ) . showGuiScreen ( parent ) ; 
 + } 
 + } 
 + 
 + @ Override 
 + public void func _ 73863 _ a ( int p _ 73863 _ 1 _ , int p _ 73863 _ 2 _ , float p _ 73863 _ 3 _ ) 
 + { 
 + this . func _ 146276 _ q _ ( ) ; 
 + this . func _ 73732 _ a ( this . field _ 146289 _ q , " Forge Mod Loader test config screen " , this . field _ 146294 _ l / 2 , 40 , 0xFFFFFF ) ; 
 + super . func _ 73863 _ a ( p _ 73863 _ 1 _ , p _ 73863 _ 2 _ , p _ 73863 _ 3 _ ) ; 
 + } 
 + 
 + } 
 + private Minecraft minecraft ; 
 + @ Override 
 + public void initialize ( Minecraft minecraftInstance ) 
 + { 
 + this . minecraft = minecraftInstance ; 
 + } 
 + 
 + @ Override 
 + public Class < ? extends GuiScreen > mainConfigGuiClass ( ) 
 + { 
 + return FMLConfigGuiScreen . class ; 
 + } 
 + 
 + @ Override 
 + public Set < RuntimeOptionCategoryElement > runtimeGuiCategories ( ) 
 + { 
 + / / TODO Auto - generated method stub 
 + return null ; 
 + } 
 + 
 + @ Override 
 + public RuntimeOptionGuiHandler getHandlerFor ( RuntimeOptionCategoryElement element ) 
 + { 
 + / / TODO Auto - generated method stub 
 + return null ; 
 + } 
 + 
 + } 
 diff - - git a / fml / src / main / java / cpw / mods / fml / client / GuiModList . java b / fml / src / main / java / cpw / mods / fml / client / GuiModList . java 
 index 9a7958f . . b83ca71 100644 
 - - - a / fml / src / main / java / cpw / mods / fml / client / GuiModList . java 
 + + + b / fml / src / main / java / cpw / mods / fml / client / GuiModList . java 
 @ @ - 33 , 10 + 33 , 12 @ @ import net . minecraft . client . resources . I18n ; 
 import net . minecraft . client . resources . IResourcePack ; 
 import net . minecraft . util . ResourceLocation ; 
 
 + import org . apache . logging . log4j . Level ; 
 import org . lwjgl . opengl . GL11 ; 
 
 import com . google . common . base . Strings ; 
 
 + import cpw . mods . fml . common . FMLLog ; 
 import cpw . mods . fml . common . Loader ; 
 import cpw . mods . fml . common . ModContainer ; 
 import cpw . mods . fml . common . ModContainer . Disableable ; 
 @ @ - 93 , 8 + 95 , 8 @ @ public class GuiModList extends GuiScreen 
 } 
 listWidth = Math . min ( listWidth , 150 ) ; 
 this . field _ 146292 _ n . add ( new GuiButton ( 6 , this . field _ 146294 _ l / 2 - 75 , this . field _ 146295 _ m - 38 , I18n . func _ 135052 _ a ( " gui . done " ) ) ) ; 
 - configModButton = new GuiButton ( 7 , 10 , this . field _ 146295 _ m - 60 , this . listWidth , 20 , " Config " ) ; 
 - disableModButton = new GuiButton ( 8 , 10 , this . field _ 146295 _ m - 38 , this . listWidth , 20 , " Disable " ) ; 
 + configModButton = new GuiButton ( 20 , 10 , this . field _ 146295 _ m - 60 , this . listWidth , 20 , " Config " ) ; 
 + disableModButton = new GuiButton ( 21 , 10 , this . field _ 146295 _ m - 38 , this . listWidth , 20 , " Disable " ) ; 
 this . field _ 146292 _ n . add ( configModButton ) ; 
 this . field _ 146292 _ n . add ( disableModButton ) ; 
 this . modList = new GuiSlotModList ( this , mods , listWidth ) ; 
 @ @ - 110 , 6 + 112 , 18 @ @ public class GuiModList extends GuiScreen 
 case 6 : 
 this . field _ 146297 _ k . func _ 147108 _ a ( this . mainMenu ) ; 
 return ; 
 + case 20 : 
 + try 
 + { 
 + IModGuiFactory guiFactory = FMLClientHandler . instance ( ) . getGuiFactoryFor ( selectedMod ) ; 
 + GuiScreen newScreen = guiFactory . mainConfigGuiClass ( ) . getConstructor ( GuiScreen . class ) . newInstance ( this ) ; 
 + this . field _ 146297 _ k . func _ 147108 _ a ( newScreen ) ; 
 + } 
 + catch ( Exception e ) 
 + { 
 + FMLLog . log ( Level . ERROR , e , " There was a critical issue trying to build the config GUI for % s " , selectedMod . getModId ( ) ) ; 
 + } 
 + return ; 
 } 
 } 
 super . func _ 146284 _ a ( button ) ; 
 @ @ - 222 , 6 + 236 , 17 @ @ public class GuiModList extends GuiScreen 
 disableModButton . field _ 146125 _ m = true ; 
 disableModButton . field _ 146124 _ l = false ; 
 } 
 + IModGuiFactory guiFactory = FMLClientHandler . instance ( ) . getGuiFactoryFor ( selectedMod ) ; 
 + if ( guiFactory = = null | | guiFactory . mainConfigGuiClass ( ) = = null ) 
 + { 
 + configModButton . field _ 146125 _ m = true ; 
 + configModButton . field _ 146124 _ l = false ; 
 + } 
 + else 
 + { 
 + configModButton . field _ 146125 _ m = true ; 
 + configModButton . field _ 146124 _ l = true ; 
 + } 
 } else { 
 offset = ( this . listWidth + this . field _ 146294 _ l ) / 2 ; 
 this . func _ 73732 _ a ( this . field _ 146289 _ q , selectedMod . getName ( ) , offset , 35 , 0xFFFFFF ) ; 
 diff - - git a / fml / src / main / java / cpw / mods / fml / client / IModGuiFactory . java b / fml / src / main / java / cpw / mods / fml / client / IModGuiFactory . java 
 new file mode 100644 
 index 0000000 . . 0e7fa18 
 - - - / dev / null 
 + + + b / fml / src / main / java / cpw / mods / fml / client / IModGuiFactory . java 
 @ @ - 0 , 0 + 1 , 127 @ @ 
 + package cpw . mods . fml . client ; 
 + 
 + import java . util . Set ; 
 + import net . minecraft . client . Minecraft ; 
 + import net . minecraft . client . gui . GuiScreen ; 
 + 
 + public interface IModGuiFactory { 
 + / * * 
 + * Called when instantiated to initialize with the active minecraft instance . 
 + * 
 + * @ param minecraftInstance the instance 
 + * / 
 + public void initialize ( Minecraft minecraftInstance ) ; 
 + / * * 
 + * Return the name of a class extending { @ link GuiScreen } . This class will 
 + * be instantiated when the " config " button is pressed in the mod list . It will 
 + * have a single argument constructor - the " parent " screen , the same as all 
 + * Minecraft GUIs . The expected behaviour is that this screen will replace the 
 + * " mod list " screen completely , and will return to the mod list screen through 
 + * the parent link , once the appropriate action is taken from the config screen . 
 + * 
 + * A null from this method indicates that the mod does not provide a " config " 
 + * button GUI screen , and the config button will be hidden / disabled . 
 + * 
 + * This config GUI is anticipated to provide configuration to the mod in a friendly 
 + * visual way . It should not be abused to set internals such as IDs ( they ' re gonna 
 + * keep disappearing anyway ) , but rather , interesting behaviours . This config GUI 
 + * is never run when a server game is running , and should be used to configure 
 + * desired behaviours that affect server state . Costs , mod game modes , stuff like that 
 + * can be changed here . 
 + * 
 + * @ return A class that will be instantiated on clicks on the config button 
 + * or null if no GUI is desired . 
 + * / 
 + public Class < ? extends GuiScreen > mainConfigGuiClass ( ) ; 
 + 
 + 
 + / * * 
 + * Return a list of the " runtime " categories this mod wishes to populate with 
 + * GUI elements . 
 + * 
 + * Runtime categories are created on demand and organized in a ' lite ' tree format . 
 + * The parent represents the parent node in the tree . There is one special parent 
 + * ' Help ' that will always list first , and is generally meant to provide Help type 
 + * content for mods . The remaining parents will sort alphabetically , though 
 + * this may change if there is a lot of alphabetic abuse . " AAA " is probably never a valid 
 + * category parent . 
 + * 
 + * Runtime configuration itself falls into two flavours : in - game help , which is 
 + * generally non interactive except for the text it wishes to show , and client - only 
 + * affecting behaviours . This would include things like toggling minimaps , or cheat modes 
 + * or anything NOT affecting the behaviour of the server . Please don ' t abuse this to 
 + * change the state of the server in any way , this is intended to behave identically 
 + * when the server is local or remote . 
 + * 
 + * @ return the set of options this mod wishes to have available , or empty if none 
 + * / 
 + public Set < RuntimeOptionCategoryElement > runtimeGuiCategories ( ) ; 
 + 
 + / * * 
 + * Return an instance of a { @ link RuntimeOptionGuiHandler } that handles painting the 
 + * right hand side option screen for the specified { @ link RuntimeOptionCategoryElement } . 
 + * 
 + * @ param element The element we wish to paint for 
 + * @ return The Handler for painting it 
 + * / 
 + public RuntimeOptionGuiHandler getHandlerFor ( RuntimeOptionCategoryElement element ) ; 
 + 
 + / * * 
 + * Represents an option category and entry in the runtime gui options list . 
 + * 
 + * @ author cpw 
 + * 
 + * / 
 + public static class RuntimeOptionCategoryElement { 
 + public final String parent ; 
 + public final String child ; 
 + 
 + public RuntimeOptionCategoryElement ( String parent , String child ) 
 + { 
 + this . parent = parent ; 
 + this . child = child ; 
 + } 
 + } 
 + 
 + / * * 
 + * Responsible for painting the mod specific section of runtime options GUI for a particular category 
 + * 
 + * @ author cpw 
 + * 
 + * / 
 + public interface RuntimeOptionGuiHandler { 
 + / * * 
 + * Called to add widgets to the screen , such as buttons . 
 + * GUI identifier numbers should start at 100 and increase . 
 + * The callback will be through { @ link # actionCallback ( int ) } 
 + * 
 + * @ param x X 
 + * @ param y Y 
 + * @ param w width 
 + * @ param h height 
 + * / 
 + public void addWidgets ( int x , int y , int w , int h ) ; 
 + 
 + / * * 
 + * Called to paint the rectangle specified . 
 + * @ param x X 
 + * @ param y Y 
 + * @ param w width 
 + * @ param h height 
 + * / 
 + public void paint ( int x , int y , int w , int h ) ; 
 + 
 + / * * 
 + * Called if a widget with id > = 100 is fired . 
 + * 
 + * @ param actionId the actionId of the firing widget 
 + * / 
 + public void actionCallback ( int actionId ) ; 
 + 
 + / * * 
 + * Called when this handler is about to go away ( probably replaced by another one , or closing the 
 + * option screen ) 
 + * / 
 + public void close ( ) ; 
 + } 
 + } 
 diff - - git a / fml / src / main / java / cpw / mods / fml / common / DummyModContainer . java b / fml / src / main / java / cpw / mods / fml / common / DummyModContainer . java 
 index f31a7a1 . . e603187 100644 
 - - - a / fml / src / main / java / cpw / mods / fml / common / DummyModContainer . java 
 + + + b / fml / src / main / java / cpw / mods / fml / common / DummyModContainer . java 
 @ @ - 186 , 4 + 186 , 10 @ @ public class DummyModContainer implements ModContainer 
 { 
 return Disableable . NEVER ; 
 } 
 + 
 + @ Override 
 + public String getGuiClassName ( ) 
 + { 
 + return null ; 
 + } 
 } 
 diff - - git a / fml / src / main / java / cpw / mods / fml / common / FMLContainer . java b / fml / src / main / java / cpw / mods / fml / common / FMLContainer . java 
 index a55cbe8 . . f406442 100644 
 - - - a / fml / src / main / java / cpw / mods / fml / common / FMLContainer . java 
 + + + b / fml / src / main / java / cpw / mods / fml / common / FMLContainer . java 
 @ @ - 215 , 4 + 215 , 10 @ @ public class FMLContainer extends DummyModContainer implements WorldAccessContai 
 { 
 return getSource ( ) . isDirectory ( ) ? FMLFolderResourcePack . class : FMLFileResourcePack . class ; 
 } 
 + 
 + @ Override 
 + public String getGuiClassName ( ) 
 + { 
 + return " cpw . mods . fml . client . FMLConfigGuiFactory " ; 
 + } 
 } 
 diff - - git a / fml / src / main / java / cpw / mods / fml / common / FMLModContainer . java b / fml / src / main / java / cpw / mods / fml / common / FMLModContainer . java 
 index 3729f43 . . 50b24ae 100644 
 - - - a / fml / src / main / java / cpw / mods / fml / common / FMLModContainer . java 
 + + + b / fml / src / main / java / cpw / mods / fml / common / FMLModContainer . java 
 @ @ - 616 , 4 + 616 , 10 @ @ public class FMLModContainer implements ModContainer 
 { 
 return disableability ; 
 } 
 + 
 + @ Override 
 + public String getGuiClassName ( ) 
 + { 
 + return ( String ) descriptor . get ( " guiFactory " ) ; 
 + } 
 } 
 diff - - git a / fml / src / main / java / cpw / mods / fml / common / InjectedModContainer . java b / fml / src / main / java / cpw / mods / fml / common / InjectedModContainer . java 
 index b02e254 . . f4acf41 100644 
 - - - a / fml / src / main / java / cpw / mods / fml / common / InjectedModContainer . java 
 + + + b / fml / src / main / java / cpw / mods / fml / common / InjectedModContainer . java 
 @ @ - 174 , 4 + 174 , 10 @ @ public class InjectedModContainer implements ModContainer 
 { 
 return wrappedContainer . canBeDisabled ( ) ; 
 } 
 + 
 + @ Override 
 + public String getGuiClassName ( ) 
 + { 
 + return wrappedContainer . getGuiClassName ( ) ; 
 + } 
 } 
 diff - - git a / fml / src / main / java / cpw / mods / fml / common / Mod . java b / fml / src / main / java / cpw / mods / fml / common / Mod . java 
 index 9d9ebf1 . . cab2511 100644 
 - - - a / fml / src / main / java / cpw / mods / fml / common / Mod . java 
 + + + b / fml / src / main / java / cpw / mods / fml / common / Mod . java 
 @ @ - 17 , 6 + 17 , 7 @ @ import java . lang . annotation . Retention ; 
 import java . lang . annotation . RetentionPolicy ; 
 import java . lang . annotation . Target ; 
 
 + import cpw . mods . fml . client . IModGuiFactory ; 
 import cpw . mods . fml . common . event . FMLEvent ; 
 import cpw . mods . fml . common . event . FMLFingerprintViolationEvent ; 
 import cpw . mods . fml . common . event . FMLInitializationEvent ; 
 @ @ - 149 , 10 + 150 , 20 @ @ public @ interface Mod 
 * ( minimap mods , graphical tweak mods ) then you can set true here and receive the FMLDeactivationEvent to perform deactivation 
 * tasks . 
 * This does not affect administrative disabling through the system property fml . modStates or the config file fmlModState . properties . 
 + * The mod will only be deactivated outside of a running game world - FML will never allow mod deactivation whilst a game server 
 + * is running . 
 * 
 - * @ return if I can be deactivated whilst the game is running . 
 + * @ return if this mod can be deactivated whilst the game is open . 
 * / 
 boolean canBeDeactivated ( ) default false ; 
 + 
 + / * * 
 + * An optional GUI factory for this mod . This is the name of a class implementing { @ link IModGuiFactory } that will be instantiated 
 + * on the client side , and will have certain configuration / options guis requested from it . 
 + * 
 + * @ return The name of a class implementing { @ link IModGuiFactory } 
 + * / 
 + String guiFactory ( ) default " " ; 
 / * * 
 * A list of custom properties for this mod . Completely up to the mod author if / when they 
 * want to put anything in here . 
 diff - - git a / fml / src / main / java / cpw / mods / fml / common / ModContainer . java b / fml / src / main / java / cpw / mods / fml / common / ModContainer . java 
 index 47cc223 . . 1641788 100644 
 - - - a / fml / src / main / java / cpw / mods / fml / common / ModContainer . java 
 + + + b / fml / src / main / java / cpw / mods / fml / common / ModContainer . java 
 @ @ - 143 , 4 + 143 , 6 @ @ public interface ModContainer 
 Map < String , String > getSharedModDescriptor ( ) ; 
 
 Disableable canBeDisabled ( ) ; 
 + 
 + String getGuiClassName ( ) ; 
 }
