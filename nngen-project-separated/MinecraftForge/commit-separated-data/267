BLEU SCORE: 0.01843246158590541

TEST MSG: Fix NBT data loss when shift - clicking stacked items in the enchantment table ( MC - 17431 )
GENERATED MSG: Improved Control of Enchantment . canApplyTogether ( ) in Mod Enchantments , allowing both enchantments to determine if they can apply together . Closes # 1434

TEST DIFF (one line): diff - - git a / patches / minecraft / net / minecraft / inventory / ContainerEnchantment . java . patch b / patches / minecraft / net / minecraft / inventory / ContainerEnchantment . java . patch <nl> index dc24e5e . . c08121b 100644 <nl> - - - a / patches / minecraft / net / minecraft / inventory / ContainerEnchantment . java . patch <nl> + + + b / patches / minecraft / net / minecraft / inventory / ContainerEnchantment . java . patch <nl> @ @ - 83 , 3 + 83 , 16 @ @ <nl> } <nl> <nl> for ( int j1 = 0 ; j1 < 3 ; + + j1 ) <nl> + @ @ - 400 , 10 + 382 , 9 @ @ <nl> + return ItemStack . field _ 190927 _ a ; <nl> + } <nl> + <nl> + - if ( itemstack1 . func _ 77942 _ o ( ) & & itemstack1 . func _ 190916 _ E ( ) = = 1 ) <nl> + + if ( itemstack1 . func _ 77942 _ o ( ) ) / / Forge : Fix MC - 17431 <nl> + { <nl> + - ( ( Slot ) this . field _ 75151 _ b . get ( 0 ) ) . func _ 75215 _ d ( itemstack1 . func _ 77946 _ l ( ) ) ; <nl> + - itemstack1 . func _ 190920 _ e ( 0 ) ; <nl> + + ( ( Slot ) this . field _ 75151 _ b . get ( 0 ) ) . func _ 75215 _ d ( itemstack1 . func _ 77979 _ a ( 1 ) ) ; <nl> + } <nl> + else if ( ! itemstack1 . func _ 190926 _ b ( ) ) <nl> + {
NEAREST DIFF (one line): diff - - git a / patches / minecraft / net / minecraft / command / CommandEnchant . java . patch b / patches / minecraft / net / minecraft / command / CommandEnchant . java . patch <nl> new file mode 100644 <nl> index 0000000 . . 7e5175c <nl> - - - / dev / null <nl> + + + b / patches / minecraft / net / minecraft / command / CommandEnchant . java . patch <nl> @ @ - 0 , 0 + 1 , 11 @ @ <nl> + - - - . . / src - base / minecraft / net / minecraft / command / CommandEnchant . java <nl> + + + + . . / src - work / minecraft / net / minecraft / command / CommandEnchant . java <nl> + @ @ - 76 , 7 + 76 , 7 @ @ <nl> + { <nl> + Enchantment enchantment1 = Enchantment . field _ 77331 _ b [ short1 ] ; <nl> + <nl> + - if ( ! enchantment1 . func _ 77326 _ a ( enchantment ) ) <nl> + + if ( ! enchantment1 . func _ 77326 _ a ( enchantment ) | | ! enchantment . func _ 77326 _ a ( enchantment1 ) ) / / Forge BugFix : Let Both enchantments veto being together <nl> + { <nl> + throw new CommandException ( " commands . enchant . cantCombine " , new Object [ ] { enchantment . func _ 77316 _ c ( j ) , enchantment1 . func _ 77316 _ c ( nbttaglist . func _ 150305 _ b ( k ) . func _ 74765 _ d ( " lvl " ) ) } ) ; <nl> + } <nl> diff - - git a / patches / minecraft / net / minecraft / enchantment / EnchantmentHelper . java . patch b / patches / minecraft / net / minecraft / enchantment / EnchantmentHelper . java . patch <nl> index 242648e . . f400f35 100644 <nl> - - - a / patches / minecraft / net / minecraft / enchantment / EnchantmentHelper . java . patch <nl> + + + b / patches / minecraft / net / minecraft / enchantment / EnchantmentHelper . java . patch <nl> @ @ - 18 , 7 + 18 , 18 @ @ <nl> <nl> if ( j < = 0 ) <nl> { <nl> - @ @ - 435 , 7 + 435 , 8 @ @ <nl> + @ @ - 393 , 7 + 393 , 9 @ @ <nl> + { <nl> + EnchantmentData enchantmentdata1 = ( EnchantmentData ) iterator1 . next ( ) ; <nl> + <nl> + - if ( enchantmentdata1 . field _ 76302 _ b . func _ 77326 _ a ( Enchantment . field _ 77331 _ b [ integer . intValue ( ) ] ) ) <nl> + + Enchantment e1 = enchantmentdata1 . field _ 76302 _ b ; <nl> + + Enchantment e2 = Enchantment . field _ 77331 _ b [ integer . intValue ( ) ] ; <nl> + + if ( e1 . func _ 77326 _ a ( e2 ) & & e2 . func _ 77326 _ a ( e1 ) ) / / Forge BugFix : Let Both enchantments veto being together <nl> + { <nl> + continue ; <nl> + } <nl> + @ @ - 435 , 7 + 437 , 8 @ @ <nl> { <nl> Enchantment enchantment = aenchantment [ k ] ; <nl> <nl> diff - - git a / patches / minecraft / net / minecraft / inventory / ContainerRepair . java . patch b / patches / minecraft / net / minecraft / inventory / ContainerRepair . java . patch <nl> index 1ba9397 . . ad320cf 100644 <nl> - - - a / patches / minecraft / net / minecraft / inventory / ContainerRepair . java . patch <nl> + + + b / patches / minecraft / net / minecraft / inventory / ContainerRepair . java . patch <nl> @ @ - 13 , 7 + 13 , 7 @ @ <nl> } <nl> <nl> + float breakChance = ForgeHooks . onAnvilRepair ( p _ 82870 _ 1 _ , p _ 82870 _ 2 _ , ContainerRepair . this . field _ 82853 _ g . func _ 70301 _ a ( 0 ) , ContainerRepair . this . field _ 82853 _ g . func _ 70301 _ a ( 1 ) ) ; <nl> - + <nl> + + <nl> ContainerRepair . this . field _ 82853 _ g . func _ 70299 _ a ( 0 , ( ItemStack ) null ) ; <nl> <nl> if ( ContainerRepair . this . field _ 82856 _ l > 0 ) <nl> @ @ - 34 , 7 + 34 , 17 @ @ <nl> flag = itemstack2 . func _ 77973 _ b ( ) = = Items . field _ 151134 _ bR & & Items . field _ 151134 _ bR . func _ 92110 _ g ( itemstack2 ) . func _ 74745 _ c ( ) > 0 ; <nl> <nl> if ( itemstack1 . func _ 77984 _ f ( ) & & itemstack1 . func _ 77973 _ b ( ) . func _ 82789 _ a ( itemstack , itemstack2 ) ) <nl> - @ @ - 373 , 6 + 377 , 8 @ @ <nl> + @ @ - 258 , 7 + 262 , 8 @ @ <nl> + { <nl> + int j2 = ( ( Integer ) iterator . next ( ) ) . intValue ( ) ; <nl> + <nl> + - if ( j2 ! = i1 & & ! enchantment . func _ 77326 _ a ( Enchantment . field _ 77331 _ b [ j2 ] ) ) <nl> + + Enchantment e2 = Enchantment . field _ 77331 _ b [ j2 ] ; <nl> + + if ( j2 ! = i1 & & ! ( enchantment . func _ 77326 _ a ( e2 ) & & e2 . func _ 77326 _ a ( enchantment ) ) ) / / Forge BugFix : Let Both enchantments veto being together <nl> + { <nl> + flag1 = false ; <nl> + i + = i2 ; <nl> + @ @ - 373 , 6 + 378 , 8 @ @ <nl> k2 = Math . max ( 1 , k2 / 2 ) ; <nl> } <nl>

TEST DIFF:
diff - - git a / patches / minecraft / net / minecraft / inventory / ContainerEnchantment . java . patch b / patches / minecraft / net / minecraft / inventory / ContainerEnchantment . java . patch 
 index dc24e5e . . c08121b 100644 
 - - - a / patches / minecraft / net / minecraft / inventory / ContainerEnchantment . java . patch 
 + + + b / patches / minecraft / net / minecraft / inventory / ContainerEnchantment . java . patch 
 @ @ - 83 , 3 + 83 , 16 @ @ 
 } 
 
 for ( int j1 = 0 ; j1 < 3 ; + + j1 ) 
 + @ @ - 400 , 10 + 382 , 9 @ @ 
 + return ItemStack . field _ 190927 _ a ; 
 + } 
 + 
 + - if ( itemstack1 . func _ 77942 _ o ( ) & & itemstack1 . func _ 190916 _ E ( ) = = 1 ) 
 + + if ( itemstack1 . func _ 77942 _ o ( ) ) / / Forge : Fix MC - 17431 
 + { 
 + - ( ( Slot ) this . field _ 75151 _ b . get ( 0 ) ) . func _ 75215 _ d ( itemstack1 . func _ 77946 _ l ( ) ) ; 
 + - itemstack1 . func _ 190920 _ e ( 0 ) ; 
 + + ( ( Slot ) this . field _ 75151 _ b . get ( 0 ) ) . func _ 75215 _ d ( itemstack1 . func _ 77979 _ a ( 1 ) ) ; 
 + } 
 + else if ( ! itemstack1 . func _ 190926 _ b ( ) ) 
 + {

NEAREST DIFF:
diff - - git a / patches / minecraft / net / minecraft / command / CommandEnchant . java . patch b / patches / minecraft / net / minecraft / command / CommandEnchant . java . patch 
 new file mode 100644 
 index 0000000 . . 7e5175c 
 - - - / dev / null 
 + + + b / patches / minecraft / net / minecraft / command / CommandEnchant . java . patch 
 @ @ - 0 , 0 + 1 , 11 @ @ 
 + - - - . . / src - base / minecraft / net / minecraft / command / CommandEnchant . java 
 + + + + . . / src - work / minecraft / net / minecraft / command / CommandEnchant . java 
 + @ @ - 76 , 7 + 76 , 7 @ @ 
 + { 
 + Enchantment enchantment1 = Enchantment . field _ 77331 _ b [ short1 ] ; 
 + 
 + - if ( ! enchantment1 . func _ 77326 _ a ( enchantment ) ) 
 + + if ( ! enchantment1 . func _ 77326 _ a ( enchantment ) | | ! enchantment . func _ 77326 _ a ( enchantment1 ) ) / / Forge BugFix : Let Both enchantments veto being together 
 + { 
 + throw new CommandException ( " commands . enchant . cantCombine " , new Object [ ] { enchantment . func _ 77316 _ c ( j ) , enchantment1 . func _ 77316 _ c ( nbttaglist . func _ 150305 _ b ( k ) . func _ 74765 _ d ( " lvl " ) ) } ) ; 
 + } 
 diff - - git a / patches / minecraft / net / minecraft / enchantment / EnchantmentHelper . java . patch b / patches / minecraft / net / minecraft / enchantment / EnchantmentHelper . java . patch 
 index 242648e . . f400f35 100644 
 - - - a / patches / minecraft / net / minecraft / enchantment / EnchantmentHelper . java . patch 
 + + + b / patches / minecraft / net / minecraft / enchantment / EnchantmentHelper . java . patch 
 @ @ - 18 , 7 + 18 , 18 @ @ 
 
 if ( j < = 0 ) 
 { 
 - @ @ - 435 , 7 + 435 , 8 @ @ 
 + @ @ - 393 , 7 + 393 , 9 @ @ 
 + { 
 + EnchantmentData enchantmentdata1 = ( EnchantmentData ) iterator1 . next ( ) ; 
 + 
 + - if ( enchantmentdata1 . field _ 76302 _ b . func _ 77326 _ a ( Enchantment . field _ 77331 _ b [ integer . intValue ( ) ] ) ) 
 + + Enchantment e1 = enchantmentdata1 . field _ 76302 _ b ; 
 + + Enchantment e2 = Enchantment . field _ 77331 _ b [ integer . intValue ( ) ] ; 
 + + if ( e1 . func _ 77326 _ a ( e2 ) & & e2 . func _ 77326 _ a ( e1 ) ) / / Forge BugFix : Let Both enchantments veto being together 
 + { 
 + continue ; 
 + } 
 + @ @ - 435 , 7 + 437 , 8 @ @ 
 { 
 Enchantment enchantment = aenchantment [ k ] ; 
 
 diff - - git a / patches / minecraft / net / minecraft / inventory / ContainerRepair . java . patch b / patches / minecraft / net / minecraft / inventory / ContainerRepair . java . patch 
 index 1ba9397 . . ad320cf 100644 
 - - - a / patches / minecraft / net / minecraft / inventory / ContainerRepair . java . patch 
 + + + b / patches / minecraft / net / minecraft / inventory / ContainerRepair . java . patch 
 @ @ - 13 , 7 + 13 , 7 @ @ 
 } 
 
 + float breakChance = ForgeHooks . onAnvilRepair ( p _ 82870 _ 1 _ , p _ 82870 _ 2 _ , ContainerRepair . this . field _ 82853 _ g . func _ 70301 _ a ( 0 ) , ContainerRepair . this . field _ 82853 _ g . func _ 70301 _ a ( 1 ) ) ; 
 - + 
 + + 
 ContainerRepair . this . field _ 82853 _ g . func _ 70299 _ a ( 0 , ( ItemStack ) null ) ; 
 
 if ( ContainerRepair . this . field _ 82856 _ l > 0 ) 
 @ @ - 34 , 7 + 34 , 17 @ @ 
 flag = itemstack2 . func _ 77973 _ b ( ) = = Items . field _ 151134 _ bR & & Items . field _ 151134 _ bR . func _ 92110 _ g ( itemstack2 ) . func _ 74745 _ c ( ) > 0 ; 
 
 if ( itemstack1 . func _ 77984 _ f ( ) & & itemstack1 . func _ 77973 _ b ( ) . func _ 82789 _ a ( itemstack , itemstack2 ) ) 
 - @ @ - 373 , 6 + 377 , 8 @ @ 
 + @ @ - 258 , 7 + 262 , 8 @ @ 
 + { 
 + int j2 = ( ( Integer ) iterator . next ( ) ) . intValue ( ) ; 
 + 
 + - if ( j2 ! = i1 & & ! enchantment . func _ 77326 _ a ( Enchantment . field _ 77331 _ b [ j2 ] ) ) 
 + + Enchantment e2 = Enchantment . field _ 77331 _ b [ j2 ] ; 
 + + if ( j2 ! = i1 & & ! ( enchantment . func _ 77326 _ a ( e2 ) & & e2 . func _ 77326 _ a ( enchantment ) ) ) / / Forge BugFix : Let Both enchantments veto being together 
 + { 
 + flag1 = false ; 
 + i + = i2 ; 
 + @ @ - 373 , 6 + 378 , 8 @ @ 
 k2 = Math . max ( 1 , k2 / 2 ) ; 
 } 

