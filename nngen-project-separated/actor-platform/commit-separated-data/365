BLEU SCORE: 0.23196101068401995

TEST MSG: fix ( server : core ) : less constraints on slash command
GENERATED MSG: fix ( server : users ) : isBot was not flusted to sql

TEST DIFF (one line): diff - - git a / actor - server / actor - core / src / main / scala / im / actor / server / user / UserCommandHandlers . scala b / actor - server / actor - core / src / main / scala / im / actor / server / user / UserCommandHandlers . scala < nl > index 2843c7f . . 773c0f3 100644 < nl > - - - a / actor - server / actor - core / src / main / scala / im / actor / server / user / UserCommandHandlers . scala < nl > + + + b / actor - server / actor - core / src / main / scala / im / actor / server / user / UserCommandHandlers . scala < nl > @ @ - 294 , 10 + 294 , 8 @ @ private [ user ] trait UserCommandHandlers { < nl > < nl > protected def addBotCommand ( user : UserState , rawCommand : BotCommand ) : Unit = { < nl > val command = rawCommand . copy ( slashCommand = rawCommand . slashCommand . trim ) < nl > - def isValid ( command : BotCommand ) = { < nl > - val slashCommand = command . slashCommand < nl > - slashCommand . nonEmpty & & slashCommand . matches ( " [ A - Za - z ] * " ) & & slashCommand . length < 32 < nl > - } < nl > + def isValid ( command : BotCommand ) = command . slashCommand . matches ( " ^ [ 0 - 9a - zA - Z _ ] { 2 , 32 } " ) < nl > + < nl > if ( user . botCommands . exists ( _ . slashCommand = = command . slashCommand ) ) { < nl > sender ( ) ! Status . Failure ( BotCommandAlreadyExists ( command . slashCommand ) ) < nl > } else {
NEAREST DIFF (one line): diff - - git a / actor - server / actor - core / src / main / scala / im / actor / server / user / UserCommandHandlers . scala b / actor - server / actor - core / src / main / scala / im / actor / server / user / UserCommandHandlers . scala < nl > index e87444b . . cc7ae16 100644 < nl > - - - a / actor - server / actor - core / src / main / scala / im / actor / server / user / UserCommandHandlers . scala < nl > + + + b / actor - server / actor - core / src / main / scala / im / actor / server / user / UserCommandHandlers . scala < nl > @ @ - 81 , 7 + 81 , 8 @ @ private [ user ] trait UserCommandHandlers { < nl > sex = models . Sex . fromInt ( sex . id ) , < nl > state = models . UserState . Registered , < nl > createdAt = LocalDateTime . now ( ZoneOffset . UTC ) , < nl > - external = external < nl > + external = external , < nl > + isBot = isBot < nl > ) < nl > db . run ( for ( _ ← p . UserRepo . create ( user ) ) yield CreateAck ( ) ) < nl > }

TEST DIFF:
diff - - git a / actor - server / actor - core / src / main / scala / im / actor / server / user / UserCommandHandlers . scala b / actor - server / actor - core / src / main / scala / im / actor / server / user / UserCommandHandlers . scala 
 index 2843c7f . . 773c0f3 100644 
 - - - a / actor - server / actor - core / src / main / scala / im / actor / server / user / UserCommandHandlers . scala 
 + + + b / actor - server / actor - core / src / main / scala / im / actor / server / user / UserCommandHandlers . scala 
 @ @ - 294 , 10 + 294 , 8 @ @ private [ user ] trait UserCommandHandlers { 
 
 protected def addBotCommand ( user : UserState , rawCommand : BotCommand ) : Unit = { 
 val command = rawCommand . copy ( slashCommand = rawCommand . slashCommand . trim ) 
 - def isValid ( command : BotCommand ) = { 
 - val slashCommand = command . slashCommand 
 - slashCommand . nonEmpty & & slashCommand . matches ( " [ A - Za - z ] * " ) & & slashCommand . length < 32 
 - } 
 + def isValid ( command : BotCommand ) = command . slashCommand . matches ( " ^ [ 0 - 9a - zA - Z _ ] { 2 , 32 } " ) 
 + 
 if ( user . botCommands . exists ( _ . slashCommand = = command . slashCommand ) ) { 
 sender ( ) ! Status . Failure ( BotCommandAlreadyExists ( command . slashCommand ) ) 
 } else {

NEAREST DIFF:
diff - - git a / actor - server / actor - core / src / main / scala / im / actor / server / user / UserCommandHandlers . scala b / actor - server / actor - core / src / main / scala / im / actor / server / user / UserCommandHandlers . scala 
 index e87444b . . cc7ae16 100644 
 - - - a / actor - server / actor - core / src / main / scala / im / actor / server / user / UserCommandHandlers . scala 
 + + + b / actor - server / actor - core / src / main / scala / im / actor / server / user / UserCommandHandlers . scala 
 @ @ - 81 , 7 + 81 , 8 @ @ private [ user ] trait UserCommandHandlers { 
 sex = models . Sex . fromInt ( sex . id ) , 
 state = models . UserState . Registered , 
 createdAt = LocalDateTime . now ( ZoneOffset . UTC ) , 
 - external = external 
 + external = external , 
 + isBot = isBot 
 ) 
 db . run ( for ( _ ← p . UserRepo . create ( user ) ) yield CreateAck ( ) ) 
 }
