BLEU SCORE: 0.5156626918239822

TEST MSG: fix ( server : push ) : call initFlow on GooglePushExtension initialization
GENERATED MSG: fix ( server : push ) : fixed successful delivery report

TEST DIFF (one line): diff - - git a / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala b / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala < nl > index 66b29e3 . . 277e2fe 100644 < nl > - - - a / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala < nl > + + + b / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala < nl > @ @ - 70 , 7 + 70 , 9 @ @ final class GooglePushExtension ( system : ActorSystem ) extends Extension { < nl > private val config = GooglePushManagerConfig . load ( system . settings . config . getConfig ( " services . google . push " ) ) . get < nl > private val deliveryPublisher = system . actorOf ( GooglePushDelivery . props , " google - push - delivery " ) < nl > < nl > - def initFlow ( ) : Unit = < nl > + initFlow ( ) < nl > + < nl > + private def initFlow ( ) : Unit = < nl > Source . fromPublisher ( ActorPublisher [ ( HttpRequest , GooglePushDelivery . Delivery ) ] ( deliveryPublisher ) ) < nl > . via ( GooglePushDelivery . flow ) < nl > . runForeach {
NEAREST DIFF (one line): diff - - git a / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala b / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala < nl > index 62c59a6 . . 6283f80 100644 < nl > - - - a / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala < nl > + + + b / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala < nl > @ @ - 88 , 7 + 88 , 7 @ @ final class GooglePushExtension ( system : ActorSystem ) extends Extension { < nl > case Xor . Right ( json ) ⇒ < nl > json . asObject match { < nl > case Some ( obj ) ⇒ < nl > - obj ( " error " ) map ( _ . asString ) foreach { < nl > + obj ( " error " ) flatMap ( _ . asString ) match { < nl > case Some ( " InvalidRegistration " ) ⇒ < nl > log . warning ( " Invalid registration , deleting " ) < nl > remove ( delivery . m . to )

TEST DIFF:
diff - - git a / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala b / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala 
 index 66b29e3 . . 277e2fe 100644 
 - - - a / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala 
 + + + b / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala 
 @ @ - 70 , 7 + 70 , 9 @ @ final class GooglePushExtension ( system : ActorSystem ) extends Extension { 
 private val config = GooglePushManagerConfig . load ( system . settings . config . getConfig ( " services . google . push " ) ) . get 
 private val deliveryPublisher = system . actorOf ( GooglePushDelivery . props , " google - push - delivery " ) 
 
 - def initFlow ( ) : Unit = 
 + initFlow ( ) 
 + 
 + private def initFlow ( ) : Unit = 
 Source . fromPublisher ( ActorPublisher [ ( HttpRequest , GooglePushDelivery . Delivery ) ] ( deliveryPublisher ) ) 
 . via ( GooglePushDelivery . flow ) 
 . runForeach {

NEAREST DIFF:
diff - - git a / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala b / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala 
 index 62c59a6 . . 6283f80 100644 
 - - - a / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala 
 + + + b / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala 
 @ @ - 88 , 7 + 88 , 7 @ @ final class GooglePushExtension ( system : ActorSystem ) extends Extension { 
 case Xor . Right ( json ) ⇒ 
 json . asObject match { 
 case Some ( obj ) ⇒ 
 - obj ( " error " ) map ( _ . asString ) foreach { 
 + obj ( " error " ) flatMap ( _ . asString ) match { 
 case Some ( " InvalidRegistration " ) ⇒ 
 log . warning ( " Invalid registration , deleting " ) 
 remove ( delivery . m . to )
