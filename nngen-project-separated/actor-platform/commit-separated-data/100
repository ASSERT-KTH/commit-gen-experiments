BLEU SCORE: 0.13741953268935678

TEST MSG: chore ( android ) : leave and exit group option
GENERATED MSG: wip ( code + android ) : Working on creation of channels

TEST DIFF (one line): diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / dialogs / DialogsDefaultFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / dialogs / DialogsDefaultFragment . java < nl > index 205a0a7 . . 8663b3f 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / dialogs / DialogsDefaultFragment . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / dialogs / DialogsDefaultFragment . java < nl > @ @ - 69 , 50 + 69 , 36 @ @ public class DialogsDefaultFragment extends BaseDialogFragment { < nl > return true ; < nl > } else if ( dialog . getPeer ( ) . getPeerType ( ) = = PeerType . GROUP ) { < nl > GroupVM groupVM = groups ( ) . get ( dialog . getPeer ( ) . getPeerId ( ) ) ; < nl > - final boolean isMember = groupVM . isMember ( ) . get ( ) ; < nl > + CharSequence [ ] items ; < nl > + if ( groupVM . getIsCanLeave ( ) . get ( ) ) { < nl > + items = new CharSequence [ ] { < nl > + getString ( R . string . dialogs _ menu _ group _ view ) , < nl > + getString ( R . string . dialogs _ menu _ group _ rename ) , < nl > + getString ( R . string . dialogs _ menu _ group _ leave ) , < nl > + } ; < nl > + } else { < nl > + items = new CharSequence [ ] { < nl > + getString ( R . string . dialogs _ menu _ group _ view ) , < nl > + getString ( R . string . dialogs _ menu _ group _ rename ) , < nl > + } ; < nl > + } < nl > < nl > new AlertDialog . Builder ( getActivity ( ) ) < nl > - . setItems ( new CharSequence [ ] { < nl > - getString ( R . string . dialogs _ menu _ group _ view ) , < nl > - getString ( R . string . dialogs _ menu _ group _ rename ) , < nl > - isMember ? getString ( R . string . dialogs _ menu _ group _ leave ) < nl > - : getString ( R . string . dialogs _ menu _ group _ delete ) , < nl > - } , ( d , which ) - > { < nl > + . setItems ( items , ( d , which ) - > { < nl > if ( which = = 0 ) { < nl > ActorSDK . sharedActor ( ) . startGroupInfoActivity ( getActivity ( ) , dialog . getPeer ( ) . getPeerId ( ) ) ; < nl > } else if ( which = = 1 ) { < nl > startActivity ( Intents . editGroupTitle ( dialog . getPeer ( ) . getPeerId ( ) , getActivity ( ) ) ) ; < nl > } else if ( which = = 2 ) { < nl > - if ( isMember ) { < nl > - new AlertDialog . Builder ( getActivity ( ) ) < nl > - . setMessage ( getString ( R . string . alert _ leave _ group _ message , dialog . getDialogTitle ( ) ) ) < nl > - . setNegativeButton ( R . string . dialog _ cancel , null ) < nl > - . setPositiveButton ( R . string . alert _ leave _ group _ yes , ( d1 , which1 ) - > { < nl > - execute ( messenger ( ) . leaveGroup ( dialog . getPeer ( ) . getPeerId ( ) ) , R . string . progress _ common ) . failure ( e - > { < nl > - Toast . makeText ( getActivity ( ) , R . string . toast _ unable _ leave , Toast . LENGTH _ LONG ) . show ( ) ; < nl > - } ) ; < nl > - } ) < nl > - . show ( ) ; < nl > - } else { < nl > - new AlertDialog . Builder ( getActivity ( ) ) < nl > - . setMessage ( getString ( R . string . alert _ delete _ group _ title , groupVM . getName ( ) . get ( ) ) ) < nl > - . setNegativeButton ( R . string . dialog _ cancel , null ) < nl > - . setPositiveButton ( R . string . alert _ delete _ group _ yes , ( d1 , which1 ) - > { < nl > - execute ( messenger ( ) . deleteChat ( dialog . getPeer ( ) ) , R . string . progress _ common , < nl > - new CommandCallback < Void > ( ) { < nl > - @ Override < nl > - public void onResult ( Void res ) { < nl > - < nl > - } < nl > - < nl > - @ Override < nl > - public void onError ( Exception e ) { < nl > - Toast . makeText ( getActivity ( ) , R . string . toast _ unable _ delete _ chat , Toast . LENGTH _ LONG ) . show ( ) ; < nl > - } < nl > - } ) ; < nl > - } ) < nl > - . show ( ) ; < nl > - } < nl > + new AlertDialog . Builder ( getActivity ( ) ) < nl > + . setMessage ( getString ( R . string . alert _ leave _ group _ message , dialog . getDialogTitle ( ) ) ) < nl > + . setNegativeButton ( R . string . dialog _ cancel , null ) < nl > + . setPositiveButton ( R . string . alert _ leave _ group _ yes , ( d1 , which1 ) - > { < nl > + execute ( messenger ( ) . leaveAndDeleteGroup ( dialog . getPeer ( ) . getPeerId ( ) ) , R . string . progress _ common ) . failure ( e - > { < nl > + Toast . makeText ( getActivity ( ) , R . string . toast _ unable _ leave , Toast . LENGTH _ LONG ) . show ( ) ; < nl > + } ) ; < nl > + } ) < nl > + . show ( ) ; < nl > } < nl > } ) . show ( ) ; < nl > return true ; < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Messenger . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Messenger . java < nl > index 9714481 . . b551eb3 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Messenger . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Messenger . java < nl > @ @ - 975 , 15 + 975 , 9 @ @ public class Messenger { < nl > * / < nl > @ ObjectiveCName ( " deleteChatCommandWithPeer : " ) < nl > public Command < Void > deleteChat ( Peer peer ) { < nl > - if ( peer . getPeerType ( ) = = PeerType . GROUP ) { < nl > - return callback - > modules . getGroupsModule ( ) . leaveAndDeleteGroup ( peer . getPeerId ( ) ) < nl > - . then ( v - > callback . onResult ( v ) ) < nl > - . failure ( e - > callback . onError ( e ) ) ; < nl > - } else { < nl > - return callback - > modules . getMessagesModule ( ) . deleteChat ( peer ) < nl > - . then ( v - > callback . onResult ( v ) ) < nl > - . failure ( e - > callback . onError ( e ) ) ; < nl > - } < nl > + return callback - > modules . getMessagesModule ( ) . deleteChat ( peer ) < nl > + . then ( v - > callback . onResult ( v ) ) < nl > + . failure ( e - > callback . onError ( e ) ) ; < nl > } < nl > < nl > / * *
NEAREST DIFF (one line): diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / compose / GroupNameFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / compose / GroupNameFragment . java < nl > index e20fb18 . . 874554f 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / compose / GroupNameFragment . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / compose / GroupNameFragment . java < nl > @ @ - 2 , 6 + 2 , 7 @ @ package im . actor . sdk . controllers . compose ; < nl > < nl > import android . app . Activity ; < nl > import android . content . Intent ; < nl > + import android . net . Uri ; < nl > import android . os . Bundle ; < nl > import android . view . KeyEvent ; < nl > import android . view . LayoutInflater ; < nl > @ @ - 14 , 17 + 15 , 20 @ @ import android . view . inputmethod . EditorInfo ; < nl > import android . widget . EditText ; < nl > import android . widget . TextView ; < nl > < nl > + import java . util . List ; < nl > + < nl > + import im . actor . runtime . function . Consumer ; < nl > import im . actor . sdk . ActorSDK ; < nl > import im . actor . sdk . R ; < nl > import im . actor . sdk . controllers . Intents ; < nl > import im . actor . sdk . controllers . BaseFragment ; < nl > + import im . actor . sdk . controllers . tools . MediaPickerCallback ; < nl > import im . actor . sdk . util . Screen ; < nl > import im . actor . sdk . view . avatar . AvatarView ; < nl > import im . actor . sdk . util . KeyboardHelper ; < nl > < nl > - / * * < nl > - * Created by ex3ndr on 04 . 10 . 14 . < nl > - * / < nl > + import static im . actor . sdk . util . ActorSDKMessenger . messenger ; < nl > + < nl > public class GroupNameFragment extends BaseFragment { < nl > < nl > private static final int REQUEST _ AVATAR = 1 ; < nl > @ @ - 50 , 15 + 54 , 12 @ @ public class GroupNameFragment extends BaseFragment { < nl > res . setBackgroundColor ( ActorSDK . sharedActor ( ) . style . getMainBackgroundColor ( ) ) ; < nl > ( ( TextView ) res . findViewById ( R . id . create _ group _ hint ) ) . setTextColor ( ActorSDK . sharedActor ( ) . style . getTextSecondaryColor ( ) ) ; < nl > groupName = ( EditText ) res . findViewById ( R . id . groupTitle ) ; < nl > - groupName . setOnEditorActionListener ( new TextView . OnEditorActionListener ( ) { < nl > - @ Override < nl > - public boolean onEditorAction ( TextView v , int actionId , KeyEvent event ) { < nl > - if ( actionId = = EditorInfo . IME _ ACTION _ NEXT ) { < nl > - next ( ) ; < nl > - return true ; < nl > - } < nl > - return false ; < nl > + groupName . setOnEditorActionListener ( ( v , actionId , event ) - > { < nl > + if ( actionId = = EditorInfo . IME _ ACTION _ NEXT ) { < nl > + next ( ) ; < nl > + return true ; < nl > } < nl > + return false ; < nl > } ) ; < nl > groupName . setTextColor ( ActorSDK . sharedActor ( ) . style . getTextPrimaryColor ( ) ) ; < nl > groupName . setHintTextColor ( ActorSDK . sharedActor ( ) . style . getTextHintColor ( ) ) ; < nl > @ @ - 69 , 11 + 70 , 8 @ @ public class GroupNameFragment extends BaseFragment { < nl > / / avatarView . getHierarchy ( ) . setControllerOverlay ( getResources ( ) . getDrawable ( R . drawable . circle _ selector ) ) ; < nl > avatarView . setImageURI ( null ) ; < nl > < nl > - res . findViewById ( R . id . pickAvatar ) . setOnClickListener ( new View . OnClickListener ( ) { < nl > - @ Override < nl > - public void onClick ( View view ) { < nl > - startActivityForResult ( Intents . pickAvatar ( avatarPath ! = null , getActivity ( ) ) , REQUEST _ AVATAR ) ; < nl > - } < nl > + res . findViewById ( R . id . pickAvatar ) . setOnClickListener ( view - > { < nl > + startActivityForResult ( Intents . pickAvatar ( avatarPath ! = null , getActivity ( ) ) , REQUEST _ AVATAR ) ; < nl > } ) ; < nl > < nl > return res ; < nl > @ @ - 104 , 8 + 102 , 11 @ @ public class GroupNameFragment extends BaseFragment { < nl > private void next ( ) { < nl > String title = groupName . getText ( ) . toString ( ) . trim ( ) ; < nl > if ( title . length ( ) > 0 ) { < nl > - ( ( CreateGroupActivity ) getActivity ( ) ) . showNextFragment ( < nl > - GroupUsersFragment . create ( groupName . getText ( ) . toString ( ) . trim ( ) , avatarPath ) , false , true ) ; < nl > + / / ( ( CreateGroupActivity ) getActivity ( ) ) . showNextFragment ( < nl > + / / GroupUsersFragment . create ( groupName . getText ( ) . toString ( ) . trim ( ) , avatarPath ) , false , true ) ; < nl > + messenger ( ) . createChannel ( groupName . getText ( ) . toString ( ) . trim ( ) , avatarPath ) . then ( gid - > { < nl > + getActivity ( ) . finish ( ) ; < nl > + } ) ; < nl > } < nl > } < nl > < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / compose / GroupUsersFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / compose / GroupUsersFragment . java < nl > index 4141245 . . db08781 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / compose / GroupUsersFragment . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / compose / GroupUsersFragment . java < nl > @ @ - 18 , 6 + 18 , 7 @ @ import android . widget . Toast ; < nl > < nl > import im . actor . core . entity . Contact ; < nl > import im . actor . core . viewmodel . CommandCallback ; < nl > + import im . actor . runtime . function . Consumer ; < nl > import im . actor . sdk . ActorSDK ; < nl > import im . actor . sdk . R ; < nl > import im . actor . sdk . controllers . Intents ; < nl > @ @ - 106 , 20 + 107 , 13 @ @ public class GroupUsersFragment extends BaseContactFragment { < nl > public boolean onOptionsItemSelected ( MenuItem item ) { < nl > if ( item . getItemId ( ) = = R . id . done ) { < nl > if ( getSelectedCount ( ) > 0 ) { < nl > - execute ( messenger ( ) . createGroup ( title , avatarPath , BoxUtil . unbox ( getSelected ( ) ) ) , < nl > - R . string . progress _ common , new CommandCallback < Integer > ( ) { < nl > - @ Override < nl > - public void onResult ( Integer res ) { < nl > - getActivity ( ) . startActivity ( Intents . openGroupDialog ( res , true , getActivity ( ) ) ) ; < nl > - getActivity ( ) . finish ( ) ; < nl > - } < nl > - < nl > - @ Override < nl > - public void onError ( Exception e ) { < nl > - Toast . makeText ( getActivity ( ) , getString ( R . string . toast _ unable _ create _ group ) , Toast . LENGTH _ LONG ) . show ( ) ; < nl > - < nl > - } < nl > - } ) ; < nl > + execute ( messenger ( ) . createGroup ( title , avatarPath , BoxUtil . unbox ( getSelected ( ) ) ) . then ( gid - > { < nl > + getActivity ( ) . startActivity ( Intents . openGroupDialog ( gid , true , getActivity ( ) ) ) ; < nl > + getActivity ( ) . finish ( ) ; < nl > + } ) . failure ( e - > { < nl > + Toast . makeText ( getActivity ( ) , getString ( R . string . toast _ unable _ create _ group ) , < nl > + Toast . LENGTH _ LONG ) . show ( ) ; < nl > + } ) ) ; < nl > } < nl > return true ; < nl > } < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatFragment . java < nl > index a05dcf5 . . ea7ca53 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatFragment . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatFragment . java < nl > @ @ - 10 , 6 + 10 , 7 @ @ import android . view . ViewGroup ; < nl > import android . widget . TextView ; < nl > import android . widget . Toast ; < nl > < nl > + import im . actor . core . entity . GroupType ; < nl > import im . actor . core . entity . Peer ; < nl > import im . actor . core . entity . PeerType ; < nl > import im . actor . core . entity . Sticker ; < nl > @ @ - 20 , 6 + 21 , 7 @ @ import im . actor . core . viewmodel . UserVM ; < nl > import im . actor . runtime . mvvm . Value ; < nl > import im . actor . runtime . mvvm . ValueChangedListener ; < nl > import im . actor . runtime . mvvm . ValueDoubleChangedListener ; < nl > + import im . actor . runtime . mvvm . ValueListener ; < nl > import im . actor . sdk . ActorSDK ; < nl > import im . actor . sdk . ActorSDKLauncher ; < nl > import im . actor . sdk . R ; < nl > @ @ - 167 , 11 + 169 , 16 @ @ public class ChatFragment extends BaseFragment implements InputBarCallback , Mess < nl > } < nl > } else if ( peer . getPeerType ( ) = = PeerType . GROUP ) { < nl > GroupVM groupVM = groups ( ) . get ( peer . getPeerId ( ) ) ; < nl > - < nl > - bind ( groupVM . isMember ( ) , ( val , valueModel ) - > { < nl > - if ( val ) { < nl > + bind ( groupVM . isMember ( ) , groupVM . getIsCanWriteMessage ( ) , ( isMember , valueModel , canWriteMessage , valueModel2 ) - > { < nl > + if ( canWriteMessage ) { < nl > goneView ( inputOverlayContainer , false ) ; < nl > showView ( inputContainer , false ) ; < nl > + } else if ( isMember ) { < nl > + inputOverlayText . setText ( " Can ' t send message " ) ; < nl > + inputOverlayText . setTextColor ( style . getListActionColor ( ) ) ; < nl > + inputOverlayText . setClickable ( false ) ; < nl > + showView ( inputOverlayContainer , false ) ; < nl > + goneView ( inputContainer , false ) ; < nl > } else { < nl > inputOverlayText . setText ( R . string . chat _ not _ member ) ; < nl > inputOverlayText . setTextColor ( style . getListActionColor ( ) ) ; < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Messenger . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Messenger . java < nl > index 1f08894 . . f793432 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Messenger . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Messenger . java < nl > @ @ - 1388 , 7 + 1388 , 7 @ @ public class Messenger { < nl > * @ param title new group title < nl > * @ return Command for execution < nl > * / < nl > - @ Nullable < nl > + @ NotNull < nl > @ ObjectiveCName ( " editGroupTitleCommandWithGid : withTitle : " ) < nl > public Command < Void > editGroupTitle ( final int gid , final String title ) { < nl > return callback - > modules . getGroupsModule ( ) . editTitle ( gid , title ) < nl > @ @ - 1458 , 16 + 1458 , 26 @ @ public class Messenger { < nl > * @ param title group title < nl > * @ param avatarDescriptor descriptor of group avatar ( can be null if not set ) < nl > * @ param uids member ' s ids < nl > - * @ return Command for execution < nl > + * @ return Promise of group id < nl > * / < nl > - @ Nullable < nl > - @ ObjectiveCName ( " createGroupCommandWithTitle : withAvatar : withUids : " ) < nl > - public Command < Integer > createGroup ( String title , String avatarDescriptor , int [ ] uids ) { < nl > - return callback - > modules . getGroupsModule ( ) . createGroup ( title , avatarDescriptor , uids ) < nl > - . then ( integer - > callback . onResult ( integer ) ) < nl > - . failure ( e - > callback . onError ( e ) ) ; < nl > + @ NotNull < nl > + @ ObjectiveCName ( " createGroupWithTitle : withAvatar : withUids : " ) < nl > + public Promise < Integer > createGroup ( String title , String avatarDescriptor , int [ ] uids ) { < nl > + return modules . getGroupsModule ( ) . createGroup ( title , avatarDescriptor , uids ) ; < nl > } < nl > < nl > + / * * < nl > + * Create channel < nl > + * < nl > + * @ param title channel title < nl > + * @ param avatarDescriptor descriptor of channel avatar ( can be null if not set ) < nl > + * @ return Promise of channel id < nl > + * / < nl > + @ NotNull < nl > + @ ObjectiveCName ( " createChannelWithTitle : withAvatar : " ) < nl > + public Promise < Integer > createChannel ( String title , String avatarDescriptor ) { < nl > + return modules . getGroupsModule ( ) . createChannel ( title , avatarDescriptor ) ; < nl > + } < nl > < nl > / * * < nl > * Leave group < nl > @ @ - 1475 , 7 + 1485 , 7 @ @ public class Messenger { < nl > * @ param gid group ' s id < nl > * @ return Command for execution < nl > * / < nl > - @ Nullable < nl > + @ NotNull < nl > @ ObjectiveCName ( " leaveGroupCommandWithGid : " ) < nl > public Command < Void > leaveGroup ( final int gid ) { < nl > return callback - > modules . getGroupsModule ( ) . leaveGroup ( gid ) < nl > @ @ - 1490 , 7 + 1500 , 7 @ @ public class Messenger { < nl > * @ param uid user ' s id < nl > * @ return Command for execution < nl > * / < nl > - @ Nullable < nl > + @ NotNull < nl > @ ObjectiveCName ( " inviteMemberCommandWithGid : withUid : " ) < nl > public Command < Void > inviteMember ( int gid , int uid ) { < nl > return callback - > modules . getGroupsModule ( ) . addMember ( gid , uid ) < nl > @ @ - 1505 , 7 + 1515 , 7 @ @ public class Messenger { < nl > * @ param uid user ' s id < nl > * @ return Command for execution < nl > * / < nl > - @ Nullable < nl > + @ NotNull < nl > @ ObjectiveCName ( " kickMemberCommandWithGid : withUid : " ) < nl > public Command < Void > kickMember ( int gid , int uid ) { < nl > return callback - > modules . getGroupsModule ( ) . kickMember ( gid , uid ) < nl > @ @ - 1520 , 7 + 1530 , 7 @ @ public class Messenger { < nl > * @ param uid user ' s id < nl > * @ return Command for execution < nl > * / < nl > - @ Nullable < nl > + @ NotNull < nl > @ ObjectiveCName ( " makeAdminCommandWithGid : withUid : " ) < nl > public Command < Void > makeAdmin ( final int gid , final int uid ) { < nl > return callback - > modules . getGroupsModule ( ) . makeAdmin ( gid , uid ) < nl > @ @ - 1535 , 7 + 1545 , 7 @ @ public class Messenger { < nl > * @ param uid user ' s id < nl > * @ return Promise of void < nl > * / < nl > - @ Nullable < nl > + @ NotNull < nl > @ ObjectiveCName ( " transferOwnershipWithGid : withUid : " ) < nl > public Promise < Void > transferOwnership ( int gid , int uid ) { < nl > return modules . getGroupsModule ( ) . transferOwnership ( gid , uid ) ; < nl > @ @ - 1547 , 7 + 1557 , 7 @ @ public class Messenger { < nl > * @ param gid group ' s id < nl > * @ return Command for execution < nl > * / < nl > - @ Nullable < nl > + @ NotNull < nl > @ ObjectiveCName ( " requestInviteLinkCommandWithGid : " ) < nl > public Command < String > requestInviteLink ( int gid ) { < nl > return callback - > modules . getGroupsModule ( ) . requestInviteLink ( gid ) < nl > @ @ - 1561 , 7 + 1571 , 7 @ @ public class Messenger { < nl > * @ param gid group ' s id < nl > * @ return Command for execution < nl > * / < nl > - @ Nullable < nl > + @ NotNull < nl > @ ObjectiveCName ( " requestRevokeLinkCommandWithGid : " ) < nl > public Command < String > revokeInviteLink ( int gid ) { < nl > return callback - > modules . getGroupsModule ( ) . requestRevokeLink ( gid ) < nl > @ @ - 1575 , 7 + 1585 , 7 @ @ public class Messenger { < nl > * @ param token invite token < nl > * @ return Command for execution < nl > * / < nl > - @ Nullable < nl > + @ NotNull < nl > @ ObjectiveCName ( " joinGroupViaLinkCommandWithToken : " ) < nl > public Command < Integer > joinGroupViaToken ( String token ) { < nl > return callback - > modules . getGroupsModule ( ) . joinGroupByToken ( token ) < nl > @ @ - 1589 , 7 + 1599 , 7 @ @ public class Messenger { < nl > * @ param gid group ' s id < nl > * @ return Command for execution < nl > * / < nl > - @ Nullable < nl > + @ NotNull < nl > @ ObjectiveCName ( " requestIntegrationTokenCommandWithGid : " ) < nl > public Command < String > requestIntegrationToken ( int gid ) { < nl > return callback - > modules . getGroupsModule ( ) . requestIntegrationToken ( gid ) < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / groups / GroupsModule . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / groups / GroupsModule . java < nl > index 9d824aa . . dfa281d 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / groups / GroupsModule . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / groups / GroupsModule . java < nl > @ @ - 9 , 6 + 9 , 7 @ @ import java . util . HashMap ; < nl > import java . util . List ; < nl > < nl > import im . actor . core . api . ApiGroupOutPeer ; < nl > + import im . actor . core . api . ApiGroupType ; < nl > import im . actor . core . api . ApiOutPeer ; < nl > import im . actor . core . api . ApiPeerType ; < nl > import im . actor . core . api . ApiUserOutPeer ; < nl > @ @ - 109 , 7 + 110 , 16 @ @ public class GroupsModule extends AbsModule implements BusSubscriber { < nl > / / Actions < nl > / / < nl > < nl > - public Promise < Integer > createGroup ( final String title , final String avatarDescriptor , final int [ ] uids ) { < nl > + public Promise < Integer > createGroup ( String title , String avatarDescriptor , int [ ] uids ) { < nl > + return createGroup ( title , avatarDescriptor , uids , ApiGroupType . GROUP ) ; < nl > + } < nl > + < nl > + public Promise < Integer > createChannel ( String title , String avatarDescriptor ) { < nl > + return createGroup ( title , avatarDescriptor , new int [ 0 ] , ApiGroupType . CHANNEL ) ; < nl > + } < nl > + < nl > + private Promise < Integer > createGroup ( String title , String avatarDescriptor , int [ ] uids , < nl > + ApiGroupType groupType ) { < nl > long rid = RandomUtils . nextRid ( ) ; < nl > return Promise . success ( uids ) < nl > . map ( ( Function < int [ ] , List < ApiUserOutPeer > > ) ints - > { < nl > @ @ - 124 , 7 + 134 , 7 @ @ public class GroupsModule extends AbsModule implements BusSubscriber { < nl > } ) < nl > . flatMap ( apiUserOutPeers - > < nl > api ( new RequestCreateGroup ( rid , title , apiUserOutPeers , < nl > - null , ApiSupportConfiguration . OPTIMIZATIONS ) ) ) < nl > + groupType , ApiSupportConfiguration . OPTIMIZATIONS ) ) ) < nl > . chain ( r - > updates ( ) . applyRelatedData ( r . getUsers ( ) , r . getGroup ( ) ) ) < nl > . chain ( r - > updates ( ) . waitForUpdate ( r . getSeq ( ) ) ) < nl > . map ( r - > r . getGroup ( ) . getId ( ) ) < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / viewmodel / GroupVM . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / viewmodel / GroupVM . java < nl > index 43bcf90 . . cb8626a 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / viewmodel / GroupVM . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / viewmodel / GroupVM . java < nl > @ @ - 15 , 6 + 15 , 7 @ @ import java . util . HashSet ; < nl > < nl > import im . actor . core . entity . Group ; < nl > import im . actor . core . entity . GroupMember ; < nl > + import im . actor . core . entity . GroupType ; < nl > import im . actor . core . viewmodel . generics . AvatarValueModel ; < nl > import im . actor . core . viewmodel . generics . BooleanValueModel ; < nl > import im . actor . core . viewmodel . generics . IntValueModel ; < nl > @ @ - 36 , 6 + 37 , 9 @ @ public class GroupVM extends BaseValueModel < Group > { < nl > private int groupId ; < nl > @ NotNull < nl > @ Property ( " nonatomic , readonly " ) < nl > + private GroupType groupType ; < nl > + @ NotNull < nl > + @ Property ( " nonatomic , readonly " ) < nl > private StringValueModel name ; < nl > @ NotNull < nl > @ Property ( " nonatomic , readonly " ) < nl > @ @ - 78 , 6 + 82 , 7 @ @ public class GroupVM extends BaseValueModel < Group > { < nl > public GroupVM ( @ NotNull Group rawObj ) { < nl > super ( rawObj ) ; < nl > this . groupId = rawObj . getGroupId ( ) ; < nl > + this . groupType = rawObj . getGroupType ( ) ; < nl > this . name = new StringValueModel ( " group . " + groupId + " . title " , rawObj . getTitle ( ) ) ; < nl > this . avatar = new AvatarValueModel ( " group . " + groupId + " . avatar " , rawObj . getAvatar ( ) ) ; < nl > this . isMember = new BooleanValueModel ( " group . " + groupId + " . isMember " , rawObj . isMember ( ) ) ; < nl > @ @ - 102 , 6 + 107 , 17 @ @ public class GroupVM extends BaseValueModel < Group > { < nl > } < nl > < nl > / * * < nl > + * Get Group Type < nl > + * < nl > + * @ return Group Type < nl > + * / < nl > + @ NotNull < nl > + @ ObjectiveCName ( " getGroupType " ) < nl > + public GroupType getGroupType ( ) { < nl > + return groupType ; < nl > + } < nl > + < nl > + / * * < nl > * Get Name Value Model < nl > * < nl > * @ return Value Model of String < nl > @ @ - 194 , 6 + 210 , 7 @ @ public class GroupVM extends BaseValueModel < Group > { < nl > isChanged | = avatar . change ( rawObj . getAvatar ( ) ) ; < nl > isChanged | = membersCount . change ( rawObj . getMembersCount ( ) ) ; < nl > isChanged | = isMember . change ( rawObj . isMember ( ) ) ; < nl > + isChanged | = isCanWriteMessage . change ( rawObj . isCanWrite ( ) ) ; < nl > < nl > isChanged | = theme . change ( rawObj . getTopic ( ) ) ; < nl > isChanged | = about . change ( rawObj . getAbout ( ) ) ;

TEST DIFF:
diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / dialogs / DialogsDefaultFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / dialogs / DialogsDefaultFragment . java 
 index 205a0a7 . . 8663b3f 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / dialogs / DialogsDefaultFragment . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / dialogs / DialogsDefaultFragment . java 
 @ @ - 69 , 50 + 69 , 36 @ @ public class DialogsDefaultFragment extends BaseDialogFragment { 
 return true ; 
 } else if ( dialog . getPeer ( ) . getPeerType ( ) = = PeerType . GROUP ) { 
 GroupVM groupVM = groups ( ) . get ( dialog . getPeer ( ) . getPeerId ( ) ) ; 
 - final boolean isMember = groupVM . isMember ( ) . get ( ) ; 
 + CharSequence [ ] items ; 
 + if ( groupVM . getIsCanLeave ( ) . get ( ) ) { 
 + items = new CharSequence [ ] { 
 + getString ( R . string . dialogs _ menu _ group _ view ) , 
 + getString ( R . string . dialogs _ menu _ group _ rename ) , 
 + getString ( R . string . dialogs _ menu _ group _ leave ) , 
 + } ; 
 + } else { 
 + items = new CharSequence [ ] { 
 + getString ( R . string . dialogs _ menu _ group _ view ) , 
 + getString ( R . string . dialogs _ menu _ group _ rename ) , 
 + } ; 
 + } 
 
 new AlertDialog . Builder ( getActivity ( ) ) 
 - . setItems ( new CharSequence [ ] { 
 - getString ( R . string . dialogs _ menu _ group _ view ) , 
 - getString ( R . string . dialogs _ menu _ group _ rename ) , 
 - isMember ? getString ( R . string . dialogs _ menu _ group _ leave ) 
 - : getString ( R . string . dialogs _ menu _ group _ delete ) , 
 - } , ( d , which ) - > { 
 + . setItems ( items , ( d , which ) - > { 
 if ( which = = 0 ) { 
 ActorSDK . sharedActor ( ) . startGroupInfoActivity ( getActivity ( ) , dialog . getPeer ( ) . getPeerId ( ) ) ; 
 } else if ( which = = 1 ) { 
 startActivity ( Intents . editGroupTitle ( dialog . getPeer ( ) . getPeerId ( ) , getActivity ( ) ) ) ; 
 } else if ( which = = 2 ) { 
 - if ( isMember ) { 
 - new AlertDialog . Builder ( getActivity ( ) ) 
 - . setMessage ( getString ( R . string . alert _ leave _ group _ message , dialog . getDialogTitle ( ) ) ) 
 - . setNegativeButton ( R . string . dialog _ cancel , null ) 
 - . setPositiveButton ( R . string . alert _ leave _ group _ yes , ( d1 , which1 ) - > { 
 - execute ( messenger ( ) . leaveGroup ( dialog . getPeer ( ) . getPeerId ( ) ) , R . string . progress _ common ) . failure ( e - > { 
 - Toast . makeText ( getActivity ( ) , R . string . toast _ unable _ leave , Toast . LENGTH _ LONG ) . show ( ) ; 
 - } ) ; 
 - } ) 
 - . show ( ) ; 
 - } else { 
 - new AlertDialog . Builder ( getActivity ( ) ) 
 - . setMessage ( getString ( R . string . alert _ delete _ group _ title , groupVM . getName ( ) . get ( ) ) ) 
 - . setNegativeButton ( R . string . dialog _ cancel , null ) 
 - . setPositiveButton ( R . string . alert _ delete _ group _ yes , ( d1 , which1 ) - > { 
 - execute ( messenger ( ) . deleteChat ( dialog . getPeer ( ) ) , R . string . progress _ common , 
 - new CommandCallback < Void > ( ) { 
 - @ Override 
 - public void onResult ( Void res ) { 
 - 
 - } 
 - 
 - @ Override 
 - public void onError ( Exception e ) { 
 - Toast . makeText ( getActivity ( ) , R . string . toast _ unable _ delete _ chat , Toast . LENGTH _ LONG ) . show ( ) ; 
 - } 
 - } ) ; 
 - } ) 
 - . show ( ) ; 
 - } 
 + new AlertDialog . Builder ( getActivity ( ) ) 
 + . setMessage ( getString ( R . string . alert _ leave _ group _ message , dialog . getDialogTitle ( ) ) ) 
 + . setNegativeButton ( R . string . dialog _ cancel , null ) 
 + . setPositiveButton ( R . string . alert _ leave _ group _ yes , ( d1 , which1 ) - > { 
 + execute ( messenger ( ) . leaveAndDeleteGroup ( dialog . getPeer ( ) . getPeerId ( ) ) , R . string . progress _ common ) . failure ( e - > { 
 + Toast . makeText ( getActivity ( ) , R . string . toast _ unable _ leave , Toast . LENGTH _ LONG ) . show ( ) ; 
 + } ) ; 
 + } ) 
 + . show ( ) ; 
 } 
 } ) . show ( ) ; 
 return true ; 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Messenger . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Messenger . java 
 index 9714481 . . b551eb3 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Messenger . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Messenger . java 
 @ @ - 975 , 15 + 975 , 9 @ @ public class Messenger { 
 * / 
 @ ObjectiveCName ( " deleteChatCommandWithPeer : " ) 
 public Command < Void > deleteChat ( Peer peer ) { 
 - if ( peer . getPeerType ( ) = = PeerType . GROUP ) { 
 - return callback - > modules . getGroupsModule ( ) . leaveAndDeleteGroup ( peer . getPeerId ( ) ) 
 - . then ( v - > callback . onResult ( v ) ) 
 - . failure ( e - > callback . onError ( e ) ) ; 
 - } else { 
 - return callback - > modules . getMessagesModule ( ) . deleteChat ( peer ) 
 - . then ( v - > callback . onResult ( v ) ) 
 - . failure ( e - > callback . onError ( e ) ) ; 
 - } 
 + return callback - > modules . getMessagesModule ( ) . deleteChat ( peer ) 
 + . then ( v - > callback . onResult ( v ) ) 
 + . failure ( e - > callback . onError ( e ) ) ; 
 } 
 
 / * *

NEAREST DIFF:
diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / compose / GroupNameFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / compose / GroupNameFragment . java 
 index e20fb18 . . 874554f 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / compose / GroupNameFragment . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / compose / GroupNameFragment . java 
 @ @ - 2 , 6 + 2 , 7 @ @ package im . actor . sdk . controllers . compose ; 
 
 import android . app . Activity ; 
 import android . content . Intent ; 
 + import android . net . Uri ; 
 import android . os . Bundle ; 
 import android . view . KeyEvent ; 
 import android . view . LayoutInflater ; 
 @ @ - 14 , 17 + 15 , 20 @ @ import android . view . inputmethod . EditorInfo ; 
 import android . widget . EditText ; 
 import android . widget . TextView ; 
 
 + import java . util . List ; 
 + 
 + import im . actor . runtime . function . Consumer ; 
 import im . actor . sdk . ActorSDK ; 
 import im . actor . sdk . R ; 
 import im . actor . sdk . controllers . Intents ; 
 import im . actor . sdk . controllers . BaseFragment ; 
 + import im . actor . sdk . controllers . tools . MediaPickerCallback ; 
 import im . actor . sdk . util . Screen ; 
 import im . actor . sdk . view . avatar . AvatarView ; 
 import im . actor . sdk . util . KeyboardHelper ; 
 
 - / * * 
 - * Created by ex3ndr on 04 . 10 . 14 . 
 - * / 
 + import static im . actor . sdk . util . ActorSDKMessenger . messenger ; 
 + 
 public class GroupNameFragment extends BaseFragment { 
 
 private static final int REQUEST _ AVATAR = 1 ; 
 @ @ - 50 , 15 + 54 , 12 @ @ public class GroupNameFragment extends BaseFragment { 
 res . setBackgroundColor ( ActorSDK . sharedActor ( ) . style . getMainBackgroundColor ( ) ) ; 
 ( ( TextView ) res . findViewById ( R . id . create _ group _ hint ) ) . setTextColor ( ActorSDK . sharedActor ( ) . style . getTextSecondaryColor ( ) ) ; 
 groupName = ( EditText ) res . findViewById ( R . id . groupTitle ) ; 
 - groupName . setOnEditorActionListener ( new TextView . OnEditorActionListener ( ) { 
 - @ Override 
 - public boolean onEditorAction ( TextView v , int actionId , KeyEvent event ) { 
 - if ( actionId = = EditorInfo . IME _ ACTION _ NEXT ) { 
 - next ( ) ; 
 - return true ; 
 - } 
 - return false ; 
 + groupName . setOnEditorActionListener ( ( v , actionId , event ) - > { 
 + if ( actionId = = EditorInfo . IME _ ACTION _ NEXT ) { 
 + next ( ) ; 
 + return true ; 
 } 
 + return false ; 
 } ) ; 
 groupName . setTextColor ( ActorSDK . sharedActor ( ) . style . getTextPrimaryColor ( ) ) ; 
 groupName . setHintTextColor ( ActorSDK . sharedActor ( ) . style . getTextHintColor ( ) ) ; 
 @ @ - 69 , 11 + 70 , 8 @ @ public class GroupNameFragment extends BaseFragment { 
 / / avatarView . getHierarchy ( ) . setControllerOverlay ( getResources ( ) . getDrawable ( R . drawable . circle _ selector ) ) ; 
 avatarView . setImageURI ( null ) ; 
 
 - res . findViewById ( R . id . pickAvatar ) . setOnClickListener ( new View . OnClickListener ( ) { 
 - @ Override 
 - public void onClick ( View view ) { 
 - startActivityForResult ( Intents . pickAvatar ( avatarPath ! = null , getActivity ( ) ) , REQUEST _ AVATAR ) ; 
 - } 
 + res . findViewById ( R . id . pickAvatar ) . setOnClickListener ( view - > { 
 + startActivityForResult ( Intents . pickAvatar ( avatarPath ! = null , getActivity ( ) ) , REQUEST _ AVATAR ) ; 
 } ) ; 
 
 return res ; 
 @ @ - 104 , 8 + 102 , 11 @ @ public class GroupNameFragment extends BaseFragment { 
 private void next ( ) { 
 String title = groupName . getText ( ) . toString ( ) . trim ( ) ; 
 if ( title . length ( ) > 0 ) { 
 - ( ( CreateGroupActivity ) getActivity ( ) ) . showNextFragment ( 
 - GroupUsersFragment . create ( groupName . getText ( ) . toString ( ) . trim ( ) , avatarPath ) , false , true ) ; 
 + / / ( ( CreateGroupActivity ) getActivity ( ) ) . showNextFragment ( 
 + / / GroupUsersFragment . create ( groupName . getText ( ) . toString ( ) . trim ( ) , avatarPath ) , false , true ) ; 
 + messenger ( ) . createChannel ( groupName . getText ( ) . toString ( ) . trim ( ) , avatarPath ) . then ( gid - > { 
 + getActivity ( ) . finish ( ) ; 
 + } ) ; 
 } 
 } 
 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / compose / GroupUsersFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / compose / GroupUsersFragment . java 
 index 4141245 . . db08781 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / compose / GroupUsersFragment . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / compose / GroupUsersFragment . java 
 @ @ - 18 , 6 + 18 , 7 @ @ import android . widget . Toast ; 
 
 import im . actor . core . entity . Contact ; 
 import im . actor . core . viewmodel . CommandCallback ; 
 + import im . actor . runtime . function . Consumer ; 
 import im . actor . sdk . ActorSDK ; 
 import im . actor . sdk . R ; 
 import im . actor . sdk . controllers . Intents ; 
 @ @ - 106 , 20 + 107 , 13 @ @ public class GroupUsersFragment extends BaseContactFragment { 
 public boolean onOptionsItemSelected ( MenuItem item ) { 
 if ( item . getItemId ( ) = = R . id . done ) { 
 if ( getSelectedCount ( ) > 0 ) { 
 - execute ( messenger ( ) . createGroup ( title , avatarPath , BoxUtil . unbox ( getSelected ( ) ) ) , 
 - R . string . progress _ common , new CommandCallback < Integer > ( ) { 
 - @ Override 
 - public void onResult ( Integer res ) { 
 - getActivity ( ) . startActivity ( Intents . openGroupDialog ( res , true , getActivity ( ) ) ) ; 
 - getActivity ( ) . finish ( ) ; 
 - } 
 - 
 - @ Override 
 - public void onError ( Exception e ) { 
 - Toast . makeText ( getActivity ( ) , getString ( R . string . toast _ unable _ create _ group ) , Toast . LENGTH _ LONG ) . show ( ) ; 
 - 
 - } 
 - } ) ; 
 + execute ( messenger ( ) . createGroup ( title , avatarPath , BoxUtil . unbox ( getSelected ( ) ) ) . then ( gid - > { 
 + getActivity ( ) . startActivity ( Intents . openGroupDialog ( gid , true , getActivity ( ) ) ) ; 
 + getActivity ( ) . finish ( ) ; 
 + } ) . failure ( e - > { 
 + Toast . makeText ( getActivity ( ) , getString ( R . string . toast _ unable _ create _ group ) , 
 + Toast . LENGTH _ LONG ) . show ( ) ; 
 + } ) ) ; 
 } 
 return true ; 
 } 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatFragment . java 
 index a05dcf5 . . ea7ca53 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatFragment . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatFragment . java 
 @ @ - 10 , 6 + 10 , 7 @ @ import android . view . ViewGroup ; 
 import android . widget . TextView ; 
 import android . widget . Toast ; 
 
 + import im . actor . core . entity . GroupType ; 
 import im . actor . core . entity . Peer ; 
 import im . actor . core . entity . PeerType ; 
 import im . actor . core . entity . Sticker ; 
 @ @ - 20 , 6 + 21 , 7 @ @ import im . actor . core . viewmodel . UserVM ; 
 import im . actor . runtime . mvvm . Value ; 
 import im . actor . runtime . mvvm . ValueChangedListener ; 
 import im . actor . runtime . mvvm . ValueDoubleChangedListener ; 
 + import im . actor . runtime . mvvm . ValueListener ; 
 import im . actor . sdk . ActorSDK ; 
 import im . actor . sdk . ActorSDKLauncher ; 
 import im . actor . sdk . R ; 
 @ @ - 167 , 11 + 169 , 16 @ @ public class ChatFragment extends BaseFragment implements InputBarCallback , Mess 
 } 
 } else if ( peer . getPeerType ( ) = = PeerType . GROUP ) { 
 GroupVM groupVM = groups ( ) . get ( peer . getPeerId ( ) ) ; 
 - 
 - bind ( groupVM . isMember ( ) , ( val , valueModel ) - > { 
 - if ( val ) { 
 + bind ( groupVM . isMember ( ) , groupVM . getIsCanWriteMessage ( ) , ( isMember , valueModel , canWriteMessage , valueModel2 ) - > { 
 + if ( canWriteMessage ) { 
 goneView ( inputOverlayContainer , false ) ; 
 showView ( inputContainer , false ) ; 
 + } else if ( isMember ) { 
 + inputOverlayText . setText ( " Can ' t send message " ) ; 
 + inputOverlayText . setTextColor ( style . getListActionColor ( ) ) ; 
 + inputOverlayText . setClickable ( false ) ; 
 + showView ( inputOverlayContainer , false ) ; 
 + goneView ( inputContainer , false ) ; 
 } else { 
 inputOverlayText . setText ( R . string . chat _ not _ member ) ; 
 inputOverlayText . setTextColor ( style . getListActionColor ( ) ) ; 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Messenger . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Messenger . java 
 index 1f08894 . . f793432 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Messenger . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Messenger . java 
 @ @ - 1388 , 7 + 1388 , 7 @ @ public class Messenger { 
 * @ param title new group title 
 * @ return Command for execution 
 * / 
 - @ Nullable 
 + @ NotNull 
 @ ObjectiveCName ( " editGroupTitleCommandWithGid : withTitle : " ) 
 public Command < Void > editGroupTitle ( final int gid , final String title ) { 
 return callback - > modules . getGroupsModule ( ) . editTitle ( gid , title ) 
 @ @ - 1458 , 16 + 1458 , 26 @ @ public class Messenger { 
 * @ param title group title 
 * @ param avatarDescriptor descriptor of group avatar ( can be null if not set ) 
 * @ param uids member ' s ids 
 - * @ return Command for execution 
 + * @ return Promise of group id 
 * / 
 - @ Nullable 
 - @ ObjectiveCName ( " createGroupCommandWithTitle : withAvatar : withUids : " ) 
 - public Command < Integer > createGroup ( String title , String avatarDescriptor , int [ ] uids ) { 
 - return callback - > modules . getGroupsModule ( ) . createGroup ( title , avatarDescriptor , uids ) 
 - . then ( integer - > callback . onResult ( integer ) ) 
 - . failure ( e - > callback . onError ( e ) ) ; 
 + @ NotNull 
 + @ ObjectiveCName ( " createGroupWithTitle : withAvatar : withUids : " ) 
 + public Promise < Integer > createGroup ( String title , String avatarDescriptor , int [ ] uids ) { 
 + return modules . getGroupsModule ( ) . createGroup ( title , avatarDescriptor , uids ) ; 
 } 
 
 + / * * 
 + * Create channel 
 + * 
 + * @ param title channel title 
 + * @ param avatarDescriptor descriptor of channel avatar ( can be null if not set ) 
 + * @ return Promise of channel id 
 + * / 
 + @ NotNull 
 + @ ObjectiveCName ( " createChannelWithTitle : withAvatar : " ) 
 + public Promise < Integer > createChannel ( String title , String avatarDescriptor ) { 
 + return modules . getGroupsModule ( ) . createChannel ( title , avatarDescriptor ) ; 
 + } 
 
 / * * 
 * Leave group 
 @ @ - 1475 , 7 + 1485 , 7 @ @ public class Messenger { 
 * @ param gid group ' s id 
 * @ return Command for execution 
 * / 
 - @ Nullable 
 + @ NotNull 
 @ ObjectiveCName ( " leaveGroupCommandWithGid : " ) 
 public Command < Void > leaveGroup ( final int gid ) { 
 return callback - > modules . getGroupsModule ( ) . leaveGroup ( gid ) 
 @ @ - 1490 , 7 + 1500 , 7 @ @ public class Messenger { 
 * @ param uid user ' s id 
 * @ return Command for execution 
 * / 
 - @ Nullable 
 + @ NotNull 
 @ ObjectiveCName ( " inviteMemberCommandWithGid : withUid : " ) 
 public Command < Void > inviteMember ( int gid , int uid ) { 
 return callback - > modules . getGroupsModule ( ) . addMember ( gid , uid ) 
 @ @ - 1505 , 7 + 1515 , 7 @ @ public class Messenger { 
 * @ param uid user ' s id 
 * @ return Command for execution 
 * / 
 - @ Nullable 
 + @ NotNull 
 @ ObjectiveCName ( " kickMemberCommandWithGid : withUid : " ) 
 public Command < Void > kickMember ( int gid , int uid ) { 
 return callback - > modules . getGroupsModule ( ) . kickMember ( gid , uid ) 
 @ @ - 1520 , 7 + 1530 , 7 @ @ public class Messenger { 
 * @ param uid user ' s id 
 * @ return Command for execution 
 * / 
 - @ Nullable 
 + @ NotNull 
 @ ObjectiveCName ( " makeAdminCommandWithGid : withUid : " ) 
 public Command < Void > makeAdmin ( final int gid , final int uid ) { 
 return callback - > modules . getGroupsModule ( ) . makeAdmin ( gid , uid ) 
 @ @ - 1535 , 7 + 1545 , 7 @ @ public class Messenger { 
 * @ param uid user ' s id 
 * @ return Promise of void 
 * / 
 - @ Nullable 
 + @ NotNull 
 @ ObjectiveCName ( " transferOwnershipWithGid : withUid : " ) 
 public Promise < Void > transferOwnership ( int gid , int uid ) { 
 return modules . getGroupsModule ( ) . transferOwnership ( gid , uid ) ; 
 @ @ - 1547 , 7 + 1557 , 7 @ @ public class Messenger { 
 * @ param gid group ' s id 
 * @ return Command for execution 
 * / 
 - @ Nullable 
 + @ NotNull 
 @ ObjectiveCName ( " requestInviteLinkCommandWithGid : " ) 
 public Command < String > requestInviteLink ( int gid ) { 
 return callback - > modules . getGroupsModule ( ) . requestInviteLink ( gid ) 
 @ @ - 1561 , 7 + 1571 , 7 @ @ public class Messenger { 
 * @ param gid group ' s id 
 * @ return Command for execution 
 * / 
 - @ Nullable 
 + @ NotNull 
 @ ObjectiveCName ( " requestRevokeLinkCommandWithGid : " ) 
 public Command < String > revokeInviteLink ( int gid ) { 
 return callback - > modules . getGroupsModule ( ) . requestRevokeLink ( gid ) 
 @ @ - 1575 , 7 + 1585 , 7 @ @ public class Messenger { 
 * @ param token invite token 
 * @ return Command for execution 
 * / 
 - @ Nullable 
 + @ NotNull 
 @ ObjectiveCName ( " joinGroupViaLinkCommandWithToken : " ) 
 public Command < Integer > joinGroupViaToken ( String token ) { 
 return callback - > modules . getGroupsModule ( ) . joinGroupByToken ( token ) 
 @ @ - 1589 , 7 + 1599 , 7 @ @ public class Messenger { 
 * @ param gid group ' s id 
 * @ return Command for execution 
 * / 
 - @ Nullable 
 + @ NotNull 
 @ ObjectiveCName ( " requestIntegrationTokenCommandWithGid : " ) 
 public Command < String > requestIntegrationToken ( int gid ) { 
 return callback - > modules . getGroupsModule ( ) . requestIntegrationToken ( gid ) 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / groups / GroupsModule . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / groups / GroupsModule . java 
 index 9d824aa . . dfa281d 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / groups / GroupsModule . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / groups / GroupsModule . java 
 @ @ - 9 , 6 + 9 , 7 @ @ import java . util . HashMap ; 
 import java . util . List ; 
 
 import im . actor . core . api . ApiGroupOutPeer ; 
 + import im . actor . core . api . ApiGroupType ; 
 import im . actor . core . api . ApiOutPeer ; 
 import im . actor . core . api . ApiPeerType ; 
 import im . actor . core . api . ApiUserOutPeer ; 
 @ @ - 109 , 7 + 110 , 16 @ @ public class GroupsModule extends AbsModule implements BusSubscriber { 
 / / Actions 
 / / 
 
 - public Promise < Integer > createGroup ( final String title , final String avatarDescriptor , final int [ ] uids ) { 
 + public Promise < Integer > createGroup ( String title , String avatarDescriptor , int [ ] uids ) { 
 + return createGroup ( title , avatarDescriptor , uids , ApiGroupType . GROUP ) ; 
 + } 
 + 
 + public Promise < Integer > createChannel ( String title , String avatarDescriptor ) { 
 + return createGroup ( title , avatarDescriptor , new int [ 0 ] , ApiGroupType . CHANNEL ) ; 
 + } 
 + 
 + private Promise < Integer > createGroup ( String title , String avatarDescriptor , int [ ] uids , 
 + ApiGroupType groupType ) { 
 long rid = RandomUtils . nextRid ( ) ; 
 return Promise . success ( uids ) 
 . map ( ( Function < int [ ] , List < ApiUserOutPeer > > ) ints - > { 
 @ @ - 124 , 7 + 134 , 7 @ @ public class GroupsModule extends AbsModule implements BusSubscriber { 
 } ) 
 . flatMap ( apiUserOutPeers - > 
 api ( new RequestCreateGroup ( rid , title , apiUserOutPeers , 
 - null , ApiSupportConfiguration . OPTIMIZATIONS ) ) ) 
 + groupType , ApiSupportConfiguration . OPTIMIZATIONS ) ) ) 
 . chain ( r - > updates ( ) . applyRelatedData ( r . getUsers ( ) , r . getGroup ( ) ) ) 
 . chain ( r - > updates ( ) . waitForUpdate ( r . getSeq ( ) ) ) 
 . map ( r - > r . getGroup ( ) . getId ( ) ) 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / viewmodel / GroupVM . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / viewmodel / GroupVM . java 
 index 43bcf90 . . cb8626a 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / viewmodel / GroupVM . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / viewmodel / GroupVM . java 
 @ @ - 15 , 6 + 15 , 7 @ @ import java . util . HashSet ; 
 
 import im . actor . core . entity . Group ; 
 import im . actor . core . entity . GroupMember ; 
 + import im . actor . core . entity . GroupType ; 
 import im . actor . core . viewmodel . generics . AvatarValueModel ; 
 import im . actor . core . viewmodel . generics . BooleanValueModel ; 
 import im . actor . core . viewmodel . generics . IntValueModel ; 
 @ @ - 36 , 6 + 37 , 9 @ @ public class GroupVM extends BaseValueModel < Group > { 
 private int groupId ; 
 @ NotNull 
 @ Property ( " nonatomic , readonly " ) 
 + private GroupType groupType ; 
 + @ NotNull 
 + @ Property ( " nonatomic , readonly " ) 
 private StringValueModel name ; 
 @ NotNull 
 @ Property ( " nonatomic , readonly " ) 
 @ @ - 78 , 6 + 82 , 7 @ @ public class GroupVM extends BaseValueModel < Group > { 
 public GroupVM ( @ NotNull Group rawObj ) { 
 super ( rawObj ) ; 
 this . groupId = rawObj . getGroupId ( ) ; 
 + this . groupType = rawObj . getGroupType ( ) ; 
 this . name = new StringValueModel ( " group . " + groupId + " . title " , rawObj . getTitle ( ) ) ; 
 this . avatar = new AvatarValueModel ( " group . " + groupId + " . avatar " , rawObj . getAvatar ( ) ) ; 
 this . isMember = new BooleanValueModel ( " group . " + groupId + " . isMember " , rawObj . isMember ( ) ) ; 
 @ @ - 102 , 6 + 107 , 17 @ @ public class GroupVM extends BaseValueModel < Group > { 
 } 
 
 / * * 
 + * Get Group Type 
 + * 
 + * @ return Group Type 
 + * / 
 + @ NotNull 
 + @ ObjectiveCName ( " getGroupType " ) 
 + public GroupType getGroupType ( ) { 
 + return groupType ; 
 + } 
 + 
 + / * * 
 * Get Name Value Model 
 * 
 * @ return Value Model of String 
 @ @ - 194 , 6 + 210 , 7 @ @ public class GroupVM extends BaseValueModel < Group > { 
 isChanged | = avatar . change ( rawObj . getAvatar ( ) ) ; 
 isChanged | = membersCount . change ( rawObj . getMembersCount ( ) ) ; 
 isChanged | = isMember . change ( rawObj . isMember ( ) ) ; 
 + isChanged | = isCanWriteMessage . change ( rawObj . isCanWrite ( ) ) ; 
 
 isChanged | = theme . change ( rawObj . getTopic ( ) ) ; 
 isChanged | = about . change ( rawObj . getAbout ( ) ) ;
