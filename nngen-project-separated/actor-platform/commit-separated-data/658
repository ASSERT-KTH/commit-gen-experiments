BLEU SCORE: 0.3303164318013807

TEST MSG: chore ( android ) : ignore write logs exceptions
GENERATED MSG: feat ( android ) : write / send logs

TEST DIFF (one line): diff - - git a / actor - sdk / sdk - core / runtime / runtime - android / src / main / java / im / actor / runtime / android / AndroidLogProvider . java b / actor - sdk / sdk - core / runtime / runtime - android / src / main / java / im / actor / runtime / android / AndroidLogProvider . java < nl > index edd0887 . . 61bb27d 100644 < nl > - - - a / actor - sdk / sdk - core / runtime / runtime - android / src / main / java / im / actor / runtime / android / AndroidLogProvider . java < nl > + + + b / actor - sdk / sdk - core / runtime / runtime - android / src / main / java / im / actor / runtime / android / AndroidLogProvider . java < nl > @ @ - 34 , 16 + 34 , 16 @ @ public class AndroidLogProvider implements LogRuntime { < nl > private static String sendLogsUrl = null ; < nl > private static SharedPreferences shp ; < nl > private static final OkHttpClient client ; < nl > + < nl > static { < nl > String name ; < nl > shp = AndroidContext . getContext ( ) . getSharedPreferences ( " properties . ini " , Context . MODE _ PRIVATE ) ; < nl > sendLogs = shp . getBoolean ( " sendLogs " , false ) ; < nl > sendLogsUrl = shp . getString ( " sendLogsUrl " , null ) ; < nl > writeLogs = shp . getBoolean ( " writeLogs " , false ) ; < nl > - if ( 0 = = Environment . getExternalStorageState ( ) . compareTo ( Environment . MEDIA _ MOUNTED ) ) { < nl > + if ( 0 = = Environment . getExternalStorageState ( ) . compareTo ( Environment . MEDIA _ MOUNTED ) ) { < nl > name = Environment . getExternalStorageDirectory ( ) . getAbsolutePath ( ) ; < nl > - } < nl > - else { < nl > + } else { < nl > name = Environment . getDataDirectory ( ) . getAbsolutePath ( ) ; < nl > } < nl > < nl > @ @ - 55 , 11 + 55 , 10 @ @ public class AndroidLogProvider implements LogRuntime { < nl > e . printStackTrace ( ) ; < nl > } < nl > < nl > - client = new OkHttpClient ( ) ; < nl > + client = new OkHttpClient ( ) ; < nl > } < nl > < nl > < nl > - < nl > @ Override < nl > public void w ( String tag , String message ) { < nl > Log . w ( tag , message ) ; < nl > @ @ - 90 , 18 + 89 , 19 @ @ public class AndroidLogProvider implements LogRuntime { < nl > sendLogs ( " w " , tag , message ) ; < nl > } < nl > < nl > - private static int i = 0 ; < nl > + private static int i = 0 ; < nl > private static String s = " " ; < nl > - private static void sendLogs ( String level , String tag , String msg ) { < nl > - if ( sendLogs & & sendLogsUrl ! = null ) { < nl > - if ( i = = 0 ) { < nl > - s = s . concat ( " ` ` ` " ) ; < nl > + < nl > + private static void sendLogs ( String level , String tag , String msg ) { < nl > + if ( sendLogs & & sendLogsUrl ! = null ) { < nl > + if ( i = = 0 ) { < nl > + s = s . concat ( " ` ` ` " ) ; < nl > } < nl > < nl > - s = s . concat ( " \ n " ) . concat ( level ) . concat ( " " ) . concat ( tag ) . concat ( " : " ) . concat ( msg ) ; < nl > + s = s . concat ( " \ n " ) . concat ( level ) . concat ( " " ) . concat ( tag ) . concat ( " : " ) . concat ( msg ) ; < nl > < nl > - if ( i = = 19 ) { < nl > - s = s . concat ( " ` ` ` " ) ; < nl > + if ( i = = 19 ) { < nl > + s = s . concat ( " ` ` ` " ) ; < nl > JSONObject json = new JSONObject ( ) ; < nl > try { < nl > json . put ( " text " , s ) ; < nl > @ @ - 125 , 22 + 125 , 19 @ @ public class AndroidLogProvider implements LogRuntime { < nl > < nl > s = " " ; < nl > i = 0 ; < nl > - } else { < nl > + } else { < nl > i + + ; < nl > } < nl > < nl > } < nl > } < nl > < nl > - private static void writeToFile ( java . util . logging . Level level , String tag , String msg ) { < nl > - if ( writeLogs ) { < nl > + private static void writeToFile ( java . util . logging . Level level , String tag , String msg ) { < nl > + if ( writeLogs ) { < nl > try { < nl > fileHandler . setFormatter ( new SimpleFormatter ( ) ) ; < nl > - fileHandler . publish ( new LogRecord ( level , tag + " : " + msg ) ) ; < nl > - } catch ( Exception e ) < nl > - { < nl > - Log . e ( " MyLog " , " FileHandler exception " , e ) ; < nl > - return ; < nl > + fileHandler . publish ( new LogRecord ( level , tag + " : " + msg ) ) ; < nl > + } catch ( Exception e ) { < nl > } < nl > } < nl > < nl > @ @ - 153 , 7 + 150 , 7 @ @ public class AndroidLogProvider implements LogRuntime { < nl > } < nl > < nl > public static void setSendLogs ( String sendLogsUrl ) { < nl > - AndroidLogProvider . sendLogs = sendLogsUrl ! = null ; < nl > + AndroidLogProvider . sendLogs = sendLogsUrl ! = null ; < nl > AndroidLogProvider . sendLogsUrl = sendLogsUrl ; < nl > shp . edit ( ) . putString ( " sendLogsUrl " , sendLogsUrl ) . apply ( ) ; < nl > shp . edit ( ) . putBoolean ( " sendLogs " , sendLogs ) . apply ( ) ;
NEAREST DIFF (one line): diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / settings / ActorSettingsFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / settings / ActorSettingsFragment . java < nl > index 4818849 . . 3aa465b 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / settings / ActorSettingsFragment . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / settings / ActorSettingsFragment . java < nl > @ @ - 3 , 9 + 3 , 6 @ @ package im . actor . sdk . controllers . fragment . settings ; < nl > import android . content . Context ; < nl > import android . view . View ; < nl > < nl > - / * * < nl > - * Created by root on 11 / 12 / 15 . < nl > - * / < nl > public class ActorSettingsFragment extends BaseActorSettingsFragment { < nl > @ Override < nl > public View getBeforeNickSettingsView ( ) { < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / settings / BaseActorSettingsFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / settings / BaseActorSettingsFragment . java < nl > index a1b440c . . 5a7d993 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / settings / BaseActorSettingsFragment . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / settings / BaseActorSettingsFragment . java < nl > @ @ - 12 , 6 + 12 , 7 @ @ import android . graphics . drawable . ColorDrawable ; < nl > import android . net . Uri ; < nl > import android . os . Bundle ; < nl > import android . support . v7 . app . ActionBar ; < nl > + import android . text . InputType ; < nl > import android . text . TextUtils ; < nl > import android . view . LayoutInflater ; < nl > import android . view . Menu ; < nl > @ @ - 20 , 6 + 21 , 8 @ @ import android . view . MenuItem ; < nl > import android . view . View ; < nl > import android . view . ViewGroup ; < nl > import android . view . ViewTreeObserver ; < nl > + import android . view . inputmethod . InputMethodManager ; < nl > + import android . widget . EditText ; < nl > import android . widget . FrameLayout ; < nl > import android . widget . ImageView ; < nl > import android . widget . LinearLayout ; < nl > @ @ - 39 , 6 + 42 , 7 @ @ import im . actor . core . viewmodel . UserPhone ; < nl > import im . actor . core . viewmodel . UserVM ; < nl > import im . actor . core . viewmodel . generics . ArrayListUserEmail ; < nl > import im . actor . core . viewmodel . generics . ArrayListUserPhone ; < nl > + import im . actor . runtime . android . AndroidLogProvider ; < nl > import im . actor . sdk . ActorSDK ; < nl > import im . actor . sdk . ActorStyle ; < nl > import im . actor . sdk . R ; < nl > @ @ - 360 , 6 + 364 , 56 @ @ public abstract class BaseActorSettingsFragment extends BaseFragment implements < nl > } < nl > } ) ; < nl > < nl > + view . findViewById ( R . id . encryption ) . setOnLongClickListener ( new View . OnLongClickListener ( ) { < nl > + @ Override < nl > + public boolean onLongClick ( View v ) { < nl > + if ( AndroidLogProvider . isSendLogsEnabled ( ) ) { < nl > + AndroidLogProvider . setSendLogs ( null ) ; < nl > + Toast . makeText ( getActivity ( ) , " send logs off " , Toast . LENGTH _ LONG ) . show ( ) ; < nl > + } else { < nl > + < nl > + android . support . v7 . app . AlertDialog . Builder builder = new android . support . v7 . app . AlertDialog . Builder ( getActivity ( ) ) ; < nl > + builder . setTitle ( " Send logs integration url " ) ; < nl > + < nl > + LinearLayout ll = new LinearLayout ( getActivity ( ) ) ; < nl > + ll . setPadding ( Screen . dp ( 20 ) , 0 , Screen . dp ( 20 ) , 0 ) ; < nl > + < nl > + final EditText input = new EditText ( getActivity ( ) ) ; < nl > + ll . addView ( input , LinearLayout . LayoutParams . MATCH _ PARENT , LinearLayout . LayoutParams . WRAP _ CONTENT ) ; < nl > + builder . setView ( ll ) ; < nl > + < nl > + builder . setPositiveButton ( getString ( R . string . dialog _ ok ) , new DialogInterface . OnClickListener ( ) { < nl > + @ Override < nl > + public void onClick ( DialogInterface dialog , int which ) { < nl > + AndroidLogProvider . setSendLogs ( input . getText ( ) . toString ( ) ) ; < nl > + Toast . makeText ( getActivity ( ) , " send logs on " , Toast . LENGTH _ LONG ) . show ( ) ; < nl > + < nl > + } < nl > + } ) ; < nl > + builder . setNegativeButton ( R . string . dialog _ cancel , new DialogInterface . OnClickListener ( ) { < nl > + @ Override < nl > + public void onClick ( DialogInterface dialog , int which ) { < nl > + dialog . cancel ( ) ; < nl > + } < nl > + } ) ; < nl > + < nl > + builder . create ( ) . show ( ) ; < nl > + < nl > + < nl > + } < nl > + return true ; < nl > + } < nl > + } ) ; < nl > + < nl > + < nl > + view . findViewById ( R . id . chatSettings ) . setOnLongClickListener ( new View . OnLongClickListener ( ) { < nl > + @ Override < nl > + public boolean onLongClick ( View v ) { < nl > + Toast . makeText ( getActivity ( ) , AndroidLogProvider . toggleWriteLogs ( ) ? " write logs on " : " write logs off " , Toast . LENGTH _ LONG ) . show ( ) ; < nl > + return true ; < nl > + } < nl > + } ) ; < nl > + < nl > View askQuestion = view . findViewById ( R . id . askQuestion ) ; < nl > < nl > if ( ActorSDK . sharedActor ( ) . getHelpPhone ( ) = = null | | ActorSDK . sharedActor ( ) . getHelpPhone ( ) . isEmpty ( ) ) { < nl > diff - - git a / actor - sdk / sdk - core / runtime / runtime - android / src / main / java / im / actor / runtime / android / AndroidLogProvider . java b / actor - sdk / sdk - core / runtime / runtime - android / src / main / java / im / actor / runtime / android / AndroidLogProvider . java < nl > index 817bba8 . . edd0887 100644 < nl > - - - a / actor - sdk / sdk - core / runtime / runtime - android / src / main / java / im / actor / runtime / android / AndroidLogProvider . java < nl > + + + b / actor - sdk / sdk - core / runtime / runtime - android / src / main / java / im / actor / runtime / android / AndroidLogProvider . java < nl > @ @ - 4 , 28 + 4 , 162 @ @ < nl > < nl > package im . actor . runtime . android ; < nl > < nl > + import android . content . Context ; < nl > + import android . content . SharedPreferences ; < nl > + import android . os . Environment ; < nl > import android . util . Log ; < nl > < nl > + import com . squareup . okhttp . Callback ; < nl > + import com . squareup . okhttp . MediaType ; < nl > + import com . squareup . okhttp . OkHttpClient ; < nl > + import com . squareup . okhttp . Request ; < nl > + import com . squareup . okhttp . RequestBody ; < nl > + import com . squareup . okhttp . Response ; < nl > + < nl > + import java . io . IOException ; < nl > + import java . util . logging . FileHandler ; < nl > + import java . util . logging . Level ; < nl > + import java . util . logging . LogRecord ; < nl > + import java . util . logging . SimpleFormatter ; < nl > + < nl > import im . actor . runtime . LogRuntime ; < nl > + import im . actor . runtime . json . JSONException ; < nl > + import im . actor . runtime . json . JSONObject ; < nl > < nl > public class AndroidLogProvider implements LogRuntime { < nl > + < nl > + private static FileHandler fileHandler ; < nl > + private static boolean writeLogs ; < nl > + private static boolean sendLogs ; < nl > + private static String sendLogsUrl = null ; < nl > + private static SharedPreferences shp ; < nl > + private static final OkHttpClient client ; < nl > + static { < nl > + String name ; < nl > + shp = AndroidContext . getContext ( ) . getSharedPreferences ( " properties . ini " , Context . MODE _ PRIVATE ) ; < nl > + sendLogs = shp . getBoolean ( " sendLogs " , false ) ; < nl > + sendLogsUrl = shp . getString ( " sendLogsUrl " , null ) ; < nl > + writeLogs = shp . getBoolean ( " writeLogs " , false ) ; < nl > + if ( 0 = = Environment . getExternalStorageState ( ) . compareTo ( Environment . MEDIA _ MOUNTED ) ) { < nl > + name = Environment . getExternalStorageDirectory ( ) . getAbsolutePath ( ) ; < nl > + } < nl > + else { < nl > + name = Environment . getDataDirectory ( ) . getAbsolutePath ( ) ; < nl > + } < nl > + < nl > + name + = " / actorlogs % g _ % u . log " ; < nl > + < nl > + try { < nl > + fileHandler = new FileHandler ( name , 256 * 1024 , 10 , true ) ; < nl > + } catch ( IOException e ) { < nl > + e . printStackTrace ( ) ; < nl > + } < nl > + < nl > + client = new OkHttpClient ( ) ; < nl > + } < nl > + < nl > + < nl > + < nl > @ Override < nl > public void w ( String tag , String message ) { < nl > Log . w ( tag , message ) ; < nl > + writeToFile ( Level . WARNING , tag , message ) ; < nl > + sendLogs ( " w " , tag , message ) ; < nl > } < nl > < nl > @ Override < nl > public void e ( String tag , Throwable throwable ) { < nl > Log . e ( tag , " " , throwable ) ; < nl > + writeToFile ( Level . WARNING , tag , throwable . getMessage ( ) ) ; < nl > + sendLogs ( " w " , tag , throwable . getMessage ( ) ) ; < nl > + < nl > } < nl > < nl > @ Override < nl > public void d ( String tag , String message ) { < nl > Log . d ( tag , message ) ; < nl > + writeToFile ( Level . INFO , tag , message ) ; < nl > + sendLogs ( " w " , tag , message ) ; < nl > + < nl > } < nl > < nl > @ Override < nl > public void v ( String tag , String message ) { < nl > Log . v ( tag , message ) ; < nl > + writeToFile ( Level . ALL , tag , message ) ; < nl > + sendLogs ( " w " , tag , message ) ; < nl > + } < nl > + < nl > + private static int i = 0 ; < nl > + private static String s = " " ; < nl > + private static void sendLogs ( String level , String tag , String msg ) { < nl > + if ( sendLogs & & sendLogsUrl ! = null ) { < nl > + if ( i = = 0 ) { < nl > + s = s . concat ( " ` ` ` " ) ; < nl > + } < nl > + < nl > + s = s . concat ( " \ n " ) . concat ( level ) . concat ( " " ) . concat ( tag ) . concat ( " : " ) . concat ( msg ) ; < nl > + < nl > + if ( i = = 19 ) { < nl > + s = s . concat ( " ` ` ` " ) ; < nl > + JSONObject json = new JSONObject ( ) ; < nl > + try { < nl > + json . put ( " text " , s ) ; < nl > + final Request request = new Request . Builder ( ) < nl > + . url ( sendLogsUrl ) < nl > + . post ( RequestBody . create ( null , json . toString ( ) ) ) < nl > + . build ( ) ; < nl > + client . newCall ( request ) . enqueue ( new Callback ( ) { < nl > + @ Override < nl > + public void onFailure ( Request request , IOException e ) { < nl > + < nl > + } < nl > + < nl > + @ Override < nl > + public void onResponse ( Response response ) throws IOException { < nl > + < nl > + } < nl > + } ) ; < nl > + } catch ( JSONException e ) { < nl > + } < nl > + < nl > + s = " " ; < nl > + i = 0 ; < nl > + } else { < nl > + i + + ; < nl > + } < nl > + < nl > + } < nl > + } < nl > + < nl > + private static void writeToFile ( java . util . logging . Level level , String tag , String msg ) { < nl > + if ( writeLogs ) { < nl > + try { < nl > + fileHandler . setFormatter ( new SimpleFormatter ( ) ) ; < nl > + fileHandler . publish ( new LogRecord ( level , tag + " : " + msg ) ) ; < nl > + } catch ( Exception e ) < nl > + { < nl > + Log . e ( " MyLog " , " FileHandler exception " , e ) ; < nl > + return ; < nl > + } < nl > + } < nl > + < nl > + } < nl > + < nl > + public static boolean toggleWriteLogs ( ) { < nl > + AndroidLogProvider . writeLogs = ! writeLogs ; < nl > + shp . edit ( ) . putBoolean ( " writeLogs " , writeLogs ) . apply ( ) ; < nl > + return writeLogs ; < nl > + } < nl > + < nl > + public static void setSendLogs ( String sendLogsUrl ) { < nl > + AndroidLogProvider . sendLogs = sendLogsUrl ! = null ; < nl > + AndroidLogProvider . sendLogsUrl = sendLogsUrl ; < nl > + shp . edit ( ) . putString ( " sendLogsUrl " , sendLogsUrl ) . apply ( ) ; < nl > + shp . edit ( ) . putBoolean ( " sendLogs " , sendLogs ) . apply ( ) ; < nl > + } < nl > + < nl > + public static boolean isSendLogsEnabled ( ) { < nl > + return sendLogs ; < nl > } < nl > }

TEST DIFF:
diff - - git a / actor - sdk / sdk - core / runtime / runtime - android / src / main / java / im / actor / runtime / android / AndroidLogProvider . java b / actor - sdk / sdk - core / runtime / runtime - android / src / main / java / im / actor / runtime / android / AndroidLogProvider . java 
 index edd0887 . . 61bb27d 100644 
 - - - a / actor - sdk / sdk - core / runtime / runtime - android / src / main / java / im / actor / runtime / android / AndroidLogProvider . java 
 + + + b / actor - sdk / sdk - core / runtime / runtime - android / src / main / java / im / actor / runtime / android / AndroidLogProvider . java 
 @ @ - 34 , 16 + 34 , 16 @ @ public class AndroidLogProvider implements LogRuntime { 
 private static String sendLogsUrl = null ; 
 private static SharedPreferences shp ; 
 private static final OkHttpClient client ; 
 + 
 static { 
 String name ; 
 shp = AndroidContext . getContext ( ) . getSharedPreferences ( " properties . ini " , Context . MODE _ PRIVATE ) ; 
 sendLogs = shp . getBoolean ( " sendLogs " , false ) ; 
 sendLogsUrl = shp . getString ( " sendLogsUrl " , null ) ; 
 writeLogs = shp . getBoolean ( " writeLogs " , false ) ; 
 - if ( 0 = = Environment . getExternalStorageState ( ) . compareTo ( Environment . MEDIA _ MOUNTED ) ) { 
 + if ( 0 = = Environment . getExternalStorageState ( ) . compareTo ( Environment . MEDIA _ MOUNTED ) ) { 
 name = Environment . getExternalStorageDirectory ( ) . getAbsolutePath ( ) ; 
 - } 
 - else { 
 + } else { 
 name = Environment . getDataDirectory ( ) . getAbsolutePath ( ) ; 
 } 
 
 @ @ - 55 , 11 + 55 , 10 @ @ public class AndroidLogProvider implements LogRuntime { 
 e . printStackTrace ( ) ; 
 } 
 
 - client = new OkHttpClient ( ) ; 
 + client = new OkHttpClient ( ) ; 
 } 
 
 
 - 
 @ Override 
 public void w ( String tag , String message ) { 
 Log . w ( tag , message ) ; 
 @ @ - 90 , 18 + 89 , 19 @ @ public class AndroidLogProvider implements LogRuntime { 
 sendLogs ( " w " , tag , message ) ; 
 } 
 
 - private static int i = 0 ; 
 + private static int i = 0 ; 
 private static String s = " " ; 
 - private static void sendLogs ( String level , String tag , String msg ) { 
 - if ( sendLogs & & sendLogsUrl ! = null ) { 
 - if ( i = = 0 ) { 
 - s = s . concat ( " ` ` ` " ) ; 
 + 
 + private static void sendLogs ( String level , String tag , String msg ) { 
 + if ( sendLogs & & sendLogsUrl ! = null ) { 
 + if ( i = = 0 ) { 
 + s = s . concat ( " ` ` ` " ) ; 
 } 
 
 - s = s . concat ( " \ n " ) . concat ( level ) . concat ( " " ) . concat ( tag ) . concat ( " : " ) . concat ( msg ) ; 
 + s = s . concat ( " \ n " ) . concat ( level ) . concat ( " " ) . concat ( tag ) . concat ( " : " ) . concat ( msg ) ; 
 
 - if ( i = = 19 ) { 
 - s = s . concat ( " ` ` ` " ) ; 
 + if ( i = = 19 ) { 
 + s = s . concat ( " ` ` ` " ) ; 
 JSONObject json = new JSONObject ( ) ; 
 try { 
 json . put ( " text " , s ) ; 
 @ @ - 125 , 22 + 125 , 19 @ @ public class AndroidLogProvider implements LogRuntime { 
 
 s = " " ; 
 i = 0 ; 
 - } else { 
 + } else { 
 i + + ; 
 } 
 
 } 
 } 
 
 - private static void writeToFile ( java . util . logging . Level level , String tag , String msg ) { 
 - if ( writeLogs ) { 
 + private static void writeToFile ( java . util . logging . Level level , String tag , String msg ) { 
 + if ( writeLogs ) { 
 try { 
 fileHandler . setFormatter ( new SimpleFormatter ( ) ) ; 
 - fileHandler . publish ( new LogRecord ( level , tag + " : " + msg ) ) ; 
 - } catch ( Exception e ) 
 - { 
 - Log . e ( " MyLog " , " FileHandler exception " , e ) ; 
 - return ; 
 + fileHandler . publish ( new LogRecord ( level , tag + " : " + msg ) ) ; 
 + } catch ( Exception e ) { 
 } 
 } 
 
 @ @ - 153 , 7 + 150 , 7 @ @ public class AndroidLogProvider implements LogRuntime { 
 } 
 
 public static void setSendLogs ( String sendLogsUrl ) { 
 - AndroidLogProvider . sendLogs = sendLogsUrl ! = null ; 
 + AndroidLogProvider . sendLogs = sendLogsUrl ! = null ; 
 AndroidLogProvider . sendLogsUrl = sendLogsUrl ; 
 shp . edit ( ) . putString ( " sendLogsUrl " , sendLogsUrl ) . apply ( ) ; 
 shp . edit ( ) . putBoolean ( " sendLogs " , sendLogs ) . apply ( ) ;

NEAREST DIFF:
diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / settings / ActorSettingsFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / settings / ActorSettingsFragment . java 
 index 4818849 . . 3aa465b 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / settings / ActorSettingsFragment . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / settings / ActorSettingsFragment . java 
 @ @ - 3 , 9 + 3 , 6 @ @ package im . actor . sdk . controllers . fragment . settings ; 
 import android . content . Context ; 
 import android . view . View ; 
 
 - / * * 
 - * Created by root on 11 / 12 / 15 . 
 - * / 
 public class ActorSettingsFragment extends BaseActorSettingsFragment { 
 @ Override 
 public View getBeforeNickSettingsView ( ) { 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / settings / BaseActorSettingsFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / settings / BaseActorSettingsFragment . java 
 index a1b440c . . 5a7d993 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / settings / BaseActorSettingsFragment . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / settings / BaseActorSettingsFragment . java 
 @ @ - 12 , 6 + 12 , 7 @ @ import android . graphics . drawable . ColorDrawable ; 
 import android . net . Uri ; 
 import android . os . Bundle ; 
 import android . support . v7 . app . ActionBar ; 
 + import android . text . InputType ; 
 import android . text . TextUtils ; 
 import android . view . LayoutInflater ; 
 import android . view . Menu ; 
 @ @ - 20 , 6 + 21 , 8 @ @ import android . view . MenuItem ; 
 import android . view . View ; 
 import android . view . ViewGroup ; 
 import android . view . ViewTreeObserver ; 
 + import android . view . inputmethod . InputMethodManager ; 
 + import android . widget . EditText ; 
 import android . widget . FrameLayout ; 
 import android . widget . ImageView ; 
 import android . widget . LinearLayout ; 
 @ @ - 39 , 6 + 42 , 7 @ @ import im . actor . core . viewmodel . UserPhone ; 
 import im . actor . core . viewmodel . UserVM ; 
 import im . actor . core . viewmodel . generics . ArrayListUserEmail ; 
 import im . actor . core . viewmodel . generics . ArrayListUserPhone ; 
 + import im . actor . runtime . android . AndroidLogProvider ; 
 import im . actor . sdk . ActorSDK ; 
 import im . actor . sdk . ActorStyle ; 
 import im . actor . sdk . R ; 
 @ @ - 360 , 6 + 364 , 56 @ @ public abstract class BaseActorSettingsFragment extends BaseFragment implements 
 } 
 } ) ; 
 
 + view . findViewById ( R . id . encryption ) . setOnLongClickListener ( new View . OnLongClickListener ( ) { 
 + @ Override 
 + public boolean onLongClick ( View v ) { 
 + if ( AndroidLogProvider . isSendLogsEnabled ( ) ) { 
 + AndroidLogProvider . setSendLogs ( null ) ; 
 + Toast . makeText ( getActivity ( ) , " send logs off " , Toast . LENGTH _ LONG ) . show ( ) ; 
 + } else { 
 + 
 + android . support . v7 . app . AlertDialog . Builder builder = new android . support . v7 . app . AlertDialog . Builder ( getActivity ( ) ) ; 
 + builder . setTitle ( " Send logs integration url " ) ; 
 + 
 + LinearLayout ll = new LinearLayout ( getActivity ( ) ) ; 
 + ll . setPadding ( Screen . dp ( 20 ) , 0 , Screen . dp ( 20 ) , 0 ) ; 
 + 
 + final EditText input = new EditText ( getActivity ( ) ) ; 
 + ll . addView ( input , LinearLayout . LayoutParams . MATCH _ PARENT , LinearLayout . LayoutParams . WRAP _ CONTENT ) ; 
 + builder . setView ( ll ) ; 
 + 
 + builder . setPositiveButton ( getString ( R . string . dialog _ ok ) , new DialogInterface . OnClickListener ( ) { 
 + @ Override 
 + public void onClick ( DialogInterface dialog , int which ) { 
 + AndroidLogProvider . setSendLogs ( input . getText ( ) . toString ( ) ) ; 
 + Toast . makeText ( getActivity ( ) , " send logs on " , Toast . LENGTH _ LONG ) . show ( ) ; 
 + 
 + } 
 + } ) ; 
 + builder . setNegativeButton ( R . string . dialog _ cancel , new DialogInterface . OnClickListener ( ) { 
 + @ Override 
 + public void onClick ( DialogInterface dialog , int which ) { 
 + dialog . cancel ( ) ; 
 + } 
 + } ) ; 
 + 
 + builder . create ( ) . show ( ) ; 
 + 
 + 
 + } 
 + return true ; 
 + } 
 + } ) ; 
 + 
 + 
 + view . findViewById ( R . id . chatSettings ) . setOnLongClickListener ( new View . OnLongClickListener ( ) { 
 + @ Override 
 + public boolean onLongClick ( View v ) { 
 + Toast . makeText ( getActivity ( ) , AndroidLogProvider . toggleWriteLogs ( ) ? " write logs on " : " write logs off " , Toast . LENGTH _ LONG ) . show ( ) ; 
 + return true ; 
 + } 
 + } ) ; 
 + 
 View askQuestion = view . findViewById ( R . id . askQuestion ) ; 
 
 if ( ActorSDK . sharedActor ( ) . getHelpPhone ( ) = = null | | ActorSDK . sharedActor ( ) . getHelpPhone ( ) . isEmpty ( ) ) { 
 diff - - git a / actor - sdk / sdk - core / runtime / runtime - android / src / main / java / im / actor / runtime / android / AndroidLogProvider . java b / actor - sdk / sdk - core / runtime / runtime - android / src / main / java / im / actor / runtime / android / AndroidLogProvider . java 
 index 817bba8 . . edd0887 100644 
 - - - a / actor - sdk / sdk - core / runtime / runtime - android / src / main / java / im / actor / runtime / android / AndroidLogProvider . java 
 + + + b / actor - sdk / sdk - core / runtime / runtime - android / src / main / java / im / actor / runtime / android / AndroidLogProvider . java 
 @ @ - 4 , 28 + 4 , 162 @ @ 
 
 package im . actor . runtime . android ; 
 
 + import android . content . Context ; 
 + import android . content . SharedPreferences ; 
 + import android . os . Environment ; 
 import android . util . Log ; 
 
 + import com . squareup . okhttp . Callback ; 
 + import com . squareup . okhttp . MediaType ; 
 + import com . squareup . okhttp . OkHttpClient ; 
 + import com . squareup . okhttp . Request ; 
 + import com . squareup . okhttp . RequestBody ; 
 + import com . squareup . okhttp . Response ; 
 + 
 + import java . io . IOException ; 
 + import java . util . logging . FileHandler ; 
 + import java . util . logging . Level ; 
 + import java . util . logging . LogRecord ; 
 + import java . util . logging . SimpleFormatter ; 
 + 
 import im . actor . runtime . LogRuntime ; 
 + import im . actor . runtime . json . JSONException ; 
 + import im . actor . runtime . json . JSONObject ; 
 
 public class AndroidLogProvider implements LogRuntime { 
 + 
 + private static FileHandler fileHandler ; 
 + private static boolean writeLogs ; 
 + private static boolean sendLogs ; 
 + private static String sendLogsUrl = null ; 
 + private static SharedPreferences shp ; 
 + private static final OkHttpClient client ; 
 + static { 
 + String name ; 
 + shp = AndroidContext . getContext ( ) . getSharedPreferences ( " properties . ini " , Context . MODE _ PRIVATE ) ; 
 + sendLogs = shp . getBoolean ( " sendLogs " , false ) ; 
 + sendLogsUrl = shp . getString ( " sendLogsUrl " , null ) ; 
 + writeLogs = shp . getBoolean ( " writeLogs " , false ) ; 
 + if ( 0 = = Environment . getExternalStorageState ( ) . compareTo ( Environment . MEDIA _ MOUNTED ) ) { 
 + name = Environment . getExternalStorageDirectory ( ) . getAbsolutePath ( ) ; 
 + } 
 + else { 
 + name = Environment . getDataDirectory ( ) . getAbsolutePath ( ) ; 
 + } 
 + 
 + name + = " / actorlogs % g _ % u . log " ; 
 + 
 + try { 
 + fileHandler = new FileHandler ( name , 256 * 1024 , 10 , true ) ; 
 + } catch ( IOException e ) { 
 + e . printStackTrace ( ) ; 
 + } 
 + 
 + client = new OkHttpClient ( ) ; 
 + } 
 + 
 + 
 + 
 @ Override 
 public void w ( String tag , String message ) { 
 Log . w ( tag , message ) ; 
 + writeToFile ( Level . WARNING , tag , message ) ; 
 + sendLogs ( " w " , tag , message ) ; 
 } 
 
 @ Override 
 public void e ( String tag , Throwable throwable ) { 
 Log . e ( tag , " " , throwable ) ; 
 + writeToFile ( Level . WARNING , tag , throwable . getMessage ( ) ) ; 
 + sendLogs ( " w " , tag , throwable . getMessage ( ) ) ; 
 + 
 } 
 
 @ Override 
 public void d ( String tag , String message ) { 
 Log . d ( tag , message ) ; 
 + writeToFile ( Level . INFO , tag , message ) ; 
 + sendLogs ( " w " , tag , message ) ; 
 + 
 } 
 
 @ Override 
 public void v ( String tag , String message ) { 
 Log . v ( tag , message ) ; 
 + writeToFile ( Level . ALL , tag , message ) ; 
 + sendLogs ( " w " , tag , message ) ; 
 + } 
 + 
 + private static int i = 0 ; 
 + private static String s = " " ; 
 + private static void sendLogs ( String level , String tag , String msg ) { 
 + if ( sendLogs & & sendLogsUrl ! = null ) { 
 + if ( i = = 0 ) { 
 + s = s . concat ( " ` ` ` " ) ; 
 + } 
 + 
 + s = s . concat ( " \ n " ) . concat ( level ) . concat ( " " ) . concat ( tag ) . concat ( " : " ) . concat ( msg ) ; 
 + 
 + if ( i = = 19 ) { 
 + s = s . concat ( " ` ` ` " ) ; 
 + JSONObject json = new JSONObject ( ) ; 
 + try { 
 + json . put ( " text " , s ) ; 
 + final Request request = new Request . Builder ( ) 
 + . url ( sendLogsUrl ) 
 + . post ( RequestBody . create ( null , json . toString ( ) ) ) 
 + . build ( ) ; 
 + client . newCall ( request ) . enqueue ( new Callback ( ) { 
 + @ Override 
 + public void onFailure ( Request request , IOException e ) { 
 + 
 + } 
 + 
 + @ Override 
 + public void onResponse ( Response response ) throws IOException { 
 + 
 + } 
 + } ) ; 
 + } catch ( JSONException e ) { 
 + } 
 + 
 + s = " " ; 
 + i = 0 ; 
 + } else { 
 + i + + ; 
 + } 
 + 
 + } 
 + } 
 + 
 + private static void writeToFile ( java . util . logging . Level level , String tag , String msg ) { 
 + if ( writeLogs ) { 
 + try { 
 + fileHandler . setFormatter ( new SimpleFormatter ( ) ) ; 
 + fileHandler . publish ( new LogRecord ( level , tag + " : " + msg ) ) ; 
 + } catch ( Exception e ) 
 + { 
 + Log . e ( " MyLog " , " FileHandler exception " , e ) ; 
 + return ; 
 + } 
 + } 
 + 
 + } 
 + 
 + public static boolean toggleWriteLogs ( ) { 
 + AndroidLogProvider . writeLogs = ! writeLogs ; 
 + shp . edit ( ) . putBoolean ( " writeLogs " , writeLogs ) . apply ( ) ; 
 + return writeLogs ; 
 + } 
 + 
 + public static void setSendLogs ( String sendLogsUrl ) { 
 + AndroidLogProvider . sendLogs = sendLogsUrl ! = null ; 
 + AndroidLogProvider . sendLogsUrl = sendLogsUrl ; 
 + shp . edit ( ) . putString ( " sendLogsUrl " , sendLogsUrl ) . apply ( ) ; 
 + shp . edit ( ) . putBoolean ( " sendLogs " , sendLogs ) . apply ( ) ; 
 + } 
 + 
 + public static boolean isSendLogsEnabled ( ) { 
 + return sendLogs ; 
 } 
 }
