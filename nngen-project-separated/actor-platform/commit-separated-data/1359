BLEU SCORE: 0.09791289611338179

TEST MSG: feat ( android + core ) : Fixing localizations
GENERATED MSG: fix ( js ) : Fixing search binding and built - in interval . js

TEST DIFF (one line): diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / i18n / I18nEngine . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / i18n / I18nEngine . java < nl > index 690fbdd . . 43efc3a 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / i18n / I18nEngine . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / i18n / I18nEngine . java < nl > @ @ - 41 , 7 + 41 , 7 @ @ public class I18nEngine { < nl > < nl > private static final String TAG = " I18nEngine " ; < nl > < nl > - private static final String [ ] SUPPORTED _ LOCALES = new String [ ] { " Ru " , " Ar " , " Cn " , " Pt " } ; < nl > + private static final String [ ] SUPPORTED _ LOCALES = new String [ ] { " Ru " , " Ar " , " Cn " , " Pt " , " Es " } ; < nl > < nl > private final Modules modules ; < nl > private final LocaleRuntime runtime ; < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Es . properties b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Es . properties < nl > index f246705 . . 077cce4 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Es . properties < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Es . properties < nl > @ @ - 36 , 8 + 36 , 8 @ @ Contact = Contacto < nl > ContentAudio = Audio < nl > Sticker = Sticker < nl > < nl > - ServiceRegistered = Entro en Tacatap < nl > - ServiceRegisteredFull = { name } unido a la red Tacatap global < nl > + ServiceRegistered = Entro en Actor < nl > + ServiceRegisteredFull = { name } unido a la red Actor < nl > ServiceNewDevice = Nuevo dispositivo agregado < nl > ServiceNewDeviceFull = { name } a ñ adio nuevo dispositivo a la cuenta < nl > ServiceGroupCreated = Creaste el grupo < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / resources / Months _ Es . properties b / actor - sdk / sdk - core / core / core - shared / src / main / resources / Months _ Es . properties < nl > new file mode 100644 < nl > index 0000000 . . f5debc9 < nl > - - - / dev / null < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / resources / Months _ Es . properties < nl > @ @ - 0 , 0 + 1 , 25 @ @ < nl > + JanShort = Ene < nl > + FebShort = Feb < nl > + MarShort = Mar < nl > + AprShort = Apr < nl > + MayShort = May < nl > + JunShort = Jun < nl > + JulShort = Jul < nl > + AugShort = Ago < nl > + SepShort = Sep < nl > + OctShort = Oct < nl > + NovShort = Nov < nl > + DecShort = Dic < nl > + < nl > + JanFull = Enero < nl > + FebFull = Febrero < nl > + MarFull = Marzo < nl > + AprFull = Abril < nl > + MayFull = Mayo < nl > + JunFull = Junio < nl > + JulFull = Julio < nl > + AugFull = Agosto < nl > + SepFull = Septembre < nl > + OctFull = Octubre < nl > + NovFull = Noviembre < nl > + DecFull = Diciembre < nl > \ No newline at end of file < nl > diff - - git a / actor - sdk / sdk - core / runtime / runtime - android / src / main / java / im / actor / runtime / android / AndroidLocaleProvider . java b / actor - sdk / sdk - core / runtime / runtime - android / src / main / java / im / actor / runtime / android / AndroidLocaleProvider . java < nl > index 11eb081 . . 05b59cd 100644 < nl > - - - a / actor - sdk / sdk - core / runtime / runtime - android / src / main / java / im / actor / runtime / android / AndroidLocaleProvider . java < nl > + + + b / actor - sdk / sdk - core / runtime / runtime - android / src / main / java / im / actor / runtime / android / AndroidLocaleProvider . java < nl > @ @ - 2 , 16 + 2 , 21 @ @ package im . actor . runtime . android ; < nl > < nl > import java . text . DateFormat ; < nl > import java . util . Date ; < nl > + import java . util . Locale ; < nl > < nl > import im . actor . runtime . LocaleRuntime ; < nl > < nl > - / * * < nl > - * Created by ex3ndr on 10 . 08 . 15 . < nl > - * / < nl > public class AndroidLocaleProvider implements LocaleRuntime { < nl > < nl > @ Override < nl > public String getCurrentLocale ( ) { < nl > + Locale current = AndroidContext . getContext ( ) . getResources ( ) . getConfiguration ( ) . locale ; < nl > + if ( current ! = null ) { < nl > + String res = current . getLanguage ( ) ; < nl > + if ( res ! = null ) { < nl > + return res . substring ( 0 , 1 ) . toUpperCase ( ) + res . substring ( 1 , 2 ) . toLowerCase ( ) ; < nl > + } < nl > + } < nl > return null ; < nl > }
NEAREST DIFF (one line): diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / internal / SearchModule . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / internal / SearchModule . java < nl > index 6572049 . . 093e3a5 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / internal / SearchModule . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / internal / SearchModule . java < nl > @ @ - 38 , 6 + 38 , 7 @ @ import im . actor . core . network . RpcCallback ; < nl > import im . actor . core . network . RpcException ; < nl > import im . actor . core . viewmodel . Command ; < nl > import im . actor . core . viewmodel . CommandCallback ; < nl > + import im . actor . runtime . Log ; < nl > import im . actor . runtime . Storage ; < nl > import im . actor . runtime . actors . ActorCreator ; < nl > import im . actor . runtime . actors . ActorRef ; < nl > @ @ - 119 , 7 + 120 , 7 @ @ public class SearchModule extends AbsModule { < nl > updates ( ) . executeRelatedResponse ( response . getUsers ( ) , response . getGroups ( ) , new Runnable ( ) { < nl > @ Override < nl > public void run ( ) { < nl > - ArrayList < MessageSearchEntity > res = new ArrayList < MessageSearchEntity > ( ) ; < nl > + final ArrayList < MessageSearchEntity > res = new ArrayList < MessageSearchEntity > ( ) ; < nl > for ( ApiMessageSearchItem r : response . getSearchResults ( ) ) { < nl > ApiMessageSearchResult itm = r . getResult ( ) ; < nl > try { < nl > @ @ - 131 , 6 + 132 , 12 @ @ public class SearchModule extends AbsModule { < nl > e . printStackTrace ( ) ; < nl > } < nl > } < nl > + runOnUiThread ( new Runnable ( ) { < nl > + @ Override < nl > + public void run ( ) { < nl > + callback . onResult ( res ) ; < nl > + } < nl > + } ) ; < nl > } < nl > } ) ; < nl > } < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / updates / SequenceActor . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / updates / SequenceActor . java < nl > index e5a9f75 . . fb14eb8 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / updates / SequenceActor . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / updates / SequenceActor . java < nl > @ @ - 125 , 7 + 125 , 7 @ @ public class SequenceActor extends ModuleActor { < nl > pendingRunnables . add ( after ) ; < nl > } < nl > return ; < nl > - } else if ( u instanceof PushSeq ) { < nl > + } else if ( u instanceof PushSeq ) { < nl > PushSeq pushSeq = ( PushSeq ) u ; < nl > if ( pushSeq . seq < = this . seq ) { < nl > Log . d ( TAG , " Ignored PushSeq { seq : " + pushSeq . seq + " } " ) ; < nl > diff - - git a / actor - sdk / sdk - core / runtime / runtime - js / src / main / java / im / actor / runtime / js / threading / JsSecureInterval . java b / actor - sdk / sdk - core / runtime / runtime - js / src / main / java / im / actor / runtime / js / threading / JsSecureInterval . java < nl > index 7769a62 . . 4beb2dc 100644 < nl > - - - a / actor - sdk / sdk - core / runtime / runtime - js / src / main / java / im / actor / runtime / js / threading / JsSecureInterval . java < nl > + + + b / actor - sdk / sdk - core / runtime / runtime - js / src / main / java / im / actor / runtime / js / threading / JsSecureInterval . java < nl > @ @ - 11 , 12 + 11 , 42 @ @ import com . google . gwt . core . client . JavaScriptObject ; < nl > * that work in background tabs < nl > * / < nl > public class JsSecureInterval extends JavaScriptObject { < nl > + < nl > public static native JsSecureInterval create ( Runnable runnable ) / * - { < nl > console . warn ( " Create jsSecureInverval " ) < nl > try { < nl > if ( typeof ( Worker ) ! = = " undefined " ) { < nl > - var worker = new Worker ( " interval . js " ) ; < nl > + < nl > + var code = " var timerId ; \ n " + < nl > + " \ n " + < nl > + " self . addEventListener ( ' message ' , function ( e ) { \ n " + < nl > + " switch ( e . data . message ) { \ n " + < nl > + " case ' schedule ' : \ n " + < nl > + " if ( timerId ) { \ n " + < nl > + " clearTimeout ( timerId ) ; \ n " + < nl > + " timerId = null ; \ n " + < nl > + " } \ n " + < nl > + " timerId = setTimeout ( function ( ) { \ n " + < nl > + " self . postMessage ( ' doSchedule ' ) ; \ n " + < nl > + " } , e . data . delay ) ; \ n " + < nl > + " break ; \ n " + < nl > + " case ' cancel ' : \ n " + < nl > + " if ( timerId ) { \ n " + < nl > + " clearTimeout ( timerId ) ; \ n " + < nl > + " timerId = null ; \ n " + < nl > + " } \ n " + < nl > + " break ; \ n " + < nl > + " } ; \ n " + < nl > + " } ) ; \ n " < nl > + < nl > + var codeBlob = new Blob ( [ code ] ) ; < nl > + var codeBlobURL = window . URL . createObjectURL ( codeBlob ) ; < nl > + < nl > + var worker = new Worker ( codeBlobURL ) ; < nl > var _ runnable = runnable ; < nl > + worker . addEventListener ( ' error ' , function ( ) { < nl > + console . warn ( " Worker error " ) < nl > + } , false ) ; < nl > worker . onmessage = function ( ) { < nl > _ runnable . @ java . lang . Runnable : : run ( ) ( ) ; < nl > } ;

TEST DIFF:
diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / i18n / I18nEngine . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / i18n / I18nEngine . java 
 index 690fbdd . . 43efc3a 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / i18n / I18nEngine . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / i18n / I18nEngine . java 
 @ @ - 41 , 7 + 41 , 7 @ @ public class I18nEngine { 
 
 private static final String TAG = " I18nEngine " ; 
 
 - private static final String [ ] SUPPORTED _ LOCALES = new String [ ] { " Ru " , " Ar " , " Cn " , " Pt " } ; 
 + private static final String [ ] SUPPORTED _ LOCALES = new String [ ] { " Ru " , " Ar " , " Cn " , " Pt " , " Es " } ; 
 
 private final Modules modules ; 
 private final LocaleRuntime runtime ; 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Es . properties b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Es . properties 
 index f246705 . . 077cce4 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Es . properties 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Es . properties 
 @ @ - 36 , 8 + 36 , 8 @ @ Contact = Contacto 
 ContentAudio = Audio 
 Sticker = Sticker 
 
 - ServiceRegistered = Entro en Tacatap 
 - ServiceRegisteredFull = { name } unido a la red Tacatap global 
 + ServiceRegistered = Entro en Actor 
 + ServiceRegisteredFull = { name } unido a la red Actor 
 ServiceNewDevice = Nuevo dispositivo agregado 
 ServiceNewDeviceFull = { name } a ñ adio nuevo dispositivo a la cuenta 
 ServiceGroupCreated = Creaste el grupo 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / resources / Months _ Es . properties b / actor - sdk / sdk - core / core / core - shared / src / main / resources / Months _ Es . properties 
 new file mode 100644 
 index 0000000 . . f5debc9 
 - - - / dev / null 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / resources / Months _ Es . properties 
 @ @ - 0 , 0 + 1 , 25 @ @ 
 + JanShort = Ene 
 + FebShort = Feb 
 + MarShort = Mar 
 + AprShort = Apr 
 + MayShort = May 
 + JunShort = Jun 
 + JulShort = Jul 
 + AugShort = Ago 
 + SepShort = Sep 
 + OctShort = Oct 
 + NovShort = Nov 
 + DecShort = Dic 
 + 
 + JanFull = Enero 
 + FebFull = Febrero 
 + MarFull = Marzo 
 + AprFull = Abril 
 + MayFull = Mayo 
 + JunFull = Junio 
 + JulFull = Julio 
 + AugFull = Agosto 
 + SepFull = Septembre 
 + OctFull = Octubre 
 + NovFull = Noviembre 
 + DecFull = Diciembre 
 \ No newline at end of file 
 diff - - git a / actor - sdk / sdk - core / runtime / runtime - android / src / main / java / im / actor / runtime / android / AndroidLocaleProvider . java b / actor - sdk / sdk - core / runtime / runtime - android / src / main / java / im / actor / runtime / android / AndroidLocaleProvider . java 
 index 11eb081 . . 05b59cd 100644 
 - - - a / actor - sdk / sdk - core / runtime / runtime - android / src / main / java / im / actor / runtime / android / AndroidLocaleProvider . java 
 + + + b / actor - sdk / sdk - core / runtime / runtime - android / src / main / java / im / actor / runtime / android / AndroidLocaleProvider . java 
 @ @ - 2 , 16 + 2 , 21 @ @ package im . actor . runtime . android ; 
 
 import java . text . DateFormat ; 
 import java . util . Date ; 
 + import java . util . Locale ; 
 
 import im . actor . runtime . LocaleRuntime ; 
 
 - / * * 
 - * Created by ex3ndr on 10 . 08 . 15 . 
 - * / 
 public class AndroidLocaleProvider implements LocaleRuntime { 
 
 @ Override 
 public String getCurrentLocale ( ) { 
 + Locale current = AndroidContext . getContext ( ) . getResources ( ) . getConfiguration ( ) . locale ; 
 + if ( current ! = null ) { 
 + String res = current . getLanguage ( ) ; 
 + if ( res ! = null ) { 
 + return res . substring ( 0 , 1 ) . toUpperCase ( ) + res . substring ( 1 , 2 ) . toLowerCase ( ) ; 
 + } 
 + } 
 return null ; 
 }

NEAREST DIFF:
diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / internal / SearchModule . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / internal / SearchModule . java 
 index 6572049 . . 093e3a5 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / internal / SearchModule . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / internal / SearchModule . java 
 @ @ - 38 , 6 + 38 , 7 @ @ import im . actor . core . network . RpcCallback ; 
 import im . actor . core . network . RpcException ; 
 import im . actor . core . viewmodel . Command ; 
 import im . actor . core . viewmodel . CommandCallback ; 
 + import im . actor . runtime . Log ; 
 import im . actor . runtime . Storage ; 
 import im . actor . runtime . actors . ActorCreator ; 
 import im . actor . runtime . actors . ActorRef ; 
 @ @ - 119 , 7 + 120 , 7 @ @ public class SearchModule extends AbsModule { 
 updates ( ) . executeRelatedResponse ( response . getUsers ( ) , response . getGroups ( ) , new Runnable ( ) { 
 @ Override 
 public void run ( ) { 
 - ArrayList < MessageSearchEntity > res = new ArrayList < MessageSearchEntity > ( ) ; 
 + final ArrayList < MessageSearchEntity > res = new ArrayList < MessageSearchEntity > ( ) ; 
 for ( ApiMessageSearchItem r : response . getSearchResults ( ) ) { 
 ApiMessageSearchResult itm = r . getResult ( ) ; 
 try { 
 @ @ - 131 , 6 + 132 , 12 @ @ public class SearchModule extends AbsModule { 
 e . printStackTrace ( ) ; 
 } 
 } 
 + runOnUiThread ( new Runnable ( ) { 
 + @ Override 
 + public void run ( ) { 
 + callback . onResult ( res ) ; 
 + } 
 + } ) ; 
 } 
 } ) ; 
 } 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / updates / SequenceActor . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / updates / SequenceActor . java 
 index e5a9f75 . . fb14eb8 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / updates / SequenceActor . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / updates / SequenceActor . java 
 @ @ - 125 , 7 + 125 , 7 @ @ public class SequenceActor extends ModuleActor { 
 pendingRunnables . add ( after ) ; 
 } 
 return ; 
 - } else if ( u instanceof PushSeq ) { 
 + } else if ( u instanceof PushSeq ) { 
 PushSeq pushSeq = ( PushSeq ) u ; 
 if ( pushSeq . seq < = this . seq ) { 
 Log . d ( TAG , " Ignored PushSeq { seq : " + pushSeq . seq + " } " ) ; 
 diff - - git a / actor - sdk / sdk - core / runtime / runtime - js / src / main / java / im / actor / runtime / js / threading / JsSecureInterval . java b / actor - sdk / sdk - core / runtime / runtime - js / src / main / java / im / actor / runtime / js / threading / JsSecureInterval . java 
 index 7769a62 . . 4beb2dc 100644 
 - - - a / actor - sdk / sdk - core / runtime / runtime - js / src / main / java / im / actor / runtime / js / threading / JsSecureInterval . java 
 + + + b / actor - sdk / sdk - core / runtime / runtime - js / src / main / java / im / actor / runtime / js / threading / JsSecureInterval . java 
 @ @ - 11 , 12 + 11 , 42 @ @ import com . google . gwt . core . client . JavaScriptObject ; 
 * that work in background tabs 
 * / 
 public class JsSecureInterval extends JavaScriptObject { 
 + 
 public static native JsSecureInterval create ( Runnable runnable ) / * - { 
 console . warn ( " Create jsSecureInverval " ) 
 try { 
 if ( typeof ( Worker ) ! = = " undefined " ) { 
 - var worker = new Worker ( " interval . js " ) ; 
 + 
 + var code = " var timerId ; \ n " + 
 + " \ n " + 
 + " self . addEventListener ( ' message ' , function ( e ) { \ n " + 
 + " switch ( e . data . message ) { \ n " + 
 + " case ' schedule ' : \ n " + 
 + " if ( timerId ) { \ n " + 
 + " clearTimeout ( timerId ) ; \ n " + 
 + " timerId = null ; \ n " + 
 + " } \ n " + 
 + " timerId = setTimeout ( function ( ) { \ n " + 
 + " self . postMessage ( ' doSchedule ' ) ; \ n " + 
 + " } , e . data . delay ) ; \ n " + 
 + " break ; \ n " + 
 + " case ' cancel ' : \ n " + 
 + " if ( timerId ) { \ n " + 
 + " clearTimeout ( timerId ) ; \ n " + 
 + " timerId = null ; \ n " + 
 + " } \ n " + 
 + " break ; \ n " + 
 + " } ; \ n " + 
 + " } ) ; \ n " 
 + 
 + var codeBlob = new Blob ( [ code ] ) ; 
 + var codeBlobURL = window . URL . createObjectURL ( codeBlob ) ; 
 + 
 + var worker = new Worker ( codeBlobURL ) ; 
 var _ runnable = runnable ; 
 + worker . addEventListener ( ' error ' , function ( ) { 
 + console . warn ( " Worker error " ) 
 + } , false ) ; 
 worker . onmessage = function ( ) { 
 _ runnable . @ java . lang . Runnable : : run ( ) ( ) ; 
 } ;
