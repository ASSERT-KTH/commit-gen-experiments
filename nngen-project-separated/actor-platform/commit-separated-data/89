BLEU SCORE: 0.3050975216056289

TEST MSG: fix ( android ) : recover join link
GENERATED MSG: feat ( android ) : Removed PageView from MainActivity

TEST DIFF (one line): diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / AndroidManifest . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / AndroidManifest . xml < nl > index 4f38c4f . . aa77568 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / AndroidManifest . xml < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / AndroidManifest . xml < nl > @ @ - 67 , 51 + 67 , 37 @ @ < nl > android : label = " @ string / app _ name " < nl > android : launchMode = " singleTop " < nl > android : theme = " @ style / MainActivityTheme " < nl > - android : windowSoftInputMode = " adjustPan " / > < nl > - < nl > - < activity < nl > - android : name = " . controllers . share . ShareActivity " < nl > - android : configChanges = " keyboard | keyboardHidden | orientation | screenSize " < nl > - android : label = " @ string / app _ name " < nl > - android : theme = " @ style / MainActivityTheme " < nl > - android : windowSoftInputMode = " adjustResize " > < nl > - < nl > + android : windowSoftInputMode = " adjustPan " > < nl > < intent - filter > < nl > < action android : name = " android . intent . action . VIEW " / > < nl > - < nl > < category android : name = " android . intent . category . BROWSABLE " / > < nl > < category android : name = " android . intent . category . DEFAULT " / > < nl > < nl > < data < nl > - android : host = " actor . cc " < nl > - android : pathPrefix = " / join / " < nl > - android : scheme = " https " / > < nl > - < data < nl > android : host = " quit . email " < nl > android : pathPrefix = " / join / " < nl > android : scheme = " https " / > < nl > < data < nl > android : host = " app . actor . im " < nl > - android : pathPrefix = " / # / join / " < nl > + android : pathPrefix = " / join / " < nl > android : scheme = " https " / > < nl > < / intent - filter > < nl > < nl > < intent - filter > < nl > < action android : name = " android . intent . action . VIEW " / > < nl > - < nl > < category android : name = " android . intent . category . DEFAULT " / > < nl > < category android : name = " android . intent . category . BROWSABLE " / > < nl > - < nl > < data android : scheme = " actor " / > < nl > < / intent - filter > < nl > < nl > - < intent - filter > < nl > - < action android : name = " android . intent . action . VIEW " / > < nl > - < category android : name = " android . intent . category . DEFAULT " / > < nl > - < data < nl > - android : host = " app . actor . im " < nl > - android : scheme = " https " / > < nl > - < / intent - filter > < nl > + < / activity > < nl > + < nl > + < activity < nl > + android : name = " . controllers . share . ShareActivity " < nl > + android : configChanges = " keyboard | keyboardHidden | orientation | screenSize " < nl > + android : label = " @ string / app _ name " < nl > + android : theme = " @ style / MainActivityTheme " < nl > + android : windowSoftInputMode = " adjustResize " > < nl > < nl > < intent - filter > < nl > < action android : name = " android . intent . action . SEND " / > < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / root / RootActivity . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / root / RootActivity . java < nl > index f71aa04 . . 66ba582 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / root / RootActivity . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / root / RootActivity . java < nl > @ @ - 1 , 14 + 1 , 33 @ @ < nl > package im . actor . sdk . controllers . root ; < nl > < nl > + import android . content . DialogInterface ; < nl > + import android . content . Intent ; < nl > import android . graphics . drawable . ColorDrawable ; < nl > import android . os . Bundle ; < nl > import android . support . v4 . app . Fragment ; < nl > + import android . support . v7 . app . AlertDialog ; < nl > import android . support . v7 . widget . Toolbar ; < nl > + import android . widget . Toast ; < nl > < nl > + import java . io . UnsupportedEncodingException ; < nl > + < nl > + import im . actor . core . entity . Peer ; < nl > + import im . actor . core . viewmodel . CommandCallback ; < nl > + import im . actor . core . viewmodel . GroupVM ; < nl > + import im . actor . runtime . HTTP ; < nl > + import im . actor . runtime . android . AndroidContext ; < nl > + import im . actor . runtime . function . Consumer ; < nl > + import im . actor . runtime . http . HTTPResponse ; < nl > + import im . actor . runtime . json . JSONException ; < nl > + import im . actor . runtime . json . JSONObject ; < nl > import im . actor . sdk . ActorSDK ; < nl > import im . actor . sdk . R ; < nl > + import im . actor . sdk . controllers . Intents ; < nl > import im . actor . sdk . controllers . activity . BaseFragmentActivity ; < nl > < nl > + import static im . actor . sdk . util . ActorSDKMessenger . groups ; < nl > + import static im . actor . sdk . util . ActorSDKMessenger . messenger ; < nl > + < nl > / * * < nl > * Root Activity of Application < nl > * / < nl > @ @ - 38 , 5 + 57 , 92 @ @ public class RootActivity extends BaseFragmentActivity { < nl > . add ( R . id . root , fragment ) < nl > . commit ( ) ; < nl > } < nl > + < nl > + handleIntent ( getIntent ( ) ) ; < nl > + } < nl > + < nl > + @ Override < nl > + protected void onNewIntent ( Intent intent ) { < nl > + super . onNewIntent ( intent ) ; < nl > + handleIntent ( intent ) ; < nl > + } < nl > + < nl > + private void handleIntent ( Intent intent ) { < nl > + if ( intent . getAction ( ) ! = null & & intent . getAction ( ) . equals ( Intent . ACTION _ VIEW ) & & intent . getData ( ) ! = null ) { < nl > + String joinGroupUrl = intent . getData ( ) . toString ( ) ; < nl > + if ( joinGroupUrl ! = null & & ( joinGroupUrl . contains ( " join " ) | | joinGroupUrl . contains ( " token " ) ) ) { < nl > + String [ ] urlSplit = null ; < nl > + if ( joinGroupUrl . contains ( " join " ) ) { < nl > + urlSplit = joinGroupUrl . split ( " / join / " ) ; < nl > + } else if ( joinGroupUrl . contains ( " token " ) ) { < nl > + urlSplit = joinGroupUrl . split ( " token = " ) ; < nl > + } < nl > + if ( urlSplit ! = null ) { < nl > + joinGroupUrl = urlSplit [ urlSplit . length - 1 ] ; < nl > + < nl > + final String token = joinGroupUrl ; < nl > + HTTP . getMethod ( " https : / / api . actor . im / v1 / groups / invites / " + joinGroupUrl , 0 , 0 , 0 ) . then ( new Consumer < HTTPResponse > ( ) { < nl > + @ Override < nl > + public void apply ( HTTPResponse httpResponse ) { < nl > + try { < nl > + JSONObject data = new JSONObject ( new String ( httpResponse . getContent ( ) , " UTF - 8 " ) ) ; < nl > + JSONObject group = data . getJSONObject ( " group " ) ; < nl > + String title = group . getString ( " title " ) ; < nl > + if ( group . has ( " id " ) ) { < nl > + int gid = group . getInt ( " id " ) ; < nl > + / / Check if we have this group < nl > + try { < nl > + GroupVM groupVM = groups ( ) . get ( gid ) ; < nl > + if ( groupVM . isMember ( ) . get ( ) ) { < nl > + / / Have this group , is member , just open it < nl > + startActivity ( Intents . openDialog ( Peer . group ( gid ) , false , RootActivity . this ) ) ; < nl > + } else { < nl > + / / Have this group , but not member , join it < nl > + joinViaToken ( token , title ) ; < nl > + } < nl > + } catch ( Exception e ) { < nl > + / / Do not have this group , join it < nl > + joinViaToken ( token , title ) ; < nl > + } < nl > + } else { < nl > + joinViaToken ( token , title ) ; < nl > + } < nl > + } catch ( JSONException | UnsupportedEncodingException e ) { < nl > + e . printStackTrace ( ) ; < nl > + } < nl > + } < nl > + } ) ; < nl > + } < nl > + } < nl > + } < nl > + } < nl > + < nl > + private void joinViaToken ( String joinGroupUrl , String title ) { < nl > + AlertDialog . Builder b = new AlertDialog . Builder ( this ) ; < nl > + b . setTitle ( getString ( R . string . invite _ link _ join _ confirm , title ) ) < nl > + . setPositiveButton ( R . string . dialog _ yes , new DialogInterface . OnClickListener ( ) { < nl > + @ Override < nl > + public void onClick ( DialogInterface dialogInterface , int i ) { < nl > + dialogInterface . dismiss ( ) ; < nl > + execute ( messenger ( ) . joinGroupViaToken ( joinGroupUrl ) , R . string . invite _ link _ title , new CommandCallback < Integer > ( ) { < nl > + @ Override < nl > + public void onResult ( Integer res ) { < nl > + startActivity ( Intents . openGroupDialog ( res , true , RootActivity . this ) ) ; < nl > + finish ( ) ; < nl > + } < nl > + < nl > + @ Override < nl > + public void onError ( Exception e ) { < nl > + Toast . makeText ( RootActivity . this , e . getMessage ( ) , Toast . LENGTH _ SHORT ) . show ( ) ; < nl > + } < nl > + } ) ; < nl > + } < nl > + } ) < nl > + . setNegativeButton ( R . string . dialog _ cancel , new DialogInterface . OnClickListener ( ) { < nl > + @ Override < nl > + public void onClick ( DialogInterface dialogInterface , int i ) { < nl > + dialogInterface . dismiss ( ) ; < nl > + } < nl > + } ) . show ( ) ; < nl > } < nl > } < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / ui _ text . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / ui _ text . xml < nl > index be5628f . . 5b73541 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / ui _ text . xml < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / ui _ text . xml < nl > @ @ - 444 , 6 + 444 , 8 @ @ < nl > < string name = " invite _ link _ error _ revoke _ link " > Unable to revoke invite link < / string > < nl > < string name = " invite _ link _ empty _ view " > Loading invite link < / string > < nl > < nl > + < string name = " invite _ link _ join _ confirm " > Join " % 1 $ s " ? < / string > < nl > + < nl > < ! - - Documents - - > < nl > < string name = " documents _ title " > Documents < / string > < nl > < string name = " documents _ empty " > No documents yet < / string >
NEAREST DIFF (one line): diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / AndroidManifest . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / AndroidManifest . xml < nl > index 8a4f5c6 . . 9a0a041 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / AndroidManifest . xml < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / AndroidManifest . xml < nl > @ @ - 64 , 8 + 64 , 8 @ @ < nl > < activity < nl > android : name = " im . actor . sdk . controllers . activity . ActorMainActivity " < nl > android : configChanges = " keyboard | keyboardHidden | orientation | screenSize " < nl > - android : launchMode = " singleTop " < nl > android : label = " @ string / app _ name " < nl > + android : launchMode = " singleTop " < nl > android : theme = " @ style / MainActivityTheme " < nl > android : windowSoftInputMode = " adjustResize " > < nl > < nl > @ @ - 91 , 8 + 91 , 10 @ @ < nl > < nl > < intent - filter > < nl > < action android : name = " android . intent . action . VIEW " / > < nl > + < nl > < category android : name = " android . intent . category . DEFAULT " / > < nl > < category android : name = " android . intent . category . BROWSABLE " / > < nl > + < nl > < data android : scheme = " actor " / > < nl > < / intent - filter > < nl > < nl > @ @ - 174 , 6 + 176 , 12 @ @ < nl > android : theme = " @ style / CommonActivityTheme " < nl > android : windowSoftInputMode = " adjustResize | stateVisible " / > < nl > < nl > + < activity < nl > + android : name = " . controllers . contacts . ContactsActivity " < nl > + android : configChanges = " keyboard | keyboardHidden | orientation | screenSize " < nl > + android : theme = " @ style / CommonActivityTheme " < nl > + android : windowSoftInputMode = " adjustResize " / > < nl > + < nl > < ! - - Settings - - > < nl > < nl > < activity < nl > @ @ - 272 , 33 + 280 , 10 @ @ < nl > android : label = " @ string / picker _ file _ activity _ title " < nl > android : theme = " @ style / PickerTheme . FilePicker " / > < nl > < nl > - < nl > - < activity < nl > - android : name = " im . actor . map . MapPickerActivity " < nl > - android : configChanges = " keyboard | keyboardHidden | orientation | screenSize " < nl > - android : theme = " @ style / CommonActivityTheme " > < nl > - < intent - filter > < nl > - < category android : name = " android . intent . category . DEFAULT " / > < nl > - < action android : name = " im . actor . pickLocation _ $ { applicationId } " / > < nl > - < / intent - filter > < nl > - < / activity > < nl > - < nl > - < activity < nl > - android : name = " im . actor . map . MapActivity " < nl > - android : configChanges = " keyboard | keyboardHidden | orientation | screenSize " < nl > - android : theme = " @ style / CommonActivityTheme " < nl > - android : windowSoftInputMode = " adjustResize " > < nl > - < intent - filter > < nl > - < category android : name = " android . intent . category . DEFAULT " / > < nl > - < action android : name = " im . actor . locationPreview _ $ { applicationId } " / > < nl > - < / intent - filter > < nl > - < / activity > < nl > - < nl > - < nl > < activity < nl > android : name = " . controllers . shortcuts . ShortcutActivity " < nl > - android : theme = " @ style / AppcompatNoDisplay " < nl > - android : launchMode = " singleInstance " > < nl > + android : launchMode = " singleInstance " < nl > + android : theme = " @ style / AppcompatNoDisplay " > < nl > < intent - filter > < nl > < action android : name = " im . actor . action . botMessageShortcut " / > < nl > < nl > @ @ - 307 , 10 + 292 , 10 @ @ < nl > < nl > < activity < nl > android : name = " . controllers . calls . CallActivity " < nl > - android : theme = " @ style / CallTheme " < nl > android : launchMode = " singleInstance " < nl > android : screenOrientation = " portrait " < nl > - android : showOnLockScreen = " true " / > < nl > + android : showOnLockScreen = " true " < nl > + android : theme = " @ style / CallTheme " / > < nl > < nl > < service < nl > android : name = " im . actor . sdk . services . KeepAliveService " < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / activity / base / Controller . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / activity / base / Controller . java < nl > index 427f54b . . 43f1eb8 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / activity / base / Controller . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / activity / base / Controller . java < nl > @ @ - 12 , 9 + 12 , 6 @ @ import android . view . MenuInflater ; < nl > import android . view . MenuItem ; < nl > import android . view . View ; < nl > < nl > - / * * < nl > - * Created by ex3ndr on 25 . 10 . 14 . < nl > - * / < nl > public abstract class Controller < T extends AppCompatActivity > { < nl > < nl > private T activity ; < nl > @ @ - 23 , 9 + 20 , 13 @ @ public abstract class Controller < T extends AppCompatActivity > { < nl > this . activity = activity ; < nl > } < nl > < nl > - public Resources getResources ( ) { return activity . getResources ( ) ; } < nl > + public Resources getResources ( ) { < nl > + return activity . getResources ( ) ; < nl > + } < nl > < nl > - public Intent getIntent ( ) { return activity . getIntent ( ) ; } < nl > + public Intent getIntent ( ) { < nl > + return activity . getIntent ( ) ; < nl > + } < nl > < nl > public View findViewById ( int id ) { < nl > return activity . findViewById ( id ) ; < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / contacts / ContactsActivity . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / contacts / ContactsActivity . java < nl > new file mode 100644 < nl > index 0000000 . . 2b2d3be < nl > - - - / dev / null < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / contacts / ContactsActivity . java < nl > @ @ - 0 , 0 + 1 , 22 @ @ < nl > + package im . actor . sdk . controllers . contacts ; < nl > + < nl > + import android . os . Bundle ; < nl > + import android . support . annotation . Nullable ; < nl > + < nl > + import im . actor . sdk . R ; < nl > + import im . actor . sdk . controllers . activity . BaseFragmentActivity ; < nl > + < nl > + public class ContactsActivity extends BaseFragmentActivity { < nl > + @ Override < nl > + protected void onCreate ( @ Nullable Bundle savedInstanceState ) { < nl > + super . onCreate ( savedInstanceState ) ; < nl > + < nl > + if ( getSupportActionBar ( ) ! = null ) { < nl > + getSupportActionBar ( ) . setTitle ( R . string . contacts _ title ) ; < nl > + } < nl > + < nl > + if ( savedInstanceState = = null ) { < nl > + showFragment ( new ContactsFragment ( ) , false , false ) ; < nl > + } < nl > + } < nl > + } < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java < nl > index fbf50d4 . . 9afacc1 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java < nl > @ @ - 251 , 6 + 251 , 8 @ @ public class ChatActivity extends ActorEditTextActivity { < nl > < nl > super . onCreate ( saveInstance ) ; < nl > < nl > + onCreateToolbar ( ) ; < nl > + < nl > messageEditText . addTextChangedListener ( new TextWatcherImp ( ) ) ; < nl > messageEditText . setOnFocusChangeListener ( new View . OnFocusChangeListener ( ) { < nl > @ Override < nl > @ @ - 523 , 7 + 525 , 6 @ @ public class ChatActivity extends ActorEditTextActivity { < nl > } < nl > } < nl > < nl > - @ Override < nl > protected void onCreateToolbar ( ) { < nl > / / Loading Toolbar header views < nl > / / Binding to real data is performed in onResume method < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / profile / ProfileActivity . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / profile / ProfileActivity . java < nl > index f9ebc2b . . a3c102f 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / profile / ProfileActivity . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / profile / ProfileActivity . java < nl > @ @ - 3 , 8 + 3 , 6 @ @ package im . actor . sdk . controllers . profile ; < nl > import android . graphics . Color ; < nl > import android . graphics . drawable . ColorDrawable ; < nl > import android . os . Bundle ; < nl > - import android . support . v7 . app . ActionBar ; < nl > - import android . support . v7 . app . AppCompatActivity ; < nl > import android . view . Menu ; < nl > import android . view . MenuItem ; < nl > import android . widget . Toast ; < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / root / MainBaseController . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / root / MainBaseController . java < nl > index 6ccce46 . . 73c993b 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / root / MainBaseController . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / root / MainBaseController . java < nl > @ @ - 5 , 10 + 5 , 8 @ @ import im . actor . sdk . controllers . activity . ActorMainActivity ; < nl > import im . actor . sdk . controllers . activity . base . Controller ; < nl > import im . actor . core . entity . Dialog ; < nl > < nl > - / * * < nl > - * Created by ex3ndr on 25 . 10 . 14 . < nl > - * / < nl > public abstract class MainBaseController extends Controller < ActorMainActivity > { < nl > + < nl > protected MainBaseController ( ActorMainActivity activity ) { < nl > super ( activity ) ; < nl > } < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / root / MainPhoneController . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / root / MainPhoneController . java < nl > index f2ce87d . . 8d49937 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / root / MainPhoneController . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / root / MainPhoneController . java < nl > @ @ - 40 , 6 + 40 , 7 @ @ import im . actor . sdk . R ; < nl > import im . actor . sdk . controllers . Intents ; < nl > import im . actor . sdk . controllers . contacts . AddContactActivity ; < nl > import im . actor . sdk . controllers . compose . ComposeActivity ; < nl > + import im . actor . sdk . controllers . contacts . ContactsActivity ; < nl > import im . actor . sdk . controllers . contacts . ContactsFragment ; < nl > import im . actor . sdk . controllers . dialogs . DialogsFragment ; < nl > import im . actor . sdk . controllers . fragment . help . HelpActivity ; < nl > @ @ - 50 , 8 + 51 , 6 @ @ import im . actor . sdk . view . adapters . FragmentNoMenuStatePagerAdapter ; < nl > import im . actor . sdk . view . adapters . HeaderViewRecyclerAdapter ; < nl > import im . actor . sdk . view . adapters . OnItemClickedListener ; < nl > import im . actor . sdk . view . PagerSlidingTabStrip ; < nl > - import im . actor . runtime . mvvm . ValueDoubleChangedListener ; < nl > - import im . actor . runtime . mvvm . Value ; < nl > < nl > import static im . actor . sdk . util . ViewUtils . goneView ; < nl > import static im . actor . sdk . util . ViewUtils . showView ; < nl > @ @ - 59 , 10 + 58 , 6 @ @ import static im . actor . sdk . util . ActorSDKMessenger . messenger ; < nl > < nl > public class MainPhoneController extends MainBaseController { < nl > < nl > - protected ViewPager pager ; < nl > - < nl > - private HomePagerAdapter homePagerAdapter ; < nl > - < nl > private RecyclerView searchList ; < nl > private View searchContainer ; < nl > private TextView searchEmptyView ; < nl > @ @ - 71 , 17 + 66 , 10 @ @ public class MainPhoneController extends MainBaseController { < nl > private boolean isSearchVisible = false ; < nl > private SearchAdapter searchAdapter ; < nl > private BindedDisplayList < SearchEntity > searchDisplay ; < nl > - private final DisplayList . Listener searchListener = new DisplayList . Listener ( ) { < nl > - @ Override < nl > - public void onCollectionChanged ( ) { < nl > - onSearchChanged ( ) ; < nl > - } < nl > - } ; < nl > + private final DisplayList . Listener searchListener = ( ) - > onSearchChanged ( ) ; < nl > private SearchView searchView ; < nl > private MenuItem searchMenu ; < nl > < nl > - protected PagerSlidingTabStrip barTabs ; < nl > - < nl > private View syncInProgressView ; < nl > private View emptyContactsView ; < nl > < nl > @ @ - 105 , 17 + 93 , 11 @ @ public class MainPhoneController extends MainBaseController { < nl > if ( ( sendUriMultiple ! = null & & ! sendUriMultiple . isEmpty ( ) ) | | docContent ! = null | | ( sendUriString ! = null & & ! sendUriString . isEmpty ( ) ) ) { < nl > new AlertDialog . Builder ( getActivity ( ) ) < nl > . setMessage ( getActivity ( ) . getString ( R . string . confirm _ share ) + " " + item . getDialogTitle ( ) + " ? " ) < nl > - . setPositiveButton ( R . string . dialog _ ok , new DialogInterface . OnClickListener ( ) { < nl > - @ Override < nl > - public void onClick ( DialogInterface dialog , int which ) { < nl > - openDialog ( item ) ; < nl > - } < nl > + . setPositiveButton ( R . string . dialog _ ok , ( dialog , which ) - > { < nl > + openDialog ( item ) ; < nl > } ) < nl > - . setNegativeButton ( R . string . dialog _ cancel , new DialogInterface . OnClickListener ( ) { < nl > - @ Override < nl > - public void onClick ( DialogInterface dialog , int which ) { < nl > - dialog . dismiss ( ) ; < nl > - } < nl > + . setNegativeButton ( R . string . dialog _ cancel , ( dialog , which ) - > { < nl > + dialog . dismiss ( ) ; < nl > } ) < nl > . show ( ) ; < nl > } else { < nl > @ @ - 128 , 17 + 110 , 11 @ @ public class MainPhoneController extends MainBaseController { < nl > if ( ( sendUriMultiple ! = null & & ! sendUriMultiple . isEmpty ( ) ) | | docContent ! = null | | ( sendUriString ! = null & & ! sendUriString . isEmpty ( ) ) ) { < nl > new AlertDialog . Builder ( getActivity ( ) ) < nl > . setMessage ( getActivity ( ) . getString ( R . string . confirm _ share ) + " " + contact . getName ( ) + " ? " ) < nl > - . setPositiveButton ( R . string . dialog _ ok , new DialogInterface . OnClickListener ( ) { < nl > - @ Override < nl > - public void onClick ( DialogInterface dialog , int which ) { < nl > - openContactDialog ( contact ) ; < nl > - } < nl > + . setPositiveButton ( R . string . dialog _ ok , ( dialog , which ) - > { < nl > + openContactDialog ( contact ) ; < nl > } ) < nl > - . setNegativeButton ( R . string . dialog _ cancel , new DialogInterface . OnClickListener ( ) { < nl > - @ Override < nl > - public void onClick ( DialogInterface dialog , int which ) { < nl > - dialog . dismiss ( ) ; < nl > - } < nl > + . setNegativeButton ( R . string . dialog _ cancel , ( dialog , which ) - > { < nl > + dialog . dismiss ( ) ; < nl > } ) < nl > . show ( ) ; < nl > } else { < nl > @ @ - 231 , 54 + 207 , 48 @ @ public class MainPhoneController extends MainBaseController { < nl > searchHintView . setVisibility ( View . GONE ) ; < nl > searchEmptyView . setVisibility ( View . GONE ) ; < nl > < nl > - pager = ( ViewPager ) findViewById ( R . id . vp _ pager ) ; < nl > - pager . setOffscreenPageLimit ( 2 ) ; < nl > - homePagerAdapter = getHomePagerAdapter ( ) ; < nl > - pager . setAdapter ( homePagerAdapter ) ; < nl > - pager . setCurrentItem ( 0 ) ; < nl > - pager . setOnPageChangeListener ( new ViewPager . OnPageChangeListener ( ) { < nl > - private int prevPage = - 1 ; < nl > - < nl > - @ Override < nl > - public void onPageScrolled ( int position , float positionOffset , int positionOffsetPixels ) { < nl > - < nl > - } < nl > - < nl > - @ Override < nl > - public void onPageSelected ( int position ) { < nl > - if ( position = = 0 ) { < nl > - if ( position ! = prevPage ) { < nl > - } < nl > - if ( prevPage = = 1 ) { < nl > - } < nl > - prevPage = position ; < nl > - } else if ( position = = 1 ) { < nl > - if ( position ! = prevPage ) { < nl > - } < nl > - if ( prevPage = = 0 ) { < nl > - } < nl > - prevPage = position ; < nl > - } < nl > - } < nl > - < nl > - @ Override < nl > - public void onPageScrollStateChanged ( int state ) { < nl > - < nl > - } < nl > - } ) ; < nl > - < nl > + / / pager = ( ViewPager ) findViewById ( R . id . vp _ pager ) ; < nl > + / / pager . setOffscreenPageLimit ( 2 ) ; < nl > + / / homePagerAdapter = getHomePagerAdapter ( ) ; < nl > + / / pager . setAdapter ( homePagerAdapter ) ; < nl > + / / pager . setCurrentItem ( 0 ) ; < nl > + / / pager . setOnPageChangeListener ( new ViewPager . OnPageChangeListener ( ) { < nl > + / / private int prevPage = - 1 ; < nl > + / / < nl > + / / @ Override < nl > + / / public void onPageScrolled ( int position , float positionOffset , int positionOffsetPixels ) { < nl > + / / < nl > + / / } < nl > + / / < nl > + / / @ Override < nl > + / / public void onPageSelected ( int position ) { < nl > + / / if ( position = = 0 ) { < nl > + / / prevPage = position ; < nl > + / / } else if ( position = = 1 ) { < nl > + / / prevPage = position ; < nl > + / / } < nl > + / / } < nl > + / / < nl > + / / @ Override < nl > + / / public void onPageScrollStateChanged ( int state ) { < nl > + / / < nl > + / / } < nl > + / / } ) ; < nl > + < nl > + if ( savedInstance = = null ) { < nl > + getFragmentManager ( ) . beginTransaction ( ) < nl > + . add ( R . id . contentRoot , new DialogsFragment ( ) ) < nl > + . commit ( ) ; < nl > + } < nl > < nl > findViewById ( R . id . addContactButton ) . setOnClickListener ( v - > startActivity ( new Intent ( getActivity ( ) , AddContactActivity . class ) ) ) ; < nl > < nl > - findViewById ( R . id . inviteButton ) . setOnClickListener ( new View . OnClickListener ( ) { < nl > - @ Override < nl > - public void onClick ( View v ) { < nl > - String inviteMessage = getResources ( ) . getString ( R . string . invite _ message ) . replace ( " { inviteUrl } " , ActorSDK . sharedActor ( ) . getInviteUrl ( ) ) . replace ( " { appName } " , ActorSDK . sharedActor ( ) . getAppName ( ) ) ; < nl > - Intent sendIntent = new Intent ( Intent . ACTION _ SEND ) ; < nl > - sendIntent . putExtra ( Intent . EXTRA _ TEXT , inviteMessage ) ; < nl > - sendIntent . setType ( " text / plain " ) ; < nl > - startActivity ( sendIntent ) ; < nl > - } < nl > + findViewById ( R . id . inviteButton ) . setOnClickListener ( v - > { < nl > + String inviteMessage = getResources ( ) . getString ( R . string . invite _ message ) . replace ( " { inviteUrl } " , ActorSDK . sharedActor ( ) . getInviteUrl ( ) ) . replace ( " { appName } " , ActorSDK . sharedActor ( ) . getAppName ( ) ) ; < nl > + Intent sendIntent = new Intent ( Intent . ACTION _ SEND ) ; < nl > + sendIntent . putExtra ( Intent . EXTRA _ TEXT , inviteMessage ) ; < nl > + sendIntent . setType ( " text / plain " ) ; < nl > + startActivity ( sendIntent ) ; < nl > } ) ; < nl > } < nl > < nl > @ @ - 330 , 10 + 300 , 11 @ @ public class MainPhoneController extends MainBaseController { < nl > @ Override < nl > public void onResume ( ) { < nl > ActionBar ab = getActionBar ( ) ; < nl > - ab . setDisplayShowCustomEnabled ( true ) ; < nl > + ab . setDisplayShowCustomEnabled ( false ) ; < nl > ab . setDisplayHomeAsUpEnabled ( false ) ; < nl > ab . setDisplayShowHomeEnabled ( false ) ; < nl > - ab . setDisplayShowTitleEnabled ( false ) ; < nl > + ab . setDisplayShowTitleEnabled ( true ) ; < nl > + ab . setTitle ( getResources ( ) . getString ( R . string . app _ name ) ) ; < nl > < nl > if ( ActorSDK . sharedActor ( ) . style . getToolBarColor ( ) ! = 0 ) { < nl > ab . setBackgroundDrawable ( new ColorDrawable ( ActorSDK . sharedActor ( ) . style . getToolBarColor ( ) ) ) ; < nl > @ @ - 347 , 61 + 318 , 57 @ @ public class MainPhoneController extends MainBaseController { < nl > < nl > getActivity ( ) . bind ( messenger ( ) . getAppState ( ) . getIsAppLoaded ( ) , < nl > messenger ( ) . getAppState ( ) . getIsAppEmpty ( ) , < nl > - new ValueDoubleChangedListener < Boolean , Boolean > ( ) { < nl > - @ Override < nl > - public void onChanged ( Boolean isAppLoaded , Value < Boolean > Value , < nl > - Boolean isAppEmpty , Value < Boolean > Value2 ) { < nl > - if ( isAppEmpty ) { < nl > - if ( isAppLoaded ) { < nl > - onHideToolbarCustomView ( ) ; < nl > - emptyContactsView . setVisibility ( View . VISIBLE ) ; < nl > - syncInProgressView . setVisibility ( View . GONE ) ; < nl > - getActivity ( ) . invalidateOptionsMenu ( ) ; < nl > - } else { < nl > - onHideToolbarCustomView ( ) ; < nl > - emptyContactsView . setVisibility ( View . GONE ) ; < nl > - syncInProgressView . setVisibility ( View . VISIBLE ) ; < nl > - getActivity ( ) . invalidateOptionsMenu ( ) ; < nl > - } < nl > + ( isAppLoaded , Value , isAppEmpty , Value2 ) - > { < nl > + if ( isAppEmpty ) { < nl > + if ( isAppLoaded ) { < nl > + onHideToolbarCustomView ( ) ; < nl > + emptyContactsView . setVisibility ( View . VISIBLE ) ; < nl > + syncInProgressView . setVisibility ( View . GONE ) ; < nl > + getActivity ( ) . invalidateOptionsMenu ( ) ; < nl > } else { < nl > - onShowToolbarCustomView ( ) ; < nl > + onHideToolbarCustomView ( ) ; < nl > emptyContactsView . setVisibility ( View . GONE ) ; < nl > - syncInProgressView . setVisibility ( View . GONE ) ; < nl > + syncInProgressView . setVisibility ( View . VISIBLE ) ; < nl > getActivity ( ) . invalidateOptionsMenu ( ) ; < nl > } < nl > + } else { < nl > + onShowToolbarCustomView ( ) ; < nl > + emptyContactsView . setVisibility ( View . GONE ) ; < nl > + syncInProgressView . setVisibility ( View . GONE ) ; < nl > + getActivity ( ) . invalidateOptionsMenu ( ) ; < nl > } < nl > } ) ; < nl > } < nl > < nl > protected void onShowToolbarCustomView ( ) { < nl > - barTabs . setVisibility ( View . VISIBLE ) ; < nl > + / / barTabs . setVisibility ( View . VISIBLE ) ; < nl > } < nl > < nl > protected void onHideToolbarCustomView ( ) { < nl > - barTabs . setVisibility ( View . GONE ) ; < nl > + / / barTabs . setVisibility ( View . GONE ) ; < nl > } < nl > < nl > protected void onConfigireToolbarCustomView ( ActionBar ab ) { < nl > - FrameLayout tabsContainer = new FrameLayout ( getActivity ( ) ) ; < nl > - barTabs = new PagerSlidingTabStrip ( getActivity ( ) ) ; < nl > - barTabs . setTabBackground ( R . drawable . selector _ bar ) ; < nl > - / / barTabs . setIndicatorColorResource ( R . color . main _ tab _ selected ) ; < nl > - barTabs . setIndicatorHeight ( Screen . dp ( 2 ) ) ; < nl > - < nl > - barTabs . setDividerColorResource ( android . R . color . transparent ) ; < nl > - / / barTabs . setTextColorResource ( R . color . main _ tab _ text ) ; < nl > - barTabs . setTextSize ( Screen . dp ( 14 ) ) ; < nl > - barTabs . setUnderlineHeight ( 0 ) ; < nl > - < nl > - barTabs . setViewPager ( pager ) ; < nl > + / / FrameLayout tabsContainer = new FrameLayout ( getActivity ( ) ) ; < nl > + / / barTabs = new PagerSlidingTabStrip ( getActivity ( ) ) ; < nl > + / / barTabs . setTabBackground ( R . drawable . selector _ bar ) ; < nl > + / / / / barTabs . setIndicatorColorResource ( R . color . main _ tab _ selected ) ; < nl > + / / barTabs . setIndicatorHeight ( Screen . dp ( 2 ) ) ; < nl > + / / < nl > + / / barTabs . setDividerColorResource ( android . R . color . transparent ) ; < nl > + / / / / barTabs . setTextColorResource ( R . color . main _ tab _ text ) ; < nl > + / / barTabs . setTextSize ( Screen . dp ( 14 ) ) ; < nl > + / / barTabs . setUnderlineHeight ( 0 ) ; < nl > + / / < nl > + / / barTabs . setViewPager ( pager ) ; < nl > < nl > / / Icons < nl > / / int width = Screen . dp ( 72 * 2 ) ; < nl > < nl > - tabsContainer . addView ( barTabs , new FrameLayout . LayoutParams ( ViewGroup . LayoutParams . WRAP _ CONTENT , Screen . dp ( 56 ) ) ) ; < nl > - Toolbar . LayoutParams lp = new Toolbar . LayoutParams ( ViewGroup . LayoutParams . WRAP _ CONTENT , Screen . dp ( 56 ) ) ; < nl > - tabsContainer . setLayoutParams ( lp ) ; < nl > - ab . setCustomView ( tabsContainer ) ; < nl > + / / tabsContainer . addView ( barTabs , new FrameLayout . LayoutParams ( ViewGroup . LayoutParams . WRAP _ CONTENT , Screen . dp ( 56 ) ) ) ; < nl > + / / Toolbar . LayoutParams lp = new Toolbar . LayoutParams ( ViewGroup . LayoutParams . WRAP _ CONTENT , Screen . dp ( 56 ) ) ; < nl > + / / tabsContainer . setLayoutParams ( lp ) ; < nl > + / / ab . setCustomView ( tabsContainer ) ; < nl > } < nl > < nl > < nl > @ @ - 549 , 6 + 516 , 9 @ @ public class MainPhoneController extends MainBaseController { < nl > } else if ( i = = R . id . profile ) { < nl > ActorSDK . sharedActor ( ) . startSettingActivity ( getActivity ( ) ) ; < nl > return true ; < nl > + } else if ( i = = R . id . contacts ) { < nl > + startActivity ( new Intent ( getActivity ( ) , ContactsActivity . class ) ) ; < nl > + return true ; < nl > } < nl > < nl > return false ; < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / actor _ activity _ main . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / actor _ activity _ main . xml < nl > index 8f89d80 . . 62455f0 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / actor _ activity _ main . xml < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / actor _ activity _ main . xml < nl > @ @ - 15 , 11 + 15 , 7 @ @ < nl > android : layout _ width = " match _ parent " < nl > android : layout _ height = " wrap _ content " < nl > android : background = " ? attr / colorPrimary " < nl > - android : contentInsetLeft = " 0dp " < nl > - android : contentInsetStart = " 0dp " < nl > android : minHeight = " 56dp " < nl > - app : contentInsetLeft = " 0dp " < nl > - app : contentInsetStart = " 0dp " < nl > app : popupTheme = " @ style / ThemeOverlay . AppCompat . Dark . ActionBar " < nl > app : theme = " @ style / ThemeOverlay . AppCompat . Dark . ActionBar " / > < nl > < nl > @ @ - 29 , 8 + 25 , 8 @ @ < nl > android : layout _ height = " match _ parent " < nl > android : layout _ below = " @ + id / toolbar " > < nl > < nl > - < android . support . v4 . view . ViewPager < nl > - android : id = " @ + id / vp _ pager " < nl > + < FrameLayout < nl > + android : id = " @ + id / contentRoot " < nl > android : layout _ width = " match _ parent " < nl > android : layout _ height = " match _ parent " / > < nl > < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / menu / main . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / menu / main . xml < nl > index d39654a . . fa4bd7b 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / menu / main . xml < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / menu / main . xml < nl > @ @ - 15 , 8 + 15 , 12 @ @ < nl > app : showAsAction = " always | collapseActionView " / > < nl > < nl > < item < nl > + android : id = " @ + id / contacts " < nl > + android : title = " Contacts " < nl > + app : showAsAction = " never " / > < nl > + < nl > + < item < nl > android : id = " @ + id / profile " < nl > android : title = " Profile " < nl > - android : icon = " @ drawable / ic _ settings _ white _ 24dp " < nl > - app : showAsAction = " always " / > < nl > + app : showAsAction = " never " / > < nl > < / menu > < nl > \ No newline at end of file < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / styles . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / styles . xml < nl > index 7912977 . . 5a2d9f7 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / styles . xml < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / styles . xml < nl > @ @ - 1 , 5 + 1 , 4 @ @ < nl > - < ? xml version = " 1 . 0 " encoding = " utf - 8 " ? > < nl > - < ! - - < nl > + < ? xml version = " 1 . 0 " encoding = " utf - 8 " ? > < ! - - < nl > ~ Copyright ( C ) 2015 Actor LLC . < https : / / actor . im > < nl > - - > < nl > < nl > @ @ - 8 , 6 + 7 , 9 @ @ < nl > < style name = " AppToolbarTheme " parent = " Theme . AppCompat . Light . DarkActionBar " > < nl > < item name = " android : windowContentOverlay " > @ null < / item > < nl > < nl > + < item name = " popupTheme " > @ style / ThemeOverlay . AppCompat . Light < / item > < nl > + < item name = " android : popupTheme " > @ style / ThemeOverlay . AppCompat . Light < / item > < nl > + < nl > < item name = " colorPrimary " > @ color / primary < / item > < nl > < item name = " colorPrimaryDark " > @ color / primary _ hovered < / item > < nl > < item name = " colorAccent " > @ color / primary < / item > < nl > @ @ - 16 , 12 + 18 , 12 @ @ < nl > < item name = " android : colorPrimaryDark " > @ color / primary _ hovered < / item > < nl > < item name = " android : colorAccent " > @ color / primary < / item > < nl > < nl > - < nl > < / style > < nl > < nl > < style name = " MainActivityTheme " parent = " AppToolbarTheme " > < nl > < item name = " android : windowBackground " > @ android : color / white < / item > < nl > < nl > + < nl > < item name = " windowActionBar " > false < / item > < nl > < item name = " windowNoTitle " > true < / item > < nl > < item name = " android : windowActionBar " > false < / item >

TEST DIFF:
diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / AndroidManifest . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / AndroidManifest . xml 
 index 4f38c4f . . aa77568 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / AndroidManifest . xml 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / AndroidManifest . xml 
 @ @ - 67 , 51 + 67 , 37 @ @ 
 android : label = " @ string / app _ name " 
 android : launchMode = " singleTop " 
 android : theme = " @ style / MainActivityTheme " 
 - android : windowSoftInputMode = " adjustPan " / > 
 - 
 - < activity 
 - android : name = " . controllers . share . ShareActivity " 
 - android : configChanges = " keyboard | keyboardHidden | orientation | screenSize " 
 - android : label = " @ string / app _ name " 
 - android : theme = " @ style / MainActivityTheme " 
 - android : windowSoftInputMode = " adjustResize " > 
 - 
 + android : windowSoftInputMode = " adjustPan " > 
 < intent - filter > 
 < action android : name = " android . intent . action . VIEW " / > 
 - 
 < category android : name = " android . intent . category . BROWSABLE " / > 
 < category android : name = " android . intent . category . DEFAULT " / > 
 
 < data 
 - android : host = " actor . cc " 
 - android : pathPrefix = " / join / " 
 - android : scheme = " https " / > 
 - < data 
 android : host = " quit . email " 
 android : pathPrefix = " / join / " 
 android : scheme = " https " / > 
 < data 
 android : host = " app . actor . im " 
 - android : pathPrefix = " / # / join / " 
 + android : pathPrefix = " / join / " 
 android : scheme = " https " / > 
 < / intent - filter > 
 
 < intent - filter > 
 < action android : name = " android . intent . action . VIEW " / > 
 - 
 < category android : name = " android . intent . category . DEFAULT " / > 
 < category android : name = " android . intent . category . BROWSABLE " / > 
 - 
 < data android : scheme = " actor " / > 
 < / intent - filter > 
 
 - < intent - filter > 
 - < action android : name = " android . intent . action . VIEW " / > 
 - < category android : name = " android . intent . category . DEFAULT " / > 
 - < data 
 - android : host = " app . actor . im " 
 - android : scheme = " https " / > 
 - < / intent - filter > 
 + < / activity > 
 + 
 + < activity 
 + android : name = " . controllers . share . ShareActivity " 
 + android : configChanges = " keyboard | keyboardHidden | orientation | screenSize " 
 + android : label = " @ string / app _ name " 
 + android : theme = " @ style / MainActivityTheme " 
 + android : windowSoftInputMode = " adjustResize " > 
 
 < intent - filter > 
 < action android : name = " android . intent . action . SEND " / > 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / root / RootActivity . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / root / RootActivity . java 
 index f71aa04 . . 66ba582 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / root / RootActivity . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / root / RootActivity . java 
 @ @ - 1 , 14 + 1 , 33 @ @ 
 package im . actor . sdk . controllers . root ; 
 
 + import android . content . DialogInterface ; 
 + import android . content . Intent ; 
 import android . graphics . drawable . ColorDrawable ; 
 import android . os . Bundle ; 
 import android . support . v4 . app . Fragment ; 
 + import android . support . v7 . app . AlertDialog ; 
 import android . support . v7 . widget . Toolbar ; 
 + import android . widget . Toast ; 
 
 + import java . io . UnsupportedEncodingException ; 
 + 
 + import im . actor . core . entity . Peer ; 
 + import im . actor . core . viewmodel . CommandCallback ; 
 + import im . actor . core . viewmodel . GroupVM ; 
 + import im . actor . runtime . HTTP ; 
 + import im . actor . runtime . android . AndroidContext ; 
 + import im . actor . runtime . function . Consumer ; 
 + import im . actor . runtime . http . HTTPResponse ; 
 + import im . actor . runtime . json . JSONException ; 
 + import im . actor . runtime . json . JSONObject ; 
 import im . actor . sdk . ActorSDK ; 
 import im . actor . sdk . R ; 
 + import im . actor . sdk . controllers . Intents ; 
 import im . actor . sdk . controllers . activity . BaseFragmentActivity ; 
 
 + import static im . actor . sdk . util . ActorSDKMessenger . groups ; 
 + import static im . actor . sdk . util . ActorSDKMessenger . messenger ; 
 + 
 / * * 
 * Root Activity of Application 
 * / 
 @ @ - 38 , 5 + 57 , 92 @ @ public class RootActivity extends BaseFragmentActivity { 
 . add ( R . id . root , fragment ) 
 . commit ( ) ; 
 } 
 + 
 + handleIntent ( getIntent ( ) ) ; 
 + } 
 + 
 + @ Override 
 + protected void onNewIntent ( Intent intent ) { 
 + super . onNewIntent ( intent ) ; 
 + handleIntent ( intent ) ; 
 + } 
 + 
 + private void handleIntent ( Intent intent ) { 
 + if ( intent . getAction ( ) ! = null & & intent . getAction ( ) . equals ( Intent . ACTION _ VIEW ) & & intent . getData ( ) ! = null ) { 
 + String joinGroupUrl = intent . getData ( ) . toString ( ) ; 
 + if ( joinGroupUrl ! = null & & ( joinGroupUrl . contains ( " join " ) | | joinGroupUrl . contains ( " token " ) ) ) { 
 + String [ ] urlSplit = null ; 
 + if ( joinGroupUrl . contains ( " join " ) ) { 
 + urlSplit = joinGroupUrl . split ( " / join / " ) ; 
 + } else if ( joinGroupUrl . contains ( " token " ) ) { 
 + urlSplit = joinGroupUrl . split ( " token = " ) ; 
 + } 
 + if ( urlSplit ! = null ) { 
 + joinGroupUrl = urlSplit [ urlSplit . length - 1 ] ; 
 + 
 + final String token = joinGroupUrl ; 
 + HTTP . getMethod ( " https : / / api . actor . im / v1 / groups / invites / " + joinGroupUrl , 0 , 0 , 0 ) . then ( new Consumer < HTTPResponse > ( ) { 
 + @ Override 
 + public void apply ( HTTPResponse httpResponse ) { 
 + try { 
 + JSONObject data = new JSONObject ( new String ( httpResponse . getContent ( ) , " UTF - 8 " ) ) ; 
 + JSONObject group = data . getJSONObject ( " group " ) ; 
 + String title = group . getString ( " title " ) ; 
 + if ( group . has ( " id " ) ) { 
 + int gid = group . getInt ( " id " ) ; 
 + / / Check if we have this group 
 + try { 
 + GroupVM groupVM = groups ( ) . get ( gid ) ; 
 + if ( groupVM . isMember ( ) . get ( ) ) { 
 + / / Have this group , is member , just open it 
 + startActivity ( Intents . openDialog ( Peer . group ( gid ) , false , RootActivity . this ) ) ; 
 + } else { 
 + / / Have this group , but not member , join it 
 + joinViaToken ( token , title ) ; 
 + } 
 + } catch ( Exception e ) { 
 + / / Do not have this group , join it 
 + joinViaToken ( token , title ) ; 
 + } 
 + } else { 
 + joinViaToken ( token , title ) ; 
 + } 
 + } catch ( JSONException | UnsupportedEncodingException e ) { 
 + e . printStackTrace ( ) ; 
 + } 
 + } 
 + } ) ; 
 + } 
 + } 
 + } 
 + } 
 + 
 + private void joinViaToken ( String joinGroupUrl , String title ) { 
 + AlertDialog . Builder b = new AlertDialog . Builder ( this ) ; 
 + b . setTitle ( getString ( R . string . invite _ link _ join _ confirm , title ) ) 
 + . setPositiveButton ( R . string . dialog _ yes , new DialogInterface . OnClickListener ( ) { 
 + @ Override 
 + public void onClick ( DialogInterface dialogInterface , int i ) { 
 + dialogInterface . dismiss ( ) ; 
 + execute ( messenger ( ) . joinGroupViaToken ( joinGroupUrl ) , R . string . invite _ link _ title , new CommandCallback < Integer > ( ) { 
 + @ Override 
 + public void onResult ( Integer res ) { 
 + startActivity ( Intents . openGroupDialog ( res , true , RootActivity . this ) ) ; 
 + finish ( ) ; 
 + } 
 + 
 + @ Override 
 + public void onError ( Exception e ) { 
 + Toast . makeText ( RootActivity . this , e . getMessage ( ) , Toast . LENGTH _ SHORT ) . show ( ) ; 
 + } 
 + } ) ; 
 + } 
 + } ) 
 + . setNegativeButton ( R . string . dialog _ cancel , new DialogInterface . OnClickListener ( ) { 
 + @ Override 
 + public void onClick ( DialogInterface dialogInterface , int i ) { 
 + dialogInterface . dismiss ( ) ; 
 + } 
 + } ) . show ( ) ; 
 } 
 } 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / ui _ text . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / ui _ text . xml 
 index be5628f . . 5b73541 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / ui _ text . xml 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / ui _ text . xml 
 @ @ - 444 , 6 + 444 , 8 @ @ 
 < string name = " invite _ link _ error _ revoke _ link " > Unable to revoke invite link < / string > 
 < string name = " invite _ link _ empty _ view " > Loading invite link < / string > 
 
 + < string name = " invite _ link _ join _ confirm " > Join " % 1 $ s " ? < / string > 
 + 
 < ! - - Documents - - > 
 < string name = " documents _ title " > Documents < / string > 
 < string name = " documents _ empty " > No documents yet < / string >

NEAREST DIFF:
diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / AndroidManifest . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / AndroidManifest . xml 
 index 8a4f5c6 . . 9a0a041 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / AndroidManifest . xml 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / AndroidManifest . xml 
 @ @ - 64 , 8 + 64 , 8 @ @ 
 < activity 
 android : name = " im . actor . sdk . controllers . activity . ActorMainActivity " 
 android : configChanges = " keyboard | keyboardHidden | orientation | screenSize " 
 - android : launchMode = " singleTop " 
 android : label = " @ string / app _ name " 
 + android : launchMode = " singleTop " 
 android : theme = " @ style / MainActivityTheme " 
 android : windowSoftInputMode = " adjustResize " > 
 
 @ @ - 91 , 8 + 91 , 10 @ @ 
 
 < intent - filter > 
 < action android : name = " android . intent . action . VIEW " / > 
 + 
 < category android : name = " android . intent . category . DEFAULT " / > 
 < category android : name = " android . intent . category . BROWSABLE " / > 
 + 
 < data android : scheme = " actor " / > 
 < / intent - filter > 
 
 @ @ - 174 , 6 + 176 , 12 @ @ 
 android : theme = " @ style / CommonActivityTheme " 
 android : windowSoftInputMode = " adjustResize | stateVisible " / > 
 
 + < activity 
 + android : name = " . controllers . contacts . ContactsActivity " 
 + android : configChanges = " keyboard | keyboardHidden | orientation | screenSize " 
 + android : theme = " @ style / CommonActivityTheme " 
 + android : windowSoftInputMode = " adjustResize " / > 
 + 
 < ! - - Settings - - > 
 
 < activity 
 @ @ - 272 , 33 + 280 , 10 @ @ 
 android : label = " @ string / picker _ file _ activity _ title " 
 android : theme = " @ style / PickerTheme . FilePicker " / > 
 
 - 
 - < activity 
 - android : name = " im . actor . map . MapPickerActivity " 
 - android : configChanges = " keyboard | keyboardHidden | orientation | screenSize " 
 - android : theme = " @ style / CommonActivityTheme " > 
 - < intent - filter > 
 - < category android : name = " android . intent . category . DEFAULT " / > 
 - < action android : name = " im . actor . pickLocation _ $ { applicationId } " / > 
 - < / intent - filter > 
 - < / activity > 
 - 
 - < activity 
 - android : name = " im . actor . map . MapActivity " 
 - android : configChanges = " keyboard | keyboardHidden | orientation | screenSize " 
 - android : theme = " @ style / CommonActivityTheme " 
 - android : windowSoftInputMode = " adjustResize " > 
 - < intent - filter > 
 - < category android : name = " android . intent . category . DEFAULT " / > 
 - < action android : name = " im . actor . locationPreview _ $ { applicationId } " / > 
 - < / intent - filter > 
 - < / activity > 
 - 
 - 
 < activity 
 android : name = " . controllers . shortcuts . ShortcutActivity " 
 - android : theme = " @ style / AppcompatNoDisplay " 
 - android : launchMode = " singleInstance " > 
 + android : launchMode = " singleInstance " 
 + android : theme = " @ style / AppcompatNoDisplay " > 
 < intent - filter > 
 < action android : name = " im . actor . action . botMessageShortcut " / > 
 
 @ @ - 307 , 10 + 292 , 10 @ @ 
 
 < activity 
 android : name = " . controllers . calls . CallActivity " 
 - android : theme = " @ style / CallTheme " 
 android : launchMode = " singleInstance " 
 android : screenOrientation = " portrait " 
 - android : showOnLockScreen = " true " / > 
 + android : showOnLockScreen = " true " 
 + android : theme = " @ style / CallTheme " / > 
 
 < service 
 android : name = " im . actor . sdk . services . KeepAliveService " 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / activity / base / Controller . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / activity / base / Controller . java 
 index 427f54b . . 43f1eb8 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / activity / base / Controller . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / activity / base / Controller . java 
 @ @ - 12 , 9 + 12 , 6 @ @ import android . view . MenuInflater ; 
 import android . view . MenuItem ; 
 import android . view . View ; 
 
 - / * * 
 - * Created by ex3ndr on 25 . 10 . 14 . 
 - * / 
 public abstract class Controller < T extends AppCompatActivity > { 
 
 private T activity ; 
 @ @ - 23 , 9 + 20 , 13 @ @ public abstract class Controller < T extends AppCompatActivity > { 
 this . activity = activity ; 
 } 
 
 - public Resources getResources ( ) { return activity . getResources ( ) ; } 
 + public Resources getResources ( ) { 
 + return activity . getResources ( ) ; 
 + } 
 
 - public Intent getIntent ( ) { return activity . getIntent ( ) ; } 
 + public Intent getIntent ( ) { 
 + return activity . getIntent ( ) ; 
 + } 
 
 public View findViewById ( int id ) { 
 return activity . findViewById ( id ) ; 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / contacts / ContactsActivity . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / contacts / ContactsActivity . java 
 new file mode 100644 
 index 0000000 . . 2b2d3be 
 - - - / dev / null 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / contacts / ContactsActivity . java 
 @ @ - 0 , 0 + 1 , 22 @ @ 
 + package im . actor . sdk . controllers . contacts ; 
 + 
 + import android . os . Bundle ; 
 + import android . support . annotation . Nullable ; 
 + 
 + import im . actor . sdk . R ; 
 + import im . actor . sdk . controllers . activity . BaseFragmentActivity ; 
 + 
 + public class ContactsActivity extends BaseFragmentActivity { 
 + @ Override 
 + protected void onCreate ( @ Nullable Bundle savedInstanceState ) { 
 + super . onCreate ( savedInstanceState ) ; 
 + 
 + if ( getSupportActionBar ( ) ! = null ) { 
 + getSupportActionBar ( ) . setTitle ( R . string . contacts _ title ) ; 
 + } 
 + 
 + if ( savedInstanceState = = null ) { 
 + showFragment ( new ContactsFragment ( ) , false , false ) ; 
 + } 
 + } 
 + } 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java 
 index fbf50d4 . . 9afacc1 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java 
 @ @ - 251 , 6 + 251 , 8 @ @ public class ChatActivity extends ActorEditTextActivity { 
 
 super . onCreate ( saveInstance ) ; 
 
 + onCreateToolbar ( ) ; 
 + 
 messageEditText . addTextChangedListener ( new TextWatcherImp ( ) ) ; 
 messageEditText . setOnFocusChangeListener ( new View . OnFocusChangeListener ( ) { 
 @ Override 
 @ @ - 523 , 7 + 525 , 6 @ @ public class ChatActivity extends ActorEditTextActivity { 
 } 
 } 
 
 - @ Override 
 protected void onCreateToolbar ( ) { 
 / / Loading Toolbar header views 
 / / Binding to real data is performed in onResume method 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / profile / ProfileActivity . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / profile / ProfileActivity . java 
 index f9ebc2b . . a3c102f 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / profile / ProfileActivity . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / profile / ProfileActivity . java 
 @ @ - 3 , 8 + 3 , 6 @ @ package im . actor . sdk . controllers . profile ; 
 import android . graphics . Color ; 
 import android . graphics . drawable . ColorDrawable ; 
 import android . os . Bundle ; 
 - import android . support . v7 . app . ActionBar ; 
 - import android . support . v7 . app . AppCompatActivity ; 
 import android . view . Menu ; 
 import android . view . MenuItem ; 
 import android . widget . Toast ; 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / root / MainBaseController . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / root / MainBaseController . java 
 index 6ccce46 . . 73c993b 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / root / MainBaseController . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / root / MainBaseController . java 
 @ @ - 5 , 10 + 5 , 8 @ @ import im . actor . sdk . controllers . activity . ActorMainActivity ; 
 import im . actor . sdk . controllers . activity . base . Controller ; 
 import im . actor . core . entity . Dialog ; 
 
 - / * * 
 - * Created by ex3ndr on 25 . 10 . 14 . 
 - * / 
 public abstract class MainBaseController extends Controller < ActorMainActivity > { 
 + 
 protected MainBaseController ( ActorMainActivity activity ) { 
 super ( activity ) ; 
 } 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / root / MainPhoneController . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / root / MainPhoneController . java 
 index f2ce87d . . 8d49937 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / root / MainPhoneController . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / root / MainPhoneController . java 
 @ @ - 40 , 6 + 40 , 7 @ @ import im . actor . sdk . R ; 
 import im . actor . sdk . controllers . Intents ; 
 import im . actor . sdk . controllers . contacts . AddContactActivity ; 
 import im . actor . sdk . controllers . compose . ComposeActivity ; 
 + import im . actor . sdk . controllers . contacts . ContactsActivity ; 
 import im . actor . sdk . controllers . contacts . ContactsFragment ; 
 import im . actor . sdk . controllers . dialogs . DialogsFragment ; 
 import im . actor . sdk . controllers . fragment . help . HelpActivity ; 
 @ @ - 50 , 8 + 51 , 6 @ @ import im . actor . sdk . view . adapters . FragmentNoMenuStatePagerAdapter ; 
 import im . actor . sdk . view . adapters . HeaderViewRecyclerAdapter ; 
 import im . actor . sdk . view . adapters . OnItemClickedListener ; 
 import im . actor . sdk . view . PagerSlidingTabStrip ; 
 - import im . actor . runtime . mvvm . ValueDoubleChangedListener ; 
 - import im . actor . runtime . mvvm . Value ; 
 
 import static im . actor . sdk . util . ViewUtils . goneView ; 
 import static im . actor . sdk . util . ViewUtils . showView ; 
 @ @ - 59 , 10 + 58 , 6 @ @ import static im . actor . sdk . util . ActorSDKMessenger . messenger ; 
 
 public class MainPhoneController extends MainBaseController { 
 
 - protected ViewPager pager ; 
 - 
 - private HomePagerAdapter homePagerAdapter ; 
 - 
 private RecyclerView searchList ; 
 private View searchContainer ; 
 private TextView searchEmptyView ; 
 @ @ - 71 , 17 + 66 , 10 @ @ public class MainPhoneController extends MainBaseController { 
 private boolean isSearchVisible = false ; 
 private SearchAdapter searchAdapter ; 
 private BindedDisplayList < SearchEntity > searchDisplay ; 
 - private final DisplayList . Listener searchListener = new DisplayList . Listener ( ) { 
 - @ Override 
 - public void onCollectionChanged ( ) { 
 - onSearchChanged ( ) ; 
 - } 
 - } ; 
 + private final DisplayList . Listener searchListener = ( ) - > onSearchChanged ( ) ; 
 private SearchView searchView ; 
 private MenuItem searchMenu ; 
 
 - protected PagerSlidingTabStrip barTabs ; 
 - 
 private View syncInProgressView ; 
 private View emptyContactsView ; 
 
 @ @ - 105 , 17 + 93 , 11 @ @ public class MainPhoneController extends MainBaseController { 
 if ( ( sendUriMultiple ! = null & & ! sendUriMultiple . isEmpty ( ) ) | | docContent ! = null | | ( sendUriString ! = null & & ! sendUriString . isEmpty ( ) ) ) { 
 new AlertDialog . Builder ( getActivity ( ) ) 
 . setMessage ( getActivity ( ) . getString ( R . string . confirm _ share ) + " " + item . getDialogTitle ( ) + " ? " ) 
 - . setPositiveButton ( R . string . dialog _ ok , new DialogInterface . OnClickListener ( ) { 
 - @ Override 
 - public void onClick ( DialogInterface dialog , int which ) { 
 - openDialog ( item ) ; 
 - } 
 + . setPositiveButton ( R . string . dialog _ ok , ( dialog , which ) - > { 
 + openDialog ( item ) ; 
 } ) 
 - . setNegativeButton ( R . string . dialog _ cancel , new DialogInterface . OnClickListener ( ) { 
 - @ Override 
 - public void onClick ( DialogInterface dialog , int which ) { 
 - dialog . dismiss ( ) ; 
 - } 
 + . setNegativeButton ( R . string . dialog _ cancel , ( dialog , which ) - > { 
 + dialog . dismiss ( ) ; 
 } ) 
 . show ( ) ; 
 } else { 
 @ @ - 128 , 17 + 110 , 11 @ @ public class MainPhoneController extends MainBaseController { 
 if ( ( sendUriMultiple ! = null & & ! sendUriMultiple . isEmpty ( ) ) | | docContent ! = null | | ( sendUriString ! = null & & ! sendUriString . isEmpty ( ) ) ) { 
 new AlertDialog . Builder ( getActivity ( ) ) 
 . setMessage ( getActivity ( ) . getString ( R . string . confirm _ share ) + " " + contact . getName ( ) + " ? " ) 
 - . setPositiveButton ( R . string . dialog _ ok , new DialogInterface . OnClickListener ( ) { 
 - @ Override 
 - public void onClick ( DialogInterface dialog , int which ) { 
 - openContactDialog ( contact ) ; 
 - } 
 + . setPositiveButton ( R . string . dialog _ ok , ( dialog , which ) - > { 
 + openContactDialog ( contact ) ; 
 } ) 
 - . setNegativeButton ( R . string . dialog _ cancel , new DialogInterface . OnClickListener ( ) { 
 - @ Override 
 - public void onClick ( DialogInterface dialog , int which ) { 
 - dialog . dismiss ( ) ; 
 - } 
 + . setNegativeButton ( R . string . dialog _ cancel , ( dialog , which ) - > { 
 + dialog . dismiss ( ) ; 
 } ) 
 . show ( ) ; 
 } else { 
 @ @ - 231 , 54 + 207 , 48 @ @ public class MainPhoneController extends MainBaseController { 
 searchHintView . setVisibility ( View . GONE ) ; 
 searchEmptyView . setVisibility ( View . GONE ) ; 
 
 - pager = ( ViewPager ) findViewById ( R . id . vp _ pager ) ; 
 - pager . setOffscreenPageLimit ( 2 ) ; 
 - homePagerAdapter = getHomePagerAdapter ( ) ; 
 - pager . setAdapter ( homePagerAdapter ) ; 
 - pager . setCurrentItem ( 0 ) ; 
 - pager . setOnPageChangeListener ( new ViewPager . OnPageChangeListener ( ) { 
 - private int prevPage = - 1 ; 
 - 
 - @ Override 
 - public void onPageScrolled ( int position , float positionOffset , int positionOffsetPixels ) { 
 - 
 - } 
 - 
 - @ Override 
 - public void onPageSelected ( int position ) { 
 - if ( position = = 0 ) { 
 - if ( position ! = prevPage ) { 
 - } 
 - if ( prevPage = = 1 ) { 
 - } 
 - prevPage = position ; 
 - } else if ( position = = 1 ) { 
 - if ( position ! = prevPage ) { 
 - } 
 - if ( prevPage = = 0 ) { 
 - } 
 - prevPage = position ; 
 - } 
 - } 
 - 
 - @ Override 
 - public void onPageScrollStateChanged ( int state ) { 
 - 
 - } 
 - } ) ; 
 - 
 + / / pager = ( ViewPager ) findViewById ( R . id . vp _ pager ) ; 
 + / / pager . setOffscreenPageLimit ( 2 ) ; 
 + / / homePagerAdapter = getHomePagerAdapter ( ) ; 
 + / / pager . setAdapter ( homePagerAdapter ) ; 
 + / / pager . setCurrentItem ( 0 ) ; 
 + / / pager . setOnPageChangeListener ( new ViewPager . OnPageChangeListener ( ) { 
 + / / private int prevPage = - 1 ; 
 + / / 
 + / / @ Override 
 + / / public void onPageScrolled ( int position , float positionOffset , int positionOffsetPixels ) { 
 + / / 
 + / / } 
 + / / 
 + / / @ Override 
 + / / public void onPageSelected ( int position ) { 
 + / / if ( position = = 0 ) { 
 + / / prevPage = position ; 
 + / / } else if ( position = = 1 ) { 
 + / / prevPage = position ; 
 + / / } 
 + / / } 
 + / / 
 + / / @ Override 
 + / / public void onPageScrollStateChanged ( int state ) { 
 + / / 
 + / / } 
 + / / } ) ; 
 + 
 + if ( savedInstance = = null ) { 
 + getFragmentManager ( ) . beginTransaction ( ) 
 + . add ( R . id . contentRoot , new DialogsFragment ( ) ) 
 + . commit ( ) ; 
 + } 
 
 findViewById ( R . id . addContactButton ) . setOnClickListener ( v - > startActivity ( new Intent ( getActivity ( ) , AddContactActivity . class ) ) ) ; 
 
 - findViewById ( R . id . inviteButton ) . setOnClickListener ( new View . OnClickListener ( ) { 
 - @ Override 
 - public void onClick ( View v ) { 
 - String inviteMessage = getResources ( ) . getString ( R . string . invite _ message ) . replace ( " { inviteUrl } " , ActorSDK . sharedActor ( ) . getInviteUrl ( ) ) . replace ( " { appName } " , ActorSDK . sharedActor ( ) . getAppName ( ) ) ; 
 - Intent sendIntent = new Intent ( Intent . ACTION _ SEND ) ; 
 - sendIntent . putExtra ( Intent . EXTRA _ TEXT , inviteMessage ) ; 
 - sendIntent . setType ( " text / plain " ) ; 
 - startActivity ( sendIntent ) ; 
 - } 
 + findViewById ( R . id . inviteButton ) . setOnClickListener ( v - > { 
 + String inviteMessage = getResources ( ) . getString ( R . string . invite _ message ) . replace ( " { inviteUrl } " , ActorSDK . sharedActor ( ) . getInviteUrl ( ) ) . replace ( " { appName } " , ActorSDK . sharedActor ( ) . getAppName ( ) ) ; 
 + Intent sendIntent = new Intent ( Intent . ACTION _ SEND ) ; 
 + sendIntent . putExtra ( Intent . EXTRA _ TEXT , inviteMessage ) ; 
 + sendIntent . setType ( " text / plain " ) ; 
 + startActivity ( sendIntent ) ; 
 } ) ; 
 } 
 
 @ @ - 330 , 10 + 300 , 11 @ @ public class MainPhoneController extends MainBaseController { 
 @ Override 
 public void onResume ( ) { 
 ActionBar ab = getActionBar ( ) ; 
 - ab . setDisplayShowCustomEnabled ( true ) ; 
 + ab . setDisplayShowCustomEnabled ( false ) ; 
 ab . setDisplayHomeAsUpEnabled ( false ) ; 
 ab . setDisplayShowHomeEnabled ( false ) ; 
 - ab . setDisplayShowTitleEnabled ( false ) ; 
 + ab . setDisplayShowTitleEnabled ( true ) ; 
 + ab . setTitle ( getResources ( ) . getString ( R . string . app _ name ) ) ; 
 
 if ( ActorSDK . sharedActor ( ) . style . getToolBarColor ( ) ! = 0 ) { 
 ab . setBackgroundDrawable ( new ColorDrawable ( ActorSDK . sharedActor ( ) . style . getToolBarColor ( ) ) ) ; 
 @ @ - 347 , 61 + 318 , 57 @ @ public class MainPhoneController extends MainBaseController { 
 
 getActivity ( ) . bind ( messenger ( ) . getAppState ( ) . getIsAppLoaded ( ) , 
 messenger ( ) . getAppState ( ) . getIsAppEmpty ( ) , 
 - new ValueDoubleChangedListener < Boolean , Boolean > ( ) { 
 - @ Override 
 - public void onChanged ( Boolean isAppLoaded , Value < Boolean > Value , 
 - Boolean isAppEmpty , Value < Boolean > Value2 ) { 
 - if ( isAppEmpty ) { 
 - if ( isAppLoaded ) { 
 - onHideToolbarCustomView ( ) ; 
 - emptyContactsView . setVisibility ( View . VISIBLE ) ; 
 - syncInProgressView . setVisibility ( View . GONE ) ; 
 - getActivity ( ) . invalidateOptionsMenu ( ) ; 
 - } else { 
 - onHideToolbarCustomView ( ) ; 
 - emptyContactsView . setVisibility ( View . GONE ) ; 
 - syncInProgressView . setVisibility ( View . VISIBLE ) ; 
 - getActivity ( ) . invalidateOptionsMenu ( ) ; 
 - } 
 + ( isAppLoaded , Value , isAppEmpty , Value2 ) - > { 
 + if ( isAppEmpty ) { 
 + if ( isAppLoaded ) { 
 + onHideToolbarCustomView ( ) ; 
 + emptyContactsView . setVisibility ( View . VISIBLE ) ; 
 + syncInProgressView . setVisibility ( View . GONE ) ; 
 + getActivity ( ) . invalidateOptionsMenu ( ) ; 
 } else { 
 - onShowToolbarCustomView ( ) ; 
 + onHideToolbarCustomView ( ) ; 
 emptyContactsView . setVisibility ( View . GONE ) ; 
 - syncInProgressView . setVisibility ( View . GONE ) ; 
 + syncInProgressView . setVisibility ( View . VISIBLE ) ; 
 getActivity ( ) . invalidateOptionsMenu ( ) ; 
 } 
 + } else { 
 + onShowToolbarCustomView ( ) ; 
 + emptyContactsView . setVisibility ( View . GONE ) ; 
 + syncInProgressView . setVisibility ( View . GONE ) ; 
 + getActivity ( ) . invalidateOptionsMenu ( ) ; 
 } 
 } ) ; 
 } 
 
 protected void onShowToolbarCustomView ( ) { 
 - barTabs . setVisibility ( View . VISIBLE ) ; 
 + / / barTabs . setVisibility ( View . VISIBLE ) ; 
 } 
 
 protected void onHideToolbarCustomView ( ) { 
 - barTabs . setVisibility ( View . GONE ) ; 
 + / / barTabs . setVisibility ( View . GONE ) ; 
 } 
 
 protected void onConfigireToolbarCustomView ( ActionBar ab ) { 
 - FrameLayout tabsContainer = new FrameLayout ( getActivity ( ) ) ; 
 - barTabs = new PagerSlidingTabStrip ( getActivity ( ) ) ; 
 - barTabs . setTabBackground ( R . drawable . selector _ bar ) ; 
 - / / barTabs . setIndicatorColorResource ( R . color . main _ tab _ selected ) ; 
 - barTabs . setIndicatorHeight ( Screen . dp ( 2 ) ) ; 
 - 
 - barTabs . setDividerColorResource ( android . R . color . transparent ) ; 
 - / / barTabs . setTextColorResource ( R . color . main _ tab _ text ) ; 
 - barTabs . setTextSize ( Screen . dp ( 14 ) ) ; 
 - barTabs . setUnderlineHeight ( 0 ) ; 
 - 
 - barTabs . setViewPager ( pager ) ; 
 + / / FrameLayout tabsContainer = new FrameLayout ( getActivity ( ) ) ; 
 + / / barTabs = new PagerSlidingTabStrip ( getActivity ( ) ) ; 
 + / / barTabs . setTabBackground ( R . drawable . selector _ bar ) ; 
 + / / / / barTabs . setIndicatorColorResource ( R . color . main _ tab _ selected ) ; 
 + / / barTabs . setIndicatorHeight ( Screen . dp ( 2 ) ) ; 
 + / / 
 + / / barTabs . setDividerColorResource ( android . R . color . transparent ) ; 
 + / / / / barTabs . setTextColorResource ( R . color . main _ tab _ text ) ; 
 + / / barTabs . setTextSize ( Screen . dp ( 14 ) ) ; 
 + / / barTabs . setUnderlineHeight ( 0 ) ; 
 + / / 
 + / / barTabs . setViewPager ( pager ) ; 
 
 / / Icons 
 / / int width = Screen . dp ( 72 * 2 ) ; 
 
 - tabsContainer . addView ( barTabs , new FrameLayout . LayoutParams ( ViewGroup . LayoutParams . WRAP _ CONTENT , Screen . dp ( 56 ) ) ) ; 
 - Toolbar . LayoutParams lp = new Toolbar . LayoutParams ( ViewGroup . LayoutParams . WRAP _ CONTENT , Screen . dp ( 56 ) ) ; 
 - tabsContainer . setLayoutParams ( lp ) ; 
 - ab . setCustomView ( tabsContainer ) ; 
 + / / tabsContainer . addView ( barTabs , new FrameLayout . LayoutParams ( ViewGroup . LayoutParams . WRAP _ CONTENT , Screen . dp ( 56 ) ) ) ; 
 + / / Toolbar . LayoutParams lp = new Toolbar . LayoutParams ( ViewGroup . LayoutParams . WRAP _ CONTENT , Screen . dp ( 56 ) ) ; 
 + / / tabsContainer . setLayoutParams ( lp ) ; 
 + / / ab . setCustomView ( tabsContainer ) ; 
 } 
 
 
 @ @ - 549 , 6 + 516 , 9 @ @ public class MainPhoneController extends MainBaseController { 
 } else if ( i = = R . id . profile ) { 
 ActorSDK . sharedActor ( ) . startSettingActivity ( getActivity ( ) ) ; 
 return true ; 
 + } else if ( i = = R . id . contacts ) { 
 + startActivity ( new Intent ( getActivity ( ) , ContactsActivity . class ) ) ; 
 + return true ; 
 } 
 
 return false ; 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / actor _ activity _ main . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / actor _ activity _ main . xml 
 index 8f89d80 . . 62455f0 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / actor _ activity _ main . xml 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / actor _ activity _ main . xml 
 @ @ - 15 , 11 + 15 , 7 @ @ 
 android : layout _ width = " match _ parent " 
 android : layout _ height = " wrap _ content " 
 android : background = " ? attr / colorPrimary " 
 - android : contentInsetLeft = " 0dp " 
 - android : contentInsetStart = " 0dp " 
 android : minHeight = " 56dp " 
 - app : contentInsetLeft = " 0dp " 
 - app : contentInsetStart = " 0dp " 
 app : popupTheme = " @ style / ThemeOverlay . AppCompat . Dark . ActionBar " 
 app : theme = " @ style / ThemeOverlay . AppCompat . Dark . ActionBar " / > 
 
 @ @ - 29 , 8 + 25 , 8 @ @ 
 android : layout _ height = " match _ parent " 
 android : layout _ below = " @ + id / toolbar " > 
 
 - < android . support . v4 . view . ViewPager 
 - android : id = " @ + id / vp _ pager " 
 + < FrameLayout 
 + android : id = " @ + id / contentRoot " 
 android : layout _ width = " match _ parent " 
 android : layout _ height = " match _ parent " / > 
 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / menu / main . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / menu / main . xml 
 index d39654a . . fa4bd7b 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / menu / main . xml 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / menu / main . xml 
 @ @ - 15 , 8 + 15 , 12 @ @ 
 app : showAsAction = " always | collapseActionView " / > 
 
 < item 
 + android : id = " @ + id / contacts " 
 + android : title = " Contacts " 
 + app : showAsAction = " never " / > 
 + 
 + < item 
 android : id = " @ + id / profile " 
 android : title = " Profile " 
 - android : icon = " @ drawable / ic _ settings _ white _ 24dp " 
 - app : showAsAction = " always " / > 
 + app : showAsAction = " never " / > 
 < / menu > 
 \ No newline at end of file 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / styles . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / styles . xml 
 index 7912977 . . 5a2d9f7 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / styles . xml 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / styles . xml 
 @ @ - 1 , 5 + 1 , 4 @ @ 
 - < ? xml version = " 1 . 0 " encoding = " utf - 8 " ? > 
 - < ! - - 
 + < ? xml version = " 1 . 0 " encoding = " utf - 8 " ? > < ! - - 
 ~ Copyright ( C ) 2015 Actor LLC . < https : / / actor . im > 
 - - > 
 
 @ @ - 8 , 6 + 7 , 9 @ @ 
 < style name = " AppToolbarTheme " parent = " Theme . AppCompat . Light . DarkActionBar " > 
 < item name = " android : windowContentOverlay " > @ null < / item > 
 
 + < item name = " popupTheme " > @ style / ThemeOverlay . AppCompat . Light < / item > 
 + < item name = " android : popupTheme " > @ style / ThemeOverlay . AppCompat . Light < / item > 
 + 
 < item name = " colorPrimary " > @ color / primary < / item > 
 < item name = " colorPrimaryDark " > @ color / primary _ hovered < / item > 
 < item name = " colorAccent " > @ color / primary < / item > 
 @ @ - 16 , 12 + 18 , 12 @ @ 
 < item name = " android : colorPrimaryDark " > @ color / primary _ hovered < / item > 
 < item name = " android : colorAccent " > @ color / primary < / item > 
 
 - 
 < / style > 
 
 < style name = " MainActivityTheme " parent = " AppToolbarTheme " > 
 < item name = " android : windowBackground " > @ android : color / white < / item > 
 
 + 
 < item name = " windowActionBar " > false < / item > 
 < item name = " windowNoTitle " > true < / item > 
 < item name = " android : windowActionBar " > false < / item >
