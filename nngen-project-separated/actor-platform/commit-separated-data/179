BLEU SCORE: 0.31356006812336346

TEST MSG: feat ( android ) : remove overflow menu
GENERATED MSG: feat ( android ) : add to contacts button in private header

TEST DIFF (one line): diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / toolbar / ChatToolbarFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / toolbar / ChatToolbarFragment . java < nl > index d638569 . . 83398ef 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / toolbar / ChatToolbarFragment . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / toolbar / ChatToolbarFragment . java < nl > @ @ - 4 , 6 + 4 , 7 @ @ import android . Manifest ; < nl > import android . app . Activity ; < nl > import android . app . AlertDialog ; < nl > import android . content . pm . PackageManager ; < nl > + import android . graphics . Color ; < nl > import android . graphics . PorterDuff ; < nl > import android . os . Bundle ; < nl > import android . support . v4 . app . ActivityCompat ; < nl > @ @ - 145 , 24 + 146 , 18 @ @ public class ChatToolbarFragment extends BaseFragment { < nl > public void onResume ( ) { < nl > super . onResume ( ) ; < nl > < nl > - < nl > / / Performing all required Data Binding here < nl > < nl > if ( peer . getPeerType ( ) = = PeerType . PRIVATE ) { < nl > < nl > / / Loading user < nl > - final UserVM user = users ( ) . get ( peer . getPeerId ( ) ) ; < nl > - if ( user = = null ) { < nl > - < nl > - return ; < nl > - } < nl > + UserVM user = users ( ) . get ( peer . getPeerId ( ) ) ; < nl > < nl > / / Binding User Avatar to Toolbar < nl > bind ( barAvatar , user . getId ( ) , user . getAvatar ( ) , user . getName ( ) ) ; < nl > < nl > / / Binding User name to Toolbar < nl > bind ( barTitle , user . getName ( ) ) ; < nl > - < nl > bind ( user . getIsVerified ( ) , ( val , valueModel ) - > { < nl > barTitle . setCompoundDrawablesWithIntrinsicBounds ( null , null , < nl > val ? new TintDrawable ( < nl > @ @ - 186 , 16 + 181 , 19 @ @ public class ChatToolbarFragment extends BaseFragment { < nl > < nl > / / Loading group < nl > GroupVM group = groups ( ) . get ( peer . getPeerId ( ) ) ; < nl > - if ( group = = null ) { < nl > - / / finish ( ) ; < nl > - return ; < nl > - } < nl > < nl > / / Binding Group avatar to Toolbar < nl > bind ( barAvatar , group . getId ( ) , group . getAvatar ( ) , group . getName ( ) ) ; < nl > < nl > / / Binding Group title to Toolbar < nl > bind ( barTitle , group . getName ( ) ) ; < nl > + if ( group . getGroupType ( ) = = GroupType . CHANNEL ) { < nl > + barTitle . setCompoundDrawablesWithIntrinsicBounds ( new TintDrawable ( < nl > + getResources ( ) . getDrawable ( R . drawable . ic _ megaphone _ 18dp _ black ) , < nl > + Color . WHITE ) , null , null , null ) ; < nl > + } else { < nl > + barTitle . setCompoundDrawablesWithIntrinsicBounds ( null , null , null , null ) ; < nl > + } < nl > < nl > / / Subtitle is always visible for Groups < nl > barSubtitleContainer . setVisibility ( View . VISIBLE ) ; < nl > @ @ - 208 , 12 + 206 , 7 @ @ public class ChatToolbarFragment extends BaseFragment { < nl > bindGroupTyping ( barTyping , barTypingContainer , barSubtitle , messenger ( ) . getGroupTyping ( group . getId ( ) ) ) ; < nl > } < nl > } < nl > - < nl > - / / Show / Hide Avatar < nl > - if ( ! style . isShowAvatarInTitle ( ) | | ( peer . getPeerType ( ) = = PeerType . PRIVATE & & ! style . isShowAvatarPrivateInTitle ( ) ) ) { < nl > - barAvatar . setVisibility ( View . GONE ) ; < nl > - } < nl > - < nl > + < nl > / / Global Counter < nl > bind ( messenger ( ) . getGlobalState ( ) . getGlobalCounter ( ) , ( val , valueModel ) - > { < nl > if ( val ! = null & & val > 0 ) { < nl > @ @ - 233 , 31 + 226 , 31 @ @ public class ChatToolbarFragment extends BaseFragment { < nl > inflater . inflate ( R . menu . chat _ menu , menu ) ; < nl > < nl > / / Show menu for opening chat contact < nl > - if ( peer . getPeerType ( ) = = PeerType . PRIVATE ) { < nl > - menu . findItem ( R . id . contact ) . setVisible ( true ) ; < nl > - } else { < nl > - menu . findItem ( R . id . contact ) . setVisible ( false ) ; < nl > - } < nl > + / / if ( peer . getPeerType ( ) = = PeerType . PRIVATE ) { < nl > + / / menu . findItem ( R . id . contact ) . setVisible ( true ) ; < nl > + / / } else { < nl > + / / menu . findItem ( R . id . contact ) . setVisible ( false ) ; < nl > + / / } < nl > < nl > / / Show menus for leave group and group info view < nl > - if ( peer . getPeerType ( ) = = PeerType . GROUP ) { < nl > - GroupVM groupVM = groups ( ) . get ( peer . getPeerId ( ) ) ; < nl > - if ( groupVM . isMember ( ) . get ( ) ) { < nl > - menu . findItem ( R . id . leaveGroup ) . setVisible ( true ) ; < nl > - menu . findItem ( R . id . groupInfo ) . setVisible ( true ) ; < nl > - } else { < nl > - menu . findItem ( R . id . leaveGroup ) . setVisible ( false ) ; < nl > - menu . findItem ( R . id . groupInfo ) . setVisible ( false ) ; < nl > - } < nl > - if ( groupVM . getGroupType ( ) = = GroupType . GROUP ) { < nl > - menu . findItem ( R . id . clear ) . setVisible ( true ) ; < nl > - } else { < nl > - menu . findItem ( R . id . clear ) . setVisible ( false ) ; < nl > - } < nl > - } else { < nl > - menu . findItem ( R . id . groupInfo ) . setVisible ( false ) ; < nl > - menu . findItem ( R . id . leaveGroup ) . setVisible ( false ) ; < nl > - } < nl > + / / if ( peer . getPeerType ( ) = = PeerType . GROUP ) { < nl > + / / GroupVM groupVM = groups ( ) . get ( peer . getPeerId ( ) ) ; < nl > + / / if ( groupVM . isMember ( ) . get ( ) ) { < nl > + / / menu . findItem ( R . id . leaveGroup ) . setVisible ( true ) ; < nl > + / / menu . findItem ( R . id . groupInfo ) . setVisible ( true ) ; < nl > + / / } else { < nl > + / / menu . findItem ( R . id . leaveGroup ) . setVisible ( false ) ; < nl > + / / menu . findItem ( R . id . groupInfo ) . setVisible ( false ) ; < nl > + / / } < nl > + / / if ( groupVM . getGroupType ( ) = = GroupType . GROUP ) { < nl > + / / menu . findItem ( R . id . clear ) . setVisible ( true ) ; < nl > + / / } else { < nl > + / / menu . findItem ( R . id . clear ) . setVisible ( false ) ; < nl > + / / } < nl > + / / } else { < nl > + / / menu . findItem ( R . id . groupInfo ) . setVisible ( false ) ; < nl > + / / menu . findItem ( R . id . leaveGroup ) . setVisible ( false ) ; < nl > + / / } < nl > < nl > / / Voice and Video calls < nl > boolean callsEnabled = ActorSDK . sharedActor ( ) . isCallsEnabled ( ) ; < nl > @ @ - 291 , 7 + 284 , 7 @ @ public class ChatToolbarFragment extends BaseFragment { < nl > int i = item . getItemId ( ) ; < nl > if ( i = = android . R . id . home ) { < nl > getActivity ( ) . finish ( ) ; < nl > - } else if ( i = = R . id . clear ) { < nl > + } / * else if ( i = = R . id . clear ) { < nl > new AlertDialog . Builder ( getActivity ( ) ) < nl > . setMessage ( R . string . alert _ delete _ all _ messages _ text ) < nl > . setPositiveButton ( R . string . alert _ delete _ all _ messages _ yes , ( dialog , which ) - > { < nl > @ @ - 338 , 7 + 331 , 7 @ @ public class ChatToolbarFragment extends BaseFragment { < nl > ActorSDKLauncher . startProfileActivity ( getActivity ( ) , peer . getPeerId ( ) ) ; < nl > } else if ( i = = R . id . groupInfo ) { < nl > ActorSDK . sharedActor ( ) . startGroupInfoActivity ( getActivity ( ) , peer . getPeerId ( ) ) ; < nl > - } else if ( i = = R . id . add _ to _ contacts ) { < nl > + } * / else if ( i = = R . id . add _ to _ contacts ) { < nl > execute ( messenger ( ) . addContact ( peer . getPeerId ( ) ) ) ; < nl > } < nl > < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / menu / chat _ menu . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / menu / chat _ menu . xml < nl > index 500ad7a . . 5a8e39f 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / menu / chat _ menu . xml < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / menu / chat _ menu . xml < nl > @ @ - 26 , 16 + 26 , 16 @ @ < nl > android : title = " " < nl > app : showAsAction = " always " / > < nl > < nl > - < item < nl > - android : id = " @ + id / groupInfo " < nl > - android : title = " @ string / chat _ menu _ group _ info " / > < nl > - < item < nl > - android : id = " @ + id / contact " < nl > - android : title = " @ string / chat _ menu _ view _ contact " / > < nl > - < item < nl > - android : id = " @ + id / clear " < nl > - android : title = " @ string / chat _ menu _ clear _ chat " / > < nl > - < item < nl > - android : id = " @ + id / leaveGroup " < nl > - android : title = " @ string / chat _ menu _ leave _ group " / > < nl > + < ! - - < item - - > < nl > + < ! - - android : id = " @ + id / groupInfo " - - > < nl > + < ! - - android : title = " @ string / chat _ menu _ group _ info " / > - - > < nl > + < ! - - < item - - > < nl > + < ! - - android : id = " @ + id / contact " - - > < nl > + < ! - - android : title = " @ string / chat _ menu _ view _ contact " / > - - > < nl > + < ! - - < item - - > < nl > + < ! - - android : id = " @ + id / clear " - - > < nl > + < ! - - android : title = " @ string / chat _ menu _ clear _ chat " / > - - > < nl > + < ! - - < item - - > < nl > + < ! - - android : id = " @ + id / leaveGroup " - - > < nl > + < ! - - android : title = " @ string / chat _ menu _ leave _ group " / > - - > < nl > < / menu > < nl > \ No newline at end of file
NEAREST DIFF (one line): diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java < nl > index 34d9c73 . . 7b9040d 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java < nl > @ @ - 215 , 6 + 215 , 7 @ @ public class ChatActivity extends ActorEditTextActivity { < nl > private boolean textEditing = false ; < nl > private long currentEditRid ; < nl > private Animation . AnimationListener animationListener ; < nl > + private Menu menu ; < nl > < nl > public static Intent build ( Peer peer , boolean compose , Context context ) { < nl > final Intent intent = new Intent ( context , ChatActivity . class ) ; < nl > @ @ - 564 , 6 + 565 , 11 @ @ public class ChatActivity extends ActorEditTextActivity { < nl > public void onResume ( ) { < nl > super . onResume ( ) ; < nl > < nl > + if ( peer . getPeerType ( ) = = PeerType . PRIVATE & & menu ! = null ) { < nl > + menu . findItem ( R . id . add _ to _ contacts ) . setVisible ( users ( ) . get ( peer . getPeerId ( ) ) . isContact ( ) . get ( ) ) ; < nl > + invalidateOptionsMenu ( ) ; < nl > + } < nl > + < nl > emojiKeyboard . setPeer ( peer ) ; < nl > < nl > voiceRecordActor = ActorSystem . system ( ) . actorOf ( Props . create ( new ActorCreator ( ) { < nl > @ @ - 1110 , 7 + 1116 , 8 @ @ public class ChatActivity extends ActorEditTextActivity { < nl > / / Options Menu < nl > < nl > @ Override < nl > - public boolean onCreateOptionsMenu ( Menu menu ) { < nl > + public boolean onCreateOptionsMenu ( final Menu menu ) { < nl > + this . menu = menu ; < nl > < nl > / / Inflating menu < nl > getMenuInflater ( ) . inflate ( R . menu . chat _ menu , menu ) ; < nl > @ @ - 1146 , 6 + 1153 , 15 @ @ public class ChatActivity extends ActorEditTextActivity { < nl > } < nl > menu . findItem ( R . id . call ) . setVisible ( callsEnabled ) ; < nl > < nl > + if ( peer . getPeerType ( ) = = PeerType . PRIVATE ) { < nl > + bind ( users ( ) . get ( peer . getPeerId ( ) ) . isContact ( ) , new ValueChangedListener < Boolean > ( ) { < nl > + @ Override < nl > + public void onChanged ( Boolean val , Value < Boolean > valueModel ) { < nl > + menu . findItem ( R . id . add _ to _ contacts ) . setVisible ( ! val ) ; < nl > + invalidateOptionsMenu ( ) ; < nl > + } < nl > + } ) ; < nl > + } < nl > < nl > / / Hide unsupported files menu < nl > menu . findItem ( R . id . files ) . setVisible ( false ) ; < nl > @ @ - 1197 , 6 + 1213 , 8 @ @ public class ChatActivity extends ActorEditTextActivity { < nl > < nl > } else if ( i = = R . id . files ) { / / startActivity ( Intents . openDocs ( chatType , chatId , ChatActivity . this ) ) ; < nl > < nl > + } else if ( i = = R . id . add _ to _ contacts ) { < nl > + execute ( messenger ( ) . addContact ( peer . getPeerId ( ) ) ) ; < nl > } < nl > < nl > if ( ActorSDK . sharedActor ( ) . isCallsEnabled ( ) ) { < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / menu / chat _ menu . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / menu / chat _ menu . xml < nl > index 88f0b13 . . 974ac3f 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / menu / chat _ menu . xml < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / menu / chat _ menu . xml < nl > @ @ - 8 , 6 + 8 , 13 @ @ < nl > xmlns : app = " http : / / schemas . android . com / apk / res - auto " > < nl > < nl > < item < nl > + android : visible = " false " < nl > + android : id = " @ + id / add _ to _ contacts " < nl > + android : icon = " @ drawable / ic _ person _ add _ white _ 24dp " < nl > + android : title = " @ string / add _ contact _ title " < nl > + app : showAsAction = " always " / > < nl > + < nl > + < item < nl > android : id = " @ + id / call " < nl > android : icon = " @ drawable / ic _ phone _ white _ 24dp " < nl > android : title = " "

TEST DIFF:
diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / toolbar / ChatToolbarFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / toolbar / ChatToolbarFragment . java 
 index d638569 . . 83398ef 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / toolbar / ChatToolbarFragment . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / toolbar / ChatToolbarFragment . java 
 @ @ - 4 , 6 + 4 , 7 @ @ import android . Manifest ; 
 import android . app . Activity ; 
 import android . app . AlertDialog ; 
 import android . content . pm . PackageManager ; 
 + import android . graphics . Color ; 
 import android . graphics . PorterDuff ; 
 import android . os . Bundle ; 
 import android . support . v4 . app . ActivityCompat ; 
 @ @ - 145 , 24 + 146 , 18 @ @ public class ChatToolbarFragment extends BaseFragment { 
 public void onResume ( ) { 
 super . onResume ( ) ; 
 
 - 
 / / Performing all required Data Binding here 
 
 if ( peer . getPeerType ( ) = = PeerType . PRIVATE ) { 
 
 / / Loading user 
 - final UserVM user = users ( ) . get ( peer . getPeerId ( ) ) ; 
 - if ( user = = null ) { 
 - 
 - return ; 
 - } 
 + UserVM user = users ( ) . get ( peer . getPeerId ( ) ) ; 
 
 / / Binding User Avatar to Toolbar 
 bind ( barAvatar , user . getId ( ) , user . getAvatar ( ) , user . getName ( ) ) ; 
 
 / / Binding User name to Toolbar 
 bind ( barTitle , user . getName ( ) ) ; 
 - 
 bind ( user . getIsVerified ( ) , ( val , valueModel ) - > { 
 barTitle . setCompoundDrawablesWithIntrinsicBounds ( null , null , 
 val ? new TintDrawable ( 
 @ @ - 186 , 16 + 181 , 19 @ @ public class ChatToolbarFragment extends BaseFragment { 
 
 / / Loading group 
 GroupVM group = groups ( ) . get ( peer . getPeerId ( ) ) ; 
 - if ( group = = null ) { 
 - / / finish ( ) ; 
 - return ; 
 - } 
 
 / / Binding Group avatar to Toolbar 
 bind ( barAvatar , group . getId ( ) , group . getAvatar ( ) , group . getName ( ) ) ; 
 
 / / Binding Group title to Toolbar 
 bind ( barTitle , group . getName ( ) ) ; 
 + if ( group . getGroupType ( ) = = GroupType . CHANNEL ) { 
 + barTitle . setCompoundDrawablesWithIntrinsicBounds ( new TintDrawable ( 
 + getResources ( ) . getDrawable ( R . drawable . ic _ megaphone _ 18dp _ black ) , 
 + Color . WHITE ) , null , null , null ) ; 
 + } else { 
 + barTitle . setCompoundDrawablesWithIntrinsicBounds ( null , null , null , null ) ; 
 + } 
 
 / / Subtitle is always visible for Groups 
 barSubtitleContainer . setVisibility ( View . VISIBLE ) ; 
 @ @ - 208 , 12 + 206 , 7 @ @ public class ChatToolbarFragment extends BaseFragment { 
 bindGroupTyping ( barTyping , barTypingContainer , barSubtitle , messenger ( ) . getGroupTyping ( group . getId ( ) ) ) ; 
 } 
 } 
 - 
 - / / Show / Hide Avatar 
 - if ( ! style . isShowAvatarInTitle ( ) | | ( peer . getPeerType ( ) = = PeerType . PRIVATE & & ! style . isShowAvatarPrivateInTitle ( ) ) ) { 
 - barAvatar . setVisibility ( View . GONE ) ; 
 - } 
 - 
 + 
 / / Global Counter 
 bind ( messenger ( ) . getGlobalState ( ) . getGlobalCounter ( ) , ( val , valueModel ) - > { 
 if ( val ! = null & & val > 0 ) { 
 @ @ - 233 , 31 + 226 , 31 @ @ public class ChatToolbarFragment extends BaseFragment { 
 inflater . inflate ( R . menu . chat _ menu , menu ) ; 
 
 / / Show menu for opening chat contact 
 - if ( peer . getPeerType ( ) = = PeerType . PRIVATE ) { 
 - menu . findItem ( R . id . contact ) . setVisible ( true ) ; 
 - } else { 
 - menu . findItem ( R . id . contact ) . setVisible ( false ) ; 
 - } 
 + / / if ( peer . getPeerType ( ) = = PeerType . PRIVATE ) { 
 + / / menu . findItem ( R . id . contact ) . setVisible ( true ) ; 
 + / / } else { 
 + / / menu . findItem ( R . id . contact ) . setVisible ( false ) ; 
 + / / } 
 
 / / Show menus for leave group and group info view 
 - if ( peer . getPeerType ( ) = = PeerType . GROUP ) { 
 - GroupVM groupVM = groups ( ) . get ( peer . getPeerId ( ) ) ; 
 - if ( groupVM . isMember ( ) . get ( ) ) { 
 - menu . findItem ( R . id . leaveGroup ) . setVisible ( true ) ; 
 - menu . findItem ( R . id . groupInfo ) . setVisible ( true ) ; 
 - } else { 
 - menu . findItem ( R . id . leaveGroup ) . setVisible ( false ) ; 
 - menu . findItem ( R . id . groupInfo ) . setVisible ( false ) ; 
 - } 
 - if ( groupVM . getGroupType ( ) = = GroupType . GROUP ) { 
 - menu . findItem ( R . id . clear ) . setVisible ( true ) ; 
 - } else { 
 - menu . findItem ( R . id . clear ) . setVisible ( false ) ; 
 - } 
 - } else { 
 - menu . findItem ( R . id . groupInfo ) . setVisible ( false ) ; 
 - menu . findItem ( R . id . leaveGroup ) . setVisible ( false ) ; 
 - } 
 + / / if ( peer . getPeerType ( ) = = PeerType . GROUP ) { 
 + / / GroupVM groupVM = groups ( ) . get ( peer . getPeerId ( ) ) ; 
 + / / if ( groupVM . isMember ( ) . get ( ) ) { 
 + / / menu . findItem ( R . id . leaveGroup ) . setVisible ( true ) ; 
 + / / menu . findItem ( R . id . groupInfo ) . setVisible ( true ) ; 
 + / / } else { 
 + / / menu . findItem ( R . id . leaveGroup ) . setVisible ( false ) ; 
 + / / menu . findItem ( R . id . groupInfo ) . setVisible ( false ) ; 
 + / / } 
 + / / if ( groupVM . getGroupType ( ) = = GroupType . GROUP ) { 
 + / / menu . findItem ( R . id . clear ) . setVisible ( true ) ; 
 + / / } else { 
 + / / menu . findItem ( R . id . clear ) . setVisible ( false ) ; 
 + / / } 
 + / / } else { 
 + / / menu . findItem ( R . id . groupInfo ) . setVisible ( false ) ; 
 + / / menu . findItem ( R . id . leaveGroup ) . setVisible ( false ) ; 
 + / / } 
 
 / / Voice and Video calls 
 boolean callsEnabled = ActorSDK . sharedActor ( ) . isCallsEnabled ( ) ; 
 @ @ - 291 , 7 + 284 , 7 @ @ public class ChatToolbarFragment extends BaseFragment { 
 int i = item . getItemId ( ) ; 
 if ( i = = android . R . id . home ) { 
 getActivity ( ) . finish ( ) ; 
 - } else if ( i = = R . id . clear ) { 
 + } / * else if ( i = = R . id . clear ) { 
 new AlertDialog . Builder ( getActivity ( ) ) 
 . setMessage ( R . string . alert _ delete _ all _ messages _ text ) 
 . setPositiveButton ( R . string . alert _ delete _ all _ messages _ yes , ( dialog , which ) - > { 
 @ @ - 338 , 7 + 331 , 7 @ @ public class ChatToolbarFragment extends BaseFragment { 
 ActorSDKLauncher . startProfileActivity ( getActivity ( ) , peer . getPeerId ( ) ) ; 
 } else if ( i = = R . id . groupInfo ) { 
 ActorSDK . sharedActor ( ) . startGroupInfoActivity ( getActivity ( ) , peer . getPeerId ( ) ) ; 
 - } else if ( i = = R . id . add _ to _ contacts ) { 
 + } * / else if ( i = = R . id . add _ to _ contacts ) { 
 execute ( messenger ( ) . addContact ( peer . getPeerId ( ) ) ) ; 
 } 
 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / menu / chat _ menu . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / menu / chat _ menu . xml 
 index 500ad7a . . 5a8e39f 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / menu / chat _ menu . xml 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / menu / chat _ menu . xml 
 @ @ - 26 , 16 + 26 , 16 @ @ 
 android : title = " " 
 app : showAsAction = " always " / > 
 
 - < item 
 - android : id = " @ + id / groupInfo " 
 - android : title = " @ string / chat _ menu _ group _ info " / > 
 - < item 
 - android : id = " @ + id / contact " 
 - android : title = " @ string / chat _ menu _ view _ contact " / > 
 - < item 
 - android : id = " @ + id / clear " 
 - android : title = " @ string / chat _ menu _ clear _ chat " / > 
 - < item 
 - android : id = " @ + id / leaveGroup " 
 - android : title = " @ string / chat _ menu _ leave _ group " / > 
 + < ! - - < item - - > 
 + < ! - - android : id = " @ + id / groupInfo " - - > 
 + < ! - - android : title = " @ string / chat _ menu _ group _ info " / > - - > 
 + < ! - - < item - - > 
 + < ! - - android : id = " @ + id / contact " - - > 
 + < ! - - android : title = " @ string / chat _ menu _ view _ contact " / > - - > 
 + < ! - - < item - - > 
 + < ! - - android : id = " @ + id / clear " - - > 
 + < ! - - android : title = " @ string / chat _ menu _ clear _ chat " / > - - > 
 + < ! - - < item - - > 
 + < ! - - android : id = " @ + id / leaveGroup " - - > 
 + < ! - - android : title = " @ string / chat _ menu _ leave _ group " / > - - > 
 < / menu > 
 \ No newline at end of file

NEAREST DIFF:
diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java 
 index 34d9c73 . . 7b9040d 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java 
 @ @ - 215 , 6 + 215 , 7 @ @ public class ChatActivity extends ActorEditTextActivity { 
 private boolean textEditing = false ; 
 private long currentEditRid ; 
 private Animation . AnimationListener animationListener ; 
 + private Menu menu ; 
 
 public static Intent build ( Peer peer , boolean compose , Context context ) { 
 final Intent intent = new Intent ( context , ChatActivity . class ) ; 
 @ @ - 564 , 6 + 565 , 11 @ @ public class ChatActivity extends ActorEditTextActivity { 
 public void onResume ( ) { 
 super . onResume ( ) ; 
 
 + if ( peer . getPeerType ( ) = = PeerType . PRIVATE & & menu ! = null ) { 
 + menu . findItem ( R . id . add _ to _ contacts ) . setVisible ( users ( ) . get ( peer . getPeerId ( ) ) . isContact ( ) . get ( ) ) ; 
 + invalidateOptionsMenu ( ) ; 
 + } 
 + 
 emojiKeyboard . setPeer ( peer ) ; 
 
 voiceRecordActor = ActorSystem . system ( ) . actorOf ( Props . create ( new ActorCreator ( ) { 
 @ @ - 1110 , 7 + 1116 , 8 @ @ public class ChatActivity extends ActorEditTextActivity { 
 / / Options Menu 
 
 @ Override 
 - public boolean onCreateOptionsMenu ( Menu menu ) { 
 + public boolean onCreateOptionsMenu ( final Menu menu ) { 
 + this . menu = menu ; 
 
 / / Inflating menu 
 getMenuInflater ( ) . inflate ( R . menu . chat _ menu , menu ) ; 
 @ @ - 1146 , 6 + 1153 , 15 @ @ public class ChatActivity extends ActorEditTextActivity { 
 } 
 menu . findItem ( R . id . call ) . setVisible ( callsEnabled ) ; 
 
 + if ( peer . getPeerType ( ) = = PeerType . PRIVATE ) { 
 + bind ( users ( ) . get ( peer . getPeerId ( ) ) . isContact ( ) , new ValueChangedListener < Boolean > ( ) { 
 + @ Override 
 + public void onChanged ( Boolean val , Value < Boolean > valueModel ) { 
 + menu . findItem ( R . id . add _ to _ contacts ) . setVisible ( ! val ) ; 
 + invalidateOptionsMenu ( ) ; 
 + } 
 + } ) ; 
 + } 
 
 / / Hide unsupported files menu 
 menu . findItem ( R . id . files ) . setVisible ( false ) ; 
 @ @ - 1197 , 6 + 1213 , 8 @ @ public class ChatActivity extends ActorEditTextActivity { 
 
 } else if ( i = = R . id . files ) { / / startActivity ( Intents . openDocs ( chatType , chatId , ChatActivity . this ) ) ; 
 
 + } else if ( i = = R . id . add _ to _ contacts ) { 
 + execute ( messenger ( ) . addContact ( peer . getPeerId ( ) ) ) ; 
 } 
 
 if ( ActorSDK . sharedActor ( ) . isCallsEnabled ( ) ) { 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / menu / chat _ menu . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / menu / chat _ menu . xml 
 index 88f0b13 . . 974ac3f 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / menu / chat _ menu . xml 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / menu / chat _ menu . xml 
 @ @ - 8 , 6 + 8 , 13 @ @ 
 xmlns : app = " http : / / schemas . android . com / apk / res - auto " > 
 
 < item 
 + android : visible = " false " 
 + android : id = " @ + id / add _ to _ contacts " 
 + android : icon = " @ drawable / ic _ person _ add _ white _ 24dp " 
 + android : title = " @ string / add _ contact _ title " 
 + app : showAsAction = " always " / > 
 + 
 + < item 
 android : id = " @ + id / call " 
 android : icon = " @ drawable / ic _ phone _ white _ 24dp " 
 android : title = " "
