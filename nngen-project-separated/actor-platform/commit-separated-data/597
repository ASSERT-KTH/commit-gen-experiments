BLEU SCORE: 0.392814650900513

TEST MSG: feat ( android ) : Removed FAB from profile screen
GENERATED MSG: feat ( android ) : chat unread counter

TEST DIFF (one line): diff - - git a / actor - sdk / sdk - core - android / android - app / src / main / java / im / actor / Application . java b / actor - sdk / sdk - core - android / android - app / src / main / java / im / actor / Application . java < nl > index c2e0ae8 . . 15167b1 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - app / src / main / java / im / actor / Application . java < nl > + + + b / actor - sdk / sdk - core - android / android - app / src / main / java / im / actor / Application . java < nl > @ @ - 31 , 6 + 31 , 9 @ @ public class Application extends ActorSDKApplication { < nl > style . setDialogsActiveTextColor ( 0xff5882ac ) ; < nl > < nl > ActorSDK . sharedActor ( ) . setFastShareEnabled ( true ) ; < nl > + < nl > + ActorSDK . sharedActor ( ) . setCallsEnabled ( true ) ; < nl > + < nl > / / ActorSDK . sharedActor ( ) . setTwitter ( " " ) ; < nl > / / ActorSDK . sharedActor ( ) . setHomePage ( " http : / / www . foo . com " ) ; < nl > / / ActorSDK . sharedActor ( ) . setInviteUrl ( " http : / / www . foo . com " ) ; < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / profile / ProfileFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / profile / ProfileFragment . java < nl > index debdd6a . . 87e9776 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / profile / ProfileFragment . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / profile / ProfileFragment . java < nl > @ @ - 34 , 6 + 34 , 8 @ @ import com . google . i18n . phonenumbers . Phonenumber ; < nl > import java . util . ArrayList ; < nl > < nl > import im . actor . core . viewmodel . UserEmail ; < nl > + import im . actor . runtime . actors . Actor ; < nl > + import im . actor . sdk . ActorSDK ; < nl > import im . actor . sdk . R ; < nl > import im . actor . sdk . controllers . Intents ; < nl > import im . actor . sdk . controllers . fragment . preview . ViewAvatarActivity ; < nl > @ @ - 98 , 17 + 100 , 17 @ @ public class ProfileFragment extends BaseFragment { < nl > / / Floating Action Button < nl > / / < nl > < nl > - FloatingActionButton fab = ( FloatingActionButton ) res . findViewById ( R . id . profileAction ) ; < nl > - fab . setColorNormal ( style . getFabColor ( ) ) ; < nl > - fab . setColorPressed ( style . getFabPressedColor ( ) ) ; < nl > - < nl > - fab . setVisibility ( View . VISIBLE ) ; < nl > - fab . setOnClickListener ( new View . OnClickListener ( ) { < nl > - @ Override < nl > - public void onClick ( View v ) { < nl > - startActivity ( Intents . openPrivateDialog ( user . getId ( ) , true , getActivity ( ) ) ) ; < nl > - } < nl > - } ) ; < nl > + / / FloatingActionButton fab = ( FloatingActionButton ) res . findViewById ( R . id . profileAction ) ; < nl > + / / fab . setColorNormal ( style . getFabColor ( ) ) ; < nl > + / / fab . setColorPressed ( style . getFabPressedColor ( ) ) ; < nl > + / / < nl > + / / fab . setVisibility ( View . VISIBLE ) ; < nl > + / / fab . setOnClickListener ( new View . OnClickListener ( ) { < nl > + / / @ Override < nl > + / / public void onClick ( View v ) { < nl > + / / startActivity ( Intents . openPrivateDialog ( user . getId ( ) , true , getActivity ( ) ) ) ; < nl > + / / } < nl > + / / } ) ; < nl > < nl > < nl > / / < nl > @ @ - 138 , 6 + 140 , 26 @ @ public class ProfileFragment extends BaseFragment { < nl > < nl > < nl > / / < nl > + / / Compose < nl > + / / < nl > + < nl > + buildRecordAction ( " Free Message " , R . drawable . ic _ chat _ bubble _ white _ 24dp , true , false , inflater , contactsContainer ) . setOnClickListener ( new View . OnClickListener ( ) { < nl > + @ Override < nl > + public void onClick ( View v ) { < nl > + startActivity ( Intents . openPrivateDialog ( user . getId ( ) , true , getActivity ( ) ) ) ; < nl > + } < nl > + } ) ; < nl > + < nl > + if ( ActorSDK . sharedActor ( ) . isCallsEnabled ( ) ) { < nl > + buildRecordAction ( " Free Call " , R . drawable . ic _ phone _ white _ 24dp , true , true , inflater , contactsContainer ) . setOnClickListener ( new View . OnClickListener ( ) { < nl > + @ Override < nl > + public void onClick ( View v ) { < nl > + execute ( ActorSDK . sharedActor ( ) . getMessenger ( ) . doCall ( user . getId ( ) ) ) ; < nl > + } < nl > + } ) ; < nl > + } < nl > + < nl > + / / < nl > / / Phones < nl > / / < nl > < nl > @ @ - 393 , 7 + 415 , 7 @ @ public class ProfileFragment extends BaseFragment { < nl > return buildRecord ( titleText , valueText , 0 , false , isLast , inflater , container ) ; < nl > } < nl > < nl > - private View buildRecord ( String titleText , String valueText , int resourceId , boolean isFirst , boolean isLast , < nl > + private View buildRecord ( String titleText , String valueText , int resourceId , boolean showIcon , boolean isLast , < nl > LayoutInflater inflater , ViewGroup container ) { < nl > final View recordView = inflater . inflate ( R . layout . contact _ record , container , false ) ; < nl > TextView value = ( TextView ) recordView . findViewById ( R . id . value ) ; < nl > @ @ - 409 , 7 + 431 , 7 @ @ public class ProfileFragment extends BaseFragment { < nl > recordView . findViewById ( R . id . divider ) . setVisibility ( View . GONE ) ; < nl > } < nl > < nl > - if ( resourceId ! = 0 & & isFirst ) { < nl > + if ( resourceId ! = 0 & & showIcon ) { < nl > ImageView iconView = ( ImageView ) recordView . findViewById ( R . id . recordIcon ) ; < nl > Drawable drawable = DrawableCompat . wrap ( getResources ( ) . getDrawable ( resourceId ) ) ; < nl > DrawableCompat . setTint ( drawable , style . getSettingsIconColor ( ) ) ; < nl > @ @ - 421 , 7 + 443 , 7 @ @ public class ProfileFragment extends BaseFragment { < nl > return recordView ; < nl > } < nl > < nl > - private View buildRecordBig ( String valueText , int resourceId , boolean isFirst , boolean isLast , < nl > + private View buildRecordBig ( String valueText , int resourceId , boolean showIcon , boolean isLast , < nl > LayoutInflater inflater , ViewGroup container ) { < nl > final View recordView = inflater . inflate ( R . layout . contact _ record _ big , container , false ) ; < nl > TextView value = ( TextView ) recordView . findViewById ( R . id . value ) ; < nl > @ @ - 433 , 7 + 455 , 7 @ @ public class ProfileFragment extends BaseFragment { < nl > recordView . findViewById ( R . id . divider ) . setVisibility ( View . GONE ) ; < nl > } < nl > < nl > - if ( resourceId ! = 0 & & isFirst ) { < nl > + if ( resourceId ! = 0 & & showIcon ) { < nl > ImageView iconView = ( ImageView ) recordView . findViewById ( R . id . recordIcon ) ; < nl > Drawable drawable = DrawableCompat . wrap ( getResources ( ) . getDrawable ( resourceId ) ) ; < nl > DrawableCompat . setTint ( drawable , style . getSettingsIconColor ( ) ) ; < nl > @ @ - 445 , 6 + 467 , 30 @ @ public class ProfileFragment extends BaseFragment { < nl > return recordView ; < nl > } < nl > < nl > + private View buildRecordAction ( String valueText , int resourceId , boolean showIcon , boolean isLast , < nl > + LayoutInflater inflater , ViewGroup container ) { < nl > + final View recordView = inflater . inflate ( R . layout . contact _ record _ big , container , false ) ; < nl > + TextView value = ( TextView ) recordView . findViewById ( R . id . value ) ; < nl > + < nl > + value . setTextColor ( style . getGroupActionAddTextColor ( ) ) ; < nl > + value . setText ( valueText ) ; < nl > + < nl > + if ( ! isLast ) { < nl > + recordView . findViewById ( R . id . divider ) . setVisibility ( View . GONE ) ; < nl > + } < nl > + < nl > + if ( resourceId ! = 0 & & showIcon ) { < nl > + ImageView iconView = ( ImageView ) recordView . findViewById ( R . id . recordIcon ) ; < nl > + Drawable drawable = DrawableCompat . wrap ( getResources ( ) . getDrawable ( resourceId ) ) ; < nl > + DrawableCompat . setTint ( drawable , style . getGroupActionAddIconColor ( ) ) ; < nl > + iconView . setImageDrawable ( drawable ) ; < nl > + } < nl > + < nl > + container . addView ( recordView ) ; < nl > + < nl > + return recordView ; < nl > + } < nl > + < nl > @ Override < nl > public void onDestroyView ( ) { < nl > super . onDestroyView ( ) ; < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / contact _ record _ big . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / contact _ record _ big . xml < nl > index 61e34f2 . . 20d8d0f 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / contact _ record _ big . xml < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / contact _ record _ big . xml < nl > @ @ - 18 , 10 + 18 , 10 @ @ < nl > android : id = " @ + id / recordIcon " < nl > android : layout _ width = " 24dp " < nl > android : layout _ height = " 24dp " < nl > - android : layout _ marginBottom = " 24dp " < nl > + android : layout _ marginBottom = " 20dp " < nl > android : layout _ marginLeft = " 16dp " < nl > android : layout _ marginRight = " 32dp " < nl > - android : layout _ marginTop = " 16dp " / > < nl > + android : layout _ marginTop = " 20dp " / > < nl > < nl > < LinearLayout < nl > android : layout _ width = " match _ parent " < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / fragment _ profile . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / fragment _ profile . xml < nl > index 65789b1 . . 988801e 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / fragment _ profile . xml < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / fragment _ profile . xml < nl > @ @ - 5 , 7 + 5 , 6 @ @ < nl > - - > < nl > < nl > < FrameLayout xmlns : android = " http : / / schemas . android . com / apk / res / android " < nl > - xmlns : app = " http : / / schemas . android . com / apk / res - auto " < nl > android : layout _ width = " match _ parent " < nl > android : layout _ height = " match _ parent " > < nl > < nl > @ @ - 14 , 116 + 13 , 99 @ @ < nl > android : layout _ width = " match _ parent " < nl > android : layout _ height = " match _ parent " > < nl > < nl > - < FrameLayout < nl > + < LinearLayout < nl > android : id = " @ + id / container " < nl > android : layout _ width = " match _ parent " < nl > - android : layout _ height = " wrap _ content " > < nl > + android : layout _ height = " wrap _ content " < nl > + android : orientation = " vertical " > < nl > < nl > - < LinearLayout < nl > - android : layout _ width = " match _ parent " < nl > - android : layout _ height = " wrap _ content " < nl > - android : orientation = " vertical " > < nl > - < nl > - < FrameLayout < nl > - android : layout _ width = " fill _ parent " < nl > - android : layout _ height = " 248dp " < nl > - android : layout _ marginBottom = " 36dp " < nl > - android : orientation = " horizontal " > < nl > - < nl > - < im . actor . sdk . view . avatar . CoverAvatarView < nl > - android : id = " @ + id / avatar " < nl > - android : layout _ width = " match _ parent " < nl > - android : layout _ height = " match _ parent " / > < nl > - < nl > - < LinearLayout < nl > - android : layout _ width = " match _ parent " < nl > - android : layout _ height = " 72dp " < nl > - android : layout _ gravity = " bottom " < nl > - android : gravity = " center _ vertical | left " < nl > - android : orientation = " vertical " < nl > - android : paddingLeft = " 72dp " < nl > - android : paddingRight = " 24dp " > < nl > - < nl > - < TextView < nl > - android : id = " @ + id / name " < nl > - android : layout _ width = " wrap _ content " < nl > - android : layout _ height = " wrap _ content " < nl > - android : layout _ marginTop = " - 2dp " < nl > - android : ellipsize = " end " < nl > - android : includeFontPadding = " false " < nl > - android : lines = " 1 " < nl > - android : singleLine = " true " < nl > - android : textSize = " 28sp " / > < nl > - < nl > - < TextView < nl > - android : id = " @ + id / lastSeen " < nl > - android : layout _ width = " wrap _ content " < nl > - android : layout _ height = " wrap _ content " < nl > - android : layout _ marginTop = " - 2dp " < nl > - android : textSize = " 14sp " / > < nl > - < nl > - < / LinearLayout > < nl > - < nl > - < / FrameLayout > < nl > + < FrameLayout < nl > + android : layout _ width = " fill _ parent " < nl > + android : layout _ height = " 248dp " < nl > + android : layout _ marginBottom = " 16dp " < nl > + android : orientation = " horizontal " > < nl > < nl > - < LinearLayout < nl > - android : id = " @ + id / contactsContainer " < nl > + < im . actor . sdk . view . avatar . CoverAvatarView < nl > + android : id = " @ + id / avatar " < nl > android : layout _ width = " match _ parent " < nl > - android : layout _ height = " wrap _ content " < nl > - android : orientation = " vertical " > < nl > - < nl > - < / LinearLayout > < nl > + android : layout _ height = " match _ parent " / > < nl > < nl > < LinearLayout < nl > - android : id = " @ + id / notificationsCont " < nl > android : layout _ width = " match _ parent " < nl > - android : layout _ height = " 48dp " < nl > - android : layout _ marginBottom = " 36dp " < nl > - android : background = " @ drawable / selector " < nl > - android : paddingRight = " 8dp " > < nl > - < nl > - < ImageView < nl > - android : id = " @ + id / settings _ notification _ icon " < nl > - android : layout _ width = " 24dp " < nl > - android : layout _ height = " 24dp " < nl > - android : layout _ marginLeft = " 16dp " < nl > - android : layout _ marginRight = " 32dp " < nl > - android : layout _ marginTop = " 12dp " < nl > - android : scaleType = " center " / > < nl > + android : layout _ height = " 72dp " < nl > + android : layout _ gravity = " bottom " < nl > + android : gravity = " center _ vertical | left " < nl > + android : orientation = " vertical " < nl > + android : paddingLeft = " 72dp " < nl > + android : paddingRight = " 24dp " > < nl > + < nl > + < TextView < nl > + android : id = " @ + id / name " < nl > + android : layout _ width = " wrap _ content " < nl > + android : layout _ height = " wrap _ content " < nl > + android : layout _ marginTop = " - 2dp " < nl > + android : ellipsize = " end " < nl > + android : includeFontPadding = " false " < nl > + android : lines = " 1 " < nl > + android : singleLine = " true " < nl > + android : textSize = " 28sp " / > < nl > < nl > < TextView < nl > - android : id = " @ + id / settings _ notifications _ title " < nl > - android : layout _ width = " 0dp " < nl > - android : layout _ height = " match _ parent " < nl > - android : layout _ weight = " 1 " < nl > - android : gravity = " center _ vertical " < nl > - android : text = " @ string / profile _ settings _ notifications " < nl > - android : textSize = " 16sp " / > < nl > - < nl > - < android . support . v7 . widget . SwitchCompat < nl > - android : id = " @ + id / enableNotifications " < nl > + android : id = " @ + id / lastSeen " < nl > android : layout _ width = " wrap _ content " < nl > - android : layout _ height = " wrap _ content " / > < nl > + android : layout _ height = " wrap _ content " < nl > + android : layout _ marginTop = " - 2dp " < nl > + android : textSize = " 14sp " / > < nl > + < nl > < / LinearLayout > < nl > < nl > - < / LinearLayout > < nl > + < / FrameLayout > < nl > < nl > - < com . getbase . floatingactionbutton . FloatingActionButton < nl > - android : id = " @ + id / profileAction " < nl > - android : layout _ width = " wrap _ content " < nl > + < LinearLayout < nl > + android : id = " @ + id / contactsContainer " < nl > + android : layout _ width = " match _ parent " < nl > android : layout _ height = " wrap _ content " < nl > - android : layout _ gravity = " right | top " < nl > - android : layout _ marginRight = " 6dp " < nl > - android : layout _ marginTop = " 212dp " < nl > - app : fab _ icon = " @ drawable / ic _ chat _ bubble _ white _ 24dp " / > < nl > + android : orientation = " vertical " / > < nl > < nl > - < / FrameLayout > < nl > + < LinearLayout < nl > + android : id = " @ + id / notificationsCont " < nl > + android : layout _ width = " match _ parent " < nl > + android : layout _ height = " 48dp " < nl > + android : layout _ marginBottom = " 36dp " < nl > + android : background = " @ drawable / selector " < nl > + android : paddingRight = " 8dp " > < nl > + < nl > + < ImageView < nl > + android : id = " @ + id / settings _ notification _ icon " < nl > + android : layout _ width = " 24dp " < nl > + android : layout _ height = " 24dp " < nl > + android : layout _ marginLeft = " 16dp " < nl > + android : layout _ marginRight = " 32dp " < nl > + android : layout _ marginTop = " 12dp " < nl > + android : scaleType = " center " / > < nl > + < nl > + < TextView < nl > + android : id = " @ + id / settings _ notifications _ title " < nl > + android : layout _ width = " 0dp " < nl > + android : layout _ height = " match _ parent " < nl > + android : layout _ weight = " 1 " < nl > + android : gravity = " center _ vertical " < nl > + android : text = " @ string / profile _ settings _ notifications " < nl > + android : textSize = " 16sp " / > < nl > + < nl > + < android . support . v7 . widget . SwitchCompat < nl > + android : id = " @ + id / enableNotifications " < nl > + android : layout _ width = " wrap _ content " < nl > + android : layout _ height = " wrap _ content " / > < nl > + < / LinearLayout > < nl > + < nl > + < / LinearLayout > < nl > < nl > < / ScrollView > < nl > < nl > - < View < nl > - android : layout _ width = " match _ parent " < nl > - android : layout _ height = " 56dp " < nl > - android : layout _ gravity = " top " < nl > - android : background = " @ drawable / profile _ avatar _ top _ shadow " / > < nl > + < ! - - < View - - > < nl > + < ! - - android : layout _ width = " match _ parent " - - > < nl > + < ! - - android : layout _ height = " 56dp " - - > < nl > + < ! - - android : layout _ gravity = " top " - - > < nl > + < ! - - android : background = " @ drawable / profile _ avatar _ top _ shadow " / > - - > < nl > < / FrameLayout > < nl > \ No newline at end of file
NEAREST DIFF (one line): diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / activity / BaseActivity . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / activity / BaseActivity . java < nl > index 0379117 . . e40b240 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / activity / BaseActivity . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / activity / BaseActivity . java < nl > @ @ - 5 , 6 + 5 , 7 @ @ import android . graphics . drawable . ColorDrawable ; < nl > import android . os . Bundle ; < nl > import android . support . v7 . app . ActionBar ; < nl > import android . support . v7 . app . AppCompatActivity ; < nl > + import android . support . v7 . widget . Toolbar ; < nl > import android . view . View ; < nl > import android . widget . TextView ; < nl > < nl > @ @ - 71 , 6 + 72 , 10 @ @ public class BaseActivity extends AppCompatActivity { < nl > BINDER . bind ( textView , titleContainer , value ) ; < nl > } < nl > < nl > + public void bindGlobalCounter ( ValueChangedListener < Integer > callback ) { < nl > + BINDER . bindGlobalCounter ( callback ) ; < nl > + } < nl > + < nl > public void bindGroupTyping ( final TextView textView , final View container , final View titleContainer , final Value < int [ ] > typing ) { < nl > BINDER . bindGroupTyping ( textView , container , titleContainer , typing ) ; < nl > } < nl > @ @ - 131 , 12 + 136 , 17 @ @ public class BaseActivity extends AppCompatActivity { < nl > protected void setToolbar ( View view , ActionBar . LayoutParams params , boolean enableBack ) { < nl > getSupportActionBar ( ) . setDisplayShowCustomEnabled ( true ) ; < nl > getSupportActionBar ( ) . setDisplayHomeAsUpEnabled ( true ) ; < nl > - if ( enableBack ) { < nl > - getSupportActionBar ( ) . setDisplayShowHomeEnabled ( true ) ; < nl > - } < nl > getSupportActionBar ( ) . setDisplayShowTitleEnabled ( false ) ; < nl > getSupportActionBar ( ) . setDisplayUseLogoEnabled ( false ) ; < nl > getSupportActionBar ( ) . setCustomView ( view , params ) ; < nl > + if ( enableBack ) { < nl > + getSupportActionBar ( ) . setDisplayShowHomeEnabled ( true ) ; < nl > + } else { < nl > + getSupportActionBar ( ) . setDisplayShowHomeEnabled ( false ) ; < nl > + getSupportActionBar ( ) . setDisplayHomeAsUpEnabled ( false ) ; < nl > + Toolbar parent = ( Toolbar ) view . getParent ( ) ; < nl > + parent . setContentInsetsAbsolute ( 0 , 0 ) ; < nl > + } < nl > } < nl > < nl > protected void setToolbar ( View view , ActionBar . LayoutParams params ) { < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java < nl > index f4bb580 . . df168be 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java < nl > @ @ - 10 , 6 + 10 , 7 @ @ import android . content . pm . ApplicationInfo ; < nl > import android . content . pm . PackageManager ; < nl > import android . content . res . Configuration ; < nl > import android . database . Cursor ; < nl > + import android . graphics . PorterDuff ; < nl > import android . net . Uri ; < nl > import android . os . Bundle ; < nl > import android . provider . ContactsContract ; < nl > @ @ - 27 , 6 + 28 , 8 @ @ import android . view . Menu ; < nl > import android . view . MenuItem ; < nl > import android . view . MotionEvent ; < nl > import android . view . View ; < nl > + import android . view . ViewGroup ; < nl > + import android . view . ViewParent ; < nl > import android . view . animation . AlphaAnimation ; < nl > import android . view . animation . TranslateAnimation ; < nl > import android . widget . AdapterView ; < nl > @ @ - 55 , 6 + 58 , 7 @ @ import im . actor . runtime . actors . ActorSystem ; < nl > import im . actor . runtime . actors . Props ; < nl > import im . actor . runtime . actors . messages . PoisonPill ; < nl > import im . actor . sdk . ActorSDK ; < nl > + import im . actor . sdk . ActorStyle ; < nl > import im . actor . sdk . R ; < nl > import im . actor . sdk . controllers . Intents ; < nl > import im . actor . sdk . controllers . conversation . mentions . MentionsAdapter ; < nl > @ @ - 74 , 6 + 78 , 7 @ @ import im . actor . runtime . mvvm . ValueChangedListener ; < nl > import static im . actor . sdk . util . ViewUtils . expand ; < nl > import static im . actor . sdk . util . ViewUtils . expandMentions ; < nl > import static im . actor . sdk . util . ViewUtils . goneView ; < nl > + import static im . actor . sdk . util . ViewUtils . hideView ; < nl > import static im . actor . sdk . util . ViewUtils . showView ; < nl > import static im . actor . sdk . util . ViewUtils . zoomInView ; < nl > import static im . actor . sdk . util . ViewUtils . zoomOutView ; < nl > @ @ - 113 , 6 + 118 , 8 @ @ public class ChatActivity extends ActorEditTextActivity { < nl > / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / < nl > / / Toolbar views < nl > / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / < nl > + / / Toolbar unread counter < nl > + private TextView counter ; < nl > / / Toolbar Avatar view < nl > private AvatarView barAvatar ; < nl > / / Toolbar title view < nl > @ @ - 414 , 10 + 421 , 22 @ @ public class ChatActivity extends ActorEditTextActivity { < nl > protected void onCreateToolbar ( ) { < nl > / / Loading Toolbar header views < nl > / / Binding to real data is performed in onResume method < nl > + ActorStyle style = ActorSDK . sharedActor ( ) . style ; < nl > barView = LayoutInflater . from ( this ) . inflate ( R . layout . bar _ conversation , null ) ; < nl > ActionBar . LayoutParams layout = new ActionBar . LayoutParams ( ActionBar . LayoutParams . MATCH _ PARENT , ActionBar . LayoutParams . MATCH _ PARENT ) ; < nl > - setToolbar ( barView , layout ) ; < nl > + setToolbar ( barView , layout , false ) ; < nl > + findViewById ( R . id . home ) . setOnClickListener ( new View . OnClickListener ( ) { < nl > + @ Override < nl > + public void onClick ( View v ) { < nl > + onBackPressed ( ) ; < nl > + } < nl > + } ) ; < nl > + < nl > + counter = ( TextView ) barView . findViewById ( R . id . counter ) ; < nl > < nl > + counter . setTextColor ( style . getDialogsCounterTextColor ( ) ) ; < nl > + counter . setBackgroundResource ( R . drawable . ic _ counter _ circle ) ; < nl > + counter . getBackground ( ) . setColorFilter ( style . getDialogsCounterBackgroundColor ( ) , PorterDuff . Mode . MULTIPLY ) ; < nl > barTitle = ( TextView ) barView . findViewById ( R . id . title ) ; < nl > barSubtitleContainer = barView . findViewById ( R . id . subtitleContainer ) ; < nl > barTypingIcon = ( ImageView ) barView . findViewById ( R . id . typingImage ) ; < nl > @ @ - 615 , 6 + 634 , 18 @ @ public class ChatActivity extends ActorEditTextActivity { < nl > } < nl > } ) ; < nl > } < nl > + < nl > + bindGlobalCounter ( new ValueChangedListener < Integer > ( ) { < nl > + @ Override < nl > + public void onChanged ( Integer val , Value < Integer > valueModel ) { < nl > + if ( val > 0 ) { < nl > + counter . setText ( Integer . toString ( val ) ) ; < nl > + showView ( counter ) ; < nl > + } else { < nl > + hideView ( counter ) ; < nl > + } < nl > + } < nl > + } ) ; < nl > } < nl > < nl > @ Override < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / ActorBinder . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / ActorBinder . java < nl > index de76ed5 . . ba8f1cb 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / ActorBinder . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / ActorBinder . java < nl > @ @ - 41 , 6 + 41 , 10 @ @ public class ActorBinder { < nl > < nl > } < nl > < nl > + public void bindGlobalCounter ( ValueChangedListener < Integer > callback ) { < nl > + callback . onChanged ( messenger ( ) . getAppState ( ) . getGlobalCounter ( ) . get ( ) , messenger ( ) . getAppState ( ) . getGlobalCounter ( ) ) ; < nl > + bind ( messenger ( ) . getAppState ( ) . getGlobalCounter ( ) , callback ) ; < nl > + } < nl > < nl > public void bindGroupTyping ( final TextView textView , final View container , final View titleContainer , final Value < int [ ] > typing ) { < nl > bind ( typing , new ValueChangedListener < int [ ] > ( ) { < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / bar _ conversation . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / bar _ conversation . xml < nl > index c284f10 . . 1e5fe62 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / bar _ conversation . xml < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / bar _ conversation . xml < nl > @ @ - 5 , 71 + 5 , 105 @ @ < nl > - - > < nl > < nl > < LinearLayout xmlns : android = " http : / / schemas . android . com / apk / res / android " < nl > - android : id = " @ + id / titleContainer " < nl > android : layout _ width = " match _ parent " < nl > - android : layout _ height = " match _ parent " < nl > - android : background = " @ drawable / selector _ light " > < nl > + android : layout _ height = " match _ parent " > < nl > < nl > - < im . actor . sdk . view . avatar . AvatarView < nl > - android : id = " @ + id / avatarPreview " < nl > - android : layout _ width = " 32dp " < nl > - android : layout _ height = " 32dp " < nl > - android : layout _ gravity = " center _ vertical " < nl > - android : layout _ marginLeft = " 8dp " / > < nl > + < FrameLayout < nl > + android : id = " @ + id / home " < nl > + android : background = " @ drawable / selector _ light " < nl > + android : layout _ width = " ? attr / actionBarSize " < nl > + android : layout _ height = " match _ parent " > < nl > < nl > - < LinearLayout < nl > - android : layout _ width = " 0dp " < nl > - android : layout _ height = " match _ parent " < nl > - android : layout _ weight = " 1 " < nl > - android : gravity = " center _ vertical " < nl > - android : orientation = " vertical " < nl > - android : paddingLeft = " 8dp " > < nl > + < ImageView < nl > + < nl > + android : layout _ width = " wrap _ content " < nl > + android : layout _ height = " match _ parent " < nl > + android : src = " @ drawable / ic _ action _ navigation _ arrow _ back " < nl > + android : scaleType = " center " < nl > + android : layout _ gravity = " center _ vertical | center _ horizontal " / > < nl > < nl > < TextView < nl > - android : id = " @ + id / title " < nl > - android : layout _ width = " match _ parent " < nl > + android : layout _ marginTop = " 10dp " < nl > + android : layout _ marginRight = " 10dp " < nl > + android : layout _ gravity = " top | right " < nl > + android : id = " @ + id / counter " < nl > + android : layout _ width = " wrap _ content " < nl > android : layout _ height = " wrap _ content " < nl > - android : layout _ marginTop = " - 2dp " < nl > - android : ellipsize = " end " < nl > - android : lines = " 1 " < nl > - android : singleLine = " true " < nl > - android : textColor = " # ffffff " < nl > - android : textSize = " 18sp " / > < nl > - < nl > - < FrameLayout < nl > - android : id = " @ + id / subtitleContainer " < nl > - android : layout _ width = " match _ parent " < nl > - android : layout _ height = " wrap _ content " < nl > - android : layout _ marginTop = " - 4dp " < nl > - android : orientation = " horizontal " > < nl > + android : paddingLeft = " 4dp " < nl > + android : paddingRight = " 4dp " < nl > + android : gravity = " center " < nl > + android : textSize = " 12sp " < nl > + android : visibility = " invisible " / > < nl > + < nl > + < / FrameLayout > < nl > + < nl > + < LinearLayout < nl > + android : id = " @ + id / titleContainer " < nl > + android : layout _ width = " match _ parent " < nl > + android : layout _ height = " match _ parent " < nl > + android : background = " @ drawable / selector _ light " > < nl > + < nl > + < im . actor . sdk . view . avatar . AvatarView < nl > + android : id = " @ + id / avatarPreview " < nl > + android : layout _ width = " 32dp " < nl > + android : layout _ height = " 32dp " < nl > + android : layout _ gravity = " center _ vertical " < nl > + android : layout _ marginLeft = " 8dp " / > < nl > < nl > - < LinearLayout < nl > - android : id = " @ + id / typingContainer " < nl > + < LinearLayout < nl > + android : layout _ width = " 0dp " < nl > + android : layout _ height = " match _ parent " < nl > + android : layout _ weight = " 1 " < nl > + android : gravity = " center _ vertical " < nl > + android : orientation = " vertical " < nl > + android : paddingLeft = " 8dp " > < nl > + < nl > + < TextView < nl > + android : id = " @ + id / title " < nl > android : layout _ width = " match _ parent " < nl > android : layout _ height = " wrap _ content " < nl > + android : layout _ marginTop = " - 2dp " < nl > + android : ellipsize = " end " < nl > + android : lines = " 1 " < nl > + android : singleLine = " true " < nl > + android : textColor = " # ffffff " < nl > + android : textSize = " 18sp " / > < nl > + < nl > + < FrameLayout < nl > + android : id = " @ + id / subtitleContainer " < nl > + android : layout _ width = " match _ parent " < nl > + android : layout _ height = " wrap _ content " < nl > + android : layout _ marginTop = " - 4dp " < nl > android : orientation = " horizontal " > < nl > < nl > - < ImageView < nl > - android : id = " @ + id / typingImage " < nl > - android : layout _ width = " wrap _ content " < nl > + < LinearLayout < nl > + android : id = " @ + id / typingContainer " < nl > + android : layout _ width = " match _ parent " < nl > android : layout _ height = " wrap _ content " < nl > - android : layout _ gravity = " center _ vertical " < nl > - android : layout _ marginTop = " 2dp " / > < nl > + android : orientation = " horizontal " > < nl > + < nl > + < ImageView < nl > + android : id = " @ + id / typingImage " < nl > + android : layout _ width = " wrap _ content " < nl > + android : layout _ height = " wrap _ content " < nl > + android : layout _ gravity = " center _ vertical " < nl > + android : layout _ marginTop = " 2dp " / > < nl > + < nl > + < TextView < nl > + android : id = " @ + id / typing " < nl > + android : layout _ width = " match _ parent " < nl > + android : layout _ height = " wrap _ content " < nl > + android : textColor = " # ffffff " < nl > + android : textSize = " 13sp " / > < nl > + < / LinearLayout > < nl > < nl > < TextView < nl > - android : id = " @ + id / typing " < nl > + android : id = " @ + id / subtitle " < nl > android : layout _ width = " match _ parent " < nl > android : layout _ height = " wrap _ content " < nl > android : textColor = " # ffffff " < nl > android : textSize = " 13sp " / > < nl > - < / LinearLayout > < nl > - < nl > - < TextView < nl > - android : id = " @ + id / subtitle " < nl > - android : layout _ width = " match _ parent " < nl > - android : layout _ height = " wrap _ content " < nl > - android : textColor = " # ffffff " < nl > - android : textSize = " 13sp " / > < nl > - < / FrameLayout > < nl > + < / FrameLayout > < nl > + < / LinearLayout > < nl > < / LinearLayout > < nl > < / LinearLayout > < nl > \ No newline at end of file

TEST DIFF:
diff - - git a / actor - sdk / sdk - core - android / android - app / src / main / java / im / actor / Application . java b / actor - sdk / sdk - core - android / android - app / src / main / java / im / actor / Application . java 
 index c2e0ae8 . . 15167b1 100644 
 - - - a / actor - sdk / sdk - core - android / android - app / src / main / java / im / actor / Application . java 
 + + + b / actor - sdk / sdk - core - android / android - app / src / main / java / im / actor / Application . java 
 @ @ - 31 , 6 + 31 , 9 @ @ public class Application extends ActorSDKApplication { 
 style . setDialogsActiveTextColor ( 0xff5882ac ) ; 
 
 ActorSDK . sharedActor ( ) . setFastShareEnabled ( true ) ; 
 + 
 + ActorSDK . sharedActor ( ) . setCallsEnabled ( true ) ; 
 + 
 / / ActorSDK . sharedActor ( ) . setTwitter ( " " ) ; 
 / / ActorSDK . sharedActor ( ) . setHomePage ( " http : / / www . foo . com " ) ; 
 / / ActorSDK . sharedActor ( ) . setInviteUrl ( " http : / / www . foo . com " ) ; 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / profile / ProfileFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / profile / ProfileFragment . java 
 index debdd6a . . 87e9776 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / profile / ProfileFragment . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / profile / ProfileFragment . java 
 @ @ - 34 , 6 + 34 , 8 @ @ import com . google . i18n . phonenumbers . Phonenumber ; 
 import java . util . ArrayList ; 
 
 import im . actor . core . viewmodel . UserEmail ; 
 + import im . actor . runtime . actors . Actor ; 
 + import im . actor . sdk . ActorSDK ; 
 import im . actor . sdk . R ; 
 import im . actor . sdk . controllers . Intents ; 
 import im . actor . sdk . controllers . fragment . preview . ViewAvatarActivity ; 
 @ @ - 98 , 17 + 100 , 17 @ @ public class ProfileFragment extends BaseFragment { 
 / / Floating Action Button 
 / / 
 
 - FloatingActionButton fab = ( FloatingActionButton ) res . findViewById ( R . id . profileAction ) ; 
 - fab . setColorNormal ( style . getFabColor ( ) ) ; 
 - fab . setColorPressed ( style . getFabPressedColor ( ) ) ; 
 - 
 - fab . setVisibility ( View . VISIBLE ) ; 
 - fab . setOnClickListener ( new View . OnClickListener ( ) { 
 - @ Override 
 - public void onClick ( View v ) { 
 - startActivity ( Intents . openPrivateDialog ( user . getId ( ) , true , getActivity ( ) ) ) ; 
 - } 
 - } ) ; 
 + / / FloatingActionButton fab = ( FloatingActionButton ) res . findViewById ( R . id . profileAction ) ; 
 + / / fab . setColorNormal ( style . getFabColor ( ) ) ; 
 + / / fab . setColorPressed ( style . getFabPressedColor ( ) ) ; 
 + / / 
 + / / fab . setVisibility ( View . VISIBLE ) ; 
 + / / fab . setOnClickListener ( new View . OnClickListener ( ) { 
 + / / @ Override 
 + / / public void onClick ( View v ) { 
 + / / startActivity ( Intents . openPrivateDialog ( user . getId ( ) , true , getActivity ( ) ) ) ; 
 + / / } 
 + / / } ) ; 
 
 
 / / 
 @ @ - 138 , 6 + 140 , 26 @ @ public class ProfileFragment extends BaseFragment { 
 
 
 / / 
 + / / Compose 
 + / / 
 + 
 + buildRecordAction ( " Free Message " , R . drawable . ic _ chat _ bubble _ white _ 24dp , true , false , inflater , contactsContainer ) . setOnClickListener ( new View . OnClickListener ( ) { 
 + @ Override 
 + public void onClick ( View v ) { 
 + startActivity ( Intents . openPrivateDialog ( user . getId ( ) , true , getActivity ( ) ) ) ; 
 + } 
 + } ) ; 
 + 
 + if ( ActorSDK . sharedActor ( ) . isCallsEnabled ( ) ) { 
 + buildRecordAction ( " Free Call " , R . drawable . ic _ phone _ white _ 24dp , true , true , inflater , contactsContainer ) . setOnClickListener ( new View . OnClickListener ( ) { 
 + @ Override 
 + public void onClick ( View v ) { 
 + execute ( ActorSDK . sharedActor ( ) . getMessenger ( ) . doCall ( user . getId ( ) ) ) ; 
 + } 
 + } ) ; 
 + } 
 + 
 + / / 
 / / Phones 
 / / 
 
 @ @ - 393 , 7 + 415 , 7 @ @ public class ProfileFragment extends BaseFragment { 
 return buildRecord ( titleText , valueText , 0 , false , isLast , inflater , container ) ; 
 } 
 
 - private View buildRecord ( String titleText , String valueText , int resourceId , boolean isFirst , boolean isLast , 
 + private View buildRecord ( String titleText , String valueText , int resourceId , boolean showIcon , boolean isLast , 
 LayoutInflater inflater , ViewGroup container ) { 
 final View recordView = inflater . inflate ( R . layout . contact _ record , container , false ) ; 
 TextView value = ( TextView ) recordView . findViewById ( R . id . value ) ; 
 @ @ - 409 , 7 + 431 , 7 @ @ public class ProfileFragment extends BaseFragment { 
 recordView . findViewById ( R . id . divider ) . setVisibility ( View . GONE ) ; 
 } 
 
 - if ( resourceId ! = 0 & & isFirst ) { 
 + if ( resourceId ! = 0 & & showIcon ) { 
 ImageView iconView = ( ImageView ) recordView . findViewById ( R . id . recordIcon ) ; 
 Drawable drawable = DrawableCompat . wrap ( getResources ( ) . getDrawable ( resourceId ) ) ; 
 DrawableCompat . setTint ( drawable , style . getSettingsIconColor ( ) ) ; 
 @ @ - 421 , 7 + 443 , 7 @ @ public class ProfileFragment extends BaseFragment { 
 return recordView ; 
 } 
 
 - private View buildRecordBig ( String valueText , int resourceId , boolean isFirst , boolean isLast , 
 + private View buildRecordBig ( String valueText , int resourceId , boolean showIcon , boolean isLast , 
 LayoutInflater inflater , ViewGroup container ) { 
 final View recordView = inflater . inflate ( R . layout . contact _ record _ big , container , false ) ; 
 TextView value = ( TextView ) recordView . findViewById ( R . id . value ) ; 
 @ @ - 433 , 7 + 455 , 7 @ @ public class ProfileFragment extends BaseFragment { 
 recordView . findViewById ( R . id . divider ) . setVisibility ( View . GONE ) ; 
 } 
 
 - if ( resourceId ! = 0 & & isFirst ) { 
 + if ( resourceId ! = 0 & & showIcon ) { 
 ImageView iconView = ( ImageView ) recordView . findViewById ( R . id . recordIcon ) ; 
 Drawable drawable = DrawableCompat . wrap ( getResources ( ) . getDrawable ( resourceId ) ) ; 
 DrawableCompat . setTint ( drawable , style . getSettingsIconColor ( ) ) ; 
 @ @ - 445 , 6 + 467 , 30 @ @ public class ProfileFragment extends BaseFragment { 
 return recordView ; 
 } 
 
 + private View buildRecordAction ( String valueText , int resourceId , boolean showIcon , boolean isLast , 
 + LayoutInflater inflater , ViewGroup container ) { 
 + final View recordView = inflater . inflate ( R . layout . contact _ record _ big , container , false ) ; 
 + TextView value = ( TextView ) recordView . findViewById ( R . id . value ) ; 
 + 
 + value . setTextColor ( style . getGroupActionAddTextColor ( ) ) ; 
 + value . setText ( valueText ) ; 
 + 
 + if ( ! isLast ) { 
 + recordView . findViewById ( R . id . divider ) . setVisibility ( View . GONE ) ; 
 + } 
 + 
 + if ( resourceId ! = 0 & & showIcon ) { 
 + ImageView iconView = ( ImageView ) recordView . findViewById ( R . id . recordIcon ) ; 
 + Drawable drawable = DrawableCompat . wrap ( getResources ( ) . getDrawable ( resourceId ) ) ; 
 + DrawableCompat . setTint ( drawable , style . getGroupActionAddIconColor ( ) ) ; 
 + iconView . setImageDrawable ( drawable ) ; 
 + } 
 + 
 + container . addView ( recordView ) ; 
 + 
 + return recordView ; 
 + } 
 + 
 @ Override 
 public void onDestroyView ( ) { 
 super . onDestroyView ( ) ; 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / contact _ record _ big . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / contact _ record _ big . xml 
 index 61e34f2 . . 20d8d0f 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / contact _ record _ big . xml 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / contact _ record _ big . xml 
 @ @ - 18 , 10 + 18 , 10 @ @ 
 android : id = " @ + id / recordIcon " 
 android : layout _ width = " 24dp " 
 android : layout _ height = " 24dp " 
 - android : layout _ marginBottom = " 24dp " 
 + android : layout _ marginBottom = " 20dp " 
 android : layout _ marginLeft = " 16dp " 
 android : layout _ marginRight = " 32dp " 
 - android : layout _ marginTop = " 16dp " / > 
 + android : layout _ marginTop = " 20dp " / > 
 
 < LinearLayout 
 android : layout _ width = " match _ parent " 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / fragment _ profile . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / fragment _ profile . xml 
 index 65789b1 . . 988801e 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / fragment _ profile . xml 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / fragment _ profile . xml 
 @ @ - 5 , 7 + 5 , 6 @ @ 
 - - > 
 
 < FrameLayout xmlns : android = " http : / / schemas . android . com / apk / res / android " 
 - xmlns : app = " http : / / schemas . android . com / apk / res - auto " 
 android : layout _ width = " match _ parent " 
 android : layout _ height = " match _ parent " > 
 
 @ @ - 14 , 116 + 13 , 99 @ @ 
 android : layout _ width = " match _ parent " 
 android : layout _ height = " match _ parent " > 
 
 - < FrameLayout 
 + < LinearLayout 
 android : id = " @ + id / container " 
 android : layout _ width = " match _ parent " 
 - android : layout _ height = " wrap _ content " > 
 + android : layout _ height = " wrap _ content " 
 + android : orientation = " vertical " > 
 
 - < LinearLayout 
 - android : layout _ width = " match _ parent " 
 - android : layout _ height = " wrap _ content " 
 - android : orientation = " vertical " > 
 - 
 - < FrameLayout 
 - android : layout _ width = " fill _ parent " 
 - android : layout _ height = " 248dp " 
 - android : layout _ marginBottom = " 36dp " 
 - android : orientation = " horizontal " > 
 - 
 - < im . actor . sdk . view . avatar . CoverAvatarView 
 - android : id = " @ + id / avatar " 
 - android : layout _ width = " match _ parent " 
 - android : layout _ height = " match _ parent " / > 
 - 
 - < LinearLayout 
 - android : layout _ width = " match _ parent " 
 - android : layout _ height = " 72dp " 
 - android : layout _ gravity = " bottom " 
 - android : gravity = " center _ vertical | left " 
 - android : orientation = " vertical " 
 - android : paddingLeft = " 72dp " 
 - android : paddingRight = " 24dp " > 
 - 
 - < TextView 
 - android : id = " @ + id / name " 
 - android : layout _ width = " wrap _ content " 
 - android : layout _ height = " wrap _ content " 
 - android : layout _ marginTop = " - 2dp " 
 - android : ellipsize = " end " 
 - android : includeFontPadding = " false " 
 - android : lines = " 1 " 
 - android : singleLine = " true " 
 - android : textSize = " 28sp " / > 
 - 
 - < TextView 
 - android : id = " @ + id / lastSeen " 
 - android : layout _ width = " wrap _ content " 
 - android : layout _ height = " wrap _ content " 
 - android : layout _ marginTop = " - 2dp " 
 - android : textSize = " 14sp " / > 
 - 
 - < / LinearLayout > 
 - 
 - < / FrameLayout > 
 + < FrameLayout 
 + android : layout _ width = " fill _ parent " 
 + android : layout _ height = " 248dp " 
 + android : layout _ marginBottom = " 16dp " 
 + android : orientation = " horizontal " > 
 
 - < LinearLayout 
 - android : id = " @ + id / contactsContainer " 
 + < im . actor . sdk . view . avatar . CoverAvatarView 
 + android : id = " @ + id / avatar " 
 android : layout _ width = " match _ parent " 
 - android : layout _ height = " wrap _ content " 
 - android : orientation = " vertical " > 
 - 
 - < / LinearLayout > 
 + android : layout _ height = " match _ parent " / > 
 
 < LinearLayout 
 - android : id = " @ + id / notificationsCont " 
 android : layout _ width = " match _ parent " 
 - android : layout _ height = " 48dp " 
 - android : layout _ marginBottom = " 36dp " 
 - android : background = " @ drawable / selector " 
 - android : paddingRight = " 8dp " > 
 - 
 - < ImageView 
 - android : id = " @ + id / settings _ notification _ icon " 
 - android : layout _ width = " 24dp " 
 - android : layout _ height = " 24dp " 
 - android : layout _ marginLeft = " 16dp " 
 - android : layout _ marginRight = " 32dp " 
 - android : layout _ marginTop = " 12dp " 
 - android : scaleType = " center " / > 
 + android : layout _ height = " 72dp " 
 + android : layout _ gravity = " bottom " 
 + android : gravity = " center _ vertical | left " 
 + android : orientation = " vertical " 
 + android : paddingLeft = " 72dp " 
 + android : paddingRight = " 24dp " > 
 + 
 + < TextView 
 + android : id = " @ + id / name " 
 + android : layout _ width = " wrap _ content " 
 + android : layout _ height = " wrap _ content " 
 + android : layout _ marginTop = " - 2dp " 
 + android : ellipsize = " end " 
 + android : includeFontPadding = " false " 
 + android : lines = " 1 " 
 + android : singleLine = " true " 
 + android : textSize = " 28sp " / > 
 
 < TextView 
 - android : id = " @ + id / settings _ notifications _ title " 
 - android : layout _ width = " 0dp " 
 - android : layout _ height = " match _ parent " 
 - android : layout _ weight = " 1 " 
 - android : gravity = " center _ vertical " 
 - android : text = " @ string / profile _ settings _ notifications " 
 - android : textSize = " 16sp " / > 
 - 
 - < android . support . v7 . widget . SwitchCompat 
 - android : id = " @ + id / enableNotifications " 
 + android : id = " @ + id / lastSeen " 
 android : layout _ width = " wrap _ content " 
 - android : layout _ height = " wrap _ content " / > 
 + android : layout _ height = " wrap _ content " 
 + android : layout _ marginTop = " - 2dp " 
 + android : textSize = " 14sp " / > 
 + 
 < / LinearLayout > 
 
 - < / LinearLayout > 
 + < / FrameLayout > 
 
 - < com . getbase . floatingactionbutton . FloatingActionButton 
 - android : id = " @ + id / profileAction " 
 - android : layout _ width = " wrap _ content " 
 + < LinearLayout 
 + android : id = " @ + id / contactsContainer " 
 + android : layout _ width = " match _ parent " 
 android : layout _ height = " wrap _ content " 
 - android : layout _ gravity = " right | top " 
 - android : layout _ marginRight = " 6dp " 
 - android : layout _ marginTop = " 212dp " 
 - app : fab _ icon = " @ drawable / ic _ chat _ bubble _ white _ 24dp " / > 
 + android : orientation = " vertical " / > 
 
 - < / FrameLayout > 
 + < LinearLayout 
 + android : id = " @ + id / notificationsCont " 
 + android : layout _ width = " match _ parent " 
 + android : layout _ height = " 48dp " 
 + android : layout _ marginBottom = " 36dp " 
 + android : background = " @ drawable / selector " 
 + android : paddingRight = " 8dp " > 
 + 
 + < ImageView 
 + android : id = " @ + id / settings _ notification _ icon " 
 + android : layout _ width = " 24dp " 
 + android : layout _ height = " 24dp " 
 + android : layout _ marginLeft = " 16dp " 
 + android : layout _ marginRight = " 32dp " 
 + android : layout _ marginTop = " 12dp " 
 + android : scaleType = " center " / > 
 + 
 + < TextView 
 + android : id = " @ + id / settings _ notifications _ title " 
 + android : layout _ width = " 0dp " 
 + android : layout _ height = " match _ parent " 
 + android : layout _ weight = " 1 " 
 + android : gravity = " center _ vertical " 
 + android : text = " @ string / profile _ settings _ notifications " 
 + android : textSize = " 16sp " / > 
 + 
 + < android . support . v7 . widget . SwitchCompat 
 + android : id = " @ + id / enableNotifications " 
 + android : layout _ width = " wrap _ content " 
 + android : layout _ height = " wrap _ content " / > 
 + < / LinearLayout > 
 + 
 + < / LinearLayout > 
 
 < / ScrollView > 
 
 - < View 
 - android : layout _ width = " match _ parent " 
 - android : layout _ height = " 56dp " 
 - android : layout _ gravity = " top " 
 - android : background = " @ drawable / profile _ avatar _ top _ shadow " / > 
 + < ! - - < View - - > 
 + < ! - - android : layout _ width = " match _ parent " - - > 
 + < ! - - android : layout _ height = " 56dp " - - > 
 + < ! - - android : layout _ gravity = " top " - - > 
 + < ! - - android : background = " @ drawable / profile _ avatar _ top _ shadow " / > - - > 
 < / FrameLayout > 
 \ No newline at end of file

NEAREST DIFF:
diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / activity / BaseActivity . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / activity / BaseActivity . java 
 index 0379117 . . e40b240 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / activity / BaseActivity . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / activity / BaseActivity . java 
 @ @ - 5 , 6 + 5 , 7 @ @ import android . graphics . drawable . ColorDrawable ; 
 import android . os . Bundle ; 
 import android . support . v7 . app . ActionBar ; 
 import android . support . v7 . app . AppCompatActivity ; 
 + import android . support . v7 . widget . Toolbar ; 
 import android . view . View ; 
 import android . widget . TextView ; 
 
 @ @ - 71 , 6 + 72 , 10 @ @ public class BaseActivity extends AppCompatActivity { 
 BINDER . bind ( textView , titleContainer , value ) ; 
 } 
 
 + public void bindGlobalCounter ( ValueChangedListener < Integer > callback ) { 
 + BINDER . bindGlobalCounter ( callback ) ; 
 + } 
 + 
 public void bindGroupTyping ( final TextView textView , final View container , final View titleContainer , final Value < int [ ] > typing ) { 
 BINDER . bindGroupTyping ( textView , container , titleContainer , typing ) ; 
 } 
 @ @ - 131 , 12 + 136 , 17 @ @ public class BaseActivity extends AppCompatActivity { 
 protected void setToolbar ( View view , ActionBar . LayoutParams params , boolean enableBack ) { 
 getSupportActionBar ( ) . setDisplayShowCustomEnabled ( true ) ; 
 getSupportActionBar ( ) . setDisplayHomeAsUpEnabled ( true ) ; 
 - if ( enableBack ) { 
 - getSupportActionBar ( ) . setDisplayShowHomeEnabled ( true ) ; 
 - } 
 getSupportActionBar ( ) . setDisplayShowTitleEnabled ( false ) ; 
 getSupportActionBar ( ) . setDisplayUseLogoEnabled ( false ) ; 
 getSupportActionBar ( ) . setCustomView ( view , params ) ; 
 + if ( enableBack ) { 
 + getSupportActionBar ( ) . setDisplayShowHomeEnabled ( true ) ; 
 + } else { 
 + getSupportActionBar ( ) . setDisplayShowHomeEnabled ( false ) ; 
 + getSupportActionBar ( ) . setDisplayHomeAsUpEnabled ( false ) ; 
 + Toolbar parent = ( Toolbar ) view . getParent ( ) ; 
 + parent . setContentInsetsAbsolute ( 0 , 0 ) ; 
 + } 
 } 
 
 protected void setToolbar ( View view , ActionBar . LayoutParams params ) { 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java 
 index f4bb580 . . df168be 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java 
 @ @ - 10 , 6 + 10 , 7 @ @ import android . content . pm . ApplicationInfo ; 
 import android . content . pm . PackageManager ; 
 import android . content . res . Configuration ; 
 import android . database . Cursor ; 
 + import android . graphics . PorterDuff ; 
 import android . net . Uri ; 
 import android . os . Bundle ; 
 import android . provider . ContactsContract ; 
 @ @ - 27 , 6 + 28 , 8 @ @ import android . view . Menu ; 
 import android . view . MenuItem ; 
 import android . view . MotionEvent ; 
 import android . view . View ; 
 + import android . view . ViewGroup ; 
 + import android . view . ViewParent ; 
 import android . view . animation . AlphaAnimation ; 
 import android . view . animation . TranslateAnimation ; 
 import android . widget . AdapterView ; 
 @ @ - 55 , 6 + 58 , 7 @ @ import im . actor . runtime . actors . ActorSystem ; 
 import im . actor . runtime . actors . Props ; 
 import im . actor . runtime . actors . messages . PoisonPill ; 
 import im . actor . sdk . ActorSDK ; 
 + import im . actor . sdk . ActorStyle ; 
 import im . actor . sdk . R ; 
 import im . actor . sdk . controllers . Intents ; 
 import im . actor . sdk . controllers . conversation . mentions . MentionsAdapter ; 
 @ @ - 74 , 6 + 78 , 7 @ @ import im . actor . runtime . mvvm . ValueChangedListener ; 
 import static im . actor . sdk . util . ViewUtils . expand ; 
 import static im . actor . sdk . util . ViewUtils . expandMentions ; 
 import static im . actor . sdk . util . ViewUtils . goneView ; 
 + import static im . actor . sdk . util . ViewUtils . hideView ; 
 import static im . actor . sdk . util . ViewUtils . showView ; 
 import static im . actor . sdk . util . ViewUtils . zoomInView ; 
 import static im . actor . sdk . util . ViewUtils . zoomOutView ; 
 @ @ - 113 , 6 + 118 , 8 @ @ public class ChatActivity extends ActorEditTextActivity { 
 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / 
 / / Toolbar views 
 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / 
 + / / Toolbar unread counter 
 + private TextView counter ; 
 / / Toolbar Avatar view 
 private AvatarView barAvatar ; 
 / / Toolbar title view 
 @ @ - 414 , 10 + 421 , 22 @ @ public class ChatActivity extends ActorEditTextActivity { 
 protected void onCreateToolbar ( ) { 
 / / Loading Toolbar header views 
 / / Binding to real data is performed in onResume method 
 + ActorStyle style = ActorSDK . sharedActor ( ) . style ; 
 barView = LayoutInflater . from ( this ) . inflate ( R . layout . bar _ conversation , null ) ; 
 ActionBar . LayoutParams layout = new ActionBar . LayoutParams ( ActionBar . LayoutParams . MATCH _ PARENT , ActionBar . LayoutParams . MATCH _ PARENT ) ; 
 - setToolbar ( barView , layout ) ; 
 + setToolbar ( barView , layout , false ) ; 
 + findViewById ( R . id . home ) . setOnClickListener ( new View . OnClickListener ( ) { 
 + @ Override 
 + public void onClick ( View v ) { 
 + onBackPressed ( ) ; 
 + } 
 + } ) ; 
 + 
 + counter = ( TextView ) barView . findViewById ( R . id . counter ) ; 
 
 + counter . setTextColor ( style . getDialogsCounterTextColor ( ) ) ; 
 + counter . setBackgroundResource ( R . drawable . ic _ counter _ circle ) ; 
 + counter . getBackground ( ) . setColorFilter ( style . getDialogsCounterBackgroundColor ( ) , PorterDuff . Mode . MULTIPLY ) ; 
 barTitle = ( TextView ) barView . findViewById ( R . id . title ) ; 
 barSubtitleContainer = barView . findViewById ( R . id . subtitleContainer ) ; 
 barTypingIcon = ( ImageView ) barView . findViewById ( R . id . typingImage ) ; 
 @ @ - 615 , 6 + 634 , 18 @ @ public class ChatActivity extends ActorEditTextActivity { 
 } 
 } ) ; 
 } 
 + 
 + bindGlobalCounter ( new ValueChangedListener < Integer > ( ) { 
 + @ Override 
 + public void onChanged ( Integer val , Value < Integer > valueModel ) { 
 + if ( val > 0 ) { 
 + counter . setText ( Integer . toString ( val ) ) ; 
 + showView ( counter ) ; 
 + } else { 
 + hideView ( counter ) ; 
 + } 
 + } 
 + } ) ; 
 } 
 
 @ Override 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / ActorBinder . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / ActorBinder . java 
 index de76ed5 . . ba8f1cb 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / ActorBinder . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / ActorBinder . java 
 @ @ - 41 , 6 + 41 , 10 @ @ public class ActorBinder { 
 
 } 
 
 + public void bindGlobalCounter ( ValueChangedListener < Integer > callback ) { 
 + callback . onChanged ( messenger ( ) . getAppState ( ) . getGlobalCounter ( ) . get ( ) , messenger ( ) . getAppState ( ) . getGlobalCounter ( ) ) ; 
 + bind ( messenger ( ) . getAppState ( ) . getGlobalCounter ( ) , callback ) ; 
 + } 
 
 public void bindGroupTyping ( final TextView textView , final View container , final View titleContainer , final Value < int [ ] > typing ) { 
 bind ( typing , new ValueChangedListener < int [ ] > ( ) { 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / bar _ conversation . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / bar _ conversation . xml 
 index c284f10 . . 1e5fe62 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / bar _ conversation . xml 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / bar _ conversation . xml 
 @ @ - 5 , 71 + 5 , 105 @ @ 
 - - > 
 
 < LinearLayout xmlns : android = " http : / / schemas . android . com / apk / res / android " 
 - android : id = " @ + id / titleContainer " 
 android : layout _ width = " match _ parent " 
 - android : layout _ height = " match _ parent " 
 - android : background = " @ drawable / selector _ light " > 
 + android : layout _ height = " match _ parent " > 
 
 - < im . actor . sdk . view . avatar . AvatarView 
 - android : id = " @ + id / avatarPreview " 
 - android : layout _ width = " 32dp " 
 - android : layout _ height = " 32dp " 
 - android : layout _ gravity = " center _ vertical " 
 - android : layout _ marginLeft = " 8dp " / > 
 + < FrameLayout 
 + android : id = " @ + id / home " 
 + android : background = " @ drawable / selector _ light " 
 + android : layout _ width = " ? attr / actionBarSize " 
 + android : layout _ height = " match _ parent " > 
 
 - < LinearLayout 
 - android : layout _ width = " 0dp " 
 - android : layout _ height = " match _ parent " 
 - android : layout _ weight = " 1 " 
 - android : gravity = " center _ vertical " 
 - android : orientation = " vertical " 
 - android : paddingLeft = " 8dp " > 
 + < ImageView 
 + 
 + android : layout _ width = " wrap _ content " 
 + android : layout _ height = " match _ parent " 
 + android : src = " @ drawable / ic _ action _ navigation _ arrow _ back " 
 + android : scaleType = " center " 
 + android : layout _ gravity = " center _ vertical | center _ horizontal " / > 
 
 < TextView 
 - android : id = " @ + id / title " 
 - android : layout _ width = " match _ parent " 
 + android : layout _ marginTop = " 10dp " 
 + android : layout _ marginRight = " 10dp " 
 + android : layout _ gravity = " top | right " 
 + android : id = " @ + id / counter " 
 + android : layout _ width = " wrap _ content " 
 android : layout _ height = " wrap _ content " 
 - android : layout _ marginTop = " - 2dp " 
 - android : ellipsize = " end " 
 - android : lines = " 1 " 
 - android : singleLine = " true " 
 - android : textColor = " # ffffff " 
 - android : textSize = " 18sp " / > 
 - 
 - < FrameLayout 
 - android : id = " @ + id / subtitleContainer " 
 - android : layout _ width = " match _ parent " 
 - android : layout _ height = " wrap _ content " 
 - android : layout _ marginTop = " - 4dp " 
 - android : orientation = " horizontal " > 
 + android : paddingLeft = " 4dp " 
 + android : paddingRight = " 4dp " 
 + android : gravity = " center " 
 + android : textSize = " 12sp " 
 + android : visibility = " invisible " / > 
 + 
 + < / FrameLayout > 
 + 
 + < LinearLayout 
 + android : id = " @ + id / titleContainer " 
 + android : layout _ width = " match _ parent " 
 + android : layout _ height = " match _ parent " 
 + android : background = " @ drawable / selector _ light " > 
 + 
 + < im . actor . sdk . view . avatar . AvatarView 
 + android : id = " @ + id / avatarPreview " 
 + android : layout _ width = " 32dp " 
 + android : layout _ height = " 32dp " 
 + android : layout _ gravity = " center _ vertical " 
 + android : layout _ marginLeft = " 8dp " / > 
 
 - < LinearLayout 
 - android : id = " @ + id / typingContainer " 
 + < LinearLayout 
 + android : layout _ width = " 0dp " 
 + android : layout _ height = " match _ parent " 
 + android : layout _ weight = " 1 " 
 + android : gravity = " center _ vertical " 
 + android : orientation = " vertical " 
 + android : paddingLeft = " 8dp " > 
 + 
 + < TextView 
 + android : id = " @ + id / title " 
 android : layout _ width = " match _ parent " 
 android : layout _ height = " wrap _ content " 
 + android : layout _ marginTop = " - 2dp " 
 + android : ellipsize = " end " 
 + android : lines = " 1 " 
 + android : singleLine = " true " 
 + android : textColor = " # ffffff " 
 + android : textSize = " 18sp " / > 
 + 
 + < FrameLayout 
 + android : id = " @ + id / subtitleContainer " 
 + android : layout _ width = " match _ parent " 
 + android : layout _ height = " wrap _ content " 
 + android : layout _ marginTop = " - 4dp " 
 android : orientation = " horizontal " > 
 
 - < ImageView 
 - android : id = " @ + id / typingImage " 
 - android : layout _ width = " wrap _ content " 
 + < LinearLayout 
 + android : id = " @ + id / typingContainer " 
 + android : layout _ width = " match _ parent " 
 android : layout _ height = " wrap _ content " 
 - android : layout _ gravity = " center _ vertical " 
 - android : layout _ marginTop = " 2dp " / > 
 + android : orientation = " horizontal " > 
 + 
 + < ImageView 
 + android : id = " @ + id / typingImage " 
 + android : layout _ width = " wrap _ content " 
 + android : layout _ height = " wrap _ content " 
 + android : layout _ gravity = " center _ vertical " 
 + android : layout _ marginTop = " 2dp " / > 
 + 
 + < TextView 
 + android : id = " @ + id / typing " 
 + android : layout _ width = " match _ parent " 
 + android : layout _ height = " wrap _ content " 
 + android : textColor = " # ffffff " 
 + android : textSize = " 13sp " / > 
 + < / LinearLayout > 
 
 < TextView 
 - android : id = " @ + id / typing " 
 + android : id = " @ + id / subtitle " 
 android : layout _ width = " match _ parent " 
 android : layout _ height = " wrap _ content " 
 android : textColor = " # ffffff " 
 android : textSize = " 13sp " / > 
 - < / LinearLayout > 
 - 
 - < TextView 
 - android : id = " @ + id / subtitle " 
 - android : layout _ width = " match _ parent " 
 - android : layout _ height = " wrap _ content " 
 - android : textColor = " # ffffff " 
 - android : textSize = " 13sp " / > 
 - < / FrameLayout > 
 + < / FrameLayout > 
 + < / LinearLayout > 
 < / LinearLayout > 
 < / LinearLayout > 
 \ No newline at end of file
