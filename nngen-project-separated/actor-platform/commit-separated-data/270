BLEU SCORE: 0.02383853510228548

TEST MSG: feat ( iOS ) : Improve bubble size calculation
GENERATED MSG: fix anchor date

TEST DIFF (one line): diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Layouting / BubbleLayouts . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Layouting / BubbleLayouts . swift < nl > index 11327e3 . . 176ea72 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Layouting / BubbleLayouts . swift < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Layouting / BubbleLayouts . swift < nl > @ @ - 44 , 8 + 44 , 22 @ @ public class AACellLayout { < nl > } < nl > < nl > public class func pickApproriateSize ( width : CGFloat , height : CGFloat ) - > CGSize { < nl > - let scaleW = 240 / width < nl > - let scaleH = 340 / height < nl > + let maxW : CGFloat < nl > + let maxH : CGFloat < nl > + if AADevice . isiPad { < nl > + maxW = 240 < nl > + maxH = 340 < nl > + } else { < nl > + if AADevice . isiPhone5 | | AADevice . isiPhone4 { < nl > + maxW = 220 < nl > + maxH = 260 < nl > + } else { < nl > + maxW = 240 < nl > + maxH = 340 < nl > + } < nl > + } < nl > + let scaleW = maxW / width < nl > + let scaleH = maxH / height < nl > let scale = min ( scaleW , scaleH ) < nl > return CGSize ( width : scale * width , height : scale * height ) < nl > }
NEAREST DIFF (one line): diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Layouting / BubbleLayouts . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Layouting / BubbleLayouts . swift < nl > index 620fbd8 . . e1008dc 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Layouting / BubbleLayouts . swift < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Layouting / BubbleLayouts . swift < nl > @ @ - 29 , 9 + 29 , 11 @ @ public class AACellLayout { < nl > let key : String < nl > var height : CGFloat < nl > let date : String < nl > + let anchorDate : String < nl > < nl > public init ( height : CGFloat , date : Int64 , key : String , layouter : AABubbleLayouter ) { < nl > self . date = AACellLayout . formatDate ( date ) < nl > + self . anchorDate = Actor . getFormatter ( ) . formatDate ( date ) < nl > self . key = key < nl > self . height = height < nl > self . layouter = layouter < nl > @ @ - 39 , 6 + 41 , 8 @ @ public class AACellLayout { < nl > < nl > public class func formatDate ( date : Int64 ) - > String { < nl > return dateFormatter . stringFromDate ( NSDate ( timeIntervalSince1970 : NSTimeInterval ( Double ( date ) / 1000 . 0 ) ) ) < nl > + < nl > + < nl > } < nl > } < nl > < nl > @ @ - 47 , 4 + 51 , 4 @ @ extension NSDateFormatter { < nl > dateFormat = " HH : mm " < nl > return self < nl > } < nl > - } < nl > \ No newline at end of file < nl > + }

TEST DIFF:
diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Layouting / BubbleLayouts . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Layouting / BubbleLayouts . swift 
 index 11327e3 . . 176ea72 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Layouting / BubbleLayouts . swift 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Layouting / BubbleLayouts . swift 
 @ @ - 44 , 8 + 44 , 22 @ @ public class AACellLayout { 
 } 
 
 public class func pickApproriateSize ( width : CGFloat , height : CGFloat ) - > CGSize { 
 - let scaleW = 240 / width 
 - let scaleH = 340 / height 
 + let maxW : CGFloat 
 + let maxH : CGFloat 
 + if AADevice . isiPad { 
 + maxW = 240 
 + maxH = 340 
 + } else { 
 + if AADevice . isiPhone5 | | AADevice . isiPhone4 { 
 + maxW = 220 
 + maxH = 260 
 + } else { 
 + maxW = 240 
 + maxH = 340 
 + } 
 + } 
 + let scaleW = maxW / width 
 + let scaleH = maxH / height 
 let scale = min ( scaleW , scaleH ) 
 return CGSize ( width : scale * width , height : scale * height ) 
 }

NEAREST DIFF:
diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Layouting / BubbleLayouts . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Layouting / BubbleLayouts . swift 
 index 620fbd8 . . e1008dc 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Layouting / BubbleLayouts . swift 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Layouting / BubbleLayouts . swift 
 @ @ - 29 , 9 + 29 , 11 @ @ public class AACellLayout { 
 let key : String 
 var height : CGFloat 
 let date : String 
 + let anchorDate : String 
 
 public init ( height : CGFloat , date : Int64 , key : String , layouter : AABubbleLayouter ) { 
 self . date = AACellLayout . formatDate ( date ) 
 + self . anchorDate = Actor . getFormatter ( ) . formatDate ( date ) 
 self . key = key 
 self . height = height 
 self . layouter = layouter 
 @ @ - 39 , 6 + 41 , 8 @ @ public class AACellLayout { 
 
 public class func formatDate ( date : Int64 ) - > String { 
 return dateFormatter . stringFromDate ( NSDate ( timeIntervalSince1970 : NSTimeInterval ( Double ( date ) / 1000 . 0 ) ) ) 
 + 
 + 
 } 
 } 
 
 @ @ - 47 , 4 + 51 , 4 @ @ extension NSDateFormatter { 
 dateFormat = " HH : mm " 
 return self 
 } 
 - } 
 \ No newline at end of file 
 + }
