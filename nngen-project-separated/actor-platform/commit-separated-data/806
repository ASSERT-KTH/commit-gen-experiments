BLEU SCORE: 0.5591430457928661

TEST MSG: fix ( server : webrtc ) : end call if one device left only in case when call is already in progress
GENERATED MSG: fix ( server : webrtc ) : end call if one device left

TEST DIFF (one line): diff - - git a / actor - server / actor - core / src / main / scala / im / actor / server / webrtc / WebrtcCallActor . scala b / actor - server / actor - core / src / main / scala / im / actor / server / webrtc / WebrtcCallActor . scala < nl > index 5870282 . . 174d856 100644 < nl > - - - a / actor - server / actor - core / src / main / scala / im / actor / server / webrtc / WebrtcCallActor . scala < nl > + + + b / actor - server / actor - core / src / main / scala / im / actor / server / webrtc / WebrtcCallActor . scala < nl > @ @ - 281 , 7 + 281 , 8 @ @ private final class WebrtcCallActor extends ActorStashing with ActorLogging { < nl > putParticipant ( userId , ApiCallMemberState . ENDED ) < nl > broadcastSyncedSet ( ) < nl > } < nl > - if ( devices . size = = 1 ) end ( ) < nl > + < nl > + if ( devices . get ( deviceId ) . exists ( _ . isJoined ) & & devices . size = = 1 ) end ( ) < nl > case EventBus . Disposed ( _ ) ⇒ < nl > end ( ) < nl > deleteSyncedSet ( )
NEAREST DIFF (one line): diff - - git a / actor - server / actor - core / src / main / scala / im / actor / server / webrtc / WebrtcCallActor . scala b / actor - server / actor - core / src / main / scala / im / actor / server / webrtc / WebrtcCallActor . scala < nl > index 4db9bdf . . 5870282 100644 < nl > - - - a / actor - server / actor - core / src / main / scala / im / actor / server / webrtc / WebrtcCallActor . scala < nl > + + + b / actor - server / actor - core / src / main / scala / im / actor / server / webrtc / WebrtcCallActor . scala < nl > @ @ - 281 , 6 + 281 , 7 @ @ private final class WebrtcCallActor extends ActorStashing with ActorLogging { < nl > putParticipant ( userId , ApiCallMemberState . ENDED ) < nl > broadcastSyncedSet ( ) < nl > } < nl > + if ( devices . size = = 1 ) end ( ) < nl > case EventBus . Disposed ( _ ) ⇒ < nl > end ( ) < nl > deleteSyncedSet ( )

TEST DIFF:
diff - - git a / actor - server / actor - core / src / main / scala / im / actor / server / webrtc / WebrtcCallActor . scala b / actor - server / actor - core / src / main / scala / im / actor / server / webrtc / WebrtcCallActor . scala 
 index 5870282 . . 174d856 100644 
 - - - a / actor - server / actor - core / src / main / scala / im / actor / server / webrtc / WebrtcCallActor . scala 
 + + + b / actor - server / actor - core / src / main / scala / im / actor / server / webrtc / WebrtcCallActor . scala 
 @ @ - 281 , 7 + 281 , 8 @ @ private final class WebrtcCallActor extends ActorStashing with ActorLogging { 
 putParticipant ( userId , ApiCallMemberState . ENDED ) 
 broadcastSyncedSet ( ) 
 } 
 - if ( devices . size = = 1 ) end ( ) 
 + 
 + if ( devices . get ( deviceId ) . exists ( _ . isJoined ) & & devices . size = = 1 ) end ( ) 
 case EventBus . Disposed ( _ ) ⇒ 
 end ( ) 
 deleteSyncedSet ( )

NEAREST DIFF:
diff - - git a / actor - server / actor - core / src / main / scala / im / actor / server / webrtc / WebrtcCallActor . scala b / actor - server / actor - core / src / main / scala / im / actor / server / webrtc / WebrtcCallActor . scala 
 index 4db9bdf . . 5870282 100644 
 - - - a / actor - server / actor - core / src / main / scala / im / actor / server / webrtc / WebrtcCallActor . scala 
 + + + b / actor - server / actor - core / src / main / scala / im / actor / server / webrtc / WebrtcCallActor . scala 
 @ @ - 281 , 6 + 281 , 7 @ @ private final class WebrtcCallActor extends ActorStashing with ActorLogging { 
 putParticipant ( userId , ApiCallMemberState . ENDED ) 
 broadcastSyncedSet ( ) 
 } 
 + if ( devices . size = = 1 ) end ( ) 
 case EventBus . Disposed ( _ ) ⇒ 
 end ( ) 
 deleteSyncedSet ( )
