BLEU SCORE: 0.3026643726685863

TEST MSG: feat ( iOS ) : Added new default endpoints and added trusted keys
GENERATED MSG: feat ( iOS ) : Implemented analytics and fixed autocomplete

TEST DIFF (one line): diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDK . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDK . swift < nl > index faa4d8a . . a70b6c6 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDK . swift < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDK . swift < nl > @ @ - 40 , 7 + 40 , 25 @ @ public class ActorSDK { < nl > / / / Server Endpoints < nl > public var endpoints = [ < nl > " tls : / / front1 - mtproto - api - rev2 . actor . im " , < nl > - " tls : / / front2 - mtproto - api - rev2 . actor . im " < nl > + " tls : / / front2 - mtproto - api - rev2 . actor . im " , < nl > + < nl > + " tcp : / / front1 - mtproto - api - rev3 . actor . im : 443 " , < nl > + " tcp : / / front2 - mtproto - api - rev3 . actor . im : 443 " , < nl > + " tcp : / / front3 - mtproto - api - rev3 . actor . im : 443 " < nl > + ] { < nl > + didSet { < nl > + trustedKeys = [ ] < nl > + } < nl > + } < nl > + < nl > + / / / Trusted Server Keys < nl > + public var trustedKeys = [ < nl > + " d9d34ed487bd5b434eda2ef2c283db587c3ae7fb88405c3834d9d1a6d247145b " , < nl > + " 4bd5422b50c585b5c8575d085e9fae01c126baa968dab56a396156759d5a7b46 " , < nl > + " ff61103913aed3a9a689b6d77473bc428d363a3421fdd48a8e307a08e404f02c " , < nl > + " 20613ab577f0891102b1f0a400ca53149e2dd05da0b77a728b62f5ebc8095878 " , < nl > + " fc49f2f2465f5b4e038ec7c070975858a8b5542aa6ec1f927a57c4f646e1c143 " , < nl > + " 6709b8b733a9f20a96b9091767ac19fd6a2a978ba0dccc85a9ac8f6b6560ac1a " < nl > ] < nl > < nl > / / < nl > @ @ - 146 , 6 + 164 , 9 @ @ public class ActorSDK { < nl > for url in endpoints { < nl > builder . addEndpoint ( url ) < nl > } < nl > + for key in trustedKeys { < nl > + builder . addTrustedKey ( key ) < nl > + } < nl > builder . setApiConfiguration ( ACApiConfiguration ( appTitle : appTitle , withAppId : jint ( apiId ) , withAppKey : apiKey , withDeviceTitle : deviceName , withDeviceId : deviceKey ) ) < nl > < nl > / / Providers
NEAREST DIFF (one line): diff - - git a / actor - sdk / sdk - core - ios / ActorSDK . xcodeproj / project . pbxproj b / actor - sdk / sdk - core - ios / ActorSDK . xcodeproj / project . pbxproj < nl > index 6606a24 . . f6dbf3d 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK . xcodeproj / project . pbxproj < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK . xcodeproj / project . pbxproj < nl > @ @ - 173 , 6 + 173 , 7 @ @ < nl > 	 	 069CF4D31BCB909A00C66E12 / * CLTokenView . m in Sources * / = { isa = PBXBuildFile ; fileRef = 069CF4CB1BCB909A00C66E12 / * CLTokenView . m * / ; settings = { ASSET _ TAGS = ( ) ; } ; } ; < nl > 	 	 06CE898A1BD8401C005A5530 / * Reachability . swift in Sources * / = { isa = PBXBuildFile ; fileRef = 06CE89891BD8401C005A5530 / * Reachability . swift * / ; settings = { ASSET _ TAGS = ( ) ; } ; } ; < nl > 	 	 06CE898C1BD841C9005A5530 / * SystemConfiguration . framework in Frameworks * / = { isa = PBXBuildFile ; fileRef = 06CE898B1BD841C9005A5530 / * SystemConfiguration . framework * / ; } ; < nl > + 	 	 06CE89901BD84DF5005A5530 / * ActorSDKAnalytics . swift in Sources * / = { isa = PBXBuildFile ; fileRef = 06CE898F1BD84DF5005A5530 / * ActorSDKAnalytics . swift * / ; settings = { ASSET _ TAGS = ( ) ; } ; } ; < nl > / * End PBXBuildFile section * / < nl > < nl > / * Begin PBXFileReference section * / < nl > @ @ - 353 , 6 + 354 , 7 @ @ < nl > 	 	 069CF4CB1BCB909A00C66E12 / * CLTokenView . m * / = { isa = PBXFileReference ; fileEncoding = 4 ; lastKnownFileType = sourcecode . c . objc ; name = CLTokenView . m ; path = CLTokenInputView / CLTokenView . m ; sourceTree = " < group > " ; } ; < nl > 	 	 06CE89891BD8401C005A5530 / * Reachability . swift * / = { isa = PBXFileReference ; fileEncoding = 4 ; lastKnownFileType = sourcecode . swift ; path = Reachability . swift ; sourceTree = " < group > " ; } ; < nl > 	 	 06CE898B1BD841C9005A5530 / * SystemConfiguration . framework * / = { isa = PBXFileReference ; lastKnownFileType = wrapper . framework ; name = SystemConfiguration . framework ; path = System / Library / Frameworks / SystemConfiguration . framework ; sourceTree = SDKROOT ; } ; < nl > + 	 	 06CE898F1BD84DF5005A5530 / * ActorSDKAnalytics . swift * / = { isa = PBXFileReference ; fileEncoding = 4 ; lastKnownFileType = sourcecode . swift ; path = ActorSDKAnalytics . swift ; sourceTree = " < group > " ; } ; < nl > 	 	 22BAEA363892E475F59B7E9F / * Pods - ActorSDK . debug . xcconfig * / = { isa = PBXFileReference ; includeInIndex = 1 ; lastKnownFileType = text . xcconfig ; name = " Pods - ActorSDK . debug . xcconfig " ; path = " Pods / Target Support Files / Pods - ActorSDK / Pods - ActorSDK . debug . xcconfig " ; sourceTree = " < group > " ; } ; < nl > 	 	 333F91AE5263DD450666CC87 / * Pods - ActorSDK . release . xcconfig * / = { isa = PBXFileReference ; includeInIndex = 1 ; lastKnownFileType = text . xcconfig ; name = " Pods - ActorSDK . release . xcconfig " ; path = " Pods / Target Support Files / Pods - ActorSDK / Pods - ActorSDK . release . xcconfig " ; sourceTree = " < group > " ; } ; < nl > 	 	 9A22DF21664BBB34087283F6 / * Pods _ ActorSDK . framework * / = { isa = PBXFileReference ; explicitFileType = wrapper . framework ; includeInIndex = 0 ; path = Pods _ ActorSDK . framework ; sourceTree = BUILT _ PRODUCTS _ DIR ; } ; < nl > @ @ - 860 , 6 + 862 , 7 @ @ < nl > 	 	 	 	 066A51201BC4B53C000E606E / * SwiftExtensions * / , < nl > 	 	 	 	 066A51571BC4C112000E606E / * Utils * / , < nl > 	 	 	 	 066A50E11BC4AF9F000E606E / * ActorSDK . swift * / , < nl > + 	 	 	 	 06CE898F1BD84DF5005A5530 / * ActorSDKAnalytics . swift * / , < nl > 	 	 	 	 066A525B1BC502EB000E606E / * ActorSDKDelegate . swift * / , < nl > 	 	 	 	 066A53381BC5456B000E606E / * ActorStyle . swift * / , < nl > 	 	 	 	 066A525D1BC503BB000E606E / * ActorApplicationDelegate . swift * / , < nl > @ @ - 1122 , 6 + 1125 , 7 @ @ < nl > 	 	 	 	 066A53231BC533F5000E606E / * Caches . swift in Sources * / , < nl > 	 	 	 	 066A52691BC50E7B000E606E / * AAAuthRegisterViewController . swift in Sources * / , < nl > 	 	 	 	 066A51501BC4BE06000E606E / * AARegex . swift in Sources * / , < nl > + 	 	 	 	 06CE89901BD84DF5005A5530 / * ActorSDKAnalytics . swift in Sources * / , < nl > 	 	 	 	 069CF4D31BCB909A00C66E12 / * CLTokenView . m in Sources * / , < nl > 	 	 	 	 066A52F71BC52B13000E606E / * AAWallpapperPreviewCell . swift in Sources * / , < nl > 	 	 	 	 066A51541BC4BE95000E606E / * Images . swift in Sources * / , < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDK . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDK . swift < nl > index e9b66f6 . . e761de9 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDK . swift < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDK . swift < nl > @ @ - 30 , 6 + 30 , 9 @ @ public class ActorSDK { < nl > / / / SDK Delegate < nl > public var delegate : ActorSDKDelegate = ActorSDKDelegateDefault ( ) < nl > < nl > + / / / SDK Analytics < nl > + public var analyticsDelegate : ActorSDKAnalytics ? < nl > + < nl > / / < nl > / / Configuration < nl > / / < nl > @ @ - 410 , 6 + 413 , 21 @ @ public class ActorSDK { < nl > } < nl > } < nl > < nl > + / / / Tracking page visible < nl > + func trackPageVisible ( page : ACPage ) { < nl > + analyticsDelegate ? . analyticsPageVisible ( page ) < nl > + } < nl > + < nl > + / / / Tracking page hidden < nl > + func trackPageHidden ( page : ACPage ) { < nl > + analyticsDelegate ? . analyticsPageHidden ( page ) < nl > + } < nl > + < nl > + / / / Tracking event < nl > + func trackEvent ( event : ACEvent ) { < nl > + analyticsDelegate ? . analyticsEvent ( event ) < nl > + } < nl > + < nl > / / < nl > / / File System < nl > / / < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDKAnalytics . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDKAnalytics . swift < nl > new file mode 100644 < nl > index 0000000 . . 3751467 < nl > - - - / dev / null < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDKAnalytics . swift < nl > @ @ - 0 , 0 + 1 , 17 @ @ < nl > + / / < nl > + / / Copyright ( c ) 2014 - 2015 Actor LLC . < https : / / actor . im > < nl > + / / < nl > + < nl > + import Foundation < nl > + < nl > + public protocol ActorSDKAnalytics { < nl > + < nl > + / / / Called when page visible < nl > + func analyticsPageVisible ( page : ACPage ) < nl > + < nl > + / / / Called when page hidden < nl > + func analyticsPageHidden ( page : ACPage ) < nl > + < nl > + / / / Called when event occurs < nl > + func analyticsEvent ( event : ACEvent ) < nl > + } < nl > \ No newline at end of file < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Conversation / ConversationViewController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Conversation / ConversationViewController . swift < nl > index 03ce9dc . . be20271 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Conversation / ConversationViewController . swift < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Conversation / ConversationViewController . swift < nl > @ @ - 193 , 7 + 193 , 7 @ @ class ConversationViewController : AAConversationContentController , UIDocumentMen < nl > } < nl > < nl > Actor . onConversationOpenWithPeer ( peer ) < nl > - / / Analytics . trackPageVisible ( content ) < nl > + ActorSDK . sharedActor ( ) . trackPageVisible ( content ) < nl > } < nl > < nl > override func viewWillLayoutSubviews ( ) { < nl > @ @ - 222 , 7 + 222 , 7 @ @ class ConversationViewController : AAConversationContentController , UIDocumentMen < nl > super . viewWillDisappear ( animated ) < nl > < nl > Actor . onConversationClosedWithPeer ( peer ) < nl > - / / Analytics . trackPageHidden ( content ) < nl > + ActorSDK . sharedActor ( ) . trackPageHidden ( content ) < nl > < nl > if ! AADevice . isiPad { < nl > AANavigationBadge . hideBadge ( ) < nl > @ @ - 308 , 14 + 308 , 14 @ @ class ConversationViewController : AAConversationContentController , UIDocumentMen < nl > < nl > / / Completition < nl > < nl > - override func canShowAutoCompletion ( ) - > Bool { < nl > + override func didChangeAutoCompletionPrefix ( prefix : String ! , andWord word : String ! ) { < nl > if UInt ( self . peer . peerType . ordinal ( ) ) = = ACPeerType . GROUP . rawValue { < nl > - if self . foundPrefix = = " @ " { < nl > - < nl > + if prefix = = " @ " { < nl > + < nl > let oldCount = filteredMembers . count < nl > filteredMembers . removeAll ( keepCapacity : true ) < nl > < nl > - let res = Actor . findMentionsWithGid ( self . peer . peerId , withQuery : self . foundWord ) < nl > + let res = Actor . findMentionsWithGid ( self . peer . peerId , withQuery : word ) < nl > for index in 0 . . < res . size ( ) { < nl > filteredMembers . append ( res . getWithInt ( index ) as ! ACMentionFilterResult ) < nl > } < nl > @ @ - 324 , 13 + 324 , 16 @ @ class ConversationViewController : AAConversationContentController , UIDocumentMen < nl > self . autoCompletionView . reloadData ( ) < nl > } < nl > < nl > - return filteredMembers . count > 0 < nl > + dispatchOnUi { ( ) - > Void in < nl > + self . showAutoCompletionView ( self . filteredMembers . count > 0 ) < nl > + } < nl > + return < nl > } < nl > - < nl > - return false < nl > } < nl > < nl > - return false < nl > + dispatchOnUi { ( ) - > Void in < nl > + self . showAutoCompletionView ( false ) < nl > + } < nl > } < nl > < nl > override func tableView ( tableView : UITableView , numberOfRowsInSection section : Int ) - > Int { < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Managed Runtime / AAViewController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Managed Runtime / AAViewController . swift < nl > index 16cc802 . . 60b7cf9 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Managed Runtime / AAViewController . swift 	 < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Managed Runtime / AAViewController . swift 	 < nl > @ @ - 148 , 7 + 148 , 7 @ @ public class AAViewController : UIViewController , UINavigationControllerDelegate , < nl > super . viewWillAppear ( animated ) < nl > < nl > if let c = content { < nl > - / / Analytics . trackPageVisible ( c ) < nl > + ActorSDK . sharedActor ( ) . trackPageVisible ( c ) < nl > } < nl > if let u = uid { < nl > Actor . onProfileOpenWithUid ( jint ( u ) ) < nl > @ @ - 159 , 7 + 159 , 7 @ @ public class AAViewController : UIViewController , UINavigationControllerDelegate , < nl > super . viewWillDisappear ( animated ) < nl > < nl > if let c = content { < nl > - / / Analytics . trackPageHidden ( c ) < nl > + ActorSDK . sharedActor ( ) . trackPageHidden ( c ) < nl > } < nl > if let u = uid { < nl > Actor . onProfileClosedWithUid ( jint ( u ) ) < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Settings / AASettingsViewController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Settings / AASettingsViewController . swift < nl > index af64e43 . . f26c644 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Settings / AASettingsViewController . swift < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Settings / AASettingsViewController . swift < nl > @ @ - 355 , 12 + 355 , 6 @ @ public class AASettingsViewController : AAContentTableController { < nl > ActorSDK . sharedActor ( ) . delegate . actorSettingsSupportDidCreated ( self , section : s ) < nl > } < nl > } < nl > - < nl > - public override func viewWillAppear ( animated : Bool ) { < nl > - super . viewWillAppear ( animated ) < nl > - < nl > - Actor . onProfileOpenWithUid ( jint ( uid ) ) < nl > - } < nl > < nl > public override func tableWillBind ( binder : AABinder ) { < nl > < nl > @ @ - 408 , 10 + 402 , 4 @ @ public class AASettingsViewController : AAContentTableController { < nl > self . emailCells . reload ( ) < nl > } ) < nl > } < nl > - < nl > - public override func viewWillDisappear ( animated : Bool ) { < nl > - super . viewWillDisappear ( animated ) < nl > - < nl > - Actor . onProfileClosedWithUid ( jint ( uid ) ) < nl > - } < nl > } < nl > \ No newline at end of file < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / User / AAUserViewController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / User / AAUserViewController . swift < nl > index 15bcab8 . . 584a829 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / User / AAUserViewController . swift < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / User / AAUserViewController . swift < nl > @ @ - 226 , 12 + 226 , 6 @ @ class AAUserViewController : AAContentTableController { < nl > < nl > } < nl > < nl > - override func viewWillAppear ( animated : Bool ) { < nl > - super . viewWillAppear ( animated ) < nl > - < nl > - Actor . onProfileOpenWithUid ( jint ( uid ) ) < nl > - } < nl > - < nl > override func tableWillBind ( binder : AABinder ) { < nl > binder . bind ( user . getAvatarModel ( ) , closure : { ( value : ACAvatar ? ) - > ( ) in < nl > self . headerRow . reload ( ) < nl > @ @ - 251 , 10 + 245 , 4 @ @ class AAUserViewController : AAContentTableController { < nl > } ) < nl > } < nl > } < nl > - < nl > - override func viewWillDisappear ( animated : Bool ) { < nl > - super . viewWillDisappear ( animated ) < nl > - < nl > - Actor . onProfileOpenWithUid ( jint ( uid ) ) < nl > - } < nl > }

TEST DIFF:
diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDK . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDK . swift 
 index faa4d8a . . a70b6c6 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDK . swift 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDK . swift 
 @ @ - 40 , 7 + 40 , 25 @ @ public class ActorSDK { 
 / / / Server Endpoints 
 public var endpoints = [ 
 " tls : / / front1 - mtproto - api - rev2 . actor . im " , 
 - " tls : / / front2 - mtproto - api - rev2 . actor . im " 
 + " tls : / / front2 - mtproto - api - rev2 . actor . im " , 
 + 
 + " tcp : / / front1 - mtproto - api - rev3 . actor . im : 443 " , 
 + " tcp : / / front2 - mtproto - api - rev3 . actor . im : 443 " , 
 + " tcp : / / front3 - mtproto - api - rev3 . actor . im : 443 " 
 + ] { 
 + didSet { 
 + trustedKeys = [ ] 
 + } 
 + } 
 + 
 + / / / Trusted Server Keys 
 + public var trustedKeys = [ 
 + " d9d34ed487bd5b434eda2ef2c283db587c3ae7fb88405c3834d9d1a6d247145b " , 
 + " 4bd5422b50c585b5c8575d085e9fae01c126baa968dab56a396156759d5a7b46 " , 
 + " ff61103913aed3a9a689b6d77473bc428d363a3421fdd48a8e307a08e404f02c " , 
 + " 20613ab577f0891102b1f0a400ca53149e2dd05da0b77a728b62f5ebc8095878 " , 
 + " fc49f2f2465f5b4e038ec7c070975858a8b5542aa6ec1f927a57c4f646e1c143 " , 
 + " 6709b8b733a9f20a96b9091767ac19fd6a2a978ba0dccc85a9ac8f6b6560ac1a " 
 ] 
 
 / / 
 @ @ - 146 , 6 + 164 , 9 @ @ public class ActorSDK { 
 for url in endpoints { 
 builder . addEndpoint ( url ) 
 } 
 + for key in trustedKeys { 
 + builder . addTrustedKey ( key ) 
 + } 
 builder . setApiConfiguration ( ACApiConfiguration ( appTitle : appTitle , withAppId : jint ( apiId ) , withAppKey : apiKey , withDeviceTitle : deviceName , withDeviceId : deviceKey ) ) 
 
 / / Providers

NEAREST DIFF:
diff - - git a / actor - sdk / sdk - core - ios / ActorSDK . xcodeproj / project . pbxproj b / actor - sdk / sdk - core - ios / ActorSDK . xcodeproj / project . pbxproj 
 index 6606a24 . . f6dbf3d 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK . xcodeproj / project . pbxproj 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK . xcodeproj / project . pbxproj 
 @ @ - 173 , 6 + 173 , 7 @ @ 
 	 	 069CF4D31BCB909A00C66E12 / * CLTokenView . m in Sources * / = { isa = PBXBuildFile ; fileRef = 069CF4CB1BCB909A00C66E12 / * CLTokenView . m * / ; settings = { ASSET _ TAGS = ( ) ; } ; } ; 
 	 	 06CE898A1BD8401C005A5530 / * Reachability . swift in Sources * / = { isa = PBXBuildFile ; fileRef = 06CE89891BD8401C005A5530 / * Reachability . swift * / ; settings = { ASSET _ TAGS = ( ) ; } ; } ; 
 	 	 06CE898C1BD841C9005A5530 / * SystemConfiguration . framework in Frameworks * / = { isa = PBXBuildFile ; fileRef = 06CE898B1BD841C9005A5530 / * SystemConfiguration . framework * / ; } ; 
 + 	 	 06CE89901BD84DF5005A5530 / * ActorSDKAnalytics . swift in Sources * / = { isa = PBXBuildFile ; fileRef = 06CE898F1BD84DF5005A5530 / * ActorSDKAnalytics . swift * / ; settings = { ASSET _ TAGS = ( ) ; } ; } ; 
 / * End PBXBuildFile section * / 
 
 / * Begin PBXFileReference section * / 
 @ @ - 353 , 6 + 354 , 7 @ @ 
 	 	 069CF4CB1BCB909A00C66E12 / * CLTokenView . m * / = { isa = PBXFileReference ; fileEncoding = 4 ; lastKnownFileType = sourcecode . c . objc ; name = CLTokenView . m ; path = CLTokenInputView / CLTokenView . m ; sourceTree = " < group > " ; } ; 
 	 	 06CE89891BD8401C005A5530 / * Reachability . swift * / = { isa = PBXFileReference ; fileEncoding = 4 ; lastKnownFileType = sourcecode . swift ; path = Reachability . swift ; sourceTree = " < group > " ; } ; 
 	 	 06CE898B1BD841C9005A5530 / * SystemConfiguration . framework * / = { isa = PBXFileReference ; lastKnownFileType = wrapper . framework ; name = SystemConfiguration . framework ; path = System / Library / Frameworks / SystemConfiguration . framework ; sourceTree = SDKROOT ; } ; 
 + 	 	 06CE898F1BD84DF5005A5530 / * ActorSDKAnalytics . swift * / = { isa = PBXFileReference ; fileEncoding = 4 ; lastKnownFileType = sourcecode . swift ; path = ActorSDKAnalytics . swift ; sourceTree = " < group > " ; } ; 
 	 	 22BAEA363892E475F59B7E9F / * Pods - ActorSDK . debug . xcconfig * / = { isa = PBXFileReference ; includeInIndex = 1 ; lastKnownFileType = text . xcconfig ; name = " Pods - ActorSDK . debug . xcconfig " ; path = " Pods / Target Support Files / Pods - ActorSDK / Pods - ActorSDK . debug . xcconfig " ; sourceTree = " < group > " ; } ; 
 	 	 333F91AE5263DD450666CC87 / * Pods - ActorSDK . release . xcconfig * / = { isa = PBXFileReference ; includeInIndex = 1 ; lastKnownFileType = text . xcconfig ; name = " Pods - ActorSDK . release . xcconfig " ; path = " Pods / Target Support Files / Pods - ActorSDK / Pods - ActorSDK . release . xcconfig " ; sourceTree = " < group > " ; } ; 
 	 	 9A22DF21664BBB34087283F6 / * Pods _ ActorSDK . framework * / = { isa = PBXFileReference ; explicitFileType = wrapper . framework ; includeInIndex = 0 ; path = Pods _ ActorSDK . framework ; sourceTree = BUILT _ PRODUCTS _ DIR ; } ; 
 @ @ - 860 , 6 + 862 , 7 @ @ 
 	 	 	 	 066A51201BC4B53C000E606E / * SwiftExtensions * / , 
 	 	 	 	 066A51571BC4C112000E606E / * Utils * / , 
 	 	 	 	 066A50E11BC4AF9F000E606E / * ActorSDK . swift * / , 
 + 	 	 	 	 06CE898F1BD84DF5005A5530 / * ActorSDKAnalytics . swift * / , 
 	 	 	 	 066A525B1BC502EB000E606E / * ActorSDKDelegate . swift * / , 
 	 	 	 	 066A53381BC5456B000E606E / * ActorStyle . swift * / , 
 	 	 	 	 066A525D1BC503BB000E606E / * ActorApplicationDelegate . swift * / , 
 @ @ - 1122 , 6 + 1125 , 7 @ @ 
 	 	 	 	 066A53231BC533F5000E606E / * Caches . swift in Sources * / , 
 	 	 	 	 066A52691BC50E7B000E606E / * AAAuthRegisterViewController . swift in Sources * / , 
 	 	 	 	 066A51501BC4BE06000E606E / * AARegex . swift in Sources * / , 
 + 	 	 	 	 06CE89901BD84DF5005A5530 / * ActorSDKAnalytics . swift in Sources * / , 
 	 	 	 	 069CF4D31BCB909A00C66E12 / * CLTokenView . m in Sources * / , 
 	 	 	 	 066A52F71BC52B13000E606E / * AAWallpapperPreviewCell . swift in Sources * / , 
 	 	 	 	 066A51541BC4BE95000E606E / * Images . swift in Sources * / , 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDK . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDK . swift 
 index e9b66f6 . . e761de9 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDK . swift 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDK . swift 
 @ @ - 30 , 6 + 30 , 9 @ @ public class ActorSDK { 
 / / / SDK Delegate 
 public var delegate : ActorSDKDelegate = ActorSDKDelegateDefault ( ) 
 
 + / / / SDK Analytics 
 + public var analyticsDelegate : ActorSDKAnalytics ? 
 + 
 / / 
 / / Configuration 
 / / 
 @ @ - 410 , 6 + 413 , 21 @ @ public class ActorSDK { 
 } 
 } 
 
 + / / / Tracking page visible 
 + func trackPageVisible ( page : ACPage ) { 
 + analyticsDelegate ? . analyticsPageVisible ( page ) 
 + } 
 + 
 + / / / Tracking page hidden 
 + func trackPageHidden ( page : ACPage ) { 
 + analyticsDelegate ? . analyticsPageHidden ( page ) 
 + } 
 + 
 + / / / Tracking event 
 + func trackEvent ( event : ACEvent ) { 
 + analyticsDelegate ? . analyticsEvent ( event ) 
 + } 
 + 
 / / 
 / / File System 
 / / 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDKAnalytics . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDKAnalytics . swift 
 new file mode 100644 
 index 0000000 . . 3751467 
 - - - / dev / null 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDKAnalytics . swift 
 @ @ - 0 , 0 + 1 , 17 @ @ 
 + / / 
 + / / Copyright ( c ) 2014 - 2015 Actor LLC . < https : / / actor . im > 
 + / / 
 + 
 + import Foundation 
 + 
 + public protocol ActorSDKAnalytics { 
 + 
 + / / / Called when page visible 
 + func analyticsPageVisible ( page : ACPage ) 
 + 
 + / / / Called when page hidden 
 + func analyticsPageHidden ( page : ACPage ) 
 + 
 + / / / Called when event occurs 
 + func analyticsEvent ( event : ACEvent ) 
 + } 
 \ No newline at end of file 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Conversation / ConversationViewController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Conversation / ConversationViewController . swift 
 index 03ce9dc . . be20271 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Conversation / ConversationViewController . swift 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Conversation / ConversationViewController . swift 
 @ @ - 193 , 7 + 193 , 7 @ @ class ConversationViewController : AAConversationContentController , UIDocumentMen 
 } 
 
 Actor . onConversationOpenWithPeer ( peer ) 
 - / / Analytics . trackPageVisible ( content ) 
 + ActorSDK . sharedActor ( ) . trackPageVisible ( content ) 
 } 
 
 override func viewWillLayoutSubviews ( ) { 
 @ @ - 222 , 7 + 222 , 7 @ @ class ConversationViewController : AAConversationContentController , UIDocumentMen 
 super . viewWillDisappear ( animated ) 
 
 Actor . onConversationClosedWithPeer ( peer ) 
 - / / Analytics . trackPageHidden ( content ) 
 + ActorSDK . sharedActor ( ) . trackPageHidden ( content ) 
 
 if ! AADevice . isiPad { 
 AANavigationBadge . hideBadge ( ) 
 @ @ - 308 , 14 + 308 , 14 @ @ class ConversationViewController : AAConversationContentController , UIDocumentMen 
 
 / / Completition 
 
 - override func canShowAutoCompletion ( ) - > Bool { 
 + override func didChangeAutoCompletionPrefix ( prefix : String ! , andWord word : String ! ) { 
 if UInt ( self . peer . peerType . ordinal ( ) ) = = ACPeerType . GROUP . rawValue { 
 - if self . foundPrefix = = " @ " { 
 - 
 + if prefix = = " @ " { 
 + 
 let oldCount = filteredMembers . count 
 filteredMembers . removeAll ( keepCapacity : true ) 
 
 - let res = Actor . findMentionsWithGid ( self . peer . peerId , withQuery : self . foundWord ) 
 + let res = Actor . findMentionsWithGid ( self . peer . peerId , withQuery : word ) 
 for index in 0 . . < res . size ( ) { 
 filteredMembers . append ( res . getWithInt ( index ) as ! ACMentionFilterResult ) 
 } 
 @ @ - 324 , 13 + 324 , 16 @ @ class ConversationViewController : AAConversationContentController , UIDocumentMen 
 self . autoCompletionView . reloadData ( ) 
 } 
 
 - return filteredMembers . count > 0 
 + dispatchOnUi { ( ) - > Void in 
 + self . showAutoCompletionView ( self . filteredMembers . count > 0 ) 
 + } 
 + return 
 } 
 - 
 - return false 
 } 
 
 - return false 
 + dispatchOnUi { ( ) - > Void in 
 + self . showAutoCompletionView ( false ) 
 + } 
 } 
 
 override func tableView ( tableView : UITableView , numberOfRowsInSection section : Int ) - > Int { 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Managed Runtime / AAViewController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Managed Runtime / AAViewController . swift 
 index 16cc802 . . 60b7cf9 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Managed Runtime / AAViewController . swift 	 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Managed Runtime / AAViewController . swift 	 
 @ @ - 148 , 7 + 148 , 7 @ @ public class AAViewController : UIViewController , UINavigationControllerDelegate , 
 super . viewWillAppear ( animated ) 
 
 if let c = content { 
 - / / Analytics . trackPageVisible ( c ) 
 + ActorSDK . sharedActor ( ) . trackPageVisible ( c ) 
 } 
 if let u = uid { 
 Actor . onProfileOpenWithUid ( jint ( u ) ) 
 @ @ - 159 , 7 + 159 , 7 @ @ public class AAViewController : UIViewController , UINavigationControllerDelegate , 
 super . viewWillDisappear ( animated ) 
 
 if let c = content { 
 - / / Analytics . trackPageHidden ( c ) 
 + ActorSDK . sharedActor ( ) . trackPageHidden ( c ) 
 } 
 if let u = uid { 
 Actor . onProfileClosedWithUid ( jint ( u ) ) 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Settings / AASettingsViewController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Settings / AASettingsViewController . swift 
 index af64e43 . . f26c644 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Settings / AASettingsViewController . swift 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Settings / AASettingsViewController . swift 
 @ @ - 355 , 12 + 355 , 6 @ @ public class AASettingsViewController : AAContentTableController { 
 ActorSDK . sharedActor ( ) . delegate . actorSettingsSupportDidCreated ( self , section : s ) 
 } 
 } 
 - 
 - public override func viewWillAppear ( animated : Bool ) { 
 - super . viewWillAppear ( animated ) 
 - 
 - Actor . onProfileOpenWithUid ( jint ( uid ) ) 
 - } 
 
 public override func tableWillBind ( binder : AABinder ) { 
 
 @ @ - 408 , 10 + 402 , 4 @ @ public class AASettingsViewController : AAContentTableController { 
 self . emailCells . reload ( ) 
 } ) 
 } 
 - 
 - public override func viewWillDisappear ( animated : Bool ) { 
 - super . viewWillDisappear ( animated ) 
 - 
 - Actor . onProfileClosedWithUid ( jint ( uid ) ) 
 - } 
 } 
 \ No newline at end of file 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / User / AAUserViewController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / User / AAUserViewController . swift 
 index 15bcab8 . . 584a829 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / User / AAUserViewController . swift 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / User / AAUserViewController . swift 
 @ @ - 226 , 12 + 226 , 6 @ @ class AAUserViewController : AAContentTableController { 
 
 } 
 
 - override func viewWillAppear ( animated : Bool ) { 
 - super . viewWillAppear ( animated ) 
 - 
 - Actor . onProfileOpenWithUid ( jint ( uid ) ) 
 - } 
 - 
 override func tableWillBind ( binder : AABinder ) { 
 binder . bind ( user . getAvatarModel ( ) , closure : { ( value : ACAvatar ? ) - > ( ) in 
 self . headerRow . reload ( ) 
 @ @ - 251 , 10 + 245 , 4 @ @ class AAUserViewController : AAContentTableController { 
 } ) 
 } 
 } 
 - 
 - override func viewWillDisappear ( animated : Bool ) { 
 - super . viewWillDisappear ( animated ) 
 - 
 - Actor . onProfileOpenWithUid ( jint ( uid ) ) 
 - } 
 }
