BLEU SCORE: 0.3498761149110956

TEST MSG: fix ( iOS ) : Fixing create photo text placeholder , fix OTP keyboard
GENERATED MSG: fix ( iOS ) : Fixing iPad compatibility

TEST DIFF (one line): diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Resources / Base . lproj / Localizable . strings b / actor - sdk / sdk - core - ios / ActorSDK / Resources / Base . lproj / Localizable . strings < nl > index fc2a2ae . . 09ff52f 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Resources / Base . lproj / Localizable . strings < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Resources / Base . lproj / Localizable . strings < nl > @ @ - 576 , 6 + 576 , 10 @ @ < nl > < nl > " ActionCancel " = " Cancel " ; < nl > < nl > + " ActionAddPhoto1 " = " add " ; < nl > + < nl > + " ActionAddPhoto2 " = " photo " ; < nl > + < nl > / * < nl > * Network < nl > * / < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Resources / es . lproj / Localizable . strings b / actor - sdk / sdk - core - ios / ActorSDK / Resources / es . lproj / Localizable . strings < nl > index 46043a2 . . 20a59ee 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Resources / es . lproj / Localizable . strings < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Resources / es . lproj / Localizable . strings < nl > @ @ - 565 , 6 + 565 , 10 @ @ < nl > < nl > " ActionCancel " = " Cancelar " ; < nl > < nl > + " ActionAddPhoto1 " = " a ñ adir " ; < nl > + < nl > + " ActionAddPhoto2 " = " foto " ; < nl > + < nl > / * < nl > * Network < nl > * / < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Resources / pt . lproj / Localizable . strings b / actor - sdk / sdk - core - ios / ActorSDK / Resources / pt . lproj / Localizable . strings < nl > index fd11a3a . . 376d808 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Resources / pt . lproj / Localizable . strings < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Resources / pt . lproj / Localizable . strings < nl > @ @ - 553 , 6 + 553 , 10 @ @ < nl > < nl > " ActionCancel " = " Cancelar " ; < nl > < nl > + " ActionAddPhoto1 " = " adicionar " ; < nl > + < nl > + " ActionAddPhoto2 " = " foto " ; < nl > + < nl > / * < nl > * Network < nl > * / < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Resources / ru . lproj / Localizable . strings b / actor - sdk / sdk - core - ios / ActorSDK / Resources / ru . lproj / Localizable . strings < nl > index ea78769 . . 77d0896 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Resources / ru . lproj / Localizable . strings < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Resources / ru . lproj / Localizable . strings < nl > @ @ - 564 , 6 + 564 , 10 @ @ < nl > < nl > " ActionCancel " = " О т м е н а " ; < nl > < nl > + " ActionAddPhoto1 " = " д о б а в и т ь " ; < nl > + < nl > + " ActionAddPhoto2 " = " ф о т о " ; < nl > + < nl > / * < nl > * Network < nl > * / < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Resources / zh - Hans . lproj / Localizable . strings b / actor - sdk / sdk - core - ios / ActorSDK / Resources / zh - Hans . lproj / Localizable . strings < nl > index 0766591 . . 0550ac8 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Resources / zh - Hans . lproj / Localizable . strings < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Resources / zh - Hans . lproj / Localizable . strings < nl > @ @ - 558 , 6 + 558 , 7 @ @ < nl > < nl > " UnsupportedContent " = " 这 个 版 本 不 支 持 此 消 息 。 请 等 待 应 用 升 级 ， 之 后 就 可 以 看 到 消 息 了 。 " ; < nl > < nl > + < nl > / * < nl > * Actions < nl > * / < nl > @ @ - 574 , 6 + 575 , 10 @ @ < nl > < nl > " ActionCancel " = " 取 消 " ; < nl > < nl > + " ActionAddPhoto1 " = " 添 加 " ; < nl > + < nl > + " ActionAddPhoto2 " = " 头 像 " ; < nl > + < nl > / * < nl > * Network < nl > * / < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Auth / AAAuthOTPViewController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Auth / AAAuthOTPViewController . swift < nl > index a066857 . . 89892ed 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Auth / AAAuthOTPViewController . swift < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Auth / AAAuthOTPViewController . swift < nl > @ @ - 105 , 7 + 105 , 7 @ @ public class AAAuthOTPViewController : AAAuthViewController , MFMailComposeViewCon < nl > codeField . font = UIFont . systemFontOfSize ( 17 ) < nl > codeField . textColor = ActorSDK . sharedActor ( ) . style . authTextColor < nl > codeField . placeholder = AALocalized ( " AuthOTPPlaceholder " ) < nl > - codeField . keyboardType = . EmailAddress < nl > + codeField . keyboardType = . NumberPad < nl > codeField . autocapitalizationType = . None < nl > < nl > codeFieldLine . backgroundColor = ActorSDK . sharedActor ( ) . style . authSeparatorColor < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAGroupCreateViewController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAGroupCreateViewController . swift < nl > index 153daa9 . . 9eca881 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAGroupCreateViewController . swift < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAGroupCreateViewController . swift < nl > @ @ - 50 , 14 + 50 , 14 @ @ public class AAGroupCreateViewController : AAViewController , UITextFieldDelegate < nl > addPhotoButton . addTarget ( self , action : " photoTap " , forControlEvents : UIControlEvents . TouchUpInside ) < nl > < nl > let addPhotoLabelFirst = UILabel ( ) < nl > - addPhotoLabelFirst . text = AALocalized ( " AuthProfileAddPhoto1 " ) < nl > + addPhotoLabelFirst . text = AALocalized ( " ActionAddPhoto1 " ) < nl > addPhotoLabelFirst . font = UIFont . systemFontOfSize ( 15 . 0 ) < nl > addPhotoLabelFirst . backgroundColor = UIColor . clearColor ( ) < nl > addPhotoLabelFirst . textColor = appStyle . composeAvatarTextColor < nl > addPhotoLabelFirst . sizeToFit ( ) < nl > < nl > let addPhotoLabelSecond = UILabel ( ) < nl > - addPhotoLabelSecond . text = AALocalized ( " AuthProfileAddPhoto2 " ) < nl > + addPhotoLabelSecond . text = AALocalized ( " ActionAddPhoto2 " ) < nl > addPhotoLabelSecond . font = UIFont . systemFontOfSize ( 15 . 0 ) < nl > addPhotoLabelSecond . backgroundColor = UIColor . clearColor ( ) < nl > addPhotoLabelSecond . textColor = appStyle . composeAvatarTextColor < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Layouting / AABubbleBackgroundProcessor . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Layouting / AABubbleBackgroundProcessor . swift < nl > index 50fac9b . . bc06b44 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Layouting / AABubbleBackgroundProcessor . swift < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Layouting / AABubbleBackgroundProcessor . swift < nl > @ @ - 49 , 7 + 49 , 7 @ @ class AAListProcessor : NSObject , ARListProcessor { < nl > self . peer = peer < nl > } < nl > < nl > - func processWithItems ( items : JavaUtilList ! , withPrevious previous : AnyObject ! ) - > AnyObject ! { < nl > + func processWithItems ( items : JavaUtilList , withPrevious previous : AnyObject ? ) - > AnyObject ? { < nl > < nl > let start = CFAbsoluteTimeGetCurrent ( ) < nl > var section = start < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Recent / AARecentViewController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Recent / AARecentViewController . swift < nl > index 80a70ed . . fb47cb5 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Recent / AARecentViewController . swift < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Recent / AARecentViewController . swift < nl > @ @ - 77 , 7 + 77 , 11 @ @ public class AARecentViewController : AADialogsListContentController , AADialogsLi < nl > } < nl > < nl > public func compose ( ) { < nl > - navigateNext ( AAComposeController ( ) ) < nl > + if AADevice . isiPad { < nl > + self . presentElegantViewController ( AANavigationController ( rootViewController : AAComposeController ( ) ) ) < nl > + } else { < nl > + navigateNext ( AAComposeController ( ) ) < nl > + } < nl > } < nl > < nl > / / Tracking app state < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Utils / AAAudioManager . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Utils / AAAudioManager . swift < nl > index 351d97f . . ebac38d 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Utils / AAAudioManager . swift < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Utils / AAAudioManager . swift < nl > @ @ - 40 , 6 + 40 , 8 @ @ public class AAAudioManager : NSObject , AVAudioPlayerDelegate { < nl > if isVisible { < nl > audioRouter . mode = AVAudioSessionModeDefault < nl > audioRouter . currentRoute = . Speaker < nl > + audioRouter . isEnabled = true < nl > + audioRouter . isManagingEnabled = true < nl > ringtoneStart ( ) < nl > } else { < nl > notificationRingtone ( call ) < nl > @ @ - 49 , 8 + 51 , 9 @ @ public class AAAudioManager : NSObject , AVAudioPlayerDelegate { < nl > audioRouter . category = AVAudioSessionCategoryPlayAndRecord < nl > audioRouter . mode = AVAudioSessionModeVoiceChat < nl > audioRouter . currentRoute = . Receiver < nl > + audioRouter . isEnabled = true < nl > + audioRouter . isManagingEnabled = true < nl > } < nl > - audioRouter . isEnabled = true < nl > } < nl > < nl > public func callAnswered ( call : ACCallVM ) { < nl > @ @ - 67 , 6 + 70 , 7 @ @ public class AAAudioManager : NSObject , AVAudioPlayerDelegate { < nl > audioRouter . mode = AVAudioSessionModeDefault < nl > audioRouter . currentRoute = . Receiver < nl > audioRouter . isEnabled = false < nl > + audioRouter . isManagingEnabled = false < nl > } < nl > < nl > < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Utils / AAAudioRouter . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Utils / AAAudioRouter . swift < nl > index 0d8ce03 . . 0a7c3fa 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Utils / AAAudioRouter . swift < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Utils / AAAudioRouter . swift < nl > @ @ - 12 , 6 + 12 , 12 @ @ public enum Route { < nl > < nl > public class AAAudioRouter { < nl > < nl > + public var isManagingEnabled = false { < nl > + didSet ( v ) { < nl > + fixSession ( ) < nl > + } < nl > + } < nl > + < nl > public var isEnabled = false { < nl > didSet ( v ) { < nl > fixSession ( ) < nl > @ @ - 82 , 10 + 88 , 8 @ @ public class AAAudioRouter { < nl > private func fixSession ( ) { < nl > let session = AVAudioSession . sharedInstance ( ) < nl > < nl > - do { < nl > - if isEnabled { < nl > - try session . setActive ( true ) < nl > - < nl > + if isManagingEnabled { < nl > + do { < nl > if session . category ! = category { < nl > try session . setCategory ( category ) < nl > } < nl > @ @ - 104 , 12 + 108 , 15 @ @ public class AAAudioRouter { < nl > } < nl > } < nl > } < nl > - } else { < nl > - try session . setActive ( false ) < nl > + } catch let error as NSError { < nl > + print ( " Audio Session : \ ( error . description ) " ) < nl > } < nl > < nl > - } catch let error as NSError { < nl > - print ( " Audio Session : \ ( error . description ) " ) < nl > + do { < nl > + try session . setActive ( isEnabled ) < nl > + } catch let error as NSError { < nl > + print ( " Audio Session : \ ( error . description ) " ) < nl > + } < nl > } < nl > } < nl > } < nl > \ No newline at end of file
NEAREST DIFF (one line): diff - - git a / actor - sdk / sdk - core - ios / ActorApp . xcodeproj / project . pbxproj b / actor - sdk / sdk - core - ios / ActorApp . xcodeproj / project . pbxproj < nl > index 6ef6244 . . 3f4c2da 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorApp . xcodeproj / project . pbxproj < nl > + + + b / actor - sdk / sdk - core - ios / ActorApp . xcodeproj / project . pbxproj < nl > @ @ - 426 , 7 + 426 , 7 @ @ < nl > 	 	 	 	 	 " - framework " , < nl > 	 	 	 	 	 " \ " WebKit \ " " , < nl > 	 	 	 	 ) ; < nl > - 	 	 	 	 PRODUCT _ BUNDLE _ IDENTIFIER = im . actor . sdk ; < nl > + 	 	 	 	 PRODUCT _ BUNDLE _ IDENTIFIER = im . actor . sdk . app ; < nl > 	 	 	 	 PRODUCT _ NAME = " $ ( TARGET _ NAME ) " ; < nl > 	 	 	 	 PROVISIONING _ PROFILE = " " ; < nl > 	 	 	 	 SDK _ PATH = " . . / actor - sdk " ; < nl > @ @ - 544 , 7 + 544 , 7 @ @ < nl > 	 	 	 	 	 " - framework " , < nl > 	 	 	 	 	 " \ " WebKit \ " " , < nl > 	 	 	 	 ) ; < nl > - 	 	 	 	 PRODUCT _ BUNDLE _ IDENTIFIER = im . actor . sdk ; < nl > + 	 	 	 	 PRODUCT _ BUNDLE _ IDENTIFIER = im . actor . sdk . app ; < nl > 	 	 	 	 PRODUCT _ NAME = " $ ( TARGET _ NAME ) " ; < nl > 	 	 	 	 PROVISIONING _ PROFILE = " " ; < nl > 	 	 	 	 SDK _ PATH = " . . / actor - sdk " ; < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAComposeController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAComposeController . swift < nl > index af58779 . . ad4af58 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAComposeController . swift < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAComposeController . swift < nl > @ @ - 36 , 7 + 36 , 7 @ @ public class AAComposeController : AAContactsListContentController , AAContactsLis < nl > } < nl > < nl > public func contactDidTap ( controller : AAContactsListContentController , contact : ACContact ) - > Bool { < nl > - navigateNext ( ConversationViewController ( peer : ACPeer . userWithInt ( contact . uid ) ) , removeCurrent : true ) < nl > + navigateDetail ( ConversationViewController ( peer : ACPeer . userWithInt ( contact . uid ) ) ) < nl > return false < nl > } < nl > } < nl > \ No newline at end of file < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAGroupCreateViewController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAGroupCreateViewController . swift < nl > index dc0852f . . b51d791 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAGroupCreateViewController . swift < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAGroupCreateViewController . swift < nl > @ @ - 92 , 14 + 92 , 12 @ @ public class AAGroupCreateViewController : AAViewController , UITextFieldDelegate < nl > public override func viewDidLayoutSubviews ( ) { < nl > super . viewDidLayoutSubviews ( ) < nl > < nl > - let screenSize = UIScreen . mainScreen ( ) . bounds . size < nl > - < nl > avatarImageView . frame = CGRectMake ( 20 , 20 + 66 , 80 , 80 ) < nl > addPhotoButton . frame = avatarImageView . frame < nl > - hint . frame = CGRectMake ( 120 , 20 + 66 , screenSize . width - 140 , 80 ) < nl > + hint . frame = CGRectMake ( 120 , 20 + 66 , view . width - 140 , 80 ) < nl > < nl > - groupName . frame = CGRectMake ( 20 , 106 + 66 , screenSize . width - 20 , 56 . 0 ) < nl > - groupNameFieldSeparator . frame = CGRectMake ( 20 , 156 + 66 , screenSize . width - 20 , 0 . 5 ) < nl > + groupName . frame = CGRectMake ( 20 , 106 + 66 , view . width - 20 , 56 . 0 ) < nl > + groupNameFieldSeparator . frame = CGRectMake ( 20 , 156 + 66 , view . width - 20 , 0 . 5 ) < nl > } < nl > < nl > public func photoTap ( ) { < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAGroupMembersController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAGroupMembersController . swift < nl > index 0828011 . . 1b87a4f 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAGroupMembersController . swift < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAGroupMembersController . swift < nl > @ @ - 81 , 7 + 81 , 7 @ @ public class GroupMembersController : AAContactsListContentController , AAContacts < nl > if self . groupImage ! = nil { < nl > Actor . changeGroupAvatar ( gid , image : self . groupImage ! ) < nl > } < nl > - self . navigateNext ( ConversationViewController ( peer : ACPeer . groupWithInt ( gid ) ) , removeCurrent : true ) < nl > + self . navigateDetail ( ConversationViewController ( peer : ACPeer . groupWithInt ( gid ) ) ) < nl > } < nl > } < nl > < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Contacts / AAContactsViewController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Contacts / AAContactsViewController . swift < nl > index 6832daf . . 273f87f 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Contacts / AAContactsViewController . swift < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Contacts / AAContactsViewController . swift < nl > @ @ - 56 , 7 + 56 , 7 @ @ class AAContactsViewController : AAContactsListContentController , AAContactsListC < nl > < nl > r . selectAction = { ( ) - > Bool in < nl > self . findContact ( ) < nl > - return false < nl > + return AADevice . isiPad < nl > } < nl > } < nl > < nl > @ @ - 116 , 7 + 116 , 9 @ @ class AAContactsViewController : AAContactsListContentController , AAContactsListC < nl > } < nl > } < nl > < nl > - self . showActionSheet ( builder . items , cancelButton : " AlertCancel " , destructButton : nil , sourceView : UIView ( ) , sourceRect : CGRectZero , tapClosure : builder . tapClosure ) < nl > + let view = self . tableView . cellForRowAtIndexPath ( NSIndexPath ( forRow : 1 , inSection : 0 ) ) ! . contentView < nl > + < nl > + self . showActionSheet ( builder . items , cancelButton : " AlertCancel " , destructButton : nil , sourceView : view , sourceRect : view . bounds , tapClosure : builder . tapClosure ) < nl > < nl > return true < nl > } < nl > @ @ - 156 , 10 + 158 , 10 @ @ class AAContactsViewController : AAContactsListContentController , AAContactsListC < nl > < nl > if user ! = nil { < nl > c . execute ( Actor . addContactCommandWithUid ( user ! . getId ( ) ) , successBlock : { ( val ) - > Void in < nl > - self . navigateNext ( ConversationViewController ( peer : ACPeer _ userWithInt _ ( user ! . getId ( ) ) ) ) < nl > + self . navigateDetail ( ConversationViewController ( peer : ACPeer _ userWithInt _ ( user ! . getId ( ) ) ) ) < nl > c . dismiss ( ) < nl > } , failureBlock : { ( val ) - > Void in < nl > - self . navigateNext ( ConversationViewController ( peer : ACPeer _ userWithInt _ ( user ! . getId ( ) ) ) ) < nl > + self . navigateDetail ( ConversationViewController ( peer : ACPeer _ userWithInt _ ( user ! . getId ( ) ) ) ) < nl > c . dismiss ( ) < nl > } ) < nl > } else { < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / AAConversationContentController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / AAConversationContentController . swift < nl > index da5a968 . . e33d2af 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / AAConversationContentController . swift < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / AAConversationContentController . swift < nl > @ @ - 341 , 11 + 341 , 12 @ @ public class AAConversationContentController : SLKTextViewController , ARDisplayLi < nl > } < nl > } < nl > < nl > - public override func willRotateToInterfaceOrientation ( toInterfaceOrientation : UIInterfaceOrientation , duration : NSTimeInterval ) { < nl > - super . willRotateToInterfaceOrientation ( toInterfaceOrientation , duration : duration ) < nl > + public override func viewWillTransitionToSize ( size : CGSize , withTransitionCoordinator coordinator : UIViewControllerTransitionCoordinator ) { < nl > + super . viewWillTransitionToSize ( size , withTransitionCoordinator : coordinator ) < nl > < nl > dispatch _ async ( dispatch _ get _ main _ queue ( ) , { ( ) - > Void in < nl > - self . collectionView . collectionViewLayout . invalidateLayout ( ) < nl > + / / self . collectionView . collectionViewLayout . invalidateLayout ( ) < nl > + self . collectionView . performBatchUpdates ( nil , completion : nil ) < nl > } ) < nl > } < nl > } < nl > \ No newline at end of file < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / AANavigationBadge . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / AANavigationBadge . swift < nl > index 5a07bf3 . . f846338 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / AANavigationBadge . swift < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / AANavigationBadge . swift < nl > @ @ - 57 , 6 + 57 , 9 @ @ class AANavigationBadge { < nl > } < nl > < nl > class func showBadge ( ) { < nl > + if ( AADevice . isiPad ) { < nl > + return < nl > + } < nl > start ( ) < nl > isBadgeVisible = true < nl > if badgeCount > 0 { < nl > @ @ - 65 , 6 + 68 , 9 @ @ class AANavigationBadge { < nl > } < nl > < nl > class func hideBadge ( ) { < nl > + if ( AADevice . isiPad ) { < nl > + return < nl > + } < nl > start ( ) < nl > isBadgeVisible = false < nl > self . badgeView . hideView ( ) < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Managed Runtime / AAManagedTableController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Managed Runtime / AAManagedTableController . swift < nl > index 957bcc3 . . 8d47288 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Managed Runtime / AAManagedTableController . swift 	 < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Managed Runtime / AAManagedTableController . swift 	 < nl > @ @ - 131 , 6 + 131 , 12 @ @ public class AAManagedTableController : AAViewController { < nl > m . controllerViewDidDisappear ( animated ) < nl > } < nl > } < nl > + < nl > + public override func viewWillLayoutSubviews ( ) { < nl > + super . viewWillLayoutSubviews ( ) < nl > + < nl > + tableView . frame = view . bounds < nl > + } < nl > } < nl > < nl > public protocol AAManagedTableControllerDelegate { < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Managed Runtime / Alerts . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Managed Runtime / Alerts . swift < nl > index 23ef765 . . d798a63 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Managed Runtime / Alerts . swift 	 < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Managed Runtime / Alerts . swift 	 < nl > @ @ - 121 , 14 + 121 , 22 @ @ public extension UIViewController { < nl > let config = AAEditTextControllerConfig ( ) < nl > closure ( config ) < nl > config . check ( ) < nl > - self . presentViewController ( AANavigationController ( rootViewController : AAEditTextController ( config : config ) ) , animated : true , completion : nil ) < nl > + let controller = AANavigationController ( rootViewController : AAEditTextController ( config : config ) ) < nl > + if ( AADevice . isiPad ) { < nl > + controller . modalPresentationStyle = . FormSheet < nl > + } < nl > + self . presentViewController ( controller , animated : true , completion : nil ) < nl > } < nl > < nl > func startEditField ( @ noescape closure : ( c : AAEditFieldControllerConfig ) - > ( ) ) { < nl > let config = AAEditFieldControllerConfig ( ) < nl > closure ( c : config ) < nl > config . check ( ) < nl > - self . presentViewController ( AANavigationController ( rootViewController : AAEditFieldController ( config : config ) ) , animated : true , completion : nil ) < nl > + let controller = AANavigationController ( rootViewController : AAEditFieldController ( config : config ) ) < nl > + if ( AADevice . isiPad ) { < nl > + controller . modalPresentationStyle = . FormSheet < nl > + } < nl > + self . presentViewController ( controller , animated : true , completion : nil ) < nl > } < nl > } < nl > < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Settings / AASettingsViewController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Settings / AASettingsViewController . swift < nl > index f26c644 . . 1312413 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Settings / AASettingsViewController . swift < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Settings / AASettingsViewController . swift < nl > @ @ - 88 , 11 + 88 , 12 @ @ public class AASettingsViewController : AAContentTableController { < nl > s . action ( " SettingsSetPhoto " ) { [ unowned self ] ( r ) - > ( ) in < nl > r . selectAction = { [ unowned self ] ( ) - > Bool in < nl > let hasCamera = UIImagePickerController . isSourceTypeAvailable ( UIImagePickerControllerSourceType . Camera ) < nl > + let view = self . tableView . cellForRowAtIndexPath ( NSIndexPath ( forRow : 1 , inSection : 0 ) ) ! . contentView < nl > self . showActionSheet ( hasCamera ? [ " PhotoCamera " , " PhotoLibrary " ] : [ " PhotoLibrary " ] , < nl > cancelButton : " AlertCancel " , < nl > destructButton : self . user . getAvatarModel ( ) . get ( ) ! = nil ? " PhotoRemove " : nil , < nl > - sourceView : self . view , < nl > - sourceRect : self . view . bounds , < nl > + sourceView : view , < nl > + sourceRect : view . bounds , < nl > tapClosure : { [ unowned self ] ( index ) - > ( ) in < nl > if index = = - 2 { < nl > self . confirmUser ( " PhotoRemoveGroupMessage " , < nl > @ @ - 217 , 7 + 218 , 7 @ @ public class AASettingsViewController : AAContentTableController { < nl > } < nl > } < nl > < nl > - return false < nl > + return AADevice . isiPad < nl > } < nl > } < nl > < nl > @ @ - 258 , 7 + 259 , 7 @ @ public class AASettingsViewController : AAContentTableController { < nl > } < nl > } < nl > < nl > - return false < nl > + return AADevice . isiPad < nl > } < nl > }

TEST DIFF:
diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Resources / Base . lproj / Localizable . strings b / actor - sdk / sdk - core - ios / ActorSDK / Resources / Base . lproj / Localizable . strings 
 index fc2a2ae . . 09ff52f 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Resources / Base . lproj / Localizable . strings 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Resources / Base . lproj / Localizable . strings 
 @ @ - 576 , 6 + 576 , 10 @ @ 
 
 " ActionCancel " = " Cancel " ; 
 
 + " ActionAddPhoto1 " = " add " ; 
 + 
 + " ActionAddPhoto2 " = " photo " ; 
 + 
 / * 
 * Network 
 * / 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Resources / es . lproj / Localizable . strings b / actor - sdk / sdk - core - ios / ActorSDK / Resources / es . lproj / Localizable . strings 
 index 46043a2 . . 20a59ee 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Resources / es . lproj / Localizable . strings 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Resources / es . lproj / Localizable . strings 
 @ @ - 565 , 6 + 565 , 10 @ @ 
 
 " ActionCancel " = " Cancelar " ; 
 
 + " ActionAddPhoto1 " = " a ñ adir " ; 
 + 
 + " ActionAddPhoto2 " = " foto " ; 
 + 
 / * 
 * Network 
 * / 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Resources / pt . lproj / Localizable . strings b / actor - sdk / sdk - core - ios / ActorSDK / Resources / pt . lproj / Localizable . strings 
 index fd11a3a . . 376d808 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Resources / pt . lproj / Localizable . strings 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Resources / pt . lproj / Localizable . strings 
 @ @ - 553 , 6 + 553 , 10 @ @ 
 
 " ActionCancel " = " Cancelar " ; 
 
 + " ActionAddPhoto1 " = " adicionar " ; 
 + 
 + " ActionAddPhoto2 " = " foto " ; 
 + 
 / * 
 * Network 
 * / 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Resources / ru . lproj / Localizable . strings b / actor - sdk / sdk - core - ios / ActorSDK / Resources / ru . lproj / Localizable . strings 
 index ea78769 . . 77d0896 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Resources / ru . lproj / Localizable . strings 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Resources / ru . lproj / Localizable . strings 
 @ @ - 564 , 6 + 564 , 10 @ @ 
 
 " ActionCancel " = " О т м е н а " ; 
 
 + " ActionAddPhoto1 " = " д о б а в и т ь " ; 
 + 
 + " ActionAddPhoto2 " = " ф о т о " ; 
 + 
 / * 
 * Network 
 * / 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Resources / zh - Hans . lproj / Localizable . strings b / actor - sdk / sdk - core - ios / ActorSDK / Resources / zh - Hans . lproj / Localizable . strings 
 index 0766591 . . 0550ac8 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Resources / zh - Hans . lproj / Localizable . strings 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Resources / zh - Hans . lproj / Localizable . strings 
 @ @ - 558 , 6 + 558 , 7 @ @ 
 
 " UnsupportedContent " = " 这 个 版 本 不 支 持 此 消 息 。 请 等 待 应 用 升 级 ， 之 后 就 可 以 看 到 消 息 了 。 " ; 
 
 + 
 / * 
 * Actions 
 * / 
 @ @ - 574 , 6 + 575 , 10 @ @ 
 
 " ActionCancel " = " 取 消 " ; 
 
 + " ActionAddPhoto1 " = " 添 加 " ; 
 + 
 + " ActionAddPhoto2 " = " 头 像 " ; 
 + 
 / * 
 * Network 
 * / 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Auth / AAAuthOTPViewController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Auth / AAAuthOTPViewController . swift 
 index a066857 . . 89892ed 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Auth / AAAuthOTPViewController . swift 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Auth / AAAuthOTPViewController . swift 
 @ @ - 105 , 7 + 105 , 7 @ @ public class AAAuthOTPViewController : AAAuthViewController , MFMailComposeViewCon 
 codeField . font = UIFont . systemFontOfSize ( 17 ) 
 codeField . textColor = ActorSDK . sharedActor ( ) . style . authTextColor 
 codeField . placeholder = AALocalized ( " AuthOTPPlaceholder " ) 
 - codeField . keyboardType = . EmailAddress 
 + codeField . keyboardType = . NumberPad 
 codeField . autocapitalizationType = . None 
 
 codeFieldLine . backgroundColor = ActorSDK . sharedActor ( ) . style . authSeparatorColor 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAGroupCreateViewController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAGroupCreateViewController . swift 
 index 153daa9 . . 9eca881 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAGroupCreateViewController . swift 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAGroupCreateViewController . swift 
 @ @ - 50 , 14 + 50 , 14 @ @ public class AAGroupCreateViewController : AAViewController , UITextFieldDelegate 
 addPhotoButton . addTarget ( self , action : " photoTap " , forControlEvents : UIControlEvents . TouchUpInside ) 
 
 let addPhotoLabelFirst = UILabel ( ) 
 - addPhotoLabelFirst . text = AALocalized ( " AuthProfileAddPhoto1 " ) 
 + addPhotoLabelFirst . text = AALocalized ( " ActionAddPhoto1 " ) 
 addPhotoLabelFirst . font = UIFont . systemFontOfSize ( 15 . 0 ) 
 addPhotoLabelFirst . backgroundColor = UIColor . clearColor ( ) 
 addPhotoLabelFirst . textColor = appStyle . composeAvatarTextColor 
 addPhotoLabelFirst . sizeToFit ( ) 
 
 let addPhotoLabelSecond = UILabel ( ) 
 - addPhotoLabelSecond . text = AALocalized ( " AuthProfileAddPhoto2 " ) 
 + addPhotoLabelSecond . text = AALocalized ( " ActionAddPhoto2 " ) 
 addPhotoLabelSecond . font = UIFont . systemFontOfSize ( 15 . 0 ) 
 addPhotoLabelSecond . backgroundColor = UIColor . clearColor ( ) 
 addPhotoLabelSecond . textColor = appStyle . composeAvatarTextColor 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Layouting / AABubbleBackgroundProcessor . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Layouting / AABubbleBackgroundProcessor . swift 
 index 50fac9b . . bc06b44 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Layouting / AABubbleBackgroundProcessor . swift 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Layouting / AABubbleBackgroundProcessor . swift 
 @ @ - 49 , 7 + 49 , 7 @ @ class AAListProcessor : NSObject , ARListProcessor { 
 self . peer = peer 
 } 
 
 - func processWithItems ( items : JavaUtilList ! , withPrevious previous : AnyObject ! ) - > AnyObject ! { 
 + func processWithItems ( items : JavaUtilList , withPrevious previous : AnyObject ? ) - > AnyObject ? { 
 
 let start = CFAbsoluteTimeGetCurrent ( ) 
 var section = start 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Recent / AARecentViewController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Recent / AARecentViewController . swift 
 index 80a70ed . . fb47cb5 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Recent / AARecentViewController . swift 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Recent / AARecentViewController . swift 
 @ @ - 77 , 7 + 77 , 11 @ @ public class AARecentViewController : AADialogsListContentController , AADialogsLi 
 } 
 
 public func compose ( ) { 
 - navigateNext ( AAComposeController ( ) ) 
 + if AADevice . isiPad { 
 + self . presentElegantViewController ( AANavigationController ( rootViewController : AAComposeController ( ) ) ) 
 + } else { 
 + navigateNext ( AAComposeController ( ) ) 
 + } 
 } 
 
 / / Tracking app state 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Utils / AAAudioManager . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Utils / AAAudioManager . swift 
 index 351d97f . . ebac38d 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Utils / AAAudioManager . swift 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Utils / AAAudioManager . swift 
 @ @ - 40 , 6 + 40 , 8 @ @ public class AAAudioManager : NSObject , AVAudioPlayerDelegate { 
 if isVisible { 
 audioRouter . mode = AVAudioSessionModeDefault 
 audioRouter . currentRoute = . Speaker 
 + audioRouter . isEnabled = true 
 + audioRouter . isManagingEnabled = true 
 ringtoneStart ( ) 
 } else { 
 notificationRingtone ( call ) 
 @ @ - 49 , 8 + 51 , 9 @ @ public class AAAudioManager : NSObject , AVAudioPlayerDelegate { 
 audioRouter . category = AVAudioSessionCategoryPlayAndRecord 
 audioRouter . mode = AVAudioSessionModeVoiceChat 
 audioRouter . currentRoute = . Receiver 
 + audioRouter . isEnabled = true 
 + audioRouter . isManagingEnabled = true 
 } 
 - audioRouter . isEnabled = true 
 } 
 
 public func callAnswered ( call : ACCallVM ) { 
 @ @ - 67 , 6 + 70 , 7 @ @ public class AAAudioManager : NSObject , AVAudioPlayerDelegate { 
 audioRouter . mode = AVAudioSessionModeDefault 
 audioRouter . currentRoute = . Receiver 
 audioRouter . isEnabled = false 
 + audioRouter . isManagingEnabled = false 
 } 
 
 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Utils / AAAudioRouter . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Utils / AAAudioRouter . swift 
 index 0d8ce03 . . 0a7c3fa 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Utils / AAAudioRouter . swift 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Utils / AAAudioRouter . swift 
 @ @ - 12 , 6 + 12 , 12 @ @ public enum Route { 
 
 public class AAAudioRouter { 
 
 + public var isManagingEnabled = false { 
 + didSet ( v ) { 
 + fixSession ( ) 
 + } 
 + } 
 + 
 public var isEnabled = false { 
 didSet ( v ) { 
 fixSession ( ) 
 @ @ - 82 , 10 + 88 , 8 @ @ public class AAAudioRouter { 
 private func fixSession ( ) { 
 let session = AVAudioSession . sharedInstance ( ) 
 
 - do { 
 - if isEnabled { 
 - try session . setActive ( true ) 
 - 
 + if isManagingEnabled { 
 + do { 
 if session . category ! = category { 
 try session . setCategory ( category ) 
 } 
 @ @ - 104 , 12 + 108 , 15 @ @ public class AAAudioRouter { 
 } 
 } 
 } 
 - } else { 
 - try session . setActive ( false ) 
 + } catch let error as NSError { 
 + print ( " Audio Session : \ ( error . description ) " ) 
 } 
 
 - } catch let error as NSError { 
 - print ( " Audio Session : \ ( error . description ) " ) 
 + do { 
 + try session . setActive ( isEnabled ) 
 + } catch let error as NSError { 
 + print ( " Audio Session : \ ( error . description ) " ) 
 + } 
 } 
 } 
 } 
 \ No newline at end of file

NEAREST DIFF:
diff - - git a / actor - sdk / sdk - core - ios / ActorApp . xcodeproj / project . pbxproj b / actor - sdk / sdk - core - ios / ActorApp . xcodeproj / project . pbxproj 
 index 6ef6244 . . 3f4c2da 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorApp . xcodeproj / project . pbxproj 
 + + + b / actor - sdk / sdk - core - ios / ActorApp . xcodeproj / project . pbxproj 
 @ @ - 426 , 7 + 426 , 7 @ @ 
 	 	 	 	 	 " - framework " , 
 	 	 	 	 	 " \ " WebKit \ " " , 
 	 	 	 	 ) ; 
 - 	 	 	 	 PRODUCT _ BUNDLE _ IDENTIFIER = im . actor . sdk ; 
 + 	 	 	 	 PRODUCT _ BUNDLE _ IDENTIFIER = im . actor . sdk . app ; 
 	 	 	 	 PRODUCT _ NAME = " $ ( TARGET _ NAME ) " ; 
 	 	 	 	 PROVISIONING _ PROFILE = " " ; 
 	 	 	 	 SDK _ PATH = " . . / actor - sdk " ; 
 @ @ - 544 , 7 + 544 , 7 @ @ 
 	 	 	 	 	 " - framework " , 
 	 	 	 	 	 " \ " WebKit \ " " , 
 	 	 	 	 ) ; 
 - 	 	 	 	 PRODUCT _ BUNDLE _ IDENTIFIER = im . actor . sdk ; 
 + 	 	 	 	 PRODUCT _ BUNDLE _ IDENTIFIER = im . actor . sdk . app ; 
 	 	 	 	 PRODUCT _ NAME = " $ ( TARGET _ NAME ) " ; 
 	 	 	 	 PROVISIONING _ PROFILE = " " ; 
 	 	 	 	 SDK _ PATH = " . . / actor - sdk " ; 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAComposeController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAComposeController . swift 
 index af58779 . . ad4af58 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAComposeController . swift 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAComposeController . swift 
 @ @ - 36 , 7 + 36 , 7 @ @ public class AAComposeController : AAContactsListContentController , AAContactsLis 
 } 
 
 public func contactDidTap ( controller : AAContactsListContentController , contact : ACContact ) - > Bool { 
 - navigateNext ( ConversationViewController ( peer : ACPeer . userWithInt ( contact . uid ) ) , removeCurrent : true ) 
 + navigateDetail ( ConversationViewController ( peer : ACPeer . userWithInt ( contact . uid ) ) ) 
 return false 
 } 
 } 
 \ No newline at end of file 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAGroupCreateViewController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAGroupCreateViewController . swift 
 index dc0852f . . b51d791 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAGroupCreateViewController . swift 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAGroupCreateViewController . swift 
 @ @ - 92 , 14 + 92 , 12 @ @ public class AAGroupCreateViewController : AAViewController , UITextFieldDelegate 
 public override func viewDidLayoutSubviews ( ) { 
 super . viewDidLayoutSubviews ( ) 
 
 - let screenSize = UIScreen . mainScreen ( ) . bounds . size 
 - 
 avatarImageView . frame = CGRectMake ( 20 , 20 + 66 , 80 , 80 ) 
 addPhotoButton . frame = avatarImageView . frame 
 - hint . frame = CGRectMake ( 120 , 20 + 66 , screenSize . width - 140 , 80 ) 
 + hint . frame = CGRectMake ( 120 , 20 + 66 , view . width - 140 , 80 ) 
 
 - groupName . frame = CGRectMake ( 20 , 106 + 66 , screenSize . width - 20 , 56 . 0 ) 
 - groupNameFieldSeparator . frame = CGRectMake ( 20 , 156 + 66 , screenSize . width - 20 , 0 . 5 ) 
 + groupName . frame = CGRectMake ( 20 , 106 + 66 , view . width - 20 , 56 . 0 ) 
 + groupNameFieldSeparator . frame = CGRectMake ( 20 , 156 + 66 , view . width - 20 , 0 . 5 ) 
 } 
 
 public func photoTap ( ) { 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAGroupMembersController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAGroupMembersController . swift 
 index 0828011 . . 1b87a4f 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAGroupMembersController . swift 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Compose / AAGroupMembersController . swift 
 @ @ - 81 , 7 + 81 , 7 @ @ public class GroupMembersController : AAContactsListContentController , AAContacts 
 if self . groupImage ! = nil { 
 Actor . changeGroupAvatar ( gid , image : self . groupImage ! ) 
 } 
 - self . navigateNext ( ConversationViewController ( peer : ACPeer . groupWithInt ( gid ) ) , removeCurrent : true ) 
 + self . navigateDetail ( ConversationViewController ( peer : ACPeer . groupWithInt ( gid ) ) ) 
 } 
 } 
 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Contacts / AAContactsViewController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Contacts / AAContactsViewController . swift 
 index 6832daf . . 273f87f 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Contacts / AAContactsViewController . swift 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Contacts / AAContactsViewController . swift 
 @ @ - 56 , 7 + 56 , 7 @ @ class AAContactsViewController : AAContactsListContentController , AAContactsListC 
 
 r . selectAction = { ( ) - > Bool in 
 self . findContact ( ) 
 - return false 
 + return AADevice . isiPad 
 } 
 } 
 
 @ @ - 116 , 7 + 116 , 9 @ @ class AAContactsViewController : AAContactsListContentController , AAContactsListC 
 } 
 } 
 
 - self . showActionSheet ( builder . items , cancelButton : " AlertCancel " , destructButton : nil , sourceView : UIView ( ) , sourceRect : CGRectZero , tapClosure : builder . tapClosure ) 
 + let view = self . tableView . cellForRowAtIndexPath ( NSIndexPath ( forRow : 1 , inSection : 0 ) ) ! . contentView 
 + 
 + self . showActionSheet ( builder . items , cancelButton : " AlertCancel " , destructButton : nil , sourceView : view , sourceRect : view . bounds , tapClosure : builder . tapClosure ) 
 
 return true 
 } 
 @ @ - 156 , 10 + 158 , 10 @ @ class AAContactsViewController : AAContactsListContentController , AAContactsListC 
 
 if user ! = nil { 
 c . execute ( Actor . addContactCommandWithUid ( user ! . getId ( ) ) , successBlock : { ( val ) - > Void in 
 - self . navigateNext ( ConversationViewController ( peer : ACPeer _ userWithInt _ ( user ! . getId ( ) ) ) ) 
 + self . navigateDetail ( ConversationViewController ( peer : ACPeer _ userWithInt _ ( user ! . getId ( ) ) ) ) 
 c . dismiss ( ) 
 } , failureBlock : { ( val ) - > Void in 
 - self . navigateNext ( ConversationViewController ( peer : ACPeer _ userWithInt _ ( user ! . getId ( ) ) ) ) 
 + self . navigateDetail ( ConversationViewController ( peer : ACPeer _ userWithInt _ ( user ! . getId ( ) ) ) ) 
 c . dismiss ( ) 
 } ) 
 } else { 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / AAConversationContentController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / AAConversationContentController . swift 
 index da5a968 . . e33d2af 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / AAConversationContentController . swift 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / AAConversationContentController . swift 
 @ @ - 341 , 11 + 341 , 12 @ @ public class AAConversationContentController : SLKTextViewController , ARDisplayLi 
 } 
 } 
 
 - public override func willRotateToInterfaceOrientation ( toInterfaceOrientation : UIInterfaceOrientation , duration : NSTimeInterval ) { 
 - super . willRotateToInterfaceOrientation ( toInterfaceOrientation , duration : duration ) 
 + public override func viewWillTransitionToSize ( size : CGSize , withTransitionCoordinator coordinator : UIViewControllerTransitionCoordinator ) { 
 + super . viewWillTransitionToSize ( size , withTransitionCoordinator : coordinator ) 
 
 dispatch _ async ( dispatch _ get _ main _ queue ( ) , { ( ) - > Void in 
 - self . collectionView . collectionViewLayout . invalidateLayout ( ) 
 + / / self . collectionView . collectionViewLayout . invalidateLayout ( ) 
 + self . collectionView . performBatchUpdates ( nil , completion : nil ) 
 } ) 
 } 
 } 
 \ No newline at end of file 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / AANavigationBadge . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / AANavigationBadge . swift 
 index 5a07bf3 . . f846338 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / AANavigationBadge . swift 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / AANavigationBadge . swift 
 @ @ - 57 , 6 + 57 , 9 @ @ class AANavigationBadge { 
 } 
 
 class func showBadge ( ) { 
 + if ( AADevice . isiPad ) { 
 + return 
 + } 
 start ( ) 
 isBadgeVisible = true 
 if badgeCount > 0 { 
 @ @ - 65 , 6 + 68 , 9 @ @ class AANavigationBadge { 
 } 
 
 class func hideBadge ( ) { 
 + if ( AADevice . isiPad ) { 
 + return 
 + } 
 start ( ) 
 isBadgeVisible = false 
 self . badgeView . hideView ( ) 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Managed Runtime / AAManagedTableController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Managed Runtime / AAManagedTableController . swift 
 index 957bcc3 . . 8d47288 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Managed Runtime / AAManagedTableController . swift 	 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Managed Runtime / AAManagedTableController . swift 	 
 @ @ - 131 , 6 + 131 , 12 @ @ public class AAManagedTableController : AAViewController { 
 m . controllerViewDidDisappear ( animated ) 
 } 
 } 
 + 
 + public override func viewWillLayoutSubviews ( ) { 
 + super . viewWillLayoutSubviews ( ) 
 + 
 + tableView . frame = view . bounds 
 + } 
 } 
 
 public protocol AAManagedTableControllerDelegate { 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Managed Runtime / Alerts . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Managed Runtime / Alerts . swift 
 index 23ef765 . . d798a63 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Managed Runtime / Alerts . swift 	 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Managed Runtime / Alerts . swift 	 
 @ @ - 121 , 14 + 121 , 22 @ @ public extension UIViewController { 
 let config = AAEditTextControllerConfig ( ) 
 closure ( config ) 
 config . check ( ) 
 - self . presentViewController ( AANavigationController ( rootViewController : AAEditTextController ( config : config ) ) , animated : true , completion : nil ) 
 + let controller = AANavigationController ( rootViewController : AAEditTextController ( config : config ) ) 
 + if ( AADevice . isiPad ) { 
 + controller . modalPresentationStyle = . FormSheet 
 + } 
 + self . presentViewController ( controller , animated : true , completion : nil ) 
 } 
 
 func startEditField ( @ noescape closure : ( c : AAEditFieldControllerConfig ) - > ( ) ) { 
 let config = AAEditFieldControllerConfig ( ) 
 closure ( c : config ) 
 config . check ( ) 
 - self . presentViewController ( AANavigationController ( rootViewController : AAEditFieldController ( config : config ) ) , animated : true , completion : nil ) 
 + let controller = AANavigationController ( rootViewController : AAEditFieldController ( config : config ) ) 
 + if ( AADevice . isiPad ) { 
 + controller . modalPresentationStyle = . FormSheet 
 + } 
 + self . presentViewController ( controller , animated : true , completion : nil ) 
 } 
 } 
 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Settings / AASettingsViewController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Settings / AASettingsViewController . swift 
 index f26c644 . . 1312413 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Settings / AASettingsViewController . swift 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Settings / AASettingsViewController . swift 
 @ @ - 88 , 11 + 88 , 12 @ @ public class AASettingsViewController : AAContentTableController { 
 s . action ( " SettingsSetPhoto " ) { [ unowned self ] ( r ) - > ( ) in 
 r . selectAction = { [ unowned self ] ( ) - > Bool in 
 let hasCamera = UIImagePickerController . isSourceTypeAvailable ( UIImagePickerControllerSourceType . Camera ) 
 + let view = self . tableView . cellForRowAtIndexPath ( NSIndexPath ( forRow : 1 , inSection : 0 ) ) ! . contentView 
 self . showActionSheet ( hasCamera ? [ " PhotoCamera " , " PhotoLibrary " ] : [ " PhotoLibrary " ] , 
 cancelButton : " AlertCancel " , 
 destructButton : self . user . getAvatarModel ( ) . get ( ) ! = nil ? " PhotoRemove " : nil , 
 - sourceView : self . view , 
 - sourceRect : self . view . bounds , 
 + sourceView : view , 
 + sourceRect : view . bounds , 
 tapClosure : { [ unowned self ] ( index ) - > ( ) in 
 if index = = - 2 { 
 self . confirmUser ( " PhotoRemoveGroupMessage " , 
 @ @ - 217 , 7 + 218 , 7 @ @ public class AASettingsViewController : AAContentTableController { 
 } 
 } 
 
 - return false 
 + return AADevice . isiPad 
 } 
 } 
 
 @ @ - 258 , 7 + 259 , 7 @ @ public class AASettingsViewController : AAContentTableController { 
 } 
 } 
 
 - return false 
 + return AADevice . isiPad 
 } 
 }
