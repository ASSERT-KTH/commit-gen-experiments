BLEU SCORE: 0.08032276872815308

TEST MSG: refactor ( server ) : replace actor . home env variable with relative path
GENERATED MSG: fix ( server : activation ) : fix email template

TEST DIFF (one line): diff - - git a / actor - server / actor - activation / src / main / resources / reference . conf b / actor - server / actor - activation / src / main / resources / reference . conf < nl > index a9d2b52 . . bba3b7a 100644 < nl > - - - a / actor - server / actor - activation / src / main / resources / reference . conf < nl > + + + b / actor - server / actor - activation / src / main / resources / reference . conf < nl > @ @ - 8 , 7 + 8 , 7 @ @ services { < nl > code - attempts : 3 < nl > < nl > email { < nl > - template : $ { actor . home } / templates / activation - email - template . html < nl > + template : templates / activation - email - template . html < nl > } < nl > internal { < nl > sender - user - id : 10 < nl > diff - - git a / actor - server / actor - activation / src / main / scala / im / actor / server / activation / smtp / SMTPProvider . scala b / actor - server / actor - activation / src / main / scala / im / actor / server / activation / smtp / SMTPProvider . scala < nl > index 87890c2 . . 5c8ebb8 100644 < nl > - - - a / actor - server / actor - activation / src / main / scala / im / actor / server / activation / smtp / SMTPProvider . scala < nl > + + + b / actor - server / actor - activation / src / main / scala / im / actor / server / activation / smtp / SMTPProvider . scala < nl > @ @ - 7 , 13 + 7 , 14 @ @ import akka . pattern . ask < nl > import akka . util . Timeout < nl > import cats . data . Xor < nl > import im . actor . config . ActorConfig < nl > + import im . actor . env . ActorEnv < nl > import im . actor . server . activation . common . ActivationStateActor . { Send , SendAck } < nl > import im . actor . server . activation . common . _ < nl > import im . actor . server . db . DbExtension < nl > import im . actor . server . email . { Content , EmailConfig , Message , SmtpEmailSender } < nl > import im . actor . util . misc . EmailUtils . isTestEmail < nl > < nl > - import scala . concurrent . { Future } < nl > + import scala . concurrent . Future < nl > import scala . concurrent . duration . _ < nl > < nl > private [ activation ] final class SMTPProvider ( system : ActorSystem ) extends ActivationProvider with CommonAuthCodes { < nl > @ @ - 26 , 9 + 27 , 10 @ @ private [ activation ] final class SMTPProvider ( system : ActorSystem ) extends Activa < nl > < nl > private val emailConfig = EmailConfig . load . getOrElse ( throw new RuntimeException ( " Failed to load email config " ) ) < nl > private val emailSender = new SmtpEmailSender ( emailConfig ) < nl > - private val emailTemplateLocation = ActorConfig . load ( ) . getString ( " services . activation . email . template " ) < nl > + private val emailTemplateLocation = < nl > + ActorEnv . getAbsolutePath ( Paths . get ( ActorConfig . load ( ) . getString ( " services . activation . email . template " ) ) ) < nl > < nl > - private val emailTemplate = new String ( Files . readAllBytes ( Paths . get ( emailTemplateLocation ) ) ) < nl > + private val emailTemplate = new String ( Files . readAllBytes ( emailTemplateLocation ) ) < nl > < nl > private val smtpStateActor = system . actorOf ( ActivationStateActor . props [ String , EmailCode ] ( < nl > repeatLimit = activationConfig . repeatLimit , < nl > diff - - git a / actor - server / actor - runtime / src / main / scala / im / actor / config / ActorConfig . scala b / actor - server / actor - runtime / src / main / scala / im / actor / config / ActorConfig . scala < nl > index 5a5ec0c . . b6ba51e 100644 < nl > - - - a / actor - server / actor - runtime / src / main / scala / im / actor / config / ActorConfig . scala < nl > + + + b / actor - server / actor - runtime / src / main / scala / im / actor / config / ActorConfig . scala < nl > @ @ - 1 , 15 + 1 , 17 @ @ < nl > package im . actor . config < nl > < nl > + import java . nio . file . { Path , Paths } < nl > import java . util . concurrent . TimeUnit < nl > < nl > import akka . actor . ActorSystem < nl > - import com . typesafe . config . { ConfigException , Config , ConfigFactory } < nl > + import com . typesafe . config . { Config , ConfigException , ConfigFactory } < nl > + < nl > import scala . collection . JavaConversions . _ < nl > import scala . concurrent . duration . _ < nl > - < nl > import scala . util . { Failure , Success , Try } < nl > < nl > object ActorConfig { < nl > + < nl > def load ( defaults : Config = ConfigFactory . empty ( ) ) : Config = { < nl > val mainConfig = ConfigFactory . load ( ) < nl > < nl > diff - - git a / actor - server / actor - runtime / src / main / scala / im / actor / env / ActorEnv . scala b / actor - server / actor - runtime / src / main / scala / im / actor / env / ActorEnv . scala < nl > new file mode 100644 < nl > index 0000000 . . fd43c0c < nl > - - - / dev / null < nl > + + + b / actor - server / actor - runtime / src / main / scala / im / actor / env / ActorEnv . scala < nl > @ @ - 0 , 0 + 1 , 14 @ @ < nl > + package im . actor . env < nl > + < nl > + import java . nio . file . { Path , Paths } < nl > + < nl > + object ActorEnv { < nl > + < nl > + def getAbsolutePath ( path : Path ) : Path = < nl > + if ( path . isAbsolute ) path else home . resolve ( path ) . toAbsolutePath . normalize < nl > + < nl > + def getAbsolutePath ( pathString : String ) : Path = getAbsolutePath ( Paths . get ( pathString ) ) < nl > + < nl > + val home : Path = Paths . get ( " . " ) . toAbsolutePath . normalize ( ) < nl > + < nl > + } < nl > diff - - git a / actor - server / actor - server - sdk / src / main / scala / im / actor / server / ActorServer . scala b / actor - server / actor - server - sdk / src / main / scala / im / actor / server / ActorServer . scala < nl > index ea3c553 . . 262c6e8 100644 < nl > - - - a / actor - server / actor - server - sdk / src / main / scala / im / actor / server / ActorServer . scala < nl > + + + b / actor - server / actor - server - sdk / src / main / scala / im / actor / server / ActorServer . scala < nl > @ @ - 1 , 11 + 1 , 13 @ @ < nl > package im . actor . server < nl > < nl > + import java . nio . file . { Files , Paths } < nl > + < nl > import akka . actor . _ < nl > import akka . cluster . Cluster < nl > import akka . stream . ActorMaterializer < nl > import com . typesafe . config . { Config , ConfigException , ConfigFactory } < nl > import im . actor . config . ActorConfig < nl > - import im . actor . server . activation . ActivationContext < nl > + import im . actor . env . ActorEnv < nl > import im . actor . server . api . http . { HttpApi , HttpApiConfig } < nl > import im . actor . server . api . rpc . RpcApiExtension < nl > import im . actor . server . api . rpc . service . auth . AuthServiceImpl < nl > @ @ - 75 , 8 + 77 , 9 @ @ final case class ActorServerBuilder ( defaultConfig : Config = ConfigFactory . empty ( < nl > * @ return < nl > * / < nl > def start ( ) : ActorServer = { < nl > - Option ( System . getProperty ( " actor . home " ) ) foreach { home â‡’ < nl > - System . setProperty ( " config . file " , s " $ home / conf / server . conf " ) < nl > + val configPath = ActorEnv . getAbsolutePath ( " conf / server . conf " ) < nl > + if ( Files . exists ( configPath ) ) { < nl > + System . setProperty ( " config . file " , configPath . toString ) < nl > } < nl > < nl > System . setProperty ( " sun . jnu . encoding " , " UTF - 8 " ) < nl > diff - - git a / actor - server / actor - tests / src / test / scala / im / actor / util / PathSpec . scala b / actor - server / actor - tests / src / test / scala / im / actor / util / PathSpec . scala < nl > new file mode 100644 < nl > index 0000000 . . 94db9b2 < nl > - - - / dev / null < nl > + + + b / actor - server / actor - tests / src / test / scala / im / actor / util / PathSpec . scala < nl > @ @ - 0 , 0 + 1 , 19 @ @ < nl > + package im . actor . util < nl > + < nl > + import java . nio . file . Files < nl > + < nl > + import im . actor . config . ActorConfig < nl > + import org . scalatest . { FlatSpec , Matchers } < nl > + < nl > + class PathSpec extends FlatSpec with Matchers { < nl > + < nl > + " Templates folder " should " exist " in templatesFolderExists ( ) < nl > + < nl > + def templatesFolderExists ( ) : Unit = { < nl > + val path = ActorConfig . getAbsolutePath ( " templates " ) < nl > + assert ( Files . exists ( path ) , " templates path should exist " ) < nl > + assert ( Files . isDirectory ( path ) , " templates is a folder " ) < nl > + assert ( path . isAbsolute , " templates path is absolute " ) < nl > + } < nl > + < nl > + } < nl > \ No newline at end of file < nl > diff - - git a / actor - server / build . sbt b / actor - server / build . sbt < nl > index 5d108d0 . . 5c0a595 100644 < nl > - - - a / actor - server / build . sbt < nl > + + + b / actor - server / build . sbt < nl > @ @ - 19 , 7 + 19 , 6 @ @ rpmVendor : = " actor " < nl > daemonUser in Linux : = " actor " < nl > daemonGroup in Linux : = ( daemonUser in Linux ) . value < nl > < nl > - bashScriptExtraDefines + = " " " addJava " - Dactor . home = $ { app _ home } / . . " " " " < nl > bashScriptExtraDefines + = " " " addJava " - Dlogback . configurationFile = $ { app _ home } / . . / conf / logback . xml " " " " < nl > bashScriptExtraDefines + = " " " addJava - XX : + HeapDumpOnOutOfMemoryError - XX : HeapDumpPath = $ { app _ home } / . . / logs / dump - ` date ` . hprof " " " < nl > < nl > @ @ - 32 , 4 + 31 , 8 @ @ dockerUpdateLatest : = true < nl > linuxPackageMappings + = { < nl > val initFiles = sourceDirectory . value / " linux " / " var " / " lib " / " actor " < nl > packageMapping ( initFiles - > " / var / lib / actor " ) withPerms " 0644 " withUser " actor " withGroup " actor " withContents ( ) < nl > + } < nl > + < nl > + linuxPackageMappings + = { < nl > + packageMapping ( baseDirectory . value / " templates " - > " / usr / share / actor / templates " ) withContents ( ) < nl > } < nl > \ No newline at end of file < nl > diff - - git a / actor - server / src / linux / usr / share / actor / templates / activation - email - template . html b / actor - server / src / linux / usr / share / actor / templates / activation - email - template . html < nl > deleted file mode 100644 < nl > index e34ddc6 . . 0000000 < nl > - - - a / actor - server / src / linux / usr / share / actor / templates / activation - email - template . html < nl > + + + / dev / null < nl > @ @ - 1 , 261 + 0 , 0 @ @ < nl > - < ! DOCTYPE html PUBLIC " - / / W3C / / DTD XHTML 1 . 0 Strict / / EN " " http : / / www . w3 . org / TR / xhtml1 / DTD / xhtml1 - strict . dtd " > < nl > - < html xmlns = " http : / / www . w3 . org / 1999 / xhtml " > < nl > - < head > < nl > - < meta http - equiv = " Content - Type " content = " text / html ; charset = utf - 8 " / > < nl > - < meta name = " viewport " content = " width = device - width , initial - scale = 1 . 0 " / > < nl > - < title > [ Actor ] Notifications for May 13th , 2015 < / title > < nl > - < nl > - < style type = " text / css " > < nl > - / * Template styling * / < nl > - body { < nl > - font - family : " Helvetica Neue " , Helvetica , Arial , sans - serif ; < nl > - width : 100 % ; < nl > - max - width : 100 % ; < nl > - font - size : 17px ; < nl > - line - height : 24px ; < nl > - color : # 373737 ; < nl > - background : # F9F9F9 ; < nl > - } < nl > - table { < nl > - width : 100 % ; < nl > - margin : 0 auto ; < nl > - } < nl > - h1 , h2 , h3 , h4 { < nl > - color : # 2ab27b ; < nl > - margin - bottom : 12px ; < nl > - line - height : 26px ; < nl > - } < nl > - p , ul , ul li { < nl > - font - size : 17px ; < nl > - margin : 0 0 16px ; < nl > - line - height : 24px ; < nl > - } < nl > - ul { < nl > - margin - bottom : 24px ; < nl > - } < nl > - ul li { < nl > - margin - bottom : 8px ; < nl > - } < nl > - p . mini { < nl > - font - size : 12px ; < nl > - line - height : 18px ; < nl > - color : # ABAFB4 ; < nl > - } < nl > - p . message { < nl > - font - size : 16px ; < nl > - line - height : 20px ; < nl > - margin - bottom : 4px ; < nl > - } < nl > - hr { < nl > - margin : 2rem 0 ; < nl > - width : 100 % ; < nl > - border : none ; < nl > - border - bottom : 1px solid # ECECEC ; < nl > - } < nl > - a , a : link , a : visited , a : active , a : hover { < nl > - font - weight : bold ; < nl > - color : # 439fe0 ; < nl > - text - decoration : none ; < nl > - word - break : break - word ; < nl > - } < nl > - a : active , a : hover { < nl > - text - decoration : underline ; < nl > - } < nl > - . time { < nl > - font - size : 11px ; < nl > - color : # ABAFB4 ; < nl > - padding - right : 6px ; < nl > - } < nl > - . emoji { < nl > - vertical - align : bottom ; < nl > - } < nl > - . avatar { < nl > - border - radius : 2px ; < nl > - } < nl > - # footer p { < nl > - margin - top : 16px ; < nl > - font - size : 12px ; < nl > - } < nl > - < nl > - / * Client - specific Styles * / < nl > - # outlook a { padding : 0 ; } < nl > - body { width : 100 % ! important ; - webkit - text - size - adjust : 100 % ; - ms - text - size - adjust : 100 % ; margin : 0 auto ; padding : 0 ; } < nl > - . ExternalClass { width : 100 % ; } < nl > - . ExternalClass , . ExternalClass p , . ExternalClass span , . ExternalClass font , . ExternalClass td , . ExternalClass div { line - height : 100 % ; } < nl > - # backgroundTable { margin : 0 ; padding : 0 ; width : 100 % ; line - height : 100 % ! important ; } < nl > - < nl > - / * Some sensible defaults for images < nl > - Bring inline : Yes . * / < nl > - img { outline : none ; text - decoration : none ; - ms - interpolation - mode : bicubic ; } < nl > - a img { border : none ; } < nl > - . image _ fix { display : block ; } < nl > - < nl > - / * Outlook 07 , 10 Padding issue fix < nl > - Bring inline : No . * / < nl > - table td { border - collapse : collapse ; } < nl > - < nl > - / * Fix spacing around Outlook 07 , 10 tables < nl > - Bring inline : Yes * / < nl > - table { border - collapse : collapse ; mso - table - lspace : 0pt ; mso - table - rspace : 0pt ; } < nl > - < nl > - / * Mobile * / < nl > - @ media only screen and ( max - device - width : 480px ) { < nl > - / * Part one of controlling phone number linking for mobile . * / < nl > - a [ href ^ = " tel " ] , a [ href ^ = " sms " ] { < nl > - text - decoration : none ; < nl > - color : blue ; / * or whatever your want * / < nl > - pointer - events : none ; < nl > - cursor : default ; < nl > - } < nl > - < nl > - . mobile _ link a [ href ^ = " tel " ] , . mobile _ link a [ href ^ = " sms " ] { < nl > - text - decoration : default ; < nl > - color : orange ! important ; < nl > - pointer - events : auto ; < nl > - cursor : default ; < nl > - } < nl > - < nl > - } < nl > - < nl > - / * Not all email clients will obey these , but the important ones will * / < nl > - @ media only screen and ( max - width : 480px ) { < nl > - . card { < nl > - padding : 1rem 0 . 75rem ! important ; < nl > - } < nl > - . link _ option { < nl > - font - size : 14px ; < nl > - } < nl > - hr { < nl > - margin : 2rem - 0 . 75rem ! important ; < nl > - padding - right : 1 . 5rem ! important ; < nl > - } < nl > - } < nl > - < nl > - / * More Specific Targeting * / < nl > - @ media only screen and ( min - device - width : 768px ) and ( max - device - width : 1024px ) { < nl > - / * You guessed it , ipad ( tablets , smaller screens , etc ) * / < nl > - / * repeating for the ipad * / < nl > - a [ href ^ = " tel " ] , a [ href ^ = " sms " ] { < nl > - text - decoration : none ; < nl > - color : blue ; / * or whatever your want * / < nl > - pointer - events : none ; < nl > - cursor : default ; < nl > - } < nl > - < nl > - . mobile _ link a [ href ^ = " tel " ] , . mobile _ link a [ href ^ = " sms " ] { < nl > - text - decoration : default ; < nl > - color : orange ! important ; < nl > - pointer - events : auto ; < nl > - cursor : default ; < nl > - } < nl > - } < nl > - < nl > - / * iPhone Retina * / < nl > - @ media only screen and ( - webkit - min - device - pixel - ratio : 2 ) and ( max - device - width : 640px ) { < nl > - / * Must include ! important on each style to override inline styles * / < nl > - # footer p { < nl > - font - size : 9px ; < nl > - } < nl > - } < nl > - < nl > - / * Android targeting * / < nl > - @ media only screen and ( - webkit - device - pixel - ratio : . 75 ) { < nl > - / * Put CSS for low density ( ldpi ) Android layouts in here * / < nl > - img { < nl > - max - width : 100 % ; < nl > - height : auto ; < nl > - } < nl > - } < nl > - @ media only screen and ( - webkit - device - pixel - ratio : 1 ) { < nl > - / * Put CSS for medium density ( mdpi ) Android layouts in here * / < nl > - img { < nl > - max - width : 100 % ; < nl > - height : auto ; < nl > - } < nl > - } < nl > - @ media only screen and ( - webkit - device - pixel - ratio : 1 . 5 ) { < nl > - / * Put CSS for high density ( hdpi ) Android layouts in here * / < nl > - img { < nl > - max - width : 100 % ; < nl > - height : auto ; < nl > - } < nl > - } < nl > - / * Galaxy Nexus * / < nl > - @ media only screen and ( min - device - width : 720px ) and ( max - device - width : 1280px ) { < nl > - img { < nl > - max - width : 100 % ; < nl > - height : auto ; < nl > - } < nl > - body { < nl > - font - size : 16px ; < nl > - } < nl > - } < nl > - / * end Android targeting * / < nl > - < nl > - < nl > - < / style > < nl > - < nl > - < / head > < nl > - < body > < nl > - < table width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " id = " backgroundTable " style = " font - size : 17px ; line - height : 24px ; color : # 373737 ; background : # F9F9F9 ; " > < nl > - < tr > < nl > - < td valign = " top " > < nl > - < table id = " header " width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " > < nl > - < tr > < nl > - < td valign = " bottom " style = " padding : 20px 16px 20px ; " > < nl > - < div style = " max - width : 600px ; margin : 0 auto ; text - align : center ; " > < / div > < nl > - < / td > < nl > - < / tr > < nl > - < / table > < nl > - < / td > < nl > - < / tr > < nl > - < tr > < nl > - < td valign = " top " > < nl > - < table id = " body " width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " align = " center " > < nl > - < tr > < nl > - < td valign = " top " > < nl > - < div style = " max - width : 600px ; margin : 0 auto ; padding : 0 12px ; text - align : center ; " > < nl > - < div class = " card " style = " background : white ; border - radius : 0 . 5rem ; padding : 2rem ; margin - bottom : 1rem ; " > < nl > - < h2 style = " color : # 4b6e99 ; margin : 0 0 12px ; line - height : 30px ; " > You ' re almost done . < / h2 > < nl > - < nl > - < p style = " margin - bottom : 4rem ; " > < nl > - Enter this verification code to access Actor : < nl > - < / p > < nl > - < nl > - < ! - - < hr style = " margin : 1 . 5rem 0 ; width : 100 % ; border : none ; border - bottom : 1px solid # ECECEC ; " / > - - > < nl > - < nl > - < h1 style = " color : # 039769 ; margin : 0 0 12px ; line - height : 30px ; margin - bottom : 4rem ; " > $ $ CODE $ $ < / h1 > < nl > - < nl > - < ! - - < hr style = " margin : 1 . 5rem 0 ; width : 100 % ; border : none ; border - bottom : 1px solid # ECECEC ; " / > - - > < nl > - < p > Is this my password ? < / p > < nl > - < p style = " font - size : 0 . 9rem ; line - height : 20px ; color : # AAA ; text - align : center ; margin : 0 auto 1rem ; max - width : 320px ; word - break : break - word ; text - align : center ; max - width : 100 % ; margin - bottom : 0 ; " > < nl > - No . To keep you safe , Actor doesn ' t use passwords . You ' ll receive a new temporary code each time you sign in to Actor . < / p > < nl > - < nl > - < / div > < nl > - < / td > < nl > - < / tr > < nl > - < / table > < nl > - < / td > < nl > - < / tr > < nl > - < / td > < nl > - < / tr > < nl > - < tr > < nl > - < td > < nl > - < table id = " footer " width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " align = " center " style = " color : # 989EA6 ; " > < nl > - < tr > < nl > - < td valign = " top " align = " center " > < nl > - < div style = " max - width : 600px ; margin : 0 auto ; " > < nl > - < p class = " footer _ address " style = " margin - top : 16px ; font - size : 12px ; line - height : 20px ; " > < nl > - Made by < a href = " https : / / actor . im " style = " font - weight : bold ; color : # 439fe0 ; " > Actor LLC < / a > & nbsp ; & bull ; & nbsp ; < nl > - < a href = " https : / / twitter . com / actorapp " style = " font - weight : bold ; color : # 439fe0 ; " > Our Twitter < / a > < br / > < nl > - Rubinsheina 11A & nbsp ; & bull ; & nbsp ; Saint - Petersburg , Russia & nbsp ; & bull ; & nbsp ; 191002 < nl > - < / p > < nl > - < / div > < nl > - < / td > < nl > - < / tr > < nl > - < / table > < nl > - < / td > < nl > - < / tr > < nl > - < / table > < nl > - < / body > < nl > - < / html > < nl > \ No newline at end of file < nl > diff - - git a / actor - server / src / universal / conf / server . conf . example b / actor - server / src / universal / conf / server . conf . example < nl > index 296ed76 . . 89f82d4 100644 < nl > - - - a / actor - server / src / universal / conf / server . conf . example < nl > + + + b / actor - server / src / universal / conf / server . conf . example < nl > @ @ - 131 , 7 + 131 , 7 @ @ services { < nl > < nl > # Email template for email code activation < nl > # email { < nl > - # template : $ { actor . home } / templates / activation - email - template . html < nl > + # template : templates / activation - email - template . html < nl > # } < nl > # Setting for internal activation ( aka via actor bot ) < nl > # internal { < nl > diff - - git a / actor - server / templates / activation - email - template . html b / actor - server / templates / activation - email - template . html < nl > new file mode 100644 < nl > index 0000000 . . e34ddc6 < nl > - - - / dev / null < nl > + + + b / actor - server / templates / activation - email - template . html < nl > @ @ - 0 , 0 + 1 , 261 @ @ < nl > + < ! DOCTYPE html PUBLIC " - / / W3C / / DTD XHTML 1 . 0 Strict / / EN " " http : / / www . w3 . org / TR / xhtml1 / DTD / xhtml1 - strict . dtd " > < nl > + < html xmlns = " http : / / www . w3 . org / 1999 / xhtml " > < nl > + < head > < nl > + < meta http - equiv = " Content - Type " content = " text / html ; charset = utf - 8 " / > < nl > + < meta name = " viewport " content = " width = device - width , initial - scale = 1 . 0 " / > < nl > + < title > [ Actor ] Notifications for May 13th , 2015 < / title > < nl > + < nl > + < style type = " text / css " > < nl > + / * Template styling * / < nl > + body { < nl > + font - family : " Helvetica Neue " , Helvetica , Arial , sans - serif ; < nl > + width : 100 % ; < nl > + max - width : 100 % ; < nl > + font - size : 17px ; < nl > + line - height : 24px ; < nl > + color : # 373737 ; < nl > + background : # F9F9F9 ; < nl > + } < nl > + table { < nl > + width : 100 % ; < nl > + margin : 0 auto ; < nl > + } < nl > + h1 , h2 , h3 , h4 { < nl > + color : # 2ab27b ; < nl > + margin - bottom : 12px ; < nl > + line - height : 26px ; < nl > + } < nl > + p , ul , ul li { < nl > + font - size : 17px ; < nl > + margin : 0 0 16px ; < nl > + line - height : 24px ; < nl > + } < nl > + ul { < nl > + margin - bottom : 24px ; < nl > + } < nl > + ul li { < nl > + margin - bottom : 8px ; < nl > + } < nl > + p . mini { < nl > + font - size : 12px ; < nl > + line - height : 18px ; < nl > + color : # ABAFB4 ; < nl > + } < nl > + p . message { < nl > + font - size : 16px ; < nl > + line - height : 20px ; < nl > + margin - bottom : 4px ; < nl > + } < nl > + hr { < nl > + margin : 2rem 0 ; < nl > + width : 100 % ; < nl > + border : none ; < nl > + border - bottom : 1px solid # ECECEC ; < nl > + } < nl > + a , a : link , a : visited , a : active , a : hover { < nl > + font - weight : bold ; < nl > + color : # 439fe0 ; < nl > + text - decoration : none ; < nl > + word - break : break - word ; < nl > + } < nl > + a : active , a : hover { < nl > + text - decoration : underline ; < nl > + } < nl > + . time { < nl > + font - size : 11px ; < nl > + color : # ABAFB4 ; < nl > + padding - right : 6px ; < nl > + } < nl > + . emoji { < nl > + vertical - align : bottom ; < nl > + } < nl > + . avatar { < nl > + border - radius : 2px ; < nl > + } < nl > + # footer p { < nl > + margin - top : 16px ; < nl > + font - size : 12px ; < nl > + } < nl > + < nl > + / * Client - specific Styles * / < nl > + # outlook a { padding : 0 ; } < nl > + body { width : 100 % ! important ; - webkit - text - size - adjust : 100 % ; - ms - text - size - adjust : 100 % ; margin : 0 auto ; padding : 0 ; } < nl > + . ExternalClass { width : 100 % ; } < nl > + . ExternalClass , . ExternalClass p , . ExternalClass span , . ExternalClass font , . ExternalClass td , . ExternalClass div { line - height : 100 % ; } < nl > + # backgroundTable { margin : 0 ; padding : 0 ; width : 100 % ; line - height : 100 % ! important ; } < nl > + < nl > + / * Some sensible defaults for images < nl > + Bring inline : Yes . * / < nl > + img { outline : none ; text - decoration : none ; - ms - interpolation - mode : bicubic ; } < nl > + a img { border : none ; } < nl > + . image _ fix { display : block ; } < nl > + < nl > + / * Outlook 07 , 10 Padding issue fix < nl > + Bring inline : No . * / < nl > + table td { border - collapse : collapse ; } < nl > + < nl > + / * Fix spacing around Outlook 07 , 10 tables < nl > + Bring inline : Yes * / < nl > + table { border - collapse : collapse ; mso - table - lspace : 0pt ; mso - table - rspace : 0pt ; } < nl > + < nl > + / * Mobile * / < nl > + @ media only screen and ( max - device - width : 480px ) { < nl > + / * Part one of controlling phone number linking for mobile . * / < nl > + a [ href ^ = " tel " ] , a [ href ^ = " sms " ] { < nl > + text - decoration : none ; < nl > + color : blue ; / * or whatever your want * / < nl > + pointer - events : none ; < nl > + cursor : default ; < nl > + } < nl > + < nl > + . mobile _ link a [ href ^ = " tel " ] , . mobile _ link a [ href ^ = " sms " ] { < nl > + text - decoration : default ; < nl > + color : orange ! important ; < nl > + pointer - events : auto ; < nl > + cursor : default ; < nl > + } < nl > + < nl > + } < nl > + < nl > + / * Not all email clients will obey these , but the important ones will * / < nl > + @ media only screen and ( max - width : 480px ) { < nl > + . card { < nl > + padding : 1rem 0 . 75rem ! important ; < nl > + } < nl > + . link _ option { < nl > + font - size : 14px ; < nl > + } < nl > + hr { < nl > + margin : 2rem - 0 . 75rem ! important ; < nl > + padding - right : 1 . 5rem ! important ; < nl > + } < nl > + } < nl > + < nl > + / * More Specific Targeting * / < nl > + @ media only screen and ( min - device - width : 768px ) and ( max - device - width : 1024px ) { < nl > + / * You guessed it , ipad ( tablets , smaller screens , etc ) * / < nl > + / * repeating for the ipad * / < nl > + a [ href ^ = " tel " ] , a [ href ^ = " sms " ] { < nl > + text - decoration : none ; < nl > + color : blue ; / * or whatever your want * / < nl > + pointer - events : none ; < nl > + cursor : default ; < nl > + } < nl > + < nl > + . mobile _ link a [ href ^ = " tel " ] , . mobile _ link a [ href ^ = " sms " ] { < nl > + text - decoration : default ; < nl > + color : orange ! important ; < nl > + pointer - events : auto ; < nl > + cursor : default ; < nl > + } < nl > + } < nl > + < nl > + / * iPhone Retina * / < nl > + @ media only screen and ( - webkit - min - device - pixel - ratio : 2 ) and ( max - device - width : 640px ) { < nl > + / * Must include ! important on each style to override inline styles * / < nl > + # footer p { < nl > + font - size : 9px ; < nl > + } < nl > + } < nl > + < nl > + / * Android targeting * / < nl > + @ media only screen and ( - webkit - device - pixel - ratio : . 75 ) { < nl > + / * Put CSS for low density ( ldpi ) Android layouts in here * / < nl > + img { < nl > + max - width : 100 % ; < nl > + height : auto ; < nl > + } < nl > + } < nl > + @ media only screen and ( - webkit - device - pixel - ratio : 1 ) { < nl > + / * Put CSS for medium density ( mdpi ) Android layouts in here * / < nl > + img { < nl > + max - width : 100 % ; < nl > + height : auto ; < nl > + } < nl > + } < nl > + @ media only screen and ( - webkit - device - pixel - ratio : 1 . 5 ) { < nl > + / * Put CSS for high density ( hdpi ) Android layouts in here * / < nl > + img { < nl > + max - width : 100 % ; < nl > + height : auto ; < nl > + } < nl > + } < nl > + / * Galaxy Nexus * / < nl > + @ media only screen and ( min - device - width : 720px ) and ( max - device - width : 1280px ) { < nl > + img { < nl > + max - width : 100 % ; < nl > + height : auto ; < nl > + } < nl > + body { < nl > + font - size : 16px ; < nl > + } < nl > + } < nl > + / * end Android targeting * / < nl > + < nl > + < nl > + < / style > < nl > + < nl > + < / head > < nl > + < body > < nl > + < table width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " id = " backgroundTable " style = " font - size : 17px ; line - height : 24px ; color : # 373737 ; background : # F9F9F9 ; " > < nl > + < tr > < nl > + < td valign = " top " > < nl > + < table id = " header " width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " > < nl > + < tr > < nl > + < td valign = " bottom " style = " padding : 20px 16px 20px ; " > < nl > + < div style = " max - width : 600px ; margin : 0 auto ; text - align : center ; " > < / div > < nl > + < / td > < nl > + < / tr > < nl > + < / table > < nl > + < / td > < nl > + < / tr > < nl > + < tr > < nl > + < td valign = " top " > < nl > + < table id = " body " width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " align = " center " > < nl > + < tr > < nl > + < td valign = " top " > < nl > + < div style = " max - width : 600px ; margin : 0 auto ; padding : 0 12px ; text - align : center ; " > < nl > + < div class = " card " style = " background : white ; border - radius : 0 . 5rem ; padding : 2rem ; margin - bottom : 1rem ; " > < nl > + < h2 style = " color : # 4b6e99 ; margin : 0 0 12px ; line - height : 30px ; " > You ' re almost done . < / h2 > < nl > + < nl > + < p style = " margin - bottom : 4rem ; " > < nl > + Enter this verification code to access Actor : < nl > + < / p > < nl > + < nl > + < ! - - < hr style = " margin : 1 . 5rem 0 ; width : 100 % ; border : none ; border - bottom : 1px solid # ECECEC ; " / > - - > < nl > + < nl > + < h1 style = " color : # 039769 ; margin : 0 0 12px ; line - height : 30px ; margin - bottom : 4rem ; " > $ $ CODE $ $ < / h1 > < nl > + < nl > + < ! - - < hr style = " margin : 1 . 5rem 0 ; width : 100 % ; border : none ; border - bottom : 1px solid # ECECEC ; " / > - - > < nl > + < p > Is this my password ? < / p > < nl > + < p style = " font - size : 0 . 9rem ; line - height : 20px ; color : # AAA ; text - align : center ; margin : 0 auto 1rem ; max - width : 320px ; word - break : break - word ; text - align : center ; max - width : 100 % ; margin - bottom : 0 ; " > < nl > + No . To keep you safe , Actor doesn ' t use passwords . You ' ll receive a new temporary code each time you sign in to Actor . < / p > < nl > + < nl > + < / div > < nl > + < / td > < nl > + < / tr > < nl > + < / table > < nl > + < / td > < nl > + < / tr > < nl > + < / td > < nl > + < / tr > < nl > + < tr > < nl > + < td > < nl > + < table id = " footer " width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " align = " center " style = " color : # 989EA6 ; " > < nl > + < tr > < nl > + < td valign = " top " align = " center " > < nl > + < div style = " max - width : 600px ; margin : 0 auto ; " > < nl > + < p class = " footer _ address " style = " margin - top : 16px ; font - size : 12px ; line - height : 20px ; " > < nl > + Made by < a href = " https : / / actor . im " style = " font - weight : bold ; color : # 439fe0 ; " > Actor LLC < / a > & nbsp ; & bull ; & nbsp ; < nl > + < a href = " https : / / twitter . com / actorapp " style = " font - weight : bold ; color : # 439fe0 ; " > Our Twitter < / a > < br / > < nl > + Rubinsheina 11A & nbsp ; & bull ; & nbsp ; Saint - Petersburg , Russia & nbsp ; & bull ; & nbsp ; 191002 < nl > + < / p > < nl > + < / div > < nl > + < / td > < nl > + < / tr > < nl > + < / table > < nl > + < / td > < nl > + < / tr > < nl > + < / table > < nl > + < / body > < nl > + < / html > < nl > \ No newline at end of file
NEAREST DIFF (one line): diff - - git a / actor - server / actor - activation / src / main / resources / mail - template . html b / actor - server / actor - activation / src / main / resources / mail - template . html < nl > deleted file mode 100644 < nl > index 25d7297 . . 0000000 < nl > - - - a / actor - server / actor - activation / src / main / resources / mail - template . html < nl > + + + / dev / null < nl > @ @ - 1 , 261 + 0 , 0 @ @ < nl > - < ! DOCTYPE html PUBLIC " - / / W3C / / DTD XHTML 1 . 0 Strict / / EN " " http : / / www . w3 . org / TR / xhtml1 / DTD / xhtml1 - strict . dtd " > < nl > - < html xmlns = " http : / / www . w3 . org / 1999 / xhtml " > < nl > - < head > < nl > - < meta http - equiv = " Content - Type " content = " text / html ; charset = utf - 8 " / > < nl > - < meta name = " viewport " content = " width = device - width , initial - scale = 1 . 0 " / > < nl > - < title > [ Actor ] Notifications for May 13th , 2015 < / title > < nl > - < nl > - < style type = " text / css " > < nl > - / * Template styling * / < nl > - body { < nl > - font - family : " Helvetica Neue " , Helvetica , Arial , sans - serif ; < nl > - width : 100 % ; < nl > - max - width : 100 % ; < nl > - font - size : 17px ; < nl > - line - height : 24px ; < nl > - color : # 373737 ; < nl > - background : # F9F9F9 ; < nl > - } < nl > - table { < nl > - width : 100 % ; < nl > - margin : 0 auto ; < nl > - } < nl > - h1 , h2 , h3 , h4 { < nl > - color : # 2ab27b ; < nl > - margin - bottom : 12px ; < nl > - line - height : 26px ; < nl > - } < nl > - p , ul , ul li { < nl > - font - size : 17px ; < nl > - margin : 0 0 16px ; < nl > - line - height : 24px ; < nl > - } < nl > - ul { < nl > - margin - bottom : 24px ; < nl > - } < nl > - ul li { < nl > - margin - bottom : 8px ; < nl > - } < nl > - p . mini { < nl > - font - size : 12px ; < nl > - line - height : 18px ; < nl > - color : # ABAFB4 ; < nl > - } < nl > - p . message { < nl > - font - size : 16px ; < nl > - line - height : 20px ; < nl > - margin - bottom : 4px ; < nl > - } < nl > - hr { < nl > - margin : 2rem 0 ; < nl > - width : 100 % ; < nl > - border : none ; < nl > - border - bottom : 1px solid # ECECEC ; < nl > - } < nl > - a , a : link , a : visited , a : active , a : hover { < nl > - font - weight : bold ; < nl > - color : # 439fe0 ; < nl > - text - decoration : none ; < nl > - word - break : break - word ; < nl > - } < nl > - a : active , a : hover { < nl > - text - decoration : underline ; < nl > - } < nl > - . time { < nl > - font - size : 11px ; < nl > - color : # ABAFB4 ; < nl > - padding - right : 6px ; < nl > - } < nl > - . emoji { < nl > - vertical - align : bottom ; < nl > - } < nl > - . avatar { < nl > - border - radius : 2px ; < nl > - } < nl > - # footer p { < nl > - margin - top : 16px ; < nl > - font - size : 12px ; < nl > - } < nl > - < nl > - / * Client - specific Styles * / < nl > - # outlook a { padding : 0 ; } < nl > - body { width : 100 % ! important ; - webkit - text - size - adjust : 100 % ; - ms - text - size - adjust : 100 % ; margin : 0 auto ; padding : 0 ; } < nl > - . ExternalClass { width : 100 % ; } < nl > - . ExternalClass , . ExternalClass p , . ExternalClass span , . ExternalClass font , . ExternalClass td , . ExternalClass div { line - height : 100 % ; } < nl > - # backgroundTable { margin : 0 ; padding : 0 ; width : 100 % ; line - height : 100 % ! important ; } < nl > - < nl > - / * Some sensible defaults for images < nl > - Bring inline : Yes . * / < nl > - img { outline : none ; text - decoration : none ; - ms - interpolation - mode : bicubic ; } < nl > - a img { border : none ; } < nl > - . image _ fix { display : block ; } < nl > - < nl > - / * Outlook 07 , 10 Padding issue fix < nl > - Bring inline : No . * / < nl > - table td { border - collapse : collapse ; } < nl > - < nl > - / * Fix spacing around Outlook 07 , 10 tables < nl > - Bring inline : Yes * / < nl > - table { border - collapse : collapse ; mso - table - lspace : 0pt ; mso - table - rspace : 0pt ; } < nl > - < nl > - / * Mobile * / < nl > - @ media only screen and ( max - device - width : 480px ) { < nl > - / * Part one of controlling phone number linking for mobile . * / < nl > - a [ href ^ = " tel " ] , a [ href ^ = " sms " ] { < nl > - text - decoration : none ; < nl > - color : blue ; / * or whatever your want * / < nl > - pointer - events : none ; < nl > - cursor : default ; < nl > - } < nl > - < nl > - . mobile _ link a [ href ^ = " tel " ] , . mobile _ link a [ href ^ = " sms " ] { < nl > - text - decoration : default ; < nl > - color : orange ! important ; < nl > - pointer - events : auto ; < nl > - cursor : default ; < nl > - } < nl > - < nl > - } < nl > - < nl > - / * Not all email clients will obey these , but the important ones will * / < nl > - @ media only screen and ( max - width : 480px ) { < nl > - . card { < nl > - padding : 1rem 0 . 75rem ! important ; < nl > - } < nl > - . link _ option { < nl > - font - size : 14px ; < nl > - } < nl > - hr { < nl > - margin : 2rem - 0 . 75rem ! important ; < nl > - padding - right : 1 . 5rem ! important ; < nl > - } < nl > - } < nl > - < nl > - / * More Specific Targeting * / < nl > - @ media only screen and ( min - device - width : 768px ) and ( max - device - width : 1024px ) { < nl > - / * You guessed it , ipad ( tablets , smaller screens , etc ) * / < nl > - / * repeating for the ipad * / < nl > - a [ href ^ = " tel " ] , a [ href ^ = " sms " ] { < nl > - text - decoration : none ; < nl > - color : blue ; / * or whatever your want * / < nl > - pointer - events : none ; < nl > - cursor : default ; < nl > - } < nl > - < nl > - . mobile _ link a [ href ^ = " tel " ] , . mobile _ link a [ href ^ = " sms " ] { < nl > - text - decoration : default ; < nl > - color : orange ! important ; < nl > - pointer - events : auto ; < nl > - cursor : default ; < nl > - } < nl > - } < nl > - < nl > - / * iPhone Retina * / < nl > - @ media only screen and ( - webkit - min - device - pixel - ratio : 2 ) and ( max - device - width : 640px ) { < nl > - / * Must include ! important on each style to override inline styles * / < nl > - # footer p { < nl > - font - size : 9px ; < nl > - } < nl > - } < nl > - < nl > - / * Android targeting * / < nl > - @ media only screen and ( - webkit - device - pixel - ratio : . 75 ) { < nl > - / * Put CSS for low density ( ldpi ) Android layouts in here * / < nl > - img { < nl > - max - width : 100 % ; < nl > - height : auto ; < nl > - } < nl > - } < nl > - @ media only screen and ( - webkit - device - pixel - ratio : 1 ) { < nl > - / * Put CSS for medium density ( mdpi ) Android layouts in here * / < nl > - img { < nl > - max - width : 100 % ; < nl > - height : auto ; < nl > - } < nl > - } < nl > - @ media only screen and ( - webkit - device - pixel - ratio : 1 . 5 ) { < nl > - / * Put CSS for high density ( hdpi ) Android layouts in here * / < nl > - img { < nl > - max - width : 100 % ; < nl > - height : auto ; < nl > - } < nl > - } < nl > - / * Galaxy Nexus * / < nl > - @ media only screen and ( min - device - width : 720px ) and ( max - device - width : 1280px ) { < nl > - img { < nl > - max - width : 100 % ; < nl > - height : auto ; < nl > - } < nl > - body { < nl > - font - size : 16px ; < nl > - } < nl > - } < nl > - / * end Android targeting * / < nl > - < nl > - < nl > - < / style > < nl > - < nl > - < / head > < nl > - < body > < nl > - < table width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " id = " backgroundTable " style = " font - size : 17px ; line - height : 24px ; color : # 373737 ; background : # F9F9F9 ; " > < nl > - < tr > < nl > - < td valign = " top " > < nl > - < table id = " header " width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " > < nl > - < tr > < nl > - < td valign = " bottom " style = " padding : 20px 16px 20px ; " > < nl > - < div style = " max - width : 600px ; margin : 0 auto ; text - align : center ; " > < / div > < nl > - < / td > < nl > - < / tr > < nl > - < / table > < nl > - < / td > < nl > - < / tr > < nl > - < tr > < nl > - < td valign = " top " > < nl > - < table id = " body " width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " align = " center " > < nl > - < tr > < nl > - < td valign = " top " > < nl > - < div style = " max - width : 600px ; margin : 0 auto ; padding : 0 12px ; text - align : center ; " > < nl > - < div class = " card " style = " background : white ; border - radius : 0 . 5rem ; padding : 2rem ; margin - bottom : 1rem ; " > < nl > - < h2 style = " color : # 4b6e99 ; margin : 0 0 12px ; line - height : 30px ; " > You ' re almost done . < / h2 > < nl > - < nl > - < p style = " margin - bottom : 4rem ; " > < nl > - Enter this verification code to access Actor : < nl > - < / p > < nl > - < nl > - < ! - - < hr style = " margin : 1 . 5rem 0 ; width : 100 % ; border : none ; border - bottom : 1px solid # ECECEC ; " / > - - > < nl > - < nl > - < h1 style = " color : # 039769 ; margin : 0 0 12px ; line - height : 30px ; margin - bottom : 4rem ; " > $ $ CODE $ $ < / h1 > < nl > - < nl > - < ! - - < hr style = " margin : 1 . 5rem 0 ; width : 100 % ; border : none ; border - bottom : 1px solid # ECECEC ; " / > - - > < nl > - < p > Is this my password ? < / p > < nl > - < p style = " font - size : 0 . 9rem ; line - height : 20px ; color : # AAA ; text - align : center ; margin : 0 auto 1rem ; max - width : 320px ; word - break : break - word ; text - align : center ; max - width : 100 % ; margin - bottom : 0 ; " > < nl > - No . To keep you safe , Actor doesn ' t use passwords . You ' ll receive a new temporary code each time you sign in to Actor . < / p > < nl > - < nl > - < / div > < nl > - < / td > < nl > - < / tr > < nl > - < / table > < nl > - < / td > < nl > - < / tr > < nl > - < / td > < nl > - < / tr > < nl > - < tr > < nl > - < td > < nl > - < table id = " footer " width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " align = " center " style = " color : # 989EA6 ; " > < nl > - < tr > < nl > - < td valign = " top " align = " center " > < nl > - < div style = " max - width : 600px ; margin : 0 auto ; " > < nl > - < p class = " footer _ address " style = " margin - top : 16px ; font - size : 12px ; line - height : 20px ; " > < nl > - Made by < a href = " https : / / actor . im " style = " font - weight : bold ; color : # 439fe0 ; " > Actor LLC < / a > & nbsp ; & bull ; & nbsp ; < nl > - < a href = " https : / / twitter . com / actorapp " style = " font - weight : bold ; color : # 439fe0 ; " > Our Twitter < / a > < br / > < nl > - Rubinsheina 11A & nbsp ; & bull ; & nbsp ; Saint - Petersburg , Russia & nbsp ; & bull ; & nbsp ; 191002 < nl > - < / p > < nl > - < / div > < nl > - < / td > < nl > - < / tr > < nl > - < / table > < nl > - < / td > < nl > - < / tr > < nl > - < / table > < nl > - / < body > < nl > - < / html > < nl > \ No newline at end of file < nl > diff - - git a / actor - server / actor - activation / src / main / scala / im / actor / server / activation / internal / EmailTemplate . scala b / actor - server / actor - activation / src / main / scala / im / actor / server / activation / internal / EmailTemplate . scala < nl > new file mode 100644 < nl > index 0000000 . . 981021a < nl > - - - / dev / null < nl > + + + b / actor - server / actor - activation / src / main / scala / im / actor / server / activation / internal / EmailTemplate . scala < nl > @ @ - 0 , 0 + 1 , 271 @ @ < nl > + package im . actor . server . activation . internal < nl > + < nl > + object EmailTemplate { < nl > + < nl > + / / fixme : load from resources < nl > + val template : String = < nl > + " " " < nl > + | < ! DOCTYPE html PUBLIC " - / / W3C / / DTD XHTML 1 . 0 Strict / / EN " " http : / / www . w3 . org / TR / xhtml1 / DTD / xhtml1 - strict . dtd " > < nl > + | < html xmlns = " http : / / www . w3 . org / 1999 / xhtml " > < nl > + | < head > < nl > + | < meta http - equiv = " Content - Type " content = " text / html ; charset = utf - 8 " / > < nl > + | < meta name = " viewport " content = " width = device - width , initial - scale = 1 . 0 " / > < nl > + | < title > [ Actor ] Notifications for May 13th , 2015 < / title > < nl > + | < nl > + | < style type = " text / css " > < nl > + | / * Template styling * / < nl > + | body { < nl > + | font - family : " Helvetica Neue " , Helvetica , Arial , sans - serif ; < nl > + | width : 100 % ; < nl > + | max - width : 100 % ; < nl > + | font - size : 17px ; < nl > + | line - height : 24px ; < nl > + | color : # 373737 ; < nl > + | background : # F9F9F9 ; < nl > + | } < nl > + | table { < nl > + | width : 100 % ; < nl > + | margin : 0 auto ; < nl > + | } < nl > + | h1 , h2 , h3 , h4 { < nl > + | color : # 2ab27b ; < nl > + | margin - bottom : 12px ; < nl > + | line - height : 26px ; < nl > + | } < nl > + | p , ul , ul li { < nl > + | font - size : 17px ; < nl > + | margin : 0 0 16px ; < nl > + | line - height : 24px ; < nl > + | } < nl > + | ul { < nl > + | margin - bottom : 24px ; < nl > + | } < nl > + | ul li { < nl > + | margin - bottom : 8px ; < nl > + | } < nl > + | p . mini { < nl > + | font - size : 12px ; < nl > + | line - height : 18px ; < nl > + | color : # ABAFB4 ; < nl > + | } < nl > + | p . message { < nl > + | font - size : 16px ; < nl > + | line - height : 20px ; < nl > + | margin - bottom : 4px ; < nl > + | } < nl > + | hr { < nl > + | margin : 2rem 0 ; < nl > + | width : 100 % ; < nl > + | border : none ; < nl > + | border - bottom : 1px solid # ECECEC ; < nl > + | } < nl > + | a , a : link , a : visited , a : active , a : hover { < nl > + | font - weight : bold ; < nl > + | color : # 439fe0 ; < nl > + | text - decoration : none ; < nl > + | word - break : break - word ; < nl > + | } < nl > + | a : active , a : hover { < nl > + | text - decoration : underline ; < nl > + | } < nl > + | . time { < nl > + | font - size : 11px ; < nl > + | color : # ABAFB4 ; < nl > + | padding - right : 6px ; < nl > + | } < nl > + | . emoji { < nl > + | vertical - align : bottom ; < nl > + | } < nl > + | . avatar { < nl > + | border - radius : 2px ; < nl > + | } < nl > + | # footer p { < nl > + | margin - top : 16px ; < nl > + | font - size : 12px ; < nl > + | } < nl > + | < nl > + | / * Client - specific Styles * / < nl > + | # outlook a { padding : 0 ; } < nl > + | body { width : 100 % ! important ; - webkit - text - size - adjust : 100 % ; - ms - text - size - adjust : 100 % ; margin : 0 auto ; padding : 0 ; } < nl > + | . ExternalClass { width : 100 % ; } < nl > + | . ExternalClass , . ExternalClass p , . ExternalClass span , . ExternalClass font , . ExternalClass td , . ExternalClass div { line - height : 100 % ; } < nl > + | # backgroundTable { margin : 0 ; padding : 0 ; width : 100 % ; line - height : 100 % ! important ; } < nl > + | < nl > + | / * Some sensible defaults for images < nl > + | Bring inline : Yes . * / < nl > + | img { outline : none ; text - decoration : none ; - ms - interpolation - mode : bicubic ; } < nl > + | a img { border : none ; } < nl > + | . image _ fix { display : block ; } < nl > + | < nl > + | / * Outlook 07 , 10 Padding issue fix < nl > + | Bring inline : No . * / < nl > + | table td { border - collapse : collapse ; } < nl > + | < nl > + | / * Fix spacing around Outlook 07 , 10 tables < nl > + | Bring inline : Yes * / < nl > + | table { border - collapse : collapse ; mso - table - lspace : 0pt ; mso - table - rspace : 0pt ; } < nl > + | < nl > + | / * Mobile * / < nl > + | @ media only screen and ( max - device - width : 480px ) { < nl > + | / * Part one of controlling phone number linking for mobile . * / < nl > + | a [ href ^ = " tel " ] , a [ href ^ = " sms " ] { < nl > + | text - decoration : none ; < nl > + | color : blue ; / * or whatever your want * / < nl > + | pointer - events : none ; < nl > + | cursor : default ; < nl > + | } < nl > + | < nl > + | . mobile _ link a [ href ^ = " tel " ] , . mobile _ link a [ href ^ = " sms " ] { < nl > + | text - decoration : default ; < nl > + | color : orange ! important ; < nl > + | pointer - events : auto ; < nl > + | cursor : default ; < nl > + | } < nl > + | < nl > + | } < nl > + | < nl > + | / * Not all email clients will obey these , but the important ones will * / < nl > + | @ media only screen and ( max - width : 480px ) { < nl > + | . card { < nl > + | padding : 1rem 0 . 75rem ! important ; < nl > + | } < nl > + | . link _ option { < nl > + | font - size : 14px ; < nl > + | } < nl > + | hr { < nl > + | margin : 2rem - 0 . 75rem ! important ; < nl > + | padding - right : 1 . 5rem ! important ; < nl > + | } < nl > + | } < nl > + | < nl > + | / * More Specific Targeting * / < nl > + | @ media only screen and ( min - device - width : 768px ) and ( max - device - width : 1024px ) { < nl > + | / * You guessed it , ipad ( tablets , smaller screens , etc ) * / < nl > + | / * repeating for the ipad * / < nl > + | a [ href ^ = " tel " ] , a [ href ^ = " sms " ] { < nl > + | text - decoration : none ; < nl > + | color : blue ; / * or whatever your want * / < nl > + | pointer - events : none ; < nl > + | cursor : default ; < nl > + | } < nl > + | < nl > + | . mobile _ link a [ href ^ = " tel " ] , . mobile _ link a [ href ^ = " sms " ] { < nl > + | text - decoration : default ; < nl > + | color : orange ! important ; < nl > + | pointer - events : auto ; < nl > + | cursor : default ; < nl > + | } < nl > + | } < nl > + | < nl > + | / * iPhone Retina * / < nl > + | @ media only screen and ( - webkit - min - device - pixel - ratio : 2 ) and ( max - device - width : 640px ) { < nl > + | / * Must include ! important on each style to override inline styles * / < nl > + | # footer p { < nl > + | font - size : 9px ; < nl > + | } < nl > + | } < nl > + | < nl > + | / * Android targeting * / < nl > + | @ media only screen and ( - webkit - device - pixel - ratio : . 75 ) { < nl > + | / * Put CSS for low density ( ldpi ) Android layouts in here * / < nl > + | img { < nl > + | max - width : 100 % ; < nl > + | height : auto ; < nl > + | } < nl > + | } < nl > + | @ media only screen and ( - webkit - device - pixel - ratio : 1 ) { < nl > + | / * Put CSS for medium density ( mdpi ) Android layouts in here * / < nl > + | img { < nl > + | max - width : 100 % ; < nl > + | height : auto ; < nl > + | } < nl > + | } < nl > + | @ media only screen and ( - webkit - device - pixel - ratio : 1 . 5 ) { < nl > + | / * Put CSS for high density ( hdpi ) Android layouts in here * / < nl > + | img { < nl > + | max - width : 100 % ; < nl > + | height : auto ; < nl > + | } < nl > + | } < nl > + | / * Galaxy Nexus * / < nl > + | @ media only screen and ( min - device - width : 720px ) and ( max - device - width : 1280px ) { < nl > + | img { < nl > + | max - width : 100 % ; < nl > + | height : auto ; < nl > + | } < nl > + | body { < nl > + | font - size : 16px ; < nl > + | } < nl > + | } < nl > + | / * end Android targeting * / < nl > + | < nl > + | < nl > + | < / style > < nl > + | < nl > + | < / head > < nl > + | < body > < nl > + | < table width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " id = " backgroundTable " style = " font - size : 17px ; line - height : 24px ; color : # 373737 ; background : # F9F9F9 ; " > < nl > + | < tr > < nl > + | < td valign = " top " > < nl > + | < table id = " header " width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " > < nl > + | < tr > < nl > + | < td valign = " bottom " style = " padding : 20px 16px 20px ; " > < nl > + | < div style = " max - width : 600px ; margin : 0 auto ; text - align : center ; " > < / div > < nl > + | < / td > < nl > + | < / tr > < nl > + | < / table > < nl > + | < / td > < nl > + | < / tr > < nl > + | < tr > < nl > + | < td valign = " top " > < nl > + | < table id = " body " width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " align = " center " > < nl > + | < tr > < nl > + | < td valign = " top " > < nl > + | < div style = " max - width : 600px ; margin : 0 auto ; padding : 0 12px ; text - align : center ; " > < nl > + | < div class = " card " style = " background : white ; border - radius : 0 . 5rem ; padding : 2rem ; margin - bottom : 1rem ; " > < nl > + | < h2 style = " color : # 4b6e99 ; margin : 0 0 12px ; line - height : 30px ; " > You ' re almost done . < / h2 > < nl > + | < nl > + | < p style = " margin - bottom : 4rem ; " > < nl > + | Enter this verification code to access Actor : < nl > + | < / p > < nl > + | < nl > + | < ! - - < hr style = " margin : 1 . 5rem 0 ; width : 100 % ; border : none ; border - bottom : 1px solid # ECECEC ; " / > - - > < nl > + | < nl > + | < h1 style = " color : # 039769 ; margin : 0 0 12px ; line - height : 30px ; margin - bottom : 4rem ; " > $ $ CODE $ $ < / h1 > < nl > + | < nl > + | < ! - - < hr style = " margin : 1 . 5rem 0 ; width : 100 % ; border : none ; border - bottom : 1px solid # ECECEC ; " / > - - > < nl > + | < p > Is this my password ? < / p > < nl > + | < p style = " font - size : 0 . 9rem ; line - height : 20px ; color : # AAA ; text - align : center ; margin : 0 auto 1rem ; max - width : 320px ; word - break : break - word ; text - align : center ; max - width : 100 % ; margin - bottom : 0 ; " > < nl > + | No . To keep you safe , Actor doesn ' t use passwords . You ' ll receive a new temporary code each time you sign in to Actor . < / p > < nl > + | < nl > + | < / div > < nl > + | < / td > < nl > + | < / tr > < nl > + | < / table > < nl > + | < / td > < nl > + | < / tr > < nl > + | < / td > < nl > + | < / tr > < nl > + | < tr > < nl > + | < td > < nl > + | < table id = " footer " width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " align = " center " style = " color : # 989EA6 ; " > < nl > + | < tr > < nl > + | < td valign = " top " align = " center " > < nl > + | < div style = " max - width : 600px ; margin : 0 auto ; " > < nl > + | < p class = " footer _ address " style = " margin - top : 16px ; font - size : 12px ; line - height : 20px ; " > < nl > + | Made by < a href = " https : / / actor . im " style = " font - weight : bold ; color : # 439fe0 ; " > Actor LLC < / a > & nbsp ; & bull ; & nbsp ; < nl > + | < a href = " https : / / twitter . com / actorapp " style = " font - weight : bold ; color : # 439fe0 ; " > Our Twitter < / a > < br / > < nl > + | Rubinsheina 11A & nbsp ; & bull ; & nbsp ; Saint - Petersburg , Russia & nbsp ; & bull ; & nbsp ; 191002 < nl > + | < / p > < nl > + | < / div > < nl > + | < / td > < nl > + | < / tr > < nl > + | < / table > < nl > + | < / td > < nl > + | < / tr > < nl > + | < / table > < nl > + | / < body > < nl > + | < / html > < nl > + " " " . stripMargin < nl > + < nl > + } < nl > diff - - git a / actor - server / actor - activation / src / main / scala / im / actor / server / activation / internal / InternalCodeActivation . scala b / actor - server / actor - activation / src / main / scala / im / actor / server / activation / internal / InternalCodeActivation . scala < nl > index e454bad . . 7d92507 100644 < nl > - - - a / actor - server / actor - activation / src / main / scala / im / actor / server / activation / internal / InternalCodeActivation . scala < nl > + + + b / actor - server / actor - activation / src / main / scala / im / actor / server / activation / internal / InternalCodeActivation . scala < nl > @ @ - 1 , 6 + 1 , 5 @ @ < nl > package im . actor . server . activation . internal < nl > < nl > - import java . nio . file . { Paths , Files } < nl > import java . time . temporal . ChronoUnit . _ < nl > import java . time . { LocalDateTime , ZoneOffset } < nl > < nl > @ @ - 95 , 7 + 94 , 7 @ @ class Activation ( repeatLimit : Duration , smsEngine : AuthSmsEngine , callEngine : Au < nl > < nl > private val sentCodes = new scala . collection . mutable . HashSet [ Code ] ( ) < nl > < nl > - private val emailTemplate = new String ( Files . readAllBytes ( Paths . get ( " / mail - template . html " ) ) ) < nl > + private val emailTemplate = EmailTemplate . template < nl > < nl > def codeWasNotSent ( code : Code ) = ! sentCodes . contains ( code )

TEST DIFF:
diff - - git a / actor - server / actor - activation / src / main / resources / reference . conf b / actor - server / actor - activation / src / main / resources / reference . conf 
 index a9d2b52 . . bba3b7a 100644 
 - - - a / actor - server / actor - activation / src / main / resources / reference . conf 
 + + + b / actor - server / actor - activation / src / main / resources / reference . conf 
 @ @ - 8 , 7 + 8 , 7 @ @ services { 
 code - attempts : 3 
 
 email { 
 - template : $ { actor . home } / templates / activation - email - template . html 
 + template : templates / activation - email - template . html 
 } 
 internal { 
 sender - user - id : 10 
 diff - - git a / actor - server / actor - activation / src / main / scala / im / actor / server / activation / smtp / SMTPProvider . scala b / actor - server / actor - activation / src / main / scala / im / actor / server / activation / smtp / SMTPProvider . scala 
 index 87890c2 . . 5c8ebb8 100644 
 - - - a / actor - server / actor - activation / src / main / scala / im / actor / server / activation / smtp / SMTPProvider . scala 
 + + + b / actor - server / actor - activation / src / main / scala / im / actor / server / activation / smtp / SMTPProvider . scala 
 @ @ - 7 , 13 + 7 , 14 @ @ import akka . pattern . ask 
 import akka . util . Timeout 
 import cats . data . Xor 
 import im . actor . config . ActorConfig 
 + import im . actor . env . ActorEnv 
 import im . actor . server . activation . common . ActivationStateActor . { Send , SendAck } 
 import im . actor . server . activation . common . _ 
 import im . actor . server . db . DbExtension 
 import im . actor . server . email . { Content , EmailConfig , Message , SmtpEmailSender } 
 import im . actor . util . misc . EmailUtils . isTestEmail 
 
 - import scala . concurrent . { Future } 
 + import scala . concurrent . Future 
 import scala . concurrent . duration . _ 
 
 private [ activation ] final class SMTPProvider ( system : ActorSystem ) extends ActivationProvider with CommonAuthCodes { 
 @ @ - 26 , 9 + 27 , 10 @ @ private [ activation ] final class SMTPProvider ( system : ActorSystem ) extends Activa 
 
 private val emailConfig = EmailConfig . load . getOrElse ( throw new RuntimeException ( " Failed to load email config " ) ) 
 private val emailSender = new SmtpEmailSender ( emailConfig ) 
 - private val emailTemplateLocation = ActorConfig . load ( ) . getString ( " services . activation . email . template " ) 
 + private val emailTemplateLocation = 
 + ActorEnv . getAbsolutePath ( Paths . get ( ActorConfig . load ( ) . getString ( " services . activation . email . template " ) ) ) 
 
 - private val emailTemplate = new String ( Files . readAllBytes ( Paths . get ( emailTemplateLocation ) ) ) 
 + private val emailTemplate = new String ( Files . readAllBytes ( emailTemplateLocation ) ) 
 
 private val smtpStateActor = system . actorOf ( ActivationStateActor . props [ String , EmailCode ] ( 
 repeatLimit = activationConfig . repeatLimit , 
 diff - - git a / actor - server / actor - runtime / src / main / scala / im / actor / config / ActorConfig . scala b / actor - server / actor - runtime / src / main / scala / im / actor / config / ActorConfig . scala 
 index 5a5ec0c . . b6ba51e 100644 
 - - - a / actor - server / actor - runtime / src / main / scala / im / actor / config / ActorConfig . scala 
 + + + b / actor - server / actor - runtime / src / main / scala / im / actor / config / ActorConfig . scala 
 @ @ - 1 , 15 + 1 , 17 @ @ 
 package im . actor . config 
 
 + import java . nio . file . { Path , Paths } 
 import java . util . concurrent . TimeUnit 
 
 import akka . actor . ActorSystem 
 - import com . typesafe . config . { ConfigException , Config , ConfigFactory } 
 + import com . typesafe . config . { Config , ConfigException , ConfigFactory } 
 + 
 import scala . collection . JavaConversions . _ 
 import scala . concurrent . duration . _ 
 - 
 import scala . util . { Failure , Success , Try } 
 
 object ActorConfig { 
 + 
 def load ( defaults : Config = ConfigFactory . empty ( ) ) : Config = { 
 val mainConfig = ConfigFactory . load ( ) 
 
 diff - - git a / actor - server / actor - runtime / src / main / scala / im / actor / env / ActorEnv . scala b / actor - server / actor - runtime / src / main / scala / im / actor / env / ActorEnv . scala 
 new file mode 100644 
 index 0000000 . . fd43c0c 
 - - - / dev / null 
 + + + b / actor - server / actor - runtime / src / main / scala / im / actor / env / ActorEnv . scala 
 @ @ - 0 , 0 + 1 , 14 @ @ 
 + package im . actor . env 
 + 
 + import java . nio . file . { Path , Paths } 
 + 
 + object ActorEnv { 
 + 
 + def getAbsolutePath ( path : Path ) : Path = 
 + if ( path . isAbsolute ) path else home . resolve ( path ) . toAbsolutePath . normalize 
 + 
 + def getAbsolutePath ( pathString : String ) : Path = getAbsolutePath ( Paths . get ( pathString ) ) 
 + 
 + val home : Path = Paths . get ( " . " ) . toAbsolutePath . normalize ( ) 
 + 
 + } 
 diff - - git a / actor - server / actor - server - sdk / src / main / scala / im / actor / server / ActorServer . scala b / actor - server / actor - server - sdk / src / main / scala / im / actor / server / ActorServer . scala 
 index ea3c553 . . 262c6e8 100644 
 - - - a / actor - server / actor - server - sdk / src / main / scala / im / actor / server / ActorServer . scala 
 + + + b / actor - server / actor - server - sdk / src / main / scala / im / actor / server / ActorServer . scala 
 @ @ - 1 , 11 + 1 , 13 @ @ 
 package im . actor . server 
 
 + import java . nio . file . { Files , Paths } 
 + 
 import akka . actor . _ 
 import akka . cluster . Cluster 
 import akka . stream . ActorMaterializer 
 import com . typesafe . config . { Config , ConfigException , ConfigFactory } 
 import im . actor . config . ActorConfig 
 - import im . actor . server . activation . ActivationContext 
 + import im . actor . env . ActorEnv 
 import im . actor . server . api . http . { HttpApi , HttpApiConfig } 
 import im . actor . server . api . rpc . RpcApiExtension 
 import im . actor . server . api . rpc . service . auth . AuthServiceImpl 
 @ @ - 75 , 8 + 77 , 9 @ @ final case class ActorServerBuilder ( defaultConfig : Config = ConfigFactory . empty ( 
 * @ return 
 * / 
 def start ( ) : ActorServer = { 
 - Option ( System . getProperty ( " actor . home " ) ) foreach { home â‡’ 
 - System . setProperty ( " config . file " , s " $ home / conf / server . conf " ) 
 + val configPath = ActorEnv . getAbsolutePath ( " conf / server . conf " ) 
 + if ( Files . exists ( configPath ) ) { 
 + System . setProperty ( " config . file " , configPath . toString ) 
 } 
 
 System . setProperty ( " sun . jnu . encoding " , " UTF - 8 " ) 
 diff - - git a / actor - server / actor - tests / src / test / scala / im / actor / util / PathSpec . scala b / actor - server / actor - tests / src / test / scala / im / actor / util / PathSpec . scala 
 new file mode 100644 
 index 0000000 . . 94db9b2 
 - - - / dev / null 
 + + + b / actor - server / actor - tests / src / test / scala / im / actor / util / PathSpec . scala 
 @ @ - 0 , 0 + 1 , 19 @ @ 
 + package im . actor . util 
 + 
 + import java . nio . file . Files 
 + 
 + import im . actor . config . ActorConfig 
 + import org . scalatest . { FlatSpec , Matchers } 
 + 
 + class PathSpec extends FlatSpec with Matchers { 
 + 
 + " Templates folder " should " exist " in templatesFolderExists ( ) 
 + 
 + def templatesFolderExists ( ) : Unit = { 
 + val path = ActorConfig . getAbsolutePath ( " templates " ) 
 + assert ( Files . exists ( path ) , " templates path should exist " ) 
 + assert ( Files . isDirectory ( path ) , " templates is a folder " ) 
 + assert ( path . isAbsolute , " templates path is absolute " ) 
 + } 
 + 
 + } 
 \ No newline at end of file 
 diff - - git a / actor - server / build . sbt b / actor - server / build . sbt 
 index 5d108d0 . . 5c0a595 100644 
 - - - a / actor - server / build . sbt 
 + + + b / actor - server / build . sbt 
 @ @ - 19 , 7 + 19 , 6 @ @ rpmVendor : = " actor " 
 daemonUser in Linux : = " actor " 
 daemonGroup in Linux : = ( daemonUser in Linux ) . value 
 
 - bashScriptExtraDefines + = " " " addJava " - Dactor . home = $ { app _ home } / . . " " " " 
 bashScriptExtraDefines + = " " " addJava " - Dlogback . configurationFile = $ { app _ home } / . . / conf / logback . xml " " " " 
 bashScriptExtraDefines + = " " " addJava - XX : + HeapDumpOnOutOfMemoryError - XX : HeapDumpPath = $ { app _ home } / . . / logs / dump - ` date ` . hprof " " " 
 
 @ @ - 32 , 4 + 31 , 8 @ @ dockerUpdateLatest : = true 
 linuxPackageMappings + = { 
 val initFiles = sourceDirectory . value / " linux " / " var " / " lib " / " actor " 
 packageMapping ( initFiles - > " / var / lib / actor " ) withPerms " 0644 " withUser " actor " withGroup " actor " withContents ( ) 
 + } 
 + 
 + linuxPackageMappings + = { 
 + packageMapping ( baseDirectory . value / " templates " - > " / usr / share / actor / templates " ) withContents ( ) 
 } 
 \ No newline at end of file 
 diff - - git a / actor - server / src / linux / usr / share / actor / templates / activation - email - template . html b / actor - server / src / linux / usr / share / actor / templates / activation - email - template . html 
 deleted file mode 100644 
 index e34ddc6 . . 0000000 
 - - - a / actor - server / src / linux / usr / share / actor / templates / activation - email - template . html 
 + + + / dev / null 
 @ @ - 1 , 261 + 0 , 0 @ @ 
 - < ! DOCTYPE html PUBLIC " - / / W3C / / DTD XHTML 1 . 0 Strict / / EN " " http : / / www . w3 . org / TR / xhtml1 / DTD / xhtml1 - strict . dtd " > 
 - < html xmlns = " http : / / www . w3 . org / 1999 / xhtml " > 
 - < head > 
 - < meta http - equiv = " Content - Type " content = " text / html ; charset = utf - 8 " / > 
 - < meta name = " viewport " content = " width = device - width , initial - scale = 1 . 0 " / > 
 - < title > [ Actor ] Notifications for May 13th , 2015 < / title > 
 - 
 - < style type = " text / css " > 
 - / * Template styling * / 
 - body { 
 - font - family : " Helvetica Neue " , Helvetica , Arial , sans - serif ; 
 - width : 100 % ; 
 - max - width : 100 % ; 
 - font - size : 17px ; 
 - line - height : 24px ; 
 - color : # 373737 ; 
 - background : # F9F9F9 ; 
 - } 
 - table { 
 - width : 100 % ; 
 - margin : 0 auto ; 
 - } 
 - h1 , h2 , h3 , h4 { 
 - color : # 2ab27b ; 
 - margin - bottom : 12px ; 
 - line - height : 26px ; 
 - } 
 - p , ul , ul li { 
 - font - size : 17px ; 
 - margin : 0 0 16px ; 
 - line - height : 24px ; 
 - } 
 - ul { 
 - margin - bottom : 24px ; 
 - } 
 - ul li { 
 - margin - bottom : 8px ; 
 - } 
 - p . mini { 
 - font - size : 12px ; 
 - line - height : 18px ; 
 - color : # ABAFB4 ; 
 - } 
 - p . message { 
 - font - size : 16px ; 
 - line - height : 20px ; 
 - margin - bottom : 4px ; 
 - } 
 - hr { 
 - margin : 2rem 0 ; 
 - width : 100 % ; 
 - border : none ; 
 - border - bottom : 1px solid # ECECEC ; 
 - } 
 - a , a : link , a : visited , a : active , a : hover { 
 - font - weight : bold ; 
 - color : # 439fe0 ; 
 - text - decoration : none ; 
 - word - break : break - word ; 
 - } 
 - a : active , a : hover { 
 - text - decoration : underline ; 
 - } 
 - . time { 
 - font - size : 11px ; 
 - color : # ABAFB4 ; 
 - padding - right : 6px ; 
 - } 
 - . emoji { 
 - vertical - align : bottom ; 
 - } 
 - . avatar { 
 - border - radius : 2px ; 
 - } 
 - # footer p { 
 - margin - top : 16px ; 
 - font - size : 12px ; 
 - } 
 - 
 - / * Client - specific Styles * / 
 - # outlook a { padding : 0 ; } 
 - body { width : 100 % ! important ; - webkit - text - size - adjust : 100 % ; - ms - text - size - adjust : 100 % ; margin : 0 auto ; padding : 0 ; } 
 - . ExternalClass { width : 100 % ; } 
 - . ExternalClass , . ExternalClass p , . ExternalClass span , . ExternalClass font , . ExternalClass td , . ExternalClass div { line - height : 100 % ; } 
 - # backgroundTable { margin : 0 ; padding : 0 ; width : 100 % ; line - height : 100 % ! important ; } 
 - 
 - / * Some sensible defaults for images 
 - Bring inline : Yes . * / 
 - img { outline : none ; text - decoration : none ; - ms - interpolation - mode : bicubic ; } 
 - a img { border : none ; } 
 - . image _ fix { display : block ; } 
 - 
 - / * Outlook 07 , 10 Padding issue fix 
 - Bring inline : No . * / 
 - table td { border - collapse : collapse ; } 
 - 
 - / * Fix spacing around Outlook 07 , 10 tables 
 - Bring inline : Yes * / 
 - table { border - collapse : collapse ; mso - table - lspace : 0pt ; mso - table - rspace : 0pt ; } 
 - 
 - / * Mobile * / 
 - @ media only screen and ( max - device - width : 480px ) { 
 - / * Part one of controlling phone number linking for mobile . * / 
 - a [ href ^ = " tel " ] , a [ href ^ = " sms " ] { 
 - text - decoration : none ; 
 - color : blue ; / * or whatever your want * / 
 - pointer - events : none ; 
 - cursor : default ; 
 - } 
 - 
 - . mobile _ link a [ href ^ = " tel " ] , . mobile _ link a [ href ^ = " sms " ] { 
 - text - decoration : default ; 
 - color : orange ! important ; 
 - pointer - events : auto ; 
 - cursor : default ; 
 - } 
 - 
 - } 
 - 
 - / * Not all email clients will obey these , but the important ones will * / 
 - @ media only screen and ( max - width : 480px ) { 
 - . card { 
 - padding : 1rem 0 . 75rem ! important ; 
 - } 
 - . link _ option { 
 - font - size : 14px ; 
 - } 
 - hr { 
 - margin : 2rem - 0 . 75rem ! important ; 
 - padding - right : 1 . 5rem ! important ; 
 - } 
 - } 
 - 
 - / * More Specific Targeting * / 
 - @ media only screen and ( min - device - width : 768px ) and ( max - device - width : 1024px ) { 
 - / * You guessed it , ipad ( tablets , smaller screens , etc ) * / 
 - / * repeating for the ipad * / 
 - a [ href ^ = " tel " ] , a [ href ^ = " sms " ] { 
 - text - decoration : none ; 
 - color : blue ; / * or whatever your want * / 
 - pointer - events : none ; 
 - cursor : default ; 
 - } 
 - 
 - . mobile _ link a [ href ^ = " tel " ] , . mobile _ link a [ href ^ = " sms " ] { 
 - text - decoration : default ; 
 - color : orange ! important ; 
 - pointer - events : auto ; 
 - cursor : default ; 
 - } 
 - } 
 - 
 - / * iPhone Retina * / 
 - @ media only screen and ( - webkit - min - device - pixel - ratio : 2 ) and ( max - device - width : 640px ) { 
 - / * Must include ! important on each style to override inline styles * / 
 - # footer p { 
 - font - size : 9px ; 
 - } 
 - } 
 - 
 - / * Android targeting * / 
 - @ media only screen and ( - webkit - device - pixel - ratio : . 75 ) { 
 - / * Put CSS for low density ( ldpi ) Android layouts in here * / 
 - img { 
 - max - width : 100 % ; 
 - height : auto ; 
 - } 
 - } 
 - @ media only screen and ( - webkit - device - pixel - ratio : 1 ) { 
 - / * Put CSS for medium density ( mdpi ) Android layouts in here * / 
 - img { 
 - max - width : 100 % ; 
 - height : auto ; 
 - } 
 - } 
 - @ media only screen and ( - webkit - device - pixel - ratio : 1 . 5 ) { 
 - / * Put CSS for high density ( hdpi ) Android layouts in here * / 
 - img { 
 - max - width : 100 % ; 
 - height : auto ; 
 - } 
 - } 
 - / * Galaxy Nexus * / 
 - @ media only screen and ( min - device - width : 720px ) and ( max - device - width : 1280px ) { 
 - img { 
 - max - width : 100 % ; 
 - height : auto ; 
 - } 
 - body { 
 - font - size : 16px ; 
 - } 
 - } 
 - / * end Android targeting * / 
 - 
 - 
 - < / style > 
 - 
 - < / head > 
 - < body > 
 - < table width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " id = " backgroundTable " style = " font - size : 17px ; line - height : 24px ; color : # 373737 ; background : # F9F9F9 ; " > 
 - < tr > 
 - < td valign = " top " > 
 - < table id = " header " width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " > 
 - < tr > 
 - < td valign = " bottom " style = " padding : 20px 16px 20px ; " > 
 - < div style = " max - width : 600px ; margin : 0 auto ; text - align : center ; " > < / div > 
 - < / td > 
 - < / tr > 
 - < / table > 
 - < / td > 
 - < / tr > 
 - < tr > 
 - < td valign = " top " > 
 - < table id = " body " width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " align = " center " > 
 - < tr > 
 - < td valign = " top " > 
 - < div style = " max - width : 600px ; margin : 0 auto ; padding : 0 12px ; text - align : center ; " > 
 - < div class = " card " style = " background : white ; border - radius : 0 . 5rem ; padding : 2rem ; margin - bottom : 1rem ; " > 
 - < h2 style = " color : # 4b6e99 ; margin : 0 0 12px ; line - height : 30px ; " > You ' re almost done . < / h2 > 
 - 
 - < p style = " margin - bottom : 4rem ; " > 
 - Enter this verification code to access Actor : 
 - < / p > 
 - 
 - < ! - - < hr style = " margin : 1 . 5rem 0 ; width : 100 % ; border : none ; border - bottom : 1px solid # ECECEC ; " / > - - > 
 - 
 - < h1 style = " color : # 039769 ; margin : 0 0 12px ; line - height : 30px ; margin - bottom : 4rem ; " > $ $ CODE $ $ < / h1 > 
 - 
 - < ! - - < hr style = " margin : 1 . 5rem 0 ; width : 100 % ; border : none ; border - bottom : 1px solid # ECECEC ; " / > - - > 
 - < p > Is this my password ? < / p > 
 - < p style = " font - size : 0 . 9rem ; line - height : 20px ; color : # AAA ; text - align : center ; margin : 0 auto 1rem ; max - width : 320px ; word - break : break - word ; text - align : center ; max - width : 100 % ; margin - bottom : 0 ; " > 
 - No . To keep you safe , Actor doesn ' t use passwords . You ' ll receive a new temporary code each time you sign in to Actor . < / p > 
 - 
 - < / div > 
 - < / td > 
 - < / tr > 
 - < / table > 
 - < / td > 
 - < / tr > 
 - < / td > 
 - < / tr > 
 - < tr > 
 - < td > 
 - < table id = " footer " width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " align = " center " style = " color : # 989EA6 ; " > 
 - < tr > 
 - < td valign = " top " align = " center " > 
 - < div style = " max - width : 600px ; margin : 0 auto ; " > 
 - < p class = " footer _ address " style = " margin - top : 16px ; font - size : 12px ; line - height : 20px ; " > 
 - Made by < a href = " https : / / actor . im " style = " font - weight : bold ; color : # 439fe0 ; " > Actor LLC < / a > & nbsp ; & bull ; & nbsp ; 
 - < a href = " https : / / twitter . com / actorapp " style = " font - weight : bold ; color : # 439fe0 ; " > Our Twitter < / a > < br / > 
 - Rubinsheina 11A & nbsp ; & bull ; & nbsp ; Saint - Petersburg , Russia & nbsp ; & bull ; & nbsp ; 191002 
 - < / p > 
 - < / div > 
 - < / td > 
 - < / tr > 
 - < / table > 
 - < / td > 
 - < / tr > 
 - < / table > 
 - < / body > 
 - < / html > 
 \ No newline at end of file 
 diff - - git a / actor - server / src / universal / conf / server . conf . example b / actor - server / src / universal / conf / server . conf . example 
 index 296ed76 . . 89f82d4 100644 
 - - - a / actor - server / src / universal / conf / server . conf . example 
 + + + b / actor - server / src / universal / conf / server . conf . example 
 @ @ - 131 , 7 + 131 , 7 @ @ services { 
 
 # Email template for email code activation 
 # email { 
 - # template : $ { actor . home } / templates / activation - email - template . html 
 + # template : templates / activation - email - template . html 
 # } 
 # Setting for internal activation ( aka via actor bot ) 
 # internal { 
 diff - - git a / actor - server / templates / activation - email - template . html b / actor - server / templates / activation - email - template . html 
 new file mode 100644 
 index 0000000 . . e34ddc6 
 - - - / dev / null 
 + + + b / actor - server / templates / activation - email - template . html 
 @ @ - 0 , 0 + 1 , 261 @ @ 
 + < ! DOCTYPE html PUBLIC " - / / W3C / / DTD XHTML 1 . 0 Strict / / EN " " http : / / www . w3 . org / TR / xhtml1 / DTD / xhtml1 - strict . dtd " > 
 + < html xmlns = " http : / / www . w3 . org / 1999 / xhtml " > 
 + < head > 
 + < meta http - equiv = " Content - Type " content = " text / html ; charset = utf - 8 " / > 
 + < meta name = " viewport " content = " width = device - width , initial - scale = 1 . 0 " / > 
 + < title > [ Actor ] Notifications for May 13th , 2015 < / title > 
 + 
 + < style type = " text / css " > 
 + / * Template styling * / 
 + body { 
 + font - family : " Helvetica Neue " , Helvetica , Arial , sans - serif ; 
 + width : 100 % ; 
 + max - width : 100 % ; 
 + font - size : 17px ; 
 + line - height : 24px ; 
 + color : # 373737 ; 
 + background : # F9F9F9 ; 
 + } 
 + table { 
 + width : 100 % ; 
 + margin : 0 auto ; 
 + } 
 + h1 , h2 , h3 , h4 { 
 + color : # 2ab27b ; 
 + margin - bottom : 12px ; 
 + line - height : 26px ; 
 + } 
 + p , ul , ul li { 
 + font - size : 17px ; 
 + margin : 0 0 16px ; 
 + line - height : 24px ; 
 + } 
 + ul { 
 + margin - bottom : 24px ; 
 + } 
 + ul li { 
 + margin - bottom : 8px ; 
 + } 
 + p . mini { 
 + font - size : 12px ; 
 + line - height : 18px ; 
 + color : # ABAFB4 ; 
 + } 
 + p . message { 
 + font - size : 16px ; 
 + line - height : 20px ; 
 + margin - bottom : 4px ; 
 + } 
 + hr { 
 + margin : 2rem 0 ; 
 + width : 100 % ; 
 + border : none ; 
 + border - bottom : 1px solid # ECECEC ; 
 + } 
 + a , a : link , a : visited , a : active , a : hover { 
 + font - weight : bold ; 
 + color : # 439fe0 ; 
 + text - decoration : none ; 
 + word - break : break - word ; 
 + } 
 + a : active , a : hover { 
 + text - decoration : underline ; 
 + } 
 + . time { 
 + font - size : 11px ; 
 + color : # ABAFB4 ; 
 + padding - right : 6px ; 
 + } 
 + . emoji { 
 + vertical - align : bottom ; 
 + } 
 + . avatar { 
 + border - radius : 2px ; 
 + } 
 + # footer p { 
 + margin - top : 16px ; 
 + font - size : 12px ; 
 + } 
 + 
 + / * Client - specific Styles * / 
 + # outlook a { padding : 0 ; } 
 + body { width : 100 % ! important ; - webkit - text - size - adjust : 100 % ; - ms - text - size - adjust : 100 % ; margin : 0 auto ; padding : 0 ; } 
 + . ExternalClass { width : 100 % ; } 
 + . ExternalClass , . ExternalClass p , . ExternalClass span , . ExternalClass font , . ExternalClass td , . ExternalClass div { line - height : 100 % ; } 
 + # backgroundTable { margin : 0 ; padding : 0 ; width : 100 % ; line - height : 100 % ! important ; } 
 + 
 + / * Some sensible defaults for images 
 + Bring inline : Yes . * / 
 + img { outline : none ; text - decoration : none ; - ms - interpolation - mode : bicubic ; } 
 + a img { border : none ; } 
 + . image _ fix { display : block ; } 
 + 
 + / * Outlook 07 , 10 Padding issue fix 
 + Bring inline : No . * / 
 + table td { border - collapse : collapse ; } 
 + 
 + / * Fix spacing around Outlook 07 , 10 tables 
 + Bring inline : Yes * / 
 + table { border - collapse : collapse ; mso - table - lspace : 0pt ; mso - table - rspace : 0pt ; } 
 + 
 + / * Mobile * / 
 + @ media only screen and ( max - device - width : 480px ) { 
 + / * Part one of controlling phone number linking for mobile . * / 
 + a [ href ^ = " tel " ] , a [ href ^ = " sms " ] { 
 + text - decoration : none ; 
 + color : blue ; / * or whatever your want * / 
 + pointer - events : none ; 
 + cursor : default ; 
 + } 
 + 
 + . mobile _ link a [ href ^ = " tel " ] , . mobile _ link a [ href ^ = " sms " ] { 
 + text - decoration : default ; 
 + color : orange ! important ; 
 + pointer - events : auto ; 
 + cursor : default ; 
 + } 
 + 
 + } 
 + 
 + / * Not all email clients will obey these , but the important ones will * / 
 + @ media only screen and ( max - width : 480px ) { 
 + . card { 
 + padding : 1rem 0 . 75rem ! important ; 
 + } 
 + . link _ option { 
 + font - size : 14px ; 
 + } 
 + hr { 
 + margin : 2rem - 0 . 75rem ! important ; 
 + padding - right : 1 . 5rem ! important ; 
 + } 
 + } 
 + 
 + / * More Specific Targeting * / 
 + @ media only screen and ( min - device - width : 768px ) and ( max - device - width : 1024px ) { 
 + / * You guessed it , ipad ( tablets , smaller screens , etc ) * / 
 + / * repeating for the ipad * / 
 + a [ href ^ = " tel " ] , a [ href ^ = " sms " ] { 
 + text - decoration : none ; 
 + color : blue ; / * or whatever your want * / 
 + pointer - events : none ; 
 + cursor : default ; 
 + } 
 + 
 + . mobile _ link a [ href ^ = " tel " ] , . mobile _ link a [ href ^ = " sms " ] { 
 + text - decoration : default ; 
 + color : orange ! important ; 
 + pointer - events : auto ; 
 + cursor : default ; 
 + } 
 + } 
 + 
 + / * iPhone Retina * / 
 + @ media only screen and ( - webkit - min - device - pixel - ratio : 2 ) and ( max - device - width : 640px ) { 
 + / * Must include ! important on each style to override inline styles * / 
 + # footer p { 
 + font - size : 9px ; 
 + } 
 + } 
 + 
 + / * Android targeting * / 
 + @ media only screen and ( - webkit - device - pixel - ratio : . 75 ) { 
 + / * Put CSS for low density ( ldpi ) Android layouts in here * / 
 + img { 
 + max - width : 100 % ; 
 + height : auto ; 
 + } 
 + } 
 + @ media only screen and ( - webkit - device - pixel - ratio : 1 ) { 
 + / * Put CSS for medium density ( mdpi ) Android layouts in here * / 
 + img { 
 + max - width : 100 % ; 
 + height : auto ; 
 + } 
 + } 
 + @ media only screen and ( - webkit - device - pixel - ratio : 1 . 5 ) { 
 + / * Put CSS for high density ( hdpi ) Android layouts in here * / 
 + img { 
 + max - width : 100 % ; 
 + height : auto ; 
 + } 
 + } 
 + / * Galaxy Nexus * / 
 + @ media only screen and ( min - device - width : 720px ) and ( max - device - width : 1280px ) { 
 + img { 
 + max - width : 100 % ; 
 + height : auto ; 
 + } 
 + body { 
 + font - size : 16px ; 
 + } 
 + } 
 + / * end Android targeting * / 
 + 
 + 
 + < / style > 
 + 
 + < / head > 
 + < body > 
 + < table width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " id = " backgroundTable " style = " font - size : 17px ; line - height : 24px ; color : # 373737 ; background : # F9F9F9 ; " > 
 + < tr > 
 + < td valign = " top " > 
 + < table id = " header " width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " > 
 + < tr > 
 + < td valign = " bottom " style = " padding : 20px 16px 20px ; " > 
 + < div style = " max - width : 600px ; margin : 0 auto ; text - align : center ; " > < / div > 
 + < / td > 
 + < / tr > 
 + < / table > 
 + < / td > 
 + < / tr > 
 + < tr > 
 + < td valign = " top " > 
 + < table id = " body " width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " align = " center " > 
 + < tr > 
 + < td valign = " top " > 
 + < div style = " max - width : 600px ; margin : 0 auto ; padding : 0 12px ; text - align : center ; " > 
 + < div class = " card " style = " background : white ; border - radius : 0 . 5rem ; padding : 2rem ; margin - bottom : 1rem ; " > 
 + < h2 style = " color : # 4b6e99 ; margin : 0 0 12px ; line - height : 30px ; " > You ' re almost done . < / h2 > 
 + 
 + < p style = " margin - bottom : 4rem ; " > 
 + Enter this verification code to access Actor : 
 + < / p > 
 + 
 + < ! - - < hr style = " margin : 1 . 5rem 0 ; width : 100 % ; border : none ; border - bottom : 1px solid # ECECEC ; " / > - - > 
 + 
 + < h1 style = " color : # 039769 ; margin : 0 0 12px ; line - height : 30px ; margin - bottom : 4rem ; " > $ $ CODE $ $ < / h1 > 
 + 
 + < ! - - < hr style = " margin : 1 . 5rem 0 ; width : 100 % ; border : none ; border - bottom : 1px solid # ECECEC ; " / > - - > 
 + < p > Is this my password ? < / p > 
 + < p style = " font - size : 0 . 9rem ; line - height : 20px ; color : # AAA ; text - align : center ; margin : 0 auto 1rem ; max - width : 320px ; word - break : break - word ; text - align : center ; max - width : 100 % ; margin - bottom : 0 ; " > 
 + No . To keep you safe , Actor doesn ' t use passwords . You ' ll receive a new temporary code each time you sign in to Actor . < / p > 
 + 
 + < / div > 
 + < / td > 
 + < / tr > 
 + < / table > 
 + < / td > 
 + < / tr > 
 + < / td > 
 + < / tr > 
 + < tr > 
 + < td > 
 + < table id = " footer " width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " align = " center " style = " color : # 989EA6 ; " > 
 + < tr > 
 + < td valign = " top " align = " center " > 
 + < div style = " max - width : 600px ; margin : 0 auto ; " > 
 + < p class = " footer _ address " style = " margin - top : 16px ; font - size : 12px ; line - height : 20px ; " > 
 + Made by < a href = " https : / / actor . im " style = " font - weight : bold ; color : # 439fe0 ; " > Actor LLC < / a > & nbsp ; & bull ; & nbsp ; 
 + < a href = " https : / / twitter . com / actorapp " style = " font - weight : bold ; color : # 439fe0 ; " > Our Twitter < / a > < br / > 
 + Rubinsheina 11A & nbsp ; & bull ; & nbsp ; Saint - Petersburg , Russia & nbsp ; & bull ; & nbsp ; 191002 
 + < / p > 
 + < / div > 
 + < / td > 
 + < / tr > 
 + < / table > 
 + < / td > 
 + < / tr > 
 + < / table > 
 + < / body > 
 + < / html > 
 \ No newline at end of file

NEAREST DIFF:
diff - - git a / actor - server / actor - activation / src / main / resources / mail - template . html b / actor - server / actor - activation / src / main / resources / mail - template . html 
 deleted file mode 100644 
 index 25d7297 . . 0000000 
 - - - a / actor - server / actor - activation / src / main / resources / mail - template . html 
 + + + / dev / null 
 @ @ - 1 , 261 + 0 , 0 @ @ 
 - < ! DOCTYPE html PUBLIC " - / / W3C / / DTD XHTML 1 . 0 Strict / / EN " " http : / / www . w3 . org / TR / xhtml1 / DTD / xhtml1 - strict . dtd " > 
 - < html xmlns = " http : / / www . w3 . org / 1999 / xhtml " > 
 - < head > 
 - < meta http - equiv = " Content - Type " content = " text / html ; charset = utf - 8 " / > 
 - < meta name = " viewport " content = " width = device - width , initial - scale = 1 . 0 " / > 
 - < title > [ Actor ] Notifications for May 13th , 2015 < / title > 
 - 
 - < style type = " text / css " > 
 - / * Template styling * / 
 - body { 
 - font - family : " Helvetica Neue " , Helvetica , Arial , sans - serif ; 
 - width : 100 % ; 
 - max - width : 100 % ; 
 - font - size : 17px ; 
 - line - height : 24px ; 
 - color : # 373737 ; 
 - background : # F9F9F9 ; 
 - } 
 - table { 
 - width : 100 % ; 
 - margin : 0 auto ; 
 - } 
 - h1 , h2 , h3 , h4 { 
 - color : # 2ab27b ; 
 - margin - bottom : 12px ; 
 - line - height : 26px ; 
 - } 
 - p , ul , ul li { 
 - font - size : 17px ; 
 - margin : 0 0 16px ; 
 - line - height : 24px ; 
 - } 
 - ul { 
 - margin - bottom : 24px ; 
 - } 
 - ul li { 
 - margin - bottom : 8px ; 
 - } 
 - p . mini { 
 - font - size : 12px ; 
 - line - height : 18px ; 
 - color : # ABAFB4 ; 
 - } 
 - p . message { 
 - font - size : 16px ; 
 - line - height : 20px ; 
 - margin - bottom : 4px ; 
 - } 
 - hr { 
 - margin : 2rem 0 ; 
 - width : 100 % ; 
 - border : none ; 
 - border - bottom : 1px solid # ECECEC ; 
 - } 
 - a , a : link , a : visited , a : active , a : hover { 
 - font - weight : bold ; 
 - color : # 439fe0 ; 
 - text - decoration : none ; 
 - word - break : break - word ; 
 - } 
 - a : active , a : hover { 
 - text - decoration : underline ; 
 - } 
 - . time { 
 - font - size : 11px ; 
 - color : # ABAFB4 ; 
 - padding - right : 6px ; 
 - } 
 - . emoji { 
 - vertical - align : bottom ; 
 - } 
 - . avatar { 
 - border - radius : 2px ; 
 - } 
 - # footer p { 
 - margin - top : 16px ; 
 - font - size : 12px ; 
 - } 
 - 
 - / * Client - specific Styles * / 
 - # outlook a { padding : 0 ; } 
 - body { width : 100 % ! important ; - webkit - text - size - adjust : 100 % ; - ms - text - size - adjust : 100 % ; margin : 0 auto ; padding : 0 ; } 
 - . ExternalClass { width : 100 % ; } 
 - . ExternalClass , . ExternalClass p , . ExternalClass span , . ExternalClass font , . ExternalClass td , . ExternalClass div { line - height : 100 % ; } 
 - # backgroundTable { margin : 0 ; padding : 0 ; width : 100 % ; line - height : 100 % ! important ; } 
 - 
 - / * Some sensible defaults for images 
 - Bring inline : Yes . * / 
 - img { outline : none ; text - decoration : none ; - ms - interpolation - mode : bicubic ; } 
 - a img { border : none ; } 
 - . image _ fix { display : block ; } 
 - 
 - / * Outlook 07 , 10 Padding issue fix 
 - Bring inline : No . * / 
 - table td { border - collapse : collapse ; } 
 - 
 - / * Fix spacing around Outlook 07 , 10 tables 
 - Bring inline : Yes * / 
 - table { border - collapse : collapse ; mso - table - lspace : 0pt ; mso - table - rspace : 0pt ; } 
 - 
 - / * Mobile * / 
 - @ media only screen and ( max - device - width : 480px ) { 
 - / * Part one of controlling phone number linking for mobile . * / 
 - a [ href ^ = " tel " ] , a [ href ^ = " sms " ] { 
 - text - decoration : none ; 
 - color : blue ; / * or whatever your want * / 
 - pointer - events : none ; 
 - cursor : default ; 
 - } 
 - 
 - . mobile _ link a [ href ^ = " tel " ] , . mobile _ link a [ href ^ = " sms " ] { 
 - text - decoration : default ; 
 - color : orange ! important ; 
 - pointer - events : auto ; 
 - cursor : default ; 
 - } 
 - 
 - } 
 - 
 - / * Not all email clients will obey these , but the important ones will * / 
 - @ media only screen and ( max - width : 480px ) { 
 - . card { 
 - padding : 1rem 0 . 75rem ! important ; 
 - } 
 - . link _ option { 
 - font - size : 14px ; 
 - } 
 - hr { 
 - margin : 2rem - 0 . 75rem ! important ; 
 - padding - right : 1 . 5rem ! important ; 
 - } 
 - } 
 - 
 - / * More Specific Targeting * / 
 - @ media only screen and ( min - device - width : 768px ) and ( max - device - width : 1024px ) { 
 - / * You guessed it , ipad ( tablets , smaller screens , etc ) * / 
 - / * repeating for the ipad * / 
 - a [ href ^ = " tel " ] , a [ href ^ = " sms " ] { 
 - text - decoration : none ; 
 - color : blue ; / * or whatever your want * / 
 - pointer - events : none ; 
 - cursor : default ; 
 - } 
 - 
 - . mobile _ link a [ href ^ = " tel " ] , . mobile _ link a [ href ^ = " sms " ] { 
 - text - decoration : default ; 
 - color : orange ! important ; 
 - pointer - events : auto ; 
 - cursor : default ; 
 - } 
 - } 
 - 
 - / * iPhone Retina * / 
 - @ media only screen and ( - webkit - min - device - pixel - ratio : 2 ) and ( max - device - width : 640px ) { 
 - / * Must include ! important on each style to override inline styles * / 
 - # footer p { 
 - font - size : 9px ; 
 - } 
 - } 
 - 
 - / * Android targeting * / 
 - @ media only screen and ( - webkit - device - pixel - ratio : . 75 ) { 
 - / * Put CSS for low density ( ldpi ) Android layouts in here * / 
 - img { 
 - max - width : 100 % ; 
 - height : auto ; 
 - } 
 - } 
 - @ media only screen and ( - webkit - device - pixel - ratio : 1 ) { 
 - / * Put CSS for medium density ( mdpi ) Android layouts in here * / 
 - img { 
 - max - width : 100 % ; 
 - height : auto ; 
 - } 
 - } 
 - @ media only screen and ( - webkit - device - pixel - ratio : 1 . 5 ) { 
 - / * Put CSS for high density ( hdpi ) Android layouts in here * / 
 - img { 
 - max - width : 100 % ; 
 - height : auto ; 
 - } 
 - } 
 - / * Galaxy Nexus * / 
 - @ media only screen and ( min - device - width : 720px ) and ( max - device - width : 1280px ) { 
 - img { 
 - max - width : 100 % ; 
 - height : auto ; 
 - } 
 - body { 
 - font - size : 16px ; 
 - } 
 - } 
 - / * end Android targeting * / 
 - 
 - 
 - < / style > 
 - 
 - < / head > 
 - < body > 
 - < table width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " id = " backgroundTable " style = " font - size : 17px ; line - height : 24px ; color : # 373737 ; background : # F9F9F9 ; " > 
 - < tr > 
 - < td valign = " top " > 
 - < table id = " header " width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " > 
 - < tr > 
 - < td valign = " bottom " style = " padding : 20px 16px 20px ; " > 
 - < div style = " max - width : 600px ; margin : 0 auto ; text - align : center ; " > < / div > 
 - < / td > 
 - < / tr > 
 - < / table > 
 - < / td > 
 - < / tr > 
 - < tr > 
 - < td valign = " top " > 
 - < table id = " body " width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " align = " center " > 
 - < tr > 
 - < td valign = " top " > 
 - < div style = " max - width : 600px ; margin : 0 auto ; padding : 0 12px ; text - align : center ; " > 
 - < div class = " card " style = " background : white ; border - radius : 0 . 5rem ; padding : 2rem ; margin - bottom : 1rem ; " > 
 - < h2 style = " color : # 4b6e99 ; margin : 0 0 12px ; line - height : 30px ; " > You ' re almost done . < / h2 > 
 - 
 - < p style = " margin - bottom : 4rem ; " > 
 - Enter this verification code to access Actor : 
 - < / p > 
 - 
 - < ! - - < hr style = " margin : 1 . 5rem 0 ; width : 100 % ; border : none ; border - bottom : 1px solid # ECECEC ; " / > - - > 
 - 
 - < h1 style = " color : # 039769 ; margin : 0 0 12px ; line - height : 30px ; margin - bottom : 4rem ; " > $ $ CODE $ $ < / h1 > 
 - 
 - < ! - - < hr style = " margin : 1 . 5rem 0 ; width : 100 % ; border : none ; border - bottom : 1px solid # ECECEC ; " / > - - > 
 - < p > Is this my password ? < / p > 
 - < p style = " font - size : 0 . 9rem ; line - height : 20px ; color : # AAA ; text - align : center ; margin : 0 auto 1rem ; max - width : 320px ; word - break : break - word ; text - align : center ; max - width : 100 % ; margin - bottom : 0 ; " > 
 - No . To keep you safe , Actor doesn ' t use passwords . You ' ll receive a new temporary code each time you sign in to Actor . < / p > 
 - 
 - < / div > 
 - < / td > 
 - < / tr > 
 - < / table > 
 - < / td > 
 - < / tr > 
 - < / td > 
 - < / tr > 
 - < tr > 
 - < td > 
 - < table id = " footer " width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " align = " center " style = " color : # 989EA6 ; " > 
 - < tr > 
 - < td valign = " top " align = " center " > 
 - < div style = " max - width : 600px ; margin : 0 auto ; " > 
 - < p class = " footer _ address " style = " margin - top : 16px ; font - size : 12px ; line - height : 20px ; " > 
 - Made by < a href = " https : / / actor . im " style = " font - weight : bold ; color : # 439fe0 ; " > Actor LLC < / a > & nbsp ; & bull ; & nbsp ; 
 - < a href = " https : / / twitter . com / actorapp " style = " font - weight : bold ; color : # 439fe0 ; " > Our Twitter < / a > < br / > 
 - Rubinsheina 11A & nbsp ; & bull ; & nbsp ; Saint - Petersburg , Russia & nbsp ; & bull ; & nbsp ; 191002 
 - < / p > 
 - < / div > 
 - < / td > 
 - < / tr > 
 - < / table > 
 - < / td > 
 - < / tr > 
 - < / table > 
 - / < body > 
 - < / html > 
 \ No newline at end of file 
 diff - - git a / actor - server / actor - activation / src / main / scala / im / actor / server / activation / internal / EmailTemplate . scala b / actor - server / actor - activation / src / main / scala / im / actor / server / activation / internal / EmailTemplate . scala 
 new file mode 100644 
 index 0000000 . . 981021a 
 - - - / dev / null 
 + + + b / actor - server / actor - activation / src / main / scala / im / actor / server / activation / internal / EmailTemplate . scala 
 @ @ - 0 , 0 + 1 , 271 @ @ 
 + package im . actor . server . activation . internal 
 + 
 + object EmailTemplate { 
 + 
 + / / fixme : load from resources 
 + val template : String = 
 + " " " 
 + | < ! DOCTYPE html PUBLIC " - / / W3C / / DTD XHTML 1 . 0 Strict / / EN " " http : / / www . w3 . org / TR / xhtml1 / DTD / xhtml1 - strict . dtd " > 
 + | < html xmlns = " http : / / www . w3 . org / 1999 / xhtml " > 
 + | < head > 
 + | < meta http - equiv = " Content - Type " content = " text / html ; charset = utf - 8 " / > 
 + | < meta name = " viewport " content = " width = device - width , initial - scale = 1 . 0 " / > 
 + | < title > [ Actor ] Notifications for May 13th , 2015 < / title > 
 + | 
 + | < style type = " text / css " > 
 + | / * Template styling * / 
 + | body { 
 + | font - family : " Helvetica Neue " , Helvetica , Arial , sans - serif ; 
 + | width : 100 % ; 
 + | max - width : 100 % ; 
 + | font - size : 17px ; 
 + | line - height : 24px ; 
 + | color : # 373737 ; 
 + | background : # F9F9F9 ; 
 + | } 
 + | table { 
 + | width : 100 % ; 
 + | margin : 0 auto ; 
 + | } 
 + | h1 , h2 , h3 , h4 { 
 + | color : # 2ab27b ; 
 + | margin - bottom : 12px ; 
 + | line - height : 26px ; 
 + | } 
 + | p , ul , ul li { 
 + | font - size : 17px ; 
 + | margin : 0 0 16px ; 
 + | line - height : 24px ; 
 + | } 
 + | ul { 
 + | margin - bottom : 24px ; 
 + | } 
 + | ul li { 
 + | margin - bottom : 8px ; 
 + | } 
 + | p . mini { 
 + | font - size : 12px ; 
 + | line - height : 18px ; 
 + | color : # ABAFB4 ; 
 + | } 
 + | p . message { 
 + | font - size : 16px ; 
 + | line - height : 20px ; 
 + | margin - bottom : 4px ; 
 + | } 
 + | hr { 
 + | margin : 2rem 0 ; 
 + | width : 100 % ; 
 + | border : none ; 
 + | border - bottom : 1px solid # ECECEC ; 
 + | } 
 + | a , a : link , a : visited , a : active , a : hover { 
 + | font - weight : bold ; 
 + | color : # 439fe0 ; 
 + | text - decoration : none ; 
 + | word - break : break - word ; 
 + | } 
 + | a : active , a : hover { 
 + | text - decoration : underline ; 
 + | } 
 + | . time { 
 + | font - size : 11px ; 
 + | color : # ABAFB4 ; 
 + | padding - right : 6px ; 
 + | } 
 + | . emoji { 
 + | vertical - align : bottom ; 
 + | } 
 + | . avatar { 
 + | border - radius : 2px ; 
 + | } 
 + | # footer p { 
 + | margin - top : 16px ; 
 + | font - size : 12px ; 
 + | } 
 + | 
 + | / * Client - specific Styles * / 
 + | # outlook a { padding : 0 ; } 
 + | body { width : 100 % ! important ; - webkit - text - size - adjust : 100 % ; - ms - text - size - adjust : 100 % ; margin : 0 auto ; padding : 0 ; } 
 + | . ExternalClass { width : 100 % ; } 
 + | . ExternalClass , . ExternalClass p , . ExternalClass span , . ExternalClass font , . ExternalClass td , . ExternalClass div { line - height : 100 % ; } 
 + | # backgroundTable { margin : 0 ; padding : 0 ; width : 100 % ; line - height : 100 % ! important ; } 
 + | 
 + | / * Some sensible defaults for images 
 + | Bring inline : Yes . * / 
 + | img { outline : none ; text - decoration : none ; - ms - interpolation - mode : bicubic ; } 
 + | a img { border : none ; } 
 + | . image _ fix { display : block ; } 
 + | 
 + | / * Outlook 07 , 10 Padding issue fix 
 + | Bring inline : No . * / 
 + | table td { border - collapse : collapse ; } 
 + | 
 + | / * Fix spacing around Outlook 07 , 10 tables 
 + | Bring inline : Yes * / 
 + | table { border - collapse : collapse ; mso - table - lspace : 0pt ; mso - table - rspace : 0pt ; } 
 + | 
 + | / * Mobile * / 
 + | @ media only screen and ( max - device - width : 480px ) { 
 + | / * Part one of controlling phone number linking for mobile . * / 
 + | a [ href ^ = " tel " ] , a [ href ^ = " sms " ] { 
 + | text - decoration : none ; 
 + | color : blue ; / * or whatever your want * / 
 + | pointer - events : none ; 
 + | cursor : default ; 
 + | } 
 + | 
 + | . mobile _ link a [ href ^ = " tel " ] , . mobile _ link a [ href ^ = " sms " ] { 
 + | text - decoration : default ; 
 + | color : orange ! important ; 
 + | pointer - events : auto ; 
 + | cursor : default ; 
 + | } 
 + | 
 + | } 
 + | 
 + | / * Not all email clients will obey these , but the important ones will * / 
 + | @ media only screen and ( max - width : 480px ) { 
 + | . card { 
 + | padding : 1rem 0 . 75rem ! important ; 
 + | } 
 + | . link _ option { 
 + | font - size : 14px ; 
 + | } 
 + | hr { 
 + | margin : 2rem - 0 . 75rem ! important ; 
 + | padding - right : 1 . 5rem ! important ; 
 + | } 
 + | } 
 + | 
 + | / * More Specific Targeting * / 
 + | @ media only screen and ( min - device - width : 768px ) and ( max - device - width : 1024px ) { 
 + | / * You guessed it , ipad ( tablets , smaller screens , etc ) * / 
 + | / * repeating for the ipad * / 
 + | a [ href ^ = " tel " ] , a [ href ^ = " sms " ] { 
 + | text - decoration : none ; 
 + | color : blue ; / * or whatever your want * / 
 + | pointer - events : none ; 
 + | cursor : default ; 
 + | } 
 + | 
 + | . mobile _ link a [ href ^ = " tel " ] , . mobile _ link a [ href ^ = " sms " ] { 
 + | text - decoration : default ; 
 + | color : orange ! important ; 
 + | pointer - events : auto ; 
 + | cursor : default ; 
 + | } 
 + | } 
 + | 
 + | / * iPhone Retina * / 
 + | @ media only screen and ( - webkit - min - device - pixel - ratio : 2 ) and ( max - device - width : 640px ) { 
 + | / * Must include ! important on each style to override inline styles * / 
 + | # footer p { 
 + | font - size : 9px ; 
 + | } 
 + | } 
 + | 
 + | / * Android targeting * / 
 + | @ media only screen and ( - webkit - device - pixel - ratio : . 75 ) { 
 + | / * Put CSS for low density ( ldpi ) Android layouts in here * / 
 + | img { 
 + | max - width : 100 % ; 
 + | height : auto ; 
 + | } 
 + | } 
 + | @ media only screen and ( - webkit - device - pixel - ratio : 1 ) { 
 + | / * Put CSS for medium density ( mdpi ) Android layouts in here * / 
 + | img { 
 + | max - width : 100 % ; 
 + | height : auto ; 
 + | } 
 + | } 
 + | @ media only screen and ( - webkit - device - pixel - ratio : 1 . 5 ) { 
 + | / * Put CSS for high density ( hdpi ) Android layouts in here * / 
 + | img { 
 + | max - width : 100 % ; 
 + | height : auto ; 
 + | } 
 + | } 
 + | / * Galaxy Nexus * / 
 + | @ media only screen and ( min - device - width : 720px ) and ( max - device - width : 1280px ) { 
 + | img { 
 + | max - width : 100 % ; 
 + | height : auto ; 
 + | } 
 + | body { 
 + | font - size : 16px ; 
 + | } 
 + | } 
 + | / * end Android targeting * / 
 + | 
 + | 
 + | < / style > 
 + | 
 + | < / head > 
 + | < body > 
 + | < table width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " id = " backgroundTable " style = " font - size : 17px ; line - height : 24px ; color : # 373737 ; background : # F9F9F9 ; " > 
 + | < tr > 
 + | < td valign = " top " > 
 + | < table id = " header " width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " > 
 + | < tr > 
 + | < td valign = " bottom " style = " padding : 20px 16px 20px ; " > 
 + | < div style = " max - width : 600px ; margin : 0 auto ; text - align : center ; " > < / div > 
 + | < / td > 
 + | < / tr > 
 + | < / table > 
 + | < / td > 
 + | < / tr > 
 + | < tr > 
 + | < td valign = " top " > 
 + | < table id = " body " width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " align = " center " > 
 + | < tr > 
 + | < td valign = " top " > 
 + | < div style = " max - width : 600px ; margin : 0 auto ; padding : 0 12px ; text - align : center ; " > 
 + | < div class = " card " style = " background : white ; border - radius : 0 . 5rem ; padding : 2rem ; margin - bottom : 1rem ; " > 
 + | < h2 style = " color : # 4b6e99 ; margin : 0 0 12px ; line - height : 30px ; " > You ' re almost done . < / h2 > 
 + | 
 + | < p style = " margin - bottom : 4rem ; " > 
 + | Enter this verification code to access Actor : 
 + | < / p > 
 + | 
 + | < ! - - < hr style = " margin : 1 . 5rem 0 ; width : 100 % ; border : none ; border - bottom : 1px solid # ECECEC ; " / > - - > 
 + | 
 + | < h1 style = " color : # 039769 ; margin : 0 0 12px ; line - height : 30px ; margin - bottom : 4rem ; " > $ $ CODE $ $ < / h1 > 
 + | 
 + | < ! - - < hr style = " margin : 1 . 5rem 0 ; width : 100 % ; border : none ; border - bottom : 1px solid # ECECEC ; " / > - - > 
 + | < p > Is this my password ? < / p > 
 + | < p style = " font - size : 0 . 9rem ; line - height : 20px ; color : # AAA ; text - align : center ; margin : 0 auto 1rem ; max - width : 320px ; word - break : break - word ; text - align : center ; max - width : 100 % ; margin - bottom : 0 ; " > 
 + | No . To keep you safe , Actor doesn ' t use passwords . You ' ll receive a new temporary code each time you sign in to Actor . < / p > 
 + | 
 + | < / div > 
 + | < / td > 
 + | < / tr > 
 + | < / table > 
 + | < / td > 
 + | < / tr > 
 + | < / td > 
 + | < / tr > 
 + | < tr > 
 + | < td > 
 + | < table id = " footer " width = " 100 % " cellpadding = " 0 " cellspacing = " 0 " border = " 0 " align = " center " style = " color : # 989EA6 ; " > 
 + | < tr > 
 + | < td valign = " top " align = " center " > 
 + | < div style = " max - width : 600px ; margin : 0 auto ; " > 
 + | < p class = " footer _ address " style = " margin - top : 16px ; font - size : 12px ; line - height : 20px ; " > 
 + | Made by < a href = " https : / / actor . im " style = " font - weight : bold ; color : # 439fe0 ; " > Actor LLC < / a > & nbsp ; & bull ; & nbsp ; 
 + | < a href = " https : / / twitter . com / actorapp " style = " font - weight : bold ; color : # 439fe0 ; " > Our Twitter < / a > < br / > 
 + | Rubinsheina 11A & nbsp ; & bull ; & nbsp ; Saint - Petersburg , Russia & nbsp ; & bull ; & nbsp ; 191002 
 + | < / p > 
 + | < / div > 
 + | < / td > 
 + | < / tr > 
 + | < / table > 
 + | < / td > 
 + | < / tr > 
 + | < / table > 
 + | / < body > 
 + | < / html > 
 + " " " . stripMargin 
 + 
 + } 
 diff - - git a / actor - server / actor - activation / src / main / scala / im / actor / server / activation / internal / InternalCodeActivation . scala b / actor - server / actor - activation / src / main / scala / im / actor / server / activation / internal / InternalCodeActivation . scala 
 index e454bad . . 7d92507 100644 
 - - - a / actor - server / actor - activation / src / main / scala / im / actor / server / activation / internal / InternalCodeActivation . scala 
 + + + b / actor - server / actor - activation / src / main / scala / im / actor / server / activation / internal / InternalCodeActivation . scala 
 @ @ - 1 , 6 + 1 , 5 @ @ 
 package im . actor . server . activation . internal 
 
 - import java . nio . file . { Paths , Files } 
 import java . time . temporal . ChronoUnit . _ 
 import java . time . { LocalDateTime , ZoneOffset } 
 
 @ @ - 95 , 7 + 94 , 7 @ @ class Activation ( repeatLimit : Duration , smsEngine : AuthSmsEngine , callEngine : Au 
 
 private val sentCodes = new scala . collection . mutable . HashSet [ Code ] ( ) 
 
 - private val emailTemplate = new String ( Files . readAllBytes ( Paths . get ( " / mail - template . html " ) ) ) 
 + private val emailTemplate = EmailTemplate . template 
 
 def codeWasNotSent ( code : Code ) = ! sentCodes . contains ( code )
