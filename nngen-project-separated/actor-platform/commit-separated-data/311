BLEU SCORE: 0.21200626759025185

TEST MSG: fix ( android ) : add camera to call ask permissions request
GENERATED MSG: design ( android ) : hide send on record

TEST DIFF (one line): diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / calls / CallFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / calls / CallFragment . java < nl > index 7a7cf9b . . e90b839 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / calls / CallFragment . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / calls / CallFragment . java < nl > @ @ - 400 , 8 + 400 , 8 @ @ public class CallFragment extends BaseFragment { < nl > remoteRender = new VideoRenderer ( remoteVideoView ) ; < nl > stream . getVideoTrack ( ) . addRenderer ( remoteRender ) ; < nl > remoteVideoView . setVisibility ( View . VISIBLE ) ; < nl > - hideView ( avatarView ) ; < nl > - hideView ( nameTV ) ; < nl > + avatarView . setVisibility ( View . INVISIBLE ) ; < nl > + nameTV . setVisibility ( View . INVISIBLE ) ; < nl > } < nl > } ) ; < nl > } < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java < nl > index 9e0b807 . . 6868237 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java < nl > @ @ - 1281 , 11 + 1281 , 12 @ @ public class ChatActivity extends ActorEditTextActivity { < nl > < nl > if ( ActorSDK . sharedActor ( ) . isCallsEnabled ( ) ) { < nl > if ( item . getItemId ( ) = = R . id . call ) { < nl > - if ( ContextCompat . checkSelfPermission ( this , Manifest . permission . RECORD _ AUDIO ) ! = PackageManager . PERMISSION _ GRANTED | | < nl > + if ( ContextCompat . checkSelfPermission ( this , Manifest . permission . CAMERA ) ! = PackageManager . PERMISSION _ GRANTED | | < nl > + ContextCompat . checkSelfPermission ( this , Manifest . permission . RECORD _ AUDIO ) ! = PackageManager . PERMISSION _ GRANTED | | < nl > ContextCompat . checkSelfPermission ( this , Manifest . permission . VIBRATE ) ! = PackageManager . PERMISSION _ GRANTED | | < nl > ContextCompat . checkSelfPermission ( this , Manifest . permission . WAKE _ LOCK ) ! = PackageManager . PERMISSION _ GRANTED ) { < nl > Log . d ( " Permissions " , " call - no permission : c " ) ; < nl > - ActivityCompat . requestPermissions ( this , new String [ ] { Manifest . permission . RECORD _ AUDIO , Manifest . permission . VIBRATE , Manifest . permission . WAKE _ LOCK } , < nl > + ActivityCompat . requestPermissions ( this , new String [ ] { Manifest . permission . RECORD _ AUDIO , Manifest . permission . CAMERA , Manifest . permission . VIBRATE , Manifest . permission . WAKE _ LOCK } , < nl > PERMISSIONS _ REQUEST _ FOR _ CALL ) ; < nl > < nl > } else { < nl > @ @ - 1630 , 6 + 1631 , 11 @ @ public class ChatActivity extends ActorEditTextActivity { < nl > & & grantResults [ 0 ] = = PackageManager . PERMISSION _ GRANTED ) { < nl > showShareChecked ( ) ; < nl > } < nl > + } else if ( requestCode = = PERMISSIONS _ REQUEST _ FOR _ CALL ) { < nl > + if ( grantResults . length > 0 < nl > + & & grantResults [ 0 ] = = PackageManager . PERMISSION _ GRANTED ) { < nl > + startCall ( ) ; < nl > + } < nl > } < nl > } < nl > } < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / fragment _ call . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / fragment _ call . xml < nl > index d9a798d . . a98ddbf 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / fragment _ call . xml < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / fragment _ call . xml < nl > @ @ - 42 , 6 + 42 , 7 @ @ < nl > android : layout _ weight = " 1 " > < nl > < nl > < View < nl > + android : visibility = " invisible " < nl > android : id = " @ + id / layer " < nl > android : layout _ width = " 82dp " < nl > android : layout _ height = " 82dp "
NEAREST DIFF (one line): diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ActorEditTextActivity . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ActorEditTextActivity . java < nl > index 3921a86 . . 40655d5 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ActorEditTextActivity . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ActorEditTextActivity . java < nl > @ @ - 9 , 6 + 9 , 7 @ @ import android . view . KeyEvent ; < nl > import android . view . View ; < nl > import android . view . inputmethod . EditorInfo ; < nl > import android . widget . EditText ; < nl > + import android . widget . FrameLayout ; < nl > import android . widget . ImageButton ; < nl > import android . widget . ImageView ; < nl > import android . widget . TextView ; < nl > @ @ - 45 , 6 + 46 , 8 @ @ public abstract class ActorEditTextActivity extends BaseActivity { < nl > < nl > / / Emoji keyboard < nl > protected EmojiKeyboard emojiKeyboard ; < nl > + protected ImageView emojiButton ; < nl > + protected FrameLayout sendContainer ; < nl > < nl > @ Override < nl > protected void onCreate ( Bundle savedInstanceState ) { < nl > @ @ - 142 , 7 + 145 , 7 @ @ public abstract class ActorEditTextActivity extends BaseActivity { < nl > ( ( TextView ) removedFromGroup . findViewById ( R . id . kicked _ text ) ) . setTextColor ( ActorSDK . sharedActor ( ) . style . getMainColor ( ) ) ; < nl > < nl > / / Emoji keyboard < nl > - final ImageView emojiButton = ( ImageView ) findViewById ( R . id . ib _ emoji ) ; < nl > + emojiButton = ( ImageView ) findViewById ( R . id . ib _ emoji ) ; < nl > emojiKeyboard = new EmojiKeyboard ( this ) ; < nl > emojiKeyboard . setKeyboardStatusListener ( new KeyboardStatusListener ( ) { < nl > < nl > @ @ - 164 , 6 + 167 , 8 @ @ public abstract class ActorEditTextActivity extends BaseActivity { < nl > } < nl > } ) ; < nl > < nl > + sendContainer = ( FrameLayout ) findViewById ( R . id . sendContainer ) ; < nl > + < nl > / / Keyboard helper for show / hide keyboard < nl > keyboardUtils = new KeyboardHelper ( this ) ; < nl > } < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java < nl > index daef4dd . . feb19ae 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java < nl > @ @ - 1189 , 6 + 1189 , 11 @ @ public class ChatActivity extends ActorEditTextActivity { < nl > } < nl > isAudioVisible = true ; < nl > < nl > + hideView ( attachButton ) ; < nl > + hideView ( messageEditText ) ; < nl > + hideView ( emojiButton ) ; < nl > + hideView ( sendContainer ) ; < nl > + < nl > audioFile = ActorSDK . sharedActor ( ) . getMessenger ( ) . getInternalTempFile ( " voice _ msg " , " opus " ) ; < nl > < nl > long id = VoiceCaptureActor . LAST _ ID . incrementAndGet ( ) ; < nl > @ @ - 1219 , 6 + 1224 , 12 @ @ public class ChatActivity extends ActorEditTextActivity { < nl > return ; < nl > } < nl > isAudioVisible = false ; < nl > + < nl > + showView ( attachButton ) ; < nl > + showView ( messageEditText ) ; < nl > + showView ( emojiButton ) ; < nl > + showView ( sendContainer ) ; < nl > + < nl > voiceRecordActor . send ( new VoiceCaptureActor . Stop ( cancel ) ) ; < nl > TranslateAnimation animation = new TranslateAnimation ( 0 , Screen . getWidth ( ) , 0 , 0 ) ; < nl > animation . setDuration ( 160 ) ; < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / activity _ dialog . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / activity _ dialog . xml < nl > index c42a626 . . d87dd13 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / activity _ dialog . xml < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / activity _ dialog . xml < nl > @ @ - 314 , 6 + 314 , 12 @ @ < nl > android : background = " @ drawable / selector _ flat " / > < nl > < / FrameLayout > < nl > < nl > + < FrameLayout < nl > + android : layout _ width = " 0dp " < nl > + android : layout _ height = " 0dp " < nl > + android : id = " @ + id / sendContainer " < nl > + android : visibility = " gone " / > < nl > + < nl > < nl > < FrameLayout < nl > android : layout _ width = " 56dp "

TEST DIFF:
diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / calls / CallFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / calls / CallFragment . java 
 index 7a7cf9b . . e90b839 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / calls / CallFragment . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / calls / CallFragment . java 
 @ @ - 400 , 8 + 400 , 8 @ @ public class CallFragment extends BaseFragment { 
 remoteRender = new VideoRenderer ( remoteVideoView ) ; 
 stream . getVideoTrack ( ) . addRenderer ( remoteRender ) ; 
 remoteVideoView . setVisibility ( View . VISIBLE ) ; 
 - hideView ( avatarView ) ; 
 - hideView ( nameTV ) ; 
 + avatarView . setVisibility ( View . INVISIBLE ) ; 
 + nameTV . setVisibility ( View . INVISIBLE ) ; 
 } 
 } ) ; 
 } 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java 
 index 9e0b807 . . 6868237 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java 
 @ @ - 1281 , 11 + 1281 , 12 @ @ public class ChatActivity extends ActorEditTextActivity { 
 
 if ( ActorSDK . sharedActor ( ) . isCallsEnabled ( ) ) { 
 if ( item . getItemId ( ) = = R . id . call ) { 
 - if ( ContextCompat . checkSelfPermission ( this , Manifest . permission . RECORD _ AUDIO ) ! = PackageManager . PERMISSION _ GRANTED | | 
 + if ( ContextCompat . checkSelfPermission ( this , Manifest . permission . CAMERA ) ! = PackageManager . PERMISSION _ GRANTED | | 
 + ContextCompat . checkSelfPermission ( this , Manifest . permission . RECORD _ AUDIO ) ! = PackageManager . PERMISSION _ GRANTED | | 
 ContextCompat . checkSelfPermission ( this , Manifest . permission . VIBRATE ) ! = PackageManager . PERMISSION _ GRANTED | | 
 ContextCompat . checkSelfPermission ( this , Manifest . permission . WAKE _ LOCK ) ! = PackageManager . PERMISSION _ GRANTED ) { 
 Log . d ( " Permissions " , " call - no permission : c " ) ; 
 - ActivityCompat . requestPermissions ( this , new String [ ] { Manifest . permission . RECORD _ AUDIO , Manifest . permission . VIBRATE , Manifest . permission . WAKE _ LOCK } , 
 + ActivityCompat . requestPermissions ( this , new String [ ] { Manifest . permission . RECORD _ AUDIO , Manifest . permission . CAMERA , Manifest . permission . VIBRATE , Manifest . permission . WAKE _ LOCK } , 
 PERMISSIONS _ REQUEST _ FOR _ CALL ) ; 
 
 } else { 
 @ @ - 1630 , 6 + 1631 , 11 @ @ public class ChatActivity extends ActorEditTextActivity { 
 & & grantResults [ 0 ] = = PackageManager . PERMISSION _ GRANTED ) { 
 showShareChecked ( ) ; 
 } 
 + } else if ( requestCode = = PERMISSIONS _ REQUEST _ FOR _ CALL ) { 
 + if ( grantResults . length > 0 
 + & & grantResults [ 0 ] = = PackageManager . PERMISSION _ GRANTED ) { 
 + startCall ( ) ; 
 + } 
 } 
 } 
 } 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / fragment _ call . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / fragment _ call . xml 
 index d9a798d . . a98ddbf 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / fragment _ call . xml 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / fragment _ call . xml 
 @ @ - 42 , 6 + 42 , 7 @ @ 
 android : layout _ weight = " 1 " > 
 
 < View 
 + android : visibility = " invisible " 
 android : id = " @ + id / layer " 
 android : layout _ width = " 82dp " 
 android : layout _ height = " 82dp "

NEAREST DIFF:
diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ActorEditTextActivity . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ActorEditTextActivity . java 
 index 3921a86 . . 40655d5 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ActorEditTextActivity . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ActorEditTextActivity . java 
 @ @ - 9 , 6 + 9 , 7 @ @ import android . view . KeyEvent ; 
 import android . view . View ; 
 import android . view . inputmethod . EditorInfo ; 
 import android . widget . EditText ; 
 + import android . widget . FrameLayout ; 
 import android . widget . ImageButton ; 
 import android . widget . ImageView ; 
 import android . widget . TextView ; 
 @ @ - 45 , 6 + 46 , 8 @ @ public abstract class ActorEditTextActivity extends BaseActivity { 
 
 / / Emoji keyboard 
 protected EmojiKeyboard emojiKeyboard ; 
 + protected ImageView emojiButton ; 
 + protected FrameLayout sendContainer ; 
 
 @ Override 
 protected void onCreate ( Bundle savedInstanceState ) { 
 @ @ - 142 , 7 + 145 , 7 @ @ public abstract class ActorEditTextActivity extends BaseActivity { 
 ( ( TextView ) removedFromGroup . findViewById ( R . id . kicked _ text ) ) . setTextColor ( ActorSDK . sharedActor ( ) . style . getMainColor ( ) ) ; 
 
 / / Emoji keyboard 
 - final ImageView emojiButton = ( ImageView ) findViewById ( R . id . ib _ emoji ) ; 
 + emojiButton = ( ImageView ) findViewById ( R . id . ib _ emoji ) ; 
 emojiKeyboard = new EmojiKeyboard ( this ) ; 
 emojiKeyboard . setKeyboardStatusListener ( new KeyboardStatusListener ( ) { 
 
 @ @ - 164 , 6 + 167 , 8 @ @ public abstract class ActorEditTextActivity extends BaseActivity { 
 } 
 } ) ; 
 
 + sendContainer = ( FrameLayout ) findViewById ( R . id . sendContainer ) ; 
 + 
 / / Keyboard helper for show / hide keyboard 
 keyboardUtils = new KeyboardHelper ( this ) ; 
 } 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java 
 index daef4dd . . feb19ae 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java 
 @ @ - 1189 , 6 + 1189 , 11 @ @ public class ChatActivity extends ActorEditTextActivity { 
 } 
 isAudioVisible = true ; 
 
 + hideView ( attachButton ) ; 
 + hideView ( messageEditText ) ; 
 + hideView ( emojiButton ) ; 
 + hideView ( sendContainer ) ; 
 + 
 audioFile = ActorSDK . sharedActor ( ) . getMessenger ( ) . getInternalTempFile ( " voice _ msg " , " opus " ) ; 
 
 long id = VoiceCaptureActor . LAST _ ID . incrementAndGet ( ) ; 
 @ @ - 1219 , 6 + 1224 , 12 @ @ public class ChatActivity extends ActorEditTextActivity { 
 return ; 
 } 
 isAudioVisible = false ; 
 + 
 + showView ( attachButton ) ; 
 + showView ( messageEditText ) ; 
 + showView ( emojiButton ) ; 
 + showView ( sendContainer ) ; 
 + 
 voiceRecordActor . send ( new VoiceCaptureActor . Stop ( cancel ) ) ; 
 TranslateAnimation animation = new TranslateAnimation ( 0 , Screen . getWidth ( ) , 0 , 0 ) ; 
 animation . setDuration ( 160 ) ; 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / activity _ dialog . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / activity _ dialog . xml 
 index c42a626 . . d87dd13 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / activity _ dialog . xml 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / activity _ dialog . xml 
 @ @ - 314 , 6 + 314 , 12 @ @ 
 android : background = " @ drawable / selector _ flat " / > 
 < / FrameLayout > 
 
 + < FrameLayout 
 + android : layout _ width = " 0dp " 
 + android : layout _ height = " 0dp " 
 + android : id = " @ + id / sendContainer " 
 + android : visibility = " gone " / > 
 + 
 
 < FrameLayout 
 android : layout _ width = " 56dp "
