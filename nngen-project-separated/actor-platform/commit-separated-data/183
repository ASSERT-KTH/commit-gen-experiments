BLEU SCORE: 0.07495553473355841

TEST MSG: feat ( android + core ) : Update service messages for channels
GENERATED MSG: fix ( sdk ) : Fix compilation

TEST DIFF (one line): diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / MessagesAdapter . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / MessagesAdapter . java < nl > index b88bd37 . . ab40cf2 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / MessagesAdapter . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / MessagesAdapter . java < nl > @ @ - 7 , 7 + 7 , 9 @ @ import android . view . ViewGroup ; < nl > < nl > import java . util . HashMap ; < nl > < nl > + import im . actor . core . entity . GroupType ; < nl > import im . actor . core . entity . Message ; < nl > + import im . actor . core . entity . PeerType ; < nl > import im . actor . core . entity . content . AbsContent ; < nl > import im . actor . core . entity . content . AnimationContent ; < nl > import im . actor . core . entity . content . ContactContent ; < nl > @ @ - 42 , 6 + 44 , 7 @ @ import im . actor . sdk . controllers . conversation . messages . content . TextHolder ; < nl > import im . actor . sdk . controllers . conversation . messages . content . UnsupportedHolder ; < nl > import im . actor . sdk . controllers . ActorBinder ; < nl > < nl > + import static im . actor . sdk . util . ActorSDKMessenger . groups ; < nl > import static im . actor . sdk . util . ActorSDKMessenger . messenger ; < nl > < nl > public class MessagesAdapter extends BindedListAdapter < Message , MessageHolder > { < nl > @ @ - 53 , 6 + 56 , 7 @ @ public class MessagesAdapter extends BindedListAdapter < Message , MessageHolder > { < nl > private long firstUnread = - 1 ; < nl > private long readDate ; < nl > private long receiveDate ; < nl > + private boolean isChannel ; < nl > < nl > private HashMap < Long , Message > selected = new HashMap < > ( ) ; < nl > < nl > @ @ - 64 , 6 + 68 , 11 @ @ public class MessagesAdapter extends BindedListAdapter < Message , MessageHolder > { < nl > this . context = context ; < nl > ConversationVM conversationVM = messenger ( ) . getConversationVM ( messagesFragment . getPeer ( ) ) ; < nl > < nl > + isChannel = false ; < nl > + if ( messagesFragment . getPeer ( ) . getPeerType ( ) = = PeerType . GROUP ) { < nl > + isChannel = groups ( ) . get ( messagesFragment . getPeer ( ) . getPeerId ( ) ) . getGroupType ( ) = = GroupType . CHANNEL ; < nl > + } < nl > + < nl > readDate = conversationVM . getReadDate ( ) . get ( ) ; < nl > receiveDate = conversationVM . getReceiveDate ( ) . get ( ) ; < nl > < nl > @ @ - 204 , 7 + 213 , 7 @ @ public class MessagesAdapter extends BindedListAdapter < Message , MessageHolder > { < nl > return ActorSDK . sharedActor ( ) . getDelegatedViewHolder ( ServiceHolder . class , new ActorSDK . OnDelegateViewHolder < ServiceHolder > ( ) { < nl > @ Override < nl > public ServiceHolder onNotDelegated ( ) { < nl > - return new ServiceHolder ( MessagesAdapter . this , inflate ( R . layout . adapter _ dialog _ service , viewGroup ) ) ; < nl > + return new ServiceHolder ( MessagesAdapter . this , isChannel , inflate ( R . layout . adapter _ dialog _ service , viewGroup ) ) ; < nl > } < nl > } , MessagesAdapter . this , inflate ( R . layout . adapter _ dialog _ service , viewGroup ) ) ; < nl > case 2 : < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / content / ServiceHolder . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / content / ServiceHolder . java < nl > index 1dbd25a . . c081448 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / content / ServiceHolder . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / content / ServiceHolder . java < nl > @ @ - 15 , 10 + 15 , 13 @ @ import static im . actor . sdk . util . ActorSDKMessenger . messenger ; < nl > public class ServiceHolder extends MessageHolder { < nl > < nl > private TextView messageText ; < nl > + private boolean isChannel ; < nl > < nl > - public ServiceHolder ( MessagesAdapter fragment , View itemView ) { < nl > + public ServiceHolder ( MessagesAdapter fragment , boolean isChannel , View itemView ) { < nl > super ( fragment , itemView , true ) ; < nl > < nl > + this . isChannel = isChannel ; < nl > + < nl > messageText = ( TextView ) itemView . findViewById ( R . id . serviceMessage ) ; < nl > messageText . setTextColor ( ActorSDK . sharedActor ( ) . style . getConvDatetextColor ( ) ) ; < nl > onConfigureViewHolder ( ) ; < nl > @ @ - 27 , 6 + 30 , 6 @ @ public class ServiceHolder extends MessageHolder { < nl > @ Override < nl > protected void bindData ( Message message , long readDate , long receiveDate , boolean isUpdated , PreprocessedData preprocessedData ) { < nl > messageText . setText ( messenger ( ) . getFormatter ( ) . formatFullServiceMessage ( message . getSenderId ( ) , < nl > - ( ServiceContent ) message . getContent ( ) ) ) ; < nl > + ( ServiceContent ) message . getContent ( ) , isChannel ) ) ; < nl > } < nl > } < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / dialogs / view / DialogView . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / dialogs / view / DialogView . java < nl > index 155b410 . . 9891db0 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / dialogs / view / DialogView . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / dialogs / view / DialogView . java < nl > @ @ - 399 , 8 + 399 , 10 @ @ public class DialogView extends ListItemBackgroundView < Dialog , DialogView . Dialog < nl > } < nl > < nl > if ( arg . getSenderId ( ) > 0 ) { < nl > + < nl > String contentText = messenger ( ) . getFormatter ( ) . formatContentText ( arg . getSenderId ( ) , < nl > - arg . getMessageType ( ) , arg . getText ( ) . replace ( " \ n " , " " ) , arg . getRelatedUid ( ) ) ; < nl > + arg . getMessageType ( ) , arg . getText ( ) . replace ( " \ n " , " " ) , arg . getRelatedUid ( ) , < nl > + arg . isChannel ( ) ) ; < nl > < nl > if ( arg . getPeer ( ) . getPeerType ( ) = = PeerType . GROUP ) { < nl > if ( messenger ( ) . getFormatter ( ) . isLargeDialogMessage ( arg . getMessageType ( ) ) ) { < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / entity / Notification . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / entity / Notification . java < nl > index 0998e1c . . 6663bea 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / entity / Notification . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / entity / Notification . java < nl > @ @ - 10 , 12 + 10 , 15 @ @ public class Notification { < nl > @ Property ( " readonly , nonatomic " ) < nl > private Peer peer ; < nl > @ Property ( " readonly , nonatomic " ) < nl > + private boolean isChannel ; < nl > + @ Property ( " readonly , nonatomic " ) < nl > private int sender ; < nl > @ Property ( " readonly , nonatomic " ) < nl > private ContentDescription contentDescription ; < nl > < nl > - public Notification ( Peer peer , int sender , ContentDescription contentDescription ) { < nl > + public Notification ( Peer peer , boolean isChannel , int sender , ContentDescription contentDescription ) { < nl > this . peer = peer ; < nl > + this . isChannel = isChannel ; < nl > this . sender = sender ; < nl > this . contentDescription = contentDescription ; < nl > } < nl > @ @ - 28 , 6 + 31 , 10 @ @ public class Notification { < nl > return sender ; < nl > } < nl > < nl > + public boolean isChannel ( ) { < nl > + return isChannel ; < nl > + } < nl > + < nl > public ContentDescription getContentDescription ( ) { < nl > return contentDescription ; < nl > } < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / i18n / I18nEngine . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / i18n / I18nEngine . java < nl > index de15160 . . 4d87232 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / i18n / I18nEngine . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / i18n / I18nEngine . java < nl > @ @ - 225 , 7 + 225 , 8 @ @ public class I18nEngine extends IntlEngine { < nl > return " " ; < nl > } else { < nl > String contentText = formatContentText ( dialog . getSenderId ( ) , < nl > - dialog . getMessageType ( ) , dialog . getText ( ) , dialog . getRelatedUid ( ) ) ; < nl > + dialog . getMessageType ( ) , dialog . getText ( ) , dialog . getRelatedUid ( ) , < nl > + dialog . isChannel ( ) ) ; < nl > if ( dialog . getPeer ( ) . getPeerType ( ) = = PeerType . GROUP ) { < nl > if ( ! isLargeDialogMessage ( dialog . getMessageType ( ) ) ) { < nl > return formatPerformerName ( dialog . getSenderId ( ) ) + " : " + contentText ; < nl > @ @ - 279 , 7 + 280 , 8 @ @ public class I18nEngine extends IntlEngine { < nl > return formatContentText ( pendingNotification . getSender ( ) , < nl > pendingNotification . getContentDescription ( ) . getContentType ( ) , < nl > pendingNotification . getContentDescription ( ) . getText ( ) , < nl > - pendingNotification . getContentDescription ( ) . getRelatedUser ( ) ) ; < nl > + pendingNotification . getContentDescription ( ) . getRelatedUser ( ) , < nl > + pendingNotification . isChannel ( ) ) ; < nl > } < nl > < nl > / * * < nl > @ @ - 291 , 8 + 293 , 12 @ @ public class I18nEngine extends IntlEngine { < nl > * @ param relatedUid optional related uid < nl > * @ return formatted content < nl > * / < nl > - @ ObjectiveCName ( " formatContentTextWithSenderId : withContentType : withText : withRelatedUid : " ) < nl > - public String formatContentText ( int senderId , ContentType contentType , String text , int relatedUid ) { < nl > + @ ObjectiveCName ( " formatContentTextWithSenderId : withContentType : withText : withRelatedUid : withIsChannel " ) < nl > + public String formatContentText ( int senderId , ContentType contentType , String text , int relatedUid , < nl > + boolean isChannel ) { < nl > + < nl > + String groupKey = isChannel ? " channels " : " groups " ; < nl > + < nl > switch ( contentType ) { < nl > case TEXT : < nl > return text ; < nl > @ @ - 323 , 27 + 329 , 27 @ @ public class I18nEngine extends IntlEngine { < nl > return getTemplateNamed ( senderId , " content . service . registered . compact " ) < nl > . replace ( " { app _ name } " , getAppName ( ) ) ; < nl > case SERVICE _ CREATED : < nl > - return getTemplateNamed ( senderId , " content . service . groups . created " ) ; < nl > + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . created " ) ; < nl > case SERVICE _ ADD : < nl > - return getTemplateNamed ( senderId , " content . service . groups . invited " ) < nl > + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . invited " ) < nl > . replace ( " { name _ added } " , getSubjectName ( relatedUid ) ) ; < nl > case SERVICE _ LEAVE : < nl > - return getTemplateNamed ( senderId , " content . service . groups . left " ) ; < nl > + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . left " ) ; < nl > case SERVICE _ KICK : < nl > - return getTemplateNamed ( senderId , " content . service . groups . kicked " ) < nl > + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . kicked " ) < nl > . replace ( " { name _ kicked } " , getSubjectName ( relatedUid ) ) ; < nl > case SERVICE _ AVATAR : < nl > - return getTemplateNamed ( senderId , " content . service . groups . avatar _ changed " ) ; < nl > + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . avatar _ changed " ) ; < nl > case SERVICE _ AVATAR _ REMOVED : < nl > - return getTemplateNamed ( senderId , " content . service . groups . avatar _ removed " ) ; < nl > + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . avatar _ removed " ) ; < nl > case SERVICE _ TITLE : < nl > - return getTemplateNamed ( senderId , " content . service . groups . title _ changed . compact " ) ; < nl > + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . title _ changed . compact " ) ; < nl > case SERVICE _ TOPIC : < nl > - return getTemplateNamed ( senderId , " content . service . groups . topic _ changed . compact " ) ; < nl > + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . topic _ changed . compact " ) ; < nl > case SERVICE _ ABOUT : < nl > - return getTemplateNamed ( senderId , " content . service . groups . about _ changed . compact " ) ; < nl > + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . about _ changed . compact " ) ; < nl > case SERVICE _ JOINED : < nl > - return getTemplateNamed ( senderId , " content . service . groups . joined " ) ; < nl > + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . joined " ) ; < nl > case SERVICE _ CALL _ ENDED : < nl > return get ( " content . service . calls . ended " ) ; < nl > case SERVICE _ CALL _ MISSED : < nl > @ @ - 364 , 42 + 370 , 43 @ @ public class I18nEngine extends IntlEngine { < nl > * @ return formatted message < nl > * / < nl > @ ObjectiveCName ( " formatFullServiceMessageWithSenderId : withContent : " ) < nl > - public String formatFullServiceMessage ( int senderId , ServiceContent content ) { < nl > + public String formatFullServiceMessage ( int senderId , ServiceContent content , boolean isChannel ) { < nl > + String groupKey = isChannel ? " channels " : " groups " ; < nl > if ( content instanceof ServiceUserRegistered ) { < nl > return getTemplateNamed ( senderId , " content . service . registered . full " ) < nl > . replace ( " { app _ name } " , getAppName ( ) ) ; < nl > } else if ( content instanceof ServiceGroupCreated ) { < nl > - return getTemplateNamed ( senderId , " content . service . groups . created " ) ; < nl > + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . created " ) ; < nl > } else if ( content instanceof ServiceGroupUserInvited ) { < nl > - return getTemplateNamed ( senderId , " content . service . groups . invited " ) < nl > + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . invited " ) < nl > . replace ( " { name _ added } " , < nl > getSubjectName ( ( ( ServiceGroupUserInvited ) content ) . getAddedUid ( ) ) ) ; < nl > } else if ( content instanceof ServiceGroupUserKicked ) { < nl > - return getTemplateNamed ( senderId , " content . service . groups . kicked " ) < nl > + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . kicked " ) < nl > . replace ( " { name _ kicked } " , < nl > getSubjectName ( ( ( ServiceGroupUserKicked ) content ) . getKickedUid ( ) ) ) ; < nl > } else if ( content instanceof ServiceGroupUserLeave ) { < nl > - return getTemplateNamed ( senderId , " content . service . groups . left " ) ; < nl > + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . left " ) ; < nl > } else if ( content instanceof ServiceGroupTitleChanged ) { < nl > - return getTemplateNamed ( senderId , " content . service . groups . title _ changed . full " ) < nl > + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . title _ changed . full " ) < nl > . replace ( " { title } " , < nl > ( ( ServiceGroupTitleChanged ) content ) . getNewTitle ( ) ) ; < nl > } else if ( content instanceof ServiceGroupTopicChanged ) { < nl > - return getTemplateNamed ( senderId , " content . service . groups . topic _ changed . full " ) < nl > + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . topic _ changed . full " ) < nl > . replace ( " { topic } " , < nl > ( ( ServiceGroupTopicChanged ) content ) . getNewTopic ( ) ) ; < nl > } else if ( content instanceof ServiceGroupAboutChanged ) { < nl > - return getTemplateNamed ( senderId , " content . service . groups . about _ changed . full " ) < nl > + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . about _ changed . full " ) < nl > . replace ( " { about } " , < nl > ( ( ServiceGroupAboutChanged ) content ) . getNewAbout ( ) ) ; < nl > } else if ( content instanceof ServiceGroupAvatarChanged ) { < nl > if ( ( ( ServiceGroupAvatarChanged ) content ) . getNewAvatar ( ) ! = null ) { < nl > - return getTemplateNamed ( senderId , " content . service . groups . avatar _ changed " ) ; < nl > + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . avatar _ changed " ) ; < nl > } else { < nl > - return getTemplateNamed ( senderId , " content . service . groups . avatar _ removed " ) ; < nl > + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . avatar _ removed " ) ; < nl > } < nl > } else if ( content instanceof ServiceGroupUserJoined ) { < nl > - return getTemplateNamed ( senderId , " content . service . groups . joined " ) ; < nl > + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . joined " ) ; < nl > } else if ( content instanceof ServiceCallEnded ) { < nl > return get ( " content . service . calls . ended " ) ; < nl > } else if ( content instanceof ServiceCallMissed ) { < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / notifications / NotificationsActor . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / notifications / NotificationsActor . java < nl > index 20add75 . . 95af715 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / notifications / NotificationsActor . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / notifications / NotificationsActor . java < nl > @ @ - 12 , 6 + 12 , 7 @ @ import java . util . List ; < nl > < nl > import im . actor . core . PlatformType ; < nl > import im . actor . core . entity . ContentDescription ; < nl > + import im . actor . core . entity . GroupType ; < nl > import im . actor . core . entity . Notification ; < nl > import im . actor . core . entity . Peer ; < nl > import im . actor . core . entity . PeerType ; < nl > @ @ - 31 , 7 + 32 , 7 @ @ import static im . actor . core . util . JavaUtil . last ; < nl > < nl > / * * < nl > * Actor that controls all notifications in application < nl > - * < p / > < nl > + * < p > < nl > * NotificationsActor keeps all unread messages for showing last unread messages in notifications < nl > * Actor also control sound effects playing logic < nl > * / < nl > @ @ - 407 , 7 + 408 , 11 @ @ public class NotificationsActor extends ModuleActor { < nl > / / Converting to PendingNotifications < nl > List < Notification > res = new ArrayList < > ( ) ; < nl > for ( PendingNotification p : destNotifications ) { < nl > - res . add ( new Notification ( p . getPeer ( ) , p . getSender ( ) , p . getContent ( ) ) ) ; < nl > + boolean isChannel = false ; < nl > + if ( p . getPeer ( ) . getPeerType ( ) = = PeerType . GROUP ) { < nl > + isChannel = groups ( ) . getValue ( p . getPeer ( ) . getPeerId ( ) ) . getGroupType ( ) = = GroupType . CHANNEL ; < nl > + } < nl > + res . add ( new Notification ( p . getPeer ( ) , isChannel , p . getSender ( ) , p . getContent ( ) ) ) ; < nl > } < nl > < nl > / / Performing notifications < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText . json b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText . json < nl > index 78f9d1a . . 53778a8 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText . json < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText . json < nl > @ @ - 107 , 6 + 107 , 27 @ @ < nl > 	 	 	 	 " avatar _ changed " : " { name } changed the group photo " , < nl > 	 	 	 	 " avatar _ removed " : " { name } removed the group photo " < nl > 	 	 	 } , < nl > + 	 	 	 " channels " : { < nl > + 	 	 	 	 " created " : " Channel created " , < nl > + 	 	 	 	 " invited " : " { name } invited { name _ added } " , < nl > + 	 	 	 	 " joined " : " { name } joined channel " , < nl > + 	 	 	 	 " kicked " : " { name } kicked { name _ kicked } " , < nl > + 	 	 	 	 " left " : " { name } left channel " , < nl > + 	 	 	 	 " title _ changed " : { < nl > + 	 	 	 	 	 " full " : " { name } changed the channel name to \ " { title } \ " " , < nl > + 	 	 	 	 	 " compact " : " { name } changed the channel name " < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " topic _ changed " : { < nl > + 	 	 	 	 	 " full " : " { name } changed the channel topic to \ " { topic } \ " " , < nl > + 	 	 	 	 	 " compact " : " { name } changed the channel topic " < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " about _ changed " : { < nl > + 	 	 	 	 	 " full " : " { name } changed the channel about to \ " { about } \ " " , < nl > + 	 	 	 	 	 " compact " : " { name } changed the channel about " < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " avatar _ changed " : " { name } changed the channel photo " , < nl > + 	 	 	 	 " avatar _ removed " : " { name } removed the channel photo " < nl > + 	 	 	 } , < nl > 	 	 	 " calls " : { < nl > 	 	 	 	 " missed " : " Missed call " , < nl > 	 	 	 	 " ended " : " Call ended " < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Ar . json b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Ar . json < nl > index 68524a5 . . 308c7b5 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Ar . json < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Ar . json < nl > @ @ - 94 , 6 + 94 , 27 @ @ < nl > 	 	 	 	 " avatar _ changed " : " { name } غ ي ر ص و ر ة ا ل م ج م و ع ة " , < nl > 	 	 	 	 " avatar _ removed " : " { name } ح ذ ف ص و ر ة ا ل م ج م و ع ة " < nl > 	 	 	 } , < nl > + 	 	 	 " channels " : { < nl > + 	 	 	 	 " created " : " ا ن ش أ ا ل م ج م و ع ة " , < nl > + 	 	 	 	 " invited " : " { name } د ع ى { name _ added } " , < nl > + 	 	 	 	 " joined " : " { name } ا ن ص م ل ل م ج م و ع ة " , < nl > + 	 	 	 	 " kicked " : " { name } ا ز ا ل { name _ kicked } " , < nl > + 	 	 	 	 " left " : " { name } غ ا د ر " , < nl > + 	 	 	 	 " title _ changed " : { < nl > + 	 	 	 	 	 " full " : " { name } غ ي ر ا ل ا س م ا ل ى \ " { title } \ " " , < nl > + 	 	 	 	 	 " compact " : " { name } غ ي ر ا س م ا ل م ج م و ع ة ا ل ى " < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " topic _ changed " : { < nl > + 	 	 	 	 	 " full " : " { name } changed the group topic to \ " { topic } \ " " , < nl > + 	 	 	 	 	 " compact " : " { name } changed the group topic " < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " about _ changed " : { < nl > + 	 	 	 	 	 " full " : " { name } changed the group about to \ " { about } \ " " , < nl > + 	 	 	 	 	 " compact " : " { name } changed the group about " < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " avatar _ changed " : " { name } غ ي ر ص و ر ة ا ل م ج م و ع ة " , < nl > + 	 	 	 	 " avatar _ removed " : " { name } ح ذ ف ص و ر ة ا ل م ج م و ع ة " < nl > + 	 	 	 } , < nl > 	 	 	 " calls " : { < nl > 	 	 	 	 " missed " : " Missed call " , < nl > 	 	 	 	 " ended " : " Call ended " < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Es . json b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Es . json < nl > index d3e2e67 . . 7cdcd77 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Es . json < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Es . json < nl > @ @ - 100 , 6 + 100 , 27 @ @ < nl > 	 	 	 	 " avatar _ changed " : " { name } modificada la foto de grupo " , < nl > 	 	 	 	 " avatar _ removed " : " { name } eliminada la foto de grupo " < nl > 	 	 	 } , < nl > + 	 	 	 " channels " : { < nl > + 	 	 	 	 " created " : " Creado el canal " , < nl > + 	 	 	 	 " invited " : " { name } invit ó a { name _ added } " , < nl > + 	 	 	 	 " joined " : " { name } se uni ó al canal " , < nl > + 	 	 	 	 " kicked " : " { name } expulsaste a { name _ kicked } " , < nl > + 	 	 	 	 " left " : " { name } elimino el canal " , < nl > + 	 	 	 	 " title _ changed " : { < nl > + 	 	 	 	 	 " full " : " { name } cambio el nombre del canal a \ " { title } \ " " , < nl > + 	 	 	 	 	 " compact " : " { name } a modificado el nombre del canal " < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " topic _ changed " : { < nl > + 	 	 	 	 	 " full " : " { name } changed the canal topic to \ " { topic } \ " " , < nl > + 	 	 	 	 	 " compact " : " { name } changed the canal topic " < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " about _ changed " : { < nl > + 	 	 	 	 	 " full " : " { name } changed the canal about to \ " { about } \ " " , < nl > + 	 	 	 	 	 " compact " : " { name } changed the canal about " < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " avatar _ changed " : " { name } modificada la foto de canal " , < nl > + 	 	 	 	 " avatar _ removed " : " { name } eliminada la foto de canal " < nl > + 	 	 	 } , < nl > 	 	 	 " calls " : { < nl > 	 	 	 	 " missed " : " Llamada perdida " , < nl > 	 	 	 	 " ended " : " Llamada finalizada " < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Fa . json b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Fa . json < nl > index 0a6b387 . . 0d663fe 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Fa . json < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Fa . json < nl > @ @ - 94 , 6 + 94 , 27 @ @ < nl > 	 	 	 	 " avatar _ changed " : " { name } ت ص و ی ر گ ر و ه ر ا ع و ض ک ر د " , < nl > 	 	 	 	 " avatar _ removed " : " { name } ت ص و ی ر گ ر و ه ر ا ع و ض ک ر د " < nl > 	 	 	 } , < nl > + 	 	 	 " channels " : { < nl > + 	 	 	 	 " created " : " گ ر و ه ر ا ا ی ج ا د ک ر د " , < nl > + 	 	 	 	 " invited " : " { name } { name _ added } ر ا د ع و ت ک ر د " , < nl > + 	 	 	 	 " joined " : " { name } ب ه گ ر و ه پ ی و س ت " , < nl > + 	 	 	 	 " kicked " : " { name } { name _ kicked } ر ا ا ز گ ر و ه ح ذ ف ک ر د " , < nl > + 	 	 	 	 " left " : " { name } ا ز گ ر و ه ر ف ت " , < nl > + 	 	 	 	 " title _ changed " : { < nl > + 	 	 	 	 	 " full " : " { name } ن ا م گ ر و ه ر ا ب ا \ " { title } \ " ج ا ی گ ز ی ن ک ر د " , < nl > + 	 	 	 	 	 " compact " : " { name } ن ا م گ ر و ه ر ا ج ا ی گ ز ی ن ک ر د " < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " topic _ changed " : { < nl > + 	 	 	 	 	 " full " : " ج ن ا ب { name } م و ض و ع گ ر و ه ر ا ب ا \ " { topic } \ " ج ا ی ‌ گ ز ی ن ک ر د ی د " , < nl > + 	 	 	 	 	 " compact " : " م و ض و ع گ ر و ه ر ا ع و ض ک ر د { name } " < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " about _ changed " : { < nl > + 	 	 	 	 	 " full " : " ج ن ا ب { name } م ت ن د ر ب ا ر ه گ ر و ه ر ا ب ا \ " { about } \ " ج ا ی ‌ گ ز ی ن ک ر د ی د " , < nl > + 	 	 	 	 	 " compact " : " م ت ن د ر ب ا ر ه گ ر و ه ر ا ع و ض ک ر د { name } " < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " avatar _ changed " : " { name } ت ص و ی ر گ ر و ه ر ا ع و ض ک ر د " , < nl > + 	 	 	 	 " avatar _ removed " : " { name } ت ص و ی ر گ ر و ه ر ا ع و ض ک ر د " < nl > + 	 	 	 } , < nl > 	 	 	 " calls " : { < nl > 	 	 	 	 " missed " : " ت م ا س ا ز د س ت ر ف ت ه " , < nl > 	 	 	 	 " ended " : " ت م ا س ت م ا م ش د " < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Pt . json b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Pt . json < nl > index b2704c9 . . f42f5e1 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Pt . json < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Pt . json < nl > @ @ - 107 , 6 + 107 , 27 @ @ < nl > 	 	 	 	 " avatar _ changed " : " { name } alterou a foto do grupo " , < nl > 	 	 	 	 " avatar _ removed " : " { name } removeu a foto do grupo " < nl > 	 	 	 } , < nl > + 	 	 	 " channels " : { < nl > + 	 	 	 	 " created " : " Criou o canal " , < nl > + 	 	 	 	 " invited " : " { name } convidado { name _ added } " , < nl > + 	 	 	 	 " joined " : " { name } entrou no canal " , < nl > + 	 	 	 	 " kicked " : " { name } removido { name _ kicked } " , < nl > + 	 	 	 	 " left " : " { name } saiu do canal " , < nl > + 	 	 	 	 " title _ changed " : { < nl > + 	 	 	 	 	 " full " : " { name } alterou o nome do canal para \ " { title } \ " " , < nl > + 	 	 	 	 	 " compact " : " { name } alterou o nome do canal " < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " topic _ changed " : { < nl > + 	 	 	 	 	 " full " : " { name } changed the canal topic to \ " { topic } \ " " , < nl > + 	 	 	 	 	 " compact " : " { name } changed the canal topic " < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " about _ changed " : { < nl > + 	 	 	 	 	 " full " : " { name } changed the canal about to \ " { about } \ " " , < nl > + 	 	 	 	 	 " compact " : " { name } changed the canal about " < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " avatar _ changed " : " { name } alterou a foto do canal " , < nl > + 	 	 	 	 " avatar _ removed " : " { name } removeu a foto do canal " < nl > + 	 	 	 } , < nl > 	 	 	 " calls " : { < nl > 	 	 	 	 " missed " : " Missed call " , < nl > 	 	 	 	 " ended " : " Call ended " < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Ru . json b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Ru . json < nl > index b4793ec . . 0f8bc7a 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Ru . json < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Ru . json < nl > @ @ - 160 , 10 + 160 , 10 @ @ < nl > 	 	 	 	 	 " other " : " { name } и з м е н и л ( - а ) н а з в а н и е г р у п п ы н а \ " { title } \ " " < nl > 	 	 	 	 	 } , < nl > 	 	 	 	 	 " compact " : { < nl > - 	 	 	 	 	 	 " you " : " { name } и з м е н и л и т е м у г р у п п ы " , < nl > - 	 	 	 	 	 	 " male " : " { name } и з м е н и л т е м у г р у п п ы " , < nl > - 	 	 	 	 	 	 " female " : " { name } и з м е н и л а т е м у г р у п п ы " , < nl > - 	 	 	 	 	 " other " : " { name } и з м е н и л ( - а ) т е м у г р у п п ы " < nl > + 	 	 	 	 	 	 " you " : " { name } и з м е н и л и н а з в а н и е г р у п п ы " , < nl > + 	 	 	 	 	 	 " male " : " { name } и з м е н и л н а з в а н и е г р у п п ы " , < nl > + 	 	 	 	 	 	 " female " : " { name } и з м е н и л а н а з в а н и е г р у п п ы " , < nl > + 	 	 	 	 	 " other " : " { name } и з м е н и л ( - а ) н а з в а н и е г р у п п ы " < nl > 	 	 	 	 	 } < nl > 	 	 	 	 } , < nl > 	 	 	 	 " topic _ changed " : { < nl > @ @ - 207 , 6 + 207 , 87 @ @ < nl > 	 	 	 	 " other " : " { name } у д а л и л ( - а ) ф о т о г р у п п ы " < nl > 	 	 	 	 } < nl > 	 	 	 } , < nl > + 	 	 	 " channels " : { < nl > + 	 	 	 	 " created " : " С о з д а н к а н а л " , < nl > + 	 	 	 	 " invited " : { < nl > + 	 	 	 	 	 " you " : " { name } п р и г л а с и л и { name _ added } " , < nl > + 	 	 	 	 	 " male " : " { name } п р и г л а с и л { name _ added } " , < nl > + 	 	 	 	 	 " female " : " { name } п р и г л а с и л а { name _ added } " , < nl > + 	 	 	 	 	 " other " : " { name } п р и г л а с и л ( - а ) { name _ added } " < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " joined " : { < nl > + 	 	 	 	 	 " you " : " { name } в о ш л и в к а н а л " , < nl > + 	 	 	 	 	 " male " : " { name } в о ш е л в к а н а л " , < nl > + 	 	 	 	 	 " female " : " { name } в о ш л а в к а н а л " , < nl > + 	 	 	 	 	 " other " : " { name } в о ш е л ( - ш л а ) в к а н а л " < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " kicked " : { < nl > + 	 	 	 	 	 " you " : " { name } и с к л ю ч и л и { name _ kicked } " , < nl > + 	 	 	 	 	 " male " : " { name } и с к л ю ч и л { name _ kicked } " , < nl > + 	 	 	 	 	 " female " : " { name } и с к л ю ч и л а { name _ kicked } " , < nl > + 	 	 	 	 	 " other " : " { name } и с к л ю ч и л ( - а ) { name _ kicked } " < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " left " : { < nl > + 	 	 	 	 	 " you " : " { name } п о к и н у л и к а н а л " , < nl > + 	 	 	 	 	 " male " : " { name } п о к и н у л к а н а л " , < nl > + 	 	 	 	 	 " female " : " { name } п о к и н у л а к а н а л " , < nl > + 	 	 	 	 	 " other " : " { name } п о к и н у л ( - а ) к а н а л " < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " title _ changed " : { < nl > + 	 	 	 	 	 " full " : { < nl > + 	 	 	 	 	 	 " you " : " { name } и з м е н и л и н а з в а н и е к а н а л а н а \ " { title } \ " " , < nl > + 	 	 	 	 	 	 " male " : " { name } и з м е н и л н а з в а н и е к а н а л а н а \ " { title } \ " " , < nl > + 	 	 	 	 	 	 " female " : " { name } и з м е н и л а н а з в а н и е к а н а л а н а \ " { title } \ " " , < nl > + 	 	 	 	 	 	 " other " : " { name } и з м е н и л ( - а ) н а з в а н и е к а н а л а н а \ " { title } \ " " < nl > + 	 	 	 	 	 } , < nl > + 	 	 	 	 	 " compact " : { < nl > + 	 	 	 	 	 	 " you " : " { name } и з м е н и л и н а з в а н и е к а н а л а " , < nl > + 	 	 	 	 	 	 " male " : " { name } и з м е н и л н а з в а н и е к а н а л а " , < nl > + 	 	 	 	 	 	 " female " : " { name } и з м е н и л а н а з в а н и е к а н а л а " , < nl > + 	 	 	 	 	 	 " other " : " { name } и з м е н и л ( - а ) н а з в а н и е к а н а л а " < nl > + 	 	 	 	 	 } < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " topic _ changed " : { < nl > + 	 	 	 	 	 " full " : { < nl > + 	 	 	 	 	 	 " you " : " { name } и з м е н и л и т е м у к а н а л а н а \ " { title } \ " " , < nl > + 	 	 	 	 	 	 " male " : " { name } и з м е н и л т е м у к а н а л а н а \ " { title } \ " " , < nl > + 	 	 	 	 	 	 " female " : " { name } и з м е н и л а т е м у к а н а л а н а \ " { title } \ " " , < nl > + 	 	 	 	 	 	 " other " : " { name } и з м е н и л ( - а ) т е м у к а н а л а н а \ " { title } \ " " < nl > + 	 	 	 	 	 } , < nl > + 	 	 	 	 	 " compact " : { < nl > + 	 	 	 	 	 	 " you " : " { name } и з м е н и л и т е м у к а н а л а " , < nl > + 	 	 	 	 	 	 " male " : " { name } и з м е н и л т е м у к а н а л а " , < nl > + 	 	 	 	 	 	 " female " : " { name } и з м е н и л а т е м у к а н а л а " , < nl > + 	 	 	 	 	 	 " other " : " { name } и з м е н и л ( - а ) т е м у к а н а л а " < nl > + 	 	 	 	 	 } < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " about _ changed " : { < nl > + 	 	 	 	 	 " full " : { < nl > + 	 	 	 	 	 	 " you " : " { name } и з м е н и л и о п и с а н и е к а н а л а н а \ " { title } \ " " , < nl > + 	 	 	 	 	 	 " male " : " { name } и з м е н и л о п и с а н и е к а н а л а н а \ " { title } \ " " , < nl > + 	 	 	 	 	 	 " female " : " { name } и з м е н и л а о п и с а н и е к а н а л а н а \ " { title } \ " " , < nl > + 	 	 	 	 	 	 " other " : " { name } и з м е н и л ( - а ) о п и с а н и е к а н а л а н а \ " { title } \ " " < nl > + 	 	 	 	 	 } , < nl > + 	 	 	 	 	 " compact " : { < nl > + 	 	 	 	 	 	 " you " : " { name } и з м е н и л и к а н а л а к а н а л а " , < nl > + 	 	 	 	 	 	 " male " : " { name } и з м е н и л о п и с а н и е к а н а л а " , < nl > + 	 	 	 	 	 	 " female " : " { name } и з м е н и л а о п и с а н и е к а н а л а " , < nl > + 	 	 	 	 	 	 " other " : " { name } и з м е н и л ( - а ) о п и с а н и е к а н а л а " < nl > + 	 	 	 	 	 } < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " avatar _ changed " : { < nl > + 	 	 	 	 	 " you " : " { name } и з м е н и л и ф о т о к а н а л а " , < nl > + 	 	 	 	 	 " male " : " { name } и з м е н и л ф о т о к а н а л а " , < nl > + 	 	 	 	 	 " female " : " { name } и з м е н и л а ф о т о к а н а л а " , < nl > + 	 	 	 	 	 " other " : " { name } и з м е н и л ( - а ) ф о т о к а н а л а " < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " avatar _ removed " : { < nl > + 	 	 	 	 	 " you " : " { name } у д а л и л и ф о т о к а н а л а " , < nl > + 	 	 	 	 	 " male " : " { name } у д а л и л ф о т о к а н а л а " , < nl > + 	 	 	 	 	 " female " : " { name } у д а л и л а ф о т о к а н а л а " , < nl > + 	 	 	 	 	 " other " : " { name } у д а л и л ( - а ) ф о т о к а н а л а " < nl > + 	 	 	 	 } < nl > + 	 	 	 } , < nl > 	 	 	 " calls " : { < nl > 	 	 	 	 " missed " : " П р о п у щ е н в ы з о в " , < nl > 	 	 	 	 " ended " : " В ы з о в з а в е р ш е н " < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Zn . json b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Zn . json < nl > index 38a30bf . . f253e8b 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Zn . json < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Zn . json < nl > @ @ - 101 , 6 + 101 , 27 @ @ < nl > 	 	 	 	 " avatar _ changed " : " { name } 修 改 了 群 组 头 像 " , < nl > 	 	 	 	 " avatar _ removed " : " { name } 删 除 了 群 组 头 像 " < nl > 	 	 	 } , < nl > + 	 	 	 " channels " : { < nl > + 	 	 	 	 " created " : " { name } 创 建 了 这 个 群 组 " , < nl > + 	 	 	 	 " invited " : " { name } 邀 请 { name _ added } " , < nl > + 	 	 	 	 " joined " : " { name } 加 入 群 组 " , < nl > + 	 	 	 	 " kicked " : " { name } 移 出 { name _ kicked } " , < nl > + 	 	 	 	 " left " : " { name } 退 出 群 组 " , < nl > + 	 	 	 	 " title _ changed " : { < nl > + 	 	 	 	 	 " full " : " { name } 修 改 为 名 称 为 ： \ " { title } \ " " , < nl > + 	 	 	 	 	 " compact " : " { name } 修 改 了 群 组 名 称 " < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " topic _ changed " : { < nl > + 	 	 	 	 	 " full " : " { name } changed the group topic to \ " { topic } \ " " , < nl > + 	 	 	 	 	 " compact " : " { name } changed the group topic " < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " about _ changed " : { < nl > + 	 	 	 	 	 " full " : " { name } changed the group about to \ " { about } \ " " , < nl > + 	 	 	 	 	 " compact " : " { name } changed the group about " < nl > + 	 	 	 	 } , < nl > + 	 	 	 	 " avatar _ changed " : " { name } 修 改 了 群 组 头 像 " , < nl > + 	 	 	 	 " avatar _ removed " : " { name } 删 除 了 群 组 头 像 " < nl > + 	 	 	 } , < nl > 	 	 	 " calls " : { < nl > 	 	 	 	 " missed " : " 未 接 电 话 " , < nl > 	 	 	 	 " ended " : " 拨 号 结 束 "
NEAREST DIFF (one line): diff - - git a / actor - sdk / sdk - bot / bot - example / build . gradle b / actor - sdk / sdk - bot / bot - example / build . gradle < nl > index c5bc200 . . 455e3ad 100644 < nl > - - - a / actor - sdk / sdk - bot / bot - example / build . gradle < nl > + + + b / actor - sdk / sdk - bot / bot - example / build . gradle < nl > @ @ - 13 , 7 + 13 , 7 @ @ repositories { < nl > } < nl > < nl > dependencies { < nl > - compile group : ' im . actor ' , name : ' actor - botkit ' , version : ' 1 . 0 . 21 ' < nl > - compile group : ' im . actor ' , name : ' shardakka ' , version : ' 0 . 1 . 5 ' < nl > + compile group : ' im . actor ' , name : ' actor - botkit ' , version : ' 1 . 0 . + ' < nl > + compile group : ' im . actor ' , name : ' shardakka ' , version : ' 0 . 1 . + ' < nl > testCompile group : ' junit ' , name : ' junit ' , version : ' 4 . 11 ' < nl > } < nl > diff - - git a / actor - sdk / sdk - core - android / android - app / build . gradle b / actor - sdk / sdk - core - android / android - app / build . gradle < nl > index fb61035 . . bcdbf65 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - app / build . gradle < nl > + + + b / actor - sdk / sdk - core - android / android - app / build . gradle < nl > @ @ - 22 , 6 + 22 , 10 @ @ android { < nl > proguardFiles getDefaultProguardFile ( ' proguard - android . txt ' ) , ' proguard - rules . pro ' < nl > } < nl > } < nl > + < nl > + lintOptions { < nl > + abortOnError false < nl > + } < nl > } < nl > < nl > dependencies { < nl > diff - - git a / actor - sdk / sdk - core - android / android - app / src / main / res / layout / activity _ main . xml b / actor - sdk / sdk - core - android / android - app / src / main / res / layout / activity _ main . xml < nl > deleted file mode 100644 < nl > index 5693318 . . 0000000 < nl > - - - a / actor - sdk / sdk - core - android / android - app / src / main / res / layout / activity _ main . xml < nl > + + + / dev / null < nl > @ @ - 1 , 11 + 0 , 0 @ @ < nl > - < RelativeLayout xmlns : android = " http : / / schemas . android . com / apk / res / android " < nl > - xmlns : tools = " http : / / schemas . android . com / tools " android : layout _ width = " match _ parent " < nl > - android : layout _ height = " match _ parent " android : paddingLeft = " @ dimen / activity _ horizontal _ margin " < nl > - android : paddingRight = " @ dimen / activity _ horizontal _ margin " < nl > - android : paddingTop = " @ dimen / activity _ vertical _ margin " < nl > - android : paddingBottom = " @ dimen / activity _ vertical _ margin " tools : context = " im . actor . MainActivity " > < nl > - < nl > - < TextView android : text = " @ string / hello _ world " android : layout _ width = " wrap _ content " < nl > - android : layout _ height = " wrap _ content " / > < nl > - < nl > - < / RelativeLayout > < nl > diff - - git a / actor - sdk / sdk - core - android / android - app / src / main / res / menu / menu _ main . xml b / actor - sdk / sdk - core - android / android - app / src / main / res / menu / menu _ main . xml < nl > deleted file mode 100644 < nl > index 5f66cab . . 0000000 < nl > - - - a / actor - sdk / sdk - core - android / android - app / src / main / res / menu / menu _ main . xml < nl > + + + / dev / null < nl > @ @ - 1 , 6 + 0 , 0 @ @ < nl > - < menu xmlns : android = " http : / / schemas . android . com / apk / res / android " < nl > - xmlns : app = " http : / / schemas . android . com / apk / res - auto " < nl > - xmlns : tools = " http : / / schemas . android . com / tools " tools : context = " im . actor . MainActivity " > < nl > - < item android : id = " @ + id / action _ settings " android : title = " @ string / action _ settings " < nl > - android : orderInCategory = " 100 " app : showAsAction = " never " / > < nl > - < / menu > < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / build . gradle b / actor - sdk / sdk - core - android / android - sdk / build . gradle < nl > index 0953b49 . . d7e97dc 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / build . gradle < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / build . gradle < nl > @ @ - 1 , 29 + 1 , 10 @ @ < nl > - < nl > - < nl > - repositories { < nl > - mavenCentral ( ) < nl > - jcenter ( ) < nl > - maven { url ' https : / / mint . splunk . com / gradle / ' } < nl > - } < nl > - < nl > buildscript { < nl > dependencies { < nl > classpath ' com . android . tools . build : gradle : 1 . 3 . 0 ' < nl > - / / classpath ' com . neenbedankt . gradle . plugins : android - apt : 1 . 7 ' < nl > } < nl > } < nl > < nl > apply plugin : ' com . android . library ' < nl > - / / apply plugin : ' com . neenbedankt . android - apt ' < nl > - < nl > - def basicVersion = ' 1 . 0 ' < nl > - def customVersionCode = ' 10240 ' ; < nl > - if ( project . hasProperty ( ' buildIndex ' ) ) { < nl > - project . version = basicVersion + ' . ' + project . buildIndex < nl > - customVersionCode = ' ' + project . buildIndex < nl > - } else { < nl > - project . version = ' debug ' < nl > - } < nl > < nl > android { < nl > < nl > @ @ - 33 , 12 + 14 , 12 @ @ android { < nl > defaultConfig { < nl > minSdkVersion 15 < nl > targetSdkVersion 23 < nl > - versionCode Integer . valueOf ( customVersionCode ) < nl > - versionName project . version < nl > } < nl > < nl > - signingConfigs { < nl > - release < nl > + sourceSets { < nl > + main { < nl > + res . srcDirs = [ ' src / main / res ' , ' src / themes / main ' , ' src / material - icons ' ] < nl > + } < nl > } < nl > < nl > / / buildTypes { < nl > @ @ - 132 , 9 + 113 , 9 @ @ android { < nl > / / targetCompatibility JavaVersion . VERSION _ 1 _ 6 < nl > / / } < nl > / / < nl > - / / lintOptions { < nl > - / / abortOnError false < nl > - / / } < nl > + lintOptions { < nl > + abortOnError false < nl > + } < nl > } < nl > < nl > dependencies { < nl > @ @ - 143 , 44 + 124 , 30 @ @ dependencies { < nl > compile project ( ' : actor - sdk : sdk - core : core : android ' ) < nl > compile ' com . droidkit : progress : 0 . 5 ' < nl > compile ' com . soundcloud . android : android - crop : 1 . 0 . 0 @ aar ' < nl > - compile ' com . facebook . fresco : fresco : 0 . 1 . 0 ' < nl > - compile ' com . facebook . rebound : rebound : 0 . 3 . 7 ' < nl > - compile ( ' com . github . chrisbanes . photoview : library : 1 . 2 . 3 ' ) { < nl > + compile ' com . facebook . fresco : fresco : 0 + ' < nl > + compile ' com . facebook . rebound : rebound : 0 + ' < nl > + compile ( ' com . github . chrisbanes . photoview : library : 1 + ' ) { < nl > exclude module : ' support - v13 ' < nl > } < nl > - compile ' com . getbase : floatingactionbutton : 1 . 5 . 1 ' < nl > - compile ' com . afollestad : material - dialogs : 0 . 7 . 3 . 1 ' < nl > - compile ' org . pegdown : pegdown : 1 . 5 . 0 ' < nl > + compile ' com . getbase : floatingactionbutton : 1 + ' < nl > + compile ' com . afollestad : material - dialogs : 0 + ' < nl > + compile ' org . pegdown : pegdown : 1 + ' < nl > < nl > / / Phone parser < nl > compile files ( ' libs / libphonenumber - 5 . 9 . jar ' ) < nl > < nl > / / Android Support < nl > - compile ' com . android . support : support - v4 : 23 . 0 . 1 ' < nl > - compile ' com . android . support : support - v13 : 23 . 0 . 1 ' < nl > - compile ' com . android . support : appcompat - v7 : 23 . 0 . 1 ' < nl > - compile ' com . android . support : palette - v7 : 23 . 0 . 1 ' < nl > - compile ' com . android . support : recyclerview - v7 : 23 . 0 . 1 ' < nl > + compile ' com . android . support : support - v4 : 23 + ' < nl > + compile ' com . android . support : support - v13 : 23 + ' < nl > + compile ' com . android . support : appcompat - v7 : 23 + ' < nl > + compile ' com . android . support : palette - v7 : 23 + ' < nl > + compile ' com . android . support : recyclerview - v7 : 23 + ' < nl > < nl > - / / GCM < nl > - releaseCompile ' com . google . android . gms : play - services - gcm : 7 . 5 . 0 ' < nl > - debugCompile ' com . google . android . gms : play - services - gcm : 7 . 5 . 0 ' < nl > - < nl > - / / Integration < nl > + / / / / GCM < nl > + / / releaseCompile ' com . google . android . gms : play - services - gcm : 7 . 8 . 0 ' < nl > + / / debugCompile ' com . google . android . gms : play - services - gcm : 7 . 8 . 0 ' < nl > < nl > / / / / Annotation processing < nl > / / apt " org . androidannotations : androidannotations : 3 . 3 . 2 " < nl > / / compile " org . androidannotations : androidannotations - api : 3 . 3 . 2 " < nl > - } < nl > - < nl > - task dist ( dependsOn : [ ' assembleRelease ' , ' assembleFree ' ] ) { < nl > - doFirst { < nl > - println " # # teamcity [ buildNumber ' $ { project . version } ' ] " < nl > - } < nl > - } < nl > - < nl > - def getDate ( ) { < nl > - def date = new Date ( ) < nl > - def formattedDate = date . format ( ' dd / MM / yy HH : mm : ss ' ) < nl > - return formattedDate < nl > - } < nl > + } < nl > \ No newline at end of file < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / messenger / app / core / ActorSDK . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / messenger / app / core / ActorSDK . java < nl > index 659f9c5 . . 2fcfd7f 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / messenger / app / core / ActorSDK . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / messenger / app / core / ActorSDK . java < nl > @ @ - 14 , 7 + 14 , 6 @ @ import org . json . JSONException ; < nl > import java . io . IOException ; < nl > < nl > import im . actor . core . AndroidMessenger ; < nl > - import im . actor . core . AndroidPushActor ; < nl > import im . actor . core . ApiConfiguration ; < nl > import im . actor . core . ConfigurationBuilder ; < nl > import im . actor . core . DeviceCategory ; < nl > @ @ - 23 , 7 + 22 , 6 @ @ import im . actor . core . entity . Group ; < nl > import im . actor . core . entity . User ; < nl > import im . actor . core . viewmodel . GroupVM ; < nl > import im . actor . core . viewmodel . UserVM ; < nl > - import im . actor . messenger . BuildConfig ; < nl > import im . actor . messenger . app . AppContext ; < nl > import im . actor . messenger . app . activity . ActorMainActivity ; < nl > import im . actor . messenger . app . view . emoji . SmileProcessor ; < nl > @ @ - 54 , 13 + 52 , 13 @ @ public class ActorSDK { < nl > < nl > Fresco . initialize ( application ) ; < nl > < nl > - / / Keep Alive < nl > - if ( BuildConfig . ENABLE _ KEEP _ ALIVE ) { < nl > - Intent keepAliveService = new Intent ( application , KeepAliveService . class ) ; < nl > - PendingIntent pintent = PendingIntent . getService ( application , 0 , keepAliveService , 0 ) ; < nl > - AlarmManager alarm = ( AlarmManager ) application . getSystemService ( Context . ALARM _ SERVICE ) ; < nl > - alarm . setRepeating ( AlarmManager . RTC , System . currentTimeMillis ( ) , 30 * 1000 , pintent ) ; < nl > - } < nl > + / / / / Keep Alive < nl > + / / if ( BuildConfig . ENABLE _ KEEP _ ALIVE ) { < nl > + / / Intent keepAliveService = new Intent ( application , KeepAliveService . class ) ; < nl > + / / PendingIntent pintent = PendingIntent . getService ( application , 0 , keepAliveService , 0 ) ; < nl > + / / AlarmManager alarm = ( AlarmManager ) application . getSystemService ( Context . ALARM _ SERVICE ) ; < nl > + / / alarm . setRepeating ( AlarmManager . RTC , System . currentTimeMillis ( ) , 30 * 1000 , pintent ) ; < nl > + / / } < nl > < nl > / / Helpers < nl > AppContext . setContext ( application ) ; < nl > @ @ - 86 , 15 + 84 , 14 @ @ public class ActorSDK { < nl > AppContext . getContext ( ) . getPackageName ( ) + " : " + Build . SERIAL ) ) ; < nl > this . messenger = new AndroidMessenger ( AppContext . getContext ( ) , builder . build ( ) ) ; < nl > < nl > - if ( getGcmProjectId ( ) ! = - 1 ) { < nl > - androidPushesActor = system ( ) . actorOf ( Props . create ( AndroidPushActor . class , new ActorCreator < AndroidPushActor > ( ) { < nl > - @ Override < nl > - public AndroidPushActor create ( ) { < nl > - return new AndroidPushActor ( application , sdk . messenger ) ; < nl > - } < nl > - } ) , " actor / android / push " ) ; < nl > - } < nl > - < nl > + / / if ( getGcmProjectId ( ) ! = - 1 ) { < nl > + / / androidPushesActor = system ( ) . actorOf ( Props . create ( AndroidPushActor . class , new ActorCreator < AndroidPushActor > ( ) { < nl > + / / @ Override < nl > + / / public AndroidPushActor create ( ) { < nl > + / / return new AndroidPushActor ( application , sdk . messenger ) ; < nl > + / / } < nl > + / / } ) , " actor / android / push " ) ; < nl > + / / } < nl > } < nl > < nl > public static ActorSDK sharedActor ( ) { < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / messenger / app / fragment / help / HelpFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / messenger / app / fragment / help / HelpFragment . java < nl > index a645e18 . . 92f461b 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / messenger / app / fragment / help / HelpFragment . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / messenger / app / fragment / help / HelpFragment . java < nl > @ @ - 10 , 7 + 10 , 6 @ @ import android . view . ViewGroup ; < nl > import android . widget . TextView ; < nl > import android . widget . Toast ; < nl > < nl > - import im . actor . messenger . BuildConfig ; < nl > import im . actor . messenger . R ; < nl > import im . actor . messenger . app . fragment . BaseFragment ; < nl > < nl > @ @ - 46 , 18 + 45 , 18 @ @ public class HelpFragment extends BaseFragment { < nl > } < nl > } ) ; < nl > < nl > - final String versionName = BuildConfig . VERSION _ TITLE ; < nl > - ( ( TextView ) res . findViewById ( R . id . version ) ) . setText ( versionName ) ; < nl > - res . findViewById ( R . id . versionItem ) . setOnLongClickListener ( new View . OnLongClickListener ( ) { < nl > - @ Override < nl > - public boolean onLongClick ( View v ) { < nl > - android . content . ClipboardManager clipboard = ( android . content . ClipboardManager ) getActivity ( ) . getSystemService ( Context . CLIPBOARD _ SERVICE ) ; < nl > - android . content . ClipData clip = android . content . ClipData . newPlainText ( " App version " , versionName ) ; < nl > - clipboard . setPrimaryClip ( clip ) ; < nl > - Toast . makeText ( getActivity ( ) , R . string . help _ version _ copy , Toast . LENGTH _ SHORT ) . show ( ) ; < nl > - return true ; < nl > - } < nl > - } ) ; < nl > + / / final String versionName = BuildConfig . VERSION _ TITLE ; < nl > + / / ( ( TextView ) res . findViewById ( R . id . version ) ) . setText ( versionName ) ; < nl > + / / res . findViewById ( R . id . versionItem ) . setOnLongClickListener ( new View . OnLongClickListener ( ) { < nl > + / / @ Override < nl > + / / public boolean onLongClick ( View v ) { < nl > + / / android . content . ClipboardManager clipboard = ( android . content . ClipboardManager ) getActivity ( ) . getSystemService ( Context . CLIPBOARD _ SERVICE ) ; < nl > + / / android . content . ClipData clip = android . content . ClipData . newPlainText ( " App version " , versionName ) ; < nl > + / / clipboard . setPrimaryClip ( clip ) ; < nl > + / / Toast . makeText ( getActivity ( ) , R . string . help _ version _ copy , Toast . LENGTH _ SHORT ) . show ( ) ; < nl > + / / return true ; < nl > + / / } < nl > + / / } ) ; < nl > return res ; < nl > } < nl > } < nl > diff - - git a / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / internal / messages / ConversationActor . java b / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / internal / messages / ConversationActor . java < nl > index 5f112bd . . c6cf715 100644 < nl > - - - a / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / internal / messages / ConversationActor . java < nl > + + + b / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / internal / messages / ConversationActor . java < nl > @ @ - 139 , 8 + 139 , 7 @ @ public class ConversationActor extends ModuleActor { < nl > if ( ! isHiddenPeer ) { < nl > dialogsActor . send ( new DialogsActor . InMessage ( peer , topMessage , inPendingIndex . getCount ( ) ) ) ; < nl > } < nl > - dialogsGroupedActor . send ( new GroupedDialogsActor . NewMessage ( peer , inPendingIndex . getCount ( ) , < nl > - topMessage . getSortDate ( ) ) ) ; < nl > + dialogsGroupedActor . send ( new GroupedDialogsActor . CounterChanged ( peer , inPendingIndex . getCount ( ) ) ) ; < nl > } < nl > } < nl > < nl > @ @ - 190 , 8 + 189 , 7 @ @ public class ConversationActor extends ModuleActor { < nl > if ( ! isHiddenPeer ) { < nl > dialogsActor . send ( new DialogsActor . InMessage ( peer , message , inPendingIndex . getCount ( ) ) ) ; < nl > } < nl > - dialogsGroupedActor . send ( new GroupedDialogsActor . NewMessage ( peer , inPendingIndex . getCount ( ) , < nl > - message . getSortDate ( ) ) ) ; < nl > + dialogsGroupedActor . send ( new GroupedDialogsActor . CounterChanged ( peer , inPendingIndex . getCount ( ) ) ) ; < nl > } < nl > } < nl > < nl > @ @ - 245 , 8 + 243 , 7 @ @ public class ConversationActor extends ModuleActor { < nl > if ( ! isHiddenPeer ) { < nl > / / Updating dialog < nl > dialogsActor . send ( new DialogsActor . InMessage ( peer , updatedMsg , inPendingIndex . getCount ( ) ) ) ; < nl > - dialogsGroupedActor . send ( new GroupedDialogsActor . NewMessage ( peer , inPendingIndex . getCount ( ) , < nl > - updatedMsg . getSortDate ( ) ) ) ; < nl > + dialogsGroupedActor . send ( new GroupedDialogsActor . CounterChanged ( peer , inPendingIndex . getCount ( ) ) ) ; < nl > } < nl > < nl > / / Updating pending index < nl > diff - - git a / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / internal / users / UsersProcessor . java b / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / internal / users / UsersProcessor . java < nl > deleted file mode 100644 < nl > index dfbc311 . . 0000000 < nl > - - - a / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / internal / users / UsersProcessor . java < nl > + + + / dev / null < nl > @ @ - 1 , 204 + 0 , 0 @ @ < nl > - package im . actor . core . modules . internal . users ; < nl > - < nl > - import java . util . ArrayList ; < nl > - import java . util . Collection ; < nl > - < nl > - import im . actor . core . api . ApiAvatar ; < nl > - import im . actor . core . api . ApiUser ; < nl > - import im . actor . core . api . updates . UpdateUserAboutChanged ; < nl > - import im . actor . core . api . updates . UpdateUserAvatarChanged ; < nl > - import im . actor . core . api . updates . UpdateUserLocalNameChanged ; < nl > - import im . actor . core . api . updates . UpdateUserNameChanged ; < nl > - import im . actor . core . api . updates . UpdateUserNickChanged ; < nl > - import im . actor . core . entity . Peer ; < nl > - import im . actor . core . entity . User ; < nl > - import im . actor . core . modules . AbsModule ; < nl > - import im . actor . core . modules . ModuleContext ; < nl > - import im . actor . core . modules . Processor ; < nl > - import im . actor . core . modules . internal . contacts . ContactsSyncActor ; < nl > - import im . actor . core . modules . internal . messages . DialogsActor ; < nl > - import im . actor . core . modules . internal . messages . GroupedDialogsActor ; < nl > - import im . actor . runtime . annotations . Verified ; < nl > - < nl > - import static im . actor . core . util . JavaUtil . equalsE ; < nl > - < nl > - public class UsersProcessor extends AbsModule implements Processor { < nl > - < nl > - public UsersProcessor ( ModuleContext context ) { < nl > - super ( context ) ; < nl > - } < nl > - < nl > - @ Verified < nl > - public void applyUsers ( Collection < ApiUser > updated , boolean forced ) { < nl > - ArrayList < User > batch = new ArrayList < User > ( ) ; < nl > - for ( ApiUser u : updated ) { < nl > - < nl > - User saved = users ( ) . getValue ( u . getId ( ) ) ; < nl > - if ( saved = = null ) { < nl > - batch . add ( new User ( u ) ) ; < nl > - } else if ( forced ) { < nl > - User upd = new User ( u ) ; < nl > - batch . add ( upd ) ; < nl > - < nl > - / / Sending changes to dialogs < nl > - if ( ! upd . getName ( ) . equals ( saved . getName ( ) ) | | < nl > - ! equalsE ( upd . getAvatar ( ) , saved . getAvatar ( ) ) ) { < nl > - onUserDescChanged ( upd ) ; < nl > - } < nl > - } < nl > - } < nl > - if ( batch . size ( ) > 0 ) { < nl > - users ( ) . addOrUpdateItems ( batch ) ; < nl > - } < nl > - } < nl > - < nl > - < nl > - @ Verified < nl > - public boolean hasUsers ( Collection < Integer > uids ) { < nl > - for ( Integer uid : uids ) { < nl > - if ( users ( ) . getValue ( uid ) = = null ) { < nl > - return false ; < nl > - } < nl > - } < nl > - return true ; < nl > - } < nl > - < nl > - @ Verified < nl > - private void onUserNameChanged ( int uid , String name ) { < nl > - User u = users ( ) . getValue ( uid ) ; < nl > - if ( u ! = null ) { < nl > - < nl > - / / Ignore if name not changed < nl > - if ( u . getServerName ( ) . equals ( name ) ) { < nl > - return ; < nl > - } < nl > - < nl > - / / Changing user name < nl > - u = u . editName ( name ) ; < nl > - < nl > - / / Updating user in collection < nl > - users ( ) . addOrUpdateItem ( u ) ; < nl > - < nl > - / / Notify if user doesn ' t have local name < nl > - if ( u . getLocalName ( ) = = null ) { < nl > - onUserDescChanged ( u ) ; < nl > - } < nl > - } < nl > - } < nl > - < nl > - @ Verified < nl > - private void onUserNickChanged ( int uid , String nick ) { < nl > - User u = users ( ) . getValue ( uid ) ; < nl > - if ( u ! = null ) { < nl > - < nl > - / / Ignore if name not changed < nl > - if ( equalsE ( u . getNick ( ) , nick ) ) { < nl > - return ; < nl > - } < nl > - < nl > - / / Changing user name < nl > - u = u . editNick ( nick ) ; < nl > - < nl > - / / Updating user in collection < nl > - users ( ) . addOrUpdateItem ( u ) ; < nl > - } < nl > - } < nl > - < nl > - @ Verified < nl > - private void onUserAboutChanged ( int uid , String about ) { < nl > - User u = users ( ) . getValue ( uid ) ; < nl > - if ( u ! = null ) { < nl > - < nl > - / / Ignore if name not changed < nl > - if ( equalsE ( u . getAbout ( ) , about ) ) { < nl > - return ; < nl > - } < nl > - < nl > - / / Changing about information < nl > - u = u . editAbout ( about ) ; < nl > - < nl > - / / Updating user in collection < nl > - users ( ) . addOrUpdateItem ( u ) ; < nl > - } < nl > - } < nl > - < nl > - @ Verified < nl > - private void onUserLocalNameChanged ( int uid , String name ) { < nl > - User u = users ( ) . getValue ( uid ) ; < nl > - if ( u ! = null ) { < nl > - < nl > - / / Ignore if local name not changed < nl > - if ( equalsE ( u . getLocalName ( ) , name ) ) { < nl > - return ; < nl > - } < nl > - < nl > - / / Changing user local name < nl > - u = u . editLocalName ( name ) ; < nl > - < nl > - / / Updating user in collection < nl > - users ( ) . addOrUpdateItem ( u ) ; < nl > - < nl > - / / Notify about user change < nl > - onUserDescChanged ( u ) ; < nl > - } < nl > - } < nl > - < nl > - @ Verified < nl > - private void onUserAvatarChanged ( int uid , ApiAvatar avatar ) { < nl > - User u = users ( ) . getValue ( uid ) ; < nl > - if ( u ! = null ) { < nl > - < nl > - / / Ignore if avatar not changed < nl > - / / Disabled because of future - compatibility it is unable to check equality < nl > - / / if ( equalsE ( u . getAvatar ( ) , new im . actor . model . entity . Avatar ( avatar ) ) ) { < nl > - / / return ; < nl > - / / } < nl > - < nl > - / / Changing user avatar < nl > - u = u . editAvatar ( avatar ) ; < nl > - < nl > - / / Updating user in collection < nl > - users ( ) . addOrUpdateItem ( u ) ; < nl > - < nl > - / / Notify about user change < nl > - onUserDescChanged ( u ) ; < nl > - } < nl > - } < nl > - < nl > - @ Override < nl > - public boolean process ( Object update ) { < nl > - if ( update instanceof UpdateUserNameChanged ) { < nl > - UpdateUserNameChanged userNameChanged = ( UpdateUserNameChanged ) update ; < nl > - onUserNameChanged ( userNameChanged . getUid ( ) , userNameChanged . getName ( ) ) ; < nl > - return true ; < nl > - } else if ( update instanceof UpdateUserLocalNameChanged ) { < nl > - UpdateUserLocalNameChanged localNameChanged = ( UpdateUserLocalNameChanged ) update ; < nl > - onUserLocalNameChanged ( localNameChanged . getUid ( ) , localNameChanged . getLocalName ( ) ) ; < nl > - return true ; < nl > - } else if ( update instanceof UpdateUserNickChanged ) { < nl > - UpdateUserNickChanged nickChanged = ( UpdateUserNickChanged ) update ; < nl > - onUserNickChanged ( nickChanged . getUid ( ) , nickChanged . getNickname ( ) ) ; < nl > - return true ; < nl > - } else if ( update instanceof UpdateUserAboutChanged ) { < nl > - UpdateUserAboutChanged userAboutChanged = ( UpdateUserAboutChanged ) update ; < nl > - onUserAboutChanged ( userAboutChanged . getUid ( ) , userAboutChanged . getAbout ( ) ) ; < nl > - return true ; < nl > - } else if ( update instanceof UpdateUserAvatarChanged ) { < nl > - UpdateUserAvatarChanged avatarChanged = ( UpdateUserAvatarChanged ) update ; < nl > - onUserAvatarChanged ( avatarChanged . getUid ( ) , avatarChanged . getAvatar ( ) ) ; < nl > - return true ; < nl > - } < nl > - return false ; < nl > - } < nl > - < nl > - @ Verified < nl > - private void onUserDescChanged ( User u ) { < nl > - context ( ) . getMessagesModule ( ) . getDialogsActor ( ) . send ( < nl > - new DialogsActor . UserChanged ( u ) ) ; < nl > - context ( ) . getMessagesModule ( ) . getDialogsGroupedActor ( ) . send ( < nl > - new GroupedDialogsActor . PeerInformationChanged ( Peer . user ( u . getUid ( ) ) , < nl > - u . getName ( ) , u . getAvatar ( ) ) ) ; < nl > - context ( ) . getContactsModule ( ) . getContactSyncActor ( ) < nl > - . send ( new ContactsSyncActor . UserChanged ( u ) ) ; < nl > - } < nl > - } < nl > diff - - git a / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / updates / GroupsProcessor . java b / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / updates / GroupsProcessor . java < nl > index e430293 . . 4bc95f0 100644 < nl > - - - a / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / updates / GroupsProcessor . java < nl > + + + b / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / updates / GroupsProcessor . java < nl > @ @ - 301 , 7 + 301 , 6 @ @ public class GroupsProcessor extends AbsModule { < nl > context ( ) . getMessagesModule ( ) . getDialogsActor ( ) < nl > . send ( new DialogsActor . GroupChanged ( group ) ) ; < nl > context ( ) . getMessagesModule ( ) . getDialogsGroupedActor ( ) . send ( < nl > - new GroupedDialogsActor . PeerInformationChanged ( Peer . group ( group . getGroupId ( ) ) , < nl > - group . getTitle ( ) , group . getAvatar ( ) ) ) ; < nl > + new GroupedDialogsActor . PeerInformationChanged ( Peer . group ( group . getGroupId ( ) ) ) ) ; < nl > } < nl > } < nl > \ No newline at end of file < nl > diff - - git a / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / updates / UpdateProcessor . java b / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / updates / UpdateProcessor . java < nl > index 9ab6741 . . 8a2998c 100644 < nl > - - - a / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / updates / UpdateProcessor . java < nl > + + + b / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / updates / UpdateProcessor . java < nl > @ @ - 49 , 7 + 49 , 6 @ @ import im . actor . core . modules . AbsModule ; < nl > import im . actor . core . modules . ModuleContext ; < nl > import im . actor . core . modules . internal . contacts . ContactsSyncActor ; < nl > import im . actor . core . modules . internal . messages . OwnReadActor ; < nl > - import im . actor . core . modules . internal . users . UsersProcessor ; < nl > import im . actor . core . modules . updates . internal . CombinedDifference ; < nl > import im . actor . core . modules . updates . internal . ContactsLoaded ; < nl > import im . actor . core . modules . updates . internal . DialogHistoryLoaded ; < nl > diff - - git a / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / updates / UsersProcessor . java b / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / updates / UsersProcessor . java < nl > new file mode 100644 < nl > index 0000000 . . 6582775 < nl > - - - / dev / null < nl > + + + b / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / updates / UsersProcessor . java < nl > @ @ - 0 , 0 + 1 , 203 @ @ < nl > + package im . actor . core . modules . updates ; < nl > + < nl > + import java . util . ArrayList ; < nl > + import java . util . Collection ; < nl > + < nl > + import im . actor . core . api . ApiAvatar ; < nl > + import im . actor . core . api . ApiUser ; < nl > + import im . actor . core . api . updates . UpdateUserAboutChanged ; < nl > + import im . actor . core . api . updates . UpdateUserAvatarChanged ; < nl > + import im . actor . core . api . updates . UpdateUserLocalNameChanged ; < nl > + import im . actor . core . api . updates . UpdateUserNameChanged ; < nl > + import im . actor . core . api . updates . UpdateUserNickChanged ; < nl > + import im . actor . core . entity . Peer ; < nl > + import im . actor . core . entity . User ; < nl > + import im . actor . core . modules . AbsModule ; < nl > + import im . actor . core . modules . ModuleContext ; < nl > + import im . actor . core . modules . Processor ; < nl > + import im . actor . core . modules . internal . contacts . ContactsSyncActor ; < nl > + import im . actor . core . modules . internal . messages . DialogsActor ; < nl > + import im . actor . core . modules . internal . messages . GroupedDialogsActor ; < nl > + import im . actor . runtime . annotations . Verified ; < nl > + < nl > + import static im . actor . core . util . JavaUtil . equalsE ; < nl > + < nl > + public class UsersProcessor extends AbsModule implements Processor { < nl > + < nl > + public UsersProcessor ( ModuleContext context ) { < nl > + super ( context ) ; < nl > + } < nl > + < nl > + @ Verified < nl > + public void applyUsers ( Collection < ApiUser > updated , boolean forced ) { < nl > + ArrayList < User > batch = new ArrayList < User > ( ) ; < nl > + for ( ApiUser u : updated ) { < nl > + < nl > + User saved = users ( ) . getValue ( u . getId ( ) ) ; < nl > + if ( saved = = null ) { < nl > + batch . add ( new User ( u ) ) ; < nl > + } else if ( forced ) { < nl > + User upd = new User ( u ) ; < nl > + batch . add ( upd ) ; < nl > + < nl > + / / Sending changes to dialogs < nl > + if ( ! upd . getName ( ) . equals ( saved . getName ( ) ) | | < nl > + ! equalsE ( upd . getAvatar ( ) , saved . getAvatar ( ) ) ) { < nl > + onUserDescChanged ( upd ) ; < nl > + } < nl > + } < nl > + } < nl > + if ( batch . size ( ) > 0 ) { < nl > + users ( ) . addOrUpdateItems ( batch ) ; < nl > + } < nl > + } < nl > + < nl > + < nl > + @ Verified < nl > + public boolean hasUsers ( Collection < Integer > uids ) { < nl > + for ( Integer uid : uids ) { < nl > + if ( users ( ) . getValue ( uid ) = = null ) { < nl > + return false ; < nl > + } < nl > + } < nl > + return true ; < nl > + } < nl > + < nl > + @ Verified < nl > + private void onUserNameChanged ( int uid , String name ) { < nl > + User u = users ( ) . getValue ( uid ) ; < nl > + if ( u ! = null ) { < nl > + < nl > + / / Ignore if name not changed < nl > + if ( u . getServerName ( ) . equals ( name ) ) { < nl > + return ; < nl > + } < nl > + < nl > + / / Changing user name < nl > + u = u . editName ( name ) ; < nl > + < nl > + / / Updating user in collection < nl > + users ( ) . addOrUpdateItem ( u ) ; < nl > + < nl > + / / Notify if user doesn ' t have local name < nl > + if ( u . getLocalName ( ) = = null ) { < nl > + onUserDescChanged ( u ) ; < nl > + } < nl > + } < nl > + } < nl > + < nl > + @ Verified < nl > + private void onUserNickChanged ( int uid , String nick ) { < nl > + User u = users ( ) . getValue ( uid ) ; < nl > + if ( u ! = null ) { < nl > + < nl > + / / Ignore if name not changed < nl > + if ( equalsE ( u . getNick ( ) , nick ) ) { < nl > + return ; < nl > + } < nl > + < nl > + / / Changing user name < nl > + u = u . editNick ( nick ) ; < nl > + < nl > + / / Updating user in collection < nl > + users ( ) . addOrUpdateItem ( u ) ; < nl > + } < nl > + } < nl > + < nl > + @ Verified < nl > + private void onUserAboutChanged ( int uid , String about ) { < nl > + User u = users ( ) . getValue ( uid ) ; < nl > + if ( u ! = null ) { < nl > + < nl > + / / Ignore if name not changed < nl > + if ( equalsE ( u . getAbout ( ) , about ) ) { < nl > + return ; < nl > + } < nl > + < nl > + / / Changing about information < nl > + u = u . editAbout ( about ) ; < nl > + < nl > + / / Updating user in collection < nl > + users ( ) . addOrUpdateItem ( u ) ; < nl > + } < nl > + } < nl > + < nl > + @ Verified < nl > + private void onUserLocalNameChanged ( int uid , String name ) { < nl > + User u = users ( ) . getValue ( uid ) ; < nl > + if ( u ! = null ) { < nl > + < nl > + / / Ignore if local name not changed < nl > + if ( equalsE ( u . getLocalName ( ) , name ) ) { < nl > + return ; < nl > + } < nl > + < nl > + / / Changing user local name < nl > + u = u . editLocalName ( name ) ; < nl > + < nl > + / / Updating user in collection < nl > + users ( ) . addOrUpdateItem ( u ) ; < nl > + < nl > + / / Notify about user change < nl > + onUserDescChanged ( u ) ; < nl > + } < nl > + } < nl > + < nl > + @ Verified < nl > + private void onUserAvatarChanged ( int uid , ApiAvatar avatar ) { < nl > + User u = users ( ) . getValue ( uid ) ; < nl > + if ( u ! = null ) { < nl > + < nl > + / / Ignore if avatar not changed < nl > + / / Disabled because of future - compatibility it is unable to check equality < nl > + / / if ( equalsE ( u . getAvatar ( ) , new im . actor . model . entity . Avatar ( avatar ) ) ) { < nl > + / / return ; < nl > + / / } < nl > + < nl > + / / Changing user avatar < nl > + u = u . editAvatar ( avatar ) ; < nl > + < nl > + / / Updating user in collection < nl > + users ( ) . addOrUpdateItem ( u ) ; < nl > + < nl > + / / Notify about user change < nl > + onUserDescChanged ( u ) ; < nl > + } < nl > + } < nl > + < nl > + @ Override < nl > + public boolean process ( Object update ) { < nl > + if ( update instanceof UpdateUserNameChanged ) { < nl > + UpdateUserNameChanged userNameChanged = ( UpdateUserNameChanged ) update ; < nl > + onUserNameChanged ( userNameChanged . getUid ( ) , userNameChanged . getName ( ) ) ; < nl > + return true ; < nl > + } else if ( update instanceof UpdateUserLocalNameChanged ) { < nl > + UpdateUserLocalNameChanged localNameChanged = ( UpdateUserLocalNameChanged ) update ; < nl > + onUserLocalNameChanged ( localNameChanged . getUid ( ) , localNameChanged . getLocalName ( ) ) ; < nl > + return true ; < nl > + } else if ( update instanceof UpdateUserNickChanged ) { < nl > + UpdateUserNickChanged nickChanged = ( UpdateUserNickChanged ) update ; < nl > + onUserNickChanged ( nickChanged . getUid ( ) , nickChanged . getNickname ( ) ) ; < nl > + return true ; < nl > + } else if ( update instanceof UpdateUserAboutChanged ) { < nl > + UpdateUserAboutChanged userAboutChanged = ( UpdateUserAboutChanged ) update ; < nl > + onUserAboutChanged ( userAboutChanged . getUid ( ) , userAboutChanged . getAbout ( ) ) ; < nl > + return true ; < nl > + } else if ( update instanceof UpdateUserAvatarChanged ) { < nl > + UpdateUserAvatarChanged avatarChanged = ( UpdateUserAvatarChanged ) update ; < nl > + onUserAvatarChanged ( avatarChanged . getUid ( ) , avatarChanged . getAvatar ( ) ) ; < nl > + return true ; < nl > + } < nl > + return false ; < nl > + } < nl > + < nl > + @ Verified < nl > + private void onUserDescChanged ( User u ) { < nl > + context ( ) . getMessagesModule ( ) . getDialogsActor ( ) . send ( < nl > + new DialogsActor . UserChanged ( u ) ) ; < nl > + context ( ) . getMessagesModule ( ) . getDialogsGroupedActor ( ) . send ( < nl > + new GroupedDialogsActor . PeerInformationChanged ( Peer . user ( u . getUid ( ) ) ) ) ; < nl > + context ( ) . getContactsModule ( ) . getContactSyncActor ( ) < nl > + . send ( new ContactsSyncActor . UserChanged ( u ) ) ; < nl > + } < nl > + } < nl > diff - - git a / actor - sdk / sdk - core / runtime / js / src / main / java / im / actor / runtime / js / storage / JsKeyValueStorage . java b / actor - sdk / sdk - core / runtime / js / src / main / java / im / actor / runtime / js / storage / JsKeyValueStorage . java < nl > index ac0d9e5 . . 8846506 100644 < nl > - - - a / actor - sdk / sdk - core / runtime / js / src / main / java / im / actor / runtime / js / storage / JsKeyValueStorage . java < nl > + + + b / actor - sdk / sdk - core / runtime / js / src / main / java / im / actor / runtime / js / storage / JsKeyValueStorage . java < nl > @ @ - 96 , 6 + 96 , 28 @ @ public class JsKeyValueStorage implements KeyValueStorage { < nl > } < nl > < nl > @ Override < nl > + public byte [ ] loadItem ( long key ) { < nl > + String res = storage . getItem ( getId ( key ) ) ; < nl > + if ( res = = null ) { < nl > + return null ; < nl > + } else { < nl > + return fromBase64 ( res ) ; < nl > + } < nl > + } < nl > + < nl > + @ Override < nl > + public List < KeyValueRecord > loadItems ( long [ ] keys ) { < nl > + / / TODO : Implement < nl > + return null ; < nl > + } < nl > + < nl > + @ Override < nl > + public List < KeyValueRecord > loadAllItems ( ) { < nl > + / / TODO : Implement < nl > + return null ; < nl > + } < nl > + < nl > + @ Override < nl > public void clear ( ) { < nl > for ( long id : items ) { < nl > storage . removeItem ( getId ( id ) ) ; < nl > @ @ - 104 , 16 + 126 , 6 @ @ public class JsKeyValueStorage implements KeyValueStorage { < nl > items . clear ( ) ; < nl > } < nl > < nl > - @ Override < nl > - public byte [ ] getValue ( long id ) { < nl > - String res = storage . getItem ( getId ( id ) ) ; < nl > - if ( res = = null ) { < nl > - return null ; < nl > - } else { < nl > - return fromBase64 ( res ) ; < nl > - } < nl > - } < nl > - < nl > private void saveIndex ( ) { < nl > DataOutput dataOutput = new DataOutput ( ) ; < nl > dataOutput . writeInt ( items . size ( ) ) ; < nl > diff - - git a / actor - sdk / sdk - core / runtime / js / src / main / java / im / actor / runtime / js / storage / JsListStorage . java b / actor - sdk / sdk - core / runtime / js / src / main / java / im / actor / runtime / js / storage / JsListStorage . java < nl > index c9de314 . . 9fe0a70 100644 < nl > - - - a / actor - sdk / sdk - core / runtime / js / src / main / java / im / actor / runtime / js / storage / JsListStorage . java < nl > + + + b / actor - sdk / sdk - core / runtime / js / src / main / java / im / actor / runtime / js / storage / JsListStorage . java < nl > @ @ - 152 , 6 + 152 , 12 @ @ public class JsListStorage implements ListStorage { < nl > } < nl > < nl > @ Override < nl > + public List < ListEngineRecord > loadAllItems ( ) { < nl > + / / TODO : Implement < nl > + return null ; < nl > + } < nl > + < nl > + @ Override < nl > public boolean isEmpty ( ) { < nl > return getCount ( ) = = 0 ; < nl > } < nl > diff - - git a / settings . gradle b / settings . gradle < nl > index c37071a . . 5d08eba 100644 < nl > - - - a / settings . gradle < nl > + + + b / settings . gradle < nl > @ @ - 37 , 4 + 37 , 4 @ @ include " : actor - sdk : sdk - core - ios " < nl > / / SDK Bots < nl > / / < nl > < nl > - include " : actor - sdk : sdk - bot : bot - example " < nl > \ No newline at end of file < nl > + / / include " : actor - sdk : sdk - bot : bot - example " < nl > \ No newline at end of file

TEST DIFF:
diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / MessagesAdapter . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / MessagesAdapter . java 
 index b88bd37 . . ab40cf2 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / MessagesAdapter . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / MessagesAdapter . java 
 @ @ - 7 , 7 + 7 , 9 @ @ import android . view . ViewGroup ; 
 
 import java . util . HashMap ; 
 
 + import im . actor . core . entity . GroupType ; 
 import im . actor . core . entity . Message ; 
 + import im . actor . core . entity . PeerType ; 
 import im . actor . core . entity . content . AbsContent ; 
 import im . actor . core . entity . content . AnimationContent ; 
 import im . actor . core . entity . content . ContactContent ; 
 @ @ - 42 , 6 + 44 , 7 @ @ import im . actor . sdk . controllers . conversation . messages . content . TextHolder ; 
 import im . actor . sdk . controllers . conversation . messages . content . UnsupportedHolder ; 
 import im . actor . sdk . controllers . ActorBinder ; 
 
 + import static im . actor . sdk . util . ActorSDKMessenger . groups ; 
 import static im . actor . sdk . util . ActorSDKMessenger . messenger ; 
 
 public class MessagesAdapter extends BindedListAdapter < Message , MessageHolder > { 
 @ @ - 53 , 6 + 56 , 7 @ @ public class MessagesAdapter extends BindedListAdapter < Message , MessageHolder > { 
 private long firstUnread = - 1 ; 
 private long readDate ; 
 private long receiveDate ; 
 + private boolean isChannel ; 
 
 private HashMap < Long , Message > selected = new HashMap < > ( ) ; 
 
 @ @ - 64 , 6 + 68 , 11 @ @ public class MessagesAdapter extends BindedListAdapter < Message , MessageHolder > { 
 this . context = context ; 
 ConversationVM conversationVM = messenger ( ) . getConversationVM ( messagesFragment . getPeer ( ) ) ; 
 
 + isChannel = false ; 
 + if ( messagesFragment . getPeer ( ) . getPeerType ( ) = = PeerType . GROUP ) { 
 + isChannel = groups ( ) . get ( messagesFragment . getPeer ( ) . getPeerId ( ) ) . getGroupType ( ) = = GroupType . CHANNEL ; 
 + } 
 + 
 readDate = conversationVM . getReadDate ( ) . get ( ) ; 
 receiveDate = conversationVM . getReceiveDate ( ) . get ( ) ; 
 
 @ @ - 204 , 7 + 213 , 7 @ @ public class MessagesAdapter extends BindedListAdapter < Message , MessageHolder > { 
 return ActorSDK . sharedActor ( ) . getDelegatedViewHolder ( ServiceHolder . class , new ActorSDK . OnDelegateViewHolder < ServiceHolder > ( ) { 
 @ Override 
 public ServiceHolder onNotDelegated ( ) { 
 - return new ServiceHolder ( MessagesAdapter . this , inflate ( R . layout . adapter _ dialog _ service , viewGroup ) ) ; 
 + return new ServiceHolder ( MessagesAdapter . this , isChannel , inflate ( R . layout . adapter _ dialog _ service , viewGroup ) ) ; 
 } 
 } , MessagesAdapter . this , inflate ( R . layout . adapter _ dialog _ service , viewGroup ) ) ; 
 case 2 : 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / content / ServiceHolder . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / content / ServiceHolder . java 
 index 1dbd25a . . c081448 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / content / ServiceHolder . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / content / ServiceHolder . java 
 @ @ - 15 , 10 + 15 , 13 @ @ import static im . actor . sdk . util . ActorSDKMessenger . messenger ; 
 public class ServiceHolder extends MessageHolder { 
 
 private TextView messageText ; 
 + private boolean isChannel ; 
 
 - public ServiceHolder ( MessagesAdapter fragment , View itemView ) { 
 + public ServiceHolder ( MessagesAdapter fragment , boolean isChannel , View itemView ) { 
 super ( fragment , itemView , true ) ; 
 
 + this . isChannel = isChannel ; 
 + 
 messageText = ( TextView ) itemView . findViewById ( R . id . serviceMessage ) ; 
 messageText . setTextColor ( ActorSDK . sharedActor ( ) . style . getConvDatetextColor ( ) ) ; 
 onConfigureViewHolder ( ) ; 
 @ @ - 27 , 6 + 30 , 6 @ @ public class ServiceHolder extends MessageHolder { 
 @ Override 
 protected void bindData ( Message message , long readDate , long receiveDate , boolean isUpdated , PreprocessedData preprocessedData ) { 
 messageText . setText ( messenger ( ) . getFormatter ( ) . formatFullServiceMessage ( message . getSenderId ( ) , 
 - ( ServiceContent ) message . getContent ( ) ) ) ; 
 + ( ServiceContent ) message . getContent ( ) , isChannel ) ) ; 
 } 
 } 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / dialogs / view / DialogView . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / dialogs / view / DialogView . java 
 index 155b410 . . 9891db0 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / dialogs / view / DialogView . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / dialogs / view / DialogView . java 
 @ @ - 399 , 8 + 399 , 10 @ @ public class DialogView extends ListItemBackgroundView < Dialog , DialogView . Dialog 
 } 
 
 if ( arg . getSenderId ( ) > 0 ) { 
 + 
 String contentText = messenger ( ) . getFormatter ( ) . formatContentText ( arg . getSenderId ( ) , 
 - arg . getMessageType ( ) , arg . getText ( ) . replace ( " \ n " , " " ) , arg . getRelatedUid ( ) ) ; 
 + arg . getMessageType ( ) , arg . getText ( ) . replace ( " \ n " , " " ) , arg . getRelatedUid ( ) , 
 + arg . isChannel ( ) ) ; 
 
 if ( arg . getPeer ( ) . getPeerType ( ) = = PeerType . GROUP ) { 
 if ( messenger ( ) . getFormatter ( ) . isLargeDialogMessage ( arg . getMessageType ( ) ) ) { 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / entity / Notification . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / entity / Notification . java 
 index 0998e1c . . 6663bea 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / entity / Notification . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / entity / Notification . java 
 @ @ - 10 , 12 + 10 , 15 @ @ public class Notification { 
 @ Property ( " readonly , nonatomic " ) 
 private Peer peer ; 
 @ Property ( " readonly , nonatomic " ) 
 + private boolean isChannel ; 
 + @ Property ( " readonly , nonatomic " ) 
 private int sender ; 
 @ Property ( " readonly , nonatomic " ) 
 private ContentDescription contentDescription ; 
 
 - public Notification ( Peer peer , int sender , ContentDescription contentDescription ) { 
 + public Notification ( Peer peer , boolean isChannel , int sender , ContentDescription contentDescription ) { 
 this . peer = peer ; 
 + this . isChannel = isChannel ; 
 this . sender = sender ; 
 this . contentDescription = contentDescription ; 
 } 
 @ @ - 28 , 6 + 31 , 10 @ @ public class Notification { 
 return sender ; 
 } 
 
 + public boolean isChannel ( ) { 
 + return isChannel ; 
 + } 
 + 
 public ContentDescription getContentDescription ( ) { 
 return contentDescription ; 
 } 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / i18n / I18nEngine . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / i18n / I18nEngine . java 
 index de15160 . . 4d87232 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / i18n / I18nEngine . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / i18n / I18nEngine . java 
 @ @ - 225 , 7 + 225 , 8 @ @ public class I18nEngine extends IntlEngine { 
 return " " ; 
 } else { 
 String contentText = formatContentText ( dialog . getSenderId ( ) , 
 - dialog . getMessageType ( ) , dialog . getText ( ) , dialog . getRelatedUid ( ) ) ; 
 + dialog . getMessageType ( ) , dialog . getText ( ) , dialog . getRelatedUid ( ) , 
 + dialog . isChannel ( ) ) ; 
 if ( dialog . getPeer ( ) . getPeerType ( ) = = PeerType . GROUP ) { 
 if ( ! isLargeDialogMessage ( dialog . getMessageType ( ) ) ) { 
 return formatPerformerName ( dialog . getSenderId ( ) ) + " : " + contentText ; 
 @ @ - 279 , 7 + 280 , 8 @ @ public class I18nEngine extends IntlEngine { 
 return formatContentText ( pendingNotification . getSender ( ) , 
 pendingNotification . getContentDescription ( ) . getContentType ( ) , 
 pendingNotification . getContentDescription ( ) . getText ( ) , 
 - pendingNotification . getContentDescription ( ) . getRelatedUser ( ) ) ; 
 + pendingNotification . getContentDescription ( ) . getRelatedUser ( ) , 
 + pendingNotification . isChannel ( ) ) ; 
 } 
 
 / * * 
 @ @ - 291 , 8 + 293 , 12 @ @ public class I18nEngine extends IntlEngine { 
 * @ param relatedUid optional related uid 
 * @ return formatted content 
 * / 
 - @ ObjectiveCName ( " formatContentTextWithSenderId : withContentType : withText : withRelatedUid : " ) 
 - public String formatContentText ( int senderId , ContentType contentType , String text , int relatedUid ) { 
 + @ ObjectiveCName ( " formatContentTextWithSenderId : withContentType : withText : withRelatedUid : withIsChannel " ) 
 + public String formatContentText ( int senderId , ContentType contentType , String text , int relatedUid , 
 + boolean isChannel ) { 
 + 
 + String groupKey = isChannel ? " channels " : " groups " ; 
 + 
 switch ( contentType ) { 
 case TEXT : 
 return text ; 
 @ @ - 323 , 27 + 329 , 27 @ @ public class I18nEngine extends IntlEngine { 
 return getTemplateNamed ( senderId , " content . service . registered . compact " ) 
 . replace ( " { app _ name } " , getAppName ( ) ) ; 
 case SERVICE _ CREATED : 
 - return getTemplateNamed ( senderId , " content . service . groups . created " ) ; 
 + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . created " ) ; 
 case SERVICE _ ADD : 
 - return getTemplateNamed ( senderId , " content . service . groups . invited " ) 
 + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . invited " ) 
 . replace ( " { name _ added } " , getSubjectName ( relatedUid ) ) ; 
 case SERVICE _ LEAVE : 
 - return getTemplateNamed ( senderId , " content . service . groups . left " ) ; 
 + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . left " ) ; 
 case SERVICE _ KICK : 
 - return getTemplateNamed ( senderId , " content . service . groups . kicked " ) 
 + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . kicked " ) 
 . replace ( " { name _ kicked } " , getSubjectName ( relatedUid ) ) ; 
 case SERVICE _ AVATAR : 
 - return getTemplateNamed ( senderId , " content . service . groups . avatar _ changed " ) ; 
 + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . avatar _ changed " ) ; 
 case SERVICE _ AVATAR _ REMOVED : 
 - return getTemplateNamed ( senderId , " content . service . groups . avatar _ removed " ) ; 
 + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . avatar _ removed " ) ; 
 case SERVICE _ TITLE : 
 - return getTemplateNamed ( senderId , " content . service . groups . title _ changed . compact " ) ; 
 + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . title _ changed . compact " ) ; 
 case SERVICE _ TOPIC : 
 - return getTemplateNamed ( senderId , " content . service . groups . topic _ changed . compact " ) ; 
 + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . topic _ changed . compact " ) ; 
 case SERVICE _ ABOUT : 
 - return getTemplateNamed ( senderId , " content . service . groups . about _ changed . compact " ) ; 
 + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . about _ changed . compact " ) ; 
 case SERVICE _ JOINED : 
 - return getTemplateNamed ( senderId , " content . service . groups . joined " ) ; 
 + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . joined " ) ; 
 case SERVICE _ CALL _ ENDED : 
 return get ( " content . service . calls . ended " ) ; 
 case SERVICE _ CALL _ MISSED : 
 @ @ - 364 , 42 + 370 , 43 @ @ public class I18nEngine extends IntlEngine { 
 * @ return formatted message 
 * / 
 @ ObjectiveCName ( " formatFullServiceMessageWithSenderId : withContent : " ) 
 - public String formatFullServiceMessage ( int senderId , ServiceContent content ) { 
 + public String formatFullServiceMessage ( int senderId , ServiceContent content , boolean isChannel ) { 
 + String groupKey = isChannel ? " channels " : " groups " ; 
 if ( content instanceof ServiceUserRegistered ) { 
 return getTemplateNamed ( senderId , " content . service . registered . full " ) 
 . replace ( " { app _ name } " , getAppName ( ) ) ; 
 } else if ( content instanceof ServiceGroupCreated ) { 
 - return getTemplateNamed ( senderId , " content . service . groups . created " ) ; 
 + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . created " ) ; 
 } else if ( content instanceof ServiceGroupUserInvited ) { 
 - return getTemplateNamed ( senderId , " content . service . groups . invited " ) 
 + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . invited " ) 
 . replace ( " { name _ added } " , 
 getSubjectName ( ( ( ServiceGroupUserInvited ) content ) . getAddedUid ( ) ) ) ; 
 } else if ( content instanceof ServiceGroupUserKicked ) { 
 - return getTemplateNamed ( senderId , " content . service . groups . kicked " ) 
 + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . kicked " ) 
 . replace ( " { name _ kicked } " , 
 getSubjectName ( ( ( ServiceGroupUserKicked ) content ) . getKickedUid ( ) ) ) ; 
 } else if ( content instanceof ServiceGroupUserLeave ) { 
 - return getTemplateNamed ( senderId , " content . service . groups . left " ) ; 
 + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . left " ) ; 
 } else if ( content instanceof ServiceGroupTitleChanged ) { 
 - return getTemplateNamed ( senderId , " content . service . groups . title _ changed . full " ) 
 + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . title _ changed . full " ) 
 . replace ( " { title } " , 
 ( ( ServiceGroupTitleChanged ) content ) . getNewTitle ( ) ) ; 
 } else if ( content instanceof ServiceGroupTopicChanged ) { 
 - return getTemplateNamed ( senderId , " content . service . groups . topic _ changed . full " ) 
 + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . topic _ changed . full " ) 
 . replace ( " { topic } " , 
 ( ( ServiceGroupTopicChanged ) content ) . getNewTopic ( ) ) ; 
 } else if ( content instanceof ServiceGroupAboutChanged ) { 
 - return getTemplateNamed ( senderId , " content . service . groups . about _ changed . full " ) 
 + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . about _ changed . full " ) 
 . replace ( " { about } " , 
 ( ( ServiceGroupAboutChanged ) content ) . getNewAbout ( ) ) ; 
 } else if ( content instanceof ServiceGroupAvatarChanged ) { 
 if ( ( ( ServiceGroupAvatarChanged ) content ) . getNewAvatar ( ) ! = null ) { 
 - return getTemplateNamed ( senderId , " content . service . groups . avatar _ changed " ) ; 
 + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . avatar _ changed " ) ; 
 } else { 
 - return getTemplateNamed ( senderId , " content . service . groups . avatar _ removed " ) ; 
 + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . avatar _ removed " ) ; 
 } 
 } else if ( content instanceof ServiceGroupUserJoined ) { 
 - return getTemplateNamed ( senderId , " content . service . groups . joined " ) ; 
 + return getTemplateNamed ( senderId , " content . service . " + groupKey + " . joined " ) ; 
 } else if ( content instanceof ServiceCallEnded ) { 
 return get ( " content . service . calls . ended " ) ; 
 } else if ( content instanceof ServiceCallMissed ) { 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / notifications / NotificationsActor . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / notifications / NotificationsActor . java 
 index 20add75 . . 95af715 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / notifications / NotificationsActor . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / notifications / NotificationsActor . java 
 @ @ - 12 , 6 + 12 , 7 @ @ import java . util . List ; 
 
 import im . actor . core . PlatformType ; 
 import im . actor . core . entity . ContentDescription ; 
 + import im . actor . core . entity . GroupType ; 
 import im . actor . core . entity . Notification ; 
 import im . actor . core . entity . Peer ; 
 import im . actor . core . entity . PeerType ; 
 @ @ - 31 , 7 + 32 , 7 @ @ import static im . actor . core . util . JavaUtil . last ; 
 
 / * * 
 * Actor that controls all notifications in application 
 - * < p / > 
 + * < p > 
 * NotificationsActor keeps all unread messages for showing last unread messages in notifications 
 * Actor also control sound effects playing logic 
 * / 
 @ @ - 407 , 7 + 408 , 11 @ @ public class NotificationsActor extends ModuleActor { 
 / / Converting to PendingNotifications 
 List < Notification > res = new ArrayList < > ( ) ; 
 for ( PendingNotification p : destNotifications ) { 
 - res . add ( new Notification ( p . getPeer ( ) , p . getSender ( ) , p . getContent ( ) ) ) ; 
 + boolean isChannel = false ; 
 + if ( p . getPeer ( ) . getPeerType ( ) = = PeerType . GROUP ) { 
 + isChannel = groups ( ) . getValue ( p . getPeer ( ) . getPeerId ( ) ) . getGroupType ( ) = = GroupType . CHANNEL ; 
 + } 
 + res . add ( new Notification ( p . getPeer ( ) , isChannel , p . getSender ( ) , p . getContent ( ) ) ) ; 
 } 
 
 / / Performing notifications 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText . json b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText . json 
 index 78f9d1a . . 53778a8 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText . json 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText . json 
 @ @ - 107 , 6 + 107 , 27 @ @ 
 	 	 	 	 " avatar _ changed " : " { name } changed the group photo " , 
 	 	 	 	 " avatar _ removed " : " { name } removed the group photo " 
 	 	 	 } , 
 + 	 	 	 " channels " : { 
 + 	 	 	 	 " created " : " Channel created " , 
 + 	 	 	 	 " invited " : " { name } invited { name _ added } " , 
 + 	 	 	 	 " joined " : " { name } joined channel " , 
 + 	 	 	 	 " kicked " : " { name } kicked { name _ kicked } " , 
 + 	 	 	 	 " left " : " { name } left channel " , 
 + 	 	 	 	 " title _ changed " : { 
 + 	 	 	 	 	 " full " : " { name } changed the channel name to \ " { title } \ " " , 
 + 	 	 	 	 	 " compact " : " { name } changed the channel name " 
 + 	 	 	 	 } , 
 + 	 	 	 	 " topic _ changed " : { 
 + 	 	 	 	 	 " full " : " { name } changed the channel topic to \ " { topic } \ " " , 
 + 	 	 	 	 	 " compact " : " { name } changed the channel topic " 
 + 	 	 	 	 } , 
 + 	 	 	 	 " about _ changed " : { 
 + 	 	 	 	 	 " full " : " { name } changed the channel about to \ " { about } \ " " , 
 + 	 	 	 	 	 " compact " : " { name } changed the channel about " 
 + 	 	 	 	 } , 
 + 	 	 	 	 " avatar _ changed " : " { name } changed the channel photo " , 
 + 	 	 	 	 " avatar _ removed " : " { name } removed the channel photo " 
 + 	 	 	 } , 
 	 	 	 " calls " : { 
 	 	 	 	 " missed " : " Missed call " , 
 	 	 	 	 " ended " : " Call ended " 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Ar . json b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Ar . json 
 index 68524a5 . . 308c7b5 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Ar . json 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Ar . json 
 @ @ - 94 , 6 + 94 , 27 @ @ 
 	 	 	 	 " avatar _ changed " : " { name } غ ي ر ص و ر ة ا ل م ج م و ع ة " , 
 	 	 	 	 " avatar _ removed " : " { name } ح ذ ف ص و ر ة ا ل م ج م و ع ة " 
 	 	 	 } , 
 + 	 	 	 " channels " : { 
 + 	 	 	 	 " created " : " ا ن ش أ ا ل م ج م و ع ة " , 
 + 	 	 	 	 " invited " : " { name } د ع ى { name _ added } " , 
 + 	 	 	 	 " joined " : " { name } ا ن ص م ل ل م ج م و ع ة " , 
 + 	 	 	 	 " kicked " : " { name } ا ز ا ل { name _ kicked } " , 
 + 	 	 	 	 " left " : " { name } غ ا د ر " , 
 + 	 	 	 	 " title _ changed " : { 
 + 	 	 	 	 	 " full " : " { name } غ ي ر ا ل ا س م ا ل ى \ " { title } \ " " , 
 + 	 	 	 	 	 " compact " : " { name } غ ي ر ا س م ا ل م ج م و ع ة ا ل ى " 
 + 	 	 	 	 } , 
 + 	 	 	 	 " topic _ changed " : { 
 + 	 	 	 	 	 " full " : " { name } changed the group topic to \ " { topic } \ " " , 
 + 	 	 	 	 	 " compact " : " { name } changed the group topic " 
 + 	 	 	 	 } , 
 + 	 	 	 	 " about _ changed " : { 
 + 	 	 	 	 	 " full " : " { name } changed the group about to \ " { about } \ " " , 
 + 	 	 	 	 	 " compact " : " { name } changed the group about " 
 + 	 	 	 	 } , 
 + 	 	 	 	 " avatar _ changed " : " { name } غ ي ر ص و ر ة ا ل م ج م و ع ة " , 
 + 	 	 	 	 " avatar _ removed " : " { name } ح ذ ف ص و ر ة ا ل م ج م و ع ة " 
 + 	 	 	 } , 
 	 	 	 " calls " : { 
 	 	 	 	 " missed " : " Missed call " , 
 	 	 	 	 " ended " : " Call ended " 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Es . json b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Es . json 
 index d3e2e67 . . 7cdcd77 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Es . json 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Es . json 
 @ @ - 100 , 6 + 100 , 27 @ @ 
 	 	 	 	 " avatar _ changed " : " { name } modificada la foto de grupo " , 
 	 	 	 	 " avatar _ removed " : " { name } eliminada la foto de grupo " 
 	 	 	 } , 
 + 	 	 	 " channels " : { 
 + 	 	 	 	 " created " : " Creado el canal " , 
 + 	 	 	 	 " invited " : " { name } invit ó a { name _ added } " , 
 + 	 	 	 	 " joined " : " { name } se uni ó al canal " , 
 + 	 	 	 	 " kicked " : " { name } expulsaste a { name _ kicked } " , 
 + 	 	 	 	 " left " : " { name } elimino el canal " , 
 + 	 	 	 	 " title _ changed " : { 
 + 	 	 	 	 	 " full " : " { name } cambio el nombre del canal a \ " { title } \ " " , 
 + 	 	 	 	 	 " compact " : " { name } a modificado el nombre del canal " 
 + 	 	 	 	 } , 
 + 	 	 	 	 " topic _ changed " : { 
 + 	 	 	 	 	 " full " : " { name } changed the canal topic to \ " { topic } \ " " , 
 + 	 	 	 	 	 " compact " : " { name } changed the canal topic " 
 + 	 	 	 	 } , 
 + 	 	 	 	 " about _ changed " : { 
 + 	 	 	 	 	 " full " : " { name } changed the canal about to \ " { about } \ " " , 
 + 	 	 	 	 	 " compact " : " { name } changed the canal about " 
 + 	 	 	 	 } , 
 + 	 	 	 	 " avatar _ changed " : " { name } modificada la foto de canal " , 
 + 	 	 	 	 " avatar _ removed " : " { name } eliminada la foto de canal " 
 + 	 	 	 } , 
 	 	 	 " calls " : { 
 	 	 	 	 " missed " : " Llamada perdida " , 
 	 	 	 	 " ended " : " Llamada finalizada " 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Fa . json b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Fa . json 
 index 0a6b387 . . 0d663fe 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Fa . json 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Fa . json 
 @ @ - 94 , 6 + 94 , 27 @ @ 
 	 	 	 	 " avatar _ changed " : " { name } ت ص و ی ر گ ر و ه ر ا ع و ض ک ر د " , 
 	 	 	 	 " avatar _ removed " : " { name } ت ص و ی ر گ ر و ه ر ا ع و ض ک ر د " 
 	 	 	 } , 
 + 	 	 	 " channels " : { 
 + 	 	 	 	 " created " : " گ ر و ه ر ا ا ی ج ا د ک ر د " , 
 + 	 	 	 	 " invited " : " { name } { name _ added } ر ا د ع و ت ک ر د " , 
 + 	 	 	 	 " joined " : " { name } ب ه گ ر و ه پ ی و س ت " , 
 + 	 	 	 	 " kicked " : " { name } { name _ kicked } ر ا ا ز گ ر و ه ح ذ ف ک ر د " , 
 + 	 	 	 	 " left " : " { name } ا ز گ ر و ه ر ف ت " , 
 + 	 	 	 	 " title _ changed " : { 
 + 	 	 	 	 	 " full " : " { name } ن ا م گ ر و ه ر ا ب ا \ " { title } \ " ج ا ی گ ز ی ن ک ر د " , 
 + 	 	 	 	 	 " compact " : " { name } ن ا م گ ر و ه ر ا ج ا ی گ ز ی ن ک ر د " 
 + 	 	 	 	 } , 
 + 	 	 	 	 " topic _ changed " : { 
 + 	 	 	 	 	 " full " : " ج ن ا ب { name } م و ض و ع گ ر و ه ر ا ب ا \ " { topic } \ " ج ا ی ‌ گ ز ی ن ک ر د ی د " , 
 + 	 	 	 	 	 " compact " : " م و ض و ع گ ر و ه ر ا ع و ض ک ر د { name } " 
 + 	 	 	 	 } , 
 + 	 	 	 	 " about _ changed " : { 
 + 	 	 	 	 	 " full " : " ج ن ا ب { name } م ت ن د ر ب ا ر ه گ ر و ه ر ا ب ا \ " { about } \ " ج ا ی ‌ گ ز ی ن ک ر د ی د " , 
 + 	 	 	 	 	 " compact " : " م ت ن د ر ب ا ر ه گ ر و ه ر ا ع و ض ک ر د { name } " 
 + 	 	 	 	 } , 
 + 	 	 	 	 " avatar _ changed " : " { name } ت ص و ی ر گ ر و ه ر ا ع و ض ک ر د " , 
 + 	 	 	 	 " avatar _ removed " : " { name } ت ص و ی ر گ ر و ه ر ا ع و ض ک ر د " 
 + 	 	 	 } , 
 	 	 	 " calls " : { 
 	 	 	 	 " missed " : " ت م ا س ا ز د س ت ر ف ت ه " , 
 	 	 	 	 " ended " : " ت م ا س ت م ا م ش د " 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Pt . json b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Pt . json 
 index b2704c9 . . f42f5e1 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Pt . json 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Pt . json 
 @ @ - 107 , 6 + 107 , 27 @ @ 
 	 	 	 	 " avatar _ changed " : " { name } alterou a foto do grupo " , 
 	 	 	 	 " avatar _ removed " : " { name } removeu a foto do grupo " 
 	 	 	 } , 
 + 	 	 	 " channels " : { 
 + 	 	 	 	 " created " : " Criou o canal " , 
 + 	 	 	 	 " invited " : " { name } convidado { name _ added } " , 
 + 	 	 	 	 " joined " : " { name } entrou no canal " , 
 + 	 	 	 	 " kicked " : " { name } removido { name _ kicked } " , 
 + 	 	 	 	 " left " : " { name } saiu do canal " , 
 + 	 	 	 	 " title _ changed " : { 
 + 	 	 	 	 	 " full " : " { name } alterou o nome do canal para \ " { title } \ " " , 
 + 	 	 	 	 	 " compact " : " { name } alterou o nome do canal " 
 + 	 	 	 	 } , 
 + 	 	 	 	 " topic _ changed " : { 
 + 	 	 	 	 	 " full " : " { name } changed the canal topic to \ " { topic } \ " " , 
 + 	 	 	 	 	 " compact " : " { name } changed the canal topic " 
 + 	 	 	 	 } , 
 + 	 	 	 	 " about _ changed " : { 
 + 	 	 	 	 	 " full " : " { name } changed the canal about to \ " { about } \ " " , 
 + 	 	 	 	 	 " compact " : " { name } changed the canal about " 
 + 	 	 	 	 } , 
 + 	 	 	 	 " avatar _ changed " : " { name } alterou a foto do canal " , 
 + 	 	 	 	 " avatar _ removed " : " { name } removeu a foto do canal " 
 + 	 	 	 } , 
 	 	 	 " calls " : { 
 	 	 	 	 " missed " : " Missed call " , 
 	 	 	 	 " ended " : " Call ended " 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Ru . json b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Ru . json 
 index b4793ec . . 0f8bc7a 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Ru . json 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Ru . json 
 @ @ - 160 , 10 + 160 , 10 @ @ 
 	 	 	 	 	 " other " : " { name } и з м е н и л ( - а ) н а з в а н и е г р у п п ы н а \ " { title } \ " " 
 	 	 	 	 	 } , 
 	 	 	 	 	 " compact " : { 
 - 	 	 	 	 	 	 " you " : " { name } и з м е н и л и т е м у г р у п п ы " , 
 - 	 	 	 	 	 	 " male " : " { name } и з м е н и л т е м у г р у п п ы " , 
 - 	 	 	 	 	 	 " female " : " { name } и з м е н и л а т е м у г р у п п ы " , 
 - 	 	 	 	 	 " other " : " { name } и з м е н и л ( - а ) т е м у г р у п п ы " 
 + 	 	 	 	 	 	 " you " : " { name } и з м е н и л и н а з в а н и е г р у п п ы " , 
 + 	 	 	 	 	 	 " male " : " { name } и з м е н и л н а з в а н и е г р у п п ы " , 
 + 	 	 	 	 	 	 " female " : " { name } и з м е н и л а н а з в а н и е г р у п п ы " , 
 + 	 	 	 	 	 " other " : " { name } и з м е н и л ( - а ) н а з в а н и е г р у п п ы " 
 	 	 	 	 	 } 
 	 	 	 	 } , 
 	 	 	 	 " topic _ changed " : { 
 @ @ - 207 , 6 + 207 , 87 @ @ 
 	 	 	 	 " other " : " { name } у д а л и л ( - а ) ф о т о г р у п п ы " 
 	 	 	 	 } 
 	 	 	 } , 
 + 	 	 	 " channels " : { 
 + 	 	 	 	 " created " : " С о з д а н к а н а л " , 
 + 	 	 	 	 " invited " : { 
 + 	 	 	 	 	 " you " : " { name } п р и г л а с и л и { name _ added } " , 
 + 	 	 	 	 	 " male " : " { name } п р и г л а с и л { name _ added } " , 
 + 	 	 	 	 	 " female " : " { name } п р и г л а с и л а { name _ added } " , 
 + 	 	 	 	 	 " other " : " { name } п р и г л а с и л ( - а ) { name _ added } " 
 + 	 	 	 	 } , 
 + 	 	 	 	 " joined " : { 
 + 	 	 	 	 	 " you " : " { name } в о ш л и в к а н а л " , 
 + 	 	 	 	 	 " male " : " { name } в о ш е л в к а н а л " , 
 + 	 	 	 	 	 " female " : " { name } в о ш л а в к а н а л " , 
 + 	 	 	 	 	 " other " : " { name } в о ш е л ( - ш л а ) в к а н а л " 
 + 	 	 	 	 } , 
 + 	 	 	 	 " kicked " : { 
 + 	 	 	 	 	 " you " : " { name } и с к л ю ч и л и { name _ kicked } " , 
 + 	 	 	 	 	 " male " : " { name } и с к л ю ч и л { name _ kicked } " , 
 + 	 	 	 	 	 " female " : " { name } и с к л ю ч и л а { name _ kicked } " , 
 + 	 	 	 	 	 " other " : " { name } и с к л ю ч и л ( - а ) { name _ kicked } " 
 + 	 	 	 	 } , 
 + 	 	 	 	 " left " : { 
 + 	 	 	 	 	 " you " : " { name } п о к и н у л и к а н а л " , 
 + 	 	 	 	 	 " male " : " { name } п о к и н у л к а н а л " , 
 + 	 	 	 	 	 " female " : " { name } п о к и н у л а к а н а л " , 
 + 	 	 	 	 	 " other " : " { name } п о к и н у л ( - а ) к а н а л " 
 + 	 	 	 	 } , 
 + 	 	 	 	 " title _ changed " : { 
 + 	 	 	 	 	 " full " : { 
 + 	 	 	 	 	 	 " you " : " { name } и з м е н и л и н а з в а н и е к а н а л а н а \ " { title } \ " " , 
 + 	 	 	 	 	 	 " male " : " { name } и з м е н и л н а з в а н и е к а н а л а н а \ " { title } \ " " , 
 + 	 	 	 	 	 	 " female " : " { name } и з м е н и л а н а з в а н и е к а н а л а н а \ " { title } \ " " , 
 + 	 	 	 	 	 	 " other " : " { name } и з м е н и л ( - а ) н а з в а н и е к а н а л а н а \ " { title } \ " " 
 + 	 	 	 	 	 } , 
 + 	 	 	 	 	 " compact " : { 
 + 	 	 	 	 	 	 " you " : " { name } и з м е н и л и н а з в а н и е к а н а л а " , 
 + 	 	 	 	 	 	 " male " : " { name } и з м е н и л н а з в а н и е к а н а л а " , 
 + 	 	 	 	 	 	 " female " : " { name } и з м е н и л а н а з в а н и е к а н а л а " , 
 + 	 	 	 	 	 	 " other " : " { name } и з м е н и л ( - а ) н а з в а н и е к а н а л а " 
 + 	 	 	 	 	 } 
 + 	 	 	 	 } , 
 + 	 	 	 	 " topic _ changed " : { 
 + 	 	 	 	 	 " full " : { 
 + 	 	 	 	 	 	 " you " : " { name } и з м е н и л и т е м у к а н а л а н а \ " { title } \ " " , 
 + 	 	 	 	 	 	 " male " : " { name } и з м е н и л т е м у к а н а л а н а \ " { title } \ " " , 
 + 	 	 	 	 	 	 " female " : " { name } и з м е н и л а т е м у к а н а л а н а \ " { title } \ " " , 
 + 	 	 	 	 	 	 " other " : " { name } и з м е н и л ( - а ) т е м у к а н а л а н а \ " { title } \ " " 
 + 	 	 	 	 	 } , 
 + 	 	 	 	 	 " compact " : { 
 + 	 	 	 	 	 	 " you " : " { name } и з м е н и л и т е м у к а н а л а " , 
 + 	 	 	 	 	 	 " male " : " { name } и з м е н и л т е м у к а н а л а " , 
 + 	 	 	 	 	 	 " female " : " { name } и з м е н и л а т е м у к а н а л а " , 
 + 	 	 	 	 	 	 " other " : " { name } и з м е н и л ( - а ) т е м у к а н а л а " 
 + 	 	 	 	 	 } 
 + 	 	 	 	 } , 
 + 	 	 	 	 " about _ changed " : { 
 + 	 	 	 	 	 " full " : { 
 + 	 	 	 	 	 	 " you " : " { name } и з м е н и л и о п и с а н и е к а н а л а н а \ " { title } \ " " , 
 + 	 	 	 	 	 	 " male " : " { name } и з м е н и л о п и с а н и е к а н а л а н а \ " { title } \ " " , 
 + 	 	 	 	 	 	 " female " : " { name } и з м е н и л а о п и с а н и е к а н а л а н а \ " { title } \ " " , 
 + 	 	 	 	 	 	 " other " : " { name } и з м е н и л ( - а ) о п и с а н и е к а н а л а н а \ " { title } \ " " 
 + 	 	 	 	 	 } , 
 + 	 	 	 	 	 " compact " : { 
 + 	 	 	 	 	 	 " you " : " { name } и з м е н и л и к а н а л а к а н а л а " , 
 + 	 	 	 	 	 	 " male " : " { name } и з м е н и л о п и с а н и е к а н а л а " , 
 + 	 	 	 	 	 	 " female " : " { name } и з м е н и л а о п и с а н и е к а н а л а " , 
 + 	 	 	 	 	 	 " other " : " { name } и з м е н и л ( - а ) о п и с а н и е к а н а л а " 
 + 	 	 	 	 	 } 
 + 	 	 	 	 } , 
 + 	 	 	 	 " avatar _ changed " : { 
 + 	 	 	 	 	 " you " : " { name } и з м е н и л и ф о т о к а н а л а " , 
 + 	 	 	 	 	 " male " : " { name } и з м е н и л ф о т о к а н а л а " , 
 + 	 	 	 	 	 " female " : " { name } и з м е н и л а ф о т о к а н а л а " , 
 + 	 	 	 	 	 " other " : " { name } и з м е н и л ( - а ) ф о т о к а н а л а " 
 + 	 	 	 	 } , 
 + 	 	 	 	 " avatar _ removed " : { 
 + 	 	 	 	 	 " you " : " { name } у д а л и л и ф о т о к а н а л а " , 
 + 	 	 	 	 	 " male " : " { name } у д а л и л ф о т о к а н а л а " , 
 + 	 	 	 	 	 " female " : " { name } у д а л и л а ф о т о к а н а л а " , 
 + 	 	 	 	 	 " other " : " { name } у д а л и л ( - а ) ф о т о к а н а л а " 
 + 	 	 	 	 } 
 + 	 	 	 } , 
 	 	 	 " calls " : { 
 	 	 	 	 " missed " : " П р о п у щ е н в ы з о в " , 
 	 	 	 	 " ended " : " В ы з о в з а в е р ш е н " 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Zn . json b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Zn . json 
 index 38a30bf . . f253e8b 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Zn . json 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / resources / AppText _ Zn . json 
 @ @ - 101 , 6 + 101 , 27 @ @ 
 	 	 	 	 " avatar _ changed " : " { name } 修 改 了 群 组 头 像 " , 
 	 	 	 	 " avatar _ removed " : " { name } 删 除 了 群 组 头 像 " 
 	 	 	 } , 
 + 	 	 	 " channels " : { 
 + 	 	 	 	 " created " : " { name } 创 建 了 这 个 群 组 " , 
 + 	 	 	 	 " invited " : " { name } 邀 请 { name _ added } " , 
 + 	 	 	 	 " joined " : " { name } 加 入 群 组 " , 
 + 	 	 	 	 " kicked " : " { name } 移 出 { name _ kicked } " , 
 + 	 	 	 	 " left " : " { name } 退 出 群 组 " , 
 + 	 	 	 	 " title _ changed " : { 
 + 	 	 	 	 	 " full " : " { name } 修 改 为 名 称 为 ： \ " { title } \ " " , 
 + 	 	 	 	 	 " compact " : " { name } 修 改 了 群 组 名 称 " 
 + 	 	 	 	 } , 
 + 	 	 	 	 " topic _ changed " : { 
 + 	 	 	 	 	 " full " : " { name } changed the group topic to \ " { topic } \ " " , 
 + 	 	 	 	 	 " compact " : " { name } changed the group topic " 
 + 	 	 	 	 } , 
 + 	 	 	 	 " about _ changed " : { 
 + 	 	 	 	 	 " full " : " { name } changed the group about to \ " { about } \ " " , 
 + 	 	 	 	 	 " compact " : " { name } changed the group about " 
 + 	 	 	 	 } , 
 + 	 	 	 	 " avatar _ changed " : " { name } 修 改 了 群 组 头 像 " , 
 + 	 	 	 	 " avatar _ removed " : " { name } 删 除 了 群 组 头 像 " 
 + 	 	 	 } , 
 	 	 	 " calls " : { 
 	 	 	 	 " missed " : " 未 接 电 话 " , 
 	 	 	 	 " ended " : " 拨 号 结 束 "

NEAREST DIFF:
diff - - git a / actor - sdk / sdk - bot / bot - example / build . gradle b / actor - sdk / sdk - bot / bot - example / build . gradle 
 index c5bc200 . . 455e3ad 100644 
 - - - a / actor - sdk / sdk - bot / bot - example / build . gradle 
 + + + b / actor - sdk / sdk - bot / bot - example / build . gradle 
 @ @ - 13 , 7 + 13 , 7 @ @ repositories { 
 } 
 
 dependencies { 
 - compile group : ' im . actor ' , name : ' actor - botkit ' , version : ' 1 . 0 . 21 ' 
 - compile group : ' im . actor ' , name : ' shardakka ' , version : ' 0 . 1 . 5 ' 
 + compile group : ' im . actor ' , name : ' actor - botkit ' , version : ' 1 . 0 . + ' 
 + compile group : ' im . actor ' , name : ' shardakka ' , version : ' 0 . 1 . + ' 
 testCompile group : ' junit ' , name : ' junit ' , version : ' 4 . 11 ' 
 } 
 diff - - git a / actor - sdk / sdk - core - android / android - app / build . gradle b / actor - sdk / sdk - core - android / android - app / build . gradle 
 index fb61035 . . bcdbf65 100644 
 - - - a / actor - sdk / sdk - core - android / android - app / build . gradle 
 + + + b / actor - sdk / sdk - core - android / android - app / build . gradle 
 @ @ - 22 , 6 + 22 , 10 @ @ android { 
 proguardFiles getDefaultProguardFile ( ' proguard - android . txt ' ) , ' proguard - rules . pro ' 
 } 
 } 
 + 
 + lintOptions { 
 + abortOnError false 
 + } 
 } 
 
 dependencies { 
 diff - - git a / actor - sdk / sdk - core - android / android - app / src / main / res / layout / activity _ main . xml b / actor - sdk / sdk - core - android / android - app / src / main / res / layout / activity _ main . xml 
 deleted file mode 100644 
 index 5693318 . . 0000000 
 - - - a / actor - sdk / sdk - core - android / android - app / src / main / res / layout / activity _ main . xml 
 + + + / dev / null 
 @ @ - 1 , 11 + 0 , 0 @ @ 
 - < RelativeLayout xmlns : android = " http : / / schemas . android . com / apk / res / android " 
 - xmlns : tools = " http : / / schemas . android . com / tools " android : layout _ width = " match _ parent " 
 - android : layout _ height = " match _ parent " android : paddingLeft = " @ dimen / activity _ horizontal _ margin " 
 - android : paddingRight = " @ dimen / activity _ horizontal _ margin " 
 - android : paddingTop = " @ dimen / activity _ vertical _ margin " 
 - android : paddingBottom = " @ dimen / activity _ vertical _ margin " tools : context = " im . actor . MainActivity " > 
 - 
 - < TextView android : text = " @ string / hello _ world " android : layout _ width = " wrap _ content " 
 - android : layout _ height = " wrap _ content " / > 
 - 
 - < / RelativeLayout > 
 diff - - git a / actor - sdk / sdk - core - android / android - app / src / main / res / menu / menu _ main . xml b / actor - sdk / sdk - core - android / android - app / src / main / res / menu / menu _ main . xml 
 deleted file mode 100644 
 index 5f66cab . . 0000000 
 - - - a / actor - sdk / sdk - core - android / android - app / src / main / res / menu / menu _ main . xml 
 + + + / dev / null 
 @ @ - 1 , 6 + 0 , 0 @ @ 
 - < menu xmlns : android = " http : / / schemas . android . com / apk / res / android " 
 - xmlns : app = " http : / / schemas . android . com / apk / res - auto " 
 - xmlns : tools = " http : / / schemas . android . com / tools " tools : context = " im . actor . MainActivity " > 
 - < item android : id = " @ + id / action _ settings " android : title = " @ string / action _ settings " 
 - android : orderInCategory = " 100 " app : showAsAction = " never " / > 
 - < / menu > 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / build . gradle b / actor - sdk / sdk - core - android / android - sdk / build . gradle 
 index 0953b49 . . d7e97dc 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / build . gradle 
 + + + b / actor - sdk / sdk - core - android / android - sdk / build . gradle 
 @ @ - 1 , 29 + 1 , 10 @ @ 
 - 
 - 
 - repositories { 
 - mavenCentral ( ) 
 - jcenter ( ) 
 - maven { url ' https : / / mint . splunk . com / gradle / ' } 
 - } 
 - 
 buildscript { 
 dependencies { 
 classpath ' com . android . tools . build : gradle : 1 . 3 . 0 ' 
 - / / classpath ' com . neenbedankt . gradle . plugins : android - apt : 1 . 7 ' 
 } 
 } 
 
 apply plugin : ' com . android . library ' 
 - / / apply plugin : ' com . neenbedankt . android - apt ' 
 - 
 - def basicVersion = ' 1 . 0 ' 
 - def customVersionCode = ' 10240 ' ; 
 - if ( project . hasProperty ( ' buildIndex ' ) ) { 
 - project . version = basicVersion + ' . ' + project . buildIndex 
 - customVersionCode = ' ' + project . buildIndex 
 - } else { 
 - project . version = ' debug ' 
 - } 
 
 android { 
 
 @ @ - 33 , 12 + 14 , 12 @ @ android { 
 defaultConfig { 
 minSdkVersion 15 
 targetSdkVersion 23 
 - versionCode Integer . valueOf ( customVersionCode ) 
 - versionName project . version 
 } 
 
 - signingConfigs { 
 - release 
 + sourceSets { 
 + main { 
 + res . srcDirs = [ ' src / main / res ' , ' src / themes / main ' , ' src / material - icons ' ] 
 + } 
 } 
 
 / / buildTypes { 
 @ @ - 132 , 9 + 113 , 9 @ @ android { 
 / / targetCompatibility JavaVersion . VERSION _ 1 _ 6 
 / / } 
 / / 
 - / / lintOptions { 
 - / / abortOnError false 
 - / / } 
 + lintOptions { 
 + abortOnError false 
 + } 
 } 
 
 dependencies { 
 @ @ - 143 , 44 + 124 , 30 @ @ dependencies { 
 compile project ( ' : actor - sdk : sdk - core : core : android ' ) 
 compile ' com . droidkit : progress : 0 . 5 ' 
 compile ' com . soundcloud . android : android - crop : 1 . 0 . 0 @ aar ' 
 - compile ' com . facebook . fresco : fresco : 0 . 1 . 0 ' 
 - compile ' com . facebook . rebound : rebound : 0 . 3 . 7 ' 
 - compile ( ' com . github . chrisbanes . photoview : library : 1 . 2 . 3 ' ) { 
 + compile ' com . facebook . fresco : fresco : 0 + ' 
 + compile ' com . facebook . rebound : rebound : 0 + ' 
 + compile ( ' com . github . chrisbanes . photoview : library : 1 + ' ) { 
 exclude module : ' support - v13 ' 
 } 
 - compile ' com . getbase : floatingactionbutton : 1 . 5 . 1 ' 
 - compile ' com . afollestad : material - dialogs : 0 . 7 . 3 . 1 ' 
 - compile ' org . pegdown : pegdown : 1 . 5 . 0 ' 
 + compile ' com . getbase : floatingactionbutton : 1 + ' 
 + compile ' com . afollestad : material - dialogs : 0 + ' 
 + compile ' org . pegdown : pegdown : 1 + ' 
 
 / / Phone parser 
 compile files ( ' libs / libphonenumber - 5 . 9 . jar ' ) 
 
 / / Android Support 
 - compile ' com . android . support : support - v4 : 23 . 0 . 1 ' 
 - compile ' com . android . support : support - v13 : 23 . 0 . 1 ' 
 - compile ' com . android . support : appcompat - v7 : 23 . 0 . 1 ' 
 - compile ' com . android . support : palette - v7 : 23 . 0 . 1 ' 
 - compile ' com . android . support : recyclerview - v7 : 23 . 0 . 1 ' 
 + compile ' com . android . support : support - v4 : 23 + ' 
 + compile ' com . android . support : support - v13 : 23 + ' 
 + compile ' com . android . support : appcompat - v7 : 23 + ' 
 + compile ' com . android . support : palette - v7 : 23 + ' 
 + compile ' com . android . support : recyclerview - v7 : 23 + ' 
 
 - / / GCM 
 - releaseCompile ' com . google . android . gms : play - services - gcm : 7 . 5 . 0 ' 
 - debugCompile ' com . google . android . gms : play - services - gcm : 7 . 5 . 0 ' 
 - 
 - / / Integration 
 + / / / / GCM 
 + / / releaseCompile ' com . google . android . gms : play - services - gcm : 7 . 8 . 0 ' 
 + / / debugCompile ' com . google . android . gms : play - services - gcm : 7 . 8 . 0 ' 
 
 / / / / Annotation processing 
 / / apt " org . androidannotations : androidannotations : 3 . 3 . 2 " 
 / / compile " org . androidannotations : androidannotations - api : 3 . 3 . 2 " 
 - } 
 - 
 - task dist ( dependsOn : [ ' assembleRelease ' , ' assembleFree ' ] ) { 
 - doFirst { 
 - println " # # teamcity [ buildNumber ' $ { project . version } ' ] " 
 - } 
 - } 
 - 
 - def getDate ( ) { 
 - def date = new Date ( ) 
 - def formattedDate = date . format ( ' dd / MM / yy HH : mm : ss ' ) 
 - return formattedDate 
 - } 
 + } 
 \ No newline at end of file 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / messenger / app / core / ActorSDK . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / messenger / app / core / ActorSDK . java 
 index 659f9c5 . . 2fcfd7f 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / messenger / app / core / ActorSDK . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / messenger / app / core / ActorSDK . java 
 @ @ - 14 , 7 + 14 , 6 @ @ import org . json . JSONException ; 
 import java . io . IOException ; 
 
 import im . actor . core . AndroidMessenger ; 
 - import im . actor . core . AndroidPushActor ; 
 import im . actor . core . ApiConfiguration ; 
 import im . actor . core . ConfigurationBuilder ; 
 import im . actor . core . DeviceCategory ; 
 @ @ - 23 , 7 + 22 , 6 @ @ import im . actor . core . entity . Group ; 
 import im . actor . core . entity . User ; 
 import im . actor . core . viewmodel . GroupVM ; 
 import im . actor . core . viewmodel . UserVM ; 
 - import im . actor . messenger . BuildConfig ; 
 import im . actor . messenger . app . AppContext ; 
 import im . actor . messenger . app . activity . ActorMainActivity ; 
 import im . actor . messenger . app . view . emoji . SmileProcessor ; 
 @ @ - 54 , 13 + 52 , 13 @ @ public class ActorSDK { 
 
 Fresco . initialize ( application ) ; 
 
 - / / Keep Alive 
 - if ( BuildConfig . ENABLE _ KEEP _ ALIVE ) { 
 - Intent keepAliveService = new Intent ( application , KeepAliveService . class ) ; 
 - PendingIntent pintent = PendingIntent . getService ( application , 0 , keepAliveService , 0 ) ; 
 - AlarmManager alarm = ( AlarmManager ) application . getSystemService ( Context . ALARM _ SERVICE ) ; 
 - alarm . setRepeating ( AlarmManager . RTC , System . currentTimeMillis ( ) , 30 * 1000 , pintent ) ; 
 - } 
 + / / / / Keep Alive 
 + / / if ( BuildConfig . ENABLE _ KEEP _ ALIVE ) { 
 + / / Intent keepAliveService = new Intent ( application , KeepAliveService . class ) ; 
 + / / PendingIntent pintent = PendingIntent . getService ( application , 0 , keepAliveService , 0 ) ; 
 + / / AlarmManager alarm = ( AlarmManager ) application . getSystemService ( Context . ALARM _ SERVICE ) ; 
 + / / alarm . setRepeating ( AlarmManager . RTC , System . currentTimeMillis ( ) , 30 * 1000 , pintent ) ; 
 + / / } 
 
 / / Helpers 
 AppContext . setContext ( application ) ; 
 @ @ - 86 , 15 + 84 , 14 @ @ public class ActorSDK { 
 AppContext . getContext ( ) . getPackageName ( ) + " : " + Build . SERIAL ) ) ; 
 this . messenger = new AndroidMessenger ( AppContext . getContext ( ) , builder . build ( ) ) ; 
 
 - if ( getGcmProjectId ( ) ! = - 1 ) { 
 - androidPushesActor = system ( ) . actorOf ( Props . create ( AndroidPushActor . class , new ActorCreator < AndroidPushActor > ( ) { 
 - @ Override 
 - public AndroidPushActor create ( ) { 
 - return new AndroidPushActor ( application , sdk . messenger ) ; 
 - } 
 - } ) , " actor / android / push " ) ; 
 - } 
 - 
 + / / if ( getGcmProjectId ( ) ! = - 1 ) { 
 + / / androidPushesActor = system ( ) . actorOf ( Props . create ( AndroidPushActor . class , new ActorCreator < AndroidPushActor > ( ) { 
 + / / @ Override 
 + / / public AndroidPushActor create ( ) { 
 + / / return new AndroidPushActor ( application , sdk . messenger ) ; 
 + / / } 
 + / / } ) , " actor / android / push " ) ; 
 + / / } 
 } 
 
 public static ActorSDK sharedActor ( ) { 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / messenger / app / fragment / help / HelpFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / messenger / app / fragment / help / HelpFragment . java 
 index a645e18 . . 92f461b 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / messenger / app / fragment / help / HelpFragment . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / messenger / app / fragment / help / HelpFragment . java 
 @ @ - 10 , 7 + 10 , 6 @ @ import android . view . ViewGroup ; 
 import android . widget . TextView ; 
 import android . widget . Toast ; 
 
 - import im . actor . messenger . BuildConfig ; 
 import im . actor . messenger . R ; 
 import im . actor . messenger . app . fragment . BaseFragment ; 
 
 @ @ - 46 , 18 + 45 , 18 @ @ public class HelpFragment extends BaseFragment { 
 } 
 } ) ; 
 
 - final String versionName = BuildConfig . VERSION _ TITLE ; 
 - ( ( TextView ) res . findViewById ( R . id . version ) ) . setText ( versionName ) ; 
 - res . findViewById ( R . id . versionItem ) . setOnLongClickListener ( new View . OnLongClickListener ( ) { 
 - @ Override 
 - public boolean onLongClick ( View v ) { 
 - android . content . ClipboardManager clipboard = ( android . content . ClipboardManager ) getActivity ( ) . getSystemService ( Context . CLIPBOARD _ SERVICE ) ; 
 - android . content . ClipData clip = android . content . ClipData . newPlainText ( " App version " , versionName ) ; 
 - clipboard . setPrimaryClip ( clip ) ; 
 - Toast . makeText ( getActivity ( ) , R . string . help _ version _ copy , Toast . LENGTH _ SHORT ) . show ( ) ; 
 - return true ; 
 - } 
 - } ) ; 
 + / / final String versionName = BuildConfig . VERSION _ TITLE ; 
 + / / ( ( TextView ) res . findViewById ( R . id . version ) ) . setText ( versionName ) ; 
 + / / res . findViewById ( R . id . versionItem ) . setOnLongClickListener ( new View . OnLongClickListener ( ) { 
 + / / @ Override 
 + / / public boolean onLongClick ( View v ) { 
 + / / android . content . ClipboardManager clipboard = ( android . content . ClipboardManager ) getActivity ( ) . getSystemService ( Context . CLIPBOARD _ SERVICE ) ; 
 + / / android . content . ClipData clip = android . content . ClipData . newPlainText ( " App version " , versionName ) ; 
 + / / clipboard . setPrimaryClip ( clip ) ; 
 + / / Toast . makeText ( getActivity ( ) , R . string . help _ version _ copy , Toast . LENGTH _ SHORT ) . show ( ) ; 
 + / / return true ; 
 + / / } 
 + / / } ) ; 
 return res ; 
 } 
 } 
 diff - - git a / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / internal / messages / ConversationActor . java b / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / internal / messages / ConversationActor . java 
 index 5f112bd . . c6cf715 100644 
 - - - a / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / internal / messages / ConversationActor . java 
 + + + b / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / internal / messages / ConversationActor . java 
 @ @ - 139 , 8 + 139 , 7 @ @ public class ConversationActor extends ModuleActor { 
 if ( ! isHiddenPeer ) { 
 dialogsActor . send ( new DialogsActor . InMessage ( peer , topMessage , inPendingIndex . getCount ( ) ) ) ; 
 } 
 - dialogsGroupedActor . send ( new GroupedDialogsActor . NewMessage ( peer , inPendingIndex . getCount ( ) , 
 - topMessage . getSortDate ( ) ) ) ; 
 + dialogsGroupedActor . send ( new GroupedDialogsActor . CounterChanged ( peer , inPendingIndex . getCount ( ) ) ) ; 
 } 
 } 
 
 @ @ - 190 , 8 + 189 , 7 @ @ public class ConversationActor extends ModuleActor { 
 if ( ! isHiddenPeer ) { 
 dialogsActor . send ( new DialogsActor . InMessage ( peer , message , inPendingIndex . getCount ( ) ) ) ; 
 } 
 - dialogsGroupedActor . send ( new GroupedDialogsActor . NewMessage ( peer , inPendingIndex . getCount ( ) , 
 - message . getSortDate ( ) ) ) ; 
 + dialogsGroupedActor . send ( new GroupedDialogsActor . CounterChanged ( peer , inPendingIndex . getCount ( ) ) ) ; 
 } 
 } 
 
 @ @ - 245 , 8 + 243 , 7 @ @ public class ConversationActor extends ModuleActor { 
 if ( ! isHiddenPeer ) { 
 / / Updating dialog 
 dialogsActor . send ( new DialogsActor . InMessage ( peer , updatedMsg , inPendingIndex . getCount ( ) ) ) ; 
 - dialogsGroupedActor . send ( new GroupedDialogsActor . NewMessage ( peer , inPendingIndex . getCount ( ) , 
 - updatedMsg . getSortDate ( ) ) ) ; 
 + dialogsGroupedActor . send ( new GroupedDialogsActor . CounterChanged ( peer , inPendingIndex . getCount ( ) ) ) ; 
 } 
 
 / / Updating pending index 
 diff - - git a / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / internal / users / UsersProcessor . java b / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / internal / users / UsersProcessor . java 
 deleted file mode 100644 
 index dfbc311 . . 0000000 
 - - - a / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / internal / users / UsersProcessor . java 
 + + + / dev / null 
 @ @ - 1 , 204 + 0 , 0 @ @ 
 - package im . actor . core . modules . internal . users ; 
 - 
 - import java . util . ArrayList ; 
 - import java . util . Collection ; 
 - 
 - import im . actor . core . api . ApiAvatar ; 
 - import im . actor . core . api . ApiUser ; 
 - import im . actor . core . api . updates . UpdateUserAboutChanged ; 
 - import im . actor . core . api . updates . UpdateUserAvatarChanged ; 
 - import im . actor . core . api . updates . UpdateUserLocalNameChanged ; 
 - import im . actor . core . api . updates . UpdateUserNameChanged ; 
 - import im . actor . core . api . updates . UpdateUserNickChanged ; 
 - import im . actor . core . entity . Peer ; 
 - import im . actor . core . entity . User ; 
 - import im . actor . core . modules . AbsModule ; 
 - import im . actor . core . modules . ModuleContext ; 
 - import im . actor . core . modules . Processor ; 
 - import im . actor . core . modules . internal . contacts . ContactsSyncActor ; 
 - import im . actor . core . modules . internal . messages . DialogsActor ; 
 - import im . actor . core . modules . internal . messages . GroupedDialogsActor ; 
 - import im . actor . runtime . annotations . Verified ; 
 - 
 - import static im . actor . core . util . JavaUtil . equalsE ; 
 - 
 - public class UsersProcessor extends AbsModule implements Processor { 
 - 
 - public UsersProcessor ( ModuleContext context ) { 
 - super ( context ) ; 
 - } 
 - 
 - @ Verified 
 - public void applyUsers ( Collection < ApiUser > updated , boolean forced ) { 
 - ArrayList < User > batch = new ArrayList < User > ( ) ; 
 - for ( ApiUser u : updated ) { 
 - 
 - User saved = users ( ) . getValue ( u . getId ( ) ) ; 
 - if ( saved = = null ) { 
 - batch . add ( new User ( u ) ) ; 
 - } else if ( forced ) { 
 - User upd = new User ( u ) ; 
 - batch . add ( upd ) ; 
 - 
 - / / Sending changes to dialogs 
 - if ( ! upd . getName ( ) . equals ( saved . getName ( ) ) | | 
 - ! equalsE ( upd . getAvatar ( ) , saved . getAvatar ( ) ) ) { 
 - onUserDescChanged ( upd ) ; 
 - } 
 - } 
 - } 
 - if ( batch . size ( ) > 0 ) { 
 - users ( ) . addOrUpdateItems ( batch ) ; 
 - } 
 - } 
 - 
 - 
 - @ Verified 
 - public boolean hasUsers ( Collection < Integer > uids ) { 
 - for ( Integer uid : uids ) { 
 - if ( users ( ) . getValue ( uid ) = = null ) { 
 - return false ; 
 - } 
 - } 
 - return true ; 
 - } 
 - 
 - @ Verified 
 - private void onUserNameChanged ( int uid , String name ) { 
 - User u = users ( ) . getValue ( uid ) ; 
 - if ( u ! = null ) { 
 - 
 - / / Ignore if name not changed 
 - if ( u . getServerName ( ) . equals ( name ) ) { 
 - return ; 
 - } 
 - 
 - / / Changing user name 
 - u = u . editName ( name ) ; 
 - 
 - / / Updating user in collection 
 - users ( ) . addOrUpdateItem ( u ) ; 
 - 
 - / / Notify if user doesn ' t have local name 
 - if ( u . getLocalName ( ) = = null ) { 
 - onUserDescChanged ( u ) ; 
 - } 
 - } 
 - } 
 - 
 - @ Verified 
 - private void onUserNickChanged ( int uid , String nick ) { 
 - User u = users ( ) . getValue ( uid ) ; 
 - if ( u ! = null ) { 
 - 
 - / / Ignore if name not changed 
 - if ( equalsE ( u . getNick ( ) , nick ) ) { 
 - return ; 
 - } 
 - 
 - / / Changing user name 
 - u = u . editNick ( nick ) ; 
 - 
 - / / Updating user in collection 
 - users ( ) . addOrUpdateItem ( u ) ; 
 - } 
 - } 
 - 
 - @ Verified 
 - private void onUserAboutChanged ( int uid , String about ) { 
 - User u = users ( ) . getValue ( uid ) ; 
 - if ( u ! = null ) { 
 - 
 - / / Ignore if name not changed 
 - if ( equalsE ( u . getAbout ( ) , about ) ) { 
 - return ; 
 - } 
 - 
 - / / Changing about information 
 - u = u . editAbout ( about ) ; 
 - 
 - / / Updating user in collection 
 - users ( ) . addOrUpdateItem ( u ) ; 
 - } 
 - } 
 - 
 - @ Verified 
 - private void onUserLocalNameChanged ( int uid , String name ) { 
 - User u = users ( ) . getValue ( uid ) ; 
 - if ( u ! = null ) { 
 - 
 - / / Ignore if local name not changed 
 - if ( equalsE ( u . getLocalName ( ) , name ) ) { 
 - return ; 
 - } 
 - 
 - / / Changing user local name 
 - u = u . editLocalName ( name ) ; 
 - 
 - / / Updating user in collection 
 - users ( ) . addOrUpdateItem ( u ) ; 
 - 
 - / / Notify about user change 
 - onUserDescChanged ( u ) ; 
 - } 
 - } 
 - 
 - @ Verified 
 - private void onUserAvatarChanged ( int uid , ApiAvatar avatar ) { 
 - User u = users ( ) . getValue ( uid ) ; 
 - if ( u ! = null ) { 
 - 
 - / / Ignore if avatar not changed 
 - / / Disabled because of future - compatibility it is unable to check equality 
 - / / if ( equalsE ( u . getAvatar ( ) , new im . actor . model . entity . Avatar ( avatar ) ) ) { 
 - / / return ; 
 - / / } 
 - 
 - / / Changing user avatar 
 - u = u . editAvatar ( avatar ) ; 
 - 
 - / / Updating user in collection 
 - users ( ) . addOrUpdateItem ( u ) ; 
 - 
 - / / Notify about user change 
 - onUserDescChanged ( u ) ; 
 - } 
 - } 
 - 
 - @ Override 
 - public boolean process ( Object update ) { 
 - if ( update instanceof UpdateUserNameChanged ) { 
 - UpdateUserNameChanged userNameChanged = ( UpdateUserNameChanged ) update ; 
 - onUserNameChanged ( userNameChanged . getUid ( ) , userNameChanged . getName ( ) ) ; 
 - return true ; 
 - } else if ( update instanceof UpdateUserLocalNameChanged ) { 
 - UpdateUserLocalNameChanged localNameChanged = ( UpdateUserLocalNameChanged ) update ; 
 - onUserLocalNameChanged ( localNameChanged . getUid ( ) , localNameChanged . getLocalName ( ) ) ; 
 - return true ; 
 - } else if ( update instanceof UpdateUserNickChanged ) { 
 - UpdateUserNickChanged nickChanged = ( UpdateUserNickChanged ) update ; 
 - onUserNickChanged ( nickChanged . getUid ( ) , nickChanged . getNickname ( ) ) ; 
 - return true ; 
 - } else if ( update instanceof UpdateUserAboutChanged ) { 
 - UpdateUserAboutChanged userAboutChanged = ( UpdateUserAboutChanged ) update ; 
 - onUserAboutChanged ( userAboutChanged . getUid ( ) , userAboutChanged . getAbout ( ) ) ; 
 - return true ; 
 - } else if ( update instanceof UpdateUserAvatarChanged ) { 
 - UpdateUserAvatarChanged avatarChanged = ( UpdateUserAvatarChanged ) update ; 
 - onUserAvatarChanged ( avatarChanged . getUid ( ) , avatarChanged . getAvatar ( ) ) ; 
 - return true ; 
 - } 
 - return false ; 
 - } 
 - 
 - @ Verified 
 - private void onUserDescChanged ( User u ) { 
 - context ( ) . getMessagesModule ( ) . getDialogsActor ( ) . send ( 
 - new DialogsActor . UserChanged ( u ) ) ; 
 - context ( ) . getMessagesModule ( ) . getDialogsGroupedActor ( ) . send ( 
 - new GroupedDialogsActor . PeerInformationChanged ( Peer . user ( u . getUid ( ) ) , 
 - u . getName ( ) , u . getAvatar ( ) ) ) ; 
 - context ( ) . getContactsModule ( ) . getContactSyncActor ( ) 
 - . send ( new ContactsSyncActor . UserChanged ( u ) ) ; 
 - } 
 - } 
 diff - - git a / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / updates / GroupsProcessor . java b / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / updates / GroupsProcessor . java 
 index e430293 . . 4bc95f0 100644 
 - - - a / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / updates / GroupsProcessor . java 
 + + + b / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / updates / GroupsProcessor . java 
 @ @ - 301 , 7 + 301 , 6 @ @ public class GroupsProcessor extends AbsModule { 
 context ( ) . getMessagesModule ( ) . getDialogsActor ( ) 
 . send ( new DialogsActor . GroupChanged ( group ) ) ; 
 context ( ) . getMessagesModule ( ) . getDialogsGroupedActor ( ) . send ( 
 - new GroupedDialogsActor . PeerInformationChanged ( Peer . group ( group . getGroupId ( ) ) , 
 - group . getTitle ( ) , group . getAvatar ( ) ) ) ; 
 + new GroupedDialogsActor . PeerInformationChanged ( Peer . group ( group . getGroupId ( ) ) ) ) ; 
 } 
 } 
 \ No newline at end of file 
 diff - - git a / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / updates / UpdateProcessor . java b / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / updates / UpdateProcessor . java 
 index 9ab6741 . . 8a2998c 100644 
 - - - a / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / updates / UpdateProcessor . java 
 + + + b / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / updates / UpdateProcessor . java 
 @ @ - 49 , 7 + 49 , 6 @ @ import im . actor . core . modules . AbsModule ; 
 import im . actor . core . modules . ModuleContext ; 
 import im . actor . core . modules . internal . contacts . ContactsSyncActor ; 
 import im . actor . core . modules . internal . messages . OwnReadActor ; 
 - import im . actor . core . modules . internal . users . UsersProcessor ; 
 import im . actor . core . modules . updates . internal . CombinedDifference ; 
 import im . actor . core . modules . updates . internal . ContactsLoaded ; 
 import im . actor . core . modules . updates . internal . DialogHistoryLoaded ; 
 diff - - git a / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / updates / UsersProcessor . java b / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / updates / UsersProcessor . java 
 new file mode 100644 
 index 0000000 . . 6582775 
 - - - / dev / null 
 + + + b / actor - sdk / sdk - core / core / shared / src / main / java / im / actor / core / modules / updates / UsersProcessor . java 
 @ @ - 0 , 0 + 1 , 203 @ @ 
 + package im . actor . core . modules . updates ; 
 + 
 + import java . util . ArrayList ; 
 + import java . util . Collection ; 
 + 
 + import im . actor . core . api . ApiAvatar ; 
 + import im . actor . core . api . ApiUser ; 
 + import im . actor . core . api . updates . UpdateUserAboutChanged ; 
 + import im . actor . core . api . updates . UpdateUserAvatarChanged ; 
 + import im . actor . core . api . updates . UpdateUserLocalNameChanged ; 
 + import im . actor . core . api . updates . UpdateUserNameChanged ; 
 + import im . actor . core . api . updates . UpdateUserNickChanged ; 
 + import im . actor . core . entity . Peer ; 
 + import im . actor . core . entity . User ; 
 + import im . actor . core . modules . AbsModule ; 
 + import im . actor . core . modules . ModuleContext ; 
 + import im . actor . core . modules . Processor ; 
 + import im . actor . core . modules . internal . contacts . ContactsSyncActor ; 
 + import im . actor . core . modules . internal . messages . DialogsActor ; 
 + import im . actor . core . modules . internal . messages . GroupedDialogsActor ; 
 + import im . actor . runtime . annotations . Verified ; 
 + 
 + import static im . actor . core . util . JavaUtil . equalsE ; 
 + 
 + public class UsersProcessor extends AbsModule implements Processor { 
 + 
 + public UsersProcessor ( ModuleContext context ) { 
 + super ( context ) ; 
 + } 
 + 
 + @ Verified 
 + public void applyUsers ( Collection < ApiUser > updated , boolean forced ) { 
 + ArrayList < User > batch = new ArrayList < User > ( ) ; 
 + for ( ApiUser u : updated ) { 
 + 
 + User saved = users ( ) . getValue ( u . getId ( ) ) ; 
 + if ( saved = = null ) { 
 + batch . add ( new User ( u ) ) ; 
 + } else if ( forced ) { 
 + User upd = new User ( u ) ; 
 + batch . add ( upd ) ; 
 + 
 + / / Sending changes to dialogs 
 + if ( ! upd . getName ( ) . equals ( saved . getName ( ) ) | | 
 + ! equalsE ( upd . getAvatar ( ) , saved . getAvatar ( ) ) ) { 
 + onUserDescChanged ( upd ) ; 
 + } 
 + } 
 + } 
 + if ( batch . size ( ) > 0 ) { 
 + users ( ) . addOrUpdateItems ( batch ) ; 
 + } 
 + } 
 + 
 + 
 + @ Verified 
 + public boolean hasUsers ( Collection < Integer > uids ) { 
 + for ( Integer uid : uids ) { 
 + if ( users ( ) . getValue ( uid ) = = null ) { 
 + return false ; 
 + } 
 + } 
 + return true ; 
 + } 
 + 
 + @ Verified 
 + private void onUserNameChanged ( int uid , String name ) { 
 + User u = users ( ) . getValue ( uid ) ; 
 + if ( u ! = null ) { 
 + 
 + / / Ignore if name not changed 
 + if ( u . getServerName ( ) . equals ( name ) ) { 
 + return ; 
 + } 
 + 
 + / / Changing user name 
 + u = u . editName ( name ) ; 
 + 
 + / / Updating user in collection 
 + users ( ) . addOrUpdateItem ( u ) ; 
 + 
 + / / Notify if user doesn ' t have local name 
 + if ( u . getLocalName ( ) = = null ) { 
 + onUserDescChanged ( u ) ; 
 + } 
 + } 
 + } 
 + 
 + @ Verified 
 + private void onUserNickChanged ( int uid , String nick ) { 
 + User u = users ( ) . getValue ( uid ) ; 
 + if ( u ! = null ) { 
 + 
 + / / Ignore if name not changed 
 + if ( equalsE ( u . getNick ( ) , nick ) ) { 
 + return ; 
 + } 
 + 
 + / / Changing user name 
 + u = u . editNick ( nick ) ; 
 + 
 + / / Updating user in collection 
 + users ( ) . addOrUpdateItem ( u ) ; 
 + } 
 + } 
 + 
 + @ Verified 
 + private void onUserAboutChanged ( int uid , String about ) { 
 + User u = users ( ) . getValue ( uid ) ; 
 + if ( u ! = null ) { 
 + 
 + / / Ignore if name not changed 
 + if ( equalsE ( u . getAbout ( ) , about ) ) { 
 + return ; 
 + } 
 + 
 + / / Changing about information 
 + u = u . editAbout ( about ) ; 
 + 
 + / / Updating user in collection 
 + users ( ) . addOrUpdateItem ( u ) ; 
 + } 
 + } 
 + 
 + @ Verified 
 + private void onUserLocalNameChanged ( int uid , String name ) { 
 + User u = users ( ) . getValue ( uid ) ; 
 + if ( u ! = null ) { 
 + 
 + / / Ignore if local name not changed 
 + if ( equalsE ( u . getLocalName ( ) , name ) ) { 
 + return ; 
 + } 
 + 
 + / / Changing user local name 
 + u = u . editLocalName ( name ) ; 
 + 
 + / / Updating user in collection 
 + users ( ) . addOrUpdateItem ( u ) ; 
 + 
 + / / Notify about user change 
 + onUserDescChanged ( u ) ; 
 + } 
 + } 
 + 
 + @ Verified 
 + private void onUserAvatarChanged ( int uid , ApiAvatar avatar ) { 
 + User u = users ( ) . getValue ( uid ) ; 
 + if ( u ! = null ) { 
 + 
 + / / Ignore if avatar not changed 
 + / / Disabled because of future - compatibility it is unable to check equality 
 + / / if ( equalsE ( u . getAvatar ( ) , new im . actor . model . entity . Avatar ( avatar ) ) ) { 
 + / / return ; 
 + / / } 
 + 
 + / / Changing user avatar 
 + u = u . editAvatar ( avatar ) ; 
 + 
 + / / Updating user in collection 
 + users ( ) . addOrUpdateItem ( u ) ; 
 + 
 + / / Notify about user change 
 + onUserDescChanged ( u ) ; 
 + } 
 + } 
 + 
 + @ Override 
 + public boolean process ( Object update ) { 
 + if ( update instanceof UpdateUserNameChanged ) { 
 + UpdateUserNameChanged userNameChanged = ( UpdateUserNameChanged ) update ; 
 + onUserNameChanged ( userNameChanged . getUid ( ) , userNameChanged . getName ( ) ) ; 
 + return true ; 
 + } else if ( update instanceof UpdateUserLocalNameChanged ) { 
 + UpdateUserLocalNameChanged localNameChanged = ( UpdateUserLocalNameChanged ) update ; 
 + onUserLocalNameChanged ( localNameChanged . getUid ( ) , localNameChanged . getLocalName ( ) ) ; 
 + return true ; 
 + } else if ( update instanceof UpdateUserNickChanged ) { 
 + UpdateUserNickChanged nickChanged = ( UpdateUserNickChanged ) update ; 
 + onUserNickChanged ( nickChanged . getUid ( ) , nickChanged . getNickname ( ) ) ; 
 + return true ; 
 + } else if ( update instanceof UpdateUserAboutChanged ) { 
 + UpdateUserAboutChanged userAboutChanged = ( UpdateUserAboutChanged ) update ; 
 + onUserAboutChanged ( userAboutChanged . getUid ( ) , userAboutChanged . getAbout ( ) ) ; 
 + return true ; 
 + } else if ( update instanceof UpdateUserAvatarChanged ) { 
 + UpdateUserAvatarChanged avatarChanged = ( UpdateUserAvatarChanged ) update ; 
 + onUserAvatarChanged ( avatarChanged . getUid ( ) , avatarChanged . getAvatar ( ) ) ; 
 + return true ; 
 + } 
 + return false ; 
 + } 
 + 
 + @ Verified 
 + private void onUserDescChanged ( User u ) { 
 + context ( ) . getMessagesModule ( ) . getDialogsActor ( ) . send ( 
 + new DialogsActor . UserChanged ( u ) ) ; 
 + context ( ) . getMessagesModule ( ) . getDialogsGroupedActor ( ) . send ( 
 + new GroupedDialogsActor . PeerInformationChanged ( Peer . user ( u . getUid ( ) ) ) ) ; 
 + context ( ) . getContactsModule ( ) . getContactSyncActor ( ) 
 + . send ( new ContactsSyncActor . UserChanged ( u ) ) ; 
 + } 
 + } 
 diff - - git a / actor - sdk / sdk - core / runtime / js / src / main / java / im / actor / runtime / js / storage / JsKeyValueStorage . java b / actor - sdk / sdk - core / runtime / js / src / main / java / im / actor / runtime / js / storage / JsKeyValueStorage . java 
 index ac0d9e5 . . 8846506 100644 
 - - - a / actor - sdk / sdk - core / runtime / js / src / main / java / im / actor / runtime / js / storage / JsKeyValueStorage . java 
 + + + b / actor - sdk / sdk - core / runtime / js / src / main / java / im / actor / runtime / js / storage / JsKeyValueStorage . java 
 @ @ - 96 , 6 + 96 , 28 @ @ public class JsKeyValueStorage implements KeyValueStorage { 
 } 
 
 @ Override 
 + public byte [ ] loadItem ( long key ) { 
 + String res = storage . getItem ( getId ( key ) ) ; 
 + if ( res = = null ) { 
 + return null ; 
 + } else { 
 + return fromBase64 ( res ) ; 
 + } 
 + } 
 + 
 + @ Override 
 + public List < KeyValueRecord > loadItems ( long [ ] keys ) { 
 + / / TODO : Implement 
 + return null ; 
 + } 
 + 
 + @ Override 
 + public List < KeyValueRecord > loadAllItems ( ) { 
 + / / TODO : Implement 
 + return null ; 
 + } 
 + 
 + @ Override 
 public void clear ( ) { 
 for ( long id : items ) { 
 storage . removeItem ( getId ( id ) ) ; 
 @ @ - 104 , 16 + 126 , 6 @ @ public class JsKeyValueStorage implements KeyValueStorage { 
 items . clear ( ) ; 
 } 
 
 - @ Override 
 - public byte [ ] getValue ( long id ) { 
 - String res = storage . getItem ( getId ( id ) ) ; 
 - if ( res = = null ) { 
 - return null ; 
 - } else { 
 - return fromBase64 ( res ) ; 
 - } 
 - } 
 - 
 private void saveIndex ( ) { 
 DataOutput dataOutput = new DataOutput ( ) ; 
 dataOutput . writeInt ( items . size ( ) ) ; 
 diff - - git a / actor - sdk / sdk - core / runtime / js / src / main / java / im / actor / runtime / js / storage / JsListStorage . java b / actor - sdk / sdk - core / runtime / js / src / main / java / im / actor / runtime / js / storage / JsListStorage . java 
 index c9de314 . . 9fe0a70 100644 
 - - - a / actor - sdk / sdk - core / runtime / js / src / main / java / im / actor / runtime / js / storage / JsListStorage . java 
 + + + b / actor - sdk / sdk - core / runtime / js / src / main / java / im / actor / runtime / js / storage / JsListStorage . java 
 @ @ - 152 , 6 + 152 , 12 @ @ public class JsListStorage implements ListStorage { 
 } 
 
 @ Override 
 + public List < ListEngineRecord > loadAllItems ( ) { 
 + / / TODO : Implement 
 + return null ; 
 + } 
 + 
 + @ Override 
 public boolean isEmpty ( ) { 
 return getCount ( ) = = 0 ; 
 } 
 diff - - git a / settings . gradle b / settings . gradle 
 index c37071a . . 5d08eba 100644 
 - - - a / settings . gradle 
 + + + b / settings . gradle 
 @ @ - 37 , 4 + 37 , 4 @ @ include " : actor - sdk : sdk - core - ios " 
 / / SDK Bots 
 / / 
 
 - include " : actor - sdk : sdk - bot : bot - example " 
 \ No newline at end of file 
 + / / include " : actor - sdk : sdk - bot : bot - example " 
 \ No newline at end of file
