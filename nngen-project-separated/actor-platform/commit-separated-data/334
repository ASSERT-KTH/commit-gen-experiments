BLEU SCORE: 0.41374412020518814

TEST MSG: fix ( server : push ) : try to deliver pushes when delivery queue overflows
GENERATED MSG: fix ( server : push ) : fixed successful delivery report

TEST DIFF (one line): diff - - git a / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala b / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala < nl > index 6799e99 . . facda39 100644 < nl > - - - a / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala < nl > + + + b / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala < nl > @ @ - 157 , 6 + 157 , 7 @ @ private final class GooglePushDelivery extends ActorPublisher [ ( HttpRequest , Goog < nl > def receive = { < nl > case d : Delivery if buf . size = = MaxQueue ⇒ < nl > log . error ( " Current queue is already at size MaxQueue : { } , totalDemand : { } , ignoring delivery " , MaxQueue , totalDemand ) < nl > + deliverBuf ( ) < nl > case d : Delivery ⇒ < nl > if ( buf . isEmpty & & totalDemand > 0 ) { < nl > onNext ( mkJob ( d ) )
NEAREST DIFF (one line): diff - - git a / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala b / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala < nl > index 62c59a6 . . 6283f80 100644 < nl > - - - a / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala < nl > + + + b / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala < nl > @ @ - 88 , 7 + 88 , 7 @ @ final class GooglePushExtension ( system : ActorSystem ) extends Extension { < nl > case Xor . Right ( json ) ⇒ < nl > json . asObject match { < nl > case Some ( obj ) ⇒ < nl > - obj ( " error " ) map ( _ . asString ) foreach { < nl > + obj ( " error " ) flatMap ( _ . asString ) match { < nl > case Some ( " InvalidRegistration " ) ⇒ < nl > log . warning ( " Invalid registration , deleting " ) < nl > remove ( delivery . m . to )

TEST DIFF:
diff - - git a / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala b / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala 
 index 6799e99 . . facda39 100644 
 - - - a / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala 
 + + + b / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala 
 @ @ - 157 , 6 + 157 , 7 @ @ private final class GooglePushDelivery extends ActorPublisher [ ( HttpRequest , Goog 
 def receive = { 
 case d : Delivery if buf . size = = MaxQueue ⇒ 
 log . error ( " Current queue is already at size MaxQueue : { } , totalDemand : { } , ignoring delivery " , MaxQueue , totalDemand ) 
 + deliverBuf ( ) 
 case d : Delivery ⇒ 
 if ( buf . isEmpty & & totalDemand > 0 ) { 
 onNext ( mkJob ( d ) )

NEAREST DIFF:
diff - - git a / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala b / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala 
 index 62c59a6 . . 6283f80 100644 
 - - - a / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala 
 + + + b / actor - server / actor - core / src / main / scala / im / actor / server / sequence / GooglePushExtension . scala 
 @ @ - 88 , 7 + 88 , 7 @ @ final class GooglePushExtension ( system : ActorSystem ) extends Extension { 
 case Xor . Right ( json ) ⇒ 
 json . asObject match { 
 case Some ( obj ) ⇒ 
 - obj ( " error " ) map ( _ . asString ) foreach { 
 + obj ( " error " ) flatMap ( _ . asString ) match { 
 case Some ( " InvalidRegistration " ) ⇒ 
 log . warning ( " Invalid registration , deleting " ) 
 remove ( delivery . m . to )
