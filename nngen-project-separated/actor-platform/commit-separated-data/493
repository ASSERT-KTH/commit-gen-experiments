BLEU SCORE: 0.44632361378533286

TEST MSG: fix ( android ) : add activities package filter
GENERATED MSG: fix ( android ) : bad link crash

TEST DIFF (one line): diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / AndroidManifest . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / AndroidManifest . xml < nl > index 515ddad . . 9d9e8af 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / AndroidManifest . xml < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / AndroidManifest . xml < nl > @ @ - 273 , 7 + 273 , 7 @ @ < nl > android : theme = " @ style / CommonActivityTheme " > < nl > < intent - filter > < nl > < category android : name = " android . intent . category . DEFAULT " / > < nl > - < action android : name = " im . actor . pickLocation " / > < nl > + < action android : name = " im . actor . pickLocation _ $ { applicationId } " / > < nl > < / intent - filter > < nl > < / activity > < nl > < nl > @ @ - 284 , 7 + 284 , 7 @ @ < nl > android : windowSoftInputMode = " adjustResize " > < nl > < intent - filter > < nl > < category android : name = " android . intent . category . DEFAULT " / > < nl > - < action android : name = " im . actor . locationPreview " / > < nl > + < action android : name = " im . actor . locationPreview _ $ { applicationId } " / > < nl > < / intent - filter > < nl > < / activity > < nl > < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / LocationHolder . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / LocationHolder . java < nl > index cea9be2 . . a763588 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / LocationHolder . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / LocationHolder . java < nl > @ @ - 33 , 6 + 33 , 7 @ @ import im . actor . core . entity . content . LocationContent ; < nl > import im . actor . core . viewmodel . FileVM ; < nl > import im . actor . core . viewmodel . UploadFileVM ; < nl > import im . actor . sdk . ActorSDK ; < nl > + < nl > import im . actor . sdk . R ; < nl > import im . actor . sdk . controllers . conversation . MessagesAdapter ; < nl > import im . actor . sdk . controllers . conversation . messages . preprocessor . PreprocessedData ; < nl > @ @ - 160 , 7 + 161 , 7 @ @ public class LocationHolder extends MessageHolder { < nl > < nl > try { < nl > Class . forName ( " com . google . android . gms . maps . GoogleMap " ) ; < nl > - Intent intent = new Intent ( " im . actor . locationPreview " ) ; < nl > + Intent intent = new Intent ( " im . actor . locationPreview _ " + context . getPackageName ( ) ) ; < nl > intent . putExtra ( " latitude " , latitude ) ; < nl > intent . putExtra ( " longitude " , longitude ) ; < nl > context . startActivity ( intent ) ; < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / pickers / Intents . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / pickers / Intents . java < nl > index 4e5e54d . . ee56a0e 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / pickers / Intents . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / pickers / Intents . java < nl > @ @ - 3 , 6 + 3 , 7 @ @ package im . actor . sdk . controllers . pickers ; < nl > import android . content . Context ; < nl > import android . content . Intent ; < nl > < nl > + import im . actor . sdk . BuildConfig ; < nl > import im . actor . sdk . controllers . pickers . file . FilePickerActivity ; < nl > < nl > < nl > @ @ - 16 , 7 + 17 , 7 @ @ public class Intents { < nl > < nl > < nl > public static Intent pickLocation ( Context context ) { < nl > - Intent intent = new Intent ( " im . actor . pickLocation " ) ; < nl > + Intent intent = new Intent ( " im . actor . pickLocation _ " + context . getPackageName ( ) ) ; < nl > return intent ; < nl > }
NEAREST DIFF (one line): diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / ChatListProcessor . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / ChatListProcessor . java < nl > index f8ee6ef . . 8a52e33 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / ChatListProcessor . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / ChatListProcessor . java < nl > @ @ - 29 , 6 + 29 , 7 @ @ import im . actor . sdk . ActorSDK ; < nl > import im . actor . sdk . R ; < nl > import im . actor . sdk . controllers . conversation . view . MentionSpan ; < nl > import im . actor . sdk . util . Strings ; < nl > + import im . actor . sdk . view . BaseUrlSpan ; < nl > import im . actor . sdk . view . emoji . SmileProcessor ; < nl > import im . actor . sdk . view . markdown . AndroidMarkdown ; < nl > import im . actor . runtime . generic . mvvm . ListProcessor ; < nl > @ @ - 251 , 7 + 252 , 7 @ @ public class ChatListProcessor implements ListProcessor < Message > { < nl > return false ; < nl > } < nl > < nl > - URLSpan span = ( isMention & & isGroup & & found ) ? new MentionSpan ( nick , userId , false ) : new URLSpan ( m . group ( ) ) ; < nl > + URLSpan span = ( isMention & & isGroup & & found ) ? new MentionSpan ( nick , userId , false ) : new BaseUrlSpan ( m . group ( ) , false ) ; < nl > < nl > < nl > spannable . setSpan ( span , m . start ( ) , m . end ( ) , Spanned . SPAN _ EXCLUSIVE _ EXCLUSIVE ) ; < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / view / markdown / AndroidMarkdown . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / view / markdown / AndroidMarkdown . java < nl > index 50efbd8 . . cea6b77 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / view / markdown / AndroidMarkdown . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / view / markdown / AndroidMarkdown . java < nl > @ @ - 12 , 6 + 12 , 7 @ @ import android . text . style . ForegroundColorSpan ; < nl > import android . text . style . RelativeSizeSpan ; < nl > import android . text . style . StyleSpan ; < nl > import android . view . View ; < nl > + import android . widget . Toast ; < nl > < nl > import im . actor . sdk . controllers . fragment . preview . CodePreviewActivity ; < nl > import im . actor . runtime . android . AndroidContext ; < nl > @ @ - 92 , 10 + 93 , 16 @ @ public class AndroidMarkdown { < nl > builder . setSpan ( new ClickableSpan ( ) { < nl > @ Override < nl > public void onClick ( View view ) { < nl > - AndroidContext . getContext ( ) . startActivity ( < nl > - new Intent ( Intent . ACTION _ VIEW ) < nl > - . setData ( Uri . parse ( url . getUrl ( ) ) ) < nl > - . setFlags ( Intent . FLAG _ ACTIVITY _ NEW _ TASK ) ) ; < nl > + Intent intent = new Intent ( Intent . ACTION _ VIEW ) < nl > + . setData ( Uri . parse ( url . getUrl ( ) ) ) < nl > + . setFlags ( Intent . FLAG _ ACTIVITY _ NEW _ TASK ) ; < nl > + if ( intent . resolveActivity ( view . getContext ( ) . getPackageManager ( ) ) ! = null ) { < nl > + AndroidContext . getContext ( ) . startActivity ( < nl > + intent ) ; < nl > + } else { < nl > + Toast . makeText ( view . getContext ( ) , " Unknown URL type " , Toast . LENGTH _ SHORT ) . show ( ) ; < nl > + } < nl > + < nl > } < nl > } , start , builder . length ( ) , Spanned . SPAN _ EXCLUSIVE _ EXCLUSIVE ) ; < nl > } else {

TEST DIFF:
diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / AndroidManifest . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / AndroidManifest . xml 
 index 515ddad . . 9d9e8af 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / AndroidManifest . xml 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / AndroidManifest . xml 
 @ @ - 273 , 7 + 273 , 7 @ @ 
 android : theme = " @ style / CommonActivityTheme " > 
 < intent - filter > 
 < category android : name = " android . intent . category . DEFAULT " / > 
 - < action android : name = " im . actor . pickLocation " / > 
 + < action android : name = " im . actor . pickLocation _ $ { applicationId } " / > 
 < / intent - filter > 
 < / activity > 
 
 @ @ - 284 , 7 + 284 , 7 @ @ 
 android : windowSoftInputMode = " adjustResize " > 
 < intent - filter > 
 < category android : name = " android . intent . category . DEFAULT " / > 
 - < action android : name = " im . actor . locationPreview " / > 
 + < action android : name = " im . actor . locationPreview _ $ { applicationId } " / > 
 < / intent - filter > 
 < / activity > 
 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / LocationHolder . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / LocationHolder . java 
 index cea9be2 . . a763588 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / LocationHolder . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / LocationHolder . java 
 @ @ - 33 , 6 + 33 , 7 @ @ import im . actor . core . entity . content . LocationContent ; 
 import im . actor . core . viewmodel . FileVM ; 
 import im . actor . core . viewmodel . UploadFileVM ; 
 import im . actor . sdk . ActorSDK ; 
 + 
 import im . actor . sdk . R ; 
 import im . actor . sdk . controllers . conversation . MessagesAdapter ; 
 import im . actor . sdk . controllers . conversation . messages . preprocessor . PreprocessedData ; 
 @ @ - 160 , 7 + 161 , 7 @ @ public class LocationHolder extends MessageHolder { 
 
 try { 
 Class . forName ( " com . google . android . gms . maps . GoogleMap " ) ; 
 - Intent intent = new Intent ( " im . actor . locationPreview " ) ; 
 + Intent intent = new Intent ( " im . actor . locationPreview _ " + context . getPackageName ( ) ) ; 
 intent . putExtra ( " latitude " , latitude ) ; 
 intent . putExtra ( " longitude " , longitude ) ; 
 context . startActivity ( intent ) ; 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / pickers / Intents . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / pickers / Intents . java 
 index 4e5e54d . . ee56a0e 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / pickers / Intents . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / pickers / Intents . java 
 @ @ - 3 , 6 + 3 , 7 @ @ package im . actor . sdk . controllers . pickers ; 
 import android . content . Context ; 
 import android . content . Intent ; 
 
 + import im . actor . sdk . BuildConfig ; 
 import im . actor . sdk . controllers . pickers . file . FilePickerActivity ; 
 
 
 @ @ - 16 , 7 + 17 , 7 @ @ public class Intents { 
 
 
 public static Intent pickLocation ( Context context ) { 
 - Intent intent = new Intent ( " im . actor . pickLocation " ) ; 
 + Intent intent = new Intent ( " im . actor . pickLocation _ " + context . getPackageName ( ) ) ; 
 return intent ; 
 }

NEAREST DIFF:
diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / ChatListProcessor . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / ChatListProcessor . java 
 index f8ee6ef . . 8a52e33 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / ChatListProcessor . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / ChatListProcessor . java 
 @ @ - 29 , 6 + 29 , 7 @ @ import im . actor . sdk . ActorSDK ; 
 import im . actor . sdk . R ; 
 import im . actor . sdk . controllers . conversation . view . MentionSpan ; 
 import im . actor . sdk . util . Strings ; 
 + import im . actor . sdk . view . BaseUrlSpan ; 
 import im . actor . sdk . view . emoji . SmileProcessor ; 
 import im . actor . sdk . view . markdown . AndroidMarkdown ; 
 import im . actor . runtime . generic . mvvm . ListProcessor ; 
 @ @ - 251 , 7 + 252 , 7 @ @ public class ChatListProcessor implements ListProcessor < Message > { 
 return false ; 
 } 
 
 - URLSpan span = ( isMention & & isGroup & & found ) ? new MentionSpan ( nick , userId , false ) : new URLSpan ( m . group ( ) ) ; 
 + URLSpan span = ( isMention & & isGroup & & found ) ? new MentionSpan ( nick , userId , false ) : new BaseUrlSpan ( m . group ( ) , false ) ; 
 
 
 spannable . setSpan ( span , m . start ( ) , m . end ( ) , Spanned . SPAN _ EXCLUSIVE _ EXCLUSIVE ) ; 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / view / markdown / AndroidMarkdown . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / view / markdown / AndroidMarkdown . java 
 index 50efbd8 . . cea6b77 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / view / markdown / AndroidMarkdown . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / view / markdown / AndroidMarkdown . java 
 @ @ - 12 , 6 + 12 , 7 @ @ import android . text . style . ForegroundColorSpan ; 
 import android . text . style . RelativeSizeSpan ; 
 import android . text . style . StyleSpan ; 
 import android . view . View ; 
 + import android . widget . Toast ; 
 
 import im . actor . sdk . controllers . fragment . preview . CodePreviewActivity ; 
 import im . actor . runtime . android . AndroidContext ; 
 @ @ - 92 , 10 + 93 , 16 @ @ public class AndroidMarkdown { 
 builder . setSpan ( new ClickableSpan ( ) { 
 @ Override 
 public void onClick ( View view ) { 
 - AndroidContext . getContext ( ) . startActivity ( 
 - new Intent ( Intent . ACTION _ VIEW ) 
 - . setData ( Uri . parse ( url . getUrl ( ) ) ) 
 - . setFlags ( Intent . FLAG _ ACTIVITY _ NEW _ TASK ) ) ; 
 + Intent intent = new Intent ( Intent . ACTION _ VIEW ) 
 + . setData ( Uri . parse ( url . getUrl ( ) ) ) 
 + . setFlags ( Intent . FLAG _ ACTIVITY _ NEW _ TASK ) ; 
 + if ( intent . resolveActivity ( view . getContext ( ) . getPackageManager ( ) ) ! = null ) { 
 + AndroidContext . getContext ( ) . startActivity ( 
 + intent ) ; 
 + } else { 
 + Toast . makeText ( view . getContext ( ) , " Unknown URL type " , Toast . LENGTH _ SHORT ) . show ( ) ; 
 + } 
 + 
 } 
 } , start , builder . length ( ) , Spanned . SPAN _ EXCLUSIVE _ EXCLUSIVE ) ; 
 } else {
