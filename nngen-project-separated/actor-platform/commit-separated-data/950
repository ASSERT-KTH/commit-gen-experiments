BLEU SCORE: 0.11457509197294043

TEST MSG: fix ( iOS ) : Fixing iOS compilation errors
GENERATED MSG: fix ( js ) : Fixing search binding and built - in interval . js

TEST DIFF (one line): diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorCore / Makefile b / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorCore / Makefile < nl > index 9a1061d . . 47d2bb5 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorCore / Makefile < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorCore / Makefile < nl > @ @ - 101 , 9 + 101 , 10 @ @ $ ( foreach root , $ ( SOURCE _ ROOTS ) , $ ( eval $ ( call SOURCE _ ROOT _ RULE , $ ( root ) ) ) ) < nl > # @ ar rcs $ ( OBJ _ DIR ) / $ ( LIBRARY _ NAME ) $ ( OBJECT _ FILES ) < nl > # @ rm - f $ ( OBJ _ DIR ) / $ ( LIBRARY _ NAME ) < nl > # $ ( call max _ args , @ ar crv $ ( OBJ _ DIR ) / $ ( LIBRARY _ NAME ) , 2 , $ ( OBJECT _ FILES ) ) < nl > + # @ $ ( call max _ args , ar rcs $ ( OBJ _ DIR ) / $ ( LIBRARY _ NAME ) , 1100 , $ ( OBJECT _ FILES ) ) < nl > build : $ ( OBJ _ DIR ) $ ( OBJECT _ FILES ) < nl > 	 @ rm - f $ ( OBJ _ DIR ) / $ ( LIBRARY _ NAME ) < nl > - 	 @ $ ( call max _ args , ar rcs $ ( OBJ _ DIR ) / $ ( LIBRARY _ NAME ) , 600 , $ ( OBJECT _ FILES ) ) < nl > + 	 @ ar rcs $ ( OBJ _ DIR ) / $ ( LIBRARY _ NAME ) $ ( OBJECT _ FILES ) < nl > 	 @ ranlib $ ( OBJ _ DIR ) / $ ( LIBRARY _ NAME ) < nl > < nl > $ ( OBJ _ DIR ) / % . o : $ ( SOURCES _ DIR ) / % . m < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / sequence / SequenceActor . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / sequence / SequenceActor . java < nl > index d63c00c . . d68534b 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / sequence / SequenceActor . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / sequence / SequenceActor . java < nl > @ @ - 196 , 7 + 196 , 9 @ @ public class SequenceActor extends ModuleActor { < nl > } < nl > < nl > Log . d ( TAG , " Difference loaded { seq = " + response . getSeq ( ) + " } in " < nl > - + ( im . actor . runtime . Runtime . getCurrentTime ( ) - loadStart ) + " ms " ) ; < nl > + + ( im . actor . runtime . Runtime . getCurrentTime ( ) - loadStart ) + " ms , " + < nl > + " userRefs : " + response . getUsersRefs ( ) . size ( ) + " , " + < nl > + " groupRefs : " + response . getGroupsRefs ( ) . size ( ) ) ; < nl > < nl > handler . onDifferenceUpdate ( response ) . then ( new Consumer < SequenceHandlerActor . UpdateProcessed > ( ) { < nl > @ Override
NEAREST DIFF (one line): diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / internal / SearchModule . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / internal / SearchModule . java < nl > index 6572049 . . 093e3a5 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / internal / SearchModule . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / internal / SearchModule . java < nl > @ @ - 38 , 6 + 38 , 7 @ @ import im . actor . core . network . RpcCallback ; < nl > import im . actor . core . network . RpcException ; < nl > import im . actor . core . viewmodel . Command ; < nl > import im . actor . core . viewmodel . CommandCallback ; < nl > + import im . actor . runtime . Log ; < nl > import im . actor . runtime . Storage ; < nl > import im . actor . runtime . actors . ActorCreator ; < nl > import im . actor . runtime . actors . ActorRef ; < nl > @ @ - 119 , 7 + 120 , 7 @ @ public class SearchModule extends AbsModule { < nl > updates ( ) . executeRelatedResponse ( response . getUsers ( ) , response . getGroups ( ) , new Runnable ( ) { < nl > @ Override < nl > public void run ( ) { < nl > - ArrayList < MessageSearchEntity > res = new ArrayList < MessageSearchEntity > ( ) ; < nl > + final ArrayList < MessageSearchEntity > res = new ArrayList < MessageSearchEntity > ( ) ; < nl > for ( ApiMessageSearchItem r : response . getSearchResults ( ) ) { < nl > ApiMessageSearchResult itm = r . getResult ( ) ; < nl > try { < nl > @ @ - 131 , 6 + 132 , 12 @ @ public class SearchModule extends AbsModule { < nl > e . printStackTrace ( ) ; < nl > } < nl > } < nl > + runOnUiThread ( new Runnable ( ) { < nl > + @ Override < nl > + public void run ( ) { < nl > + callback . onResult ( res ) ; < nl > + } < nl > + } ) ; < nl > } < nl > } ) ; < nl > } < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / updates / SequenceActor . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / updates / SequenceActor . java < nl > index e5a9f75 . . fb14eb8 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / updates / SequenceActor . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / updates / SequenceActor . java < nl > @ @ - 125 , 7 + 125 , 7 @ @ public class SequenceActor extends ModuleActor { < nl > pendingRunnables . add ( after ) ; < nl > } < nl > return ; < nl > - } else if ( u instanceof PushSeq ) { < nl > + } else if ( u instanceof PushSeq ) { < nl > PushSeq pushSeq = ( PushSeq ) u ; < nl > if ( pushSeq . seq < = this . seq ) { < nl > Log . d ( TAG , " Ignored PushSeq { seq : " + pushSeq . seq + " } " ) ; < nl > diff - - git a / actor - sdk / sdk - core / runtime / runtime - js / src / main / java / im / actor / runtime / js / threading / JsSecureInterval . java b / actor - sdk / sdk - core / runtime / runtime - js / src / main / java / im / actor / runtime / js / threading / JsSecureInterval . java < nl > index 7769a62 . . 4beb2dc 100644 < nl > - - - a / actor - sdk / sdk - core / runtime / runtime - js / src / main / java / im / actor / runtime / js / threading / JsSecureInterval . java < nl > + + + b / actor - sdk / sdk - core / runtime / runtime - js / src / main / java / im / actor / runtime / js / threading / JsSecureInterval . java < nl > @ @ - 11 , 12 + 11 , 42 @ @ import com . google . gwt . core . client . JavaScriptObject ; < nl > * that work in background tabs < nl > * / < nl > public class JsSecureInterval extends JavaScriptObject { < nl > + < nl > public static native JsSecureInterval create ( Runnable runnable ) / * - { < nl > console . warn ( " Create jsSecureInverval " ) < nl > try { < nl > if ( typeof ( Worker ) ! = = " undefined " ) { < nl > - var worker = new Worker ( " interval . js " ) ; < nl > + < nl > + var code = " var timerId ; \ n " + < nl > + " \ n " + < nl > + " self . addEventListener ( ' message ' , function ( e ) { \ n " + < nl > + " switch ( e . data . message ) { \ n " + < nl > + " case ' schedule ' : \ n " + < nl > + " if ( timerId ) { \ n " + < nl > + " clearTimeout ( timerId ) ; \ n " + < nl > + " timerId = null ; \ n " + < nl > + " } \ n " + < nl > + " timerId = setTimeout ( function ( ) { \ n " + < nl > + " self . postMessage ( ' doSchedule ' ) ; \ n " + < nl > + " } , e . data . delay ) ; \ n " + < nl > + " break ; \ n " + < nl > + " case ' cancel ' : \ n " + < nl > + " if ( timerId ) { \ n " + < nl > + " clearTimeout ( timerId ) ; \ n " + < nl > + " timerId = null ; \ n " + < nl > + " } \ n " + < nl > + " break ; \ n " + < nl > + " } ; \ n " + < nl > + " } ) ; \ n " < nl > + < nl > + var codeBlob = new Blob ( [ code ] ) ; < nl > + var codeBlobURL = window . URL . createObjectURL ( codeBlob ) ; < nl > + < nl > + var worker = new Worker ( codeBlobURL ) ; < nl > var _ runnable = runnable ; < nl > + worker . addEventListener ( ' error ' , function ( ) { < nl > + console . warn ( " Worker error " ) < nl > + } , false ) ; < nl > worker . onmessage = function ( ) { < nl > _ runnable . @ java . lang . Runnable : : run ( ) ( ) ; < nl > } ;

TEST DIFF:
diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorCore / Makefile b / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorCore / Makefile 
 index 9a1061d . . 47d2bb5 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorCore / Makefile 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorCore / Makefile 
 @ @ - 101 , 9 + 101 , 10 @ @ $ ( foreach root , $ ( SOURCE _ ROOTS ) , $ ( eval $ ( call SOURCE _ ROOT _ RULE , $ ( root ) ) ) ) 
 # @ ar rcs $ ( OBJ _ DIR ) / $ ( LIBRARY _ NAME ) $ ( OBJECT _ FILES ) 
 # @ rm - f $ ( OBJ _ DIR ) / $ ( LIBRARY _ NAME ) 
 # $ ( call max _ args , @ ar crv $ ( OBJ _ DIR ) / $ ( LIBRARY _ NAME ) , 2 , $ ( OBJECT _ FILES ) ) 
 + # @ $ ( call max _ args , ar rcs $ ( OBJ _ DIR ) / $ ( LIBRARY _ NAME ) , 1100 , $ ( OBJECT _ FILES ) ) 
 build : $ ( OBJ _ DIR ) $ ( OBJECT _ FILES ) 
 	 @ rm - f $ ( OBJ _ DIR ) / $ ( LIBRARY _ NAME ) 
 - 	 @ $ ( call max _ args , ar rcs $ ( OBJ _ DIR ) / $ ( LIBRARY _ NAME ) , 600 , $ ( OBJECT _ FILES ) ) 
 + 	 @ ar rcs $ ( OBJ _ DIR ) / $ ( LIBRARY _ NAME ) $ ( OBJECT _ FILES ) 
 	 @ ranlib $ ( OBJ _ DIR ) / $ ( LIBRARY _ NAME ) 
 
 $ ( OBJ _ DIR ) / % . o : $ ( SOURCES _ DIR ) / % . m 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / sequence / SequenceActor . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / sequence / SequenceActor . java 
 index d63c00c . . d68534b 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / sequence / SequenceActor . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / sequence / SequenceActor . java 
 @ @ - 196 , 7 + 196 , 9 @ @ public class SequenceActor extends ModuleActor { 
 } 
 
 Log . d ( TAG , " Difference loaded { seq = " + response . getSeq ( ) + " } in " 
 - + ( im . actor . runtime . Runtime . getCurrentTime ( ) - loadStart ) + " ms " ) ; 
 + + ( im . actor . runtime . Runtime . getCurrentTime ( ) - loadStart ) + " ms , " + 
 + " userRefs : " + response . getUsersRefs ( ) . size ( ) + " , " + 
 + " groupRefs : " + response . getGroupsRefs ( ) . size ( ) ) ; 
 
 handler . onDifferenceUpdate ( response ) . then ( new Consumer < SequenceHandlerActor . UpdateProcessed > ( ) { 
 @ Override

NEAREST DIFF:
diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / internal / SearchModule . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / internal / SearchModule . java 
 index 6572049 . . 093e3a5 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / internal / SearchModule . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / internal / SearchModule . java 
 @ @ - 38 , 6 + 38 , 7 @ @ import im . actor . core . network . RpcCallback ; 
 import im . actor . core . network . RpcException ; 
 import im . actor . core . viewmodel . Command ; 
 import im . actor . core . viewmodel . CommandCallback ; 
 + import im . actor . runtime . Log ; 
 import im . actor . runtime . Storage ; 
 import im . actor . runtime . actors . ActorCreator ; 
 import im . actor . runtime . actors . ActorRef ; 
 @ @ - 119 , 7 + 120 , 7 @ @ public class SearchModule extends AbsModule { 
 updates ( ) . executeRelatedResponse ( response . getUsers ( ) , response . getGroups ( ) , new Runnable ( ) { 
 @ Override 
 public void run ( ) { 
 - ArrayList < MessageSearchEntity > res = new ArrayList < MessageSearchEntity > ( ) ; 
 + final ArrayList < MessageSearchEntity > res = new ArrayList < MessageSearchEntity > ( ) ; 
 for ( ApiMessageSearchItem r : response . getSearchResults ( ) ) { 
 ApiMessageSearchResult itm = r . getResult ( ) ; 
 try { 
 @ @ - 131 , 6 + 132 , 12 @ @ public class SearchModule extends AbsModule { 
 e . printStackTrace ( ) ; 
 } 
 } 
 + runOnUiThread ( new Runnable ( ) { 
 + @ Override 
 + public void run ( ) { 
 + callback . onResult ( res ) ; 
 + } 
 + } ) ; 
 } 
 } ) ; 
 } 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / updates / SequenceActor . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / updates / SequenceActor . java 
 index e5a9f75 . . fb14eb8 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / updates / SequenceActor . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / updates / SequenceActor . java 
 @ @ - 125 , 7 + 125 , 7 @ @ public class SequenceActor extends ModuleActor { 
 pendingRunnables . add ( after ) ; 
 } 
 return ; 
 - } else if ( u instanceof PushSeq ) { 
 + } else if ( u instanceof PushSeq ) { 
 PushSeq pushSeq = ( PushSeq ) u ; 
 if ( pushSeq . seq < = this . seq ) { 
 Log . d ( TAG , " Ignored PushSeq { seq : " + pushSeq . seq + " } " ) ; 
 diff - - git a / actor - sdk / sdk - core / runtime / runtime - js / src / main / java / im / actor / runtime / js / threading / JsSecureInterval . java b / actor - sdk / sdk - core / runtime / runtime - js / src / main / java / im / actor / runtime / js / threading / JsSecureInterval . java 
 index 7769a62 . . 4beb2dc 100644 
 - - - a / actor - sdk / sdk - core / runtime / runtime - js / src / main / java / im / actor / runtime / js / threading / JsSecureInterval . java 
 + + + b / actor - sdk / sdk - core / runtime / runtime - js / src / main / java / im / actor / runtime / js / threading / JsSecureInterval . java 
 @ @ - 11 , 12 + 11 , 42 @ @ import com . google . gwt . core . client . JavaScriptObject ; 
 * that work in background tabs 
 * / 
 public class JsSecureInterval extends JavaScriptObject { 
 + 
 public static native JsSecureInterval create ( Runnable runnable ) / * - { 
 console . warn ( " Create jsSecureInverval " ) 
 try { 
 if ( typeof ( Worker ) ! = = " undefined " ) { 
 - var worker = new Worker ( " interval . js " ) ; 
 + 
 + var code = " var timerId ; \ n " + 
 + " \ n " + 
 + " self . addEventListener ( ' message ' , function ( e ) { \ n " + 
 + " switch ( e . data . message ) { \ n " + 
 + " case ' schedule ' : \ n " + 
 + " if ( timerId ) { \ n " + 
 + " clearTimeout ( timerId ) ; \ n " + 
 + " timerId = null ; \ n " + 
 + " } \ n " + 
 + " timerId = setTimeout ( function ( ) { \ n " + 
 + " self . postMessage ( ' doSchedule ' ) ; \ n " + 
 + " } , e . data . delay ) ; \ n " + 
 + " break ; \ n " + 
 + " case ' cancel ' : \ n " + 
 + " if ( timerId ) { \ n " + 
 + " clearTimeout ( timerId ) ; \ n " + 
 + " timerId = null ; \ n " + 
 + " } \ n " + 
 + " break ; \ n " + 
 + " } ; \ n " + 
 + " } ) ; \ n " 
 + 
 + var codeBlob = new Blob ( [ code ] ) ; 
 + var codeBlobURL = window . URL . createObjectURL ( codeBlob ) ; 
 + 
 + var worker = new Worker ( codeBlobURL ) ; 
 var _ runnable = runnable ; 
 + worker . addEventListener ( ' error ' , function ( ) { 
 + console . warn ( " Worker error " ) 
 + } , false ) ; 
 worker . onmessage = function ( ) { 
 _ runnable . @ java . lang . Runnable : : run ( ) ( ) ; 
 } ;
