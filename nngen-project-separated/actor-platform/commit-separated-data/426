BLEU SCORE: 0.09662504873924324

TEST MSG: fix ( android ) : recover save phoneBook ids
GENERATED MSG: fix ( core ) : Fix crash on receiving updates before auth

TEST DIFF (one line): diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / contacts / InviteContactAdapter . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / contacts / InviteContactAdapter . java < nl > index f10a333 . . e34f558 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / contacts / InviteContactAdapter . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / contacts / InviteContactAdapter . java < nl > @ @ - 37 , 14 + 37 , 7 @ @ public class InviteContactAdapter extends BindedListAdapter < PhoneBookContact , In < nl > this . context = context ; < nl > this . onItemClickedListener = onItemClickedListener ; < nl > < nl > - try { < nl > - PhoneBookIds ids = Bser . parse ( new PhoneBookIds ( ) , messenger ( ) . getPreferences ( ) . getBytes ( " phone _ book _ ids " ) ) ; < nl > - for ( long id : ids . getIds ( ) ) { < nl > - selectedUsers . add ( id ) ; < nl > - } < nl > - } catch ( IOException e ) { < nl > - e . printStackTrace ( ) ; < nl > - } < nl > + < nl > } < nl > < nl > public void setQuery ( String query ) { < nl > @ @ - 97 , 4 + 90 , 15 @ @ public class InviteContactAdapter extends BindedListAdapter < PhoneBookContact , In < nl > public InviteContactHolder onCreateViewHolder ( ViewGroup viewGroup , int viewType ) { < nl > return new InviteContactHolder ( new FrameLayout ( context ) , context , onItemClickedListener ) ; < nl > } < nl > + < nl > + public void updateIds ( ) { < nl > + try { < nl > + PhoneBookIds ids = Bser . parse ( new PhoneBookIds ( ) , messenger ( ) . getPreferences ( ) . getBytes ( " phone _ book _ ids " ) ) ; < nl > + for ( long id : ids . getIds ( ) ) { < nl > + selectedUsers . add ( id ) ; < nl > + } < nl > + } catch ( Exception e ) { < nl > + e . printStackTrace ( ) ; < nl > + } < nl > + } < nl > } < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / contacts / InviteFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / contacts / InviteFragment . java < nl > index f9a8748 . . 497ceb8 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / contacts / InviteFragment . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / contacts / InviteFragment . java < nl > @ @ - 6 , 7 + 6 , 6 @ @ import android . content . Intent ; < nl > import android . net . Uri ; < nl > import android . os . Bundle ; < nl > import android . support . v7 . app . AlertDialog ; < nl > - import android . telephony . SmsManager ; < nl > import android . view . LayoutInflater ; < nl > import android . view . Menu ; < nl > import android . view . MenuInflater ; < nl > @ @ - 160 , 7 + 159 , 7 @ @ public class InviteFragment extends DisplayListFragment < PhoneBookContact , Invite < nl > super . onCreateOptionsMenu ( menu , inflater ) ; < nl > inflater . inflate ( R . menu . invite , menu ) ; < nl > sendButton = menu . getItem ( 0 ) ; < nl > - checkSEndButton ( ) ; < nl > + checkSendButton ( ) ; < nl > } < nl > < nl > @ Override < nl > @ @ - 246 , 7 + 245 , 7 @ @ public class InviteFragment extends DisplayListFragment < PhoneBookContact , Invite < nl > startActivity ( i ) ; < nl > } < nl > < nl > - public void checkSEndButton ( ) { < nl > + public void checkSendButton ( ) { < nl > if ( sendButton ! = null ) { < nl > sendButton . setVisible ( getDisplayList ( ) . getSize ( ) ! = 0 ) ; < nl > } < nl > @ @ - 255 , 7 + 254 , 8 @ @ public class InviteFragment extends DisplayListFragment < PhoneBookContact , Invite < nl > @ Override < nl > public void onCollectionChanged ( ) { < nl > super . onCollectionChanged ( ) ; < nl > - checkSEndButton ( ) ; < nl > + checkSendButton ( ) ; < nl > + ( ( InviteContactAdapter ) getAdapter ( ) ) . updateIds ( ) ; < nl > } < nl > < nl > } < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / contacts / BookImportActor . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / contacts / BookImportActor . java < nl > index 77e33b7 . . 06a01c2 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / contacts / BookImportActor . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / contacts / BookImportActor . java < nl > @ @ - 159 , 6 + 159 , 7 @ @ public class BookImportActor extends ModuleActor { < nl > toRemoveArray [ i ] = toRemove . get ( i ) ; < nl > } < nl > context ( ) . getContactsModule ( ) . getPhoneBook ( ) . removeItems ( toRemoveArray ) ; < nl > + context ( ) . getPreferences ( ) . putBytes ( " phone _ book _ ids " , new PhoneBookIds ( newids ) . toByteArray ( ) ) ; < nl > < nl > if ( ENABLE _ LOG ) { < nl > if ( newPhones = = 0 & & newEmails = = 0 ) {
NEAREST DIFF (one line): diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / ActorSDKDelegate . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / ActorSDKDelegate . java < nl > index 593095a . . ab9a17a 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / ActorSDKDelegate . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / ActorSDKDelegate . java < nl > @ @ - 8 , 6 + 8 , 9 @ @ import im . actor . sdk . controllers . fragment . auth . BaseAuthFragment ; < nl > import im . actor . sdk . controllers . fragment . settings . ActorSettingsCategory ; < nl > import im . actor . sdk . intents . ActorIntent ; < nl > < nl > + / * * < nl > + * SDK Delegate . Used for delegating some work to < nl > + * / < nl > public interface ActorSDKDelegate { < nl > < nl > / * * < nl > @ @ - 31 , 19 + 34 , 34 @ @ public interface ActorSDKDelegate { < nl > * / < nl > ActorIntent getStartIntent ( ) ; < nl > < nl > + / * * < nl > + * If not null returned , overrides settings activity intent < nl > + * < nl > + * @ return Actor Intent < nl > + * / < nl > + ActorIntent getSettingsIntent ( ) ; < nl > + < nl > + @ Deprecated < nl > AuthState getAuthStartState ( ) ; < nl > < nl > + @ Deprecated < nl > BaseAuthFragment getSignFragment ( ) ; < nl > < nl > + @ Deprecated < nl > View getBeforeNickSettingsView ( Context context ) ; < nl > < nl > + @ Deprecated < nl > View getAfterPhoneSettingsView ( Context context ) ; < nl > < nl > + @ Deprecated < nl > View getSettingsTopView ( Context context ) ; < nl > < nl > + @ Deprecated < nl > View getSettingsBottomView ( Context context ) ; < nl > < nl > + @ Deprecated < nl > ActorSettingsCategory [ ] getBeforeSettingsCategories ( ) ; < nl > < nl > + @ Deprecated < nl > ActorSettingsCategory [ ] getAfterSettingsCategories ( ) ; < nl > } < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / BaseActorSDKDelegate . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / BaseActorSDKDelegate . java < nl > index 68ec210 . . 9741d06 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / BaseActorSDKDelegate . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / BaseActorSDKDelegate . java < nl > @ @ - 61 , 6 + 61 , 11 @ @ public class BaseActorSDKDelegate implements ActorSDKDelegate { < nl > return null ; < nl > } < nl > < nl > + @ Override < nl > + public ActorIntent getSettingsIntent ( ) { < nl > + return null ; < nl > + } < nl > + < nl > / / < nl > / / Hacking settings activity < nl > / / < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / ApiModule . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / ApiModule . java < nl > index bbb081d . . 2518330 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / ApiModule . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / ApiModule . java < nl > @ @ - 113 , 7 + 113 , 9 @ @ public class ApiModule extends AbsModule implements BusSubscriber { < nl > < nl > @ Override < nl > public void onUpdateReceived ( Object obj ) { < nl > - context ( ) . getUpdatesModule ( ) . onUpdateReceived ( obj ) ; < nl > + if ( context ( ) . getUpdatesModule ( ) ! = null ) { < nl > + context ( ) . getUpdatesModule ( ) . onUpdateReceived ( obj ) ; < nl > + } < nl > } < nl > < nl > @ Override

TEST DIFF:
diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / contacts / InviteContactAdapter . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / contacts / InviteContactAdapter . java 
 index f10a333 . . e34f558 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / contacts / InviteContactAdapter . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / contacts / InviteContactAdapter . java 
 @ @ - 37 , 14 + 37 , 7 @ @ public class InviteContactAdapter extends BindedListAdapter < PhoneBookContact , In 
 this . context = context ; 
 this . onItemClickedListener = onItemClickedListener ; 
 
 - try { 
 - PhoneBookIds ids = Bser . parse ( new PhoneBookIds ( ) , messenger ( ) . getPreferences ( ) . getBytes ( " phone _ book _ ids " ) ) ; 
 - for ( long id : ids . getIds ( ) ) { 
 - selectedUsers . add ( id ) ; 
 - } 
 - } catch ( IOException e ) { 
 - e . printStackTrace ( ) ; 
 - } 
 + 
 } 
 
 public void setQuery ( String query ) { 
 @ @ - 97 , 4 + 90 , 15 @ @ public class InviteContactAdapter extends BindedListAdapter < PhoneBookContact , In 
 public InviteContactHolder onCreateViewHolder ( ViewGroup viewGroup , int viewType ) { 
 return new InviteContactHolder ( new FrameLayout ( context ) , context , onItemClickedListener ) ; 
 } 
 + 
 + public void updateIds ( ) { 
 + try { 
 + PhoneBookIds ids = Bser . parse ( new PhoneBookIds ( ) , messenger ( ) . getPreferences ( ) . getBytes ( " phone _ book _ ids " ) ) ; 
 + for ( long id : ids . getIds ( ) ) { 
 + selectedUsers . add ( id ) ; 
 + } 
 + } catch ( Exception e ) { 
 + e . printStackTrace ( ) ; 
 + } 
 + } 
 } 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / contacts / InviteFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / contacts / InviteFragment . java 
 index f9a8748 . . 497ceb8 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / contacts / InviteFragment . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / contacts / InviteFragment . java 
 @ @ - 6 , 7 + 6 , 6 @ @ import android . content . Intent ; 
 import android . net . Uri ; 
 import android . os . Bundle ; 
 import android . support . v7 . app . AlertDialog ; 
 - import android . telephony . SmsManager ; 
 import android . view . LayoutInflater ; 
 import android . view . Menu ; 
 import android . view . MenuInflater ; 
 @ @ - 160 , 7 + 159 , 7 @ @ public class InviteFragment extends DisplayListFragment < PhoneBookContact , Invite 
 super . onCreateOptionsMenu ( menu , inflater ) ; 
 inflater . inflate ( R . menu . invite , menu ) ; 
 sendButton = menu . getItem ( 0 ) ; 
 - checkSEndButton ( ) ; 
 + checkSendButton ( ) ; 
 } 
 
 @ Override 
 @ @ - 246 , 7 + 245 , 7 @ @ public class InviteFragment extends DisplayListFragment < PhoneBookContact , Invite 
 startActivity ( i ) ; 
 } 
 
 - public void checkSEndButton ( ) { 
 + public void checkSendButton ( ) { 
 if ( sendButton ! = null ) { 
 sendButton . setVisible ( getDisplayList ( ) . getSize ( ) ! = 0 ) ; 
 } 
 @ @ - 255 , 7 + 254 , 8 @ @ public class InviteFragment extends DisplayListFragment < PhoneBookContact , Invite 
 @ Override 
 public void onCollectionChanged ( ) { 
 super . onCollectionChanged ( ) ; 
 - checkSEndButton ( ) ; 
 + checkSendButton ( ) ; 
 + ( ( InviteContactAdapter ) getAdapter ( ) ) . updateIds ( ) ; 
 } 
 
 } 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / contacts / BookImportActor . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / contacts / BookImportActor . java 
 index 77e33b7 . . 06a01c2 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / contacts / BookImportActor . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / contacts / BookImportActor . java 
 @ @ - 159 , 6 + 159 , 7 @ @ public class BookImportActor extends ModuleActor { 
 toRemoveArray [ i ] = toRemove . get ( i ) ; 
 } 
 context ( ) . getContactsModule ( ) . getPhoneBook ( ) . removeItems ( toRemoveArray ) ; 
 + context ( ) . getPreferences ( ) . putBytes ( " phone _ book _ ids " , new PhoneBookIds ( newids ) . toByteArray ( ) ) ; 
 
 if ( ENABLE _ LOG ) { 
 if ( newPhones = = 0 & & newEmails = = 0 ) {

NEAREST DIFF:
diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / ActorSDKDelegate . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / ActorSDKDelegate . java 
 index 593095a . . ab9a17a 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / ActorSDKDelegate . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / ActorSDKDelegate . java 
 @ @ - 8 , 6 + 8 , 9 @ @ import im . actor . sdk . controllers . fragment . auth . BaseAuthFragment ; 
 import im . actor . sdk . controllers . fragment . settings . ActorSettingsCategory ; 
 import im . actor . sdk . intents . ActorIntent ; 
 
 + / * * 
 + * SDK Delegate . Used for delegating some work to 
 + * / 
 public interface ActorSDKDelegate { 
 
 / * * 
 @ @ - 31 , 19 + 34 , 34 @ @ public interface ActorSDKDelegate { 
 * / 
 ActorIntent getStartIntent ( ) ; 
 
 + / * * 
 + * If not null returned , overrides settings activity intent 
 + * 
 + * @ return Actor Intent 
 + * / 
 + ActorIntent getSettingsIntent ( ) ; 
 + 
 + @ Deprecated 
 AuthState getAuthStartState ( ) ; 
 
 + @ Deprecated 
 BaseAuthFragment getSignFragment ( ) ; 
 
 + @ Deprecated 
 View getBeforeNickSettingsView ( Context context ) ; 
 
 + @ Deprecated 
 View getAfterPhoneSettingsView ( Context context ) ; 
 
 + @ Deprecated 
 View getSettingsTopView ( Context context ) ; 
 
 + @ Deprecated 
 View getSettingsBottomView ( Context context ) ; 
 
 + @ Deprecated 
 ActorSettingsCategory [ ] getBeforeSettingsCategories ( ) ; 
 
 + @ Deprecated 
 ActorSettingsCategory [ ] getAfterSettingsCategories ( ) ; 
 } 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / BaseActorSDKDelegate . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / BaseActorSDKDelegate . java 
 index 68ec210 . . 9741d06 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / BaseActorSDKDelegate . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / BaseActorSDKDelegate . java 
 @ @ - 61 , 6 + 61 , 11 @ @ public class BaseActorSDKDelegate implements ActorSDKDelegate { 
 return null ; 
 } 
 
 + @ Override 
 + public ActorIntent getSettingsIntent ( ) { 
 + return null ; 
 + } 
 + 
 / / 
 / / Hacking settings activity 
 / / 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / ApiModule . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / ApiModule . java 
 index bbb081d . . 2518330 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / ApiModule . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / ApiModule . java 
 @ @ - 113 , 7 + 113 , 9 @ @ public class ApiModule extends AbsModule implements BusSubscriber { 
 
 @ Override 
 public void onUpdateReceived ( Object obj ) { 
 - context ( ) . getUpdatesModule ( ) . onUpdateReceived ( obj ) ; 
 + if ( context ( ) . getUpdatesModule ( ) ! = null ) { 
 + context ( ) . getUpdatesModule ( ) . onUpdateReceived ( obj ) ; 
 + } 
 } 
 
 @ Override
