BLEU SCORE: 0.07160476144948855

TEST MSG: Merge branch ' shortcuts '
GENERATED MSG: feat ( android ) : shortcuts icons

TEST DIFF (one line): diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / MessagesFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / MessagesFragment . java < nl > index 94e5455 . . c6d6813 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / MessagesFragment . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / MessagesFragment . java < nl > @ @ - 7 , 8 + 7 , 11 @ @ import android . content . Context ; < nl > import android . content . DialogInterface ; < nl > import android . content . Intent ; < nl > import android . graphics . Color ; < nl > + import android . graphics . drawable . BitmapDrawable ; < nl > + import android . graphics . drawable . Drawable ; < nl > import android . os . Build ; < nl > import android . os . Bundle ; < nl > + import android . provider . MediaStore ; < nl > import android . support . annotation . Nullable ; < nl > import android . support . v4 . app . FragmentActivity ; < nl > import android . support . v7 . app . AppCompatActivity ; < nl > @ @ - 27 , 6 + 30 , 7 @ @ import android . widget . FrameLayout ; < nl > import android . widget . LinearLayout ; < nl > import android . widget . Toast ; < nl > < nl > + import java . io . FileNotFoundException ; < nl > import java . io . IOException ; < nl > < nl > import im . actor . core . entity . Message ; < nl > @ @ - 60 , 6 + 64 , 9 @ @ import static im . actor . sdk . util . ActorSDKMessenger . users ; < nl > @ TargetApi ( Build . VERSION _ CODES . LOLLIPOP ) < nl > public class MessagesFragment extends DisplayListFragment < Message , MessageHolder > { < nl > < nl > + private static final int REQUEST _ GALLERY = 198 ; < nl > + private String shortcutText ; < nl > + < nl > public static MessagesFragment create ( Peer peer ) { < nl > return new MessagesFragment ( peer ) ; < nl > } < nl > @ @ - 298 , 58 + 305 , 12 @ @ public class MessagesFragment extends DisplayListFragment < Message , MessageHolder < nl > @ Override < nl > public boolean onActionItemClicked ( final ActionMode actionMode , MenuItem menuItem ) { < nl > if ( menuItem . getItemId ( ) = = R . id . shortcut ) { < nl > - final String text = messenger ( ) . getFormatter ( ) . formatMessagesExport ( messagesAdapter . getSelected ( ) ) ; < nl > - < nl > - android . support . v7 . app . AlertDialog . Builder builder = new android . support . v7 . app . AlertDialog . Builder ( getActivity ( ) , R . style . AlertDialogStyle ) ; < nl > - builder . setTitle ( menuItem . getTitle ( ) ) ; < nl > - < nl > - final LinearLayout ll = new LinearLayout ( getActivity ( ) ) ; < nl > - ll . setPadding ( Screen . dp ( 20 ) , 0 , Screen . dp ( 20 ) , 0 ) ; < nl > - < nl > - final EditText input = new EditText ( getActivity ( ) ) ; < nl > - input . setTextColor ( Color . BLACK ) ; < nl > - input . setText ( text ) ; < nl > - ll . addView ( input , LinearLayout . LayoutParams . MATCH _ PARENT , LinearLayout . LayoutParams . WRAP _ CONTENT ) ; < nl > - builder . setView ( ll ) ; < nl > - < nl > - builder . setPositiveButton ( getString ( R . string . dialog _ ok ) , new DialogInterface . OnClickListener ( ) { < nl > - @ Override < nl > - public void onClick ( DialogInterface dialog , int which ) { < nl > - Intent shortcutIntent = new Intent ( getContext ( ) , ShortcutActivity . class ) ; < nl > - shortcutIntent . addFlags ( Intent . FLAG _ ACTIVITY _ NO _ HISTORY | Intent . FLAG _ ACTIVITY _ EXCLUDE _ FROM _ RECENTS | Intent . FLAG _ ACTIVITY _ TASK _ ON _ HOME | Intent . FLAG _ ACTIVITY _ NEW _ DOCUMENT | Intent . FLAG _ ACTIVITY _ MULTIPLE _ TASK ) ; < nl > - shortcutIntent . setAction ( " im . actor . action . botMessageShortcut " ) ; < nl > - shortcutIntent . putExtra ( " peer " , peer . getUnuqueId ( ) ) ; < nl > - shortcutIntent . putExtra ( " text " , input . getText ( ) . toString ( ) ) ; < nl > - Intent addIntent = new Intent ( ) ; < nl > - addIntent < nl > - . putExtra ( Intent . EXTRA _ SHORTCUT _ INTENT , shortcutIntent ) ; < nl > - addIntent . putExtra ( Intent . EXTRA _ SHORTCUT _ NAME , input . getText ( ) . toString ( ) + " - > " + users ( ) . get ( peer . getPeerId ( ) ) . getNick ( ) . get ( ) ) ; < nl > - addIntent . putExtra ( Intent . EXTRA _ SHORTCUT _ ICON _ RESOURCE , < nl > - Intent . ShortcutIconResource . fromContext ( getContext ( ) , < nl > - R . drawable . ic _ message _ white _ 24dp ) ) ; < nl > - < nl > - addIntent . setAction ( " com . android . launcher . action . INSTALL _ SHORTCUT " ) ; < nl > - getContext ( ) . getApplicationContext ( ) . sendBroadcast ( addIntent ) ; < nl > - actionMode . finish ( ) ; < nl > - } < nl > - } ) ; < nl > - builder . setNegativeButton ( R . string . dialog _ cancel , new DialogInterface . OnClickListener ( ) { < nl > - @ Override < nl > - public void onClick ( DialogInterface dialog , int which ) { < nl > - dialog . cancel ( ) ; < nl > - } < nl > - } ) ; < nl > - < nl > - android . support . v7 . app . AlertDialog ad = builder . create ( ) ; < nl > - ad . setOnShowListener ( new DialogInterface . OnShowListener ( ) { < nl > - @ Override < nl > - public void onShow ( DialogInterface dialog ) { < nl > - InputMethodManager inputMethodManager = ( InputMethodManager ) getActivity ( ) . getSystemService ( FragmentActivity . INPUT _ METHOD _ SERVICE ) ; < nl > - input . requestFocus ( ) ; < nl > - inputMethodManager . showSoftInput ( input , 0 ) ; < nl > - } < nl > - } ) ; < nl > - ad . show ( ) ; < nl > + shortcutText = messenger ( ) . getFormatter ( ) . formatMessagesExport ( messagesAdapter . getSelected ( ) ) ; < nl > + < nl > + Drawable shortCutDrawable = getResources ( ) . getDrawable ( R . drawable . ic _ message _ white _ 24dp ) ; < nl > + < nl > + createShortcutDialog ( menuItem . getTitle ( ) . toString ( ) , shortCutDrawable ) ; < nl > + actionMode . finish ( ) ; < nl > < nl > < nl > } else if ( menuItem . getItemId ( ) = = R . id . delete ) { < nl > @ @ - 512 , 6 + 473 , 85 @ @ public class MessagesFragment extends DisplayListFragment < Message , MessageHolder < nl > return true ; < nl > } < nl > < nl > + public void createShortcutDialog ( String title , final Drawable shortCutDrawable ) { < nl > + final android . support . v7 . app . AlertDialog . Builder builder = new android . support . v7 . app . AlertDialog . Builder ( getActivity ( ) , R . style . AlertDialogStyle ) ; < nl > + builder . setTitle ( title ) ; < nl > + < nl > + final LinearLayout ll = new LinearLayout ( getActivity ( ) ) ; < nl > + ll . setPadding ( Screen . dp ( 20 ) , 0 , Screen . dp ( 20 ) , 0 ) ; < nl > + < nl > + final EditText shortcutInput = new EditText ( getActivity ( ) ) ; < nl > + shortcutInput . setTextColor ( Color . BLACK ) ; < nl > + shortcutInput . setText ( shortcutText ) ; < nl > + shortcutInput . setCompoundDrawablesWithIntrinsicBounds ( shortCutDrawable , null , null , null ) ; < nl > + ll . addView ( shortcutInput , LinearLayout . LayoutParams . MATCH _ PARENT , LinearLayout . LayoutParams . WRAP _ CONTENT ) ; < nl > + builder . setView ( ll ) ; < nl > + < nl > + builder . setPositiveButton ( getString ( R . string . dialog _ ok ) , new DialogInterface . OnClickListener ( ) { < nl > + @ Override < nl > + public void onClick ( DialogInterface dialog , int which ) { < nl > + Intent shortcutIntent = new Intent ( getContext ( ) , ShortcutActivity . class ) ; < nl > + shortcutIntent . addFlags ( Intent . FLAG _ ACTIVITY _ NO _ HISTORY | Intent . FLAG _ ACTIVITY _ EXCLUDE _ FROM _ RECENTS | Intent . FLAG _ ACTIVITY _ TASK _ ON _ HOME | Intent . FLAG _ ACTIVITY _ NEW _ DOCUMENT | Intent . FLAG _ ACTIVITY _ MULTIPLE _ TASK ) ; < nl > + shortcutIntent . setAction ( " im . actor . action . botMessageShortcut " ) ; < nl > + shortcutIntent . putExtra ( " peer " , peer . getUnuqueId ( ) ) ; < nl > + shortcutIntent . putExtra ( " text " , shortcutInput . getText ( ) . toString ( ) ) ; < nl > + Intent addIntent = new Intent ( ) ; < nl > + addIntent < nl > + . putExtra ( Intent . EXTRA _ SHORTCUT _ INTENT , shortcutIntent ) ; < nl > + addIntent . putExtra ( Intent . EXTRA _ SHORTCUT _ NAME , shortcutInput . getText ( ) . toString ( ) + " - > " + users ( ) . get ( peer . getPeerId ( ) ) . getNick ( ) . get ( ) ) ; < nl > + / / addIntent . putExtra ( Intent . EXTRA _ SHORTCUT _ ICON _ RESOURCE , < nl > + / / Intent . ShortcutIconResource . fromContext ( getContext ( ) , < nl > + / / R . drawable . ic _ message _ white _ 24dp ) ) ; < nl > + < nl > + BitmapDrawable bd = ( BitmapDrawable ) shortCutDrawable ; < nl > + addIntent . putExtra ( Intent . EXTRA _ SHORTCUT _ ICON , bd . getBitmap ( ) ) ; < nl > + < nl > + addIntent . setAction ( " com . android . launcher . action . INSTALL _ SHORTCUT " ) ; < nl > + getContext ( ) . getApplicationContext ( ) . sendBroadcast ( addIntent ) ; < nl > + } < nl > + } ) ; < nl > + builder . setNegativeButton ( R . string . dialog _ cancel , new DialogInterface . OnClickListener ( ) { < nl > + @ Override < nl > + public void onClick ( DialogInterface dialog , int which ) { < nl > + dialog . cancel ( ) ; < nl > + } < nl > + } ) ; < nl > + < nl > + builder . setNeutralButton ( " Icon " , new DialogInterface . OnClickListener ( ) { < nl > + @ Override < nl > + public void onClick ( DialogInterface dialog , int which ) { < nl > + Intent intent = new Intent ( Intent . ACTION _ PICK , MediaStore . Images . Media . EXTERNAL _ CONTENT _ URI ) ; < nl > + intent . setType ( " image / * " ) ; < nl > + startActivityForResult ( intent , REQUEST _ GALLERY ) ; < nl > + } < nl > + } ) ; < nl > + < nl > + android . support . v7 . app . AlertDialog ad = builder . create ( ) ; < nl > + ad . setOnShowListener ( new DialogInterface . OnShowListener ( ) { < nl > + @ Override < nl > + public void onShow ( DialogInterface dialog ) { < nl > + InputMethodManager inputMethodManager = ( InputMethodManager ) getActivity ( ) . getSystemService ( FragmentActivity . INPUT _ METHOD _ SERVICE ) ; < nl > + shortcutInput . requestFocus ( ) ; < nl > + inputMethodManager . showSoftInput ( shortcutInput , 0 ) ; < nl > + } < nl > + } ) ; < nl > + ad . show ( ) ; < nl > + } < nl > + < nl > + @ Override < nl > + public void onActivityResult ( int requestCode , int resultCode , Intent data ) { < nl > + if ( resultCode = = Activity . RESULT _ OK ) { < nl > + if ( requestCode = = REQUEST _ GALLERY ) { < nl > + try { < nl > + createShortcutDialog ( " Create shortcut " , Drawable . createFromStream ( getActivity ( ) . getContentResolver ( ) . openInputStream ( data . getData ( ) ) , null ) ) ; < nl > + } catch ( FileNotFoundException e ) { < nl > + e . printStackTrace ( ) ; < nl > + } < nl > + } < nl > + } < nl > + super . onActivityResult ( requestCode , resultCode , data ) ; < nl > + } < nl > + < nl > @ Override < nl > public void onPause ( ) { < nl > super . onPause ( ) ; < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / styles . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / styles . xml < nl > index 6f2b8ab . . 6b54f4e 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / styles . xml < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / styles . xml < nl > @ @ - 86 , 7 + 86 , 7 @ @ < nl > < item name = " android : windowAnimationStyle " > @ null < / item > < nl > < / style > < nl > < nl > - < style name = " AlertDialogStyle " parent = " Theme . AppCompat . Light . Dialog . Alert " / > < nl > + < style name = " AlertDialogStyle " parent = " Theme . AppCompat . Dialog . Alert " / > < nl > < nl > < style name = " AppcompatNoDisplay " parent = " Theme . AppCompat . NoActionBar " > < nl > < item name = " android : windowBackground " > @ null < / item >
NEAREST DIFF (one line): diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / MessagesFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / MessagesFragment . java < nl > index 94e5455 . . c6d6813 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / MessagesFragment . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / MessagesFragment . java < nl > @ @ - 7 , 8 + 7 , 11 @ @ import android . content . Context ; < nl > import android . content . DialogInterface ; < nl > import android . content . Intent ; < nl > import android . graphics . Color ; < nl > + import android . graphics . drawable . BitmapDrawable ; < nl > + import android . graphics . drawable . Drawable ; < nl > import android . os . Build ; < nl > import android . os . Bundle ; < nl > + import android . provider . MediaStore ; < nl > import android . support . annotation . Nullable ; < nl > import android . support . v4 . app . FragmentActivity ; < nl > import android . support . v7 . app . AppCompatActivity ; < nl > @ @ - 27 , 6 + 30 , 7 @ @ import android . widget . FrameLayout ; < nl > import android . widget . LinearLayout ; < nl > import android . widget . Toast ; < nl > < nl > + import java . io . FileNotFoundException ; < nl > import java . io . IOException ; < nl > < nl > import im . actor . core . entity . Message ; < nl > @ @ - 60 , 6 + 64 , 9 @ @ import static im . actor . sdk . util . ActorSDKMessenger . users ; < nl > @ TargetApi ( Build . VERSION _ CODES . LOLLIPOP ) < nl > public class MessagesFragment extends DisplayListFragment < Message , MessageHolder > { < nl > < nl > + private static final int REQUEST _ GALLERY = 198 ; < nl > + private String shortcutText ; < nl > + < nl > public static MessagesFragment create ( Peer peer ) { < nl > return new MessagesFragment ( peer ) ; < nl > } < nl > @ @ - 298 , 58 + 305 , 12 @ @ public class MessagesFragment extends DisplayListFragment < Message , MessageHolder < nl > @ Override < nl > public boolean onActionItemClicked ( final ActionMode actionMode , MenuItem menuItem ) { < nl > if ( menuItem . getItemId ( ) = = R . id . shortcut ) { < nl > - final String text = messenger ( ) . getFormatter ( ) . formatMessagesExport ( messagesAdapter . getSelected ( ) ) ; < nl > - < nl > - android . support . v7 . app . AlertDialog . Builder builder = new android . support . v7 . app . AlertDialog . Builder ( getActivity ( ) , R . style . AlertDialogStyle ) ; < nl > - builder . setTitle ( menuItem . getTitle ( ) ) ; < nl > - < nl > - final LinearLayout ll = new LinearLayout ( getActivity ( ) ) ; < nl > - ll . setPadding ( Screen . dp ( 20 ) , 0 , Screen . dp ( 20 ) , 0 ) ; < nl > - < nl > - final EditText input = new EditText ( getActivity ( ) ) ; < nl > - input . setTextColor ( Color . BLACK ) ; < nl > - input . setText ( text ) ; < nl > - ll . addView ( input , LinearLayout . LayoutParams . MATCH _ PARENT , LinearLayout . LayoutParams . WRAP _ CONTENT ) ; < nl > - builder . setView ( ll ) ; < nl > - < nl > - builder . setPositiveButton ( getString ( R . string . dialog _ ok ) , new DialogInterface . OnClickListener ( ) { < nl > - @ Override < nl > - public void onClick ( DialogInterface dialog , int which ) { < nl > - Intent shortcutIntent = new Intent ( getContext ( ) , ShortcutActivity . class ) ; < nl > - shortcutIntent . addFlags ( Intent . FLAG _ ACTIVITY _ NO _ HISTORY | Intent . FLAG _ ACTIVITY _ EXCLUDE _ FROM _ RECENTS | Intent . FLAG _ ACTIVITY _ TASK _ ON _ HOME | Intent . FLAG _ ACTIVITY _ NEW _ DOCUMENT | Intent . FLAG _ ACTIVITY _ MULTIPLE _ TASK ) ; < nl > - shortcutIntent . setAction ( " im . actor . action . botMessageShortcut " ) ; < nl > - shortcutIntent . putExtra ( " peer " , peer . getUnuqueId ( ) ) ; < nl > - shortcutIntent . putExtra ( " text " , input . getText ( ) . toString ( ) ) ; < nl > - Intent addIntent = new Intent ( ) ; < nl > - addIntent < nl > - . putExtra ( Intent . EXTRA _ SHORTCUT _ INTENT , shortcutIntent ) ; < nl > - addIntent . putExtra ( Intent . EXTRA _ SHORTCUT _ NAME , input . getText ( ) . toString ( ) + " - > " + users ( ) . get ( peer . getPeerId ( ) ) . getNick ( ) . get ( ) ) ; < nl > - addIntent . putExtra ( Intent . EXTRA _ SHORTCUT _ ICON _ RESOURCE , < nl > - Intent . ShortcutIconResource . fromContext ( getContext ( ) , < nl > - R . drawable . ic _ message _ white _ 24dp ) ) ; < nl > - < nl > - addIntent . setAction ( " com . android . launcher . action . INSTALL _ SHORTCUT " ) ; < nl > - getContext ( ) . getApplicationContext ( ) . sendBroadcast ( addIntent ) ; < nl > - actionMode . finish ( ) ; < nl > - } < nl > - } ) ; < nl > - builder . setNegativeButton ( R . string . dialog _ cancel , new DialogInterface . OnClickListener ( ) { < nl > - @ Override < nl > - public void onClick ( DialogInterface dialog , int which ) { < nl > - dialog . cancel ( ) ; < nl > - } < nl > - } ) ; < nl > - < nl > - android . support . v7 . app . AlertDialog ad = builder . create ( ) ; < nl > - ad . setOnShowListener ( new DialogInterface . OnShowListener ( ) { < nl > - @ Override < nl > - public void onShow ( DialogInterface dialog ) { < nl > - InputMethodManager inputMethodManager = ( InputMethodManager ) getActivity ( ) . getSystemService ( FragmentActivity . INPUT _ METHOD _ SERVICE ) ; < nl > - input . requestFocus ( ) ; < nl > - inputMethodManager . showSoftInput ( input , 0 ) ; < nl > - } < nl > - } ) ; < nl > - ad . show ( ) ; < nl > + shortcutText = messenger ( ) . getFormatter ( ) . formatMessagesExport ( messagesAdapter . getSelected ( ) ) ; < nl > + < nl > + Drawable shortCutDrawable = getResources ( ) . getDrawable ( R . drawable . ic _ message _ white _ 24dp ) ; < nl > + < nl > + createShortcutDialog ( menuItem . getTitle ( ) . toString ( ) , shortCutDrawable ) ; < nl > + actionMode . finish ( ) ; < nl > < nl > < nl > } else if ( menuItem . getItemId ( ) = = R . id . delete ) { < nl > @ @ - 512 , 6 + 473 , 85 @ @ public class MessagesFragment extends DisplayListFragment < Message , MessageHolder < nl > return true ; < nl > } < nl > < nl > + public void createShortcutDialog ( String title , final Drawable shortCutDrawable ) { < nl > + final android . support . v7 . app . AlertDialog . Builder builder = new android . support . v7 . app . AlertDialog . Builder ( getActivity ( ) , R . style . AlertDialogStyle ) ; < nl > + builder . setTitle ( title ) ; < nl > + < nl > + final LinearLayout ll = new LinearLayout ( getActivity ( ) ) ; < nl > + ll . setPadding ( Screen . dp ( 20 ) , 0 , Screen . dp ( 20 ) , 0 ) ; < nl > + < nl > + final EditText shortcutInput = new EditText ( getActivity ( ) ) ; < nl > + shortcutInput . setTextColor ( Color . BLACK ) ; < nl > + shortcutInput . setText ( shortcutText ) ; < nl > + shortcutInput . setCompoundDrawablesWithIntrinsicBounds ( shortCutDrawable , null , null , null ) ; < nl > + ll . addView ( shortcutInput , LinearLayout . LayoutParams . MATCH _ PARENT , LinearLayout . LayoutParams . WRAP _ CONTENT ) ; < nl > + builder . setView ( ll ) ; < nl > + < nl > + builder . setPositiveButton ( getString ( R . string . dialog _ ok ) , new DialogInterface . OnClickListener ( ) { < nl > + @ Override < nl > + public void onClick ( DialogInterface dialog , int which ) { < nl > + Intent shortcutIntent = new Intent ( getContext ( ) , ShortcutActivity . class ) ; < nl > + shortcutIntent . addFlags ( Intent . FLAG _ ACTIVITY _ NO _ HISTORY | Intent . FLAG _ ACTIVITY _ EXCLUDE _ FROM _ RECENTS | Intent . FLAG _ ACTIVITY _ TASK _ ON _ HOME | Intent . FLAG _ ACTIVITY _ NEW _ DOCUMENT | Intent . FLAG _ ACTIVITY _ MULTIPLE _ TASK ) ; < nl > + shortcutIntent . setAction ( " im . actor . action . botMessageShortcut " ) ; < nl > + shortcutIntent . putExtra ( " peer " , peer . getUnuqueId ( ) ) ; < nl > + shortcutIntent . putExtra ( " text " , shortcutInput . getText ( ) . toString ( ) ) ; < nl > + Intent addIntent = new Intent ( ) ; < nl > + addIntent < nl > + . putExtra ( Intent . EXTRA _ SHORTCUT _ INTENT , shortcutIntent ) ; < nl > + addIntent . putExtra ( Intent . EXTRA _ SHORTCUT _ NAME , shortcutInput . getText ( ) . toString ( ) + " - > " + users ( ) . get ( peer . getPeerId ( ) ) . getNick ( ) . get ( ) ) ; < nl > + / / addIntent . putExtra ( Intent . EXTRA _ SHORTCUT _ ICON _ RESOURCE , < nl > + / / Intent . ShortcutIconResource . fromContext ( getContext ( ) , < nl > + / / R . drawable . ic _ message _ white _ 24dp ) ) ; < nl > + < nl > + BitmapDrawable bd = ( BitmapDrawable ) shortCutDrawable ; < nl > + addIntent . putExtra ( Intent . EXTRA _ SHORTCUT _ ICON , bd . getBitmap ( ) ) ; < nl > + < nl > + addIntent . setAction ( " com . android . launcher . action . INSTALL _ SHORTCUT " ) ; < nl > + getContext ( ) . getApplicationContext ( ) . sendBroadcast ( addIntent ) ; < nl > + } < nl > + } ) ; < nl > + builder . setNegativeButton ( R . string . dialog _ cancel , new DialogInterface . OnClickListener ( ) { < nl > + @ Override < nl > + public void onClick ( DialogInterface dialog , int which ) { < nl > + dialog . cancel ( ) ; < nl > + } < nl > + } ) ; < nl > + < nl > + builder . setNeutralButton ( " Icon " , new DialogInterface . OnClickListener ( ) { < nl > + @ Override < nl > + public void onClick ( DialogInterface dialog , int which ) { < nl > + Intent intent = new Intent ( Intent . ACTION _ PICK , MediaStore . Images . Media . EXTERNAL _ CONTENT _ URI ) ; < nl > + intent . setType ( " image / * " ) ; < nl > + startActivityForResult ( intent , REQUEST _ GALLERY ) ; < nl > + } < nl > + } ) ; < nl > + < nl > + android . support . v7 . app . AlertDialog ad = builder . create ( ) ; < nl > + ad . setOnShowListener ( new DialogInterface . OnShowListener ( ) { < nl > + @ Override < nl > + public void onShow ( DialogInterface dialog ) { < nl > + InputMethodManager inputMethodManager = ( InputMethodManager ) getActivity ( ) . getSystemService ( FragmentActivity . INPUT _ METHOD _ SERVICE ) ; < nl > + shortcutInput . requestFocus ( ) ; < nl > + inputMethodManager . showSoftInput ( shortcutInput , 0 ) ; < nl > + } < nl > + } ) ; < nl > + ad . show ( ) ; < nl > + } < nl > + < nl > + @ Override < nl > + public void onActivityResult ( int requestCode , int resultCode , Intent data ) { < nl > + if ( resultCode = = Activity . RESULT _ OK ) { < nl > + if ( requestCode = = REQUEST _ GALLERY ) { < nl > + try { < nl > + createShortcutDialog ( " Create shortcut " , Drawable . createFromStream ( getActivity ( ) . getContentResolver ( ) . openInputStream ( data . getData ( ) ) , null ) ) ; < nl > + } catch ( FileNotFoundException e ) { < nl > + e . printStackTrace ( ) ; < nl > + } < nl > + } < nl > + } < nl > + super . onActivityResult ( requestCode , resultCode , data ) ; < nl > + } < nl > + < nl > @ Override < nl > public void onPause ( ) { < nl > super . onPause ( ) ; < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / styles . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / styles . xml < nl > index 6f2b8ab . . 6b54f4e 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / styles . xml < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / styles . xml < nl > @ @ - 86 , 7 + 86 , 7 @ @ < nl > < item name = " android : windowAnimationStyle " > @ null < / item > < nl > < / style > < nl > < nl > - < style name = " AlertDialogStyle " parent = " Theme . AppCompat . Light . Dialog . Alert " / > < nl > + < style name = " AlertDialogStyle " parent = " Theme . AppCompat . Dialog . Alert " / > < nl > < nl > < style name = " AppcompatNoDisplay " parent = " Theme . AppCompat . NoActionBar " > < nl > < item name = " android : windowBackground " > @ null < / item >

TEST DIFF:
diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / MessagesFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / MessagesFragment . java 
 index 94e5455 . . c6d6813 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / MessagesFragment . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / MessagesFragment . java 
 @ @ - 7 , 8 + 7 , 11 @ @ import android . content . Context ; 
 import android . content . DialogInterface ; 
 import android . content . Intent ; 
 import android . graphics . Color ; 
 + import android . graphics . drawable . BitmapDrawable ; 
 + import android . graphics . drawable . Drawable ; 
 import android . os . Build ; 
 import android . os . Bundle ; 
 + import android . provider . MediaStore ; 
 import android . support . annotation . Nullable ; 
 import android . support . v4 . app . FragmentActivity ; 
 import android . support . v7 . app . AppCompatActivity ; 
 @ @ - 27 , 6 + 30 , 7 @ @ import android . widget . FrameLayout ; 
 import android . widget . LinearLayout ; 
 import android . widget . Toast ; 
 
 + import java . io . FileNotFoundException ; 
 import java . io . IOException ; 
 
 import im . actor . core . entity . Message ; 
 @ @ - 60 , 6 + 64 , 9 @ @ import static im . actor . sdk . util . ActorSDKMessenger . users ; 
 @ TargetApi ( Build . VERSION _ CODES . LOLLIPOP ) 
 public class MessagesFragment extends DisplayListFragment < Message , MessageHolder > { 
 
 + private static final int REQUEST _ GALLERY = 198 ; 
 + private String shortcutText ; 
 + 
 public static MessagesFragment create ( Peer peer ) { 
 return new MessagesFragment ( peer ) ; 
 } 
 @ @ - 298 , 58 + 305 , 12 @ @ public class MessagesFragment extends DisplayListFragment < Message , MessageHolder 
 @ Override 
 public boolean onActionItemClicked ( final ActionMode actionMode , MenuItem menuItem ) { 
 if ( menuItem . getItemId ( ) = = R . id . shortcut ) { 
 - final String text = messenger ( ) . getFormatter ( ) . formatMessagesExport ( messagesAdapter . getSelected ( ) ) ; 
 - 
 - android . support . v7 . app . AlertDialog . Builder builder = new android . support . v7 . app . AlertDialog . Builder ( getActivity ( ) , R . style . AlertDialogStyle ) ; 
 - builder . setTitle ( menuItem . getTitle ( ) ) ; 
 - 
 - final LinearLayout ll = new LinearLayout ( getActivity ( ) ) ; 
 - ll . setPadding ( Screen . dp ( 20 ) , 0 , Screen . dp ( 20 ) , 0 ) ; 
 - 
 - final EditText input = new EditText ( getActivity ( ) ) ; 
 - input . setTextColor ( Color . BLACK ) ; 
 - input . setText ( text ) ; 
 - ll . addView ( input , LinearLayout . LayoutParams . MATCH _ PARENT , LinearLayout . LayoutParams . WRAP _ CONTENT ) ; 
 - builder . setView ( ll ) ; 
 - 
 - builder . setPositiveButton ( getString ( R . string . dialog _ ok ) , new DialogInterface . OnClickListener ( ) { 
 - @ Override 
 - public void onClick ( DialogInterface dialog , int which ) { 
 - Intent shortcutIntent = new Intent ( getContext ( ) , ShortcutActivity . class ) ; 
 - shortcutIntent . addFlags ( Intent . FLAG _ ACTIVITY _ NO _ HISTORY | Intent . FLAG _ ACTIVITY _ EXCLUDE _ FROM _ RECENTS | Intent . FLAG _ ACTIVITY _ TASK _ ON _ HOME | Intent . FLAG _ ACTIVITY _ NEW _ DOCUMENT | Intent . FLAG _ ACTIVITY _ MULTIPLE _ TASK ) ; 
 - shortcutIntent . setAction ( " im . actor . action . botMessageShortcut " ) ; 
 - shortcutIntent . putExtra ( " peer " , peer . getUnuqueId ( ) ) ; 
 - shortcutIntent . putExtra ( " text " , input . getText ( ) . toString ( ) ) ; 
 - Intent addIntent = new Intent ( ) ; 
 - addIntent 
 - . putExtra ( Intent . EXTRA _ SHORTCUT _ INTENT , shortcutIntent ) ; 
 - addIntent . putExtra ( Intent . EXTRA _ SHORTCUT _ NAME , input . getText ( ) . toString ( ) + " - > " + users ( ) . get ( peer . getPeerId ( ) ) . getNick ( ) . get ( ) ) ; 
 - addIntent . putExtra ( Intent . EXTRA _ SHORTCUT _ ICON _ RESOURCE , 
 - Intent . ShortcutIconResource . fromContext ( getContext ( ) , 
 - R . drawable . ic _ message _ white _ 24dp ) ) ; 
 - 
 - addIntent . setAction ( " com . android . launcher . action . INSTALL _ SHORTCUT " ) ; 
 - getContext ( ) . getApplicationContext ( ) . sendBroadcast ( addIntent ) ; 
 - actionMode . finish ( ) ; 
 - } 
 - } ) ; 
 - builder . setNegativeButton ( R . string . dialog _ cancel , new DialogInterface . OnClickListener ( ) { 
 - @ Override 
 - public void onClick ( DialogInterface dialog , int which ) { 
 - dialog . cancel ( ) ; 
 - } 
 - } ) ; 
 - 
 - android . support . v7 . app . AlertDialog ad = builder . create ( ) ; 
 - ad . setOnShowListener ( new DialogInterface . OnShowListener ( ) { 
 - @ Override 
 - public void onShow ( DialogInterface dialog ) { 
 - InputMethodManager inputMethodManager = ( InputMethodManager ) getActivity ( ) . getSystemService ( FragmentActivity . INPUT _ METHOD _ SERVICE ) ; 
 - input . requestFocus ( ) ; 
 - inputMethodManager . showSoftInput ( input , 0 ) ; 
 - } 
 - } ) ; 
 - ad . show ( ) ; 
 + shortcutText = messenger ( ) . getFormatter ( ) . formatMessagesExport ( messagesAdapter . getSelected ( ) ) ; 
 + 
 + Drawable shortCutDrawable = getResources ( ) . getDrawable ( R . drawable . ic _ message _ white _ 24dp ) ; 
 + 
 + createShortcutDialog ( menuItem . getTitle ( ) . toString ( ) , shortCutDrawable ) ; 
 + actionMode . finish ( ) ; 
 
 
 } else if ( menuItem . getItemId ( ) = = R . id . delete ) { 
 @ @ - 512 , 6 + 473 , 85 @ @ public class MessagesFragment extends DisplayListFragment < Message , MessageHolder 
 return true ; 
 } 
 
 + public void createShortcutDialog ( String title , final Drawable shortCutDrawable ) { 
 + final android . support . v7 . app . AlertDialog . Builder builder = new android . support . v7 . app . AlertDialog . Builder ( getActivity ( ) , R . style . AlertDialogStyle ) ; 
 + builder . setTitle ( title ) ; 
 + 
 + final LinearLayout ll = new LinearLayout ( getActivity ( ) ) ; 
 + ll . setPadding ( Screen . dp ( 20 ) , 0 , Screen . dp ( 20 ) , 0 ) ; 
 + 
 + final EditText shortcutInput = new EditText ( getActivity ( ) ) ; 
 + shortcutInput . setTextColor ( Color . BLACK ) ; 
 + shortcutInput . setText ( shortcutText ) ; 
 + shortcutInput . setCompoundDrawablesWithIntrinsicBounds ( shortCutDrawable , null , null , null ) ; 
 + ll . addView ( shortcutInput , LinearLayout . LayoutParams . MATCH _ PARENT , LinearLayout . LayoutParams . WRAP _ CONTENT ) ; 
 + builder . setView ( ll ) ; 
 + 
 + builder . setPositiveButton ( getString ( R . string . dialog _ ok ) , new DialogInterface . OnClickListener ( ) { 
 + @ Override 
 + public void onClick ( DialogInterface dialog , int which ) { 
 + Intent shortcutIntent = new Intent ( getContext ( ) , ShortcutActivity . class ) ; 
 + shortcutIntent . addFlags ( Intent . FLAG _ ACTIVITY _ NO _ HISTORY | Intent . FLAG _ ACTIVITY _ EXCLUDE _ FROM _ RECENTS | Intent . FLAG _ ACTIVITY _ TASK _ ON _ HOME | Intent . FLAG _ ACTIVITY _ NEW _ DOCUMENT | Intent . FLAG _ ACTIVITY _ MULTIPLE _ TASK ) ; 
 + shortcutIntent . setAction ( " im . actor . action . botMessageShortcut " ) ; 
 + shortcutIntent . putExtra ( " peer " , peer . getUnuqueId ( ) ) ; 
 + shortcutIntent . putExtra ( " text " , shortcutInput . getText ( ) . toString ( ) ) ; 
 + Intent addIntent = new Intent ( ) ; 
 + addIntent 
 + . putExtra ( Intent . EXTRA _ SHORTCUT _ INTENT , shortcutIntent ) ; 
 + addIntent . putExtra ( Intent . EXTRA _ SHORTCUT _ NAME , shortcutInput . getText ( ) . toString ( ) + " - > " + users ( ) . get ( peer . getPeerId ( ) ) . getNick ( ) . get ( ) ) ; 
 + / / addIntent . putExtra ( Intent . EXTRA _ SHORTCUT _ ICON _ RESOURCE , 
 + / / Intent . ShortcutIconResource . fromContext ( getContext ( ) , 
 + / / R . drawable . ic _ message _ white _ 24dp ) ) ; 
 + 
 + BitmapDrawable bd = ( BitmapDrawable ) shortCutDrawable ; 
 + addIntent . putExtra ( Intent . EXTRA _ SHORTCUT _ ICON , bd . getBitmap ( ) ) ; 
 + 
 + addIntent . setAction ( " com . android . launcher . action . INSTALL _ SHORTCUT " ) ; 
 + getContext ( ) . getApplicationContext ( ) . sendBroadcast ( addIntent ) ; 
 + } 
 + } ) ; 
 + builder . setNegativeButton ( R . string . dialog _ cancel , new DialogInterface . OnClickListener ( ) { 
 + @ Override 
 + public void onClick ( DialogInterface dialog , int which ) { 
 + dialog . cancel ( ) ; 
 + } 
 + } ) ; 
 + 
 + builder . setNeutralButton ( " Icon " , new DialogInterface . OnClickListener ( ) { 
 + @ Override 
 + public void onClick ( DialogInterface dialog , int which ) { 
 + Intent intent = new Intent ( Intent . ACTION _ PICK , MediaStore . Images . Media . EXTERNAL _ CONTENT _ URI ) ; 
 + intent . setType ( " image / * " ) ; 
 + startActivityForResult ( intent , REQUEST _ GALLERY ) ; 
 + } 
 + } ) ; 
 + 
 + android . support . v7 . app . AlertDialog ad = builder . create ( ) ; 
 + ad . setOnShowListener ( new DialogInterface . OnShowListener ( ) { 
 + @ Override 
 + public void onShow ( DialogInterface dialog ) { 
 + InputMethodManager inputMethodManager = ( InputMethodManager ) getActivity ( ) . getSystemService ( FragmentActivity . INPUT _ METHOD _ SERVICE ) ; 
 + shortcutInput . requestFocus ( ) ; 
 + inputMethodManager . showSoftInput ( shortcutInput , 0 ) ; 
 + } 
 + } ) ; 
 + ad . show ( ) ; 
 + } 
 + 
 + @ Override 
 + public void onActivityResult ( int requestCode , int resultCode , Intent data ) { 
 + if ( resultCode = = Activity . RESULT _ OK ) { 
 + if ( requestCode = = REQUEST _ GALLERY ) { 
 + try { 
 + createShortcutDialog ( " Create shortcut " , Drawable . createFromStream ( getActivity ( ) . getContentResolver ( ) . openInputStream ( data . getData ( ) ) , null ) ) ; 
 + } catch ( FileNotFoundException e ) { 
 + e . printStackTrace ( ) ; 
 + } 
 + } 
 + } 
 + super . onActivityResult ( requestCode , resultCode , data ) ; 
 + } 
 + 
 @ Override 
 public void onPause ( ) { 
 super . onPause ( ) ; 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / styles . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / styles . xml 
 index 6f2b8ab . . 6b54f4e 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / styles . xml 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / styles . xml 
 @ @ - 86 , 7 + 86 , 7 @ @ 
 < item name = " android : windowAnimationStyle " > @ null < / item > 
 < / style > 
 
 - < style name = " AlertDialogStyle " parent = " Theme . AppCompat . Light . Dialog . Alert " / > 
 + < style name = " AlertDialogStyle " parent = " Theme . AppCompat . Dialog . Alert " / > 
 
 < style name = " AppcompatNoDisplay " parent = " Theme . AppCompat . NoActionBar " > 
 < item name = " android : windowBackground " > @ null < / item >

NEAREST DIFF:
diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / MessagesFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / MessagesFragment . java 
 index 94e5455 . . c6d6813 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / MessagesFragment . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / messages / MessagesFragment . java 
 @ @ - 7 , 8 + 7 , 11 @ @ import android . content . Context ; 
 import android . content . DialogInterface ; 
 import android . content . Intent ; 
 import android . graphics . Color ; 
 + import android . graphics . drawable . BitmapDrawable ; 
 + import android . graphics . drawable . Drawable ; 
 import android . os . Build ; 
 import android . os . Bundle ; 
 + import android . provider . MediaStore ; 
 import android . support . annotation . Nullable ; 
 import android . support . v4 . app . FragmentActivity ; 
 import android . support . v7 . app . AppCompatActivity ; 
 @ @ - 27 , 6 + 30 , 7 @ @ import android . widget . FrameLayout ; 
 import android . widget . LinearLayout ; 
 import android . widget . Toast ; 
 
 + import java . io . FileNotFoundException ; 
 import java . io . IOException ; 
 
 import im . actor . core . entity . Message ; 
 @ @ - 60 , 6 + 64 , 9 @ @ import static im . actor . sdk . util . ActorSDKMessenger . users ; 
 @ TargetApi ( Build . VERSION _ CODES . LOLLIPOP ) 
 public class MessagesFragment extends DisplayListFragment < Message , MessageHolder > { 
 
 + private static final int REQUEST _ GALLERY = 198 ; 
 + private String shortcutText ; 
 + 
 public static MessagesFragment create ( Peer peer ) { 
 return new MessagesFragment ( peer ) ; 
 } 
 @ @ - 298 , 58 + 305 , 12 @ @ public class MessagesFragment extends DisplayListFragment < Message , MessageHolder 
 @ Override 
 public boolean onActionItemClicked ( final ActionMode actionMode , MenuItem menuItem ) { 
 if ( menuItem . getItemId ( ) = = R . id . shortcut ) { 
 - final String text = messenger ( ) . getFormatter ( ) . formatMessagesExport ( messagesAdapter . getSelected ( ) ) ; 
 - 
 - android . support . v7 . app . AlertDialog . Builder builder = new android . support . v7 . app . AlertDialog . Builder ( getActivity ( ) , R . style . AlertDialogStyle ) ; 
 - builder . setTitle ( menuItem . getTitle ( ) ) ; 
 - 
 - final LinearLayout ll = new LinearLayout ( getActivity ( ) ) ; 
 - ll . setPadding ( Screen . dp ( 20 ) , 0 , Screen . dp ( 20 ) , 0 ) ; 
 - 
 - final EditText input = new EditText ( getActivity ( ) ) ; 
 - input . setTextColor ( Color . BLACK ) ; 
 - input . setText ( text ) ; 
 - ll . addView ( input , LinearLayout . LayoutParams . MATCH _ PARENT , LinearLayout . LayoutParams . WRAP _ CONTENT ) ; 
 - builder . setView ( ll ) ; 
 - 
 - builder . setPositiveButton ( getString ( R . string . dialog _ ok ) , new DialogInterface . OnClickListener ( ) { 
 - @ Override 
 - public void onClick ( DialogInterface dialog , int which ) { 
 - Intent shortcutIntent = new Intent ( getContext ( ) , ShortcutActivity . class ) ; 
 - shortcutIntent . addFlags ( Intent . FLAG _ ACTIVITY _ NO _ HISTORY | Intent . FLAG _ ACTIVITY _ EXCLUDE _ FROM _ RECENTS | Intent . FLAG _ ACTIVITY _ TASK _ ON _ HOME | Intent . FLAG _ ACTIVITY _ NEW _ DOCUMENT | Intent . FLAG _ ACTIVITY _ MULTIPLE _ TASK ) ; 
 - shortcutIntent . setAction ( " im . actor . action . botMessageShortcut " ) ; 
 - shortcutIntent . putExtra ( " peer " , peer . getUnuqueId ( ) ) ; 
 - shortcutIntent . putExtra ( " text " , input . getText ( ) . toString ( ) ) ; 
 - Intent addIntent = new Intent ( ) ; 
 - addIntent 
 - . putExtra ( Intent . EXTRA _ SHORTCUT _ INTENT , shortcutIntent ) ; 
 - addIntent . putExtra ( Intent . EXTRA _ SHORTCUT _ NAME , input . getText ( ) . toString ( ) + " - > " + users ( ) . get ( peer . getPeerId ( ) ) . getNick ( ) . get ( ) ) ; 
 - addIntent . putExtra ( Intent . EXTRA _ SHORTCUT _ ICON _ RESOURCE , 
 - Intent . ShortcutIconResource . fromContext ( getContext ( ) , 
 - R . drawable . ic _ message _ white _ 24dp ) ) ; 
 - 
 - addIntent . setAction ( " com . android . launcher . action . INSTALL _ SHORTCUT " ) ; 
 - getContext ( ) . getApplicationContext ( ) . sendBroadcast ( addIntent ) ; 
 - actionMode . finish ( ) ; 
 - } 
 - } ) ; 
 - builder . setNegativeButton ( R . string . dialog _ cancel , new DialogInterface . OnClickListener ( ) { 
 - @ Override 
 - public void onClick ( DialogInterface dialog , int which ) { 
 - dialog . cancel ( ) ; 
 - } 
 - } ) ; 
 - 
 - android . support . v7 . app . AlertDialog ad = builder . create ( ) ; 
 - ad . setOnShowListener ( new DialogInterface . OnShowListener ( ) { 
 - @ Override 
 - public void onShow ( DialogInterface dialog ) { 
 - InputMethodManager inputMethodManager = ( InputMethodManager ) getActivity ( ) . getSystemService ( FragmentActivity . INPUT _ METHOD _ SERVICE ) ; 
 - input . requestFocus ( ) ; 
 - inputMethodManager . showSoftInput ( input , 0 ) ; 
 - } 
 - } ) ; 
 - ad . show ( ) ; 
 + shortcutText = messenger ( ) . getFormatter ( ) . formatMessagesExport ( messagesAdapter . getSelected ( ) ) ; 
 + 
 + Drawable shortCutDrawable = getResources ( ) . getDrawable ( R . drawable . ic _ message _ white _ 24dp ) ; 
 + 
 + createShortcutDialog ( menuItem . getTitle ( ) . toString ( ) , shortCutDrawable ) ; 
 + actionMode . finish ( ) ; 
 
 
 } else if ( menuItem . getItemId ( ) = = R . id . delete ) { 
 @ @ - 512 , 6 + 473 , 85 @ @ public class MessagesFragment extends DisplayListFragment < Message , MessageHolder 
 return true ; 
 } 
 
 + public void createShortcutDialog ( String title , final Drawable shortCutDrawable ) { 
 + final android . support . v7 . app . AlertDialog . Builder builder = new android . support . v7 . app . AlertDialog . Builder ( getActivity ( ) , R . style . AlertDialogStyle ) ; 
 + builder . setTitle ( title ) ; 
 + 
 + final LinearLayout ll = new LinearLayout ( getActivity ( ) ) ; 
 + ll . setPadding ( Screen . dp ( 20 ) , 0 , Screen . dp ( 20 ) , 0 ) ; 
 + 
 + final EditText shortcutInput = new EditText ( getActivity ( ) ) ; 
 + shortcutInput . setTextColor ( Color . BLACK ) ; 
 + shortcutInput . setText ( shortcutText ) ; 
 + shortcutInput . setCompoundDrawablesWithIntrinsicBounds ( shortCutDrawable , null , null , null ) ; 
 + ll . addView ( shortcutInput , LinearLayout . LayoutParams . MATCH _ PARENT , LinearLayout . LayoutParams . WRAP _ CONTENT ) ; 
 + builder . setView ( ll ) ; 
 + 
 + builder . setPositiveButton ( getString ( R . string . dialog _ ok ) , new DialogInterface . OnClickListener ( ) { 
 + @ Override 
 + public void onClick ( DialogInterface dialog , int which ) { 
 + Intent shortcutIntent = new Intent ( getContext ( ) , ShortcutActivity . class ) ; 
 + shortcutIntent . addFlags ( Intent . FLAG _ ACTIVITY _ NO _ HISTORY | Intent . FLAG _ ACTIVITY _ EXCLUDE _ FROM _ RECENTS | Intent . FLAG _ ACTIVITY _ TASK _ ON _ HOME | Intent . FLAG _ ACTIVITY _ NEW _ DOCUMENT | Intent . FLAG _ ACTIVITY _ MULTIPLE _ TASK ) ; 
 + shortcutIntent . setAction ( " im . actor . action . botMessageShortcut " ) ; 
 + shortcutIntent . putExtra ( " peer " , peer . getUnuqueId ( ) ) ; 
 + shortcutIntent . putExtra ( " text " , shortcutInput . getText ( ) . toString ( ) ) ; 
 + Intent addIntent = new Intent ( ) ; 
 + addIntent 
 + . putExtra ( Intent . EXTRA _ SHORTCUT _ INTENT , shortcutIntent ) ; 
 + addIntent . putExtra ( Intent . EXTRA _ SHORTCUT _ NAME , shortcutInput . getText ( ) . toString ( ) + " - > " + users ( ) . get ( peer . getPeerId ( ) ) . getNick ( ) . get ( ) ) ; 
 + / / addIntent . putExtra ( Intent . EXTRA _ SHORTCUT _ ICON _ RESOURCE , 
 + / / Intent . ShortcutIconResource . fromContext ( getContext ( ) , 
 + / / R . drawable . ic _ message _ white _ 24dp ) ) ; 
 + 
 + BitmapDrawable bd = ( BitmapDrawable ) shortCutDrawable ; 
 + addIntent . putExtra ( Intent . EXTRA _ SHORTCUT _ ICON , bd . getBitmap ( ) ) ; 
 + 
 + addIntent . setAction ( " com . android . launcher . action . INSTALL _ SHORTCUT " ) ; 
 + getContext ( ) . getApplicationContext ( ) . sendBroadcast ( addIntent ) ; 
 + } 
 + } ) ; 
 + builder . setNegativeButton ( R . string . dialog _ cancel , new DialogInterface . OnClickListener ( ) { 
 + @ Override 
 + public void onClick ( DialogInterface dialog , int which ) { 
 + dialog . cancel ( ) ; 
 + } 
 + } ) ; 
 + 
 + builder . setNeutralButton ( " Icon " , new DialogInterface . OnClickListener ( ) { 
 + @ Override 
 + public void onClick ( DialogInterface dialog , int which ) { 
 + Intent intent = new Intent ( Intent . ACTION _ PICK , MediaStore . Images . Media . EXTERNAL _ CONTENT _ URI ) ; 
 + intent . setType ( " image / * " ) ; 
 + startActivityForResult ( intent , REQUEST _ GALLERY ) ; 
 + } 
 + } ) ; 
 + 
 + android . support . v7 . app . AlertDialog ad = builder . create ( ) ; 
 + ad . setOnShowListener ( new DialogInterface . OnShowListener ( ) { 
 + @ Override 
 + public void onShow ( DialogInterface dialog ) { 
 + InputMethodManager inputMethodManager = ( InputMethodManager ) getActivity ( ) . getSystemService ( FragmentActivity . INPUT _ METHOD _ SERVICE ) ; 
 + shortcutInput . requestFocus ( ) ; 
 + inputMethodManager . showSoftInput ( shortcutInput , 0 ) ; 
 + } 
 + } ) ; 
 + ad . show ( ) ; 
 + } 
 + 
 + @ Override 
 + public void onActivityResult ( int requestCode , int resultCode , Intent data ) { 
 + if ( resultCode = = Activity . RESULT _ OK ) { 
 + if ( requestCode = = REQUEST _ GALLERY ) { 
 + try { 
 + createShortcutDialog ( " Create shortcut " , Drawable . createFromStream ( getActivity ( ) . getContentResolver ( ) . openInputStream ( data . getData ( ) ) , null ) ) ; 
 + } catch ( FileNotFoundException e ) { 
 + e . printStackTrace ( ) ; 
 + } 
 + } 
 + } 
 + super . onActivityResult ( requestCode , resultCode , data ) ; 
 + } 
 + 
 @ Override 
 public void onPause ( ) { 
 super . onPause ( ) ; 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / styles . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / styles . xml 
 index 6f2b8ab . . 6b54f4e 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / styles . xml 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / values / styles . xml 
 @ @ - 86 , 7 + 86 , 7 @ @ 
 < item name = " android : windowAnimationStyle " > @ null < / item > 
 < / style > 
 
 - < style name = " AlertDialogStyle " parent = " Theme . AppCompat . Light . Dialog . Alert " / > 
 + < style name = " AlertDialogStyle " parent = " Theme . AppCompat . Dialog . Alert " / > 
 
 < style name = " AppcompatNoDisplay " parent = " Theme . AppCompat . NoActionBar " > 
 < item name = " android : windowBackground " > @ null < / item >
