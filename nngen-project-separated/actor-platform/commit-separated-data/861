BLEU SCORE: 0.1760870361361878

TEST MSG: feat ( iOS ) : Enable proximity monitoring during call
GENERATED MSG: fix ( iOS ) : remove memory leaks form conv controller and attachment sheet

TEST DIFF (one line): diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Calls / AACallViewController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Calls / AACallViewController . swift < nl > index aa56b69 . . a4520d7 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Calls / AACallViewController . swift < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Calls / AACallViewController . swift < nl > @ @ - 159 , 10 + 159 , 13 @ @ public class AACallViewController : AAViewController { < nl > self . senderAvatar . bind ( group . getNameModel ( ) . get ( ) , id : group . getId ( ) , avatar : value ) < nl > } ) < nl > } < nl > + < nl > + UIDevice . currentDevice ( ) . proximityMonitoringEnabled = true < nl > } < nl > < nl > public override func viewWillDisappear ( animated : Bool ) { < nl > super . viewWillDisappear ( animated ) < nl > + UIDevice . currentDevice ( ) . proximityMonitoringEnabled = false < nl > binder . unbindAll ( ) < nl > } < nl > } < nl > \ No newline at end of file
NEAREST DIFF (one line): diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Cell / AABubbleCell . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Cell / AABubbleCell . swift < nl > index 5a15add . . 8f60973 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Cell / AABubbleCell . swift < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Cell / AABubbleCell . swift < nl > @ @ - 122 , 7 + 122 , 7 @ @ public class AABubbleCell : UICollectionViewCell { < nl > < nl > / / Binded data < nl > public var peer : ACPeer ! < nl > - public var controller : AAConversationContentController ! < nl > + public weak var controller : AAConversationContentController ! < nl > public var isGroup : Bool = false < nl > public var isFullSize : Bool ! < nl > public var bindedSetting : AACellSetting ? < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Views / AAConvActionSheet . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Views / AAConvActionSheet . swift < nl > index 58f4ec0 . . 5e4ce78 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Views / AAConvActionSheet . swift < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Views / AAConvActionSheet . swift < nl > @ @ - 305 , 5 + 305 , 6 @ @ class AAConvActionSheet : UIView { < nl > } < nl > < nl > } < nl > + < nl > < nl > } < nl > diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Conversation / ConversationViewController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Conversation / ConversationViewController . swift < nl > index 8b6732b . . e1fe5cc 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Conversation / ConversationViewController . swift < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Conversation / ConversationViewController . swift < nl > @ @ - 180 , 12 + 180 , 6 @ @ class ConversationViewController : AAConversationContentController , UIDocumentMen < nl > name : SLKKeyboardWillHideNotification , < nl > object : nil ) < nl > < nl > - } < nl > - < nl > - override func viewWillAppear ( animated : Bool ) { < nl > - super . viewWillAppear ( animated ) < nl > - < nl > - textView . text = Actor . loadDraftWithPeer ( peer ) < nl > < nl > / / Installing bindings < nl > if ( UInt ( peer . peerType . ordinal ( ) ) = = ACPeerType . PRIVATE . rawValue ) { < nl > @ @ - 240 , 7 + 234 , 7 @ @ class ConversationViewController : AAConversationContentController , UIDocumentMen < nl > } else { < nl > self . setTextInputbarHidden ( false , animated : false ) < nl > } < nl > - < nl > + < nl > if ( typingValue ! = nil & & typingValue ! . length ( ) > 0 ) { < nl > self . subtitleView . textColor = self . appStyle . navigationSubtitleActiveColor < nl > if ( typingValue ! . length ( ) = = 1 ) { < nl > @ @ - 268 , 6 + 262 , 19 @ @ class ConversationViewController : AAConversationContentController , UIDocumentMen < nl > < nl > Actor . onConversationOpenWithPeer ( peer ) < nl > ActorSDK . sharedActor ( ) . trackPageVisible ( content ) < nl > + < nl > + } < nl > + < nl > + override func viewWillAppear ( animated : Bool ) { < nl > + super . viewWillAppear ( animated ) < nl > + < nl > + < nl > + if textView . isFirstResponder ( ) = = false { < nl > + textView . resignFirstResponder ( ) < nl > + } < nl > + < nl > + textView . text = Actor . loadDraftWithPeer ( peer ) < nl > + < nl > } < nl > < nl > override func viewWillLayoutSubviews ( ) { < nl > @ @ - 320 , 6 + 327 , 9 @ @ class ConversationViewController : AAConversationContentController , UIDocumentMen < nl > < nl > / / Releasing bindings < nl > binder . unbindAll ( ) < nl > + < nl > + self . actionSheet . removeFromSuperview ( ) < nl > + self . actionSheet = nil < nl > } < nl > < nl > / / Chat avatar tap < nl > @ @ - 798 , 6 + 808 , 10 @ @ class ConversationViewController : AAConversationContentController , UIDocumentMen < nl > Actor . sendStickerWithPeer ( self . peer , withSticker : sticker ) < nl > < nl > } < nl > + < nl > + deinit { < nl > + print ( " conversation controller deinit ' ed " ) < nl > + } < nl > < nl > < nl > }

TEST DIFF:
diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Calls / AACallViewController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Calls / AACallViewController . swift 
 index aa56b69 . . a4520d7 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Calls / AACallViewController . swift 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Calls / AACallViewController . swift 
 @ @ - 159 , 10 + 159 , 13 @ @ public class AACallViewController : AAViewController { 
 self . senderAvatar . bind ( group . getNameModel ( ) . get ( ) , id : group . getId ( ) , avatar : value ) 
 } ) 
 } 
 + 
 + UIDevice . currentDevice ( ) . proximityMonitoringEnabled = true 
 } 
 
 public override func viewWillDisappear ( animated : Bool ) { 
 super . viewWillDisappear ( animated ) 
 + UIDevice . currentDevice ( ) . proximityMonitoringEnabled = false 
 binder . unbindAll ( ) 
 } 
 } 
 \ No newline at end of file

NEAREST DIFF:
diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Cell / AABubbleCell . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Cell / AABubbleCell . swift 
 index 5a15add . . 8f60973 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Cell / AABubbleCell . swift 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Cell / AABubbleCell . swift 
 @ @ - 122 , 7 + 122 , 7 @ @ public class AABubbleCell : UICollectionViewCell { 
 
 / / Binded data 
 public var peer : ACPeer ! 
 - public var controller : AAConversationContentController ! 
 + public weak var controller : AAConversationContentController ! 
 public var isGroup : Bool = false 
 public var isFullSize : Bool ! 
 public var bindedSetting : AACellSetting ? 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Views / AAConvActionSheet . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Views / AAConvActionSheet . swift 
 index 58f4ec0 . . 5e4ce78 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Views / AAConvActionSheet . swift 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Content / Conversation / Views / AAConvActionSheet . swift 
 @ @ - 305 , 5 + 305 , 6 @ @ class AAConvActionSheet : UIView { 
 } 
 
 } 
 + 
 
 } 
 diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Conversation / ConversationViewController . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Conversation / ConversationViewController . swift 
 index 8b6732b . . e1fe5cc 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Conversation / ConversationViewController . swift 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / Controllers / Conversation / ConversationViewController . swift 
 @ @ - 180 , 12 + 180 , 6 @ @ class ConversationViewController : AAConversationContentController , UIDocumentMen 
 name : SLKKeyboardWillHideNotification , 
 object : nil ) 
 
 - } 
 - 
 - override func viewWillAppear ( animated : Bool ) { 
 - super . viewWillAppear ( animated ) 
 - 
 - textView . text = Actor . loadDraftWithPeer ( peer ) 
 
 / / Installing bindings 
 if ( UInt ( peer . peerType . ordinal ( ) ) = = ACPeerType . PRIVATE . rawValue ) { 
 @ @ - 240 , 7 + 234 , 7 @ @ class ConversationViewController : AAConversationContentController , UIDocumentMen 
 } else { 
 self . setTextInputbarHidden ( false , animated : false ) 
 } 
 - 
 + 
 if ( typingValue ! = nil & & typingValue ! . length ( ) > 0 ) { 
 self . subtitleView . textColor = self . appStyle . navigationSubtitleActiveColor 
 if ( typingValue ! . length ( ) = = 1 ) { 
 @ @ - 268 , 6 + 262 , 19 @ @ class ConversationViewController : AAConversationContentController , UIDocumentMen 
 
 Actor . onConversationOpenWithPeer ( peer ) 
 ActorSDK . sharedActor ( ) . trackPageVisible ( content ) 
 + 
 + } 
 + 
 + override func viewWillAppear ( animated : Bool ) { 
 + super . viewWillAppear ( animated ) 
 + 
 + 
 + if textView . isFirstResponder ( ) = = false { 
 + textView . resignFirstResponder ( ) 
 + } 
 + 
 + textView . text = Actor . loadDraftWithPeer ( peer ) 
 + 
 } 
 
 override func viewWillLayoutSubviews ( ) { 
 @ @ - 320 , 6 + 327 , 9 @ @ class ConversationViewController : AAConversationContentController , UIDocumentMen 
 
 / / Releasing bindings 
 binder . unbindAll ( ) 
 + 
 + self . actionSheet . removeFromSuperview ( ) 
 + self . actionSheet = nil 
 } 
 
 / / Chat avatar tap 
 @ @ - 798 , 6 + 808 , 10 @ @ class ConversationViewController : AAConversationContentController , UIDocumentMen 
 Actor . sendStickerWithPeer ( self . peer , withSticker : sticker ) 
 
 } 
 + 
 + deinit { 
 + print ( " conversation controller deinit ' ed " ) 
 + } 
 
 
 }
