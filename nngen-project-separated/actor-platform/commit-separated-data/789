BLEU SCORE: 0.345720784641941

TEST MSG: style ( android ) : new calls design
GENERATED MSG: feat ( android ) : chat unread counter

TEST DIFF (one line): diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / calls / CallFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / calls / CallFragment . java < nl > index 1c81113 . . 4cb5158 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / calls / CallFragment . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / calls / CallFragment . java < nl > @ @ - 10 , 7 + 10 , 6 @ @ import android . content . Intent ; < nl > import android . content . pm . PackageManager ; < nl > import android . graphics . Color ; < nl > import android . graphics . drawable . GradientDrawable ; < nl > - import android . graphics . drawable . ShapeDrawable ; < nl > import android . media . AudioManager ; < nl > import android . media . Ringtone ; < nl > import android . media . RingtoneManager ; < nl > @ @ - 136 , 7 + 135 , 7 @ @ public class CallFragment extends BaseFragment { < nl > for ( int i = 0 ; i < avatarLayers . length ; i + + ) { < nl > View layer = avatarLayers [ i ] ; < nl > ( ( GradientDrawable ) layer . getBackground ( ) ) . setColor ( Color . WHITE ) ; < nl > - ( ( GradientDrawable ) layer . getBackground ( ) ) . setAlpha ( 150 ) ; < nl > + ( ( GradientDrawable ) layer . getBackground ( ) ) . setAlpha ( 50 ) ; < nl > } < nl > < nl > answerContainer = cont . findViewById ( R . id . answer _ container ) ; < nl > @ @ - 180 , 6 + 179 , 8 @ @ public class CallFragment extends BaseFragment { < nl > bind ( nameTV , g . getName ( ) ) ; < nl > } < nl > < nl > + nameTV . setSelected ( true ) ; < nl > + < nl > / / < nl > / / Members list < nl > / / < nl > @ @ - 234 , 19 + 235 , 13 @ @ public class CallFragment extends BaseFragment { < nl > cont . findViewById ( R . id . speaker _ btn ) . setOnClickListener ( new View . OnClickListener ( ) { < nl > @ Override < nl > public void onClick ( View v ) { < nl > - speakerOn = ! speakerOn ; < nl > - audioManager . setSpeakerphoneOn ( speakerOn ) ; < nl > - if ( speakerOn ) { < nl > - speaker . setTint ( Color . WHITE ) ; < nl > - speakerTV . setTextColor ( Color . WHITE ) ; < nl > - } else { < nl > - speaker . setTint ( getResources ( ) . getColor ( R . color . picker _ grey ) ) ; < nl > - speakerTV . setTextColor ( getResources ( ) . getColor ( R . color . picker _ grey ) ) ; < nl > - } < nl > + toggleSpeaker ( speaker , speakerTV ) ; < nl > } < nl > } ) ; < nl > + checkSpeaker ( speaker , speakerTV ) ; < nl > < nl > final TintImageView muteCall = ( TintImageView ) cont . findViewById ( R . id . mute ) ; < nl > + final TextView muteCallTv = ( TextView ) cont . findViewById ( R . id . mute _ tv ) ; < nl > muteCall . setResource ( R . drawable . ic _ mic _ off _ white _ 24dp ) ; < nl > cont . findViewById ( R . id . mute _ btn ) . setOnClickListener ( new View . OnClickListener ( ) { < nl > @ Override < nl > @ @ - 257 , 24 + 252 , 35 @ @ public class CallFragment extends BaseFragment { < nl > < nl > final TintImageView video = ( TintImageView ) cont . findViewById ( R . id . video ) ; < nl > video . setResource ( R . drawable . ic _ videocam _ white _ 24dp ) ; < nl > + TextView videoTv = ( TextView ) cont . findViewById ( R . id . video _ tv ) ; < nl > + videoTv . setTextColor ( getResources ( ) . getColor ( R . color . picker _ grey ) ) ; < nl > + video . setTint ( getResources ( ) . getColor ( R . color . picker _ grey ) ) ; < nl > < nl > final TintImageView back = ( TintImageView ) cont . findViewById ( R . id . back ) ; < nl > back . setResource ( R . drawable . ic _ message _ white _ 24dp ) ; < nl > + cont . findViewById ( R . id . back _ btn ) . setOnClickListener ( new View . OnClickListener ( ) { < nl > + @ Override < nl > + public void onClick ( View v ) { < nl > + getActivity ( ) . onBackPressed ( ) ; < nl > + } < nl > + } ) ; < nl > < nl > final TintImageView add = ( TintImageView ) cont . findViewById ( R . id . add ) ; < nl > add . setResource ( R . drawable . ic _ person _ add _ white _ 24dp ) ; < nl > - < nl > + TextView addTv = ( TextView ) cont . findViewById ( R . id . add _ user _ tv ) ; < nl > + addTv . setTextColor ( getResources ( ) . getColor ( R . color . picker _ grey ) ) ; < nl > + add . setTint ( getResources ( ) . getColor ( R . color . picker _ grey ) ) ; < nl > < nl > if ( call ! = null ) { < nl > call . getIsMuted ( ) . subscribe ( new ValueChangedListener < Boolean > ( ) { < nl > @ Override < nl > public void onChanged ( Boolean val , Value < Boolean > valueModel ) { < nl > if ( val ) { < nl > - muteCall . setBackgroundResource ( R . drawable . call _ action _ background _ active ) ; < nl > - muteCall . setTint ( Color . WHITE ) ; < nl > + muteCallTv . setTextColor ( getResources ( ) . getColor ( R . color . picker _ grey ) ) ; < nl > + muteCall . setTint ( getResources ( ) . getColor ( R . color . picker _ grey ) ) ; < nl > } else { < nl > - muteCall . setBackgroundResource ( R . drawable . call _ action _ background ) ; < nl > - muteCall . setTint ( getResources ( ) . getColor ( R . color . primary ) ) ; < nl > + muteCallTv . setTextColor ( Color . WHITE ) ; < nl > + muteCall . setTint ( Color . WHITE ) ; < nl > } < nl > } < nl > } ) ; < nl > @ @ - 323 , 6 + 329 , 22 @ @ public class CallFragment extends BaseFragment { < nl > return cont ; < nl > } < nl > < nl > + public void toggleSpeaker ( TintImageView speaker , TextView speakerTV ) { < nl > + speakerOn = ! speakerOn ; < nl > + audioManager . setSpeakerphoneOn ( speakerOn ) ; < nl > + checkSpeaker ( speaker , speakerTV ) ; < nl > + } < nl > + < nl > + public void checkSpeaker ( TintImageView speaker , TextView speakerTV ) { < nl > + if ( speakerOn ) { < nl > + speaker . setTint ( Color . WHITE ) ; < nl > + speakerTV . setTextColor ( Color . WHITE ) ; < nl > + } else { < nl > + speaker . setTint ( getResources ( ) . getColor ( R . color . picker _ grey ) ) ; < nl > + speakerTV . setTextColor ( getResources ( ) . getColor ( R . color . picker _ grey ) ) ; < nl > + } < nl > + } < nl > + < nl > public void switchAvatarMembers ( ) { < nl > if ( peer . getPeerType ( ) = = PeerType . GROUP ) { < nl > if ( avatarView . getVisibility ( ) = = View . VISIBLE ) { < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / fragment _ call . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / fragment _ call . xml < nl > index d295f55 . . 7cd8351 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / fragment _ call . xml < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / fragment _ call . xml < nl > @ @ - 4 , 7 + 4 , 6 @ @ < nl > android : layout _ width = " match _ parent " < nl > android : layout _ height = " match _ parent " > < nl > < nl > - < nl > < LinearLayout < nl > android : layout _ width = " match _ parent " < nl > android : layout _ height = " match _ parent " < nl > @ @ - 14 , 14 + 13 , 14 @ @ < nl > < nl > < TextView < nl > android : id = " @ + id / status " < nl > - android : layout _ marginTop = " 40dp " < nl > + android : layout _ marginTop = " 37 . 5dp " < nl > android : layout _ gravity = " center " < nl > android : gravity = " center " < nl > android : layout _ width = " wrap _ content " < nl > android : layout _ height = " wrap _ content " < nl > - android : textSize = " 20sp " < nl > - android : textColor = " @ android : color / white " < nl > - android : text = " Ringing . . . " / > < nl > + android : textSize = " 17 . 3sp " < nl > + android : fontFamily = " sans - serif - light " < nl > + android : textColor = " @ android : color / white " / > < nl > < nl > < RelativeLayout < nl > < nl > @ @ - 71 , 7 + 70 , 6 @ @ < nl > android : layout _ centerHorizontal = " true " < nl > android : background = " @ drawable / call _ avatar _ background " / > < nl > < nl > - < nl > < im . actor . sdk . view . avatar . AvatarView < nl > android : id = " @ + id / avatar " < nl > android : layout _ width = " 100dp " < nl > @ @ - 79 , 8 + 77 , 6 @ @ < nl > android : layout _ centerVertical = " true " < nl > android : layout _ centerHorizontal = " true " / > < nl > < nl > - < nl > - < nl > < ListView < nl > android : paddingLeft = " 20dp " < nl > android : paddingRight = " 20dp " < nl > @ @ - 94 , 21 + 90 , 22 @ @ < nl > < TextView < nl > android : textColor = " @ android : color / white " < nl > android : paddingTop = " 5dp " < nl > + android : paddingLeft = " 5dp " < nl > + android : paddingRight = " 5dp " < nl > android : gravity = " center _ horizontal | bottom " < nl > - < nl > - android : fontFamily = " sans - serif - thin " < nl > + android : ellipsize = " marquee " < nl > + android : scrollHorizontally = " true " < nl > + android : marqueeRepeatLimit = " marquee _ forever " < nl > + android : fontFamily = " sans - serif - light " < nl > android : id = " @ + id / name " < nl > android : layout _ width = " wrap _ content " < nl > android : layout _ height = " wrap _ content " < nl > + android : singleLine = " true " < nl > android : lines = " 1 " < nl > - android : textSize = " 32sp " < nl > + android : textSize = " 30sp " < nl > android : layout _ below = " @ + id / layer4 " < nl > android : layout _ centerHorizontal = " true " / > < nl > < nl > - < nl > - < nl > - < nl > - < nl > < / RelativeLayout > < nl > < nl > < FrameLayout < nl > @ @ - 138 , 14 + 135 , 15 @ @ < nl > android : layout _ width = " 60dp " < nl > android : layout _ height = " 60dp " < nl > android : src = " @ drawable / ic _ call _ end _ white _ 36dp " < nl > - android : background = " @ drawable / end _ call _ background " < nl > - / > < nl > + android : background = " @ drawable / end _ call _ background " / > < nl > + < nl > < / FrameLayout > < nl > < nl > < FrameLayout < nl > android : layout _ width = " 0dp " < nl > android : layout _ weight = " 1 " < nl > android : layout _ height = " 60dp " > < nl > + < nl > < ImageButton < nl > android : layout _ gravity = " center " < nl > android : id = " @ + id / answer " < nl > @ @ - 159 , 26 + 157 , 33 @ @ < nl > < / LinearLayout > < nl > < nl > < TableLayout < nl > - android : layout _ width = " match _ parent " < nl > - android : layout _ height = " match _ parent " < nl > + android : paddingBottom = " 15dp " < nl > + android : paddingLeft = " 10dp " < nl > + android : paddingRight = " 10dp " < nl > + android : layout _ gravity = " bottom | center _ horizontal " < nl > + android : layout _ width = " wrap _ content " < nl > + android : layout _ height = " wrap _ content " < nl > android : stretchColumns = " * " > < nl > + < nl > < TableRow < nl > + android : minHeight = " 110dp " < nl > android : layout _ weight = " 1 " < nl > android : gravity = " center " > < nl > + < nl > < LinearLayout < nl > android : id = " @ + id / mute _ btn " < nl > android : orientation = " vertical " < nl > android : layout _ weight = " 1 " < nl > android : layout _ width = " 0dp " < nl > android : layout _ height = " wrap _ content " > < nl > + < nl > < im . actor . sdk . view . TintImageView < nl > android : id = " @ + id / mute " < nl > android : layout _ gravity = " center _ horizontal " < nl > android : layout _ height = " @ dimen / call _ btn _ size " < nl > android : scaleType = " centerInside " < nl > - android : layout _ width = " @ dimen / call _ btn _ size " < nl > - < nl > - / > < nl > + android : layout _ width = " @ dimen / call _ btn _ size " / > < nl > + < nl > < TextView < nl > android : id = " @ + id / mute _ tv " < nl > android : layout _ gravity = " center " < nl > @ @ - 195 , 14 + 200 , 14 @ @ < nl > android : layout _ weight = " 1 " < nl > android : layout _ width = " 0dp " < nl > android : layout _ height = " wrap _ content " > < nl > + < nl > < im . actor . sdk . view . TintImageView < nl > android : id = " @ + id / speaker " < nl > android : layout _ gravity = " center _ horizontal " < nl > android : layout _ height = " @ dimen / call _ btn _ size " < nl > android : scaleType = " centerInside " < nl > - android : layout _ width = " @ dimen / call _ btn _ size " < nl > - < nl > - / > < nl > + android : layout _ width = " @ dimen / call _ btn _ size " / > < nl > + < nl > < TextView < nl > android : id = " @ + id / speaker _ tv " < nl > android : layout _ gravity = " center " < nl > @ @ - 219 , 14 + 224 , 14 @ @ < nl > android : layout _ weight = " 1 " < nl > android : layout _ width = " 0dp " < nl > android : layout _ height = " wrap _ content " > < nl > + < nl > < im . actor . sdk . view . TintImageView < nl > android : id = " @ + id / video " < nl > android : layout _ gravity = " center _ horizontal " < nl > android : layout _ height = " @ dimen / call _ btn _ size " < nl > android : scaleType = " centerInside " < nl > - android : layout _ width = " @ dimen / call _ btn _ size " < nl > - < nl > - / > < nl > + android : layout _ width = " @ dimen / call _ btn _ size " / > < nl > + < nl > < TextView < nl > android : id = " @ + id / video _ tv " < nl > android : layout _ gravity = " center " < nl > @ @ - 234 , 12 + 239 , 14 @ @ < nl > android : text = " video " < nl > android : gravity = " center " < nl > android : layout _ width = " wrap _ content " < nl > - android : layout _ height = " wrap _ content " / > < nl > + android : layout _ height = " wrap _ content " / > < nl > + < nl > < / LinearLayout > < nl > < nl > < / TableRow > < nl > < nl > < TableRow < nl > + android : minHeight = " 110dp " < nl > android : layout _ weight = " 1 " < nl > android : gravity = " center " > < nl > < nl > @ @ - 249 , 14 + 256 , 14 @ @ < nl > android : layout _ weight = " 1 " < nl > android : layout _ width = " 0dp " < nl > android : layout _ height = " wrap _ content " > < nl > + < nl > < im . actor . sdk . view . TintImageView < nl > android : id = " @ + id / back " < nl > android : layout _ gravity = " center _ horizontal " < nl > android : layout _ height = " @ dimen / call _ btn _ size " < nl > android : scaleType = " centerInside " < nl > - android : layout _ width = " @ dimen / call _ btn _ size " < nl > - < nl > - / > < nl > + android : layout _ width = " @ dimen / call _ btn _ size " / > < nl > + < nl > < TextView < nl > android : id = " @ + id / back _ tv " < nl > android : layout _ gravity = " center " < nl > @ @ - 265 , 12 + 272 , 14 @ @ < nl > android : gravity = " center " < nl > android : layout _ width = " wrap _ content " < nl > android : layout _ height = " wrap _ content " / > < nl > + < nl > < / LinearLayout > < nl > < nl > < FrameLayout < nl > android : layout _ weight = " 1 " < nl > android : layout _ width = " 0dp " < nl > android : layout _ height = " wrap _ content " > < nl > + < nl > < ImageButton < nl > android : layout _ gravity = " center " < nl > android : visibility = " visible " < nl > @ @ - 287 , 14 + 296 , 14 @ @ < nl > android : layout _ weight = " 1 " < nl > android : layout _ width = " 0dp " < nl > android : layout _ height = " wrap _ content " > < nl > + < nl > < im . actor . sdk . view . TintImageView < nl > android : id = " @ + id / add " < nl > android : layout _ gravity = " center _ horizontal " < nl > android : layout _ height = " @ dimen / call _ btn _ size " < nl > android : scaleType = " centerInside " < nl > - android : layout _ width = " @ dimen / call _ btn _ size " < nl > - < nl > - / > < nl > + android : layout _ width = " @ dimen / call _ btn _ size " / > < nl > + < nl > < TextView < nl > android : id = " @ + id / add _ user _ tv " < nl > android : layout _ gravity = " center " < nl > @ @ - 305 , 17 + 314 , 12 @ @ < nl > android : layout _ height = " wrap _ content " / > < nl > < / LinearLayout > < nl > < nl > - < nl > < / TableRow > < nl > - < / TableLayout > < nl > - < nl > - < nl > - < nl > < nl > + < / TableLayout > < nl > < nl > < / FrameLayout > < nl > < nl > < / LinearLayout > < nl > < nl > - < nl > < / FrameLayout >
NEAREST DIFF (one line): diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / activity / BaseActivity . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / activity / BaseActivity . java < nl > index 0379117 . . e40b240 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / activity / BaseActivity . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / activity / BaseActivity . java < nl > @ @ - 5 , 6 + 5 , 7 @ @ import android . graphics . drawable . ColorDrawable ; < nl > import android . os . Bundle ; < nl > import android . support . v7 . app . ActionBar ; < nl > import android . support . v7 . app . AppCompatActivity ; < nl > + import android . support . v7 . widget . Toolbar ; < nl > import android . view . View ; < nl > import android . widget . TextView ; < nl > < nl > @ @ - 71 , 6 + 72 , 10 @ @ public class BaseActivity extends AppCompatActivity { < nl > BINDER . bind ( textView , titleContainer , value ) ; < nl > } < nl > < nl > + public void bindGlobalCounter ( ValueChangedListener < Integer > callback ) { < nl > + BINDER . bindGlobalCounter ( callback ) ; < nl > + } < nl > + < nl > public void bindGroupTyping ( final TextView textView , final View container , final View titleContainer , final Value < int [ ] > typing ) { < nl > BINDER . bindGroupTyping ( textView , container , titleContainer , typing ) ; < nl > } < nl > @ @ - 131 , 12 + 136 , 17 @ @ public class BaseActivity extends AppCompatActivity { < nl > protected void setToolbar ( View view , ActionBar . LayoutParams params , boolean enableBack ) { < nl > getSupportActionBar ( ) . setDisplayShowCustomEnabled ( true ) ; < nl > getSupportActionBar ( ) . setDisplayHomeAsUpEnabled ( true ) ; < nl > - if ( enableBack ) { < nl > - getSupportActionBar ( ) . setDisplayShowHomeEnabled ( true ) ; < nl > - } < nl > getSupportActionBar ( ) . setDisplayShowTitleEnabled ( false ) ; < nl > getSupportActionBar ( ) . setDisplayUseLogoEnabled ( false ) ; < nl > getSupportActionBar ( ) . setCustomView ( view , params ) ; < nl > + if ( enableBack ) { < nl > + getSupportActionBar ( ) . setDisplayShowHomeEnabled ( true ) ; < nl > + } else { < nl > + getSupportActionBar ( ) . setDisplayShowHomeEnabled ( false ) ; < nl > + getSupportActionBar ( ) . setDisplayHomeAsUpEnabled ( false ) ; < nl > + Toolbar parent = ( Toolbar ) view . getParent ( ) ; < nl > + parent . setContentInsetsAbsolute ( 0 , 0 ) ; < nl > + } < nl > } < nl > < nl > protected void setToolbar ( View view , ActionBar . LayoutParams params ) { < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java < nl > index f4bb580 . . df168be 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java < nl > @ @ - 10 , 6 + 10 , 7 @ @ import android . content . pm . ApplicationInfo ; < nl > import android . content . pm . PackageManager ; < nl > import android . content . res . Configuration ; < nl > import android . database . Cursor ; < nl > + import android . graphics . PorterDuff ; < nl > import android . net . Uri ; < nl > import android . os . Bundle ; < nl > import android . provider . ContactsContract ; < nl > @ @ - 27 , 6 + 28 , 8 @ @ import android . view . Menu ; < nl > import android . view . MenuItem ; < nl > import android . view . MotionEvent ; < nl > import android . view . View ; < nl > + import android . view . ViewGroup ; < nl > + import android . view . ViewParent ; < nl > import android . view . animation . AlphaAnimation ; < nl > import android . view . animation . TranslateAnimation ; < nl > import android . widget . AdapterView ; < nl > @ @ - 55 , 6 + 58 , 7 @ @ import im . actor . runtime . actors . ActorSystem ; < nl > import im . actor . runtime . actors . Props ; < nl > import im . actor . runtime . actors . messages . PoisonPill ; < nl > import im . actor . sdk . ActorSDK ; < nl > + import im . actor . sdk . ActorStyle ; < nl > import im . actor . sdk . R ; < nl > import im . actor . sdk . controllers . Intents ; < nl > import im . actor . sdk . controllers . conversation . mentions . MentionsAdapter ; < nl > @ @ - 74 , 6 + 78 , 7 @ @ import im . actor . runtime . mvvm . ValueChangedListener ; < nl > import static im . actor . sdk . util . ViewUtils . expand ; < nl > import static im . actor . sdk . util . ViewUtils . expandMentions ; < nl > import static im . actor . sdk . util . ViewUtils . goneView ; < nl > + import static im . actor . sdk . util . ViewUtils . hideView ; < nl > import static im . actor . sdk . util . ViewUtils . showView ; < nl > import static im . actor . sdk . util . ViewUtils . zoomInView ; < nl > import static im . actor . sdk . util . ViewUtils . zoomOutView ; < nl > @ @ - 113 , 6 + 118 , 8 @ @ public class ChatActivity extends ActorEditTextActivity { < nl > / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / < nl > / / Toolbar views < nl > / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / < nl > + / / Toolbar unread counter < nl > + private TextView counter ; < nl > / / Toolbar Avatar view < nl > private AvatarView barAvatar ; < nl > / / Toolbar title view < nl > @ @ - 414 , 10 + 421 , 22 @ @ public class ChatActivity extends ActorEditTextActivity { < nl > protected void onCreateToolbar ( ) { < nl > / / Loading Toolbar header views < nl > / / Binding to real data is performed in onResume method < nl > + ActorStyle style = ActorSDK . sharedActor ( ) . style ; < nl > barView = LayoutInflater . from ( this ) . inflate ( R . layout . bar _ conversation , null ) ; < nl > ActionBar . LayoutParams layout = new ActionBar . LayoutParams ( ActionBar . LayoutParams . MATCH _ PARENT , ActionBar . LayoutParams . MATCH _ PARENT ) ; < nl > - setToolbar ( barView , layout ) ; < nl > + setToolbar ( barView , layout , false ) ; < nl > + findViewById ( R . id . home ) . setOnClickListener ( new View . OnClickListener ( ) { < nl > + @ Override < nl > + public void onClick ( View v ) { < nl > + onBackPressed ( ) ; < nl > + } < nl > + } ) ; < nl > + < nl > + counter = ( TextView ) barView . findViewById ( R . id . counter ) ; < nl > < nl > + counter . setTextColor ( style . getDialogsCounterTextColor ( ) ) ; < nl > + counter . setBackgroundResource ( R . drawable . ic _ counter _ circle ) ; < nl > + counter . getBackground ( ) . setColorFilter ( style . getDialogsCounterBackgroundColor ( ) , PorterDuff . Mode . MULTIPLY ) ; < nl > barTitle = ( TextView ) barView . findViewById ( R . id . title ) ; < nl > barSubtitleContainer = barView . findViewById ( R . id . subtitleContainer ) ; < nl > barTypingIcon = ( ImageView ) barView . findViewById ( R . id . typingImage ) ; < nl > @ @ - 615 , 6 + 634 , 18 @ @ public class ChatActivity extends ActorEditTextActivity { < nl > } < nl > } ) ; < nl > } < nl > + < nl > + bindGlobalCounter ( new ValueChangedListener < Integer > ( ) { < nl > + @ Override < nl > + public void onChanged ( Integer val , Value < Integer > valueModel ) { < nl > + if ( val > 0 ) { < nl > + counter . setText ( Integer . toString ( val ) ) ; < nl > + showView ( counter ) ; < nl > + } else { < nl > + hideView ( counter ) ; < nl > + } < nl > + } < nl > + } ) ; < nl > } < nl > < nl > @ Override < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / ActorBinder . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / ActorBinder . java < nl > index de76ed5 . . ba8f1cb 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / ActorBinder . java < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / ActorBinder . java < nl > @ @ - 41 , 6 + 41 , 10 @ @ public class ActorBinder { < nl > < nl > } < nl > < nl > + public void bindGlobalCounter ( ValueChangedListener < Integer > callback ) { < nl > + callback . onChanged ( messenger ( ) . getAppState ( ) . getGlobalCounter ( ) . get ( ) , messenger ( ) . getAppState ( ) . getGlobalCounter ( ) ) ; < nl > + bind ( messenger ( ) . getAppState ( ) . getGlobalCounter ( ) , callback ) ; < nl > + } < nl > < nl > public void bindGroupTyping ( final TextView textView , final View container , final View titleContainer , final Value < int [ ] > typing ) { < nl > bind ( typing , new ValueChangedListener < int [ ] > ( ) { < nl > diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / bar _ conversation . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / bar _ conversation . xml < nl > index c284f10 . . 1e5fe62 100644 < nl > - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / bar _ conversation . xml < nl > + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / bar _ conversation . xml < nl > @ @ - 5 , 71 + 5 , 105 @ @ < nl > - - > < nl > < nl > < LinearLayout xmlns : android = " http : / / schemas . android . com / apk / res / android " < nl > - android : id = " @ + id / titleContainer " < nl > android : layout _ width = " match _ parent " < nl > - android : layout _ height = " match _ parent " < nl > - android : background = " @ drawable / selector _ light " > < nl > + android : layout _ height = " match _ parent " > < nl > < nl > - < im . actor . sdk . view . avatar . AvatarView < nl > - android : id = " @ + id / avatarPreview " < nl > - android : layout _ width = " 32dp " < nl > - android : layout _ height = " 32dp " < nl > - android : layout _ gravity = " center _ vertical " < nl > - android : layout _ marginLeft = " 8dp " / > < nl > + < FrameLayout < nl > + android : id = " @ + id / home " < nl > + android : background = " @ drawable / selector _ light " < nl > + android : layout _ width = " ? attr / actionBarSize " < nl > + android : layout _ height = " match _ parent " > < nl > < nl > - < LinearLayout < nl > - android : layout _ width = " 0dp " < nl > - android : layout _ height = " match _ parent " < nl > - android : layout _ weight = " 1 " < nl > - android : gravity = " center _ vertical " < nl > - android : orientation = " vertical " < nl > - android : paddingLeft = " 8dp " > < nl > + < ImageView < nl > + < nl > + android : layout _ width = " wrap _ content " < nl > + android : layout _ height = " match _ parent " < nl > + android : src = " @ drawable / ic _ action _ navigation _ arrow _ back " < nl > + android : scaleType = " center " < nl > + android : layout _ gravity = " center _ vertical | center _ horizontal " / > < nl > < nl > < TextView < nl > - android : id = " @ + id / title " < nl > - android : layout _ width = " match _ parent " < nl > + android : layout _ marginTop = " 10dp " < nl > + android : layout _ marginRight = " 10dp " < nl > + android : layout _ gravity = " top | right " < nl > + android : id = " @ + id / counter " < nl > + android : layout _ width = " wrap _ content " < nl > android : layout _ height = " wrap _ content " < nl > - android : layout _ marginTop = " - 2dp " < nl > - android : ellipsize = " end " < nl > - android : lines = " 1 " < nl > - android : singleLine = " true " < nl > - android : textColor = " # ffffff " < nl > - android : textSize = " 18sp " / > < nl > - < nl > - < FrameLayout < nl > - android : id = " @ + id / subtitleContainer " < nl > - android : layout _ width = " match _ parent " < nl > - android : layout _ height = " wrap _ content " < nl > - android : layout _ marginTop = " - 4dp " < nl > - android : orientation = " horizontal " > < nl > + android : paddingLeft = " 4dp " < nl > + android : paddingRight = " 4dp " < nl > + android : gravity = " center " < nl > + android : textSize = " 12sp " < nl > + android : visibility = " invisible " / > < nl > + < nl > + < / FrameLayout > < nl > + < nl > + < LinearLayout < nl > + android : id = " @ + id / titleContainer " < nl > + android : layout _ width = " match _ parent " < nl > + android : layout _ height = " match _ parent " < nl > + android : background = " @ drawable / selector _ light " > < nl > + < nl > + < im . actor . sdk . view . avatar . AvatarView < nl > + android : id = " @ + id / avatarPreview " < nl > + android : layout _ width = " 32dp " < nl > + android : layout _ height = " 32dp " < nl > + android : layout _ gravity = " center _ vertical " < nl > + android : layout _ marginLeft = " 8dp " / > < nl > < nl > - < LinearLayout < nl > - android : id = " @ + id / typingContainer " < nl > + < LinearLayout < nl > + android : layout _ width = " 0dp " < nl > + android : layout _ height = " match _ parent " < nl > + android : layout _ weight = " 1 " < nl > + android : gravity = " center _ vertical " < nl > + android : orientation = " vertical " < nl > + android : paddingLeft = " 8dp " > < nl > + < nl > + < TextView < nl > + android : id = " @ + id / title " < nl > android : layout _ width = " match _ parent " < nl > android : layout _ height = " wrap _ content " < nl > + android : layout _ marginTop = " - 2dp " < nl > + android : ellipsize = " end " < nl > + android : lines = " 1 " < nl > + android : singleLine = " true " < nl > + android : textColor = " # ffffff " < nl > + android : textSize = " 18sp " / > < nl > + < nl > + < FrameLayout < nl > + android : id = " @ + id / subtitleContainer " < nl > + android : layout _ width = " match _ parent " < nl > + android : layout _ height = " wrap _ content " < nl > + android : layout _ marginTop = " - 4dp " < nl > android : orientation = " horizontal " > < nl > < nl > - < ImageView < nl > - android : id = " @ + id / typingImage " < nl > - android : layout _ width = " wrap _ content " < nl > + < LinearLayout < nl > + android : id = " @ + id / typingContainer " < nl > + android : layout _ width = " match _ parent " < nl > android : layout _ height = " wrap _ content " < nl > - android : layout _ gravity = " center _ vertical " < nl > - android : layout _ marginTop = " 2dp " / > < nl > + android : orientation = " horizontal " > < nl > + < nl > + < ImageView < nl > + android : id = " @ + id / typingImage " < nl > + android : layout _ width = " wrap _ content " < nl > + android : layout _ height = " wrap _ content " < nl > + android : layout _ gravity = " center _ vertical " < nl > + android : layout _ marginTop = " 2dp " / > < nl > + < nl > + < TextView < nl > + android : id = " @ + id / typing " < nl > + android : layout _ width = " match _ parent " < nl > + android : layout _ height = " wrap _ content " < nl > + android : textColor = " # ffffff " < nl > + android : textSize = " 13sp " / > < nl > + < / LinearLayout > < nl > < nl > < TextView < nl > - android : id = " @ + id / typing " < nl > + android : id = " @ + id / subtitle " < nl > android : layout _ width = " match _ parent " < nl > android : layout _ height = " wrap _ content " < nl > android : textColor = " # ffffff " < nl > android : textSize = " 13sp " / > < nl > - < / LinearLayout > < nl > - < nl > - < TextView < nl > - android : id = " @ + id / subtitle " < nl > - android : layout _ width = " match _ parent " < nl > - android : layout _ height = " wrap _ content " < nl > - android : textColor = " # ffffff " < nl > - android : textSize = " 13sp " / > < nl > - < / FrameLayout > < nl > + < / FrameLayout > < nl > + < / LinearLayout > < nl > < / LinearLayout > < nl > < / LinearLayout > < nl > \ No newline at end of file

TEST DIFF:
diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / calls / CallFragment . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / calls / CallFragment . java 
 index 1c81113 . . 4cb5158 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / calls / CallFragment . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / calls / CallFragment . java 
 @ @ - 10 , 7 + 10 , 6 @ @ import android . content . Intent ; 
 import android . content . pm . PackageManager ; 
 import android . graphics . Color ; 
 import android . graphics . drawable . GradientDrawable ; 
 - import android . graphics . drawable . ShapeDrawable ; 
 import android . media . AudioManager ; 
 import android . media . Ringtone ; 
 import android . media . RingtoneManager ; 
 @ @ - 136 , 7 + 135 , 7 @ @ public class CallFragment extends BaseFragment { 
 for ( int i = 0 ; i < avatarLayers . length ; i + + ) { 
 View layer = avatarLayers [ i ] ; 
 ( ( GradientDrawable ) layer . getBackground ( ) ) . setColor ( Color . WHITE ) ; 
 - ( ( GradientDrawable ) layer . getBackground ( ) ) . setAlpha ( 150 ) ; 
 + ( ( GradientDrawable ) layer . getBackground ( ) ) . setAlpha ( 50 ) ; 
 } 
 
 answerContainer = cont . findViewById ( R . id . answer _ container ) ; 
 @ @ - 180 , 6 + 179 , 8 @ @ public class CallFragment extends BaseFragment { 
 bind ( nameTV , g . getName ( ) ) ; 
 } 
 
 + nameTV . setSelected ( true ) ; 
 + 
 / / 
 / / Members list 
 / / 
 @ @ - 234 , 19 + 235 , 13 @ @ public class CallFragment extends BaseFragment { 
 cont . findViewById ( R . id . speaker _ btn ) . setOnClickListener ( new View . OnClickListener ( ) { 
 @ Override 
 public void onClick ( View v ) { 
 - speakerOn = ! speakerOn ; 
 - audioManager . setSpeakerphoneOn ( speakerOn ) ; 
 - if ( speakerOn ) { 
 - speaker . setTint ( Color . WHITE ) ; 
 - speakerTV . setTextColor ( Color . WHITE ) ; 
 - } else { 
 - speaker . setTint ( getResources ( ) . getColor ( R . color . picker _ grey ) ) ; 
 - speakerTV . setTextColor ( getResources ( ) . getColor ( R . color . picker _ grey ) ) ; 
 - } 
 + toggleSpeaker ( speaker , speakerTV ) ; 
 } 
 } ) ; 
 + checkSpeaker ( speaker , speakerTV ) ; 
 
 final TintImageView muteCall = ( TintImageView ) cont . findViewById ( R . id . mute ) ; 
 + final TextView muteCallTv = ( TextView ) cont . findViewById ( R . id . mute _ tv ) ; 
 muteCall . setResource ( R . drawable . ic _ mic _ off _ white _ 24dp ) ; 
 cont . findViewById ( R . id . mute _ btn ) . setOnClickListener ( new View . OnClickListener ( ) { 
 @ Override 
 @ @ - 257 , 24 + 252 , 35 @ @ public class CallFragment extends BaseFragment { 
 
 final TintImageView video = ( TintImageView ) cont . findViewById ( R . id . video ) ; 
 video . setResource ( R . drawable . ic _ videocam _ white _ 24dp ) ; 
 + TextView videoTv = ( TextView ) cont . findViewById ( R . id . video _ tv ) ; 
 + videoTv . setTextColor ( getResources ( ) . getColor ( R . color . picker _ grey ) ) ; 
 + video . setTint ( getResources ( ) . getColor ( R . color . picker _ grey ) ) ; 
 
 final TintImageView back = ( TintImageView ) cont . findViewById ( R . id . back ) ; 
 back . setResource ( R . drawable . ic _ message _ white _ 24dp ) ; 
 + cont . findViewById ( R . id . back _ btn ) . setOnClickListener ( new View . OnClickListener ( ) { 
 + @ Override 
 + public void onClick ( View v ) { 
 + getActivity ( ) . onBackPressed ( ) ; 
 + } 
 + } ) ; 
 
 final TintImageView add = ( TintImageView ) cont . findViewById ( R . id . add ) ; 
 add . setResource ( R . drawable . ic _ person _ add _ white _ 24dp ) ; 
 - 
 + TextView addTv = ( TextView ) cont . findViewById ( R . id . add _ user _ tv ) ; 
 + addTv . setTextColor ( getResources ( ) . getColor ( R . color . picker _ grey ) ) ; 
 + add . setTint ( getResources ( ) . getColor ( R . color . picker _ grey ) ) ; 
 
 if ( call ! = null ) { 
 call . getIsMuted ( ) . subscribe ( new ValueChangedListener < Boolean > ( ) { 
 @ Override 
 public void onChanged ( Boolean val , Value < Boolean > valueModel ) { 
 if ( val ) { 
 - muteCall . setBackgroundResource ( R . drawable . call _ action _ background _ active ) ; 
 - muteCall . setTint ( Color . WHITE ) ; 
 + muteCallTv . setTextColor ( getResources ( ) . getColor ( R . color . picker _ grey ) ) ; 
 + muteCall . setTint ( getResources ( ) . getColor ( R . color . picker _ grey ) ) ; 
 } else { 
 - muteCall . setBackgroundResource ( R . drawable . call _ action _ background ) ; 
 - muteCall . setTint ( getResources ( ) . getColor ( R . color . primary ) ) ; 
 + muteCallTv . setTextColor ( Color . WHITE ) ; 
 + muteCall . setTint ( Color . WHITE ) ; 
 } 
 } 
 } ) ; 
 @ @ - 323 , 6 + 329 , 22 @ @ public class CallFragment extends BaseFragment { 
 return cont ; 
 } 
 
 + public void toggleSpeaker ( TintImageView speaker , TextView speakerTV ) { 
 + speakerOn = ! speakerOn ; 
 + audioManager . setSpeakerphoneOn ( speakerOn ) ; 
 + checkSpeaker ( speaker , speakerTV ) ; 
 + } 
 + 
 + public void checkSpeaker ( TintImageView speaker , TextView speakerTV ) { 
 + if ( speakerOn ) { 
 + speaker . setTint ( Color . WHITE ) ; 
 + speakerTV . setTextColor ( Color . WHITE ) ; 
 + } else { 
 + speaker . setTint ( getResources ( ) . getColor ( R . color . picker _ grey ) ) ; 
 + speakerTV . setTextColor ( getResources ( ) . getColor ( R . color . picker _ grey ) ) ; 
 + } 
 + } 
 + 
 public void switchAvatarMembers ( ) { 
 if ( peer . getPeerType ( ) = = PeerType . GROUP ) { 
 if ( avatarView . getVisibility ( ) = = View . VISIBLE ) { 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / fragment _ call . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / fragment _ call . xml 
 index d295f55 . . 7cd8351 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / fragment _ call . xml 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / fragment _ call . xml 
 @ @ - 4 , 7 + 4 , 6 @ @ 
 android : layout _ width = " match _ parent " 
 android : layout _ height = " match _ parent " > 
 
 - 
 < LinearLayout 
 android : layout _ width = " match _ parent " 
 android : layout _ height = " match _ parent " 
 @ @ - 14 , 14 + 13 , 14 @ @ 
 
 < TextView 
 android : id = " @ + id / status " 
 - android : layout _ marginTop = " 40dp " 
 + android : layout _ marginTop = " 37 . 5dp " 
 android : layout _ gravity = " center " 
 android : gravity = " center " 
 android : layout _ width = " wrap _ content " 
 android : layout _ height = " wrap _ content " 
 - android : textSize = " 20sp " 
 - android : textColor = " @ android : color / white " 
 - android : text = " Ringing . . . " / > 
 + android : textSize = " 17 . 3sp " 
 + android : fontFamily = " sans - serif - light " 
 + android : textColor = " @ android : color / white " / > 
 
 < RelativeLayout 
 
 @ @ - 71 , 7 + 70 , 6 @ @ 
 android : layout _ centerHorizontal = " true " 
 android : background = " @ drawable / call _ avatar _ background " / > 
 
 - 
 < im . actor . sdk . view . avatar . AvatarView 
 android : id = " @ + id / avatar " 
 android : layout _ width = " 100dp " 
 @ @ - 79 , 8 + 77 , 6 @ @ 
 android : layout _ centerVertical = " true " 
 android : layout _ centerHorizontal = " true " / > 
 
 - 
 - 
 < ListView 
 android : paddingLeft = " 20dp " 
 android : paddingRight = " 20dp " 
 @ @ - 94 , 21 + 90 , 22 @ @ 
 < TextView 
 android : textColor = " @ android : color / white " 
 android : paddingTop = " 5dp " 
 + android : paddingLeft = " 5dp " 
 + android : paddingRight = " 5dp " 
 android : gravity = " center _ horizontal | bottom " 
 - 
 - android : fontFamily = " sans - serif - thin " 
 + android : ellipsize = " marquee " 
 + android : scrollHorizontally = " true " 
 + android : marqueeRepeatLimit = " marquee _ forever " 
 + android : fontFamily = " sans - serif - light " 
 android : id = " @ + id / name " 
 android : layout _ width = " wrap _ content " 
 android : layout _ height = " wrap _ content " 
 + android : singleLine = " true " 
 android : lines = " 1 " 
 - android : textSize = " 32sp " 
 + android : textSize = " 30sp " 
 android : layout _ below = " @ + id / layer4 " 
 android : layout _ centerHorizontal = " true " / > 
 
 - 
 - 
 - 
 - 
 < / RelativeLayout > 
 
 < FrameLayout 
 @ @ - 138 , 14 + 135 , 15 @ @ 
 android : layout _ width = " 60dp " 
 android : layout _ height = " 60dp " 
 android : src = " @ drawable / ic _ call _ end _ white _ 36dp " 
 - android : background = " @ drawable / end _ call _ background " 
 - / > 
 + android : background = " @ drawable / end _ call _ background " / > 
 + 
 < / FrameLayout > 
 
 < FrameLayout 
 android : layout _ width = " 0dp " 
 android : layout _ weight = " 1 " 
 android : layout _ height = " 60dp " > 
 + 
 < ImageButton 
 android : layout _ gravity = " center " 
 android : id = " @ + id / answer " 
 @ @ - 159 , 26 + 157 , 33 @ @ 
 < / LinearLayout > 
 
 < TableLayout 
 - android : layout _ width = " match _ parent " 
 - android : layout _ height = " match _ parent " 
 + android : paddingBottom = " 15dp " 
 + android : paddingLeft = " 10dp " 
 + android : paddingRight = " 10dp " 
 + android : layout _ gravity = " bottom | center _ horizontal " 
 + android : layout _ width = " wrap _ content " 
 + android : layout _ height = " wrap _ content " 
 android : stretchColumns = " * " > 
 + 
 < TableRow 
 + android : minHeight = " 110dp " 
 android : layout _ weight = " 1 " 
 android : gravity = " center " > 
 + 
 < LinearLayout 
 android : id = " @ + id / mute _ btn " 
 android : orientation = " vertical " 
 android : layout _ weight = " 1 " 
 android : layout _ width = " 0dp " 
 android : layout _ height = " wrap _ content " > 
 + 
 < im . actor . sdk . view . TintImageView 
 android : id = " @ + id / mute " 
 android : layout _ gravity = " center _ horizontal " 
 android : layout _ height = " @ dimen / call _ btn _ size " 
 android : scaleType = " centerInside " 
 - android : layout _ width = " @ dimen / call _ btn _ size " 
 - 
 - / > 
 + android : layout _ width = " @ dimen / call _ btn _ size " / > 
 + 
 < TextView 
 android : id = " @ + id / mute _ tv " 
 android : layout _ gravity = " center " 
 @ @ - 195 , 14 + 200 , 14 @ @ 
 android : layout _ weight = " 1 " 
 android : layout _ width = " 0dp " 
 android : layout _ height = " wrap _ content " > 
 + 
 < im . actor . sdk . view . TintImageView 
 android : id = " @ + id / speaker " 
 android : layout _ gravity = " center _ horizontal " 
 android : layout _ height = " @ dimen / call _ btn _ size " 
 android : scaleType = " centerInside " 
 - android : layout _ width = " @ dimen / call _ btn _ size " 
 - 
 - / > 
 + android : layout _ width = " @ dimen / call _ btn _ size " / > 
 + 
 < TextView 
 android : id = " @ + id / speaker _ tv " 
 android : layout _ gravity = " center " 
 @ @ - 219 , 14 + 224 , 14 @ @ 
 android : layout _ weight = " 1 " 
 android : layout _ width = " 0dp " 
 android : layout _ height = " wrap _ content " > 
 + 
 < im . actor . sdk . view . TintImageView 
 android : id = " @ + id / video " 
 android : layout _ gravity = " center _ horizontal " 
 android : layout _ height = " @ dimen / call _ btn _ size " 
 android : scaleType = " centerInside " 
 - android : layout _ width = " @ dimen / call _ btn _ size " 
 - 
 - / > 
 + android : layout _ width = " @ dimen / call _ btn _ size " / > 
 + 
 < TextView 
 android : id = " @ + id / video _ tv " 
 android : layout _ gravity = " center " 
 @ @ - 234 , 12 + 239 , 14 @ @ 
 android : text = " video " 
 android : gravity = " center " 
 android : layout _ width = " wrap _ content " 
 - android : layout _ height = " wrap _ content " / > 
 + android : layout _ height = " wrap _ content " / > 
 + 
 < / LinearLayout > 
 
 < / TableRow > 
 
 < TableRow 
 + android : minHeight = " 110dp " 
 android : layout _ weight = " 1 " 
 android : gravity = " center " > 
 
 @ @ - 249 , 14 + 256 , 14 @ @ 
 android : layout _ weight = " 1 " 
 android : layout _ width = " 0dp " 
 android : layout _ height = " wrap _ content " > 
 + 
 < im . actor . sdk . view . TintImageView 
 android : id = " @ + id / back " 
 android : layout _ gravity = " center _ horizontal " 
 android : layout _ height = " @ dimen / call _ btn _ size " 
 android : scaleType = " centerInside " 
 - android : layout _ width = " @ dimen / call _ btn _ size " 
 - 
 - / > 
 + android : layout _ width = " @ dimen / call _ btn _ size " / > 
 + 
 < TextView 
 android : id = " @ + id / back _ tv " 
 android : layout _ gravity = " center " 
 @ @ - 265 , 12 + 272 , 14 @ @ 
 android : gravity = " center " 
 android : layout _ width = " wrap _ content " 
 android : layout _ height = " wrap _ content " / > 
 + 
 < / LinearLayout > 
 
 < FrameLayout 
 android : layout _ weight = " 1 " 
 android : layout _ width = " 0dp " 
 android : layout _ height = " wrap _ content " > 
 + 
 < ImageButton 
 android : layout _ gravity = " center " 
 android : visibility = " visible " 
 @ @ - 287 , 14 + 296 , 14 @ @ 
 android : layout _ weight = " 1 " 
 android : layout _ width = " 0dp " 
 android : layout _ height = " wrap _ content " > 
 + 
 < im . actor . sdk . view . TintImageView 
 android : id = " @ + id / add " 
 android : layout _ gravity = " center _ horizontal " 
 android : layout _ height = " @ dimen / call _ btn _ size " 
 android : scaleType = " centerInside " 
 - android : layout _ width = " @ dimen / call _ btn _ size " 
 - 
 - / > 
 + android : layout _ width = " @ dimen / call _ btn _ size " / > 
 + 
 < TextView 
 android : id = " @ + id / add _ user _ tv " 
 android : layout _ gravity = " center " 
 @ @ - 305 , 17 + 314 , 12 @ @ 
 android : layout _ height = " wrap _ content " / > 
 < / LinearLayout > 
 
 - 
 < / TableRow > 
 - < / TableLayout > 
 - 
 - 
 - 
 
 + < / TableLayout > 
 
 < / FrameLayout > 
 
 < / LinearLayout > 
 
 - 
 < / FrameLayout >

NEAREST DIFF:
diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / activity / BaseActivity . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / activity / BaseActivity . java 
 index 0379117 . . e40b240 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / activity / BaseActivity . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / activity / BaseActivity . java 
 @ @ - 5 , 6 + 5 , 7 @ @ import android . graphics . drawable . ColorDrawable ; 
 import android . os . Bundle ; 
 import android . support . v7 . app . ActionBar ; 
 import android . support . v7 . app . AppCompatActivity ; 
 + import android . support . v7 . widget . Toolbar ; 
 import android . view . View ; 
 import android . widget . TextView ; 
 
 @ @ - 71 , 6 + 72 , 10 @ @ public class BaseActivity extends AppCompatActivity { 
 BINDER . bind ( textView , titleContainer , value ) ; 
 } 
 
 + public void bindGlobalCounter ( ValueChangedListener < Integer > callback ) { 
 + BINDER . bindGlobalCounter ( callback ) ; 
 + } 
 + 
 public void bindGroupTyping ( final TextView textView , final View container , final View titleContainer , final Value < int [ ] > typing ) { 
 BINDER . bindGroupTyping ( textView , container , titleContainer , typing ) ; 
 } 
 @ @ - 131 , 12 + 136 , 17 @ @ public class BaseActivity extends AppCompatActivity { 
 protected void setToolbar ( View view , ActionBar . LayoutParams params , boolean enableBack ) { 
 getSupportActionBar ( ) . setDisplayShowCustomEnabled ( true ) ; 
 getSupportActionBar ( ) . setDisplayHomeAsUpEnabled ( true ) ; 
 - if ( enableBack ) { 
 - getSupportActionBar ( ) . setDisplayShowHomeEnabled ( true ) ; 
 - } 
 getSupportActionBar ( ) . setDisplayShowTitleEnabled ( false ) ; 
 getSupportActionBar ( ) . setDisplayUseLogoEnabled ( false ) ; 
 getSupportActionBar ( ) . setCustomView ( view , params ) ; 
 + if ( enableBack ) { 
 + getSupportActionBar ( ) . setDisplayShowHomeEnabled ( true ) ; 
 + } else { 
 + getSupportActionBar ( ) . setDisplayShowHomeEnabled ( false ) ; 
 + getSupportActionBar ( ) . setDisplayHomeAsUpEnabled ( false ) ; 
 + Toolbar parent = ( Toolbar ) view . getParent ( ) ; 
 + parent . setContentInsetsAbsolute ( 0 , 0 ) ; 
 + } 
 } 
 
 protected void setToolbar ( View view , ActionBar . LayoutParams params ) { 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java 
 index f4bb580 . . df168be 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / conversation / ChatActivity . java 
 @ @ - 10 , 6 + 10 , 7 @ @ import android . content . pm . ApplicationInfo ; 
 import android . content . pm . PackageManager ; 
 import android . content . res . Configuration ; 
 import android . database . Cursor ; 
 + import android . graphics . PorterDuff ; 
 import android . net . Uri ; 
 import android . os . Bundle ; 
 import android . provider . ContactsContract ; 
 @ @ - 27 , 6 + 28 , 8 @ @ import android . view . Menu ; 
 import android . view . MenuItem ; 
 import android . view . MotionEvent ; 
 import android . view . View ; 
 + import android . view . ViewGroup ; 
 + import android . view . ViewParent ; 
 import android . view . animation . AlphaAnimation ; 
 import android . view . animation . TranslateAnimation ; 
 import android . widget . AdapterView ; 
 @ @ - 55 , 6 + 58 , 7 @ @ import im . actor . runtime . actors . ActorSystem ; 
 import im . actor . runtime . actors . Props ; 
 import im . actor . runtime . actors . messages . PoisonPill ; 
 import im . actor . sdk . ActorSDK ; 
 + import im . actor . sdk . ActorStyle ; 
 import im . actor . sdk . R ; 
 import im . actor . sdk . controllers . Intents ; 
 import im . actor . sdk . controllers . conversation . mentions . MentionsAdapter ; 
 @ @ - 74 , 6 + 78 , 7 @ @ import im . actor . runtime . mvvm . ValueChangedListener ; 
 import static im . actor . sdk . util . ViewUtils . expand ; 
 import static im . actor . sdk . util . ViewUtils . expandMentions ; 
 import static im . actor . sdk . util . ViewUtils . goneView ; 
 + import static im . actor . sdk . util . ViewUtils . hideView ; 
 import static im . actor . sdk . util . ViewUtils . showView ; 
 import static im . actor . sdk . util . ViewUtils . zoomInView ; 
 import static im . actor . sdk . util . ViewUtils . zoomOutView ; 
 @ @ - 113 , 6 + 118 , 8 @ @ public class ChatActivity extends ActorEditTextActivity { 
 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / 
 / / Toolbar views 
 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / 
 + / / Toolbar unread counter 
 + private TextView counter ; 
 / / Toolbar Avatar view 
 private AvatarView barAvatar ; 
 / / Toolbar title view 
 @ @ - 414 , 10 + 421 , 22 @ @ public class ChatActivity extends ActorEditTextActivity { 
 protected void onCreateToolbar ( ) { 
 / / Loading Toolbar header views 
 / / Binding to real data is performed in onResume method 
 + ActorStyle style = ActorSDK . sharedActor ( ) . style ; 
 barView = LayoutInflater . from ( this ) . inflate ( R . layout . bar _ conversation , null ) ; 
 ActionBar . LayoutParams layout = new ActionBar . LayoutParams ( ActionBar . LayoutParams . MATCH _ PARENT , ActionBar . LayoutParams . MATCH _ PARENT ) ; 
 - setToolbar ( barView , layout ) ; 
 + setToolbar ( barView , layout , false ) ; 
 + findViewById ( R . id . home ) . setOnClickListener ( new View . OnClickListener ( ) { 
 + @ Override 
 + public void onClick ( View v ) { 
 + onBackPressed ( ) ; 
 + } 
 + } ) ; 
 + 
 + counter = ( TextView ) barView . findViewById ( R . id . counter ) ; 
 
 + counter . setTextColor ( style . getDialogsCounterTextColor ( ) ) ; 
 + counter . setBackgroundResource ( R . drawable . ic _ counter _ circle ) ; 
 + counter . getBackground ( ) . setColorFilter ( style . getDialogsCounterBackgroundColor ( ) , PorterDuff . Mode . MULTIPLY ) ; 
 barTitle = ( TextView ) barView . findViewById ( R . id . title ) ; 
 barSubtitleContainer = barView . findViewById ( R . id . subtitleContainer ) ; 
 barTypingIcon = ( ImageView ) barView . findViewById ( R . id . typingImage ) ; 
 @ @ - 615 , 6 + 634 , 18 @ @ public class ChatActivity extends ActorEditTextActivity { 
 } 
 } ) ; 
 } 
 + 
 + bindGlobalCounter ( new ValueChangedListener < Integer > ( ) { 
 + @ Override 
 + public void onChanged ( Integer val , Value < Integer > valueModel ) { 
 + if ( val > 0 ) { 
 + counter . setText ( Integer . toString ( val ) ) ; 
 + showView ( counter ) ; 
 + } else { 
 + hideView ( counter ) ; 
 + } 
 + } 
 + } ) ; 
 } 
 
 @ Override 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / ActorBinder . java b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / ActorBinder . java 
 index de76ed5 . . ba8f1cb 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / ActorBinder . java 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / java / im / actor / sdk / controllers / fragment / ActorBinder . java 
 @ @ - 41 , 6 + 41 , 10 @ @ public class ActorBinder { 
 
 } 
 
 + public void bindGlobalCounter ( ValueChangedListener < Integer > callback ) { 
 + callback . onChanged ( messenger ( ) . getAppState ( ) . getGlobalCounter ( ) . get ( ) , messenger ( ) . getAppState ( ) . getGlobalCounter ( ) ) ; 
 + bind ( messenger ( ) . getAppState ( ) . getGlobalCounter ( ) , callback ) ; 
 + } 
 
 public void bindGroupTyping ( final TextView textView , final View container , final View titleContainer , final Value < int [ ] > typing ) { 
 bind ( typing , new ValueChangedListener < int [ ] > ( ) { 
 diff - - git a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / bar _ conversation . xml b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / bar _ conversation . xml 
 index c284f10 . . 1e5fe62 100644 
 - - - a / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / bar _ conversation . xml 
 + + + b / actor - sdk / sdk - core - android / android - sdk / src / main / res / layout / bar _ conversation . xml 
 @ @ - 5 , 71 + 5 , 105 @ @ 
 - - > 
 
 < LinearLayout xmlns : android = " http : / / schemas . android . com / apk / res / android " 
 - android : id = " @ + id / titleContainer " 
 android : layout _ width = " match _ parent " 
 - android : layout _ height = " match _ parent " 
 - android : background = " @ drawable / selector _ light " > 
 + android : layout _ height = " match _ parent " > 
 
 - < im . actor . sdk . view . avatar . AvatarView 
 - android : id = " @ + id / avatarPreview " 
 - android : layout _ width = " 32dp " 
 - android : layout _ height = " 32dp " 
 - android : layout _ gravity = " center _ vertical " 
 - android : layout _ marginLeft = " 8dp " / > 
 + < FrameLayout 
 + android : id = " @ + id / home " 
 + android : background = " @ drawable / selector _ light " 
 + android : layout _ width = " ? attr / actionBarSize " 
 + android : layout _ height = " match _ parent " > 
 
 - < LinearLayout 
 - android : layout _ width = " 0dp " 
 - android : layout _ height = " match _ parent " 
 - android : layout _ weight = " 1 " 
 - android : gravity = " center _ vertical " 
 - android : orientation = " vertical " 
 - android : paddingLeft = " 8dp " > 
 + < ImageView 
 + 
 + android : layout _ width = " wrap _ content " 
 + android : layout _ height = " match _ parent " 
 + android : src = " @ drawable / ic _ action _ navigation _ arrow _ back " 
 + android : scaleType = " center " 
 + android : layout _ gravity = " center _ vertical | center _ horizontal " / > 
 
 < TextView 
 - android : id = " @ + id / title " 
 - android : layout _ width = " match _ parent " 
 + android : layout _ marginTop = " 10dp " 
 + android : layout _ marginRight = " 10dp " 
 + android : layout _ gravity = " top | right " 
 + android : id = " @ + id / counter " 
 + android : layout _ width = " wrap _ content " 
 android : layout _ height = " wrap _ content " 
 - android : layout _ marginTop = " - 2dp " 
 - android : ellipsize = " end " 
 - android : lines = " 1 " 
 - android : singleLine = " true " 
 - android : textColor = " # ffffff " 
 - android : textSize = " 18sp " / > 
 - 
 - < FrameLayout 
 - android : id = " @ + id / subtitleContainer " 
 - android : layout _ width = " match _ parent " 
 - android : layout _ height = " wrap _ content " 
 - android : layout _ marginTop = " - 4dp " 
 - android : orientation = " horizontal " > 
 + android : paddingLeft = " 4dp " 
 + android : paddingRight = " 4dp " 
 + android : gravity = " center " 
 + android : textSize = " 12sp " 
 + android : visibility = " invisible " / > 
 + 
 + < / FrameLayout > 
 + 
 + < LinearLayout 
 + android : id = " @ + id / titleContainer " 
 + android : layout _ width = " match _ parent " 
 + android : layout _ height = " match _ parent " 
 + android : background = " @ drawable / selector _ light " > 
 + 
 + < im . actor . sdk . view . avatar . AvatarView 
 + android : id = " @ + id / avatarPreview " 
 + android : layout _ width = " 32dp " 
 + android : layout _ height = " 32dp " 
 + android : layout _ gravity = " center _ vertical " 
 + android : layout _ marginLeft = " 8dp " / > 
 
 - < LinearLayout 
 - android : id = " @ + id / typingContainer " 
 + < LinearLayout 
 + android : layout _ width = " 0dp " 
 + android : layout _ height = " match _ parent " 
 + android : layout _ weight = " 1 " 
 + android : gravity = " center _ vertical " 
 + android : orientation = " vertical " 
 + android : paddingLeft = " 8dp " > 
 + 
 + < TextView 
 + android : id = " @ + id / title " 
 android : layout _ width = " match _ parent " 
 android : layout _ height = " wrap _ content " 
 + android : layout _ marginTop = " - 2dp " 
 + android : ellipsize = " end " 
 + android : lines = " 1 " 
 + android : singleLine = " true " 
 + android : textColor = " # ffffff " 
 + android : textSize = " 18sp " / > 
 + 
 + < FrameLayout 
 + android : id = " @ + id / subtitleContainer " 
 + android : layout _ width = " match _ parent " 
 + android : layout _ height = " wrap _ content " 
 + android : layout _ marginTop = " - 4dp " 
 android : orientation = " horizontal " > 
 
 - < ImageView 
 - android : id = " @ + id / typingImage " 
 - android : layout _ width = " wrap _ content " 
 + < LinearLayout 
 + android : id = " @ + id / typingContainer " 
 + android : layout _ width = " match _ parent " 
 android : layout _ height = " wrap _ content " 
 - android : layout _ gravity = " center _ vertical " 
 - android : layout _ marginTop = " 2dp " / > 
 + android : orientation = " horizontal " > 
 + 
 + < ImageView 
 + android : id = " @ + id / typingImage " 
 + android : layout _ width = " wrap _ content " 
 + android : layout _ height = " wrap _ content " 
 + android : layout _ gravity = " center _ vertical " 
 + android : layout _ marginTop = " 2dp " / > 
 + 
 + < TextView 
 + android : id = " @ + id / typing " 
 + android : layout _ width = " match _ parent " 
 + android : layout _ height = " wrap _ content " 
 + android : textColor = " # ffffff " 
 + android : textSize = " 13sp " / > 
 + < / LinearLayout > 
 
 < TextView 
 - android : id = " @ + id / typing " 
 + android : id = " @ + id / subtitle " 
 android : layout _ width = " match _ parent " 
 android : layout _ height = " wrap _ content " 
 android : textColor = " # ffffff " 
 android : textSize = " 13sp " / > 
 - < / LinearLayout > 
 - 
 - < TextView 
 - android : id = " @ + id / subtitle " 
 - android : layout _ width = " match _ parent " 
 - android : layout _ height = " wrap _ content " 
 - android : textColor = " # ffffff " 
 - android : textSize = " 13sp " / > 
 - < / FrameLayout > 
 + < / FrameLayout > 
 + < / LinearLayout > 
 < / LinearLayout > 
 < / LinearLayout > 
 \ No newline at end of file
