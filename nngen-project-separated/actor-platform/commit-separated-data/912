BLEU SCORE: 0.23462350320528

TEST MSG: wip ( core ) : Working on Call Master event bus
GENERATED MSG: feat ( core ) : Ability to disable phone book import

TEST DIFF (one line): diff - - git a / actor - sdk / sdk - api / actor . json b / actor - sdk / sdk - api / actor . json < nl > index dd57b91 . . 21881e7 100644 < nl > - - - a / actor - sdk / sdk - api / actor . json < nl > + + + b / actor - sdk / sdk - api / actor . json < nl > @ @ - 11849 , 7 + 11849 , 7 @ @ < nl > { < nl > " type " : " reference " , < nl > " argument " : " timeout " , < nl > - " category " : " hidden " , < nl > + " category " : " full " , < nl > " description " : " Join timeout " < nl > } < nl > ] , < nl > @ @ - 11896 , 7 + 11896 , 7 @ @ < nl > { < nl > " type " : " reference " , < nl > " argument " : " timeout " , < nl > - " category " : " hidden " , < nl > + " category " : " full " , < nl > " description " : " Optional timeout for keep alive " < nl > } < nl > ] , < nl > @ @ - 12437 , 6 + 12437 , 12 @ @ < nl > " argument " : " peer " , < nl > " category " : " full " , < nl > " description " : " destination peer " < nl > + } , < nl > + { < nl > + " type " : " reference " , < nl > + " argument " : " eventBusId " , < nl > + " category " : " full " , < nl > + " description " : " Call Event Bus Id " < nl > } < nl > ] , < nl > " attributes " : [ < nl > diff - - git a / actor - sdk / sdk - api / api - language / solutions / im . actor . api / models / im / actor / api / scheme . mps b / actor - sdk / sdk - api / api - language / solutions / im . actor . api / models / im / actor / api / scheme . mps < nl > index 9162f96 . . ce7385b 100644 < nl > - - - a / actor - sdk / sdk - api / api - language / solutions / im . actor . api / models / im / actor / api / scheme . mps < nl > + + + b / actor - sdk / sdk - api / api - language / solutions / im . actor . api / models / im / actor / api / scheme . mps < nl > @ @ - 10245 , 6 + 10245 , 7 @ @ < nl > < / node > < nl > < node concept = " NX1gA " id = " 3Tolai5ML1M " role = " 1GBnQ6 " > < nl > < property role = " NX6R2 " value = " Join timeout " / > < nl > + < property role = " 1GSvIU " value = " full " / > < nl > < ref role = " NX6Kv " node = " 3Tolai5M $ P3 " resolve = " timeout " / > < nl > < / node > < nl > < / node > < nl > @ @ - 10282 , 6 + 10283 , 7 @ @ < nl > < / node > < nl > < node concept = " NX1gA " id = " 3Tolai5MM2b " role = " 1GBnQ6 " > < nl > < property role = " NX6R2 " value = " Optional timeout for keep alive " / > < nl > + < property role = " 1GSvIU " value = " full " / > < nl > < ref role = " NX6Kv " node = " 3Tolai5M _ Py " resolve = " timeout " / > < nl > < / node > < nl > < / node > < nl > @ @ - 10724 , 6 + 10726 , 11 @ @ < nl > < property role = " 1GSvIU " value = " full " / > < nl > < ref role = " NX6Kv " node = " 201xLeQvfRW " resolve = " peer " / > < nl > < / node > < nl > + < node concept = " NX1gA " id = " 3Tolai5O2bn " role = " 1GBnQ6 " > < nl > + < property role = " NX6R2 " value = " Call Event Bus Id " / > < nl > + < property role = " 1GSvIU " value = " full " / > < nl > + < ref role = " NX6Kv " node = " 3Tolai5Np _ j " resolve = " eventBusId " / > < nl > + < / node > < nl > < / node > < nl > < node concept = " w93zz " id = " 3Tolai5NMKi " role = " 2m5mJr " > < nl > < property role = " TrG5h " value = " WebRTCSignaling " / > < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / api / rpc / RequestDoCall . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / api / rpc / RequestDoCall . java < nl > index f21285f . . ef7ebcf 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / api / rpc / RequestDoCall . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / api / rpc / RequestDoCall . java < nl > @ @ - 66 , 6 + 66 , 7 @ @ public class RequestDoCall extends Request < ResponseDoCall > { < nl > public String toString ( ) { < nl > String res = " rpc DoCall { " ; < nl > res + = " peer = " + this . peer ; < nl > + res + = " , eventBusId = " + this . eventBusId ; < nl > res + = " } " ; < nl > return res ; < nl > } < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / api / rpc / RequestJoinEventBus . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / api / rpc / RequestJoinEventBus . java < nl > index 985d3c9 . . c6d4ce6 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / api / rpc / RequestJoinEventBus . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / api / rpc / RequestJoinEventBus . java < nl > @ @ - 65 , 6 + 65 , 7 @ @ public class RequestJoinEventBus extends Request < ResponseJoinEventBus > { < nl > public String toString ( ) { < nl > String res = " rpc JoinEventBus { " ; < nl > res + = " id = " + this . id ; < nl > + res + = " , timeout = " + this . timeout ; < nl > res + = " } " ; < nl > return res ; < nl > } < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / api / rpc / RequestKeepAliveEventBus . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / api / rpc / RequestKeepAliveEventBus . java < nl > index 7d21fea . . c34ee52 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / api / rpc / RequestKeepAliveEventBus . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / api / rpc / RequestKeepAliveEventBus . java < nl > @ @ - 65 , 6 + 65 , 7 @ @ public class RequestKeepAliveEventBus extends Request < ResponseVoid > { < nl > public String toString ( ) { < nl > String res = " rpc KeepAliveEventBus { " ; < nl > res + = " id = " + this . id ; < nl > + res + = " , timeout = " + this . timeout ; < nl > res + = " } " ; < nl > return res ; < nl > } < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / calls / CallManagerActor . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / calls / CallManagerActor . java < nl > index a19566e . . d7f1c8a 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / calls / CallManagerActor . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / calls / CallManagerActor . java < nl > @ @ - 67 , 11 + 67 , 11 @ @ public class CallManagerActor extends ModuleActor { < nl > / / Starting call < nl > / / < nl > < nl > - private void doCall ( Peer peer ) { < nl > + private void doCall ( final Peer peer ) { < nl > system ( ) . actorOf ( " actor / ? ? " , new ActorCreator ( ) { < nl > @ Override < nl > public Actor create ( ) { < nl > - return new CallMasterActor ( context ( ) ) ; < nl > + return new CallMasterActor ( peer , context ( ) ) ; < nl > } < nl > } ) ; < nl > } < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / calls / CallMasterActor . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / calls / CallMasterActor . java < nl > index c637b88 . . 96664f7 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / calls / CallMasterActor . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / calls / CallMasterActor . java < nl > @ @ - 1 , 13 + 1 , 82 @ @ < nl > package im . actor . core . modules . calls ; < nl > < nl > + import org . jetbrains . annotations . Nullable ; < nl > + < nl > + import java . io . IOException ; < nl > + < nl > + import im . actor . core . api . ApiWebRTCSignaling ; < nl > + import im . actor . core . api . rpc . RequestDoCall ; < nl > + import im . actor . core . api . rpc . ResponseDoCall ; < nl > + import im . actor . core . entity . Peer ; < nl > import im . actor . core . modules . ModuleContext ; < nl > import im . actor . core . modules . eventbus . EventBusActor ; < nl > + import im . actor . runtime . Log ; < nl > + import im . actor . runtime . function . Consumer ; < nl > < nl > public class CallMasterActor extends EventBusActor { < nl > < nl > - public CallMasterActor ( ModuleContext context ) { < nl > + private static final String TAG = " CallMasterActor " ; < nl > + < nl > + private final Peer peer ; < nl > + < nl > + public CallMasterActor ( Peer peer , ModuleContext context ) { < nl > super ( context ) ; < nl > + this . peer = peer ; < nl > } < nl > < nl > + @ Override < nl > + public void onBusCreated ( ) { < nl > + Log . d ( TAG , " onBusCreated " ) ; < nl > + api ( new RequestDoCall ( buidOutPeer ( peer ) , getBusId ( ) ) ) . then ( new Consumer < ResponseDoCall > ( ) { < nl > + @ Override < nl > + public void apply ( ResponseDoCall responseDoCall ) { < nl > + Log . d ( TAG , " onBusCreated : result " ) ; < nl > + } < nl > + } ) . failure ( new Consumer < Exception > ( ) { < nl > + @ Override < nl > + public void apply ( Exception e ) { < nl > + Log . d ( TAG , " onBusCreated : error " ) ; < nl > + dispose ( ) ; < nl > + } < nl > + } ) . done ( self ( ) ) ; < nl > + } < nl > + < nl > + @ Override < nl > + public void onDeviceConnected ( int uid , long deviceId ) { < nl > + Log . d ( TAG , " onDeviceConnected " ) ; < nl > + } < nl > + < nl > + @ Override < nl > + public void onDeviceDisconnected ( int uid , long deviceId ) { < nl > + Log . d ( TAG , " onDeviceDisconnected " ) ; < nl > + } < nl > < nl > - } < nl > + @ Override < nl > + public void onMessageReceived ( @ Nullable Integer senderId , @ Nullable Long senderDeviceId , byte [ ] data ) { < nl > + ApiWebRTCSignaling signaling ; < nl > + try { < nl > + signaling = ApiWebRTCSignaling . fromBytes ( data ) ; < nl > + } catch ( IOException e ) { < nl > + e . printStackTrace ( ) ; < nl > + Log . d ( TAG , " onMessageReceived : ignoring " ) ; < nl > + return ; < nl > + } < nl > + < nl > + Log . d ( TAG , " onMessageReceived : " + signaling ) ; < nl > + } < nl > + < nl > + @ Override < nl > + public void onBusShutdown ( ) { < nl > + Log . d ( TAG , " onBusShutdown " ) ; < nl > + } < nl > + < nl > + @ Override < nl > + public void onBusDisposed ( ) { < nl > + Log . d ( TAG , " onBusDisposed " ) ; < nl > + } < nl > + < nl > + @ Override < nl > + public void onBusStopped ( ) { < nl > + Log . d ( TAG , " onBusStopped " ) ; < nl > + } < nl > + } < nl > \ No newline at end of file < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / eventbus / EventBusActor . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / eventbus / EventBusActor . java < nl > index 93b769c . . 65bf90e 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / eventbus / EventBusActor . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / eventbus / EventBusActor . java < nl > @ @ - 17 , 7 + 17 , 7 @ @ import im . actor . runtime . function . Consumer ; < nl > < nl > public class EventBusActor extends ModuleActor { < nl > < nl > - private static final long TIMEOUT = 15000 ; < nl > + private static final long TIMEOUT = 10000 ; < nl > private static final long KEEP _ ALIVE = 5000 ; < nl > < nl > private boolean isProcessing ;
NEAREST DIFF (one line): diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDK . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDK . swift < nl > index 01a0edb . . 63f9dd8 100644 < nl > - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDK . swift < nl > + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDK . swift < nl > @ @ - 72 , 6 + 72 , 9 @ @ public class ActorSDK { < nl > / / / Push token registration id . Required for sending push tokens < nl > public var apiPushId : Int ? = nil < nl > < nl > + / / / Enable phone book import < nl > + public var enablePhoneBookImport = true < nl > + < nl > / / / Invitation URL for apps < nl > public var inviteUrl : String = " https : / / actor . im / dl " < nl > < nl > @ @ - 198 , 6 + 201 , 9 @ @ public class ActorSDK { < nl > builder . setCustomAppName ( AALocalized ( appNameInLocStrings ) ) < nl > } < nl > < nl > + / / Config < nl > + builder . setPhoneBookImportEnabled ( jboolean ( enablePhoneBookImport ) ) < nl > + < nl > / / Creating messenger < nl > messenger = ACCocoaMessenger ( configuration : builder . build ( ) ) < nl > < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Configuration . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Configuration . java < nl > index bf0da53 . . 1d73500 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Configuration . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Configuration . java < nl > @ @ - 43 , 6 + 43 , 8 @ @ public class Configuration { < nl > < nl > private String customAppName ; < nl > < nl > + private boolean enablePhoneBookImport ; < nl > + < nl > Configuration ( ConnectionEndpoint [ ] endpoints , < nl > PhoneBookProvider phoneBookProvider , < nl > NotificationProvider notificationProvider , < nl > @ @ - 59 , 7 + 61 , 8 @ @ public class Configuration { < nl > String timeZone , < nl > String [ ] preferredLanguages , < nl > String customAppName , < nl > - TrustedKey [ ] trustedKeys ) { < nl > + TrustedKey [ ] trustedKeys , < nl > + boolean enablePhoneBookImport ) { < nl > this . endpoints = endpoints ; < nl > this . phoneBookProvider = phoneBookProvider ; < nl > this . enableContactsLogging = enableContactsLogging ; < nl > @ @ - 77 , 6 + 80 , 16 @ @ public class Configuration { < nl > this . preferredLanguages = preferredLanguages ; < nl > this . customAppName = customAppName ; < nl > this . trustedKeys = trustedKeys ; < nl > + this . enablePhoneBookImport = enablePhoneBookImport ; < nl > + } < nl > + < nl > + / * * < nl > + * Getting if app automatically imports phone book to server < nl > + * < nl > + * @ return if phone book enabled < nl > + * / < nl > + public boolean isEnablePhoneBookImport ( ) { < nl > + return enablePhoneBookImport ; < nl > } < nl > < nl > / * * < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / ConfigurationBuilder . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / ConfigurationBuilder . java < nl > index a8a872d . . 8d1c65e 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / ConfigurationBuilder . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / ConfigurationBuilder . java < nl > @ @ - 47 , 6 + 47 , 21 @ @ public class ConfigurationBuilder { < nl > < nl > private String customAppName ; < nl > < nl > + private boolean isPhoneBookImportEnabled = true ; < nl > + < nl > + / * * < nl > + * Setting if application need to upload phone book to server < nl > + * < nl > + * @ param isPhoneBookImportEnabled enabled flag < nl > + * @ return this < nl > + * / < nl > + @ NotNull < nl > + @ ObjectiveCName ( " setPhoneBookImportEnabled : " ) < nl > + public ConfigurationBuilder setPhoneBookImportEnabled ( boolean isPhoneBookImportEnabled ) { < nl > + this . isPhoneBookImportEnabled = isPhoneBookImportEnabled ; < nl > + return this ; < nl > + } < nl > + < nl > / * * < nl > * Adding Trusted key for protocol encryption securing < nl > * < nl > @ @ - 341 , 6 + 356 , 7 @ @ public class ConfigurationBuilder { < nl > extensions . toArray ( new ConfigurationExtension [ extensions . size ( ) ] ) , < nl > timeZone , preferredLanguages . toArray ( new String [ preferredLanguages . size ( ) ] ) , < nl > customAppName , < nl > - trustedKeys . toArray ( new TrustedKey [ trustedKeys . size ( ) ] ) ) ; < nl > + trustedKeys . toArray ( new TrustedKey [ trustedKeys . size ( ) ] ) , < nl > + isPhoneBookImportEnabled ) ; < nl > } < nl > } < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Messenger . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Messenger . java < nl > index 1a36d66 . . a44d871 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Messenger . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Messenger . java < nl > @ @ - 154 , 9 + 154 , 9 @ @ public class Messenger { < nl > * @ return Command for execution < nl > * / < nl > @ NotNull < nl > - @ ObjectiveCName ( " requestStartAuthCommandWithUserName : " ) < nl > + @ ObjectiveCName ( " requestStartAnonymousAuthWithUserName : " ) < nl > public Command < AuthState > requestStartAnonymousAuth ( String userName ) { < nl > - return modules . getAuthModule ( ) . requestStartAnonumousAuth ( userName ) ; < nl > + return modules . getAuthModule ( ) . requestStartAnonymousAuth ( userName ) ; < nl > } < nl > < nl > / * * < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / Authentication . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / Authentication . java < nl > index 482e019 . . 5776d0f 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / Authentication . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / Authentication . java < nl > @ @ - 116 , 7 + 116 , 7 @ @ public class Authentication { < nl > } < nl > } < nl > < nl > - public Command < AuthState > requestStartAnonumousAuth ( final String userName ) { < nl > + public Command < AuthState > requestStartAnonymousAuth ( final String userName ) { < nl > return new Command < AuthState > ( ) { < nl > @ Override < nl > public void start ( final CommandCallback < AuthState > callback ) { < nl > diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / internal / contacts / BookImportActor . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / internal / contacts / BookImportActor . java < nl > index 2f23fc3 . . 2910480 100644 < nl > - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / internal / contacts / BookImportActor . java < nl > + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / internal / contacts / BookImportActor . java < nl > @ @ - 65 , 10 + 65 , 16 @ @ public class BookImportActor extends ModuleActor { < nl > e . getLocalizedMessage ( ) ; < nl > } < nl > } < nl > + < nl > self ( ) . send ( new PerformSync ( ) ) ; < nl > } < nl > < nl > private void performSync ( ) { < nl > + / / Ignoring syncing if not enabled < nl > + if ( ! config ( ) . isEnablePhoneBookImport ( ) ) { < nl > + return ; < nl > + } < nl > + < nl > if ( ENABLE _ LOG ) { < nl > Log . d ( TAG , " Checking sync . . . " ) ; < nl > }

TEST DIFF:
diff - - git a / actor - sdk / sdk - api / actor . json b / actor - sdk / sdk - api / actor . json 
 index dd57b91 . . 21881e7 100644 
 - - - a / actor - sdk / sdk - api / actor . json 
 + + + b / actor - sdk / sdk - api / actor . json 
 @ @ - 11849 , 7 + 11849 , 7 @ @ 
 { 
 " type " : " reference " , 
 " argument " : " timeout " , 
 - " category " : " hidden " , 
 + " category " : " full " , 
 " description " : " Join timeout " 
 } 
 ] , 
 @ @ - 11896 , 7 + 11896 , 7 @ @ 
 { 
 " type " : " reference " , 
 " argument " : " timeout " , 
 - " category " : " hidden " , 
 + " category " : " full " , 
 " description " : " Optional timeout for keep alive " 
 } 
 ] , 
 @ @ - 12437 , 6 + 12437 , 12 @ @ 
 " argument " : " peer " , 
 " category " : " full " , 
 " description " : " destination peer " 
 + } , 
 + { 
 + " type " : " reference " , 
 + " argument " : " eventBusId " , 
 + " category " : " full " , 
 + " description " : " Call Event Bus Id " 
 } 
 ] , 
 " attributes " : [ 
 diff - - git a / actor - sdk / sdk - api / api - language / solutions / im . actor . api / models / im / actor / api / scheme . mps b / actor - sdk / sdk - api / api - language / solutions / im . actor . api / models / im / actor / api / scheme . mps 
 index 9162f96 . . ce7385b 100644 
 - - - a / actor - sdk / sdk - api / api - language / solutions / im . actor . api / models / im / actor / api / scheme . mps 
 + + + b / actor - sdk / sdk - api / api - language / solutions / im . actor . api / models / im / actor / api / scheme . mps 
 @ @ - 10245 , 6 + 10245 , 7 @ @ 
 < / node > 
 < node concept = " NX1gA " id = " 3Tolai5ML1M " role = " 1GBnQ6 " > 
 < property role = " NX6R2 " value = " Join timeout " / > 
 + < property role = " 1GSvIU " value = " full " / > 
 < ref role = " NX6Kv " node = " 3Tolai5M $ P3 " resolve = " timeout " / > 
 < / node > 
 < / node > 
 @ @ - 10282 , 6 + 10283 , 7 @ @ 
 < / node > 
 < node concept = " NX1gA " id = " 3Tolai5MM2b " role = " 1GBnQ6 " > 
 < property role = " NX6R2 " value = " Optional timeout for keep alive " / > 
 + < property role = " 1GSvIU " value = " full " / > 
 < ref role = " NX6Kv " node = " 3Tolai5M _ Py " resolve = " timeout " / > 
 < / node > 
 < / node > 
 @ @ - 10724 , 6 + 10726 , 11 @ @ 
 < property role = " 1GSvIU " value = " full " / > 
 < ref role = " NX6Kv " node = " 201xLeQvfRW " resolve = " peer " / > 
 < / node > 
 + < node concept = " NX1gA " id = " 3Tolai5O2bn " role = " 1GBnQ6 " > 
 + < property role = " NX6R2 " value = " Call Event Bus Id " / > 
 + < property role = " 1GSvIU " value = " full " / > 
 + < ref role = " NX6Kv " node = " 3Tolai5Np _ j " resolve = " eventBusId " / > 
 + < / node > 
 < / node > 
 < node concept = " w93zz " id = " 3Tolai5NMKi " role = " 2m5mJr " > 
 < property role = " TrG5h " value = " WebRTCSignaling " / > 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / api / rpc / RequestDoCall . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / api / rpc / RequestDoCall . java 
 index f21285f . . ef7ebcf 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / api / rpc / RequestDoCall . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / api / rpc / RequestDoCall . java 
 @ @ - 66 , 6 + 66 , 7 @ @ public class RequestDoCall extends Request < ResponseDoCall > { 
 public String toString ( ) { 
 String res = " rpc DoCall { " ; 
 res + = " peer = " + this . peer ; 
 + res + = " , eventBusId = " + this . eventBusId ; 
 res + = " } " ; 
 return res ; 
 } 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / api / rpc / RequestJoinEventBus . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / api / rpc / RequestJoinEventBus . java 
 index 985d3c9 . . c6d4ce6 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / api / rpc / RequestJoinEventBus . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / api / rpc / RequestJoinEventBus . java 
 @ @ - 65 , 6 + 65 , 7 @ @ public class RequestJoinEventBus extends Request < ResponseJoinEventBus > { 
 public String toString ( ) { 
 String res = " rpc JoinEventBus { " ; 
 res + = " id = " + this . id ; 
 + res + = " , timeout = " + this . timeout ; 
 res + = " } " ; 
 return res ; 
 } 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / api / rpc / RequestKeepAliveEventBus . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / api / rpc / RequestKeepAliveEventBus . java 
 index 7d21fea . . c34ee52 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / api / rpc / RequestKeepAliveEventBus . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / api / rpc / RequestKeepAliveEventBus . java 
 @ @ - 65 , 6 + 65 , 7 @ @ public class RequestKeepAliveEventBus extends Request < ResponseVoid > { 
 public String toString ( ) { 
 String res = " rpc KeepAliveEventBus { " ; 
 res + = " id = " + this . id ; 
 + res + = " , timeout = " + this . timeout ; 
 res + = " } " ; 
 return res ; 
 } 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / calls / CallManagerActor . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / calls / CallManagerActor . java 
 index a19566e . . d7f1c8a 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / calls / CallManagerActor . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / calls / CallManagerActor . java 
 @ @ - 67 , 11 + 67 , 11 @ @ public class CallManagerActor extends ModuleActor { 
 / / Starting call 
 / / 
 
 - private void doCall ( Peer peer ) { 
 + private void doCall ( final Peer peer ) { 
 system ( ) . actorOf ( " actor / ? ? " , new ActorCreator ( ) { 
 @ Override 
 public Actor create ( ) { 
 - return new CallMasterActor ( context ( ) ) ; 
 + return new CallMasterActor ( peer , context ( ) ) ; 
 } 
 } ) ; 
 } 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / calls / CallMasterActor . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / calls / CallMasterActor . java 
 index c637b88 . . 96664f7 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / calls / CallMasterActor . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / calls / CallMasterActor . java 
 @ @ - 1 , 13 + 1 , 82 @ @ 
 package im . actor . core . modules . calls ; 
 
 + import org . jetbrains . annotations . Nullable ; 
 + 
 + import java . io . IOException ; 
 + 
 + import im . actor . core . api . ApiWebRTCSignaling ; 
 + import im . actor . core . api . rpc . RequestDoCall ; 
 + import im . actor . core . api . rpc . ResponseDoCall ; 
 + import im . actor . core . entity . Peer ; 
 import im . actor . core . modules . ModuleContext ; 
 import im . actor . core . modules . eventbus . EventBusActor ; 
 + import im . actor . runtime . Log ; 
 + import im . actor . runtime . function . Consumer ; 
 
 public class CallMasterActor extends EventBusActor { 
 
 - public CallMasterActor ( ModuleContext context ) { 
 + private static final String TAG = " CallMasterActor " ; 
 + 
 + private final Peer peer ; 
 + 
 + public CallMasterActor ( Peer peer , ModuleContext context ) { 
 super ( context ) ; 
 + this . peer = peer ; 
 } 
 
 + @ Override 
 + public void onBusCreated ( ) { 
 + Log . d ( TAG , " onBusCreated " ) ; 
 + api ( new RequestDoCall ( buidOutPeer ( peer ) , getBusId ( ) ) ) . then ( new Consumer < ResponseDoCall > ( ) { 
 + @ Override 
 + public void apply ( ResponseDoCall responseDoCall ) { 
 + Log . d ( TAG , " onBusCreated : result " ) ; 
 + } 
 + } ) . failure ( new Consumer < Exception > ( ) { 
 + @ Override 
 + public void apply ( Exception e ) { 
 + Log . d ( TAG , " onBusCreated : error " ) ; 
 + dispose ( ) ; 
 + } 
 + } ) . done ( self ( ) ) ; 
 + } 
 + 
 + @ Override 
 + public void onDeviceConnected ( int uid , long deviceId ) { 
 + Log . d ( TAG , " onDeviceConnected " ) ; 
 + } 
 + 
 + @ Override 
 + public void onDeviceDisconnected ( int uid , long deviceId ) { 
 + Log . d ( TAG , " onDeviceDisconnected " ) ; 
 + } 
 
 - } 
 + @ Override 
 + public void onMessageReceived ( @ Nullable Integer senderId , @ Nullable Long senderDeviceId , byte [ ] data ) { 
 + ApiWebRTCSignaling signaling ; 
 + try { 
 + signaling = ApiWebRTCSignaling . fromBytes ( data ) ; 
 + } catch ( IOException e ) { 
 + e . printStackTrace ( ) ; 
 + Log . d ( TAG , " onMessageReceived : ignoring " ) ; 
 + return ; 
 + } 
 + 
 + Log . d ( TAG , " onMessageReceived : " + signaling ) ; 
 + } 
 + 
 + @ Override 
 + public void onBusShutdown ( ) { 
 + Log . d ( TAG , " onBusShutdown " ) ; 
 + } 
 + 
 + @ Override 
 + public void onBusDisposed ( ) { 
 + Log . d ( TAG , " onBusDisposed " ) ; 
 + } 
 + 
 + @ Override 
 + public void onBusStopped ( ) { 
 + Log . d ( TAG , " onBusStopped " ) ; 
 + } 
 + } 
 \ No newline at end of file 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / eventbus / EventBusActor . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / eventbus / EventBusActor . java 
 index 93b769c . . 65bf90e 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / eventbus / EventBusActor . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / eventbus / EventBusActor . java 
 @ @ - 17 , 7 + 17 , 7 @ @ import im . actor . runtime . function . Consumer ; 
 
 public class EventBusActor extends ModuleActor { 
 
 - private static final long TIMEOUT = 15000 ; 
 + private static final long TIMEOUT = 10000 ; 
 private static final long KEEP _ ALIVE = 5000 ; 
 
 private boolean isProcessing ;

NEAREST DIFF:
diff - - git a / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDK . swift b / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDK . swift 
 index 01a0edb . . 63f9dd8 100644 
 - - - a / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDK . swift 
 + + + b / actor - sdk / sdk - core - ios / ActorSDK / Sources / ActorSDK . swift 
 @ @ - 72 , 6 + 72 , 9 @ @ public class ActorSDK { 
 / / / Push token registration id . Required for sending push tokens 
 public var apiPushId : Int ? = nil 
 
 + / / / Enable phone book import 
 + public var enablePhoneBookImport = true 
 + 
 / / / Invitation URL for apps 
 public var inviteUrl : String = " https : / / actor . im / dl " 
 
 @ @ - 198 , 6 + 201 , 9 @ @ public class ActorSDK { 
 builder . setCustomAppName ( AALocalized ( appNameInLocStrings ) ) 
 } 
 
 + / / Config 
 + builder . setPhoneBookImportEnabled ( jboolean ( enablePhoneBookImport ) ) 
 + 
 / / Creating messenger 
 messenger = ACCocoaMessenger ( configuration : builder . build ( ) ) 
 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Configuration . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Configuration . java 
 index bf0da53 . . 1d73500 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Configuration . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Configuration . java 
 @ @ - 43 , 6 + 43 , 8 @ @ public class Configuration { 
 
 private String customAppName ; 
 
 + private boolean enablePhoneBookImport ; 
 + 
 Configuration ( ConnectionEndpoint [ ] endpoints , 
 PhoneBookProvider phoneBookProvider , 
 NotificationProvider notificationProvider , 
 @ @ - 59 , 7 + 61 , 8 @ @ public class Configuration { 
 String timeZone , 
 String [ ] preferredLanguages , 
 String customAppName , 
 - TrustedKey [ ] trustedKeys ) { 
 + TrustedKey [ ] trustedKeys , 
 + boolean enablePhoneBookImport ) { 
 this . endpoints = endpoints ; 
 this . phoneBookProvider = phoneBookProvider ; 
 this . enableContactsLogging = enableContactsLogging ; 
 @ @ - 77 , 6 + 80 , 16 @ @ public class Configuration { 
 this . preferredLanguages = preferredLanguages ; 
 this . customAppName = customAppName ; 
 this . trustedKeys = trustedKeys ; 
 + this . enablePhoneBookImport = enablePhoneBookImport ; 
 + } 
 + 
 + / * * 
 + * Getting if app automatically imports phone book to server 
 + * 
 + * @ return if phone book enabled 
 + * / 
 + public boolean isEnablePhoneBookImport ( ) { 
 + return enablePhoneBookImport ; 
 } 
 
 / * * 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / ConfigurationBuilder . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / ConfigurationBuilder . java 
 index a8a872d . . 8d1c65e 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / ConfigurationBuilder . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / ConfigurationBuilder . java 
 @ @ - 47 , 6 + 47 , 21 @ @ public class ConfigurationBuilder { 
 
 private String customAppName ; 
 
 + private boolean isPhoneBookImportEnabled = true ; 
 + 
 + / * * 
 + * Setting if application need to upload phone book to server 
 + * 
 + * @ param isPhoneBookImportEnabled enabled flag 
 + * @ return this 
 + * / 
 + @ NotNull 
 + @ ObjectiveCName ( " setPhoneBookImportEnabled : " ) 
 + public ConfigurationBuilder setPhoneBookImportEnabled ( boolean isPhoneBookImportEnabled ) { 
 + this . isPhoneBookImportEnabled = isPhoneBookImportEnabled ; 
 + return this ; 
 + } 
 + 
 / * * 
 * Adding Trusted key for protocol encryption securing 
 * 
 @ @ - 341 , 6 + 356 , 7 @ @ public class ConfigurationBuilder { 
 extensions . toArray ( new ConfigurationExtension [ extensions . size ( ) ] ) , 
 timeZone , preferredLanguages . toArray ( new String [ preferredLanguages . size ( ) ] ) , 
 customAppName , 
 - trustedKeys . toArray ( new TrustedKey [ trustedKeys . size ( ) ] ) ) ; 
 + trustedKeys . toArray ( new TrustedKey [ trustedKeys . size ( ) ] ) , 
 + isPhoneBookImportEnabled ) ; 
 } 
 } 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Messenger . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Messenger . java 
 index 1a36d66 . . a44d871 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Messenger . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / Messenger . java 
 @ @ - 154 , 9 + 154 , 9 @ @ public class Messenger { 
 * @ return Command for execution 
 * / 
 @ NotNull 
 - @ ObjectiveCName ( " requestStartAuthCommandWithUserName : " ) 
 + @ ObjectiveCName ( " requestStartAnonymousAuthWithUserName : " ) 
 public Command < AuthState > requestStartAnonymousAuth ( String userName ) { 
 - return modules . getAuthModule ( ) . requestStartAnonumousAuth ( userName ) ; 
 + return modules . getAuthModule ( ) . requestStartAnonymousAuth ( userName ) ; 
 } 
 
 / * * 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / Authentication . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / Authentication . java 
 index 482e019 . . 5776d0f 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / Authentication . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / Authentication . java 
 @ @ - 116 , 7 + 116 , 7 @ @ public class Authentication { 
 } 
 } 
 
 - public Command < AuthState > requestStartAnonumousAuth ( final String userName ) { 
 + public Command < AuthState > requestStartAnonymousAuth ( final String userName ) { 
 return new Command < AuthState > ( ) { 
 @ Override 
 public void start ( final CommandCallback < AuthState > callback ) { 
 diff - - git a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / internal / contacts / BookImportActor . java b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / internal / contacts / BookImportActor . java 
 index 2f23fc3 . . 2910480 100644 
 - - - a / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / internal / contacts / BookImportActor . java 
 + + + b / actor - sdk / sdk - core / core / core - shared / src / main / java / im / actor / core / modules / internal / contacts / BookImportActor . java 
 @ @ - 65 , 10 + 65 , 16 @ @ public class BookImportActor extends ModuleActor { 
 e . getLocalizedMessage ( ) ; 
 } 
 } 
 + 
 self ( ) . send ( new PerformSync ( ) ) ; 
 } 
 
 private void performSync ( ) { 
 + / / Ignoring syncing if not enabled 
 + if ( ! config ( ) . isEnablePhoneBookImport ( ) ) { 
 + return ; 
 + } 
 + 
 if ( ENABLE _ LOG ) { 
 Log . d ( TAG , " Checking sync . . . " ) ; 
 }
