BLEU SCORE: 0.03283637368030199

TEST MSG: cqlsh : Improve default float precision behavior
GENERATED MSG: Add standalone sstableupgrade utility .

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index ca12522 . . a4430c0 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 1 , 4 + 1 , 5 @ @ <nl> 2 . 1 . 6 <nl> + * ( cqlsh ) Better float precision by default ( CASSANDRA - 9224 ) <nl> * Improve estimated row count ( CASSANDRA - 9107 ) <nl> * Optimize range tombstone memory footprint ( CASSANDRA - 8603 ) <nl> * Use configured gcgs in anticompaction ( CASSANDRA - 9397 ) <nl> diff - - git a / pylib / cqlshlib / formatting . py b / pylib / cqlshlib / formatting . py <nl> index e9d22fd . . 2a99e23 100644 <nl> - - - a / pylib / cqlshlib / formatting . py <nl> + + + b / pylib / cqlshlib / formatting . py <nl> @ @ - 14 , 6 + 14 , 7 @ @ <nl> # See the License for the specific language governing permissions and <nl> # limitations under the License . <nl> <nl> + import sys <nl> import re <nl> import time <nl> import calendar <nl> @ @ - 144 , 6 + 145 , 13 @ @ def format _ floating _ point _ type ( val , colormap , float _ precision , * * _ ) : <nl> elif math . isinf ( val ) : <nl> bval = ' Infinity ' <nl> else : <nl> + exponent = int ( math . log10 ( abs ( val ) ) ) if abs ( val ) > sys . float _ info . epsilon else - sys . maxint - 1 <nl> + if - 4 < = exponent < float _ precision : <nl> + # when this is true % g will not use scientific notation , <nl> + # increasing precision should not change this decision <nl> + # so we increase the precision to take into account the <nl> + # digits to the left of the decimal point <nl> + float _ precision = float _ precision + exponent + 1 <nl> bval = ' % . * g ' % ( float _ precision , val ) <nl> return colorme ( bval , colormap , ' float ' ) <nl>
NEAREST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / metrics / ReadRepairMetrics . java b / src / java / org / apache / cassandra / metrics / ReadRepairMetrics . java <nl> index 3f48fee . . 5b61e42 100644 <nl> - - - a / src / java / org / apache / cassandra / metrics / ReadRepairMetrics . java <nl> + + + b / src / java / org / apache / cassandra / metrics / ReadRepairMetrics . java <nl> @ @ - 1 , 4 + 1 , 25 @ @ <nl> package org . apache . cassandra . metrics ; <nl> + / * <nl> + * <nl> + * Licensed to the Apache Software Foundation ( ASF ) under one <nl> + * or more contributor license agreements . See the NOTICE file <nl> + * distributed with this work for additional information <nl> + * regarding copyright ownership . The ASF licenses this file <nl> + * to you under the Apache License , Version 2 . 0 ( the <nl> + * " License " ) ; you may not use this file except in compliance <nl> + * with the License . You may obtain a copy of the License at <nl> + * <nl> + * http : / / www . apache . org / licenses / LICENSE - 2 . 0 <nl> + * <nl> + * Unless required by applicable law or agreed to in writing , <nl> + * software distributed under the License is distributed on an <nl> + * " AS IS " BASIS , WITHOUT WARRANTIES OR CONDITIONS OF ANY <nl> + * KIND , either express or implied . See the License for the <nl> + * specific language governing permissions and limitations <nl> + * under the License . <nl> + * <nl> + * / <nl> + <nl> <nl> import java . util . concurrent . TimeUnit ; <nl>

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index ca12522 . . a4430c0 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 1 , 4 + 1 , 5 @ @ 
 2 . 1 . 6 
 + * ( cqlsh ) Better float precision by default ( CASSANDRA - 9224 ) 
 * Improve estimated row count ( CASSANDRA - 9107 ) 
 * Optimize range tombstone memory footprint ( CASSANDRA - 8603 ) 
 * Use configured gcgs in anticompaction ( CASSANDRA - 9397 ) 
 diff - - git a / pylib / cqlshlib / formatting . py b / pylib / cqlshlib / formatting . py 
 index e9d22fd . . 2a99e23 100644 
 - - - a / pylib / cqlshlib / formatting . py 
 + + + b / pylib / cqlshlib / formatting . py 
 @ @ - 14 , 6 + 14 , 7 @ @ 
 # See the License for the specific language governing permissions and 
 # limitations under the License . 
 
 + import sys 
 import re 
 import time 
 import calendar 
 @ @ - 144 , 6 + 145 , 13 @ @ def format _ floating _ point _ type ( val , colormap , float _ precision , * * _ ) : 
 elif math . isinf ( val ) : 
 bval = ' Infinity ' 
 else : 
 + exponent = int ( math . log10 ( abs ( val ) ) ) if abs ( val ) > sys . float _ info . epsilon else - sys . maxint - 1 
 + if - 4 < = exponent < float _ precision : 
 + # when this is true % g will not use scientific notation , 
 + # increasing precision should not change this decision 
 + # so we increase the precision to take into account the 
 + # digits to the left of the decimal point 
 + float _ precision = float _ precision + exponent + 1 
 bval = ' % . * g ' % ( float _ precision , val ) 
 return colorme ( bval , colormap , ' float ' ) 


NEAREST DIFF:
diff - - git a / src / java / org / apache / cassandra / metrics / ReadRepairMetrics . java b / src / java / org / apache / cassandra / metrics / ReadRepairMetrics . java 
 index 3f48fee . . 5b61e42 100644 
 - - - a / src / java / org / apache / cassandra / metrics / ReadRepairMetrics . java 
 + + + b / src / java / org / apache / cassandra / metrics / ReadRepairMetrics . java 
 @ @ - 1 , 4 + 1 , 25 @ @ 
 package org . apache . cassandra . metrics ; 
 + / * 
 + * 
 + * Licensed to the Apache Software Foundation ( ASF ) under one 
 + * or more contributor license agreements . See the NOTICE file 
 + * distributed with this work for additional information 
 + * regarding copyright ownership . The ASF licenses this file 
 + * to you under the Apache License , Version 2 . 0 ( the 
 + * " License " ) ; you may not use this file except in compliance 
 + * with the License . You may obtain a copy of the License at 
 + * 
 + * http : / / www . apache . org / licenses / LICENSE - 2 . 0 
 + * 
 + * Unless required by applicable law or agreed to in writing , 
 + * software distributed under the License is distributed on an 
 + * " AS IS " BASIS , WITHOUT WARRANTIES OR CONDITIONS OF ANY 
 + * KIND , either express or implied . See the License for the 
 + * specific language governing permissions and limitations 
 + * under the License . 
 + * 
 + * / 
 + 
 
 import java . util . concurrent . TimeUnit ; 

