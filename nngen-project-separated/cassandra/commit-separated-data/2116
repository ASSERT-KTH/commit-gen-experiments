BLEU SCORE: 0.037477767366779206

TEST MSG: Clean up compaction logging more - followup to CASSANDRA - 7818
GENERATED MSG: omit zero counts from compaction merge summary

TEST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / db / compaction / CompactionTask . java b / src / java / org / apache / cassandra / db / compaction / CompactionTask . java <nl> index fa0cffc . . 4a22d0c 100644 <nl> - - - a / src / java / org / apache / cassandra / db / compaction / CompactionTask . java <nl> + + + b / src / java / org / apache / cassandra / db / compaction / CompactionTask . java <nl> @ @ - 136 , 7 + 136 , 7 @ @ public class CompactionTask extends AbstractCompactionTask <nl> StringBuilder ssTableLoggerMsg = new StringBuilder ( " [ " ) ; <nl> for ( SSTableReader sstr : sstables ) <nl> { <nl> - ssTableLoggerMsg . append ( String . format ( " SSTableReader ( path = % s , level = % d ) , " , sstr . getFilename ( ) , sstr . getSSTableLevel ( ) ) ) ; <nl> + ssTableLoggerMsg . append ( String . format ( " % s : level = % d , " , sstr . getFilename ( ) , sstr . getSSTableLevel ( ) ) ) ; <nl> } <nl> ssTableLoggerMsg . append ( " ] " ) ; <nl> String taskIdLoggerMsg = taskId = = null ? UUIDGen . getTimeUUID ( ) . toString ( ) : taskId . toString ( ) ;
NEAREST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / db / Memtable . java b / src / java / org / apache / cassandra / db / Memtable . java <nl> index 12d36bf . . 3bb8c1e 100644 <nl> - - - a / src / java / org / apache / cassandra / db / Memtable . java <nl> + + + b / src / java / org / apache / cassandra / db / Memtable . java <nl> @ @ - 446 , 7 + 446 , 7 @ @ public class Memtable <nl> else <nl> cfs . liveRatio = ( cfs . liveRatio + newRatio ) / 2 . 0 ; <nl> <nl> - logger . info ( " { } liveRatio is { } ( just - counted was { } ) . calculation took { } ms for { } columns " , <nl> + logger . info ( " { } liveRatio is { } ( just - counted was { } ) . calculation took { } ms for { } cells " , <nl> cfs , cfs . liveRatio , newRatio , TimeUnit . NANOSECONDS . toMillis ( System . nanoTime ( ) - start ) , objects ) ; <nl> } <nl> finally <nl> diff - - git a / src / java / org / apache / cassandra / db / compaction / CompactionTask . java b / src / java / org / apache / cassandra / db / compaction / CompactionTask . java <nl> index cd7d3d9 . . 6c6f852 100644 <nl> - - - a / src / java / org / apache / cassandra / db / compaction / CompactionTask . java <nl> + + + b / src / java / org / apache / cassandra / db / compaction / CompactionTask . java <nl> @ @ - 272 , 7 + 272 , 7 @ @ public class CompactionTask extends AbstractCompactionTask <nl> } <nl> <nl> SystemKeyspace . updateCompactionHistory ( cfs . keyspace . getName ( ) , cfs . name , start , startsize , endsize , mergedRows ) ; <nl> - logger . info ( String . format ( " Compacted % d sstables to [ % s ] . % , d bytes to % , d ( ~ % d % % of original ) in % , dms = % fMB / s . % , d total rows , % , d unique . Row merge counts were { % s } " , <nl> + logger . info ( String . format ( " Compacted % d sstables to [ % s ] . % , d bytes to % , d ( ~ % d % % of original ) in % , dms = % fMB / s . % , d total partitions merged to % , d . Partition merge counts were { % s } " , <nl> toCompact . size ( ) , builder . toString ( ) , startsize , endsize , ( int ) ( ratio * 100 ) , dTime , mbps , totalSourceRows , totalkeysWritten , mergeSummary . toString ( ) ) ) ; <nl> logger . debug ( String . format ( " CF Total Bytes Compacted : % , d " , CompactionTask . addToTotalBytesCompacted ( endsize ) ) ) ; <nl> }

TEST DIFF:
diff - - git a / src / java / org / apache / cassandra / db / compaction / CompactionTask . java b / src / java / org / apache / cassandra / db / compaction / CompactionTask . java 
 index fa0cffc . . 4a22d0c 100644 
 - - - a / src / java / org / apache / cassandra / db / compaction / CompactionTask . java 
 + + + b / src / java / org / apache / cassandra / db / compaction / CompactionTask . java 
 @ @ - 136 , 7 + 136 , 7 @ @ public class CompactionTask extends AbstractCompactionTask 
 StringBuilder ssTableLoggerMsg = new StringBuilder ( " [ " ) ; 
 for ( SSTableReader sstr : sstables ) 
 { 
 - ssTableLoggerMsg . append ( String . format ( " SSTableReader ( path = % s , level = % d ) , " , sstr . getFilename ( ) , sstr . getSSTableLevel ( ) ) ) ; 
 + ssTableLoggerMsg . append ( String . format ( " % s : level = % d , " , sstr . getFilename ( ) , sstr . getSSTableLevel ( ) ) ) ; 
 } 
 ssTableLoggerMsg . append ( " ] " ) ; 
 String taskIdLoggerMsg = taskId = = null ? UUIDGen . getTimeUUID ( ) . toString ( ) : taskId . toString ( ) ;

NEAREST DIFF:
diff - - git a / src / java / org / apache / cassandra / db / Memtable . java b / src / java / org / apache / cassandra / db / Memtable . java 
 index 12d36bf . . 3bb8c1e 100644 
 - - - a / src / java / org / apache / cassandra / db / Memtable . java 
 + + + b / src / java / org / apache / cassandra / db / Memtable . java 
 @ @ - 446 , 7 + 446 , 7 @ @ public class Memtable 
 else 
 cfs . liveRatio = ( cfs . liveRatio + newRatio ) / 2 . 0 ; 
 
 - logger . info ( " { } liveRatio is { } ( just - counted was { } ) . calculation took { } ms for { } columns " , 
 + logger . info ( " { } liveRatio is { } ( just - counted was { } ) . calculation took { } ms for { } cells " , 
 cfs , cfs . liveRatio , newRatio , TimeUnit . NANOSECONDS . toMillis ( System . nanoTime ( ) - start ) , objects ) ; 
 } 
 finally 
 diff - - git a / src / java / org / apache / cassandra / db / compaction / CompactionTask . java b / src / java / org / apache / cassandra / db / compaction / CompactionTask . java 
 index cd7d3d9 . . 6c6f852 100644 
 - - - a / src / java / org / apache / cassandra / db / compaction / CompactionTask . java 
 + + + b / src / java / org / apache / cassandra / db / compaction / CompactionTask . java 
 @ @ - 272 , 7 + 272 , 7 @ @ public class CompactionTask extends AbstractCompactionTask 
 } 
 
 SystemKeyspace . updateCompactionHistory ( cfs . keyspace . getName ( ) , cfs . name , start , startsize , endsize , mergedRows ) ; 
 - logger . info ( String . format ( " Compacted % d sstables to [ % s ] . % , d bytes to % , d ( ~ % d % % of original ) in % , dms = % fMB / s . % , d total rows , % , d unique . Row merge counts were { % s } " , 
 + logger . info ( String . format ( " Compacted % d sstables to [ % s ] . % , d bytes to % , d ( ~ % d % % of original ) in % , dms = % fMB / s . % , d total partitions merged to % , d . Partition merge counts were { % s } " , 
 toCompact . size ( ) , builder . toString ( ) , startsize , endsize , ( int ) ( ratio * 100 ) , dTime , mbps , totalSourceRows , totalkeysWritten , mergeSummary . toString ( ) ) ) ; 
 logger . debug ( String . format ( " CF Total Bytes Compacted : % , d " , CompactionTask . addToTotalBytesCompacted ( endsize ) ) ) ; 
 }
