BLEU SCORE: 0.033864985683445356

TEST MSG: If CompactionMetadata is not in stats file , use index summary instead
GENERATED MSG: Fix bug in cardinality estimation when sstables are being compacted

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index a6a0c60 . . 6f567ee 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 1 , 7 + 1 , 8 @ @ <nl> 2 . 1 . 13 <nl> + * If CompactionMetadata is not in stats file , use index summary instead ( CASSANDRA - 10676 ) <nl> * Retry sending gossip syn multiple times during shadow round ( CASSANDRA - 8072 ) <nl> * Fix pending range calculation during moves ( CASSANDRA - 10887 ) <nl> - * Sane default ( 200Mbps ) for inter - DC streaming througput ( CASSANDRA - 9708 ) <nl> + * Sane default ( 200Mbps ) for inter - DC streaming througput ( CASSANDRA - 8708 ) <nl> * Match cassandra - loader options in COPY FROM ( CASSANDRA - 9303 ) <nl> * Fix binding to any address in CqlBulkRecordWriter ( CASSANDRA - 9309 ) <nl> * Fix the way we replace sstables after anticompaction ( CASSANDRA - 10831 ) <nl> diff - - git a / src / java / org / apache / cassandra / io / sstable / SSTableReader . java b / src / java / org / apache / cassandra / io / sstable / SSTableReader . java <nl> index 84add6f . . 2680125 100644 <nl> - - - a / src / java / org / apache / cassandra / io / sstable / SSTableReader . java <nl> + + + b / src / java / org / apache / cassandra / io / sstable / SSTableReader . java <nl> @ @ - 265 , 7 + 265 , 15 @ @ public class SSTableReader extends SSTable implements SelfRefCounted < SSTableRead <nl> try <nl> { <nl> CompactionMetadata metadata = ( CompactionMetadata ) sstable . descriptor . getMetadataSerializer ( ) . deserialize ( sstable . descriptor , MetadataType . COMPACTION ) ; <nl> - assert metadata ! = null : sstable . getFilename ( ) ; <nl> + / / If we can ' t load the CompactionMetadata , we are forced to estimate the keys using the index <nl> + / / summary . ( CASSANDRA - 10676 ) <nl> + if ( metadata = = null ) <nl> + { <nl> + logger . warn ( " Reading cardinality from Statistics . db failed for { } " , sstable . getFilename ( ) ) ; <nl> + failed = true ; <nl> + break ; <nl> + } <nl> + <nl> if ( cardinality = = null ) <nl> cardinality = metadata . cardinalityEstimator ; <nl> else
NEAREST DIFF (one line): ELIMINATEDSENTENCE

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index a6a0c60 . . 6f567ee 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 1 , 7 + 1 , 8 @ @ 
 2 . 1 . 13 
 + * If CompactionMetadata is not in stats file , use index summary instead ( CASSANDRA - 10676 ) 
 * Retry sending gossip syn multiple times during shadow round ( CASSANDRA - 8072 ) 
 * Fix pending range calculation during moves ( CASSANDRA - 10887 ) 
 - * Sane default ( 200Mbps ) for inter - DC streaming througput ( CASSANDRA - 9708 ) 
 + * Sane default ( 200Mbps ) for inter - DC streaming througput ( CASSANDRA - 8708 ) 
 * Match cassandra - loader options in COPY FROM ( CASSANDRA - 9303 ) 
 * Fix binding to any address in CqlBulkRecordWriter ( CASSANDRA - 9309 ) 
 * Fix the way we replace sstables after anticompaction ( CASSANDRA - 10831 ) 
 diff - - git a / src / java / org / apache / cassandra / io / sstable / SSTableReader . java b / src / java / org / apache / cassandra / io / sstable / SSTableReader . java 
 index 84add6f . . 2680125 100644 
 - - - a / src / java / org / apache / cassandra / io / sstable / SSTableReader . java 
 + + + b / src / java / org / apache / cassandra / io / sstable / SSTableReader . java 
 @ @ - 265 , 7 + 265 , 15 @ @ public class SSTableReader extends SSTable implements SelfRefCounted < SSTableRead 
 try 
 { 
 CompactionMetadata metadata = ( CompactionMetadata ) sstable . descriptor . getMetadataSerializer ( ) . deserialize ( sstable . descriptor , MetadataType . COMPACTION ) ; 
 - assert metadata ! = null : sstable . getFilename ( ) ; 
 + / / If we can ' t load the CompactionMetadata , we are forced to estimate the keys using the index 
 + / / summary . ( CASSANDRA - 10676 ) 
 + if ( metadata = = null ) 
 + { 
 + logger . warn ( " Reading cardinality from Statistics . db failed for { } " , sstable . getFilename ( ) ) ; 
 + failed = true ; 
 + break ; 
 + } 
 + 
 if ( cardinality = = null ) 
 cardinality = metadata . cardinalityEstimator ; 
 else

NEAREST DIFF:
ELIMINATEDSENTENCE
