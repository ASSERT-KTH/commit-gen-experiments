BLEU SCORE: 0.021504238591261653

TEST MSG: Use RandomStringGenerator instead of WordGenerator so BitSetTest passes
GENERATED MSG: Fix for missing filter type in 2 . 0 branch

TEST DIFF (one line): diff - - git a / test / unit / org / apache / cassandra / utils / BitSetTest . java b / test / unit / org / apache / cassandra / utils / BitSetTest . java <nl> index e9f9211 . . 59bc5e4 100644 <nl> - - - a / test / unit / org / apache / cassandra / utils / BitSetTest . java <nl> + + + b / test / unit / org / apache / cassandra / utils / BitSetTest . java <nl> @ @ - 29 , 7 + 29 , 7 @ @ import org . junit . Test ; <nl> <nl> import org . junit . Assert ; <nl> import org . apache . cassandra . io . util . DataOutputBuffer ; <nl> - import org . apache . cassandra . utils . KeyGenerator . WordGenerator ; <nl> + import org . apache . cassandra . utils . KeyGenerator . RandomStringGenerator ; <nl> import org . apache . cassandra . utils . obs . IBitSet ; <nl> import org . apache . cassandra . utils . obs . OffHeapBitSet ; <nl> import org . apache . cassandra . utils . obs . OpenBitSet ; <nl> @ @ - 44 , 10 + 44 , 10 @ @ public class BitSetTest <nl> @ Test <nl> public void compareBitSets ( ) <nl> { <nl> - BloomFilter bf2 = ( BloomFilter ) FilterFactory . getFilter ( KeyGenerator . WordGenerator . WORDS / 2 , FilterTestHelper . MAX _ FAILURE _ RATE , false ) ; <nl> - BloomFilter bf3 = ( BloomFilter ) FilterFactory . getFilter ( KeyGenerator . WordGenerator . WORDS / 2 , FilterTestHelper . MAX _ FAILURE _ RATE , true ) ; <nl> - int skipEven = KeyGenerator . WordGenerator . WORDS % 2 = = 0 ? 0 : 2 ; <nl> - WordGenerator gen1 = new KeyGenerator . WordGenerator ( skipEven , 2 ) ; <nl> + BloomFilter bf2 = ( BloomFilter ) FilterFactory . getFilter ( FilterTestHelper . ELEMENTS / 2 , FilterTestHelper . MAX _ FAILURE _ RATE , false ) ; <nl> + BloomFilter bf3 = ( BloomFilter ) FilterFactory . getFilter ( FilterTestHelper . ELEMENTS / 2 , FilterTestHelper . MAX _ FAILURE _ RATE , true ) ; <nl> + <nl> + RandomStringGenerator gen1 = new KeyGenerator . RandomStringGenerator ( new Random ( ) . nextInt ( ) , FilterTestHelper . ELEMENTS ) ; <nl> <nl> / / make sure both bitsets are empty . <nl> compare ( bf2 . bitset , bf3 . bitset ) ;
NEAREST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / db / HintedHandOffManager . java b / src / java / org / apache / cassandra / db / HintedHandOffManager . java <nl> index 014a4cc . . 406f62d 100644 <nl> - - - a / src / java / org / apache / cassandra / db / HintedHandOffManager . java <nl> + + + b / src / java / org / apache / cassandra / db / HintedHandOffManager . java <nl> @ @ - 356 , 7 + 356 , 7 @ @ public class HintedHandOffManager implements HintedHandOffManagerMBean <nl> } <nl> <nl> List < WriteResponseHandler > responseHandlers = Lists . newArrayList ( ) ; <nl> - <nl> + Map < UUID , Long > truncationTimesCache = new HashMap < UUID , Long > ( ) ; <nl> for ( final Column hint : hintsPage ) <nl> { <nl> / / check if hints delivery has been paused during the process <nl> @ @ - 395 , 7 + 395 , 7 @ @ public class HintedHandOffManager implements HintedHandOffManagerMBean <nl> throw new AssertionError ( e ) ; <nl> } <nl> <nl> - Map < UUID , Long > truncationTimesCache = new HashMap < UUID , Long > ( ) ; <nl> + truncationTimesCache . clear ( ) ; <nl> for ( UUID cfId : ImmutableSet . copyOf ( ( rm . getColumnFamilyIds ( ) ) ) ) <nl> { <nl> Long truncatedAt = truncationTimesCache . get ( cfId ) ;

TEST DIFF:
diff - - git a / test / unit / org / apache / cassandra / utils / BitSetTest . java b / test / unit / org / apache / cassandra / utils / BitSetTest . java 
 index e9f9211 . . 59bc5e4 100644 
 - - - a / test / unit / org / apache / cassandra / utils / BitSetTest . java 
 + + + b / test / unit / org / apache / cassandra / utils / BitSetTest . java 
 @ @ - 29 , 7 + 29 , 7 @ @ import org . junit . Test ; 
 
 import org . junit . Assert ; 
 import org . apache . cassandra . io . util . DataOutputBuffer ; 
 - import org . apache . cassandra . utils . KeyGenerator . WordGenerator ; 
 + import org . apache . cassandra . utils . KeyGenerator . RandomStringGenerator ; 
 import org . apache . cassandra . utils . obs . IBitSet ; 
 import org . apache . cassandra . utils . obs . OffHeapBitSet ; 
 import org . apache . cassandra . utils . obs . OpenBitSet ; 
 @ @ - 44 , 10 + 44 , 10 @ @ public class BitSetTest 
 @ Test 
 public void compareBitSets ( ) 
 { 
 - BloomFilter bf2 = ( BloomFilter ) FilterFactory . getFilter ( KeyGenerator . WordGenerator . WORDS / 2 , FilterTestHelper . MAX _ FAILURE _ RATE , false ) ; 
 - BloomFilter bf3 = ( BloomFilter ) FilterFactory . getFilter ( KeyGenerator . WordGenerator . WORDS / 2 , FilterTestHelper . MAX _ FAILURE _ RATE , true ) ; 
 - int skipEven = KeyGenerator . WordGenerator . WORDS % 2 = = 0 ? 0 : 2 ; 
 - WordGenerator gen1 = new KeyGenerator . WordGenerator ( skipEven , 2 ) ; 
 + BloomFilter bf2 = ( BloomFilter ) FilterFactory . getFilter ( FilterTestHelper . ELEMENTS / 2 , FilterTestHelper . MAX _ FAILURE _ RATE , false ) ; 
 + BloomFilter bf3 = ( BloomFilter ) FilterFactory . getFilter ( FilterTestHelper . ELEMENTS / 2 , FilterTestHelper . MAX _ FAILURE _ RATE , true ) ; 
 + 
 + RandomStringGenerator gen1 = new KeyGenerator . RandomStringGenerator ( new Random ( ) . nextInt ( ) , FilterTestHelper . ELEMENTS ) ; 
 
 / / make sure both bitsets are empty . 
 compare ( bf2 . bitset , bf3 . bitset ) ;

NEAREST DIFF:
diff - - git a / src / java / org / apache / cassandra / db / HintedHandOffManager . java b / src / java / org / apache / cassandra / db / HintedHandOffManager . java 
 index 014a4cc . . 406f62d 100644 
 - - - a / src / java / org / apache / cassandra / db / HintedHandOffManager . java 
 + + + b / src / java / org / apache / cassandra / db / HintedHandOffManager . java 
 @ @ - 356 , 7 + 356 , 7 @ @ public class HintedHandOffManager implements HintedHandOffManagerMBean 
 } 
 
 List < WriteResponseHandler > responseHandlers = Lists . newArrayList ( ) ; 
 - 
 + Map < UUID , Long > truncationTimesCache = new HashMap < UUID , Long > ( ) ; 
 for ( final Column hint : hintsPage ) 
 { 
 / / check if hints delivery has been paused during the process 
 @ @ - 395 , 7 + 395 , 7 @ @ public class HintedHandOffManager implements HintedHandOffManagerMBean 
 throw new AssertionError ( e ) ; 
 } 
 
 - Map < UUID , Long > truncationTimesCache = new HashMap < UUID , Long > ( ) ; 
 + truncationTimesCache . clear ( ) ; 
 for ( UUID cfId : ImmutableSet . copyOf ( ( rm . getColumnFamilyIds ( ) ) ) ) 
 { 
 Long truncatedAt = truncationTimesCache . get ( cfId ) ;
