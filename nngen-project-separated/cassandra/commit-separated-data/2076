BLEU SCORE: 0.030569602392969023

TEST MSG: ninja add support for yaml profile as a url
GENERATED MSG: ninja fix cassandra - stress pre - 2 . 1 . 1 compatibility

TEST DIFF (one line): diff - - git a / tools / stress / src / org / apache / cassandra / stress / StressProfile . java b / tools / stress / src / org / apache / cassandra / stress / StressProfile . java <nl> index b0a149c . . 76642be 100644 <nl> - - - a / tools / stress / src / org / apache / cassandra / stress / StressProfile . java <nl> + + + b / tools / stress / src / org / apache / cassandra / stress / StressProfile . java <nl> @ @ - 68 , 11 + 68 , 9 @ @ import org . yaml . snakeyaml . Yaml ; <nl> import org . yaml . snakeyaml . constructor . Constructor ; <nl> import org . yaml . snakeyaml . error . YAMLException ; <nl> <nl> - import java . io . ByteArrayInputStream ; <nl> - import java . io . File ; <nl> - import java . io . IOError ; <nl> - import java . io . IOException ; <nl> - import java . io . Serializable ; <nl> + import java . io . * ; <nl> + import java . net . URI ; <nl> + import java . net . URL ; <nl> import java . nio . file . Files ; <nl> import java . nio . file . Paths ; <nl> import java . util . ArrayList ; <nl> @ @ - 524 , 17 + 522 , 20 @ @ public class StressProfile implements Serializable <nl> } <nl> } <nl> <nl> - public static StressProfile load ( File file ) throws IOError <nl> + public static StressProfile load ( URI file ) throws IOError <nl> { <nl> try <nl> { <nl> - byte [ ] profileBytes = Files . readAllBytes ( Paths . get ( file . toURI ( ) ) ) ; <nl> - <nl> Constructor constructor = new Constructor ( StressYaml . class ) ; <nl> <nl> Yaml yaml = new Yaml ( constructor ) ; <nl> <nl> - StressYaml profileYaml = yaml . loadAs ( new ByteArrayInputStream ( profileBytes ) , StressYaml . class ) ; <nl> + InputStream yamlStream = file . toURL ( ) . openStream ( ) ; <nl> + <nl> + if ( yamlStream . available ( ) = = 0 ) <nl> + throw new IOException ( " Unable to load yaml file from : " + file ) ; <nl> + <nl> + StressYaml profileYaml = yaml . loadAs ( yamlStream , StressYaml . class ) ; <nl> <nl> StressProfile profile = new StressProfile ( ) ; <nl> profile . init ( profileYaml ) ; <nl> diff - - git a / tools / stress / src / org / apache / cassandra / stress / settings / SettingsCommandUser . java b / tools / stress / src / org / apache / cassandra / stress / settings / SettingsCommandUser . java <nl> index a6dad35 . . 4e2997f 100644 <nl> - - - a / tools / stress / src / org / apache / cassandra / stress / settings / SettingsCommandUser . java <nl> + + + b / tools / stress / src / org / apache / cassandra / stress / settings / SettingsCommandUser . java <nl> @ @ - 22 , 6 + 22 , 7 @ @ package org . apache . cassandra . stress . settings ; <nl> <nl> <nl> import java . io . File ; <nl> + import java . net . URI ; <nl> import java . util . ArrayList ; <nl> import java . util . Arrays ; <nl> import java . util . Collections ; <nl> @ @ - 58 , 7 + 59 , 15 @ @ public class SettingsCommandUser extends SettingsCommand <nl> <nl> clustering = options . clustering . get ( ) ; <nl> ratios = options . ops . ratios ( ) ; <nl> - profile = StressProfile . load ( new File ( options . profile . value ( ) ) ) ; <nl> + <nl> + String yamlPath = options . profile . value ( ) ; <nl> + File yamlFile = new File ( yamlPath ) ; <nl> + if ( yamlFile . exists ( ) ) <nl> + { <nl> + yamlPath = " file : / / / " + yamlFile . getAbsolutePath ( ) ; <nl> + } <nl> + <nl> + profile = StressProfile . load ( URI . create ( yamlPath ) ) ; <nl> <nl> if ( ratios . size ( ) = = 0 ) <nl> throw new IllegalArgumentException ( " Must specify at least one command with a non - zero ratio " ) ;
NEAREST DIFF (one line): ELIMINATEDSENTENCE

TEST DIFF:
diff - - git a / tools / stress / src / org / apache / cassandra / stress / StressProfile . java b / tools / stress / src / org / apache / cassandra / stress / StressProfile . java 
 index b0a149c . . 76642be 100644 
 - - - a / tools / stress / src / org / apache / cassandra / stress / StressProfile . java 
 + + + b / tools / stress / src / org / apache / cassandra / stress / StressProfile . java 
 @ @ - 68 , 11 + 68 , 9 @ @ import org . yaml . snakeyaml . Yaml ; 
 import org . yaml . snakeyaml . constructor . Constructor ; 
 import org . yaml . snakeyaml . error . YAMLException ; 
 
 - import java . io . ByteArrayInputStream ; 
 - import java . io . File ; 
 - import java . io . IOError ; 
 - import java . io . IOException ; 
 - import java . io . Serializable ; 
 + import java . io . * ; 
 + import java . net . URI ; 
 + import java . net . URL ; 
 import java . nio . file . Files ; 
 import java . nio . file . Paths ; 
 import java . util . ArrayList ; 
 @ @ - 524 , 17 + 522 , 20 @ @ public class StressProfile implements Serializable 
 } 
 } 
 
 - public static StressProfile load ( File file ) throws IOError 
 + public static StressProfile load ( URI file ) throws IOError 
 { 
 try 
 { 
 - byte [ ] profileBytes = Files . readAllBytes ( Paths . get ( file . toURI ( ) ) ) ; 
 - 
 Constructor constructor = new Constructor ( StressYaml . class ) ; 
 
 Yaml yaml = new Yaml ( constructor ) ; 
 
 - StressYaml profileYaml = yaml . loadAs ( new ByteArrayInputStream ( profileBytes ) , StressYaml . class ) ; 
 + InputStream yamlStream = file . toURL ( ) . openStream ( ) ; 
 + 
 + if ( yamlStream . available ( ) = = 0 ) 
 + throw new IOException ( " Unable to load yaml file from : " + file ) ; 
 + 
 + StressYaml profileYaml = yaml . loadAs ( yamlStream , StressYaml . class ) ; 
 
 StressProfile profile = new StressProfile ( ) ; 
 profile . init ( profileYaml ) ; 
 diff - - git a / tools / stress / src / org / apache / cassandra / stress / settings / SettingsCommandUser . java b / tools / stress / src / org / apache / cassandra / stress / settings / SettingsCommandUser . java 
 index a6dad35 . . 4e2997f 100644 
 - - - a / tools / stress / src / org / apache / cassandra / stress / settings / SettingsCommandUser . java 
 + + + b / tools / stress / src / org / apache / cassandra / stress / settings / SettingsCommandUser . java 
 @ @ - 22 , 6 + 22 , 7 @ @ package org . apache . cassandra . stress . settings ; 
 
 
 import java . io . File ; 
 + import java . net . URI ; 
 import java . util . ArrayList ; 
 import java . util . Arrays ; 
 import java . util . Collections ; 
 @ @ - 58 , 7 + 59 , 15 @ @ public class SettingsCommandUser extends SettingsCommand 
 
 clustering = options . clustering . get ( ) ; 
 ratios = options . ops . ratios ( ) ; 
 - profile = StressProfile . load ( new File ( options . profile . value ( ) ) ) ; 
 + 
 + String yamlPath = options . profile . value ( ) ; 
 + File yamlFile = new File ( yamlPath ) ; 
 + if ( yamlFile . exists ( ) ) 
 + { 
 + yamlPath = " file : / / / " + yamlFile . getAbsolutePath ( ) ; 
 + } 
 + 
 + profile = StressProfile . load ( URI . create ( yamlPath ) ) ; 
 
 if ( ratios . size ( ) = = 0 ) 
 throw new IllegalArgumentException ( " Must specify at least one command with a non - zero ratio " ) ;

NEAREST DIFF:
ELIMINATEDSENTENCE
