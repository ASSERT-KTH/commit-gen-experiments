BLEU SCORE: 0.009055400496876965

TEST MSG: Fix heap size calculation on Windows
GENERATED MSG: Update CHANGES . txt and NEWS . txt for 0 . 8 . 1 release

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index 41ee6e5 . . eed2c09 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 4 , 6 + 4 , 7 @ @ <nl> * Don ' t fail streams on failure detector downs ( CASSANDRA - 3569 ) <nl> * Add optional keyspace to DROP INDEX statement ( CASSANDRA - 7314 ) <nl> * Reduce run time for CQL tests ( CASSANDRA - 7327 ) <nl> + * Fix heap size calculation on Windows ( CASSANDRA - 7352 ) <nl> Merged from 2 . 0 : <nl> * Add per - CF range read request latency metrics ( CASSANDRA - 7338 ) <nl> * Fix NPE in StreamTransferTask . createMessageForRetry ( ) ( CASSANDRA - 7323 ) <nl> diff - - git a / conf / cassandra - env . ps1 b / conf / cassandra - env . ps1 <nl> index b3f773f . . 3f64737 100644 <nl> - - - a / conf / cassandra - env . ps1 <nl> + + + b / conf / cassandra - env . ps1 <nl> @ @ - 67 , 7 + 67 , 7 @ @ Function CalculateHeapSizes <nl> <nl> $ memObject = Get - WMIObject - class win32 _ physicalmemory <nl> $ memory = ( $ memObject | Measure - Object Capacity - Sum ) . sum <nl> - $ memoryMB = $ memory / ( 1024 * 1024 ) <nl> + $ memoryMB = [ Math ] : : Truncate ( $ memory / ( 1024 * 1024 ) ) <nl> <nl> $ cpu = gwmi Win32 _ ComputerSystem | Select - Object NumberOfLogicalProcessors <nl> $ systemCores = $ cpu . NumberOfLogicalProcessors <nl> @ @ - 77 , 8 + 77 , 8 @ @ Function CalculateHeapSizes <nl> # calculate 1 / 2 ram and cap to 1024MB <nl> # calculate 1 / 4 ram and cap to 8192MB <nl> # pick the max <nl> - $ halfMem = $ memoryMB / 2 <nl> - $ quarterMem = $ halfMem / 2 <nl> + $ halfMem = [ Math ] : : Truncate ( $ memoryMB / 2 ) <nl> + $ quarterMem = [ Math ] : : Truncate ( $ halfMem / 2 ) <nl> <nl> if ( $ halfMem - gt 1024 ) <nl> { <nl> @ @ - 103 , 7 + 103 , 7 @ @ Function CalculateHeapSizes <nl> # Young gen : min ( max _ sensible _ per _ modern _ cpu _ core * num _ cores , 1 / 4 <nl> $ maxYGPerCore = 100 <nl> $ maxYGTotal = $ maxYGPerCore * $ systemCores <nl> - $ desiredYG = $ maxHeapMB / 4 <nl> + $ desiredYG = [ Math ] : : Truncate ( $ maxHeapMB / 4 ) <nl> <nl> if ( $ desiredYG - gt $ maxYGTotal ) <nl> {
NEAREST DIFF (one line): diff - - git a / build . xml b / build . xml <nl> index 8595743 . . 8b353e4 100644 <nl> - - - a / build . xml <nl> + + + b / build . xml <nl> @ @ - 25 , 8 + 25 , 8 @ @ <nl> < property name = " debuglevel " value = " source , lines , vars " / > <nl> <nl> < ! - - default version and SCM information ( we need the default SCM info as people may checkout with git - svn ) - - > <nl> - < property name = " base . version " value = " 0 . 8 . 0 " / > <nl> - < property name = " scm . default . path " value = " cassandra / branches / cassandra - 0 . 7 " / > <nl> + < property name = " base . version " value = " 0 . 8 . 1 " / > <nl> + < property name = " scm . default . path " value = " cassandra / branches / cassandra - 0 . 8 " / > <nl> < property name = " scm . default . connection " value = " scm : svn : http : / / svn . apache . org / repos / asf / $ { scm . default . path } " / > <nl> < property name = " scm . default . developerConnection " value = " scm : svn : https : / / svn . apache . org / repos / asf / $ { scm . default . path } " / > <nl> < property name = " scm . default . url " value = " http : / / svn . apache . org / viewvc / $ { scm . default . path } " / > <nl> diff - - git a / debian / changelog b / debian / changelog <nl> index fd4892a . . 9bb7f18 100644 <nl> - - - a / debian / changelog <nl> + + + b / debian / changelog <nl> @ @ - 1 , 3 + 1 , 9 @ @ <nl> + cassandra ( 0 . 8 . 1 ) unstable ; urgency = low <nl> + <nl> + * New release <nl> + <nl> + - - Sylvain Lebresne < slebresne @ apache . org > Thu , 16 Jun 2011 09 : 37 : 27 + 0200 <nl> + <nl> cassandra ( 0 . 8 . 0 ) unstable ; urgency = low <nl> <nl> * New release <nl> diff - - git a / src / java / org / apache / cassandra / db / EchoedRow . java b / src / java / org / apache / cassandra / db / EchoedRow . java <nl> index 4e464f9 . . c6d7231 100644 <nl> - - - a / src / java / org / apache / cassandra / db / EchoedRow . java <nl> + + + b / src / java / org / apache / cassandra / db / EchoedRow . java <nl> @ @ - 1 , 4 + 1 , 25 @ @ <nl> package org . apache . cassandra . db ; <nl> + / * <nl> + * <nl> + * Licensed to the Apache Software Foundation ( ASF ) under one <nl> + * or more contributor license agreements . See the NOTICE file <nl> + * distributed with this work for additional information <nl> + * regarding copyright ownership . The ASF licenses this file <nl> + * to you under the Apache License , Version 2 . 0 ( the <nl> + * " License " ) ; you may not use this file except in compliance <nl> + * with the License . You may obtain a copy of the License at <nl> + * <nl> + * http : / / www . apache . org / licenses / LICENSE - 2 . 0 <nl> + * <nl> + * Unless required by applicable law or agreed to in writing , <nl> + * software distributed under the License is distributed on an <nl> + * " AS IS " BASIS , WITHOUT WARRANTIES OR CONDITIONS OF ANY <nl> + * KIND , either express or implied . See the License for the <nl> + * specific language governing permissions and limitations <nl> + * under the License . <nl> + * <nl> + * / <nl> + <nl> <nl> import java . io . DataOutput ; <nl> import java . io . IOException ; <nl> diff - - git a / src / java / org / apache / cassandra / db / commitlog / CommitLogHeader . java b / src / java / org / apache / cassandra / db / commitlog / CommitLogHeader . java <nl> deleted file mode 100644 <nl> index e69de29 . . 0000000 <nl> diff - - git a / test / unit / org / apache / cassandra / locator / EC2SnitchTest . java b / test / unit / org / apache / cassandra / locator / EC2SnitchTest . java <nl> index 42af187 . . fad5e9e 100644 <nl> - - - a / test / unit / org / apache / cassandra / locator / EC2SnitchTest . java <nl> + + + b / test / unit / org / apache / cassandra / locator / EC2SnitchTest . java <nl> @ @ - 1 , 4 + 1 , 25 @ @ <nl> package org . apache . cassandra . locator ; <nl> + / * <nl> + * <nl> + * Licensed to the Apache Software Foundation ( ASF ) under one <nl> + * or more contributor license agreements . See the NOTICE file <nl> + * distributed with this work for additional information <nl> + * regarding copyright ownership . The ASF licenses this file <nl> + * to you under the Apache License , Version 2 . 0 ( the <nl> + * " License " ) ; you may not use this file except in compliance <nl> + * with the License . You may obtain a copy of the License at <nl> + * <nl> + * http : / / www . apache . org / licenses / LICENSE - 2 . 0 <nl> + * <nl> + * Unless required by applicable law or agreed to in writing , <nl> + * software distributed under the License is distributed on an <nl> + * " AS IS " BASIS , WITHOUT WARRANTIES OR CONDITIONS OF ANY <nl> + * KIND , either express or implied . See the License for the <nl> + * specific language governing permissions and limitations <nl> + * under the License . <nl> + * <nl> + * / <nl> + <nl> <nl> import static org . junit . Assert . assertEquals ; <nl>

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index 41ee6e5 . . eed2c09 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 4 , 6 + 4 , 7 @ @ 
 * Don ' t fail streams on failure detector downs ( CASSANDRA - 3569 ) 
 * Add optional keyspace to DROP INDEX statement ( CASSANDRA - 7314 ) 
 * Reduce run time for CQL tests ( CASSANDRA - 7327 ) 
 + * Fix heap size calculation on Windows ( CASSANDRA - 7352 ) 
 Merged from 2 . 0 : 
 * Add per - CF range read request latency metrics ( CASSANDRA - 7338 ) 
 * Fix NPE in StreamTransferTask . createMessageForRetry ( ) ( CASSANDRA - 7323 ) 
 diff - - git a / conf / cassandra - env . ps1 b / conf / cassandra - env . ps1 
 index b3f773f . . 3f64737 100644 
 - - - a / conf / cassandra - env . ps1 
 + + + b / conf / cassandra - env . ps1 
 @ @ - 67 , 7 + 67 , 7 @ @ Function CalculateHeapSizes 
 
 $ memObject = Get - WMIObject - class win32 _ physicalmemory 
 $ memory = ( $ memObject | Measure - Object Capacity - Sum ) . sum 
 - $ memoryMB = $ memory / ( 1024 * 1024 ) 
 + $ memoryMB = [ Math ] : : Truncate ( $ memory / ( 1024 * 1024 ) ) 
 
 $ cpu = gwmi Win32 _ ComputerSystem | Select - Object NumberOfLogicalProcessors 
 $ systemCores = $ cpu . NumberOfLogicalProcessors 
 @ @ - 77 , 8 + 77 , 8 @ @ Function CalculateHeapSizes 
 # calculate 1 / 2 ram and cap to 1024MB 
 # calculate 1 / 4 ram and cap to 8192MB 
 # pick the max 
 - $ halfMem = $ memoryMB / 2 
 - $ quarterMem = $ halfMem / 2 
 + $ halfMem = [ Math ] : : Truncate ( $ memoryMB / 2 ) 
 + $ quarterMem = [ Math ] : : Truncate ( $ halfMem / 2 ) 
 
 if ( $ halfMem - gt 1024 ) 
 { 
 @ @ - 103 , 7 + 103 , 7 @ @ Function CalculateHeapSizes 
 # Young gen : min ( max _ sensible _ per _ modern _ cpu _ core * num _ cores , 1 / 4 
 $ maxYGPerCore = 100 
 $ maxYGTotal = $ maxYGPerCore * $ systemCores 
 - $ desiredYG = $ maxHeapMB / 4 
 + $ desiredYG = [ Math ] : : Truncate ( $ maxHeapMB / 4 ) 
 
 if ( $ desiredYG - gt $ maxYGTotal ) 
 {

NEAREST DIFF:
diff - - git a / build . xml b / build . xml 
 index 8595743 . . 8b353e4 100644 
 - - - a / build . xml 
 + + + b / build . xml 
 @ @ - 25 , 8 + 25 , 8 @ @ 
 < property name = " debuglevel " value = " source , lines , vars " / > 
 
 < ! - - default version and SCM information ( we need the default SCM info as people may checkout with git - svn ) - - > 
 - < property name = " base . version " value = " 0 . 8 . 0 " / > 
 - < property name = " scm . default . path " value = " cassandra / branches / cassandra - 0 . 7 " / > 
 + < property name = " base . version " value = " 0 . 8 . 1 " / > 
 + < property name = " scm . default . path " value = " cassandra / branches / cassandra - 0 . 8 " / > 
 < property name = " scm . default . connection " value = " scm : svn : http : / / svn . apache . org / repos / asf / $ { scm . default . path } " / > 
 < property name = " scm . default . developerConnection " value = " scm : svn : https : / / svn . apache . org / repos / asf / $ { scm . default . path } " / > 
 < property name = " scm . default . url " value = " http : / / svn . apache . org / viewvc / $ { scm . default . path } " / > 
 diff - - git a / debian / changelog b / debian / changelog 
 index fd4892a . . 9bb7f18 100644 
 - - - a / debian / changelog 
 + + + b / debian / changelog 
 @ @ - 1 , 3 + 1 , 9 @ @ 
 + cassandra ( 0 . 8 . 1 ) unstable ; urgency = low 
 + 
 + * New release 
 + 
 + - - Sylvain Lebresne < slebresne @ apache . org > Thu , 16 Jun 2011 09 : 37 : 27 + 0200 
 + 
 cassandra ( 0 . 8 . 0 ) unstable ; urgency = low 
 
 * New release 
 diff - - git a / src / java / org / apache / cassandra / db / EchoedRow . java b / src / java / org / apache / cassandra / db / EchoedRow . java 
 index 4e464f9 . . c6d7231 100644 
 - - - a / src / java / org / apache / cassandra / db / EchoedRow . java 
 + + + b / src / java / org / apache / cassandra / db / EchoedRow . java 
 @ @ - 1 , 4 + 1 , 25 @ @ 
 package org . apache . cassandra . db ; 
 + / * 
 + * 
 + * Licensed to the Apache Software Foundation ( ASF ) under one 
 + * or more contributor license agreements . See the NOTICE file 
 + * distributed with this work for additional information 
 + * regarding copyright ownership . The ASF licenses this file 
 + * to you under the Apache License , Version 2 . 0 ( the 
 + * " License " ) ; you may not use this file except in compliance 
 + * with the License . You may obtain a copy of the License at 
 + * 
 + * http : / / www . apache . org / licenses / LICENSE - 2 . 0 
 + * 
 + * Unless required by applicable law or agreed to in writing , 
 + * software distributed under the License is distributed on an 
 + * " AS IS " BASIS , WITHOUT WARRANTIES OR CONDITIONS OF ANY 
 + * KIND , either express or implied . See the License for the 
 + * specific language governing permissions and limitations 
 + * under the License . 
 + * 
 + * / 
 + 
 
 import java . io . DataOutput ; 
 import java . io . IOException ; 
 diff - - git a / src / java / org / apache / cassandra / db / commitlog / CommitLogHeader . java b / src / java / org / apache / cassandra / db / commitlog / CommitLogHeader . java 
 deleted file mode 100644 
 index e69de29 . . 0000000 
 diff - - git a / test / unit / org / apache / cassandra / locator / EC2SnitchTest . java b / test / unit / org / apache / cassandra / locator / EC2SnitchTest . java 
 index 42af187 . . fad5e9e 100644 
 - - - a / test / unit / org / apache / cassandra / locator / EC2SnitchTest . java 
 + + + b / test / unit / org / apache / cassandra / locator / EC2SnitchTest . java 
 @ @ - 1 , 4 + 1 , 25 @ @ 
 package org . apache . cassandra . locator ; 
 + / * 
 + * 
 + * Licensed to the Apache Software Foundation ( ASF ) under one 
 + * or more contributor license agreements . See the NOTICE file 
 + * distributed with this work for additional information 
 + * regarding copyright ownership . The ASF licenses this file 
 + * to you under the Apache License , Version 2 . 0 ( the 
 + * " License " ) ; you may not use this file except in compliance 
 + * with the License . You may obtain a copy of the License at 
 + * 
 + * http : / / www . apache . org / licenses / LICENSE - 2 . 0 
 + * 
 + * Unless required by applicable law or agreed to in writing , 
 + * software distributed under the License is distributed on an 
 + * " AS IS " BASIS , WITHOUT WARRANTIES OR CONDITIONS OF ANY 
 + * KIND , either express or implied . See the License for the 
 + * specific language governing permissions and limitations 
 + * under the License . 
 + * 
 + * / 
 + 
 
 import static org . junit . Assert . assertEquals ; 

