BLEU SCORE: 0.0043542900280071906

TEST MSG: Fix double division and rounding
GENERATED MSG: track coordinator latency and use that instead of local for read speculation ; fix round - trip of percentile through string

TEST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / metrics / DecayingEstimatedHistogramReservoir . java b / src / java / org / apache / cassandra / metrics / DecayingEstimatedHistogramReservoir . java <nl> index 38dc5a4 . . d0e550e 100644 <nl> - - - a / src / java / org / apache / cassandra / metrics / DecayingEstimatedHistogramReservoir . java <nl> + + + b / src / java / org / apache / cassandra / metrics / DecayingEstimatedHistogramReservoir . java <nl> @ @ - 178 , 7 + 178 , 7 @ @ public class DecayingEstimatedHistogramReservoir implements Reservoir <nl> <nl> try <nl> { <nl> - decayingBuckets . getAndAdd ( index , forwardDecayWeight ( now ) ) ; <nl> + decayingBuckets . getAndAdd ( index , Math . round ( forwardDecayWeight ( now ) ) ) ; <nl> } <nl> finally <nl> { <nl> @ @ - 188 , 9 + 188 , 9 @ @ public class DecayingEstimatedHistogramReservoir implements Reservoir <nl> buckets . getAndIncrement ( index ) ; <nl> } <nl> <nl> - private long forwardDecayWeight ( long now ) <nl> + private double forwardDecayWeight ( long now ) <nl> { <nl> - return Math . round ( Math . exp ( ( ( now - decayLandmark ) / 1000L ) / MEAN _ LIFETIME _ IN _ S ) ) ; <nl> + return Math . exp ( ( ( now - decayLandmark ) / 1000L ) / MEAN _ LIFETIME _ IN _ S ) ; <nl> } <nl> <nl> / * * <nl> @ @ - 269 , 7 + 269 , 7 @ @ public class DecayingEstimatedHistogramReservoir implements Reservoir <nl> <nl> try <nl> { <nl> - final long rescaleFactor = forwardDecayWeight ( now ) ; <nl> + final double rescaleFactor = forwardDecayWeight ( now ) ; <nl> decayLandmark = now ; <nl> <nl> final int bucketCount = decayingBuckets . length ( ) ;
NEAREST DIFF (one line): diff - - git a / NEWS . txt b / NEWS . txt <nl> index fc257f4 . . 1f76277 100644 <nl> - - - a / NEWS . txt <nl> + + + b / NEWS . txt <nl> @ @ - 13 , 6 + 13 , 16 @ @ restore snapshots created with the previous major version using the <nl> ' sstableloader ' tool . You can upgrade the file format of your snapshots <nl> using the provided ' sstableupgrade ' tool . <nl> <nl> + <nl> + 2 . 0 . 2 <nl> + = = = = = <nl> + <nl> + New features <nl> + - - - - - - - - - - - - <nl> + - Speculative retry defaults to 99th percentile <nl> + ( See blog post at TODO ) <nl> + <nl> + <nl> 2 . 0 . 1 <nl> = = = = = <nl> <nl> diff - - git a / src / java / org / apache / cassandra / config / CFMetaData . java b / src / java / org / apache / cassandra / config / CFMetaData . java <nl> index 51865c2 . . 8c4075c 100644 <nl> - - - a / src / java / org / apache / cassandra / config / CFMetaData . java <nl> + + + b / src / java / org / apache / cassandra / config / CFMetaData . java <nl> @ @ - 83 , 7 + 83 , 7 @ @ public final class CFMetaData <nl> public final static Class < ? extends AbstractCompactionStrategy > DEFAULT _ COMPACTION _ STRATEGY _ CLASS = SizeTieredCompactionStrategy . class ; <nl> public final static Caching DEFAULT _ CACHING _ STRATEGY = Caching . KEYS _ ONLY ; <nl> public final static int DEFAULT _ DEFAULT _ TIME _ TO _ LIVE = 0 ; <nl> - public final static SpeculativeRetry DEFAULT _ SPECULATIVE _ RETRY = new SpeculativeRetry ( SpeculativeRetry . RetryType . NONE , 0 ) ; <nl> + public final static SpeculativeRetry DEFAULT _ SPECULATIVE _ RETRY = new SpeculativeRetry ( SpeculativeRetry . RetryType . PERCENTILE , 0 . 99 ) ; <nl> public final static int DEFAULT _ INDEX _ INTERVAL = 128 ; <nl> public final static boolean DEFAULT _ POPULATE _ IO _ CACHE _ ON _ FLUSH = false ; <nl>

TEST DIFF:
diff - - git a / src / java / org / apache / cassandra / metrics / DecayingEstimatedHistogramReservoir . java b / src / java / org / apache / cassandra / metrics / DecayingEstimatedHistogramReservoir . java 
 index 38dc5a4 . . d0e550e 100644 
 - - - a / src / java / org / apache / cassandra / metrics / DecayingEstimatedHistogramReservoir . java 
 + + + b / src / java / org / apache / cassandra / metrics / DecayingEstimatedHistogramReservoir . java 
 @ @ - 178 , 7 + 178 , 7 @ @ public class DecayingEstimatedHistogramReservoir implements Reservoir 
 
 try 
 { 
 - decayingBuckets . getAndAdd ( index , forwardDecayWeight ( now ) ) ; 
 + decayingBuckets . getAndAdd ( index , Math . round ( forwardDecayWeight ( now ) ) ) ; 
 } 
 finally 
 { 
 @ @ - 188 , 9 + 188 , 9 @ @ public class DecayingEstimatedHistogramReservoir implements Reservoir 
 buckets . getAndIncrement ( index ) ; 
 } 
 
 - private long forwardDecayWeight ( long now ) 
 + private double forwardDecayWeight ( long now ) 
 { 
 - return Math . round ( Math . exp ( ( ( now - decayLandmark ) / 1000L ) / MEAN _ LIFETIME _ IN _ S ) ) ; 
 + return Math . exp ( ( ( now - decayLandmark ) / 1000L ) / MEAN _ LIFETIME _ IN _ S ) ; 
 } 
 
 / * * 
 @ @ - 269 , 7 + 269 , 7 @ @ public class DecayingEstimatedHistogramReservoir implements Reservoir 
 
 try 
 { 
 - final long rescaleFactor = forwardDecayWeight ( now ) ; 
 + final double rescaleFactor = forwardDecayWeight ( now ) ; 
 decayLandmark = now ; 
 
 final int bucketCount = decayingBuckets . length ( ) ;

NEAREST DIFF:
diff - - git a / NEWS . txt b / NEWS . txt 
 index fc257f4 . . 1f76277 100644 
 - - - a / NEWS . txt 
 + + + b / NEWS . txt 
 @ @ - 13 , 6 + 13 , 16 @ @ restore snapshots created with the previous major version using the 
 ' sstableloader ' tool . You can upgrade the file format of your snapshots 
 using the provided ' sstableupgrade ' tool . 
 
 + 
 + 2 . 0 . 2 
 + = = = = = 
 + 
 + New features 
 + - - - - - - - - - - - - 
 + - Speculative retry defaults to 99th percentile 
 + ( See blog post at TODO ) 
 + 
 + 
 2 . 0 . 1 
 = = = = = 
 
 diff - - git a / src / java / org / apache / cassandra / config / CFMetaData . java b / src / java / org / apache / cassandra / config / CFMetaData . java 
 index 51865c2 . . 8c4075c 100644 
 - - - a / src / java / org / apache / cassandra / config / CFMetaData . java 
 + + + b / src / java / org / apache / cassandra / config / CFMetaData . java 
 @ @ - 83 , 7 + 83 , 7 @ @ public final class CFMetaData 
 public final static Class < ? extends AbstractCompactionStrategy > DEFAULT _ COMPACTION _ STRATEGY _ CLASS = SizeTieredCompactionStrategy . class ; 
 public final static Caching DEFAULT _ CACHING _ STRATEGY = Caching . KEYS _ ONLY ; 
 public final static int DEFAULT _ DEFAULT _ TIME _ TO _ LIVE = 0 ; 
 - public final static SpeculativeRetry DEFAULT _ SPECULATIVE _ RETRY = new SpeculativeRetry ( SpeculativeRetry . RetryType . NONE , 0 ) ; 
 + public final static SpeculativeRetry DEFAULT _ SPECULATIVE _ RETRY = new SpeculativeRetry ( SpeculativeRetry . RetryType . PERCENTILE , 0 . 99 ) ; 
 public final static int DEFAULT _ INDEX _ INTERVAL = 128 ; 
 public final static boolean DEFAULT _ POPULATE _ IO _ CACHE _ ON _ FLUSH = false ; 

