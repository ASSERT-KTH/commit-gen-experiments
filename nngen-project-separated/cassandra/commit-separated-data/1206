BLEU SCORE: 0.011246923682765546

TEST MSG: Fix failing DeleteTest
GENERATED MSG: Workaround for netty issue causing corrupted data to come off the wire

TEST DIFF (one line): diff - - git a / test / unit / org / apache / cassandra / cql3 / DeleteTest . java b / test / unit / org / apache / cassandra / cql3 / DeleteTest . java <nl> index 0b88586 . . 3c95a6c 100644 <nl> - - - a / test / unit / org / apache / cassandra / cql3 / DeleteTest . java <nl> + + + b / test / unit / org / apache / cassandra / cql3 / DeleteTest . java <nl> @ @ - 17 , 27 + 17 , 17 @ @ <nl> * / <nl> package org . apache . cassandra . cql3 ; <nl> <nl> - <nl> - import org . junit . AfterClass ; <nl> import org . junit . Assert ; <nl> - import org . junit . BeforeClass ; <nl> + import org . junit . Before ; <nl> import org . junit . Test ; <nl> <nl> - import com . datastax . driver . core . Cluster ; <nl> + import com . datastax . driver . core . ConsistencyLevel ; <nl> import com . datastax . driver . core . PreparedStatement ; <nl> import com . datastax . driver . core . ResultSetFuture ; <nl> import com . datastax . driver . core . Session ; <nl> - import org . apache . cassandra . SchemaLoader ; <nl> - import org . apache . cassandra . config . DatabaseDescriptor ; <nl> - import org . apache . cassandra . config . Schema ; <nl> - import org . apache . cassandra . service . EmbeddedCassandraService ; <nl> <nl> - public class DeleteTest extends SchemaLoader <nl> + public class DeleteTest extends CQLTester <nl> { <nl> - private static EmbeddedCassandraService cassandra ; <nl> - <nl> - private static Cluster cluster ; <nl> - private static Session session ; <nl> private static PreparedStatement pstmtI ; <nl> private static PreparedStatement pstmtU ; <nl> private static PreparedStatement pstmtD ; <nl> @ @ - 47 , 16 + 37 , 13 @ @ public class DeleteTest extends SchemaLoader <nl> private static PreparedStatement pstmt4 ; <nl> private static PreparedStatement pstmt5 ; <nl> <nl> - @ BeforeClass <nl> - public static void setup ( ) throws Exception <nl> + @ Before <nl> + public void prepare ( ) throws Exception <nl> { <nl> - Schema . instance . clear ( ) ; <nl> + / / Schema . instance . clear ( ) ; <nl> <nl> - cassandra = new EmbeddedCassandraService ( ) ; <nl> - cassandra . start ( ) ; <nl> - <nl> - cluster = Cluster . builder ( ) . addContactPoint ( " 127 . 0 . 0 . 1 " ) . withPort ( DatabaseDescriptor . getNativeTransportPort ( ) ) . build ( ) ; <nl> - session = cluster . connect ( ) ; <nl> + Session session = sessionNet ( ) ; <nl> + session . getCluster ( ) . getConfiguration ( ) . getQueryOptions ( ) . setConsistencyLevel ( ConsistencyLevel . ONE ) ; <nl> <nl> session . execute ( " drop keyspace if exists junit ; " ) ; <nl> session . execute ( " create keyspace junit WITH REPLICATION = { ' class ' : ' SimpleStrategy ' , ' replication _ factor ' : 2 } ; " ) ; <nl> @ @ - 106 , 15 + 93 , 10 @ @ public class DeleteTest extends SchemaLoader <nl> pstmt5 = session . prepare ( " select id , cid , inh _ c , val from junit . tpc _ inherit _ c where id = ? and cid = ? " ) ; <nl> } <nl> <nl> - @ AfterClass <nl> - public static void tearDown ( ) throws Exception <nl> - { <nl> - cluster . close ( ) ; <nl> - } <nl> - <nl> @ Test <nl> public void lostDeletesTest ( ) <nl> { <nl> + Session session = sessionNet ( ) ; <nl> <nl> for ( int i = 0 ; i < 500 ; i + + ) <nl> { <nl> @ @ - 151 , 6 + 133 , 8 @ @ public class DeleteTest extends SchemaLoader <nl> } <nl> <nl> private ResultSetFuture [ ] load ( ) { <nl> + Session session = sessionNet ( ) ; <nl> + <nl> return new ResultSetFuture [ ] { <nl> session . executeAsync ( pstmt1 . bind ( 1 , 1 ) ) , <nl> session . executeAsync ( pstmt2 . bind ( 1 , 1 ) ) ,
NEAREST DIFF (one line): ELIMINATEDSENTENCE

TEST DIFF:
diff - - git a / test / unit / org / apache / cassandra / cql3 / DeleteTest . java b / test / unit / org / apache / cassandra / cql3 / DeleteTest . java 
 index 0b88586 . . 3c95a6c 100644 
 - - - a / test / unit / org / apache / cassandra / cql3 / DeleteTest . java 
 + + + b / test / unit / org / apache / cassandra / cql3 / DeleteTest . java 
 @ @ - 17 , 27 + 17 , 17 @ @ 
 * / 
 package org . apache . cassandra . cql3 ; 
 
 - 
 - import org . junit . AfterClass ; 
 import org . junit . Assert ; 
 - import org . junit . BeforeClass ; 
 + import org . junit . Before ; 
 import org . junit . Test ; 
 
 - import com . datastax . driver . core . Cluster ; 
 + import com . datastax . driver . core . ConsistencyLevel ; 
 import com . datastax . driver . core . PreparedStatement ; 
 import com . datastax . driver . core . ResultSetFuture ; 
 import com . datastax . driver . core . Session ; 
 - import org . apache . cassandra . SchemaLoader ; 
 - import org . apache . cassandra . config . DatabaseDescriptor ; 
 - import org . apache . cassandra . config . Schema ; 
 - import org . apache . cassandra . service . EmbeddedCassandraService ; 
 
 - public class DeleteTest extends SchemaLoader 
 + public class DeleteTest extends CQLTester 
 { 
 - private static EmbeddedCassandraService cassandra ; 
 - 
 - private static Cluster cluster ; 
 - private static Session session ; 
 private static PreparedStatement pstmtI ; 
 private static PreparedStatement pstmtU ; 
 private static PreparedStatement pstmtD ; 
 @ @ - 47 , 16 + 37 , 13 @ @ public class DeleteTest extends SchemaLoader 
 private static PreparedStatement pstmt4 ; 
 private static PreparedStatement pstmt5 ; 
 
 - @ BeforeClass 
 - public static void setup ( ) throws Exception 
 + @ Before 
 + public void prepare ( ) throws Exception 
 { 
 - Schema . instance . clear ( ) ; 
 + / / Schema . instance . clear ( ) ; 
 
 - cassandra = new EmbeddedCassandraService ( ) ; 
 - cassandra . start ( ) ; 
 - 
 - cluster = Cluster . builder ( ) . addContactPoint ( " 127 . 0 . 0 . 1 " ) . withPort ( DatabaseDescriptor . getNativeTransportPort ( ) ) . build ( ) ; 
 - session = cluster . connect ( ) ; 
 + Session session = sessionNet ( ) ; 
 + session . getCluster ( ) . getConfiguration ( ) . getQueryOptions ( ) . setConsistencyLevel ( ConsistencyLevel . ONE ) ; 
 
 session . execute ( " drop keyspace if exists junit ; " ) ; 
 session . execute ( " create keyspace junit WITH REPLICATION = { ' class ' : ' SimpleStrategy ' , ' replication _ factor ' : 2 } ; " ) ; 
 @ @ - 106 , 15 + 93 , 10 @ @ public class DeleteTest extends SchemaLoader 
 pstmt5 = session . prepare ( " select id , cid , inh _ c , val from junit . tpc _ inherit _ c where id = ? and cid = ? " ) ; 
 } 
 
 - @ AfterClass 
 - public static void tearDown ( ) throws Exception 
 - { 
 - cluster . close ( ) ; 
 - } 
 - 
 @ Test 
 public void lostDeletesTest ( ) 
 { 
 + Session session = sessionNet ( ) ; 
 
 for ( int i = 0 ; i < 500 ; i + + ) 
 { 
 @ @ - 151 , 6 + 133 , 8 @ @ public class DeleteTest extends SchemaLoader 
 } 
 
 private ResultSetFuture [ ] load ( ) { 
 + Session session = sessionNet ( ) ; 
 + 
 return new ResultSetFuture [ ] { 
 session . executeAsync ( pstmt1 . bind ( 1 , 1 ) ) , 
 session . executeAsync ( pstmt2 . bind ( 1 , 1 ) ) ,

NEAREST DIFF:
ELIMINATEDSENTENCE
