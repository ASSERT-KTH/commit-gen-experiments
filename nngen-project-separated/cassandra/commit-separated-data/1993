BLEU SCORE: 0.02383853510228548

TEST MSG: Fix incremental repair not remove parent session on remote
GENERATED MSG: Add ' nodetool statusgossip '

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index 1910f31 . . 6caa5c7 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 2 , 6 + 2 , 7 @ @ <nl> * Support for frozen collections ( CASSANDRA - 7859 ) <nl> * Fix overflow on histogram computation ( CASSANDRA - 8028 ) <nl> * Have paxos reuse the timestamp generation of normal queries ( CASSANDRA - 7801 ) <nl> + * Fix incremental repair not remove parent session on remote ( CASSANDRA - 8291 ) <nl> Merged from 2 . 0 : <nl> * Disable SSLv3 for POODLE ( CASSANDRA - 8265 ) <nl> * Fix millisecond timestamps in Tracing ( CASSANDRA - 8297 ) <nl> diff - - git a / src / java / org / apache / cassandra / repair / RepairMessageVerbHandler . java b / src / java / org / apache / cassandra / repair / RepairMessageVerbHandler . java <nl> index 54117a3 . . 141e4c7 100644 <nl> - - - a / src / java / org / apache / cassandra / repair / RepairMessageVerbHandler . java <nl> + + + b / src / java / org / apache / cassandra / repair / RepairMessageVerbHandler . java <nl> @ @ - 119 , 6 + 119 , 10 @ @ public class RepairMessageVerbHandler implements IVerbHandler < RepairMessage > <nl> { <nl> throw new RuntimeException ( e ) ; <nl> } <nl> + finally <nl> + { <nl> + ActiveRepairService . instance . removeParentRepairSession ( anticompactionRequest . parentRepairSession ) ; <nl> + } <nl> <nl> break ; <nl> <nl> diff - - git a / src / java / org / apache / cassandra / service / ActiveRepairService . java b / src / java / org / apache / cassandra / service / ActiveRepairService . java <nl> index 35a86f6 . . 68c2fae 100644 <nl> - - - a / src / java / org / apache / cassandra / service / ActiveRepairService . java <nl> + + + b / src / java / org / apache / cassandra / service / ActiveRepairService . java <nl> @ @ - 343 , 6 + 343 , 11 @ @ public class ActiveRepairService <nl> return parentRepairSessions . get ( parentSessionId ) ; <nl> } <nl> <nl> + public ParentRepairSession removeParentRepairSession ( UUID parentSessionId ) <nl> + { <nl> + return parentRepairSessions . remove ( parentSessionId ) ; <nl> + } <nl> + <nl> public List < Future < ? > > doAntiCompaction ( UUID parentRepairSession ) throws InterruptedException , ExecutionException , IOException <nl> { <nl> assert parentRepairSession ! = null ;
NEAREST DIFF (one line): ELIMINATEDSENTENCE

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index 1910f31 . . 6caa5c7 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 2 , 6 + 2 , 7 @ @ 
 * Support for frozen collections ( CASSANDRA - 7859 ) 
 * Fix overflow on histogram computation ( CASSANDRA - 8028 ) 
 * Have paxos reuse the timestamp generation of normal queries ( CASSANDRA - 7801 ) 
 + * Fix incremental repair not remove parent session on remote ( CASSANDRA - 8291 ) 
 Merged from 2 . 0 : 
 * Disable SSLv3 for POODLE ( CASSANDRA - 8265 ) 
 * Fix millisecond timestamps in Tracing ( CASSANDRA - 8297 ) 
 diff - - git a / src / java / org / apache / cassandra / repair / RepairMessageVerbHandler . java b / src / java / org / apache / cassandra / repair / RepairMessageVerbHandler . java 
 index 54117a3 . . 141e4c7 100644 
 - - - a / src / java / org / apache / cassandra / repair / RepairMessageVerbHandler . java 
 + + + b / src / java / org / apache / cassandra / repair / RepairMessageVerbHandler . java 
 @ @ - 119 , 6 + 119 , 10 @ @ public class RepairMessageVerbHandler implements IVerbHandler < RepairMessage > 
 { 
 throw new RuntimeException ( e ) ; 
 } 
 + finally 
 + { 
 + ActiveRepairService . instance . removeParentRepairSession ( anticompactionRequest . parentRepairSession ) ; 
 + } 
 
 break ; 
 
 diff - - git a / src / java / org / apache / cassandra / service / ActiveRepairService . java b / src / java / org / apache / cassandra / service / ActiveRepairService . java 
 index 35a86f6 . . 68c2fae 100644 
 - - - a / src / java / org / apache / cassandra / service / ActiveRepairService . java 
 + + + b / src / java / org / apache / cassandra / service / ActiveRepairService . java 
 @ @ - 343 , 6 + 343 , 11 @ @ public class ActiveRepairService 
 return parentRepairSessions . get ( parentSessionId ) ; 
 } 
 
 + public ParentRepairSession removeParentRepairSession ( UUID parentSessionId ) 
 + { 
 + return parentRepairSessions . remove ( parentSessionId ) ; 
 + } 
 + 
 public List < Future < ? > > doAntiCompaction ( UUID parentRepairSession ) throws InterruptedException , ExecutionException , IOException 
 { 
 assert parentRepairSession ! = null ;

NEAREST DIFF:
ELIMINATEDSENTENCE
