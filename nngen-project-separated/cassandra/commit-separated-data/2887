BLEU SCORE: 0.024675789207681903

TEST MSG: fix stats to omit purged row tombstone
GENERATED MSG: avoid re - using Message object in index queries

TEST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / db / compaction / LazilyCompactedRow . java b / src / java / org / apache / cassandra / db / compaction / LazilyCompactedRow . java <nl> index 0d33b22 . . 0ad3de2 100644 <nl> - - - a / src / java / org / apache / cassandra / db / compaction / LazilyCompactedRow . java <nl> + + + b / src / java / org / apache / cassandra / db / compaction / LazilyCompactedRow . java <nl> @ @ - 112 , 7 + 112 , 7 @ @ public class LazilyCompactedRow extends AbstractCompactedRow implements Iterable <nl> / / ( however , if there are zero columns , iterator ( ) will not be called by ColumnIndexer and reducer will be null ) <nl> columnStats = new ColumnStats ( reducer = = null ? 0 : reducer . columns , <nl> reducer = = null ? Long . MAX _ VALUE : reducer . minTimestampSeen , <nl> - reducer = = null ? maxRowTombstone . markedForDeleteAt : Math . max ( maxRowTombstone . markedForDeleteAt , reducer . maxTimestampSeen ) , <nl> + reducer = = null ? emptyColumnFamily . maxTimestamp ( ) : Math . max ( emptyColumnFamily . maxTimestamp ( ) , reducer . maxTimestampSeen ) , <nl> reducer = = null ? Integer . MIN _ VALUE : reducer . maxLocalDeletionTimeSeen , <nl> reducer = = null ? new StreamingHistogram ( SSTable . TOMBSTONE _ HISTOGRAM _ BIN _ SIZE ) : reducer . tombstones , <nl> reducer = = null ? Collections . < ByteBuffer > emptyList ( ) : reducer . minColumnNameSeen ,
NEAREST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / service / StorageProxy . java b / src / java / org / apache / cassandra / service / StorageProxy . java <nl> index 3e475d5 . . 1e4b45d 100644 <nl> - - - a / src / java / org / apache / cassandra / service / StorageProxy . java <nl> + + + b / src / java / org / apache / cassandra / service / StorageProxy . java <nl> @ @ - 144 , 7 + 144 , 7 @ @ public class StorageProxy implements StorageProxyMBean <nl> / / unhinted writes <nl> if ( destination . equals ( FBUtilities . getLocalAddress ( ) ) ) <nl> { <nl> - insertLocalMessage ( rm , responseHandler ) ; <nl> + insertLocal ( rm , responseHandler ) ; <nl> } <nl> else <nl> { <nl> @ @ - 277 , 7 + 277 , 7 @ @ public class StorageProxy implements StorageProxyMBean <nl> message . setHeader ( RowMutation . HINT , bos . toByteArray ( ) ) ; <nl> } <nl> <nl> - private static void insertLocalMessage ( final RowMutation rm , final IWriteResponseHandler responseHandler ) <nl> + private static void insertLocal ( final RowMutation rm , final IWriteResponseHandler responseHandler ) <nl> { <nl> if ( logger . isDebugEnabled ( ) ) <nl> logger . debug ( " insert writing local " + rm . toString ( true ) ) ;

TEST DIFF:
diff - - git a / src / java / org / apache / cassandra / db / compaction / LazilyCompactedRow . java b / src / java / org / apache / cassandra / db / compaction / LazilyCompactedRow . java 
 index 0d33b22 . . 0ad3de2 100644 
 - - - a / src / java / org / apache / cassandra / db / compaction / LazilyCompactedRow . java 
 + + + b / src / java / org / apache / cassandra / db / compaction / LazilyCompactedRow . java 
 @ @ - 112 , 7 + 112 , 7 @ @ public class LazilyCompactedRow extends AbstractCompactedRow implements Iterable 
 / / ( however , if there are zero columns , iterator ( ) will not be called by ColumnIndexer and reducer will be null ) 
 columnStats = new ColumnStats ( reducer = = null ? 0 : reducer . columns , 
 reducer = = null ? Long . MAX _ VALUE : reducer . minTimestampSeen , 
 - reducer = = null ? maxRowTombstone . markedForDeleteAt : Math . max ( maxRowTombstone . markedForDeleteAt , reducer . maxTimestampSeen ) , 
 + reducer = = null ? emptyColumnFamily . maxTimestamp ( ) : Math . max ( emptyColumnFamily . maxTimestamp ( ) , reducer . maxTimestampSeen ) , 
 reducer = = null ? Integer . MIN _ VALUE : reducer . maxLocalDeletionTimeSeen , 
 reducer = = null ? new StreamingHistogram ( SSTable . TOMBSTONE _ HISTOGRAM _ BIN _ SIZE ) : reducer . tombstones , 
 reducer = = null ? Collections . < ByteBuffer > emptyList ( ) : reducer . minColumnNameSeen ,

NEAREST DIFF:
diff - - git a / src / java / org / apache / cassandra / service / StorageProxy . java b / src / java / org / apache / cassandra / service / StorageProxy . java 
 index 3e475d5 . . 1e4b45d 100644 
 - - - a / src / java / org / apache / cassandra / service / StorageProxy . java 
 + + + b / src / java / org / apache / cassandra / service / StorageProxy . java 
 @ @ - 144 , 7 + 144 , 7 @ @ public class StorageProxy implements StorageProxyMBean 
 / / unhinted writes 
 if ( destination . equals ( FBUtilities . getLocalAddress ( ) ) ) 
 { 
 - insertLocalMessage ( rm , responseHandler ) ; 
 + insertLocal ( rm , responseHandler ) ; 
 } 
 else 
 { 
 @ @ - 277 , 7 + 277 , 7 @ @ public class StorageProxy implements StorageProxyMBean 
 message . setHeader ( RowMutation . HINT , bos . toByteArray ( ) ) ; 
 } 
 
 - private static void insertLocalMessage ( final RowMutation rm , final IWriteResponseHandler responseHandler ) 
 + private static void insertLocal ( final RowMutation rm , final IWriteResponseHandler responseHandler ) 
 { 
 if ( logger . isDebugEnabled ( ) ) 
 logger . debug ( " insert writing local " + rm . toString ( true ) ) ;
