BLEU SCORE: 0.05795599612995367

TEST MSG: Fix Distribution . average in cassandra - stress
GENERATED MSG: Make stress . java insert operation to use microseconds

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index 51f8961 . . f3f552c 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 1 , 4 + 1 , 5 @ @ <nl> 4 . 0 <nl> + * Fix Distribution . average in cassandra - stress ( CASSANDRA - 14090 ) <nl> * Support a means of logging all queries as they were invoked ( CASSANDRA - 13983 ) <nl> * Presize collections ( CASSANDRA - 13760 ) <nl> * Add GroupCommitLogService ( CASSANDRA - 13530 ) <nl> diff - - git a / tools / stress / src / org / apache / cassandra / stress / generate / Distribution . java b / tools / stress / src / org / apache / cassandra / stress / generate / Distribution . java <nl> index 0100006 . . 30efd34 100644 <nl> - - - a / tools / stress / src / org / apache / cassandra / stress / generate / Distribution . java <nl> + + + b / tools / stress / src / org / apache / cassandra / stress / generate / Distribution . java <nl> @ @ - 46 , 7 + 46 , 7 @ @ public abstract class Distribution implements Serializable <nl> { <nl> double sum = 0 ; <nl> double d = 0d ; <nl> - for ( int count = 0 ; count < 51 ; count + + ) <nl> + for ( int count = 0 ; count < 50 ; count + + ) <nl> { <nl> sum + = inverseCumProb ( d ) ; <nl> d + = 0 . 02d ;
NEAREST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / net / MessagingService . java b / src / java / org / apache / cassandra / net / MessagingService . java <nl> index 9ff110e . . 99037a1 100644 <nl> - - - a / src / java / org / apache / cassandra / net / MessagingService . java <nl> + + + b / src / java / org / apache / cassandra / net / MessagingService . java <nl> @ @ - 482 , 7 + 482 , 21 @ @ public final class MessagingService implements MessagingServiceMBean <nl> logger _ . info ( " Waiting for messaging service to quiesce " ) ; <nl> / / We may need to schedule hints on the mutation stage , so it ' s erroneous to shut down the mutation stage first <nl> assert ! StageManager . getStage ( Stage . MUTATION ) . isShutdown ( ) ; <nl> + <nl> + / / the important part <nl> callbacks . shutdown ( ) ; <nl> + <nl> + / / attempt to humor tests that try to stop and restart MS <nl> + try <nl> + { <nl> + for ( SocketThread th : socketThreads ) <nl> + th . close ( ) ; <nl> + } <nl> + catch ( IOException e ) <nl> + { <nl> + throw new IOError ( e ) ; <nl> + } <nl> + <nl> } <nl> <nl> public void receive ( Message message , String id )

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index 51f8961 . . f3f552c 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 1 , 4 + 1 , 5 @ @ 
 4 . 0 
 + * Fix Distribution . average in cassandra - stress ( CASSANDRA - 14090 ) 
 * Support a means of logging all queries as they were invoked ( CASSANDRA - 13983 ) 
 * Presize collections ( CASSANDRA - 13760 ) 
 * Add GroupCommitLogService ( CASSANDRA - 13530 ) 
 diff - - git a / tools / stress / src / org / apache / cassandra / stress / generate / Distribution . java b / tools / stress / src / org / apache / cassandra / stress / generate / Distribution . java 
 index 0100006 . . 30efd34 100644 
 - - - a / tools / stress / src / org / apache / cassandra / stress / generate / Distribution . java 
 + + + b / tools / stress / src / org / apache / cassandra / stress / generate / Distribution . java 
 @ @ - 46 , 7 + 46 , 7 @ @ public abstract class Distribution implements Serializable 
 { 
 double sum = 0 ; 
 double d = 0d ; 
 - for ( int count = 0 ; count < 51 ; count + + ) 
 + for ( int count = 0 ; count < 50 ; count + + ) 
 { 
 sum + = inverseCumProb ( d ) ; 
 d + = 0 . 02d ;

NEAREST DIFF:
diff - - git a / src / java / org / apache / cassandra / net / MessagingService . java b / src / java / org / apache / cassandra / net / MessagingService . java 
 index 9ff110e . . 99037a1 100644 
 - - - a / src / java / org / apache / cassandra / net / MessagingService . java 
 + + + b / src / java / org / apache / cassandra / net / MessagingService . java 
 @ @ - 482 , 7 + 482 , 21 @ @ public final class MessagingService implements MessagingServiceMBean 
 logger _ . info ( " Waiting for messaging service to quiesce " ) ; 
 / / We may need to schedule hints on the mutation stage , so it ' s erroneous to shut down the mutation stage first 
 assert ! StageManager . getStage ( Stage . MUTATION ) . isShutdown ( ) ; 
 + 
 + / / the important part 
 callbacks . shutdown ( ) ; 
 + 
 + / / attempt to humor tests that try to stop and restart MS 
 + try 
 + { 
 + for ( SocketThread th : socketThreads ) 
 + th . close ( ) ; 
 + } 
 + catch ( IOException e ) 
 + { 
 + throw new IOError ( e ) ; 
 + } 
 + 
 } 
 
 public void receive ( Message message , String id )
