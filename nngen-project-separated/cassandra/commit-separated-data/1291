BLEU SCORE: 0.024367494694068095

TEST MSG: Early validation of partition keys in CAS requests
GENERATED MSG: Refuse conditions on deletes unless full PK is given

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index 248192e . . 775d8a4 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 1 , 4 + 1 , 5 @ @ <nl> 3 . 0 . 0 - rc1 <nl> + * Check partition keys for CAS operations during stmt validation ( CASSANDRA - 10338 ) <nl> * Add custom query expressions to SELECT ( CASSANDRA - 10217 ) <nl> * Fix minor bugs in MV handling ( CASSANDRA - 10362 ) <nl> * Allow custom indexes with 0 , 1 or multiple target columns ( CASSANDRA - 10124 ) <nl> diff - - git a / src / java / org / apache / cassandra / cql3 / statements / ModificationStatement . java b / src / java / org / apache / cassandra / cql3 / statements / ModificationStatement . java <nl> index 3f3f3f5 . . 54a4f28 100644 <nl> - - - a / src / java / org / apache / cassandra / cql3 / statements / ModificationStatement . java <nl> + + + b / src / java / org / apache / cassandra / cql3 / statements / ModificationStatement . java <nl> @ @ - 281 , 7 + 281 , 11 @ @ public abstract class ModificationStatement implements CQLStatement <nl> public List < ByteBuffer > buildPartitionKeyNames ( QueryOptions options ) <nl> throws InvalidRequestException <nl> { <nl> - return restrictions . getPartitionKeys ( options ) ; <nl> + List < ByteBuffer > partitionKeys = restrictions . getPartitionKeys ( options ) ; <nl> + for ( ByteBuffer key : partitionKeys ) <nl> + QueryProcessor . validateKey ( key ) ; <nl> + <nl> + return partitionKeys ; <nl> } <nl> <nl> public NavigableSet < Clustering > createClustering ( QueryOptions options )
NEAREST DIFF (one line): ELIMINATEDSENTENCE

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index 248192e . . 775d8a4 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 1 , 4 + 1 , 5 @ @ 
 3 . 0 . 0 - rc1 
 + * Check partition keys for CAS operations during stmt validation ( CASSANDRA - 10338 ) 
 * Add custom query expressions to SELECT ( CASSANDRA - 10217 ) 
 * Fix minor bugs in MV handling ( CASSANDRA - 10362 ) 
 * Allow custom indexes with 0 , 1 or multiple target columns ( CASSANDRA - 10124 ) 
 diff - - git a / src / java / org / apache / cassandra / cql3 / statements / ModificationStatement . java b / src / java / org / apache / cassandra / cql3 / statements / ModificationStatement . java 
 index 3f3f3f5 . . 54a4f28 100644 
 - - - a / src / java / org / apache / cassandra / cql3 / statements / ModificationStatement . java 
 + + + b / src / java / org / apache / cassandra / cql3 / statements / ModificationStatement . java 
 @ @ - 281 , 7 + 281 , 11 @ @ public abstract class ModificationStatement implements CQLStatement 
 public List < ByteBuffer > buildPartitionKeyNames ( QueryOptions options ) 
 throws InvalidRequestException 
 { 
 - return restrictions . getPartitionKeys ( options ) ; 
 + List < ByteBuffer > partitionKeys = restrictions . getPartitionKeys ( options ) ; 
 + for ( ByteBuffer key : partitionKeys ) 
 + QueryProcessor . validateKey ( key ) ; 
 + 
 + return partitionKeys ; 
 } 
 
 public NavigableSet < Clustering > createClustering ( QueryOptions options )

NEAREST DIFF:
ELIMINATEDSENTENCE
