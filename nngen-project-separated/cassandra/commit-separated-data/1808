BLEU SCORE: 0.024367494694068095

TEST MSG: Make logging for NPE in removeUnfinishedCompactionLeftovers more useful
GENERATED MSG: avoid attempting to delete compacted sstables twice on restart

TEST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / db / ColumnFamilyStore . java b / src / java / org / apache / cassandra / db / ColumnFamilyStore . java <nl> index 1f03090 . . 3d5e4c2 100644 <nl> - - - a / src / java / org / apache / cassandra / db / ColumnFamilyStore . java <nl> + + + b / src / java / org / apache / cassandra / db / ColumnFamilyStore . java <nl> @ @ - 612 , 6 + 612 , 10 @ @ public class ColumnFamilyStore implements ColumnFamilyStoreMBean <nl> { <nl> throw new FSReadError ( e , desc . filenameFor ( Component . STATS ) ) ; <nl> } <nl> + catch ( NullPointerException e ) <nl> + { <nl> + throw new FSReadError ( e , " Failed to remove unfinished compaction leftovers ( file : " + desc . filenameFor ( Component . STATS ) + " ) . See log for details . " ) ; <nl> + } <nl> <nl> if ( ! ancestors . isEmpty ( ) <nl> & & unfinishedGenerations . containsAll ( ancestors )
NEAREST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / db / ColumnFamilyStore . java b / src / java / org / apache / cassandra / db / ColumnFamilyStore . java <nl> index 46a5ca1 . . c53ce06 100644 <nl> - - - a / src / java / org / apache / cassandra / db / ColumnFamilyStore . java <nl> + + + b / src / java / org / apache / cassandra / db / ColumnFamilyStore . java <nl> @ @ - 462 , 7 + 462 , 10 @ @ public class ColumnFamilyStore implements ColumnFamilyStoreMBean <nl> Set < Component > components = sstableFiles . getValue ( ) ; <nl> <nl> if ( components . contains ( Component . COMPACTED _ MARKER ) | | desc . temporary ) <nl> + { <nl> SSTable . delete ( desc , components ) ; <nl> + continue ; <nl> + } <nl> <nl> File dataFile = new File ( desc . filenameFor ( Component . DATA ) ) ; <nl> if ( components . contains ( Component . DATA ) & & dataFile . length ( ) > 0 )

TEST DIFF:
diff - - git a / src / java / org / apache / cassandra / db / ColumnFamilyStore . java b / src / java / org / apache / cassandra / db / ColumnFamilyStore . java 
 index 1f03090 . . 3d5e4c2 100644 
 - - - a / src / java / org / apache / cassandra / db / ColumnFamilyStore . java 
 + + + b / src / java / org / apache / cassandra / db / ColumnFamilyStore . java 
 @ @ - 612 , 6 + 612 , 10 @ @ public class ColumnFamilyStore implements ColumnFamilyStoreMBean 
 { 
 throw new FSReadError ( e , desc . filenameFor ( Component . STATS ) ) ; 
 } 
 + catch ( NullPointerException e ) 
 + { 
 + throw new FSReadError ( e , " Failed to remove unfinished compaction leftovers ( file : " + desc . filenameFor ( Component . STATS ) + " ) . See log for details . " ) ; 
 + } 
 
 if ( ! ancestors . isEmpty ( ) 
 & & unfinishedGenerations . containsAll ( ancestors )

NEAREST DIFF:
diff - - git a / src / java / org / apache / cassandra / db / ColumnFamilyStore . java b / src / java / org / apache / cassandra / db / ColumnFamilyStore . java 
 index 46a5ca1 . . c53ce06 100644 
 - - - a / src / java / org / apache / cassandra / db / ColumnFamilyStore . java 
 + + + b / src / java / org / apache / cassandra / db / ColumnFamilyStore . java 
 @ @ - 462 , 7 + 462 , 10 @ @ public class ColumnFamilyStore implements ColumnFamilyStoreMBean 
 Set < Component > components = sstableFiles . getValue ( ) ; 
 
 if ( components . contains ( Component . COMPACTED _ MARKER ) | | desc . temporary ) 
 + { 
 SSTable . delete ( desc , components ) ; 
 + continue ; 
 + } 
 
 File dataFile = new File ( desc . filenameFor ( Component . DATA ) ) ; 
 if ( components . contains ( Component . DATA ) & & dataFile . length ( ) > 0 )
