BLEU SCORE: 0.034353182138500235

TEST MSG: Log error when stream session fails
GENERATED MSG: Add failure callbacks for outgoing streams .

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index 581784e . . 82176c5 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 1 , 4 + 1 , 5 @ @ <nl> 2 . 1 . 13 <nl> + * Log error when stream session fails ( CASSANDRA - 9294 ) <nl> * Fix bugs in commit log archiving startup behavior ( CASSANDRA - 10593 ) <nl> * ( cqlsh ) further optimise COPY FROM ( CASSANDRA - 9302 ) <nl> * Allow CREATE TABLE WITH ID ( CASSANDRA - 9179 ) <nl> diff - - git a / src / java / org / apache / cassandra / streaming / StreamSession . java b / src / java / org / apache / cassandra / streaming / StreamSession . java <nl> index 63219d8 . . 98a6f1f 100644 <nl> - - - a / src / java / org / apache / cassandra / streaming / StreamSession . java <nl> + + + b / src / java / org / apache / cassandra / streaming / StreamSession . java <nl> @ @ - 617 , 6 + 617 , 7 @ @ public class StreamSession implements IEndpointStateChangeSubscriber <nl> * / <nl> public synchronized void sessionFailed ( ) <nl> { <nl> + logger . error ( " [ Stream # { } ] Remote peer { } failed stream session . " , planId ( ) , peer . getHostAddress ( ) ) ; <nl> closeSession ( State . FAILED ) ; <nl> } <nl> <nl> @ @ - 665 , 11 + 666 , 13 @ @ public class StreamSession implements IEndpointStateChangeSubscriber <nl> <nl> public void onRemove ( InetAddress endpoint ) <nl> { <nl> + logger . error ( " [ Stream # { } ] Session failed because remote peer { } has left . " , planId ( ) , peer . getHostAddress ( ) ) ; <nl> closeSession ( State . FAILED ) ; <nl> } <nl> <nl> public void onRestart ( InetAddress endpoint , EndpointState epState ) <nl> { <nl> + logger . error ( " [ Stream # { } ] Session failed because remote peer { } was restarted . " , planId ( ) , peer . getHostAddress ( ) ) ; <nl> closeSession ( State . FAILED ) ; <nl> } <nl>
NEAREST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / service / StorageService . java b / src / java / org / apache / cassandra / service / StorageService . java <nl> index 4ec5de3 . . e668c1c 100644 <nl> - - - a / src / java / org / apache / cassandra / service / StorageService . java <nl> + + + b / src / java / org / apache / cassandra / service / StorageService . java <nl> @ @ - 1530 , 7 + 1530 , 7 @ @ public class StorageService implements IEndpointStateChangeSubscriber , StorageSe <nl> <nl> public void onFailure ( ) <nl> { <nl> - logger _ . warn ( " Streaming from " + source + " failed " ) ; <nl> + logger . warn ( " Streaming from " + source + " failed " ) ; <nl> onSuccess ( ) ; / / calling onSuccess to send notification <nl> } <nl> } ; <nl> @ @ - 2846 , 7 + 2846 , 7 @ @ public class StorageService implements IEndpointStateChangeSubscriber , StorageSe <nl> <nl> public void onFailure ( ) <nl> { <nl> - logger _ . warn ( " Streaming to " + endPointEntry + " failed " ) ; <nl> + logger . warn ( " Streaming to " + endPointEntry + " failed " ) ; <nl> onSuccess ( ) ; / / calling onSuccess for latch countdown <nl> } <nl> } ; <nl> @ @ - 2902 , 7 + 2902 , 7 @ @ public class StorageService implements IEndpointStateChangeSubscriber , StorageSe <nl> <nl> public void onFailure ( ) <nl> { <nl> - logger _ . warn ( " Streaming from " + source + " failed " ) ; <nl> + logger . warn ( " Streaming from " + source + " failed " ) ; <nl> onSuccess ( ) ; / / calling onSuccess for latch countdown <nl> } <nl> } ;

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index 581784e . . 82176c5 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 1 , 4 + 1 , 5 @ @ 
 2 . 1 . 13 
 + * Log error when stream session fails ( CASSANDRA - 9294 ) 
 * Fix bugs in commit log archiving startup behavior ( CASSANDRA - 10593 ) 
 * ( cqlsh ) further optimise COPY FROM ( CASSANDRA - 9302 ) 
 * Allow CREATE TABLE WITH ID ( CASSANDRA - 9179 ) 
 diff - - git a / src / java / org / apache / cassandra / streaming / StreamSession . java b / src / java / org / apache / cassandra / streaming / StreamSession . java 
 index 63219d8 . . 98a6f1f 100644 
 - - - a / src / java / org / apache / cassandra / streaming / StreamSession . java 
 + + + b / src / java / org / apache / cassandra / streaming / StreamSession . java 
 @ @ - 617 , 6 + 617 , 7 @ @ public class StreamSession implements IEndpointStateChangeSubscriber 
 * / 
 public synchronized void sessionFailed ( ) 
 { 
 + logger . error ( " [ Stream # { } ] Remote peer { } failed stream session . " , planId ( ) , peer . getHostAddress ( ) ) ; 
 closeSession ( State . FAILED ) ; 
 } 
 
 @ @ - 665 , 11 + 666 , 13 @ @ public class StreamSession implements IEndpointStateChangeSubscriber 
 
 public void onRemove ( InetAddress endpoint ) 
 { 
 + logger . error ( " [ Stream # { } ] Session failed because remote peer { } has left . " , planId ( ) , peer . getHostAddress ( ) ) ; 
 closeSession ( State . FAILED ) ; 
 } 
 
 public void onRestart ( InetAddress endpoint , EndpointState epState ) 
 { 
 + logger . error ( " [ Stream # { } ] Session failed because remote peer { } was restarted . " , planId ( ) , peer . getHostAddress ( ) ) ; 
 closeSession ( State . FAILED ) ; 
 } 


NEAREST DIFF:
diff - - git a / src / java / org / apache / cassandra / service / StorageService . java b / src / java / org / apache / cassandra / service / StorageService . java 
 index 4ec5de3 . . e668c1c 100644 
 - - - a / src / java / org / apache / cassandra / service / StorageService . java 
 + + + b / src / java / org / apache / cassandra / service / StorageService . java 
 @ @ - 1530 , 7 + 1530 , 7 @ @ public class StorageService implements IEndpointStateChangeSubscriber , StorageSe 
 
 public void onFailure ( ) 
 { 
 - logger _ . warn ( " Streaming from " + source + " failed " ) ; 
 + logger . warn ( " Streaming from " + source + " failed " ) ; 
 onSuccess ( ) ; / / calling onSuccess to send notification 
 } 
 } ; 
 @ @ - 2846 , 7 + 2846 , 7 @ @ public class StorageService implements IEndpointStateChangeSubscriber , StorageSe 
 
 public void onFailure ( ) 
 { 
 - logger _ . warn ( " Streaming to " + endPointEntry + " failed " ) ; 
 + logger . warn ( " Streaming to " + endPointEntry + " failed " ) ; 
 onSuccess ( ) ; / / calling onSuccess for latch countdown 
 } 
 } ; 
 @ @ - 2902 , 7 + 2902 , 7 @ @ public class StorageService implements IEndpointStateChangeSubscriber , StorageSe 
 
 public void onFailure ( ) 
 { 
 - logger _ . warn ( " Streaming from " + source + " failed " ) ; 
 + logger . warn ( " Streaming from " + source + " failed " ) ; 
 onSuccess ( ) ; / / calling onSuccess for latch countdown 
 } 
 } ;
