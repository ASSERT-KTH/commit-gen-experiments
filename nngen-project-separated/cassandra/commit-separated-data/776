BLEU SCORE: 0.04372912656590315

TEST MSG: make Trackers static inner classes
GENERATED MSG: add filename check for commitlog replay

TEST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / db / commitlog / CommitLogReader . java b / src / java / org / apache / cassandra / db / commitlog / CommitLogReader . java <nl> index 6acbd0d . . a9e9038 100644 <nl> - - - a / src / java / org / apache / cassandra / db / commitlog / CommitLogReader . java <nl> + + + b / src / java / org / apache / cassandra / db / commitlog / CommitLogReader . java <nl> @ @ - 470 , 7 + 470 , 7 @ @ public class CommitLogReader <nl> } <nl> } <nl> <nl> - private class ReadStatusTracker <nl> + private static class ReadStatusTracker <nl> { <nl> private int mutationsLeft ; <nl> public String errorContext = " " ; <nl> diff - - git a / src / java / org / apache / cassandra / db / commitlog / CommitLogSegmentManagerCDC . java b / src / java / org / apache / cassandra / db / commitlog / CommitLogSegmentManagerCDC . java <nl> index fe4b2af . . 15944bd 100644 <nl> - - - a / src / java / org / apache / cassandra / db / commitlog / CommitLogSegmentManagerCDC . java <nl> + + + b / src / java / org / apache / cassandra / db / commitlog / CommitLogSegmentManagerCDC . java <nl> @ @ - 153 , 7 + 153 , 7 @ @ public class CommitLogSegmentManagerCDC extends AbstractCommitLogSegmentManager <nl> * Arrays . stream ( path . listFiles ( ) ) . mapToLong ( File : : length ) . sum ( ) ; <nl> * However this solution is 375 % slower on Windows . Revisit this and split logic to per - OS <nl> * / <nl> - private class CDCSizeTracker extends DirectorySizeCalculator <nl> + private static class CDCSizeTracker extends DirectorySizeCalculator <nl> { <nl> private final RateLimiter rateLimiter = RateLimiter . create ( 1000 . 0 / DatabaseDescriptor . getCDCDiskCheckInterval ( ) ) ; <nl> private ExecutorService cdcSizeCalculationExecutor ;
NEAREST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / db / commitlog / CommitLog . java b / src / java / org / apache / cassandra / db / commitlog / CommitLog . java <nl> index ab45ff7 . . 7cf0a9f 100644 <nl> - - - a / src / java / org / apache / cassandra / db / commitlog / CommitLog . java <nl> + + + b / src / java / org / apache / cassandra / db / commitlog / CommitLog . java <nl> @ @ - 161 , 8 + 161 , 7 @ @ public class CommitLog <nl> { <nl> public boolean accept ( File dir , String name ) <nl> { <nl> - / / throw out anything that starts with dot . <nl> - return ! name . matches ( " \ \ . . * " ) ; <nl> + return CommitLogSegment . possibleCommitLogFile ( name ) ; <nl> } <nl> } ) ; <nl> if ( files . length = = 0 ) <nl> diff - - git a / src / java / org / apache / cassandra / db / commitlog / CommitLogSegment . java b / src / java / org / apache / cassandra / db / commitlog / CommitLogSegment . java <nl> index ec54e6e . . bec2698 100644 <nl> - - - a / src / java / org / apache / cassandra / db / commitlog / CommitLogSegment . java <nl> + + + b / src / java / org / apache / cassandra / db / commitlog / CommitLogSegment . java <nl> @ @ - 63 , 6 + 63 , 11 @ @ public class CommitLogSegment <nl> } <nl> } <nl> <nl> + public static boolean possibleCommitLogFile ( String filename ) <nl> + { <nl> + return filename . matches ( " CommitLog - \ \ d + . log " ) ; <nl> + } <nl> + <nl> public void writeHeader ( ) throws IOException <nl> { <nl> seekAndWriteCommitLogHeader ( header . toByteArray ( ) ) ;

TEST DIFF:
diff - - git a / src / java / org / apache / cassandra / db / commitlog / CommitLogReader . java b / src / java / org / apache / cassandra / db / commitlog / CommitLogReader . java 
 index 6acbd0d . . a9e9038 100644 
 - - - a / src / java / org / apache / cassandra / db / commitlog / CommitLogReader . java 
 + + + b / src / java / org / apache / cassandra / db / commitlog / CommitLogReader . java 
 @ @ - 470 , 7 + 470 , 7 @ @ public class CommitLogReader 
 } 
 } 
 
 - private class ReadStatusTracker 
 + private static class ReadStatusTracker 
 { 
 private int mutationsLeft ; 
 public String errorContext = " " ; 
 diff - - git a / src / java / org / apache / cassandra / db / commitlog / CommitLogSegmentManagerCDC . java b / src / java / org / apache / cassandra / db / commitlog / CommitLogSegmentManagerCDC . java 
 index fe4b2af . . 15944bd 100644 
 - - - a / src / java / org / apache / cassandra / db / commitlog / CommitLogSegmentManagerCDC . java 
 + + + b / src / java / org / apache / cassandra / db / commitlog / CommitLogSegmentManagerCDC . java 
 @ @ - 153 , 7 + 153 , 7 @ @ public class CommitLogSegmentManagerCDC extends AbstractCommitLogSegmentManager 
 * Arrays . stream ( path . listFiles ( ) ) . mapToLong ( File : : length ) . sum ( ) ; 
 * However this solution is 375 % slower on Windows . Revisit this and split logic to per - OS 
 * / 
 - private class CDCSizeTracker extends DirectorySizeCalculator 
 + private static class CDCSizeTracker extends DirectorySizeCalculator 
 { 
 private final RateLimiter rateLimiter = RateLimiter . create ( 1000 . 0 / DatabaseDescriptor . getCDCDiskCheckInterval ( ) ) ; 
 private ExecutorService cdcSizeCalculationExecutor ;

NEAREST DIFF:
diff - - git a / src / java / org / apache / cassandra / db / commitlog / CommitLog . java b / src / java / org / apache / cassandra / db / commitlog / CommitLog . java 
 index ab45ff7 . . 7cf0a9f 100644 
 - - - a / src / java / org / apache / cassandra / db / commitlog / CommitLog . java 
 + + + b / src / java / org / apache / cassandra / db / commitlog / CommitLog . java 
 @ @ - 161 , 8 + 161 , 7 @ @ public class CommitLog 
 { 
 public boolean accept ( File dir , String name ) 
 { 
 - / / throw out anything that starts with dot . 
 - return ! name . matches ( " \ \ . . * " ) ; 
 + return CommitLogSegment . possibleCommitLogFile ( name ) ; 
 } 
 } ) ; 
 if ( files . length = = 0 ) 
 diff - - git a / src / java / org / apache / cassandra / db / commitlog / CommitLogSegment . java b / src / java / org / apache / cassandra / db / commitlog / CommitLogSegment . java 
 index ec54e6e . . bec2698 100644 
 - - - a / src / java / org / apache / cassandra / db / commitlog / CommitLogSegment . java 
 + + + b / src / java / org / apache / cassandra / db / commitlog / CommitLogSegment . java 
 @ @ - 63 , 6 + 63 , 11 @ @ public class CommitLogSegment 
 } 
 } 
 
 + public static boolean possibleCommitLogFile ( String filename ) 
 + { 
 + return filename . matches ( " CommitLog - \ \ d + . log " ) ; 
 + } 
 + 
 public void writeHeader ( ) throws IOException 
 { 
 seekAndWriteCommitLogHeader ( header . toByteArray ( ) ) ;
