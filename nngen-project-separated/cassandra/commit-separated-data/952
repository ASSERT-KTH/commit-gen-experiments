BLEU SCORE: 0.027611988917697356

TEST MSG: Use noop index updater during compaction when appropriate
GENERATED MSG: Fix SecondaryIndexManager # deleteFromIndexes ( )

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index 5e8828b . . 6e43496 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 1 , 4 + 1 , 5 @ @ <nl> 2 . 2 . 6 <nl> + * Fix use of NullUpdater for 2i during compaction ( CASSANDRA - 11450 ) <nl> * Notify when sstables change after cancelling compaction ( CASSANDRA - 11373 ) <nl> * cqlsh : COPY FROM should check that explicit column names are valid ( CASSANDRA - 11333 ) <nl> * Add - Dcassandra . start _ gossip startup option ( CASSANDRA - 10809 ) <nl> diff - - git a / src / java / org / apache / cassandra / db / index / SecondaryIndexManager . java b / src / java / org / apache / cassandra / db / index / SecondaryIndexManager . java <nl> index f7abc54 . . 26327d4 100644 <nl> - - - a / src / java / org / apache / cassandra / db / index / SecondaryIndexManager . java <nl> + + + b / src / java / org / apache / cassandra / db / index / SecondaryIndexManager . java <nl> @ @ - 511 , 7 + 511 , 9 @ @ public class SecondaryIndexManager <nl> * / <nl> public Updater gcUpdaterFor ( DecoratedKey key ) <nl> { <nl> - return new GCUpdater ( key ) ; <nl> + return ( indexesByColumn . isEmpty ( ) & & rowLevelIndexMap . isEmpty ( ) ) <nl> + ? nullUpdater <nl> + : new GCUpdater ( key ) ; <nl> } <nl> <nl> / * *
NEAREST DIFF (one line): ELIMINATEDSENTENCE

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index 5e8828b . . 6e43496 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 1 , 4 + 1 , 5 @ @ 
 2 . 2 . 6 
 + * Fix use of NullUpdater for 2i during compaction ( CASSANDRA - 11450 ) 
 * Notify when sstables change after cancelling compaction ( CASSANDRA - 11373 ) 
 * cqlsh : COPY FROM should check that explicit column names are valid ( CASSANDRA - 11333 ) 
 * Add - Dcassandra . start _ gossip startup option ( CASSANDRA - 10809 ) 
 diff - - git a / src / java / org / apache / cassandra / db / index / SecondaryIndexManager . java b / src / java / org / apache / cassandra / db / index / SecondaryIndexManager . java 
 index f7abc54 . . 26327d4 100644 
 - - - a / src / java / org / apache / cassandra / db / index / SecondaryIndexManager . java 
 + + + b / src / java / org / apache / cassandra / db / index / SecondaryIndexManager . java 
 @ @ - 511 , 7 + 511 , 9 @ @ public class SecondaryIndexManager 
 * / 
 public Updater gcUpdaterFor ( DecoratedKey key ) 
 { 
 - return new GCUpdater ( key ) ; 
 + return ( indexesByColumn . isEmpty ( ) & & rowLevelIndexMap . isEmpty ( ) ) 
 + ? nullUpdater 
 + : new GCUpdater ( key ) ; 
 } 
 
 / * *

NEAREST DIFF:
ELIMINATEDSENTENCE
