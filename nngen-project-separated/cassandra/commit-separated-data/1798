BLEU SCORE: 0.03089055318156698

TEST MSG: Fix cassandra - stress so it respects the CL passed in user mode
GENERATED MSG: Make stress . java insert operation to use microseconds

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index 24a8bb7 . . c8a4a84 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 1 , 4 + 1 , 5 @ @ <nl> 2 . 1 . 4 <nl> + * Fix cassandra - stress so it respects the CL passed in user mode ( CASSANDRA - 8948 ) <nl> * Fix rare NPE in ColumnDefinition # hasIndexOption ( ) ( CASSANDRA - 8786 ) <nl> * cassandra - stress reports per - operation statistics , plus misc ( CASSANDRA - 8769 ) <nl> * Add SimpleDate ( cql date ) and Time ( cql time ) types ( CASSANDRA - 7523 ) <nl> diff - - git a / tools / stress / src / org / apache / cassandra / stress / operations / userdefined / SchemaStatement . java b / tools / stress / src / org / apache / cassandra / stress / operations / userdefined / SchemaStatement . java <nl> index 75e49b4 . . 4305151 100644 <nl> - - - a / tools / stress / src / org / apache / cassandra / stress / operations / userdefined / SchemaStatement . java <nl> + + + b / tools / stress / src / org / apache / cassandra / stress / operations / userdefined / SchemaStatement . java <nl> @ @ - 35 , 6 + 35 , 7 @ @ import org . apache . cassandra . stress . Operation ; <nl> import org . apache . cassandra . stress . generate . Row ; <nl> import org . apache . cassandra . stress . settings . StressSettings ; <nl> import org . apache . cassandra . stress . settings . ValidationType ; <nl> + import org . apache . cassandra . stress . util . JavaDriverClient ; <nl> import org . apache . cassandra . stress . util . Timer ; <nl> import org . apache . cassandra . thrift . CqlResult ; <nl> import org . apache . cassandra . transport . SimpleClient ; <nl> @ @ - 62 , 6 + 63 , 8 @ @ public abstract class SchemaStatement extends Operation <nl> int i = 0 ; <nl> for ( ColumnDefinitions . Definition definition : statement . getVariables ( ) ) <nl> argumentIndex [ i + + ] = spec . partitionGenerator . indexOf ( definition . getName ( ) ) ; <nl> + <nl> + statement . setConsistencyLevel ( JavaDriverClient . from ( cl ) ) ; <nl> } <nl> <nl> BoundStatement bindRow ( Row row )
NEAREST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / net / MessagingService . java b / src / java / org / apache / cassandra / net / MessagingService . java <nl> index 9ff110e . . 99037a1 100644 <nl> - - - a / src / java / org / apache / cassandra / net / MessagingService . java <nl> + + + b / src / java / org / apache / cassandra / net / MessagingService . java <nl> @ @ - 482 , 7 + 482 , 21 @ @ public final class MessagingService implements MessagingServiceMBean <nl> logger _ . info ( " Waiting for messaging service to quiesce " ) ; <nl> / / We may need to schedule hints on the mutation stage , so it ' s erroneous to shut down the mutation stage first <nl> assert ! StageManager . getStage ( Stage . MUTATION ) . isShutdown ( ) ; <nl> + <nl> + / / the important part <nl> callbacks . shutdown ( ) ; <nl> + <nl> + / / attempt to humor tests that try to stop and restart MS <nl> + try <nl> + { <nl> + for ( SocketThread th : socketThreads ) <nl> + th . close ( ) ; <nl> + } <nl> + catch ( IOException e ) <nl> + { <nl> + throw new IOError ( e ) ; <nl> + } <nl> + <nl> } <nl> <nl> public void receive ( Message message , String id )

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index 24a8bb7 . . c8a4a84 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 1 , 4 + 1 , 5 @ @ 
 2 . 1 . 4 
 + * Fix cassandra - stress so it respects the CL passed in user mode ( CASSANDRA - 8948 ) 
 * Fix rare NPE in ColumnDefinition # hasIndexOption ( ) ( CASSANDRA - 8786 ) 
 * cassandra - stress reports per - operation statistics , plus misc ( CASSANDRA - 8769 ) 
 * Add SimpleDate ( cql date ) and Time ( cql time ) types ( CASSANDRA - 7523 ) 
 diff - - git a / tools / stress / src / org / apache / cassandra / stress / operations / userdefined / SchemaStatement . java b / tools / stress / src / org / apache / cassandra / stress / operations / userdefined / SchemaStatement . java 
 index 75e49b4 . . 4305151 100644 
 - - - a / tools / stress / src / org / apache / cassandra / stress / operations / userdefined / SchemaStatement . java 
 + + + b / tools / stress / src / org / apache / cassandra / stress / operations / userdefined / SchemaStatement . java 
 @ @ - 35 , 6 + 35 , 7 @ @ import org . apache . cassandra . stress . Operation ; 
 import org . apache . cassandra . stress . generate . Row ; 
 import org . apache . cassandra . stress . settings . StressSettings ; 
 import org . apache . cassandra . stress . settings . ValidationType ; 
 + import org . apache . cassandra . stress . util . JavaDriverClient ; 
 import org . apache . cassandra . stress . util . Timer ; 
 import org . apache . cassandra . thrift . CqlResult ; 
 import org . apache . cassandra . transport . SimpleClient ; 
 @ @ - 62 , 6 + 63 , 8 @ @ public abstract class SchemaStatement extends Operation 
 int i = 0 ; 
 for ( ColumnDefinitions . Definition definition : statement . getVariables ( ) ) 
 argumentIndex [ i + + ] = spec . partitionGenerator . indexOf ( definition . getName ( ) ) ; 
 + 
 + statement . setConsistencyLevel ( JavaDriverClient . from ( cl ) ) ; 
 } 
 
 BoundStatement bindRow ( Row row )

NEAREST DIFF:
diff - - git a / src / java / org / apache / cassandra / net / MessagingService . java b / src / java / org / apache / cassandra / net / MessagingService . java 
 index 9ff110e . . 99037a1 100644 
 - - - a / src / java / org / apache / cassandra / net / MessagingService . java 
 + + + b / src / java / org / apache / cassandra / net / MessagingService . java 
 @ @ - 482 , 7 + 482 , 21 @ @ public final class MessagingService implements MessagingServiceMBean 
 logger _ . info ( " Waiting for messaging service to quiesce " ) ; 
 / / We may need to schedule hints on the mutation stage , so it ' s erroneous to shut down the mutation stage first 
 assert ! StageManager . getStage ( Stage . MUTATION ) . isShutdown ( ) ; 
 + 
 + / / the important part 
 callbacks . shutdown ( ) ; 
 + 
 + / / attempt to humor tests that try to stop and restart MS 
 + try 
 + { 
 + for ( SocketThread th : socketThreads ) 
 + th . close ( ) ; 
 + } 
 + catch ( IOException e ) 
 + { 
 + throw new IOError ( e ) ; 
 + } 
 + 
 } 
 
 public void receive ( Message message , String id )
