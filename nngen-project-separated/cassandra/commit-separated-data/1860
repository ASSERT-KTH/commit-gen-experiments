BLEU SCORE: 0.001846432619570943

TEST MSG: simplify : iterate over the values collection
GENERATED MSG: This patch adds ColumnFamilyStore . forceflush to the mbean so that it can be activated through the management agent . patch by Eric Evans ; reviewed by jbellis for CASSANDRA - 34

TEST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / db / Keyspace . java b / src / java / org / apache / cassandra / db / Keyspace . java <nl> index b34d589 . . bffddc6 100644 <nl> - - - a / src / java / org / apache / cassandra / db / Keyspace . java <nl> + + + b / src / java / org / apache / cassandra / db / Keyspace . java <nl> @ @ - 425 , 8 + 425 , 8 @ @ public class Keyspace <nl> public List < Future < ? > > flush ( ) <nl> { <nl> List < Future < ? > > futures = new ArrayList < > ( columnFamilyStores . size ( ) ) ; <nl> - for ( UUID cfId : columnFamilyStores . keySet ( ) ) <nl> - futures . add ( columnFamilyStores . get ( cfId ) . forceFlush ( ) ) ; <nl> + for ( ColumnFamilyStore cfs : columnFamilyStores . values ( ) ) <nl> + futures . add ( cfs . forceFlush ( ) ) ; <nl> return futures ; <nl> } <nl>
NEAREST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / db / ColumnFamilyStore . java b / src / java / org / apache / cassandra / db / ColumnFamilyStore . java <nl> index 2fac2a5 . . 57458a2 100644 <nl> - - - a / src / java / org / apache / cassandra / db / ColumnFamilyStore . java <nl> + + + b / src / java / org / apache / cassandra / db / ColumnFamilyStore . java <nl> @ @ - 425 , 7 + 425 , 7 @ @ public class ColumnFamilyStore implements ColumnFamilyStoreMBean <nl> binaryMemtable _ . get ( ) . put ( key , buffer ) ; <nl> } <nl> <nl> - void forceFlush ( ) throws IOException <nl> + public void forceFlush ( ) <nl> { <nl> memtable _ . get ( ) . forceflush ( ) ; <nl> } <nl> diff - - git a / src / java / org / apache / cassandra / db / ColumnFamilyStoreMBean . java b / src / java / org / apache / cassandra / db / ColumnFamilyStoreMBean . java <nl> index 521b3e9 . . 75840b8 100644 <nl> - - - a / src / java / org / apache / cassandra / db / ColumnFamilyStoreMBean . java <nl> + + + b / src / java / org / apache / cassandra / db / ColumnFamilyStoreMBean . java <nl> @ @ - 53 , 4 + 53 , 9 @ @ public interface ColumnFamilyStoreMBean <nl> * @ return the number of tasks waiting to run on the memtable executor <nl> * / <nl> public int getMemtableTasks ( ) ; <nl> + <nl> + / * * <nl> + * Triggers an immediate memtable flush . <nl> + * / <nl> + public void forceFlush ( ) ; <nl> }

TEST DIFF:
diff - - git a / src / java / org / apache / cassandra / db / Keyspace . java b / src / java / org / apache / cassandra / db / Keyspace . java 
 index b34d589 . . bffddc6 100644 
 - - - a / src / java / org / apache / cassandra / db / Keyspace . java 
 + + + b / src / java / org / apache / cassandra / db / Keyspace . java 
 @ @ - 425 , 8 + 425 , 8 @ @ public class Keyspace 
 public List < Future < ? > > flush ( ) 
 { 
 List < Future < ? > > futures = new ArrayList < > ( columnFamilyStores . size ( ) ) ; 
 - for ( UUID cfId : columnFamilyStores . keySet ( ) ) 
 - futures . add ( columnFamilyStores . get ( cfId ) . forceFlush ( ) ) ; 
 + for ( ColumnFamilyStore cfs : columnFamilyStores . values ( ) ) 
 + futures . add ( cfs . forceFlush ( ) ) ; 
 return futures ; 
 } 


NEAREST DIFF:
diff - - git a / src / java / org / apache / cassandra / db / ColumnFamilyStore . java b / src / java / org / apache / cassandra / db / ColumnFamilyStore . java 
 index 2fac2a5 . . 57458a2 100644 
 - - - a / src / java / org / apache / cassandra / db / ColumnFamilyStore . java 
 + + + b / src / java / org / apache / cassandra / db / ColumnFamilyStore . java 
 @ @ - 425 , 7 + 425 , 7 @ @ public class ColumnFamilyStore implements ColumnFamilyStoreMBean 
 binaryMemtable _ . get ( ) . put ( key , buffer ) ; 
 } 
 
 - void forceFlush ( ) throws IOException 
 + public void forceFlush ( ) 
 { 
 memtable _ . get ( ) . forceflush ( ) ; 
 } 
 diff - - git a / src / java / org / apache / cassandra / db / ColumnFamilyStoreMBean . java b / src / java / org / apache / cassandra / db / ColumnFamilyStoreMBean . java 
 index 521b3e9 . . 75840b8 100644 
 - - - a / src / java / org / apache / cassandra / db / ColumnFamilyStoreMBean . java 
 + + + b / src / java / org / apache / cassandra / db / ColumnFamilyStoreMBean . java 
 @ @ - 53 , 4 + 53 , 9 @ @ public interface ColumnFamilyStoreMBean 
 * @ return the number of tasks waiting to run on the memtable executor 
 * / 
 public int getMemtableTasks ( ) ; 
 + 
 + / * * 
 + * Triggers an immediate memtable flush . 
 + * / 
 + public void forceFlush ( ) ; 
 }
