BLEU SCORE: 0.0011392542366888657

TEST MSG: Fix Metered MBean registration
GENERATED MSG: track coordinator latency and use that instead of local for read speculation ; fix round - trip of percentile through string

TEST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / metrics / CassandraMetricsRegistry . java b / src / java / org / apache / cassandra / metrics / CassandraMetricsRegistry . java <nl> index 79d3c3e . . 43d6609 100644 <nl> - - - a / src / java / org / apache / cassandra / metrics / CassandraMetricsRegistry . java <nl> + + + b / src / java / org / apache / cassandra / metrics / CassandraMetricsRegistry . java <nl> @ @ - 182 , 29 + 182 , 25 @ @ public class CassandraMetricsRegistry extends MetricRegistry <nl> AbstractBean mbean ; <nl> <nl> if ( metric instanceof Gauge ) <nl> - { <nl> mbean = new JmxGauge ( ( Gauge < ? > ) metric , name ) ; <nl> - } else if ( metric instanceof Counter ) <nl> - { <nl> + else if ( metric instanceof Counter ) <nl> mbean = new JmxCounter ( ( Counter ) metric , name ) ; <nl> - } else if ( metric instanceof Histogram ) <nl> - { <nl> + else if ( metric instanceof Histogram ) <nl> mbean = new JmxHistogram ( ( Histogram ) metric , name ) ; <nl> - } else if ( metric instanceof Meter ) <nl> - { <nl> - mbean = new JmxMeter ( ( Meter ) metric , name , TimeUnit . SECONDS ) ; <nl> - } else if ( metric instanceof Timer ) <nl> - { <nl> + else if ( metric instanceof Timer ) <nl> mbean = new JmxTimer ( ( Timer ) metric , name , TimeUnit . SECONDS , TimeUnit . MICROSECONDS ) ; <nl> - } else <nl> - { <nl> + else if ( metric instanceof Metered ) <nl> + mbean = new JmxMeter ( ( Metered ) metric , name , TimeUnit . SECONDS ) ; <nl> + else <nl> throw new IllegalArgumentException ( " Unknown metric type : " + metric . getClass ( ) ) ; <nl> - } <nl> <nl> try <nl> { <nl> mBeanServer . registerMBean ( mbean , name ) ; <nl> - } catch ( Exception ignored ) { } <nl> + } <nl> + catch ( Exception ignored ) <nl> + { <nl> + } <nl> } <nl> <nl> private void registerAlias ( MetricName existingName , MetricName aliasName )
NEAREST DIFF (one line): diff - - git a / NEWS . txt b / NEWS . txt <nl> index fc257f4 . . 1f76277 100644 <nl> - - - a / NEWS . txt <nl> + + + b / NEWS . txt <nl> @ @ - 13 , 6 + 13 , 16 @ @ restore snapshots created with the previous major version using the <nl> ' sstableloader ' tool . You can upgrade the file format of your snapshots <nl> using the provided ' sstableupgrade ' tool . <nl> <nl> + <nl> + 2 . 0 . 2 <nl> + = = = = = <nl> + <nl> + New features <nl> + - - - - - - - - - - - - <nl> + - Speculative retry defaults to 99th percentile <nl> + ( See blog post at TODO ) <nl> + <nl> + <nl> 2 . 0 . 1 <nl> = = = = = <nl> <nl> diff - - git a / src / java / org / apache / cassandra / config / CFMetaData . java b / src / java / org / apache / cassandra / config / CFMetaData . java <nl> index 51865c2 . . 8c4075c 100644 <nl> - - - a / src / java / org / apache / cassandra / config / CFMetaData . java <nl> + + + b / src / java / org / apache / cassandra / config / CFMetaData . java <nl> @ @ - 83 , 7 + 83 , 7 @ @ public final class CFMetaData <nl> public final static Class < ? extends AbstractCompactionStrategy > DEFAULT _ COMPACTION _ STRATEGY _ CLASS = SizeTieredCompactionStrategy . class ; <nl> public final static Caching DEFAULT _ CACHING _ STRATEGY = Caching . KEYS _ ONLY ; <nl> public final static int DEFAULT _ DEFAULT _ TIME _ TO _ LIVE = 0 ; <nl> - public final static SpeculativeRetry DEFAULT _ SPECULATIVE _ RETRY = new SpeculativeRetry ( SpeculativeRetry . RetryType . NONE , 0 ) ; <nl> + public final static SpeculativeRetry DEFAULT _ SPECULATIVE _ RETRY = new SpeculativeRetry ( SpeculativeRetry . RetryType . PERCENTILE , 0 . 99 ) ; <nl> public final static int DEFAULT _ INDEX _ INTERVAL = 128 ; <nl> public final static boolean DEFAULT _ POPULATE _ IO _ CACHE _ ON _ FLUSH = false ; <nl>

TEST DIFF:
diff - - git a / src / java / org / apache / cassandra / metrics / CassandraMetricsRegistry . java b / src / java / org / apache / cassandra / metrics / CassandraMetricsRegistry . java 
 index 79d3c3e . . 43d6609 100644 
 - - - a / src / java / org / apache / cassandra / metrics / CassandraMetricsRegistry . java 
 + + + b / src / java / org / apache / cassandra / metrics / CassandraMetricsRegistry . java 
 @ @ - 182 , 29 + 182 , 25 @ @ public class CassandraMetricsRegistry extends MetricRegistry 
 AbstractBean mbean ; 
 
 if ( metric instanceof Gauge ) 
 - { 
 mbean = new JmxGauge ( ( Gauge < ? > ) metric , name ) ; 
 - } else if ( metric instanceof Counter ) 
 - { 
 + else if ( metric instanceof Counter ) 
 mbean = new JmxCounter ( ( Counter ) metric , name ) ; 
 - } else if ( metric instanceof Histogram ) 
 - { 
 + else if ( metric instanceof Histogram ) 
 mbean = new JmxHistogram ( ( Histogram ) metric , name ) ; 
 - } else if ( metric instanceof Meter ) 
 - { 
 - mbean = new JmxMeter ( ( Meter ) metric , name , TimeUnit . SECONDS ) ; 
 - } else if ( metric instanceof Timer ) 
 - { 
 + else if ( metric instanceof Timer ) 
 mbean = new JmxTimer ( ( Timer ) metric , name , TimeUnit . SECONDS , TimeUnit . MICROSECONDS ) ; 
 - } else 
 - { 
 + else if ( metric instanceof Metered ) 
 + mbean = new JmxMeter ( ( Metered ) metric , name , TimeUnit . SECONDS ) ; 
 + else 
 throw new IllegalArgumentException ( " Unknown metric type : " + metric . getClass ( ) ) ; 
 - } 
 
 try 
 { 
 mBeanServer . registerMBean ( mbean , name ) ; 
 - } catch ( Exception ignored ) { } 
 + } 
 + catch ( Exception ignored ) 
 + { 
 + } 
 } 
 
 private void registerAlias ( MetricName existingName , MetricName aliasName )

NEAREST DIFF:
diff - - git a / NEWS . txt b / NEWS . txt 
 index fc257f4 . . 1f76277 100644 
 - - - a / NEWS . txt 
 + + + b / NEWS . txt 
 @ @ - 13 , 6 + 13 , 16 @ @ restore snapshots created with the previous major version using the 
 ' sstableloader ' tool . You can upgrade the file format of your snapshots 
 using the provided ' sstableupgrade ' tool . 
 
 + 
 + 2 . 0 . 2 
 + = = = = = 
 + 
 + New features 
 + - - - - - - - - - - - - 
 + - Speculative retry defaults to 99th percentile 
 + ( See blog post at TODO ) 
 + 
 + 
 2 . 0 . 1 
 = = = = = 
 
 diff - - git a / src / java / org / apache / cassandra / config / CFMetaData . java b / src / java / org / apache / cassandra / config / CFMetaData . java 
 index 51865c2 . . 8c4075c 100644 
 - - - a / src / java / org / apache / cassandra / config / CFMetaData . java 
 + + + b / src / java / org / apache / cassandra / config / CFMetaData . java 
 @ @ - 83 , 7 + 83 , 7 @ @ public final class CFMetaData 
 public final static Class < ? extends AbstractCompactionStrategy > DEFAULT _ COMPACTION _ STRATEGY _ CLASS = SizeTieredCompactionStrategy . class ; 
 public final static Caching DEFAULT _ CACHING _ STRATEGY = Caching . KEYS _ ONLY ; 
 public final static int DEFAULT _ DEFAULT _ TIME _ TO _ LIVE = 0 ; 
 - public final static SpeculativeRetry DEFAULT _ SPECULATIVE _ RETRY = new SpeculativeRetry ( SpeculativeRetry . RetryType . NONE , 0 ) ; 
 + public final static SpeculativeRetry DEFAULT _ SPECULATIVE _ RETRY = new SpeculativeRetry ( SpeculativeRetry . RetryType . PERCENTILE , 0 . 99 ) ; 
 public final static int DEFAULT _ INDEX _ INTERVAL = 128 ; 
 public final static boolean DEFAULT _ POPULATE _ IO _ CACHE _ ON _ FLUSH = false ; 

