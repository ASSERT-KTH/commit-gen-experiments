BLEU SCORE: 0.018738883683389617

TEST MSG: Allow simultaneous bootstrapping with strict consistency when no vnodes are used
GENERATED MSG: Add ' nodetool statusgossip '

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index 636c15d . . 4b87ed0 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 1 , 4 + 1 , 5 @ @ <nl> 2 . 1 . 13 <nl> + * Allow simultaneous bootstrapping with strict consistency when no vnodes are used ( CASSANDRA - 11005 ) <nl> * Log a message when major compaction does not result in a single file ( CASSANDRA - 10847 ) <nl> * ( cqlsh ) fix cqlsh _ copy _ tests when vnodes are disabled ( CASSANDRA - 10997 ) <nl> * ( cqlsh ) fix formatting bytearray values ( CASSANDRA - 10839 ) <nl> diff - - git a / src / java / org / apache / cassandra / dht / RangeStreamer . java b / src / java / org / apache / cassandra / dht / RangeStreamer . java <nl> index 3b095b1 . . f8e29b6 100644 <nl> - - - a / src / java / org / apache / cassandra / dht / RangeStreamer . java <nl> + + + b / src / java / org / apache / cassandra / dht / RangeStreamer . java <nl> @ @ - 49 , 6 + 49 , 7 @ @ public class RangeStreamer <nl> { <nl> private static final Logger logger = LoggerFactory . getLogger ( RangeStreamer . class ) ; <nl> public static final boolean useStrictConsistency = Boolean . valueOf ( System . getProperty ( " cassandra . consistent . rangemovement " , " true " ) ) ; <nl> + public static final boolean allowSimultaneousMoves = Boolean . valueOf ( System . getProperty ( " cassandra . consistent . simultaneousmoves . allow " , " false " ) ) ; <nl> private final Collection < Token > tokens ; <nl> private final TokenMetadata metadata ; <nl> private final InetAddress address ; <nl> diff - - git a / src / java / org / apache / cassandra / service / StorageService . java b / src / java / org / apache / cassandra / service / StorageService . java <nl> index f134e8a . . 606670c 100644 <nl> - - - a / src / java / org / apache / cassandra / service / StorageService . java <nl> + + + b / src / java / org / apache / cassandra / service / StorageService . java <nl> @ @ - 545 , 7 + 545 , 7 @ @ public class StorageService extends NotificationBroadcasterSupport implements IE <nl> " Use cassandra . replace _ address if you want to replace this node . " , <nl> FBUtilities . getBroadcastAddress ( ) ) ) ; <nl> } <nl> - if ( RangeStreamer . useStrictConsistency ) <nl> + if ( RangeStreamer . useStrictConsistency & & ! allowSimultaneousMoves ( ) ) <nl> { <nl> for ( Map . Entry < InetAddress , EndpointState > entry : Gossiper . instance . getEndpointStates ( ) ) <nl> { <nl> @ @ - 562 , 6 + 562 , 11 @ @ public class StorageService extends NotificationBroadcasterSupport implements IE <nl> Gossiper . instance . resetEndpointStateMap ( ) ; <nl> } <nl> <nl> + private boolean allowSimultaneousMoves ( ) <nl> + { <nl> + return RangeStreamer . allowSimultaneousMoves & & DatabaseDescriptor . getNumTokens ( ) = = 1 ; <nl> + } <nl> + <nl> public synchronized void initClient ( ) throws ConfigurationException <nl> { <nl> / / We don ' t wait , because we ' re going to actually try to work on
NEAREST DIFF (one line): ELIMINATEDSENTENCE

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index 636c15d . . 4b87ed0 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 1 , 4 + 1 , 5 @ @ 
 2 . 1 . 13 
 + * Allow simultaneous bootstrapping with strict consistency when no vnodes are used ( CASSANDRA - 11005 ) 
 * Log a message when major compaction does not result in a single file ( CASSANDRA - 10847 ) 
 * ( cqlsh ) fix cqlsh _ copy _ tests when vnodes are disabled ( CASSANDRA - 10997 ) 
 * ( cqlsh ) fix formatting bytearray values ( CASSANDRA - 10839 ) 
 diff - - git a / src / java / org / apache / cassandra / dht / RangeStreamer . java b / src / java / org / apache / cassandra / dht / RangeStreamer . java 
 index 3b095b1 . . f8e29b6 100644 
 - - - a / src / java / org / apache / cassandra / dht / RangeStreamer . java 
 + + + b / src / java / org / apache / cassandra / dht / RangeStreamer . java 
 @ @ - 49 , 6 + 49 , 7 @ @ public class RangeStreamer 
 { 
 private static final Logger logger = LoggerFactory . getLogger ( RangeStreamer . class ) ; 
 public static final boolean useStrictConsistency = Boolean . valueOf ( System . getProperty ( " cassandra . consistent . rangemovement " , " true " ) ) ; 
 + public static final boolean allowSimultaneousMoves = Boolean . valueOf ( System . getProperty ( " cassandra . consistent . simultaneousmoves . allow " , " false " ) ) ; 
 private final Collection < Token > tokens ; 
 private final TokenMetadata metadata ; 
 private final InetAddress address ; 
 diff - - git a / src / java / org / apache / cassandra / service / StorageService . java b / src / java / org / apache / cassandra / service / StorageService . java 
 index f134e8a . . 606670c 100644 
 - - - a / src / java / org / apache / cassandra / service / StorageService . java 
 + + + b / src / java / org / apache / cassandra / service / StorageService . java 
 @ @ - 545 , 7 + 545 , 7 @ @ public class StorageService extends NotificationBroadcasterSupport implements IE 
 " Use cassandra . replace _ address if you want to replace this node . " , 
 FBUtilities . getBroadcastAddress ( ) ) ) ; 
 } 
 - if ( RangeStreamer . useStrictConsistency ) 
 + if ( RangeStreamer . useStrictConsistency & & ! allowSimultaneousMoves ( ) ) 
 { 
 for ( Map . Entry < InetAddress , EndpointState > entry : Gossiper . instance . getEndpointStates ( ) ) 
 { 
 @ @ - 562 , 6 + 562 , 11 @ @ public class StorageService extends NotificationBroadcasterSupport implements IE 
 Gossiper . instance . resetEndpointStateMap ( ) ; 
 } 
 
 + private boolean allowSimultaneousMoves ( ) 
 + { 
 + return RangeStreamer . allowSimultaneousMoves & & DatabaseDescriptor . getNumTokens ( ) = = 1 ; 
 + } 
 + 
 public synchronized void initClient ( ) throws ConfigurationException 
 { 
 / / We don ' t wait , because we ' re going to actually try to work on

NEAREST DIFF:
ELIMINATEDSENTENCE
