BLEU SCORE: 0.01763751180315069

TEST MSG: Remove default method AbstractRow . isEmpty
GENERATED MSG: LazilyCompactedRow and QueryFilter incorrectly claimed their trivial reduce case was trivial

TEST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / db / rows / AbstractRow . java b / src / java / org / apache / cassandra / db / rows / AbstractRow . java <nl> index 807d805 . . 6090274 100644 <nl> - - - a / src / java / org / apache / cassandra / db / rows / AbstractRow . java <nl> + + + b / src / java / org / apache / cassandra / db / rows / AbstractRow . java <nl> @ @ - 49 , 13 + 49 , 6 @ @ public abstract class AbstractRow implements Row <nl> return Iterables . any ( cells ( ) , cell - > cell . isLive ( nowInSec ) ) ; <nl> } <nl> <nl> - public boolean isEmpty ( ) <nl> - { <nl> - return primaryKeyLivenessInfo ( ) . isEmpty ( ) <nl> - & & deletion ( ) . isLive ( ) <nl> - & & ! iterator ( ) . hasNext ( ) ; <nl> - } <nl> - <nl> public boolean isStatic ( ) <nl> { <nl> return clustering ( ) = = Clustering . STATIC _ CLUSTERING ; <nl> diff - - git a / src / java / org / apache / cassandra / db / rows / BTreeBackedRow . java b / src / java / org / apache / cassandra / db / rows / BTreeBackedRow . java <nl> index 2e0d320 . . 548fb82 100644 <nl> - - - a / src / java / org / apache / cassandra / db / rows / BTreeBackedRow . java <nl> + + + b / src / java / org / apache / cassandra / db / rows / BTreeBackedRow . java <nl> @ @ - 42 , 8 + 42 , 6 @ @ import org . apache . cassandra . utils . btree . UpdateFunction ; <nl> * / <nl> public class BTreeBackedRow extends AbstractRow <nl> { <nl> - private static final ColumnData [ ] NO _ DATA = new ColumnData [ 0 ] ; <nl> - <nl> private static final long EMPTY _ SIZE = ObjectSizes . measure ( emptyRow ( Clustering . EMPTY ) ) ; <nl> <nl> private final Clustering clustering ; <nl> @ @ - 171 , 6 + 169 , 13 @ @ public class BTreeBackedRow extends AbstractRow <nl> return primaryKeyLivenessInfo ; <nl> } <nl> <nl> + public boolean isEmpty ( ) <nl> + { <nl> + return primaryKeyLivenessInfo ( ) . isEmpty ( ) <nl> + & & deletion ( ) . isLive ( ) <nl> + & & BTree . isEmpty ( btree ) ; <nl> + } <nl> + <nl> public DeletionTime deletion ( ) <nl> { <nl> return deletion ;
NEAREST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / db / RowIteratorFactory . java b / src / java / org / apache / cassandra / db / RowIteratorFactory . java <nl> index eb457c0 . . a835a21 100644 <nl> - - - a / src / java / org / apache / cassandra / db / RowIteratorFactory . java <nl> + + + b / src / java / org / apache / cassandra / db / RowIteratorFactory . java <nl> @ @ - 100 , 11 + 100 , 6 @ @ public class RowIteratorFactory <nl> private DecoratedKey key ; <nl> private ColumnFamily returnCF ; <nl> <nl> - public boolean trivialReduceIsTrivial ( ) <nl> - { <nl> - return false ; <nl> - } <nl> - <nl> @ Override <nl> protected void onKeyChange ( ) <nl> { <nl> diff - - git a / src / java / org / apache / cassandra / db / compaction / CompactionIterable . java b / src / java / org / apache / cassandra / db / compaction / CompactionIterable . java <nl> index 4d1f6ab . . bb8d2bd 100644 <nl> - - - a / src / java / org / apache / cassandra / db / compaction / CompactionIterable . java <nl> + + + b / src / java / org / apache / cassandra / db / compaction / CompactionIterable . java <nl> @ @ - 88 , 11 + 88 , 6 @ @ public class CompactionIterable extends AbstractCompactionIterable <nl> { <nl> protected final List < SSTableIdentityIterator > rows = new ArrayList < SSTableIdentityIterator > ( ) ; <nl> <nl> - public boolean trivialReduceIsTrivial ( ) <nl> - { <nl> - return false ; <nl> - } <nl> - <nl> public void reduce ( IColumnIterator current ) <nl> { <nl> rows . add ( ( SSTableIdentityIterator ) current ) ; <nl> diff - - git a / src / java / org / apache / cassandra / db / compaction / LazilyCompactedRow . java b / src / java / org / apache / cassandra / db / compaction / LazilyCompactedRow . java <nl> index 5eea926 . . 4b0f56f 100644 <nl> - - - a / src / java / org / apache / cassandra / db / compaction / LazilyCompactedRow . java <nl> + + + b / src / java / org / apache / cassandra / db / compaction / LazilyCompactedRow . java <nl> @ @ - 215 , 11 + 215 , 6 @ @ public class LazilyCompactedRow extends AbstractCompactedRow implements IIterabl <nl> int size = 0 ; <nl> long maxTimestampSeen = Long . MIN _ VALUE ; <nl> <nl> - public boolean trivialReduceIsTrivial ( ) <nl> - { <nl> - return true ; <nl> - } <nl> - <nl> public void reduce ( IColumn current ) <nl> { <nl> container . addColumn ( current ) ; <nl> diff - - git a / src / java / org / apache / cassandra / db / compaction / ParallelCompactionIterable . java b / src / java / org / apache / cassandra / db / compaction / ParallelCompactionIterable . java <nl> index c6000b0 . . e9bf574 100644 <nl> - - - a / src / java / org / apache / cassandra / db / compaction / ParallelCompactionIterable . java <nl> + + + b / src / java / org / apache / cassandra / db / compaction / ParallelCompactionIterable . java <nl> @ @ - 148 , 11 + 148 , 6 @ @ public class ParallelCompactionIterable extends AbstractCompactionIterable <nl> private final ThreadPoolExecutor executor ; <nl> private int row = 0 ; <nl> <nl> - public boolean trivialReduceIsTrivial ( ) <nl> - { <nl> - return false ; <nl> - } <nl> - <nl> private Reducer ( ) <nl> { <nl> super ( ) ; <nl> diff - - git a / src / java / org / apache / cassandra / db / filter / QueryFilter . java b / src / java / org / apache / cassandra / db / filter / QueryFilter . java <nl> index cdf7b0f . . c27d636 100644 <nl> - - - a / src / java / org / apache / cassandra / db / filter / QueryFilter . java <nl> + + + b / src / java / org / apache / cassandra / db / filter / QueryFilter . java <nl> @ @ - 97 , 11 + 97 , 6 @ @ public class QueryFilter <nl> { <nl> ColumnFamily curCF = returnCF . cloneMeShallow ( ) ; <nl> <nl> - public boolean trivialReduceIsTrivial ( ) <nl> - { <nl> - return true ; <nl> - } <nl> - <nl> protected boolean isEqual ( IColumn o1 , IColumn o2 ) <nl> { <nl> return o1 . name ( ) . equals ( o2 . name ( ) ) ; <nl> diff - - git a / src / java / org / apache / cassandra / io / sstable / ReducingKeyIterator . java b / src / java / org / apache / cassandra / io / sstable / ReducingKeyIterator . java <nl> index cdcd875 . . af5922b 100644 <nl> - - - a / src / java / org / apache / cassandra / io / sstable / ReducingKeyIterator . java <nl> + + + b / src / java / org / apache / cassandra / io / sstable / ReducingKeyIterator . java <nl> @ @ - 43 , 6 + 43 , 7 @ @ public class ReducingKeyIterator implements CloseableIterator < DecoratedKey > <nl> { <nl> DecoratedKey < ? > reduced = null ; <nl> <nl> + @ Override <nl> public boolean trivialReduceIsTrivial ( ) <nl> { <nl> return true ; <nl> diff - - git a / src / java / org / apache / cassandra / service / RangeSliceResponseResolver . java b / src / java / org / apache / cassandra / service / RangeSliceResponseResolver . java <nl> index 618f55e . . 3be61d1 100644 <nl> - - - a / src / java / org / apache / cassandra / service / RangeSliceResponseResolver . java <nl> + + + b / src / java / org / apache / cassandra / service / RangeSliceResponseResolver . java <nl> @ @ - 141 , 11 + 141 , 6 @ @ public class RangeSliceResponseResolver implements IResponseResolver < Iterable < Ro <nl> List < InetAddress > versionSources = new ArrayList < InetAddress > ( sources . size ( ) ) ; <nl> DecoratedKey key ; <nl> <nl> - public boolean trivialReduceIsTrivial ( ) <nl> - { <nl> - return false ; <nl> - } <nl> - <nl> public void reduce ( Pair < Row , InetAddress > current ) <nl> { <nl> key = current . left . key ; <nl> diff - - git a / src / java / org / apache / cassandra / utils / MergeIterator . java b / src / java / org / apache / cassandra / utils / MergeIterator . java <nl> index ecfc725 . . fbba415 100644 <nl> - - - a / src / java / org / apache / cassandra / utils / MergeIterator . java <nl> + + + b / src / java / org / apache / cassandra / utils / MergeIterator . java <nl> @ @ - 161 , 7 + 161 , 10 @ @ public abstract class MergeIterator < In , Out > extends AbstractIterator < Out > implem <nl> / * * <nl> * @ return true if Out is the same as In for the case of a single source iterator <nl> * / <nl> - public abstract boolean trivialReduceIsTrivial ( ) ; <nl> + public boolean trivialReduceIsTrivial ( ) <nl> + { <nl> + return false ; <nl> + } <nl> <nl> / * * <nl> * combine this object with the previous ones . <nl> diff - - git a / test / unit / org / apache / cassandra / utils / MergeIteratorTest . java b / test / unit / org / apache / cassandra / utils / MergeIteratorTest . java <nl> index 2ff4fd9 . . 01e8c97 100644 <nl> - - - a / test / unit / org / apache / cassandra / utils / MergeIteratorTest . java <nl> + + + b / test / unit / org / apache / cassandra / utils / MergeIteratorTest . java <nl> @ @ - 51 , 11 + 51 , 6 @ @ public class MergeIteratorTest <nl> { <nl> String concatted = " " ; <nl> <nl> - public boolean trivialReduceIsTrivial ( ) <nl> - { <nl> - return false ; / / technically true , but let ' s not optimize anything away here . . . <nl> - } <nl> - <nl> public void reduce ( String value ) <nl> { <nl> concatted + = value ;

TEST DIFF:
diff - - git a / src / java / org / apache / cassandra / db / rows / AbstractRow . java b / src / java / org / apache / cassandra / db / rows / AbstractRow . java 
 index 807d805 . . 6090274 100644 
 - - - a / src / java / org / apache / cassandra / db / rows / AbstractRow . java 
 + + + b / src / java / org / apache / cassandra / db / rows / AbstractRow . java 
 @ @ - 49 , 13 + 49 , 6 @ @ public abstract class AbstractRow implements Row 
 return Iterables . any ( cells ( ) , cell - > cell . isLive ( nowInSec ) ) ; 
 } 
 
 - public boolean isEmpty ( ) 
 - { 
 - return primaryKeyLivenessInfo ( ) . isEmpty ( ) 
 - & & deletion ( ) . isLive ( ) 
 - & & ! iterator ( ) . hasNext ( ) ; 
 - } 
 - 
 public boolean isStatic ( ) 
 { 
 return clustering ( ) = = Clustering . STATIC _ CLUSTERING ; 
 diff - - git a / src / java / org / apache / cassandra / db / rows / BTreeBackedRow . java b / src / java / org / apache / cassandra / db / rows / BTreeBackedRow . java 
 index 2e0d320 . . 548fb82 100644 
 - - - a / src / java / org / apache / cassandra / db / rows / BTreeBackedRow . java 
 + + + b / src / java / org / apache / cassandra / db / rows / BTreeBackedRow . java 
 @ @ - 42 , 8 + 42 , 6 @ @ import org . apache . cassandra . utils . btree . UpdateFunction ; 
 * / 
 public class BTreeBackedRow extends AbstractRow 
 { 
 - private static final ColumnData [ ] NO _ DATA = new ColumnData [ 0 ] ; 
 - 
 private static final long EMPTY _ SIZE = ObjectSizes . measure ( emptyRow ( Clustering . EMPTY ) ) ; 
 
 private final Clustering clustering ; 
 @ @ - 171 , 6 + 169 , 13 @ @ public class BTreeBackedRow extends AbstractRow 
 return primaryKeyLivenessInfo ; 
 } 
 
 + public boolean isEmpty ( ) 
 + { 
 + return primaryKeyLivenessInfo ( ) . isEmpty ( ) 
 + & & deletion ( ) . isLive ( ) 
 + & & BTree . isEmpty ( btree ) ; 
 + } 
 + 
 public DeletionTime deletion ( ) 
 { 
 return deletion ;

NEAREST DIFF:
diff - - git a / src / java / org / apache / cassandra / db / RowIteratorFactory . java b / src / java / org / apache / cassandra / db / RowIteratorFactory . java 
 index eb457c0 . . a835a21 100644 
 - - - a / src / java / org / apache / cassandra / db / RowIteratorFactory . java 
 + + + b / src / java / org / apache / cassandra / db / RowIteratorFactory . java 
 @ @ - 100 , 11 + 100 , 6 @ @ public class RowIteratorFactory 
 private DecoratedKey key ; 
 private ColumnFamily returnCF ; 
 
 - public boolean trivialReduceIsTrivial ( ) 
 - { 
 - return false ; 
 - } 
 - 
 @ Override 
 protected void onKeyChange ( ) 
 { 
 diff - - git a / src / java / org / apache / cassandra / db / compaction / CompactionIterable . java b / src / java / org / apache / cassandra / db / compaction / CompactionIterable . java 
 index 4d1f6ab . . bb8d2bd 100644 
 - - - a / src / java / org / apache / cassandra / db / compaction / CompactionIterable . java 
 + + + b / src / java / org / apache / cassandra / db / compaction / CompactionIterable . java 
 @ @ - 88 , 11 + 88 , 6 @ @ public class CompactionIterable extends AbstractCompactionIterable 
 { 
 protected final List < SSTableIdentityIterator > rows = new ArrayList < SSTableIdentityIterator > ( ) ; 
 
 - public boolean trivialReduceIsTrivial ( ) 
 - { 
 - return false ; 
 - } 
 - 
 public void reduce ( IColumnIterator current ) 
 { 
 rows . add ( ( SSTableIdentityIterator ) current ) ; 
 diff - - git a / src / java / org / apache / cassandra / db / compaction / LazilyCompactedRow . java b / src / java / org / apache / cassandra / db / compaction / LazilyCompactedRow . java 
 index 5eea926 . . 4b0f56f 100644 
 - - - a / src / java / org / apache / cassandra / db / compaction / LazilyCompactedRow . java 
 + + + b / src / java / org / apache / cassandra / db / compaction / LazilyCompactedRow . java 
 @ @ - 215 , 11 + 215 , 6 @ @ public class LazilyCompactedRow extends AbstractCompactedRow implements IIterabl 
 int size = 0 ; 
 long maxTimestampSeen = Long . MIN _ VALUE ; 
 
 - public boolean trivialReduceIsTrivial ( ) 
 - { 
 - return true ; 
 - } 
 - 
 public void reduce ( IColumn current ) 
 { 
 container . addColumn ( current ) ; 
 diff - - git a / src / java / org / apache / cassandra / db / compaction / ParallelCompactionIterable . java b / src / java / org / apache / cassandra / db / compaction / ParallelCompactionIterable . java 
 index c6000b0 . . e9bf574 100644 
 - - - a / src / java / org / apache / cassandra / db / compaction / ParallelCompactionIterable . java 
 + + + b / src / java / org / apache / cassandra / db / compaction / ParallelCompactionIterable . java 
 @ @ - 148 , 11 + 148 , 6 @ @ public class ParallelCompactionIterable extends AbstractCompactionIterable 
 private final ThreadPoolExecutor executor ; 
 private int row = 0 ; 
 
 - public boolean trivialReduceIsTrivial ( ) 
 - { 
 - return false ; 
 - } 
 - 
 private Reducer ( ) 
 { 
 super ( ) ; 
 diff - - git a / src / java / org / apache / cassandra / db / filter / QueryFilter . java b / src / java / org / apache / cassandra / db / filter / QueryFilter . java 
 index cdf7b0f . . c27d636 100644 
 - - - a / src / java / org / apache / cassandra / db / filter / QueryFilter . java 
 + + + b / src / java / org / apache / cassandra / db / filter / QueryFilter . java 
 @ @ - 97 , 11 + 97 , 6 @ @ public class QueryFilter 
 { 
 ColumnFamily curCF = returnCF . cloneMeShallow ( ) ; 
 
 - public boolean trivialReduceIsTrivial ( ) 
 - { 
 - return true ; 
 - } 
 - 
 protected boolean isEqual ( IColumn o1 , IColumn o2 ) 
 { 
 return o1 . name ( ) . equals ( o2 . name ( ) ) ; 
 diff - - git a / src / java / org / apache / cassandra / io / sstable / ReducingKeyIterator . java b / src / java / org / apache / cassandra / io / sstable / ReducingKeyIterator . java 
 index cdcd875 . . af5922b 100644 
 - - - a / src / java / org / apache / cassandra / io / sstable / ReducingKeyIterator . java 
 + + + b / src / java / org / apache / cassandra / io / sstable / ReducingKeyIterator . java 
 @ @ - 43 , 6 + 43 , 7 @ @ public class ReducingKeyIterator implements CloseableIterator < DecoratedKey > 
 { 
 DecoratedKey < ? > reduced = null ; 
 
 + @ Override 
 public boolean trivialReduceIsTrivial ( ) 
 { 
 return true ; 
 diff - - git a / src / java / org / apache / cassandra / service / RangeSliceResponseResolver . java b / src / java / org / apache / cassandra / service / RangeSliceResponseResolver . java 
 index 618f55e . . 3be61d1 100644 
 - - - a / src / java / org / apache / cassandra / service / RangeSliceResponseResolver . java 
 + + + b / src / java / org / apache / cassandra / service / RangeSliceResponseResolver . java 
 @ @ - 141 , 11 + 141 , 6 @ @ public class RangeSliceResponseResolver implements IResponseResolver < Iterable < Ro 
 List < InetAddress > versionSources = new ArrayList < InetAddress > ( sources . size ( ) ) ; 
 DecoratedKey key ; 
 
 - public boolean trivialReduceIsTrivial ( ) 
 - { 
 - return false ; 
 - } 
 - 
 public void reduce ( Pair < Row , InetAddress > current ) 
 { 
 key = current . left . key ; 
 diff - - git a / src / java / org / apache / cassandra / utils / MergeIterator . java b / src / java / org / apache / cassandra / utils / MergeIterator . java 
 index ecfc725 . . fbba415 100644 
 - - - a / src / java / org / apache / cassandra / utils / MergeIterator . java 
 + + + b / src / java / org / apache / cassandra / utils / MergeIterator . java 
 @ @ - 161 , 7 + 161 , 10 @ @ public abstract class MergeIterator < In , Out > extends AbstractIterator < Out > implem 
 / * * 
 * @ return true if Out is the same as In for the case of a single source iterator 
 * / 
 - public abstract boolean trivialReduceIsTrivial ( ) ; 
 + public boolean trivialReduceIsTrivial ( ) 
 + { 
 + return false ; 
 + } 
 
 / * * 
 * combine this object with the previous ones . 
 diff - - git a / test / unit / org / apache / cassandra / utils / MergeIteratorTest . java b / test / unit / org / apache / cassandra / utils / MergeIteratorTest . java 
 index 2ff4fd9 . . 01e8c97 100644 
 - - - a / test / unit / org / apache / cassandra / utils / MergeIteratorTest . java 
 + + + b / test / unit / org / apache / cassandra / utils / MergeIteratorTest . java 
 @ @ - 51 , 11 + 51 , 6 @ @ public class MergeIteratorTest 
 { 
 String concatted = " " ; 
 
 - public boolean trivialReduceIsTrivial ( ) 
 - { 
 - return false ; / / technically true , but let ' s not optimize anything away here . . . 
 - } 
 - 
 public void reduce ( String value ) 
 { 
 concatted + = value ;
