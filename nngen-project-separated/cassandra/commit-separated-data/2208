BLEU SCORE: 0.08392229812593097

TEST MSG: Don ' t depend on cassandra config for nodetool ring
GENERATED MSG: Fix configuration error when running nodetool ring

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index 53d3297 . . 3d31948 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 1 , 4 + 1 , 5 @ @ <nl> 2 . 0 . 10 <nl> + * Don ' t depend on cassandra config for nodetool ring ( CASSANDRA - 7508 ) <nl> * ( cqlsh ) Fix failing cqlsh formatting tests ( CASSANDRA - 7703 ) <nl> * Fix MS expiring map timeout for Paxos messages ( CASSANDRA - 7752 ) <nl> * Do not flush on truncate if durable _ writes is false ( CASSANDRA - 7750 ) <nl> diff - - git a / src / java / org / apache / cassandra / tools / NodeCmd . java b / src / java / org / apache / cassandra / tools / NodeCmd . java <nl> index aeed913 . . 4d9992f 100644 <nl> - - - a / src / java / org / apache / cassandra / tools / NodeCmd . java <nl> + + + b / src / java / org / apache / cassandra / tools / NodeCmd . java <nl> @ @ - 34 , 7 + 34 , 6 @ @ import com . google . common . collect . ArrayListMultimap ; <nl> import com . google . common . collect . LinkedHashMultimap ; <nl> import com . google . common . collect . Maps ; <nl> <nl> - import org . apache . cassandra . config . DatabaseDescriptor ; <nl> import org . apache . cassandra . utils . FBUtilities ; <nl> import org . apache . commons . cli . * ; <nl> import org . yaml . snakeyaml . Yaml ; <nl> @ @ - 254 , 8 + 253 , 12 @ @ public class NodeCmd <nl> { <nl> Map < String , String > tokensToEndpoints = probe . getTokenToEndpointMap ( ) ; <nl> LinkedHashMultimap < String , String > endpointsToTokens = LinkedHashMultimap . create ( ) ; <nl> + boolean haveVnodes = false ; <nl> for ( Map . Entry < String , String > entry : tokensToEndpoints . entrySet ( ) ) <nl> + { <nl> + haveVnodes | = endpointsToTokens . containsKey ( entry . getValue ( ) ) ; <nl> endpointsToTokens . put ( entry . getValue ( ) , entry . getKey ( ) ) ; <nl> + } <nl> <nl> int maxAddressLength = Collections . max ( endpointsToTokens . keys ( ) , new Comparator < String > ( ) { <nl> @ Override <nl> @ @ - 293 , 7 + 296 , 7 @ @ public class NodeCmd <nl> throw new RuntimeException ( e ) ; <nl> } <nl> <nl> - if ( DatabaseDescriptor . getNumTokens ( ) > 1 ) <nl> + if ( haveVnodes ) <nl> { <nl> outs . println ( " Warning : \ " nodetool ring \ " is used to output all the tokens of a node . " ) ; <nl> outs . println ( " To view status related info of a node use \ " nodetool status \ " instead . \ n " ) ;
NEAREST DIFF (one line): ELIMINATEDSENTENCE

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index 53d3297 . . 3d31948 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 1 , 4 + 1 , 5 @ @ 
 2 . 0 . 10 
 + * Don ' t depend on cassandra config for nodetool ring ( CASSANDRA - 7508 ) 
 * ( cqlsh ) Fix failing cqlsh formatting tests ( CASSANDRA - 7703 ) 
 * Fix MS expiring map timeout for Paxos messages ( CASSANDRA - 7752 ) 
 * Do not flush on truncate if durable _ writes is false ( CASSANDRA - 7750 ) 
 diff - - git a / src / java / org / apache / cassandra / tools / NodeCmd . java b / src / java / org / apache / cassandra / tools / NodeCmd . java 
 index aeed913 . . 4d9992f 100644 
 - - - a / src / java / org / apache / cassandra / tools / NodeCmd . java 
 + + + b / src / java / org / apache / cassandra / tools / NodeCmd . java 
 @ @ - 34 , 7 + 34 , 6 @ @ import com . google . common . collect . ArrayListMultimap ; 
 import com . google . common . collect . LinkedHashMultimap ; 
 import com . google . common . collect . Maps ; 
 
 - import org . apache . cassandra . config . DatabaseDescriptor ; 
 import org . apache . cassandra . utils . FBUtilities ; 
 import org . apache . commons . cli . * ; 
 import org . yaml . snakeyaml . Yaml ; 
 @ @ - 254 , 8 + 253 , 12 @ @ public class NodeCmd 
 { 
 Map < String , String > tokensToEndpoints = probe . getTokenToEndpointMap ( ) ; 
 LinkedHashMultimap < String , String > endpointsToTokens = LinkedHashMultimap . create ( ) ; 
 + boolean haveVnodes = false ; 
 for ( Map . Entry < String , String > entry : tokensToEndpoints . entrySet ( ) ) 
 + { 
 + haveVnodes | = endpointsToTokens . containsKey ( entry . getValue ( ) ) ; 
 endpointsToTokens . put ( entry . getValue ( ) , entry . getKey ( ) ) ; 
 + } 
 
 int maxAddressLength = Collections . max ( endpointsToTokens . keys ( ) , new Comparator < String > ( ) { 
 @ Override 
 @ @ - 293 , 7 + 296 , 7 @ @ public class NodeCmd 
 throw new RuntimeException ( e ) ; 
 } 
 
 - if ( DatabaseDescriptor . getNumTokens ( ) > 1 ) 
 + if ( haveVnodes ) 
 { 
 outs . println ( " Warning : \ " nodetool ring \ " is used to output all the tokens of a node . " ) ; 
 outs . println ( " To view status related info of a node use \ " nodetool status \ " instead . \ n " ) ;

NEAREST DIFF:
ELIMINATEDSENTENCE
