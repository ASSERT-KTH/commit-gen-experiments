BLEU SCORE: 0.011499609862079688

TEST MSG: Fix unwanted schema pull while upgrading nodes from 1 . 2 to 2 . 0
GENERATED MSG: r / m assert that is causing test problems ( see # 3116 , # 3399 )

TEST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / service / MigrationManager . java b / src / java / org / apache / cassandra / service / MigrationManager . java <nl> index b463116 . . fdcefe4 100644 <nl> - - - a / src / java / org / apache / cassandra / service / MigrationManager . java <nl> + + + b / src / java / org / apache / cassandra / service / MigrationManager . java <nl> @ @ - 137 , 8 + 137 , 9 @ @ public class MigrationManager <nl> * Don ' t request schema from nodes with a higher major ( may have incompatible schema ) <nl> * Don ' t request schema from fat clients <nl> * / <nl> - return MessagingService . instance ( ) . getVersion ( endpoint ) < = MessagingService . current _ version <nl> - & & ! Gossiper . instance . isFatClient ( endpoint ) ; <nl> + return MessagingService . instance ( ) . knowsVersion ( endpoint ) <nl> + & & MessagingService . instance ( ) . getVersion ( endpoint ) < = MessagingService . current _ version <nl> + & & ! Gossiper . instance . isFatClient ( endpoint ) ; <nl> } <nl> <nl> public static boolean isReadyForBootstrap ( )
NEAREST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index 7512c9d . . f614f05 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 82 , 7 + 82 , 6 @ @ Merged from 0 . 8 : <nl> * Fix race in AntiEntropyService ( CASSANDRA - 3400 ) <nl> * allow encryption only between datacenters ( CASSANDRA - 2802 ) <nl> <nl> - <nl> 1 . 0 . 0 - final <nl> * close scrubbed sstable fd before deleting it ( CASSANDRA - 3318 ) <nl> * fix bug preventing obsolete commitlog segments from being removed <nl> diff - - git a / src / java / org / apache / cassandra / gms / Gossiper . java b / src / java / org / apache / cassandra / gms / Gossiper . java <nl> index 560bd8b . . 92f61ff 100644 <nl> - - - a / src / java / org / apache / cassandra / gms / Gossiper . java <nl> + + + b / src / java / org / apache / cassandra / gms / Gossiper . java <nl> @ @ - 798 , 7 + 798 , 7 @ @ public class Gossiper implements IFailureDetectionEventListener , GossiperMBean <nl> subscriber . onJoin ( ep , epState ) ; <nl> } <nl> <nl> - public Boolean isDeadState ( EndpointState epState ) <nl> + private Boolean isDeadState ( EndpointState epState ) <nl> { <nl> if ( epState . getApplicationState ( ApplicationState . STATUS ) = = null ) <nl> return false ;

TEST DIFF:
diff - - git a / src / java / org / apache / cassandra / service / MigrationManager . java b / src / java / org / apache / cassandra / service / MigrationManager . java 
 index b463116 . . fdcefe4 100644 
 - - - a / src / java / org / apache / cassandra / service / MigrationManager . java 
 + + + b / src / java / org / apache / cassandra / service / MigrationManager . java 
 @ @ - 137 , 8 + 137 , 9 @ @ public class MigrationManager 
 * Don ' t request schema from nodes with a higher major ( may have incompatible schema ) 
 * Don ' t request schema from fat clients 
 * / 
 - return MessagingService . instance ( ) . getVersion ( endpoint ) < = MessagingService . current _ version 
 - & & ! Gossiper . instance . isFatClient ( endpoint ) ; 
 + return MessagingService . instance ( ) . knowsVersion ( endpoint ) 
 + & & MessagingService . instance ( ) . getVersion ( endpoint ) < = MessagingService . current _ version 
 + & & ! Gossiper . instance . isFatClient ( endpoint ) ; 
 } 
 
 public static boolean isReadyForBootstrap ( )

NEAREST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index 7512c9d . . f614f05 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 82 , 7 + 82 , 6 @ @ Merged from 0 . 8 : 
 * Fix race in AntiEntropyService ( CASSANDRA - 3400 ) 
 * allow encryption only between datacenters ( CASSANDRA - 2802 ) 
 
 - 
 1 . 0 . 0 - final 
 * close scrubbed sstable fd before deleting it ( CASSANDRA - 3318 ) 
 * fix bug preventing obsolete commitlog segments from being removed 
 diff - - git a / src / java / org / apache / cassandra / gms / Gossiper . java b / src / java / org / apache / cassandra / gms / Gossiper . java 
 index 560bd8b . . 92f61ff 100644 
 - - - a / src / java / org / apache / cassandra / gms / Gossiper . java 
 + + + b / src / java / org / apache / cassandra / gms / Gossiper . java 
 @ @ - 798 , 7 + 798 , 7 @ @ public class Gossiper implements IFailureDetectionEventListener , GossiperMBean 
 subscriber . onJoin ( ep , epState ) ; 
 } 
 
 - public Boolean isDeadState ( EndpointState epState ) 
 + private Boolean isDeadState ( EndpointState epState ) 
 { 
 if ( epState . getApplicationState ( ApplicationState . STATUS ) = = null ) 
 return false ;
