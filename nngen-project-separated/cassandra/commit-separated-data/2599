BLEU SCORE: 1.4039360358397666E-4

TEST MSG: Post - CASSANDRA - 6945 tweak
GENERATED MSG: avoid creating empty sstables on recovery flush . ( a ) empty sstables are still work for the compactor later , and ( b ) sstable . close errors out when it ' s empty . patch by jbellis .

TEST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / db / Memtable . java b / src / java / org / apache / cassandra / db / Memtable . java <nl> index b26b7cd . . ea79e9c 100644 <nl> - - - a / src / java / org / apache / cassandra / db / Memtable . java <nl> + + + b / src / java / org / apache / cassandra / db / Memtable . java <nl> @ @ - 131 , 7 + 131 , 7 @ @ public class Memtable <nl> if ( previous ! = null ) <nl> { <nl> liveRatio = previous . liveRatio ; <nl> - liveRatioComputedAt . set ( previous . liveRatioComputedAt . get ( ) / 2 ) ; <nl> + liveRatioComputedAt . set ( previous . liveRatioComputedAt . get ( ) / 4 ) ; <nl> } <nl> <nl> Callable < Set < Object > > provider = new Callable < Set < Object > > ( )
NEAREST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / db / Memtable . java b / src / java / org / apache / cassandra / db / Memtable . java <nl> index 6481cc0 . . f66e812 100644 <nl> - - - a / src / java / org / apache / cassandra / db / Memtable . java <nl> + + + b / src / java / org / apache / cassandra / db / Memtable . java <nl> @ @ - 226 , 7 + 226 , 8 @ @ public class Memtable implements Comparable < Memtable > <nl> } <nl> <nl> void flushOnRecovery ( ) throws IOException { <nl> - flush ( CommitLog . CommitLogContext . NULL ) ; <nl> + if ( ! isClean ( ) ) <nl> + flush ( CommitLog . CommitLogContext . NULL ) ; <nl> } <nl> <nl> private void resolve ( String key , ColumnFamily columnFamily )

TEST DIFF:
diff - - git a / src / java / org / apache / cassandra / db / Memtable . java b / src / java / org / apache / cassandra / db / Memtable . java 
 index b26b7cd . . ea79e9c 100644 
 - - - a / src / java / org / apache / cassandra / db / Memtable . java 
 + + + b / src / java / org / apache / cassandra / db / Memtable . java 
 @ @ - 131 , 7 + 131 , 7 @ @ public class Memtable 
 if ( previous ! = null ) 
 { 
 liveRatio = previous . liveRatio ; 
 - liveRatioComputedAt . set ( previous . liveRatioComputedAt . get ( ) / 2 ) ; 
 + liveRatioComputedAt . set ( previous . liveRatioComputedAt . get ( ) / 4 ) ; 
 } 
 
 Callable < Set < Object > > provider = new Callable < Set < Object > > ( )

NEAREST DIFF:
diff - - git a / src / java / org / apache / cassandra / db / Memtable . java b / src / java / org / apache / cassandra / db / Memtable . java 
 index 6481cc0 . . f66e812 100644 
 - - - a / src / java / org / apache / cassandra / db / Memtable . java 
 + + + b / src / java / org / apache / cassandra / db / Memtable . java 
 @ @ - 226 , 7 + 226 , 8 @ @ public class Memtable implements Comparable < Memtable > 
 } 
 
 void flushOnRecovery ( ) throws IOException { 
 - flush ( CommitLog . CommitLogContext . NULL ) ; 
 + if ( ! isClean ( ) ) 
 + flush ( CommitLog . CommitLogContext . NULL ) ; 
 } 
 
 private void resolve ( String key , ColumnFamily columnFamily )
