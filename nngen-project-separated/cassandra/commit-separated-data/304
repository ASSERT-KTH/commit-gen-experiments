BLEU SCORE: 0.029079340872079116

TEST MSG: enable segement creation before recovering commitlogs
GENERATED MSG: enableReserveSegmentCreation even when there is nothing to replay

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index 6609b05 . . 452dc9b 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 1 , 4 + 1 , 5 @ @ <nl> 3 . 0 . 15 <nl> + * enable segement creation before recovering commitlogs ( CASSANDRA - 13587 ) <nl> * Fix AssertionError in short read protection ( CASSANDRA - 13747 ) <nl> * Don ' t skip corrupted sstables on startup ( CASSANDRA - 13620 ) <nl> * Fix the merging of cells with different user type versions ( CASSANDRA - 13776 ) <nl> diff - - git a / src / java / org / apache / cassandra / db / commitlog / CommitLog . java b / src / java / org / apache / cassandra / db / commitlog / CommitLog . java <nl> index d167735 . . 40040ed 100644 <nl> - - - a / src / java / org / apache / cassandra / db / commitlog / CommitLog . java <nl> + + + b / src / java / org / apache / cassandra / db / commitlog / CommitLog . java <nl> @ @ - 150 , 6 + 150 , 7 @ @ public class CommitLog implements CommitLogMBean <nl> <nl> File [ ] files = new File ( DatabaseDescriptor . getCommitLogLocation ( ) ) . listFiles ( unmanagedFilesFilter ) ; <nl> int replayed = 0 ; <nl> + allocator . enableReserveSegmentCreation ( ) ; <nl> if ( files . length = = 0 ) <nl> { <nl> logger . info ( " No commitlog files found ; skipping replay " ) ; <nl> @ @ - 165 , 7 + 166 , 6 @ @ public class CommitLog implements CommitLogMBean <nl> allocator . recycleSegment ( f ) ; <nl> } <nl> <nl> - allocator . enableReserveSegmentCreation ( ) ; <nl> return replayed ; <nl> } <nl>
NEAREST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / service / StorageProxy . java b / src / java / org / apache / cassandra / service / StorageProxy . java <nl> index a8af00c . . af6df6a 100644 <nl> - - - a / src / java / org / apache / cassandra / service / StorageProxy . java <nl> + + + b / src / java / org / apache / cassandra / service / StorageProxy . java <nl> @ @ - 810 , 7 + 810 , 7 @ @ public class StorageProxy implements StorageProxyMBean <nl> throws IOException , UnavailableException , TimeoutException <nl> { <nl> if ( logger . isDebugEnabled ( ) ) <nl> - logger . debug ( command . toString ( ) ) ; <nl> + logger . debug ( " Command / ConsistencyLevel is { } / { } " , command . toString ( ) , consistency _ level ) ; <nl> long startTime = System . nanoTime ( ) ; <nl> List < Row > rows ; <nl> / / now scan until we have enough results

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index 6609b05 . . 452dc9b 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 1 , 4 + 1 , 5 @ @ 
 3 . 0 . 15 
 + * enable segement creation before recovering commitlogs ( CASSANDRA - 13587 ) 
 * Fix AssertionError in short read protection ( CASSANDRA - 13747 ) 
 * Don ' t skip corrupted sstables on startup ( CASSANDRA - 13620 ) 
 * Fix the merging of cells with different user type versions ( CASSANDRA - 13776 ) 
 diff - - git a / src / java / org / apache / cassandra / db / commitlog / CommitLog . java b / src / java / org / apache / cassandra / db / commitlog / CommitLog . java 
 index d167735 . . 40040ed 100644 
 - - - a / src / java / org / apache / cassandra / db / commitlog / CommitLog . java 
 + + + b / src / java / org / apache / cassandra / db / commitlog / CommitLog . java 
 @ @ - 150 , 6 + 150 , 7 @ @ public class CommitLog implements CommitLogMBean 
 
 File [ ] files = new File ( DatabaseDescriptor . getCommitLogLocation ( ) ) . listFiles ( unmanagedFilesFilter ) ; 
 int replayed = 0 ; 
 + allocator . enableReserveSegmentCreation ( ) ; 
 if ( files . length = = 0 ) 
 { 
 logger . info ( " No commitlog files found ; skipping replay " ) ; 
 @ @ - 165 , 7 + 166 , 6 @ @ public class CommitLog implements CommitLogMBean 
 allocator . recycleSegment ( f ) ; 
 } 
 
 - allocator . enableReserveSegmentCreation ( ) ; 
 return replayed ; 
 } 


NEAREST DIFF:
diff - - git a / src / java / org / apache / cassandra / service / StorageProxy . java b / src / java / org / apache / cassandra / service / StorageProxy . java 
 index a8af00c . . af6df6a 100644 
 - - - a / src / java / org / apache / cassandra / service / StorageProxy . java 
 + + + b / src / java / org / apache / cassandra / service / StorageProxy . java 
 @ @ - 810 , 7 + 810 , 7 @ @ public class StorageProxy implements StorageProxyMBean 
 throws IOException , UnavailableException , TimeoutException 
 { 
 if ( logger . isDebugEnabled ( ) ) 
 - logger . debug ( command . toString ( ) ) ; 
 + logger . debug ( " Command / ConsistencyLevel is { } / { } " , command . toString ( ) , consistency _ level ) ; 
 long startTime = System . nanoTime ( ) ; 
 List < Row > rows ; 
 / / now scan until we have enough results
