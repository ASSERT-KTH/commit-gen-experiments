BLEU SCORE: 0.017386863385674488

TEST MSG: Fix failed bootstrap / replace attempts being persisted in system . peers
GENERATED MSG: fix 1 . 0 . x node join to mixed version cluster , other nodes > = 1 . 1

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index 063a39b . . 4a1cd1c 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 94 , 12 + 94 , 8 @ @ <nl> * Save repair data to system table ( CASSANDRA - 5839 ) <nl> <nl> 2 . 1 . 5 <nl> - < < < < < < < HEAD <nl> * Add generate - idea - files target to build . xml ( CASSANDRA - 9123 ) <nl> - | | | | | | | merged common ancestors <nl> - = = = = = = = <nl> * Allow takeColumnFamilySnapshot to take a list of tables ( CASSANDRA - 8348 ) <nl> - > > > > > > > cassandra - 2 . 1 <nl> * Limit major sstable operations to their canonical representation ( CASSANDRA - 8669 ) <nl> * cqlsh : Add tests for INSERT and UPDATE tab completion ( CASSANDRA - 9125 ) <nl> * cqlsh : quote column names when needed in COPY FROM inserts ( CASSANDRA - 9080 ) <nl> @ @ - 171 , 6 + 167 , 7 @ @ <nl> * Use stdout for progress and stats in sstableloader ( CASSANDRA - 8982 ) <nl> * Correctly identify 2i datadir from older versions ( CASSANDRA - 9116 ) <nl> Merged from 2 . 0 : <nl> + * Fix failed bootstrap / replace attempts being persisted in system . peers ( CASSANDRA - 9180 ) <nl> * Flush system . IndexInfo after marking index built ( CASSANDRA - 9128 ) <nl> * Fix updates to min / max _ compaction _ threshold through cassandra - cli <nl> ( CASSANDRA - 8102 ) <nl> diff - - git a / src / java / org / apache / cassandra / service / StorageService . java b / src / java / org / apache / cassandra / service / StorageService . java <nl> index e0fb8b2 . . e07c0b1 100644 <nl> - - - a / src / java / org / apache / cassandra / service / StorageService . java <nl> + + + b / src / java / org / apache / cassandra / service / StorageService . java <nl> @ @ - 1612 , 37 + 1612 , 40 @ @ public class StorageService extends NotificationBroadcasterSupport implements IE <nl> return ; <nl> } <nl> <nl> - switch ( state ) <nl> + if ( getTokenMetadata ( ) . isMember ( endpoint ) ) <nl> { <nl> - case RELEASE _ VERSION : <nl> - SystemKeyspace . updatePeerInfo ( endpoint , " release _ version " , value . value ) ; <nl> - break ; <nl> - case DC : <nl> - SystemKeyspace . updatePeerInfo ( endpoint , " data _ center " , value . value ) ; <nl> - break ; <nl> - case RACK : <nl> - SystemKeyspace . updatePeerInfo ( endpoint , " rack " , value . value ) ; <nl> - break ; <nl> - case RPC _ ADDRESS : <nl> - try <nl> - { <nl> - SystemKeyspace . updatePeerInfo ( endpoint , " rpc _ address " , InetAddress . getByName ( value . value ) ) ; <nl> - } <nl> - catch ( UnknownHostException e ) <nl> - { <nl> - throw new RuntimeException ( e ) ; <nl> - } <nl> - break ; <nl> - case SCHEMA : <nl> - SystemKeyspace . updatePeerInfo ( endpoint , " schema _ version " , UUID . fromString ( value . value ) ) ; <nl> - MigrationManager . instance . scheduleSchemaPull ( endpoint , epState ) ; <nl> - break ; <nl> - case HOST _ ID : <nl> - SystemKeyspace . updatePeerInfo ( endpoint , " host _ id " , UUID . fromString ( value . value ) ) ; <nl> - break ; <nl> - case RPC _ READY : <nl> - notifyRpcChange ( endpoint , epState . isRpcReady ( ) ) ; <nl> - break ; <nl> + switch ( state ) <nl> + { <nl> + case RELEASE _ VERSION : <nl> + SystemKeyspace . updatePeerInfo ( endpoint , " release _ version " , value . value ) ; <nl> + break ; <nl> + case DC : <nl> + SystemKeyspace . updatePeerInfo ( endpoint , " data _ center " , value . value ) ; <nl> + break ; <nl> + case RACK : <nl> + SystemKeyspace . updatePeerInfo ( endpoint , " rack " , value . value ) ; <nl> + break ; <nl> + case RPC _ ADDRESS : <nl> + try <nl> + { <nl> + SystemKeyspace . updatePeerInfo ( endpoint , " rpc _ address " , InetAddress . getByName ( value . value ) ) ; <nl> + } <nl> + catch ( UnknownHostException e ) <nl> + { <nl> + throw new RuntimeException ( e ) ; <nl> + } <nl> + break ; <nl> + case SCHEMA : <nl> + SystemKeyspace . updatePeerInfo ( endpoint , " schema _ version " , UUID . fromString ( value . value ) ) ; <nl> + MigrationManager . instance . scheduleSchemaPull ( endpoint , epState ) ; <nl> + break ; <nl> + case HOST _ ID : <nl> + SystemKeyspace . updatePeerInfo ( endpoint , " host _ id " , UUID . fromString ( value . value ) ) ; <nl> + break ; <nl> + case RPC _ READY : <nl> + notifyRpcChange ( endpoint , epState . isRpcReady ( ) ) ; <nl> + break ; <nl> + } <nl> } <nl> } <nl> }
NEAREST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index cb85459 . . 01a3af1 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 13 , 6 + 13 , 7 @ @ <nl> Merged from 1 . 0 : <nl> * allow dropping columns shadowed by not - yet - expired supercolumn or row <nl> tombstones in PrecompactedRow ( CASSANDRA - 4396 ) <nl> + * fix 1 . 0 . x node join to mixed version cluster , other nodes > = 1 . 1 ( CASSANDRA - 4195 ) <nl> <nl> <nl> 1 . 1 . 2

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index 063a39b . . 4a1cd1c 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 94 , 12 + 94 , 8 @ @ 
 * Save repair data to system table ( CASSANDRA - 5839 ) 
 
 2 . 1 . 5 
 - < < < < < < < HEAD 
 * Add generate - idea - files target to build . xml ( CASSANDRA - 9123 ) 
 - | | | | | | | merged common ancestors 
 - = = = = = = = 
 * Allow takeColumnFamilySnapshot to take a list of tables ( CASSANDRA - 8348 ) 
 - > > > > > > > cassandra - 2 . 1 
 * Limit major sstable operations to their canonical representation ( CASSANDRA - 8669 ) 
 * cqlsh : Add tests for INSERT and UPDATE tab completion ( CASSANDRA - 9125 ) 
 * cqlsh : quote column names when needed in COPY FROM inserts ( CASSANDRA - 9080 ) 
 @ @ - 171 , 6 + 167 , 7 @ @ 
 * Use stdout for progress and stats in sstableloader ( CASSANDRA - 8982 ) 
 * Correctly identify 2i datadir from older versions ( CASSANDRA - 9116 ) 
 Merged from 2 . 0 : 
 + * Fix failed bootstrap / replace attempts being persisted in system . peers ( CASSANDRA - 9180 ) 
 * Flush system . IndexInfo after marking index built ( CASSANDRA - 9128 ) 
 * Fix updates to min / max _ compaction _ threshold through cassandra - cli 
 ( CASSANDRA - 8102 ) 
 diff - - git a / src / java / org / apache / cassandra / service / StorageService . java b / src / java / org / apache / cassandra / service / StorageService . java 
 index e0fb8b2 . . e07c0b1 100644 
 - - - a / src / java / org / apache / cassandra / service / StorageService . java 
 + + + b / src / java / org / apache / cassandra / service / StorageService . java 
 @ @ - 1612 , 37 + 1612 , 40 @ @ public class StorageService extends NotificationBroadcasterSupport implements IE 
 return ; 
 } 
 
 - switch ( state ) 
 + if ( getTokenMetadata ( ) . isMember ( endpoint ) ) 
 { 
 - case RELEASE _ VERSION : 
 - SystemKeyspace . updatePeerInfo ( endpoint , " release _ version " , value . value ) ; 
 - break ; 
 - case DC : 
 - SystemKeyspace . updatePeerInfo ( endpoint , " data _ center " , value . value ) ; 
 - break ; 
 - case RACK : 
 - SystemKeyspace . updatePeerInfo ( endpoint , " rack " , value . value ) ; 
 - break ; 
 - case RPC _ ADDRESS : 
 - try 
 - { 
 - SystemKeyspace . updatePeerInfo ( endpoint , " rpc _ address " , InetAddress . getByName ( value . value ) ) ; 
 - } 
 - catch ( UnknownHostException e ) 
 - { 
 - throw new RuntimeException ( e ) ; 
 - } 
 - break ; 
 - case SCHEMA : 
 - SystemKeyspace . updatePeerInfo ( endpoint , " schema _ version " , UUID . fromString ( value . value ) ) ; 
 - MigrationManager . instance . scheduleSchemaPull ( endpoint , epState ) ; 
 - break ; 
 - case HOST _ ID : 
 - SystemKeyspace . updatePeerInfo ( endpoint , " host _ id " , UUID . fromString ( value . value ) ) ; 
 - break ; 
 - case RPC _ READY : 
 - notifyRpcChange ( endpoint , epState . isRpcReady ( ) ) ; 
 - break ; 
 + switch ( state ) 
 + { 
 + case RELEASE _ VERSION : 
 + SystemKeyspace . updatePeerInfo ( endpoint , " release _ version " , value . value ) ; 
 + break ; 
 + case DC : 
 + SystemKeyspace . updatePeerInfo ( endpoint , " data _ center " , value . value ) ; 
 + break ; 
 + case RACK : 
 + SystemKeyspace . updatePeerInfo ( endpoint , " rack " , value . value ) ; 
 + break ; 
 + case RPC _ ADDRESS : 
 + try 
 + { 
 + SystemKeyspace . updatePeerInfo ( endpoint , " rpc _ address " , InetAddress . getByName ( value . value ) ) ; 
 + } 
 + catch ( UnknownHostException e ) 
 + { 
 + throw new RuntimeException ( e ) ; 
 + } 
 + break ; 
 + case SCHEMA : 
 + SystemKeyspace . updatePeerInfo ( endpoint , " schema _ version " , UUID . fromString ( value . value ) ) ; 
 + MigrationManager . instance . scheduleSchemaPull ( endpoint , epState ) ; 
 + break ; 
 + case HOST _ ID : 
 + SystemKeyspace . updatePeerInfo ( endpoint , " host _ id " , UUID . fromString ( value . value ) ) ; 
 + break ; 
 + case RPC _ READY : 
 + notifyRpcChange ( endpoint , epState . isRpcReady ( ) ) ; 
 + break ; 
 + } 
 } 
 } 
 }

NEAREST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index cb85459 . . 01a3af1 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 13 , 6 + 13 , 7 @ @ 
 Merged from 1 . 0 : 
 * allow dropping columns shadowed by not - yet - expired supercolumn or row 
 tombstones in PrecompactedRow ( CASSANDRA - 4396 ) 
 + * fix 1 . 0 . x node join to mixed version cluster , other nodes > = 1 . 1 ( CASSANDRA - 4195 ) 
 
 
 1 . 1 . 2
