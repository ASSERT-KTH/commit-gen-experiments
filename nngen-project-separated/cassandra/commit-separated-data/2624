BLEU SCORE: 0.02383853510228548

TEST MSG: Fix off - by - one error in stress
GENERATED MSG: merge from 1 . 1

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index 7d3c5d2 . . 7e2ed4d 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 26 , 6 + 26 , 7 @ @ <nl> * ByteBuffer write ( ) methods for serializing sstables ( CASSANDRA - 6781 ) <nl> * Proper compare function for CollectionType ( CASSANDRA - 6783 ) <nl> * Update native server to Netty 4 ( CASSANDRA - 6236 ) <nl> + * Fix off - by - one error in stress ( CASSANDRA - 6883 ) <nl> Merged from 2 . 0 : <nl> * Add uuid ( ) function ( CASSANDRA - 6473 ) <nl> * Omit tombstones from schema digests ( CASSANDRA - 6862 ) <nl> diff - - git a / tools / stress / src / org / apache / cassandra / stress / settings / OptionDistribution . java b / tools / stress / src / org / apache / cassandra / stress / settings / OptionDistribution . java <nl> index b84bbc2 . . 76fa0a9 100644 <nl> - - - a / tools / stress / src / org / apache / cassandra / stress / settings / OptionDistribution . java <nl> + + + b / tools / stress / src / org / apache / cassandra / stress / settings / OptionDistribution . java <nl> @ @ - 334 , 7 + 334 , 7 @ @ class OptionDistribution extends Option <nl> @ Override <nl> public Distribution get ( ) <nl> { <nl> - return new DistributionBoundApache ( new UniformRealDistribution ( min , max ) , min , max ) ; <nl> + return new DistributionBoundApache ( new UniformRealDistribution ( min , max + 1 ) , min , max ) ; <nl> } <nl> } <nl>
NEAREST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / db / HintedHandOffManager . java b / src / java / org / apache / cassandra / db / HintedHandOffManager . java <nl> index a83fbab . . e2dc046 100644 <nl> - - - a / src / java / org / apache / cassandra / db / HintedHandOffManager . java <nl> + + + b / src / java / org / apache / cassandra / db / HintedHandOffManager . java <nl> @ @ - 391 , 7 + 391 , 9 @ @ public class HintedHandOffManager implements HintedHandOffManagerMBean <nl> { <nl> Token < ? > token = StorageService . getPartitioner ( ) . getTokenFactory ( ) . fromByteArray ( row . key . key ) ; <nl> InetAddress target = StorageService . instance . getTokenMetadata ( ) . getEndpoint ( token ) ; <nl> - scheduleHintDelivery ( target ) ; <nl> + / / token may have since been removed ( in which case we have just read back a tombstone ) <nl> + if ( target ! = null ) <nl> + scheduleHintDelivery ( target ) ; <nl> } <nl> <nl> if ( logger _ . isDebugEnabled ( ) )

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index 7d3c5d2 . . 7e2ed4d 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 26 , 6 + 26 , 7 @ @ 
 * ByteBuffer write ( ) methods for serializing sstables ( CASSANDRA - 6781 ) 
 * Proper compare function for CollectionType ( CASSANDRA - 6783 ) 
 * Update native server to Netty 4 ( CASSANDRA - 6236 ) 
 + * Fix off - by - one error in stress ( CASSANDRA - 6883 ) 
 Merged from 2 . 0 : 
 * Add uuid ( ) function ( CASSANDRA - 6473 ) 
 * Omit tombstones from schema digests ( CASSANDRA - 6862 ) 
 diff - - git a / tools / stress / src / org / apache / cassandra / stress / settings / OptionDistribution . java b / tools / stress / src / org / apache / cassandra / stress / settings / OptionDistribution . java 
 index b84bbc2 . . 76fa0a9 100644 
 - - - a / tools / stress / src / org / apache / cassandra / stress / settings / OptionDistribution . java 
 + + + b / tools / stress / src / org / apache / cassandra / stress / settings / OptionDistribution . java 
 @ @ - 334 , 7 + 334 , 7 @ @ class OptionDistribution extends Option 
 @ Override 
 public Distribution get ( ) 
 { 
 - return new DistributionBoundApache ( new UniformRealDistribution ( min , max ) , min , max ) ; 
 + return new DistributionBoundApache ( new UniformRealDistribution ( min , max + 1 ) , min , max ) ; 
 } 
 } 


NEAREST DIFF:
diff - - git a / src / java / org / apache / cassandra / db / HintedHandOffManager . java b / src / java / org / apache / cassandra / db / HintedHandOffManager . java 
 index a83fbab . . e2dc046 100644 
 - - - a / src / java / org / apache / cassandra / db / HintedHandOffManager . java 
 + + + b / src / java / org / apache / cassandra / db / HintedHandOffManager . java 
 @ @ - 391 , 7 + 391 , 9 @ @ public class HintedHandOffManager implements HintedHandOffManagerMBean 
 { 
 Token < ? > token = StorageService . getPartitioner ( ) . getTokenFactory ( ) . fromByteArray ( row . key . key ) ; 
 InetAddress target = StorageService . instance . getTokenMetadata ( ) . getEndpoint ( token ) ; 
 - scheduleHintDelivery ( target ) ; 
 + / / token may have since been removed ( in which case we have just read back a tombstone ) 
 + if ( target ! = null ) 
 + scheduleHintDelivery ( target ) ; 
 } 
 
 if ( logger _ . isDebugEnabled ( ) )
