BLEU SCORE: 0.01763751180315069

TEST MSG: Track metrics at a keyspace level
GENERATED MSG: Expose whether jna is enabled and memory is locked via JMX

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index db94066 . . e3bd64b 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 16 , 7 + 16 , 6 @ @ <nl> * Fix infinite loop on exception while streaming ( CASSANDRA - 7330 ) <nl> * Reference sstables before populating key cache ( CASSANDRA - 7234 ) <nl> Merged from 1 . 2 : <nl> - 1 . 2 . 17 <nl> * Track metrics at a keyspace level ( CASSANDRA - 6539 ) <nl> * Add replace _ address _ first _ boot flag to only replace if not bootstrapped ( CASSANDRA - 7356 ) <nl> * Enable keepalive for native protocol ( CASSANDRA - 7380 ) <nl> diff - - git a / src / java / org / apache / cassandra / db / Keyspace . java b / src / java / org / apache / cassandra / db / Keyspace . java <nl> index 06df066 . . 308d8ef 100644 <nl> - - - a / src / java / org / apache / cassandra / db / Keyspace . java <nl> + + + b / src / java / org / apache / cassandra / db / Keyspace . java <nl> @ @ - 27 , 6 + 27 , 7 @ @ import java . util . concurrent . locks . ReentrantReadWriteLock ; <nl> <nl> import com . google . common . base . Function ; <nl> import com . google . common . collect . Iterables ; <nl> + import org . apache . cassandra . metrics . KeyspaceMetrics ; <nl> import org . slf4j . Logger ; <nl> import org . slf4j . LoggerFactory ; <nl> <nl> @ @ - 63 , 6 + 64 , 8 @ @ public class Keyspace <nl> * / <nl> public static final ReentrantReadWriteLock switchLock = new ReentrantReadWriteLock ( ) ; <nl> <nl> + public final KeyspaceMetrics metric ; <nl> + <nl> / / It is possible to call Keyspace . open without a running daemon , so it makes sense to ensure <nl> / / proper directories here as well as in CassandraDaemon . <nl> static <nl> @ @ - 262 , 6 + 265 , 7 @ @ public class Keyspace <nl> metadata = Schema . instance . getKSMetaData ( keyspaceName ) ; <nl> assert metadata ! = null : " Unknown keyspace " + keyspaceName ; <nl> createReplicationStrategy ( metadata ) ; <nl> + metric = new KeyspaceMetrics ( this ) ; <nl> <nl> for ( CFMetaData cfm : new ArrayList < CFMetaData > ( metadata . cfMetaData ( ) . values ( ) ) ) <nl> {
NEAREST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / service / NativeAccessMBean . java b / src / java / org / apache / cassandra / service / NativeAccessMBean . java <nl> new file mode 100644 <nl> index 0000000 . . 39b96c5 <nl> - - - / dev / null <nl> + + + b / src / java / org / apache / cassandra / service / NativeAccessMBean . java <nl> @ @ - 0 , 0 + 1 , 9 @ @ <nl> + package org . apache . cassandra . service ; <nl> + <nl> + public interface NativeAccessMBean <nl> + { <nl> + boolean isAvailable ( ) ; <nl> + <nl> + boolean isMemoryLockable ( ) ; <nl> + } <nl> +

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index db94066 . . e3bd64b 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 16 , 7 + 16 , 6 @ @ 
 * Fix infinite loop on exception while streaming ( CASSANDRA - 7330 ) 
 * Reference sstables before populating key cache ( CASSANDRA - 7234 ) 
 Merged from 1 . 2 : 
 - 1 . 2 . 17 
 * Track metrics at a keyspace level ( CASSANDRA - 6539 ) 
 * Add replace _ address _ first _ boot flag to only replace if not bootstrapped ( CASSANDRA - 7356 ) 
 * Enable keepalive for native protocol ( CASSANDRA - 7380 ) 
 diff - - git a / src / java / org / apache / cassandra / db / Keyspace . java b / src / java / org / apache / cassandra / db / Keyspace . java 
 index 06df066 . . 308d8ef 100644 
 - - - a / src / java / org / apache / cassandra / db / Keyspace . java 
 + + + b / src / java / org / apache / cassandra / db / Keyspace . java 
 @ @ - 27 , 6 + 27 , 7 @ @ import java . util . concurrent . locks . ReentrantReadWriteLock ; 
 
 import com . google . common . base . Function ; 
 import com . google . common . collect . Iterables ; 
 + import org . apache . cassandra . metrics . KeyspaceMetrics ; 
 import org . slf4j . Logger ; 
 import org . slf4j . LoggerFactory ; 
 
 @ @ - 63 , 6 + 64 , 8 @ @ public class Keyspace 
 * / 
 public static final ReentrantReadWriteLock switchLock = new ReentrantReadWriteLock ( ) ; 
 
 + public final KeyspaceMetrics metric ; 
 + 
 / / It is possible to call Keyspace . open without a running daemon , so it makes sense to ensure 
 / / proper directories here as well as in CassandraDaemon . 
 static 
 @ @ - 262 , 6 + 265 , 7 @ @ public class Keyspace 
 metadata = Schema . instance . getKSMetaData ( keyspaceName ) ; 
 assert metadata ! = null : " Unknown keyspace " + keyspaceName ; 
 createReplicationStrategy ( metadata ) ; 
 + metric = new KeyspaceMetrics ( this ) ; 
 
 for ( CFMetaData cfm : new ArrayList < CFMetaData > ( metadata . cfMetaData ( ) . values ( ) ) ) 
 {

NEAREST DIFF:
diff - - git a / src / java / org / apache / cassandra / service / NativeAccessMBean . java b / src / java / org / apache / cassandra / service / NativeAccessMBean . java 
 new file mode 100644 
 index 0000000 . . 39b96c5 
 - - - / dev / null 
 + + + b / src / java / org / apache / cassandra / service / NativeAccessMBean . java 
 @ @ - 0 , 0 + 1 , 9 @ @ 
 + package org . apache . cassandra . service ; 
 + 
 + public interface NativeAccessMBean 
 + { 
 + boolean isAvailable ( ) ; 
 + 
 + boolean isMemoryLockable ( ) ; 
 + } 
 +
