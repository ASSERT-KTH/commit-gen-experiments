BLEU SCORE: 0.03283637368030199

TEST MSG: make sure zone info gets completely read
GENERATED MSG: load PFS properties with ResourceAsStream

TEST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / locator / CloudstackSnitch . java b / src / java / org / apache / cassandra / locator / CloudstackSnitch . java <nl> index 6d06556 . . af26ef9 100644 <nl> - - - a / src / java / org / apache / cassandra / locator / CloudstackSnitch . java <nl> + + + b / src / java / org / apache / cassandra / locator / CloudstackSnitch . java <nl> @ @ - 17 , 9 + 17 , 8 @ @ <nl> * / <nl> package org . apache . cassandra . locator ; <nl> <nl> - import java . io . InputStream ; <nl> + import java . io . DataInputStream ; <nl> import java . io . BufferedInputStream ; <nl> - import java . io . FilterInputStream ; <nl> import java . io . BufferedReader ; <nl> import java . io . FileReader ; <nl> import java . io . IOException ; <nl> @ @ - 112 , 7 + 111 , 7 @ @ public class CloudstackSnitch extends AbstractNetworkTopologySnitch <nl> String csQueryMetadata ( String url ) throws ConfigurationException , IOException <nl> { <nl> HttpURLConnection conn = null ; <nl> - BufferedInputStream is = null ; <nl> + DataInputStream is = null ; <nl> <nl> try { <nl> conn = ( HttpURLConnection ) new URL ( url ) . openConnection ( ) ; <nl> @ @ - 127 , 8 + 126 , 8 @ @ public class CloudstackSnitch extends AbstractNetworkTopologySnitch <nl> <nl> int cl = conn . getContentLength ( ) ; <nl> byte [ ] b = new byte [ cl ] ; <nl> - is = new BufferedInputStream ( conn . getInputStream ( ) ) ; <nl> - is . read ( b , 0 , cl ) ; <nl> + is = new DataInputStream ( new BufferedInputStream ( conn . getInputStream ( ) ) ) ; <nl> + is . readFully ( b ) ; <nl> return new String ( b , StandardCharsets . UTF _ 8 ) ; <nl> } finally { <nl> FileUtils . close ( is ) ;
NEAREST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / service / StorageService . java b / src / java / org / apache / cassandra / service / StorageService . java <nl> index 62405ee . . 0975616 100644 <nl> - - - a / src / java / org / apache / cassandra / service / StorageService . java <nl> + + + b / src / java / org / apache / cassandra / service / StorageService . java <nl> @ @ - 169 , 15 + 169 , 6 @ @ public class StorageService implements IEndpointStateChangeSubscriber , StorageSe <nl> / * This abstraction maintains the token / endpoint metadata information * / <nl> private TokenMetadata tokenMetadata _ = new TokenMetadata ( ) ; <nl> <nl> - / * This thread pool does consistency checks when the client doesn ' t care about consistency * / <nl> - private ExecutorService consistencyManager _ = new JMXEnabledThreadPoolExecutor ( DatabaseDescriptor . getConsistencyThreads ( ) , <nl> - DatabaseDescriptor . getConsistencyThreads ( ) , <nl> - StageManager . KEEPALIVE , <nl> - TimeUnit . SECONDS , <nl> - new LinkedBlockingQueue < Runnable > ( ) , <nl> - new NamedThreadFactory ( " ReadRepair " ) , <nl> - " request " ) ; <nl> - <nl> private Set < InetAddress > replicatingNodes ; <nl> private InetAddress removingNode ; <nl>

TEST DIFF:
diff - - git a / src / java / org / apache / cassandra / locator / CloudstackSnitch . java b / src / java / org / apache / cassandra / locator / CloudstackSnitch . java 
 index 6d06556 . . af26ef9 100644 
 - - - a / src / java / org / apache / cassandra / locator / CloudstackSnitch . java 
 + + + b / src / java / org / apache / cassandra / locator / CloudstackSnitch . java 
 @ @ - 17 , 9 + 17 , 8 @ @ 
 * / 
 package org . apache . cassandra . locator ; 
 
 - import java . io . InputStream ; 
 + import java . io . DataInputStream ; 
 import java . io . BufferedInputStream ; 
 - import java . io . FilterInputStream ; 
 import java . io . BufferedReader ; 
 import java . io . FileReader ; 
 import java . io . IOException ; 
 @ @ - 112 , 7 + 111 , 7 @ @ public class CloudstackSnitch extends AbstractNetworkTopologySnitch 
 String csQueryMetadata ( String url ) throws ConfigurationException , IOException 
 { 
 HttpURLConnection conn = null ; 
 - BufferedInputStream is = null ; 
 + DataInputStream is = null ; 
 
 try { 
 conn = ( HttpURLConnection ) new URL ( url ) . openConnection ( ) ; 
 @ @ - 127 , 8 + 126 , 8 @ @ public class CloudstackSnitch extends AbstractNetworkTopologySnitch 
 
 int cl = conn . getContentLength ( ) ; 
 byte [ ] b = new byte [ cl ] ; 
 - is = new BufferedInputStream ( conn . getInputStream ( ) ) ; 
 - is . read ( b , 0 , cl ) ; 
 + is = new DataInputStream ( new BufferedInputStream ( conn . getInputStream ( ) ) ) ; 
 + is . readFully ( b ) ; 
 return new String ( b , StandardCharsets . UTF _ 8 ) ; 
 } finally { 
 FileUtils . close ( is ) ;

NEAREST DIFF:
diff - - git a / src / java / org / apache / cassandra / service / StorageService . java b / src / java / org / apache / cassandra / service / StorageService . java 
 index 62405ee . . 0975616 100644 
 - - - a / src / java / org / apache / cassandra / service / StorageService . java 
 + + + b / src / java / org / apache / cassandra / service / StorageService . java 
 @ @ - 169 , 15 + 169 , 6 @ @ public class StorageService implements IEndpointStateChangeSubscriber , StorageSe 
 / * This abstraction maintains the token / endpoint metadata information * / 
 private TokenMetadata tokenMetadata _ = new TokenMetadata ( ) ; 
 
 - / * This thread pool does consistency checks when the client doesn ' t care about consistency * / 
 - private ExecutorService consistencyManager _ = new JMXEnabledThreadPoolExecutor ( DatabaseDescriptor . getConsistencyThreads ( ) , 
 - DatabaseDescriptor . getConsistencyThreads ( ) , 
 - StageManager . KEEPALIVE , 
 - TimeUnit . SECONDS , 
 - new LinkedBlockingQueue < Runnable > ( ) , 
 - new NamedThreadFactory ( " ReadRepair " ) , 
 - " request " ) ; 
 - 
 private Set < InetAddress > replicatingNodes ; 
 private InetAddress removingNode ; 

