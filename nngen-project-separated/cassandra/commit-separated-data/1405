BLEU SCORE: 0.04767707020457096

TEST MSG: Fix KeyCacheTest on Windows ( regression from 8099 )
GENERATED MSG: Fix various unit - test failures

TEST DIFF (one line): diff - - git a / test / unit / org / apache / cassandra / db / KeyCacheTest . java b / test / unit / org / apache / cassandra / db / KeyCacheTest . java <nl> index 2508800 . . 30812d2 100644 <nl> - - - a / test / unit / org / apache / cassandra / db / KeyCacheTest . java <nl> + + + b / test / unit / org / apache / cassandra / db / KeyCacheTest . java <nl> @ @ - 34 , 6 + 34 , 7 @ @ import org . apache . cassandra . Util ; <nl> import org . apache . cassandra . cache . KeyCacheKey ; <nl> import org . apache . cassandra . concurrent . ScheduledExecutors ; <nl> import org . apache . cassandra . config . CFMetaData ; <nl> + import org . apache . cassandra . config . DatabaseDescriptor ; <nl> import org . apache . cassandra . config . Schema ; <nl> import org . apache . cassandra . db . compaction . CompactionManager ; <nl> import org . apache . cassandra . exceptions . ConfigurationException ; <nl> @ @ - 153 , 10 + 154 , 12 @ @ public class KeyCacheTest <nl> throw new IllegalStateException ( ) ; <nl> <nl> Util . compactAll ( cfs , Integer . MAX _ VALUE ) . get ( ) ; <nl> + boolean noEarlyOpen = DatabaseDescriptor . getSSTablePreempiveOpenIntervalInMB ( ) < 0 ; <nl> + <nl> / / after compaction cache should have entries for new SSTables , <nl> / / but since we have kept a reference to the old sstables , <nl> / / if we had 2 keys in cache previously it should become 4 <nl> - assertKeyCacheSize ( 4 , KEYSPACE1 , COLUMN _ FAMILY1 ) ; <nl> + assertKeyCacheSize ( noEarlyOpen ? 2 : 4 , KEYSPACE1 , COLUMN _ FAMILY1 ) ; <nl> <nl> refs . release ( ) ; <nl> <nl> @ @ - 172 , 7 + 175 , 7 @ @ public class KeyCacheTest <nl> Util . getAll ( Util . cmd ( cfs , " key1 " ) . build ( ) ) ; <nl> Util . getAll ( Util . cmd ( cfs , " key2 " ) . build ( ) ) ; <nl> <nl> - assertKeyCacheSize ( 2 , KEYSPACE1 , COLUMN _ FAMILY1 ) ; <nl> + assertKeyCacheSize ( noEarlyOpen ? 4 : 2 , KEYSPACE1 , COLUMN _ FAMILY1 ) ; <nl> } <nl> <nl> private static void readData ( String keyspace , String columnFamily , int numberOfRows )
NEAREST DIFF (one line): ELIMINATEDSENTENCE

TEST DIFF:
diff - - git a / test / unit / org / apache / cassandra / db / KeyCacheTest . java b / test / unit / org / apache / cassandra / db / KeyCacheTest . java 
 index 2508800 . . 30812d2 100644 
 - - - a / test / unit / org / apache / cassandra / db / KeyCacheTest . java 
 + + + b / test / unit / org / apache / cassandra / db / KeyCacheTest . java 
 @ @ - 34 , 6 + 34 , 7 @ @ import org . apache . cassandra . Util ; 
 import org . apache . cassandra . cache . KeyCacheKey ; 
 import org . apache . cassandra . concurrent . ScheduledExecutors ; 
 import org . apache . cassandra . config . CFMetaData ; 
 + import org . apache . cassandra . config . DatabaseDescriptor ; 
 import org . apache . cassandra . config . Schema ; 
 import org . apache . cassandra . db . compaction . CompactionManager ; 
 import org . apache . cassandra . exceptions . ConfigurationException ; 
 @ @ - 153 , 10 + 154 , 12 @ @ public class KeyCacheTest 
 throw new IllegalStateException ( ) ; 
 
 Util . compactAll ( cfs , Integer . MAX _ VALUE ) . get ( ) ; 
 + boolean noEarlyOpen = DatabaseDescriptor . getSSTablePreempiveOpenIntervalInMB ( ) < 0 ; 
 + 
 / / after compaction cache should have entries for new SSTables , 
 / / but since we have kept a reference to the old sstables , 
 / / if we had 2 keys in cache previously it should become 4 
 - assertKeyCacheSize ( 4 , KEYSPACE1 , COLUMN _ FAMILY1 ) ; 
 + assertKeyCacheSize ( noEarlyOpen ? 2 : 4 , KEYSPACE1 , COLUMN _ FAMILY1 ) ; 
 
 refs . release ( ) ; 
 
 @ @ - 172 , 7 + 175 , 7 @ @ public class KeyCacheTest 
 Util . getAll ( Util . cmd ( cfs , " key1 " ) . build ( ) ) ; 
 Util . getAll ( Util . cmd ( cfs , " key2 " ) . build ( ) ) ; 
 
 - assertKeyCacheSize ( 2 , KEYSPACE1 , COLUMN _ FAMILY1 ) ; 
 + assertKeyCacheSize ( noEarlyOpen ? 4 : 2 , KEYSPACE1 , COLUMN _ FAMILY1 ) ; 
 } 
 
 private static void readData ( String keyspace , String columnFamily , int numberOfRows )

NEAREST DIFF:
ELIMINATEDSENTENCE
