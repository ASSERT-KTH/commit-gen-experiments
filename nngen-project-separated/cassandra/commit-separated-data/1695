BLEU SCORE: 1.0

TEST MSG: Don ' t initiate snitch reconnection for dead states
GENERATED MSG: Don ' t initiate snitch reconnection for dead states

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index 80ab11c . . 2777d79 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 81 , 6 + 81 , 7 @ @ <nl> * Use stdout for progress and stats in sstableloader ( CASSANDRA - 8982 ) <nl> * Correctly identify 2i datadir from older versions ( CASSANDRA - 9116 ) <nl> Merged from 2 . 0 : <nl> + * Don ' t initiate snitch reconnection for dead states ( CASSANDRA - 7292 ) <nl> * Fix ArrayIndexOutOfBoundsException in CQLSSTableWriter ( CASSANDRA - 8978 ) <nl> * Add shutdown gossip state to prevent timeouts during rolling restarts ( CASSANDRA - 8336 ) <nl> * Fix running with java . net . preferIPv6Addresses = true ( CASSANDRA - 9137 ) <nl> diff - - git a / src / java / org / apache / cassandra / locator / ReconnectableSnitchHelper . java b / src / java / org / apache / cassandra / locator / ReconnectableSnitchHelper . java <nl> index d797393 . . 1642561 100644 <nl> - - - a / src / java / org / apache / cassandra / locator / ReconnectableSnitchHelper . java <nl> + + + b / src / java / org / apache / cassandra / locator / ReconnectableSnitchHelper . java <nl> @ @ - 21 , 10 + 21 , 7 @ @ package org . apache . cassandra . locator ; <nl> import java . net . InetAddress ; <nl> import java . net . UnknownHostException ; <nl> <nl> - import org . apache . cassandra . gms . ApplicationState ; <nl> - import org . apache . cassandra . gms . EndpointState ; <nl> - import org . apache . cassandra . gms . IEndpointStateChangeSubscriber ; <nl> - import org . apache . cassandra . gms . VersionedValue ; <nl> + import org . apache . cassandra . gms . * ; <nl> import org . apache . cassandra . net . MessagingService ; <nl> import org . slf4j . Logger ; <nl> import org . slf4j . LoggerFactory ; <nl> @ @ - 78 , 13 + 75 , 13 @ @ public class ReconnectableSnitchHelper implements IEndpointStateChangeSubscriber <nl> <nl> public void onJoin ( InetAddress endpoint , EndpointState epState ) <nl> { <nl> - if ( preferLocal & & epState . getApplicationState ( ApplicationState . INTERNAL _ IP ) ! = null ) <nl> + if ( preferLocal & & ! Gossiper . instance . isDeadState ( epState ) & & epState . getApplicationState ( ApplicationState . INTERNAL _ IP ) ! = null ) <nl> reconnect ( endpoint , epState . getApplicationState ( ApplicationState . INTERNAL _ IP ) ) ; <nl> } <nl> <nl> public void onChange ( InetAddress endpoint , ApplicationState state , VersionedValue value ) <nl> { <nl> - if ( preferLocal & & state = = ApplicationState . INTERNAL _ IP ) <nl> + if ( preferLocal & & ! Gossiper . instance . isDeadState ( epState ) & & state = = ApplicationState . INTERNAL _ IP ) <nl> reconnect ( endpoint , value ) ; <nl> } <nl>
NEAREST DIFF (one line): ELIMINATEDSENTENCE

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index 80ab11c . . 2777d79 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 81 , 6 + 81 , 7 @ @ 
 * Use stdout for progress and stats in sstableloader ( CASSANDRA - 8982 ) 
 * Correctly identify 2i datadir from older versions ( CASSANDRA - 9116 ) 
 Merged from 2 . 0 : 
 + * Don ' t initiate snitch reconnection for dead states ( CASSANDRA - 7292 ) 
 * Fix ArrayIndexOutOfBoundsException in CQLSSTableWriter ( CASSANDRA - 8978 ) 
 * Add shutdown gossip state to prevent timeouts during rolling restarts ( CASSANDRA - 8336 ) 
 * Fix running with java . net . preferIPv6Addresses = true ( CASSANDRA - 9137 ) 
 diff - - git a / src / java / org / apache / cassandra / locator / ReconnectableSnitchHelper . java b / src / java / org / apache / cassandra / locator / ReconnectableSnitchHelper . java 
 index d797393 . . 1642561 100644 
 - - - a / src / java / org / apache / cassandra / locator / ReconnectableSnitchHelper . java 
 + + + b / src / java / org / apache / cassandra / locator / ReconnectableSnitchHelper . java 
 @ @ - 21 , 10 + 21 , 7 @ @ package org . apache . cassandra . locator ; 
 import java . net . InetAddress ; 
 import java . net . UnknownHostException ; 
 
 - import org . apache . cassandra . gms . ApplicationState ; 
 - import org . apache . cassandra . gms . EndpointState ; 
 - import org . apache . cassandra . gms . IEndpointStateChangeSubscriber ; 
 - import org . apache . cassandra . gms . VersionedValue ; 
 + import org . apache . cassandra . gms . * ; 
 import org . apache . cassandra . net . MessagingService ; 
 import org . slf4j . Logger ; 
 import org . slf4j . LoggerFactory ; 
 @ @ - 78 , 13 + 75 , 13 @ @ public class ReconnectableSnitchHelper implements IEndpointStateChangeSubscriber 
 
 public void onJoin ( InetAddress endpoint , EndpointState epState ) 
 { 
 - if ( preferLocal & & epState . getApplicationState ( ApplicationState . INTERNAL _ IP ) ! = null ) 
 + if ( preferLocal & & ! Gossiper . instance . isDeadState ( epState ) & & epState . getApplicationState ( ApplicationState . INTERNAL _ IP ) ! = null ) 
 reconnect ( endpoint , epState . getApplicationState ( ApplicationState . INTERNAL _ IP ) ) ; 
 } 
 
 public void onChange ( InetAddress endpoint , ApplicationState state , VersionedValue value ) 
 { 
 - if ( preferLocal & & state = = ApplicationState . INTERNAL _ IP ) 
 + if ( preferLocal & & ! Gossiper . instance . isDeadState ( epState ) & & state = = ApplicationState . INTERNAL _ IP ) 
 reconnect ( endpoint , value ) ; 
 } 


NEAREST DIFF:
ELIMINATEDSENTENCE
