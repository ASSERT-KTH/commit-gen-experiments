BLEU SCORE: 0.02383853510228548

TEST MSG: Ninja : fix bad merge of CASSANDRA - 7804
GENERATED MSG: Fix CQL3 CAS conditions check

TEST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / cql3 / statements / ModificationStatement . java b / src / java / org / apache / cassandra / cql3 / statements / ModificationStatement . java <nl> index d1d0c27 . . 69d5472 100644 <nl> - - - a / src / java / org / apache / cassandra / cql3 / statements / ModificationStatement . java <nl> + + + b / src / java / org / apache / cassandra / cql3 / statements / ModificationStatement . java <nl> @ @ - 748 , 7 + 748 , 6 @ @ public abstract class ModificationStatement implements CQLStatement , MeasurableF <nl> { <nl> case PARTITION _ KEY : <nl> case CLUSTERING _ COLUMN : <nl> - throw new InvalidRequestException ( String . format ( " PRIMARY KEY part % s found in SET part " , entry . left ) ) ; <nl> throw new InvalidRequestException ( String . format ( " PRIMARY KEY column ' % s ' cannot have IF conditions " , entry . left ) ) ; <nl> default : <nl> stmt . addCondition ( condition ) ;
NEAREST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index 498f447 . . 2182768 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 25 , 6 + 25 , 7 @ @ <nl> * Fix repair hanging silently on unexpected error ( CASSANDRA - 5229 ) <nl> * Fix Ec2Snitch regression introduced by CASSANDRA - 5171 ( CASSANDRA - 5432 ) <nl> * Add nodetool enablebackup / disablebackup ( CASSANDRA - 5556 ) <nl> + * cqlsh : fix DESCRIBE after case insensitive USE ( CASSANDRA - 5567 ) <nl> Merged from 1 . 1 <nl> * Add retry mechanism to OTC for non - droppable _ verbs ( CASSANDRA - 5393 ) <nl> * Use allocator information to improve memtable memory usage estimate <nl> diff - - git a / bin / cqlsh b / bin / cqlsh <nl> index a29eee4 . . 974c916 100755 <nl> - - - a / bin / cqlsh <nl> + + + b / bin / cqlsh <nl> @ @ - 32 , 7 + 32 , 7 @ @ exit 1 <nl> from _ _ future _ _ import with _ statement <nl> <nl> description = " CQL Shell for Apache Cassandra " <nl> - version = " 3 . 0 . 1 " <nl> + version = " 3 . 0 . 2 " <nl> <nl> from StringIO import StringIO <nl> from itertools import groupby <nl> @ @ - 962 , 7 + 962 , 10 @ @ class Shell ( cmd . Cmd ) : <nl> def do _ use ( self , parsed ) : <nl> ksname = parsed . get _ binding ( ' ksname ' ) <nl> if self . perform _ statement _ untraced ( parsed . extract _ orig ( ) ) : <nl> - self . current _ keyspace = self . cql _ unprotect _ name ( ksname ) <nl> + if ksname [ 0 ] = = ' " ' and ksname [ - 1 ] = = ' " ' : <nl> + self . current _ keyspace = self . cql _ unprotect _ name ( ksname ) <nl> + else : <nl> + self . current _ keyspace = ksname . lower ( ) <nl> <nl> def do _ select ( self , parsed ) : <nl> ksname = parsed . get _ binding ( ' ksname ' )

TEST DIFF:
diff - - git a / src / java / org / apache / cassandra / cql3 / statements / ModificationStatement . java b / src / java / org / apache / cassandra / cql3 / statements / ModificationStatement . java 
 index d1d0c27 . . 69d5472 100644 
 - - - a / src / java / org / apache / cassandra / cql3 / statements / ModificationStatement . java 
 + + + b / src / java / org / apache / cassandra / cql3 / statements / ModificationStatement . java 
 @ @ - 748 , 7 + 748 , 6 @ @ public abstract class ModificationStatement implements CQLStatement , MeasurableF 
 { 
 case PARTITION _ KEY : 
 case CLUSTERING _ COLUMN : 
 - throw new InvalidRequestException ( String . format ( " PRIMARY KEY part % s found in SET part " , entry . left ) ) ; 
 throw new InvalidRequestException ( String . format ( " PRIMARY KEY column ' % s ' cannot have IF conditions " , entry . left ) ) ; 
 default : 
 stmt . addCondition ( condition ) ;

NEAREST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index 498f447 . . 2182768 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 25 , 6 + 25 , 7 @ @ 
 * Fix repair hanging silently on unexpected error ( CASSANDRA - 5229 ) 
 * Fix Ec2Snitch regression introduced by CASSANDRA - 5171 ( CASSANDRA - 5432 ) 
 * Add nodetool enablebackup / disablebackup ( CASSANDRA - 5556 ) 
 + * cqlsh : fix DESCRIBE after case insensitive USE ( CASSANDRA - 5567 ) 
 Merged from 1 . 1 
 * Add retry mechanism to OTC for non - droppable _ verbs ( CASSANDRA - 5393 ) 
 * Use allocator information to improve memtable memory usage estimate 
 diff - - git a / bin / cqlsh b / bin / cqlsh 
 index a29eee4 . . 974c916 100755 
 - - - a / bin / cqlsh 
 + + + b / bin / cqlsh 
 @ @ - 32 , 7 + 32 , 7 @ @ exit 1 
 from _ _ future _ _ import with _ statement 
 
 description = " CQL Shell for Apache Cassandra " 
 - version = " 3 . 0 . 1 " 
 + version = " 3 . 0 . 2 " 
 
 from StringIO import StringIO 
 from itertools import groupby 
 @ @ - 962 , 7 + 962 , 10 @ @ class Shell ( cmd . Cmd ) : 
 def do _ use ( self , parsed ) : 
 ksname = parsed . get _ binding ( ' ksname ' ) 
 if self . perform _ statement _ untraced ( parsed . extract _ orig ( ) ) : 
 - self . current _ keyspace = self . cql _ unprotect _ name ( ksname ) 
 + if ksname [ 0 ] = = ' " ' and ksname [ - 1 ] = = ' " ' : 
 + self . current _ keyspace = self . cql _ unprotect _ name ( ksname ) 
 + else : 
 + self . current _ keyspace = ksname . lower ( ) 
 
 def do _ select ( self , parsed ) : 
 ksname = parsed . get _ binding ( ' ksname ' )
