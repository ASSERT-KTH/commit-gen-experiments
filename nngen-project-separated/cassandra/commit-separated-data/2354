BLEU SCORE: 0.08697972365316727

TEST MSG: Fix race in FileCacheService RemovalListener
GENERATED MSG: Fix accounting in FileCacheService to allow re - using RAR

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index 2b3ace3 . . c74b27d 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 1 , 3 + 1 , 7 @ @ <nl> + 2 . 0 . 10 <nl> + * Fix race in FileCacheService RemovalListener ( CASSANDRA - 7278 ) <nl> + <nl> + <nl> 2 . 0 . 9 <nl> * Fix CC # collectTimeOrderedData ( ) tombstone optimisations ( CASSANDRA - 7394 ) <nl> * Fix assertion error in CL . ANY timeout handling ( CASSANDRA - 7364 ) <nl> diff - - git a / src / java / org / apache / cassandra / service / FileCacheService . java b / src / java / org / apache / cassandra / service / FileCacheService . java <nl> index faa53f0 . . 59b5548 100644 <nl> - - - a / src / java / org / apache / cassandra / service / FileCacheService . java <nl> + + + b / src / java / org / apache / cassandra / service / FileCacheService . java <nl> @ @ - 69 , 7 + 69 , 7 @ @ public class FileCacheService <nl> if ( cachedInstances . size ( ) > 0 ) <nl> logger . debug ( " Evicting cold readers for { } " , cachedInstances . peek ( ) . getPath ( ) ) ; <nl> <nl> - for ( RandomAccessReader reader : cachedInstances ) <nl> + for ( RandomAccessReader reader = cachedInstances . poll ( ) ; reader ! = null ; reader = cachedInstances . poll ( ) ) <nl> { <nl> memoryUsage . addAndGet ( - 1 * reader . getTotalBufferSize ( ) ) ; <nl> reader . deallocate ( ) ;
NEAREST DIFF (one line): ELIMINATEDSENTENCE

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index 2b3ace3 . . c74b27d 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 1 , 3 + 1 , 7 @ @ 
 + 2 . 0 . 10 
 + * Fix race in FileCacheService RemovalListener ( CASSANDRA - 7278 ) 
 + 
 + 
 2 . 0 . 9 
 * Fix CC # collectTimeOrderedData ( ) tombstone optimisations ( CASSANDRA - 7394 ) 
 * Fix assertion error in CL . ANY timeout handling ( CASSANDRA - 7364 ) 
 diff - - git a / src / java / org / apache / cassandra / service / FileCacheService . java b / src / java / org / apache / cassandra / service / FileCacheService . java 
 index faa53f0 . . 59b5548 100644 
 - - - a / src / java / org / apache / cassandra / service / FileCacheService . java 
 + + + b / src / java / org / apache / cassandra / service / FileCacheService . java 
 @ @ - 69 , 7 + 69 , 7 @ @ public class FileCacheService 
 if ( cachedInstances . size ( ) > 0 ) 
 logger . debug ( " Evicting cold readers for { } " , cachedInstances . peek ( ) . getPath ( ) ) ; 
 
 - for ( RandomAccessReader reader : cachedInstances ) 
 + for ( RandomAccessReader reader = cachedInstances . poll ( ) ; reader ! = null ; reader = cachedInstances . poll ( ) ) 
 { 
 memoryUsage . addAndGet ( - 1 * reader . getTotalBufferSize ( ) ) ; 
 reader . deallocate ( ) ;

NEAREST DIFF:
ELIMINATEDSENTENCE
