BLEU SCORE: 0.028398387225677897

TEST MSG: Use " keyspace updated " message for UDT changes in v1 / 2 protocols
GENERATED MSG: Bump CQL version to 3 . 2 . 0 and update CQL docs

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index e940931 . . 1278c56 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 8 , 6 + 8 , 8 @ @ <nl> dropping non - existent index with IF EXISTS ( CASSANDRA - 7590 ) <nl> * Fix sstablelevelresetter hang ( CASSANDRA - 7614 ) <nl> * ( cqlsh ) Fix deserialization of blobs ( CASSANDRA - 7603 ) <nl> + * Use " keyspace updated " schema change message for UDT changes in v1 and <nl> + v2 protocols ( CASSANDRA - 7617 ) <nl> Merged from 2 . 0 : <nl> * Fix ReversedType ( DateType ) mapping to native protocol ( CASSANDRA - 7576 ) <nl> * Always merge ranges owned by a single node ( CASSANDRA - 6930 ) <nl> diff - - git a / doc / native _ protocol _ v1 . spec b / doc / native _ protocol _ v1 . spec <nl> index 08cb91e . . 83154fc 100644 <nl> - - - a / doc / native _ protocol _ v1 . spec <nl> + + + b / doc / native _ protocol _ v1 . spec <nl> @ @ - 472 , 8 + 472 , 10 @ @ Table of Contents <nl> the empty string " " ) if the change was affecting a keyspace and not a <nl> table . <nl> <nl> - Note that queries to create and drop an index are considered as change <nl> - updating the table the index is on . <nl> + Note that queries to create and drop an index are considered changes <nl> + updating the table the index is on . Queries that create , alter , or drop <nl> + user - defined types ( availble in Cassandra 2 . 1 + ) are considered changes <nl> + updating the keyspace the type is defined in . <nl> <nl> <nl> 4 . 2 . 6 . EVENT <nl> @ @ - 499 , 6 + 501 , 9 @ @ Table of Contents <nl> followed by the name of the affected keyspace and the name of the <nl> affected table within that keyspace . For changes that affect a keyspace <nl> directly , the table name will be empty ( i . e . the empty string " " ) . <nl> + Changes to user - defined types ( available in Cassandra 2 . 1 + ) will result <nl> + in an " UPDATED " change for the keyspace containing the type , and the <nl> + table name will be empty . <nl> <nl> All EVENT message have a streamId of - 1 ( Section 2 . 3 ) . <nl> <nl> diff - - git a / doc / native _ protocol _ v2 . spec b / doc / native _ protocol _ v2 . spec <nl> index 11d380f . . 0f0cbcb 100644 <nl> - - - a / doc / native _ protocol _ v2 . spec <nl> + + + b / doc / native _ protocol _ v2 . spec <nl> @ @ - 590 , 8 + 590 , 10 @ @ Table of Contents <nl> the empty string " " ) if the change was affecting a keyspace and not a <nl> table . <nl> <nl> - Note that queries to create and drop an index are considered as change <nl> - updating the table the index is on . <nl> + Note that queries to create and drop an index are considered changes <nl> + updating the table the index is on . Queries that create , alter , or drop <nl> + user - defined types ( availble in Cassandra 2 . 1 + ) are considered changes <nl> + updating the keyspace the type is defined in . <nl> <nl> <nl> 4 . 2 . 6 . EVENT <nl> @ @ - 617 , 6 + 619 , 9 @ @ Table of Contents <nl> followed by the name of the affected keyspace and the name of the <nl> affected table within that keyspace . For changes that affect a keyspace <nl> directly , the table name will be empty ( i . e . the empty string " " ) . <nl> + Changes to user - defined types ( available in Cassandra 2 . 1 + ) will result <nl> + in an " UPDATED " change for the keyspace containing the type , and the <nl> + table name will be empty . <nl> <nl> All EVENT message have a streamId of - 1 ( Section 2 . 3 ) . <nl> <nl> diff - - git a / src / java / org / apache / cassandra / transport / Event . java b / src / java / org / apache / cassandra / transport / Event . java <nl> index 1b7e487 . . b7c5e68 100644 <nl> - - - a / src / java / org / apache / cassandra / transport / Event . java <nl> + + + b / src / java / org / apache / cassandra / transport / Event . java <nl> @ @ - 258 , 9 + 258 , 20 @ @ public abstract class Event <nl> } <nl> else <nl> { <nl> - CBUtil . writeEnumValue ( change , dest ) ; <nl> - CBUtil . writeString ( keyspace , dest ) ; <nl> - CBUtil . writeString ( target = = Target . KEYSPACE ? " " : tableOrType , dest ) ; <nl> + if ( target = = Target . TYPE ) <nl> + { <nl> + / / For the v1 / v2 protocol , we have no way to represent type changes , so we simply say the keyspace <nl> + / / was updated . See CASSANDRA - 7617 . <nl> + CBUtil . writeEnumValue ( Change . UPDATED , dest ) ; <nl> + CBUtil . writeString ( keyspace , dest ) ; <nl> + CBUtil . writeString ( " " , dest ) ; <nl> + } <nl> + else <nl> + { <nl> + CBUtil . writeEnumValue ( change , dest ) ; <nl> + CBUtil . writeString ( keyspace , dest ) ; <nl> + CBUtil . writeString ( target = = Target . KEYSPACE ? " " : tableOrType , dest ) ; <nl> + } <nl> } <nl> } <nl> <nl> @ @ - 279 , 6 + 290 , 12 @ @ public abstract class Event <nl> } <nl> else <nl> { <nl> + if ( target = = Target . TYPE ) <nl> + { <nl> + return CBUtil . sizeOfEnumValue ( Change . UPDATED ) <nl> + + CBUtil . sizeOfString ( keyspace ) <nl> + + CBUtil . sizeOfString ( " " ) ; <nl> + } <nl> return CBUtil . sizeOfEnumValue ( change ) <nl> + CBUtil . sizeOfString ( keyspace ) <nl> + CBUtil . sizeOfString ( target = = Target . KEYSPACE ? " " : tableOrType ) ;
NEAREST DIFF (one line): ELIMINATEDSENTENCE

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index e940931 . . 1278c56 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 8 , 6 + 8 , 8 @ @ 
 dropping non - existent index with IF EXISTS ( CASSANDRA - 7590 ) 
 * Fix sstablelevelresetter hang ( CASSANDRA - 7614 ) 
 * ( cqlsh ) Fix deserialization of blobs ( CASSANDRA - 7603 ) 
 + * Use " keyspace updated " schema change message for UDT changes in v1 and 
 + v2 protocols ( CASSANDRA - 7617 ) 
 Merged from 2 . 0 : 
 * Fix ReversedType ( DateType ) mapping to native protocol ( CASSANDRA - 7576 ) 
 * Always merge ranges owned by a single node ( CASSANDRA - 6930 ) 
 diff - - git a / doc / native _ protocol _ v1 . spec b / doc / native _ protocol _ v1 . spec 
 index 08cb91e . . 83154fc 100644 
 - - - a / doc / native _ protocol _ v1 . spec 
 + + + b / doc / native _ protocol _ v1 . spec 
 @ @ - 472 , 8 + 472 , 10 @ @ Table of Contents 
 the empty string " " ) if the change was affecting a keyspace and not a 
 table . 
 
 - Note that queries to create and drop an index are considered as change 
 - updating the table the index is on . 
 + Note that queries to create and drop an index are considered changes 
 + updating the table the index is on . Queries that create , alter , or drop 
 + user - defined types ( availble in Cassandra 2 . 1 + ) are considered changes 
 + updating the keyspace the type is defined in . 
 
 
 4 . 2 . 6 . EVENT 
 @ @ - 499 , 6 + 501 , 9 @ @ Table of Contents 
 followed by the name of the affected keyspace and the name of the 
 affected table within that keyspace . For changes that affect a keyspace 
 directly , the table name will be empty ( i . e . the empty string " " ) . 
 + Changes to user - defined types ( available in Cassandra 2 . 1 + ) will result 
 + in an " UPDATED " change for the keyspace containing the type , and the 
 + table name will be empty . 
 
 All EVENT message have a streamId of - 1 ( Section 2 . 3 ) . 
 
 diff - - git a / doc / native _ protocol _ v2 . spec b / doc / native _ protocol _ v2 . spec 
 index 11d380f . . 0f0cbcb 100644 
 - - - a / doc / native _ protocol _ v2 . spec 
 + + + b / doc / native _ protocol _ v2 . spec 
 @ @ - 590 , 8 + 590 , 10 @ @ Table of Contents 
 the empty string " " ) if the change was affecting a keyspace and not a 
 table . 
 
 - Note that queries to create and drop an index are considered as change 
 - updating the table the index is on . 
 + Note that queries to create and drop an index are considered changes 
 + updating the table the index is on . Queries that create , alter , or drop 
 + user - defined types ( availble in Cassandra 2 . 1 + ) are considered changes 
 + updating the keyspace the type is defined in . 
 
 
 4 . 2 . 6 . EVENT 
 @ @ - 617 , 6 + 619 , 9 @ @ Table of Contents 
 followed by the name of the affected keyspace and the name of the 
 affected table within that keyspace . For changes that affect a keyspace 
 directly , the table name will be empty ( i . e . the empty string " " ) . 
 + Changes to user - defined types ( available in Cassandra 2 . 1 + ) will result 
 + in an " UPDATED " change for the keyspace containing the type , and the 
 + table name will be empty . 
 
 All EVENT message have a streamId of - 1 ( Section 2 . 3 ) . 
 
 diff - - git a / src / java / org / apache / cassandra / transport / Event . java b / src / java / org / apache / cassandra / transport / Event . java 
 index 1b7e487 . . b7c5e68 100644 
 - - - a / src / java / org / apache / cassandra / transport / Event . java 
 + + + b / src / java / org / apache / cassandra / transport / Event . java 
 @ @ - 258 , 9 + 258 , 20 @ @ public abstract class Event 
 } 
 else 
 { 
 - CBUtil . writeEnumValue ( change , dest ) ; 
 - CBUtil . writeString ( keyspace , dest ) ; 
 - CBUtil . writeString ( target = = Target . KEYSPACE ? " " : tableOrType , dest ) ; 
 + if ( target = = Target . TYPE ) 
 + { 
 + / / For the v1 / v2 protocol , we have no way to represent type changes , so we simply say the keyspace 
 + / / was updated . See CASSANDRA - 7617 . 
 + CBUtil . writeEnumValue ( Change . UPDATED , dest ) ; 
 + CBUtil . writeString ( keyspace , dest ) ; 
 + CBUtil . writeString ( " " , dest ) ; 
 + } 
 + else 
 + { 
 + CBUtil . writeEnumValue ( change , dest ) ; 
 + CBUtil . writeString ( keyspace , dest ) ; 
 + CBUtil . writeString ( target = = Target . KEYSPACE ? " " : tableOrType , dest ) ; 
 + } 
 } 
 } 
 
 @ @ - 279 , 6 + 290 , 12 @ @ public abstract class Event 
 } 
 else 
 { 
 + if ( target = = Target . TYPE ) 
 + { 
 + return CBUtil . sizeOfEnumValue ( Change . UPDATED ) 
 + + CBUtil . sizeOfString ( keyspace ) 
 + + CBUtil . sizeOfString ( " " ) ; 
 + } 
 return CBUtil . sizeOfEnumValue ( change ) 
 + CBUtil . sizeOfString ( keyspace ) 
 + CBUtil . sizeOfString ( target = = Target . KEYSPACE ? " " : tableOrType ) ;

NEAREST DIFF:
ELIMINATEDSENTENCE
