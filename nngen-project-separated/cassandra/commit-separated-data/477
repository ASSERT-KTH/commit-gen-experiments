BLEU SCORE: 0.02133165846478451

TEST MSG: Exceptions encountered calling getSeeds ( ) breaks OTC thread
GENERATED MSG: Record the real messaging version in all cases in OutboundTcpConnection

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index d53457f . . 1b83501 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 1 , 3 + 1 , 6 @ @ <nl> + 2 . 2 . 10 <nl> + * Exceptions encountered calling getSeeds ( ) breaks OTC thread ( CASSANDRA - 13018 ) <nl> + <nl> 2 . 2 . 9 <nl> * Coalescing strategy sleeps too much and shouldn ' t be enabled by default ( CASSANDRA - 13090 ) <nl> * Fix negative mean latency metric ( CASSANDRA - 12876 ) <nl> diff - - git a / src / java / org / apache / cassandra / net / OutboundTcpConnection . java b / src / java / org / apache / cassandra / net / OutboundTcpConnection . java <nl> index 6ec78a4 . . 8baac75 100644 <nl> - - - a / src / java / org / apache / cassandra / net / OutboundTcpConnection . java <nl> + + + b / src / java / org / apache / cassandra / net / OutboundTcpConnection . java <nl> @ @ - 434 , 8 + 434 , 6 @ @ public class OutboundTcpConnection extends Thread <nl> / / a different target version ( targetVersion < MessagingService . VERSION _ 12 ) <nl> / / or if the same version the handshake will finally succeed <nl> logger . trace ( " Target max version is { } ; no version information yet , will retry " , maxTargetVersion ) ; <nl> - if ( DatabaseDescriptor . getSeeds ( ) . contains ( poolReference . endPoint ( ) ) ) <nl> - logger . warn ( " Seed gossip version is { } ; will not connect with that version " , maxTargetVersion ) ; <nl> disconnect ( ) ; <nl> continue ; <nl> } <nl> @ @ - 447 , 8 + 445 , 24 @ @ public class OutboundTcpConnection extends Thread <nl> if ( targetVersion > maxTargetVersion ) <nl> { <nl> logger . trace ( " Target max version is { } ; will reconnect with that version " , maxTargetVersion ) ; <nl> - disconnect ( ) ; <nl> - return false ; <nl> + try <nl> + { <nl> + if ( DatabaseDescriptor . getSeeds ( ) . contains ( poolReference . endPoint ( ) ) ) <nl> + logger . warn ( " Seed gossip version is { } ; will not connect with that version " , maxTargetVersion ) ; <nl> + } <nl> + catch ( Throwable e ) <nl> + { <nl> + / / If invalid yaml has been added to the config since startup , getSeeds ( ) will throw an AssertionError <nl> + / / Additionally , third party seed providers may throw exceptions if network is flakey <nl> + / / Regardless of what ' s thrown , we must catch it , disconnect , and try again <nl> + JVMStabilityInspector . inspectThrowable ( e ) ; <nl> + logger . warn ( " Configuration error prevented outbound connection : { } " , e . getLocalizedMessage ( ) ) ; <nl> + } <nl> + finally <nl> + { <nl> + disconnect ( ) ; <nl> + return false ; <nl> + } <nl> } <nl> <nl> if ( targetVersion < maxTargetVersion & & targetVersion < MessagingService . current _ version )
NEAREST DIFF (one line): ELIMINATEDSENTENCE

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index d53457f . . 1b83501 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 1 , 3 + 1 , 6 @ @ 
 + 2 . 2 . 10 
 + * Exceptions encountered calling getSeeds ( ) breaks OTC thread ( CASSANDRA - 13018 ) 
 + 
 2 . 2 . 9 
 * Coalescing strategy sleeps too much and shouldn ' t be enabled by default ( CASSANDRA - 13090 ) 
 * Fix negative mean latency metric ( CASSANDRA - 12876 ) 
 diff - - git a / src / java / org / apache / cassandra / net / OutboundTcpConnection . java b / src / java / org / apache / cassandra / net / OutboundTcpConnection . java 
 index 6ec78a4 . . 8baac75 100644 
 - - - a / src / java / org / apache / cassandra / net / OutboundTcpConnection . java 
 + + + b / src / java / org / apache / cassandra / net / OutboundTcpConnection . java 
 @ @ - 434 , 8 + 434 , 6 @ @ public class OutboundTcpConnection extends Thread 
 / / a different target version ( targetVersion < MessagingService . VERSION _ 12 ) 
 / / or if the same version the handshake will finally succeed 
 logger . trace ( " Target max version is { } ; no version information yet , will retry " , maxTargetVersion ) ; 
 - if ( DatabaseDescriptor . getSeeds ( ) . contains ( poolReference . endPoint ( ) ) ) 
 - logger . warn ( " Seed gossip version is { } ; will not connect with that version " , maxTargetVersion ) ; 
 disconnect ( ) ; 
 continue ; 
 } 
 @ @ - 447 , 8 + 445 , 24 @ @ public class OutboundTcpConnection extends Thread 
 if ( targetVersion > maxTargetVersion ) 
 { 
 logger . trace ( " Target max version is { } ; will reconnect with that version " , maxTargetVersion ) ; 
 - disconnect ( ) ; 
 - return false ; 
 + try 
 + { 
 + if ( DatabaseDescriptor . getSeeds ( ) . contains ( poolReference . endPoint ( ) ) ) 
 + logger . warn ( " Seed gossip version is { } ; will not connect with that version " , maxTargetVersion ) ; 
 + } 
 + catch ( Throwable e ) 
 + { 
 + / / If invalid yaml has been added to the config since startup , getSeeds ( ) will throw an AssertionError 
 + / / Additionally , third party seed providers may throw exceptions if network is flakey 
 + / / Regardless of what ' s thrown , we must catch it , disconnect , and try again 
 + JVMStabilityInspector . inspectThrowable ( e ) ; 
 + logger . warn ( " Configuration error prevented outbound connection : { } " , e . getLocalizedMessage ( ) ) ; 
 + } 
 + finally 
 + { 
 + disconnect ( ) ; 
 + return false ; 
 + } 
 } 
 
 if ( targetVersion < maxTargetVersion & & targetVersion < MessagingService . current _ version )

NEAREST DIFF:
ELIMINATEDSENTENCE
