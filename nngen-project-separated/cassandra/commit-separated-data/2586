BLEU SCORE: 0.013139808552042212

TEST MSG: add asserts to make sure we don ' t call KS . open during startup
GENERATED MSG: Fix unit tests on java7

TEST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / db / Keyspace . java b / src / java / org / apache / cassandra / db / Keyspace . java <nl> index d6746da . . c0a8690 100644 <nl> - - - a / src / java / org / apache / cassandra / db / Keyspace . java <nl> + + + b / src / java / org / apache / cassandra / db / Keyspace . java <nl> @ @ - 83 , 13 + 83 , 21 @ @ public class Keyspace <nl> } <nl> } ; <nl> <nl> + private static volatile boolean initialized = false ; <nl> + public static void setInitialized ( ) <nl> + { <nl> + initialized = true ; <nl> + } <nl> + <nl> public static Keyspace open ( String keyspaceName ) <nl> { <nl> + assert initialized | | keyspaceName . equals ( SYSTEM _ KS ) ; <nl> return open ( keyspaceName , Schema . instance , true ) ; <nl> } <nl> <nl> public static Keyspace openWithoutSSTables ( String keyspaceName ) <nl> { <nl> + assert initialized | | keyspaceName . equals ( SYSTEM _ KS ) ; <nl> return open ( keyspaceName , Schema . instance , false ) ; <nl> } <nl> <nl> diff - - git a / src / java / org / apache / cassandra / service / CassandraDaemon . java b / src / java / org / apache / cassandra / service / CassandraDaemon . java <nl> index 7259a17 . . 7171b68 100644 <nl> - - - a / src / java / org / apache / cassandra / service / CassandraDaemon . java <nl> + + + b / src / java / org / apache / cassandra / service / CassandraDaemon . java <nl> @ @ - 31 , 14 + 31 , 12 @ @ import javax . management . MBeanServer ; <nl> import javax . management . ObjectName ; <nl> import javax . management . StandardMBean ; <nl> <nl> - import com . addthis . metrics . reporter . config . ReporterConfig ; <nl> import com . google . common . collect . Iterables ; <nl> import com . google . common . util . concurrent . Uninterruptibles ; <nl> - <nl> - import org . apache . cassandra . io . sstable . CorruptSSTableException ; <nl> import org . slf4j . Logger ; <nl> import org . slf4j . LoggerFactory ; <nl> <nl> + import com . addthis . metrics . reporter . config . ReporterConfig ; <nl> import org . apache . cassandra . concurrent . JMXEnabledThreadPoolExecutor ; <nl> import org . apache . cassandra . concurrent . Stage ; <nl> import org . apache . cassandra . concurrent . StageManager ; <nl> @ @ - 53 , 6 + 51 , 7 @ @ import org . apache . cassandra . db . commitlog . CommitLog ; <nl> import org . apache . cassandra . db . compaction . CompactionManager ; <nl> import org . apache . cassandra . exceptions . ConfigurationException ; <nl> import org . apache . cassandra . io . FSError ; <nl> + import org . apache . cassandra . io . sstable . CorruptSSTableException ; <nl> import org . apache . cassandra . io . util . FileUtils ; <nl> import org . apache . cassandra . metrics . StorageMetrics ; <nl> import org . apache . cassandra . thrift . ThriftServer ; <nl> @ @ - 258 , 6 + 257 , 7 @ @ public class CassandraDaemon <nl> ColumnFamilyStore . scrubDataDirectories ( cfm ) ; <nl> } <nl> <nl> + Keyspace . setInitialized ( ) ; <nl> / / initialize keyspaces <nl> for ( String keyspaceName : Schema . instance . getKeyspaces ( ) ) <nl> { <nl> diff - - git a / test / unit / org / apache / cassandra / SchemaLoader . java b / test / unit / org / apache / cassandra / SchemaLoader . java <nl> index 43a6dc3 . . 943cf96 100644 <nl> - - - a / test / unit / org / apache / cassandra / SchemaLoader . java <nl> + + + b / test / unit / org / apache / cassandra / SchemaLoader . java <nl> @ @ - 21 , 19 + 21 , 19 @ @ import java . io . File ; <nl> import java . nio . ByteBuffer ; <nl> import java . util . * ; <nl> <nl> - import org . apache . cassandra . cache . CachingOptions ; <nl> - import org . apache . cassandra . db . index . PerRowSecondaryIndexTest ; <nl> - import org . apache . cassandra . db . index . SecondaryIndex ; <nl> import org . junit . AfterClass ; <nl> import org . junit . BeforeClass ; <nl> import org . slf4j . Logger ; <nl> import org . slf4j . LoggerFactory ; <nl> <nl> + import org . apache . cassandra . cache . CachingOptions ; <nl> import org . apache . cassandra . config . * ; <nl> import org . apache . cassandra . cql3 . ColumnIdentifier ; <nl> import org . apache . cassandra . db . * ; <nl> import org . apache . cassandra . db . commitlog . CommitLog ; <nl> import org . apache . cassandra . db . compaction . LeveledCompactionStrategy ; <nl> + import org . apache . cassandra . db . index . PerRowSecondaryIndexTest ; <nl> + import org . apache . cassandra . db . index . SecondaryIndex ; <nl> import org . apache . cassandra . db . marshal . * ; <nl> import org . apache . cassandra . exceptions . ConfigurationException ; <nl> import org . apache . cassandra . gms . Gossiper ; <nl> @ @ - 65 , 6 + 65 , 7 @ @ public class SchemaLoader <nl> } <nl> } ) ; <nl> <nl> + Keyspace . setInitialized ( ) ; <nl> / / Migrations aren ' t happy if gossiper is not started . Even if we don ' t use migrations though , <nl> / / some tests now expect us to start gossip for them . <nl> startGossiper ( ) ; <nl> diff - - git a / test / unit / org / apache / cassandra / config / DatabaseDescriptorTest . java b / test / unit / org / apache / cassandra / config / DatabaseDescriptorTest . java <nl> index b954f39 . . f6d4ad4 100644 <nl> - - - a / test / unit / org / apache / cassandra / config / DatabaseDescriptorTest . java <nl> + + + b / test / unit / org / apache / cassandra / config / DatabaseDescriptorTest . java <nl> @ @ - 18 , 18 + 18 , 21 @ @ <nl> * / <nl> package org . apache . cassandra . config ; <nl> <nl> + import org . junit . Test ; <nl> + import org . junit . runner . RunWith ; <nl> + <nl> import org . apache . cassandra . OrderedJUnit4ClassRunner ; <nl> import org . apache . cassandra . SchemaLoader ; <nl> + import org . apache . cassandra . db . Keyspace ; <nl> import org . apache . cassandra . exceptions . ConfigurationException ; <nl> import org . apache . cassandra . exceptions . InvalidRequestException ; <nl> import org . apache . cassandra . gms . Gossiper ; <nl> import org . apache . cassandra . locator . SimpleStrategy ; <nl> import org . apache . cassandra . service . MigrationManager ; <nl> <nl> - import org . junit . Test ; <nl> - import org . junit . runner . RunWith ; <nl> - <nl> - import static org . junit . Assert . * ; <nl> + import static org . junit . Assert . assertEquals ; <nl> + import static org . junit . Assert . assertNotNull ; <nl> + import static org . junit . Assert . assertNull ; <nl> <nl> @ RunWith ( OrderedJUnit4ClassRunner . class ) <nl> public class DatabaseDescriptorTest <nl> @ @ - 70 , 6 + 73 , 7 @ @ public class DatabaseDescriptorTest <nl> assertEquals ( 0 , Schema . instance . getNonSystemKeyspaces ( ) . size ( ) ) ; <nl> <nl> Gossiper . instance . start ( ( int ) ( System . currentTimeMillis ( ) / 1000 ) ) ; <nl> + Keyspace . setInitialized ( ) ; <nl> <nl> try <nl> { <nl> @ @ - 103 , 6 + 107 , 7 @ @ public class DatabaseDescriptorTest <nl> / / By default , we should load from the yaml <nl> Config config = DatabaseDescriptor . loadConfig ( ) ; <nl> assertEquals ( " Test Cluster " , config . cluster _ name ) ; <nl> + Keyspace . setInitialized ( ) ; <nl> <nl> / / Now try custom loader <nl> ConfigurationLoader testLoader = new TestLoader ( ) ; <nl> diff - - git a / test / unit / org / apache / cassandra / io / sstable / CQLSSTableWriterTest . java b / test / unit / org / apache / cassandra / io / sstable / CQLSSTableWriterTest . java <nl> index 73ff21c . . c35a1df 100644 <nl> - - - a / test / unit / org / apache / cassandra / io / sstable / CQLSSTableWriterTest . java <nl> + + + b / test / unit / org / apache / cassandra / io / sstable / CQLSSTableWriterTest . java <nl> @ @ - 24 , 23 + 24 , 27 @ @ import com . google . common . collect . ImmutableMap ; <nl> import com . google . common . io . Files ; <nl> import org . junit . BeforeClass ; <nl> import org . junit . Test ; <nl> - import static org . junit . Assert . assertEquals ; <nl> - import static org . junit . Assert . assertFalse ; <nl> <nl> import org . apache . cassandra . config . CFMetaData ; <nl> import org . apache . cassandra . config . Schema ; <nl> - import org . apache . cassandra . cql3 . * ; <nl> + import org . apache . cassandra . cql3 . QueryProcessor ; <nl> + import org . apache . cassandra . cql3 . UntypedResultSet ; <nl> + import org . apache . cassandra . db . Keyspace ; <nl> import org . apache . cassandra . dht . Range ; <nl> import org . apache . cassandra . dht . Token ; <nl> import org . apache . cassandra . service . StorageService ; <nl> import org . apache . cassandra . utils . FBUtilities ; <nl> import org . apache . cassandra . utils . OutputHandler ; <nl> <nl> + import static org . junit . Assert . assertEquals ; <nl> + import static org . junit . Assert . assertFalse ; <nl> + <nl> public class CQLSSTableWriterTest <nl> { <nl> @ BeforeClass <nl> public static void setup ( ) throws Exception <nl> { <nl> + Keyspace . setInitialized ( ) ; <nl> StorageService . instance . initServer ( ) ; <nl> } <nl> <nl> diff - - git a / test / unit / org / apache / cassandra / io / sstable / LegacySSTableTest . java b / test / unit / org / apache / cassandra / io / sstable / LegacySSTableTest . java <nl> index c0c9d41 . . e26d0f5 100644 <nl> - - - a / test / unit / org / apache / cassandra / io / sstable / LegacySSTableTest . java <nl> + + + b / test / unit / org / apache / cassandra / io / sstable / LegacySSTableTest . java <nl> @ @ - 21 , 11 + 21 , 21 @ @ package org . apache . cassandra . io . sstable ; <nl> <nl> import java . io . File ; <nl> import java . nio . ByteBuffer ; <nl> - import java . util . * ; <nl> + import java . util . ArrayList ; <nl> + import java . util . HashSet ; <nl> + import java . util . List ; <nl> + import java . util . Set ; <nl> + <nl> + import org . junit . BeforeClass ; <nl> + import org . junit . Test ; <nl> <nl> import org . apache . cassandra . SchemaLoader ; <nl> import org . apache . cassandra . Util ; <nl> - import org . apache . cassandra . db . * ; <nl> + import org . apache . cassandra . db . ColumnFamily ; <nl> + import org . apache . cassandra . db . ColumnFamilyStore ; <nl> + import org . apache . cassandra . db . DecoratedKey ; <nl> + import org . apache . cassandra . db . DeletionInfo ; <nl> + import org . apache . cassandra . db . Keyspace ; <nl> import org . apache . cassandra . db . columniterator . SSTableNamesIterator ; <nl> import org . apache . cassandra . db . composites . CellNameType ; <nl> import org . apache . cassandra . dht . IPartitioner ; <nl> @ @ - 34 , 10 + 44 , 8 @ @ import org . apache . cassandra . dht . Token ; <nl> import org . apache . cassandra . service . StorageService ; <nl> import org . apache . cassandra . streaming . StreamPlan ; <nl> import org . apache . cassandra . streaming . StreamSession ; <nl> - import org . apache . cassandra . utils . FBUtilities ; <nl> import org . apache . cassandra . utils . ByteBufferUtil ; <nl> - import org . junit . BeforeClass ; <nl> - import org . junit . Test ; <nl> + import org . apache . cassandra . utils . FBUtilities ; <nl> <nl> / * * <nl> * Tests backwards compatibility for SSTables <nl> @ @ - 54 , 6 + 62 , 7 @ @ public class LegacySSTableTest extends SchemaLoader <nl> @ BeforeClass <nl> public static void beforeClass ( ) <nl> { <nl> + Keyspace . setInitialized ( ) ; <nl> String scp = System . getProperty ( LEGACY _ SSTABLE _ PROP ) ; <nl> assert scp ! = null ; <nl> LEGACY _ SSTABLE _ ROOT = new File ( scp ) . getAbsoluteFile ( ) ; <nl> diff - - git a / test / unit / org / apache / cassandra / io / sstable / SSTableLoaderTest . java b / test / unit / org / apache / cassandra / io / sstable / SSTableLoaderTest . java <nl> index 809934f . . 18beaa9 100644 <nl> - - - a / test / unit / org / apache / cassandra / io / sstable / SSTableLoaderTest . java <nl> + + + b / test / unit / org / apache / cassandra / io / sstable / SSTableLoaderTest . java <nl> @ @ - 45 , 6 + 45 , 7 @ @ public class SSTableLoaderTest extends SchemaLoader <nl> @ BeforeClass <nl> public static void setup ( ) throws Exception <nl> { <nl> + Keyspace . setInitialized ( ) ; <nl> StorageService . instance . initServer ( ) ; <nl> } <nl> <nl> diff - - git a / test / unit / org / apache / cassandra / locator / EC2SnitchTest . java b / test / unit / org / apache / cassandra / locator / EC2SnitchTest . java <nl> index fe48ce5 . . 6015adf 100644 <nl> - - - a / test / unit / org / apache / cassandra / locator / EC2SnitchTest . java <nl> + + + b / test / unit / org / apache / cassandra / locator / EC2SnitchTest . java <nl> @ @ - 21 , 16 + 21 , 18 @ @ package org . apache . cassandra . locator ; <nl> * / <nl> <nl> <nl> - import static org . junit . Assert . assertEquals ; <nl> - <nl> import java . io . IOException ; <nl> import java . net . InetAddress ; <nl> import java . net . UnknownHostException ; <nl> import java . util . Map ; <nl> <nl> + import org . junit . AfterClass ; <nl> import org . junit . Assert ; <nl> + import org . junit . BeforeClass ; <nl> + import org . junit . Test ; <nl> <nl> import org . apache . cassandra . SchemaLoader ; <nl> + import org . apache . cassandra . db . Keyspace ; <nl> import org . apache . cassandra . exceptions . ConfigurationException ; <nl> import org . apache . cassandra . gms . ApplicationState ; <nl> import org . apache . cassandra . gms . Gossiper ; <nl> @ @ - 38 , 9 + 40 , 8 @ @ import org . apache . cassandra . gms . VersionedValue ; <nl> import org . apache . cassandra . net . MessagingService ; <nl> import org . apache . cassandra . net . OutboundTcpConnectionPool ; <nl> import org . apache . cassandra . service . StorageService ; <nl> - import org . junit . AfterClass ; <nl> - import org . junit . BeforeClass ; <nl> - import org . junit . Test ; <nl> + <nl> + import static org . junit . Assert . assertEquals ; <nl> <nl> public class EC2SnitchTest <nl> { <nl> @ @ - 51 , 6 + 52 , 7 @ @ public class EC2SnitchTest <nl> { <nl> SchemaLoader . mkdirs ( ) ; <nl> SchemaLoader . cleanup ( ) ; <nl> + Keyspace . setInitialized ( ) ; <nl> StorageService . instance . initServer ( 0 ) ; <nl> } <nl> <nl> diff - - git a / test / unit / org / apache / cassandra / service / StorageServiceServerTest . java b / test / unit / org / apache / cassandra / service / StorageServiceServerTest . java <nl> index f58ded6 . . 81c5261 100644 <nl> - - - a / test / unit / org / apache / cassandra / service / StorageServiceServerTest . java <nl> + + + b / test / unit / org / apache / cassandra / service / StorageServiceServerTest . java <nl> @ @ - 56 , 6 + 56 , 7 @ @ public class StorageServiceServerTest <nl> { <nl> IEndpointSnitch snitch = new PropertyFileSnitch ( ) ; <nl> DatabaseDescriptor . setEndpointSnitch ( snitch ) ; <nl> + Keyspace . setInitialized ( ) ; <nl> } <nl> <nl> @ Test
NEAREST DIFF (one line): diff - - git a / test / unit / org / apache / cassandra / config / DatabaseDescriptorTest . java b / test / unit / org / apache / cassandra / config / DatabaseDescriptorTest . java <nl> index 4273662 . . 87f1a66 100644 <nl> - - - a / test / unit / org / apache / cassandra / config / DatabaseDescriptorTest . java <nl> + + + b / test / unit / org / apache / cassandra / config / DatabaseDescriptorTest . java <nl> @ @ - 18 , 6 + 18 , 7 @ @ <nl> * / <nl> package org . apache . cassandra . config ; <nl> <nl> + import org . apache . cassandra . OrderedJUnit4ClassRunner ; <nl> import org . apache . cassandra . SchemaLoader ; <nl> import org . apache . cassandra . exceptions . ConfigurationException ; <nl> import org . apache . cassandra . exceptions . InvalidRequestException ; <nl> @ @ - 26 , 9 + 27 , 11 @ @ import org . apache . cassandra . locator . SimpleStrategy ; <nl> import org . apache . cassandra . service . MigrationManager ; <nl> <nl> import org . junit . Test ; <nl> + import org . junit . runner . RunWith ; <nl> <nl> import java . io . IOException ; <nl> <nl> + @ RunWith ( OrderedJUnit4ClassRunner . class ) <nl> public class DatabaseDescriptorTest <nl> { <nl> @ Test <nl> diff - - git a / test / unit / org / apache / cassandra / config / DefsTest . java b / test / unit / org / apache / cassandra / config / DefsTest . java <nl> index 5bb16a0 . . 87c53d4 100644 <nl> - - - a / test / unit / org / apache / cassandra / config / DefsTest . java <nl> + + + b / test / unit / org / apache / cassandra / config / DefsTest . java <nl> @ @ - 24 , 6 + 24 , 7 @ @ import java . nio . ByteBuffer ; <nl> import java . util . * ; <nl> import java . util . concurrent . ExecutionException ; <nl> <nl> + import org . apache . cassandra . OrderedJUnit4ClassRunner ; <nl> import org . apache . cassandra . SchemaLoader ; <nl> import org . apache . cassandra . Util ; <nl> import org . apache . cassandra . db . * ; <nl> @ @ - 43 , 7 + 44 , 9 @ @ import org . apache . cassandra . thrift . IndexType ; <nl> import org . apache . cassandra . utils . ByteBufferUtil ; <nl> <nl> import org . junit . Test ; <nl> + import org . junit . runner . RunWith ; <nl> <nl> + @ RunWith ( OrderedJUnit4ClassRunner . class ) <nl> public class DefsTest extends SchemaLoader <nl> { <nl> <nl> diff - - git a / test / unit / org / apache / cassandra / db / ColumnFamilyStoreTest . java b / test / unit / org / apache / cassandra / db / ColumnFamilyStoreTest . java <nl> index 8318f0d . . eab9772 100644 <nl> - - - a / test / unit / org / apache / cassandra / db / ColumnFamilyStoreTest . java <nl> + + + b / test / unit / org / apache / cassandra / db / ColumnFamilyStoreTest . java <nl> @ @ - 32 , 6 + 32 , 7 @ @ import com . google . common . collect . Sets ; <nl> import org . apache . commons . lang . ArrayUtils ; <nl> import org . apache . commons . lang . StringUtils ; <nl> import org . junit . Test ; <nl> + import org . junit . runner . RunWith ; <nl> <nl> import static org . junit . Assert . assertNull ; <nl> import static junit . framework . Assert . assertEquals ; <nl> @ @ - 45 , 6 + 46 , 7 @ @ import static org . apache . cassandra . db . TableTest . assertColumns ; <nl> import static org . apache . cassandra . utils . ByteBufferUtil . bytes ; <nl> import static org . apache . commons . lang . ArrayUtils . EMPTY _ BYTE _ ARRAY ; <nl> <nl> + import org . apache . cassandra . OrderedJUnit4ClassRunner ; <nl> import org . apache . cassandra . SchemaLoader ; <nl> import org . apache . cassandra . Util ; <nl> import org . apache . cassandra . config . CFMetaData ; <nl> @ @ - 68 , 6 + 70 , 7 @ @ import org . apache . cassandra . thrift . * ; <nl> import org . apache . cassandra . utils . ByteBufferUtil ; <nl> import org . apache . cassandra . utils . WrappedRunnable ; <nl> <nl> + @ RunWith ( OrderedJUnit4ClassRunner . class ) <nl> public class ColumnFamilyStoreTest extends SchemaLoader <nl> { <nl> static byte [ ] bytes1 , bytes2 ; <nl> diff - - git a / test / unit / org / apache / cassandra / db / compaction / CompactionsTest . java b / test / unit / org / apache / cassandra / db / compaction / CompactionsTest . java <nl> index a09451e . . 3a469bf 100644 <nl> - - - a / test / unit / org / apache / cassandra / db / compaction / CompactionsTest . java <nl> + + + b / test / unit / org / apache / cassandra / db / compaction / CompactionsTest . java <nl> @ @ - 25 , 7 + 25 , 9 @ @ import java . util . concurrent . ExecutionException ; <nl> import java . util . concurrent . TimeUnit ; <nl> <nl> import org . junit . Test ; <nl> + import org . junit . runner . RunWith ; <nl> <nl> + import org . apache . cassandra . OrderedJUnit4ClassRunner ; <nl> import org . apache . cassandra . SchemaLoader ; <nl> import org . apache . cassandra . Util ; <nl> import org . apache . cassandra . config . DatabaseDescriptor ; <nl> @ @ - 43 , 6 + 45 , 7 @ @ import org . apache . cassandra . utils . FBUtilities ; <nl> <nl> import static junit . framework . Assert . * ; <nl> <nl> + @ RunWith ( OrderedJUnit4ClassRunner . class ) <nl> public class CompactionsTest extends SchemaLoader <nl> { <nl> public static final String TABLE1 = " Keyspace1 " ; <nl> diff - - git a / test / unit / org / apache / cassandra / db / compaction / LeveledCompactionStrategyTest . java b / test / unit / org / apache / cassandra / db / compaction / LeveledCompactionStrategyTest . java <nl> index 6a329c3 . . e073c41 100644 <nl> - - - a / test / unit / org / apache / cassandra / db / compaction / LeveledCompactionStrategyTest . java <nl> + + + b / test / unit / org / apache / cassandra / db / compaction / LeveledCompactionStrategyTest . java <nl> @ @ - 21 , 7 + 21 , 9 @ @ import java . nio . ByteBuffer ; <nl> import java . util . Collection ; <nl> <nl> import org . junit . Test ; <nl> + import org . junit . runner . RunWith ; <nl> <nl> + import org . apache . cassandra . OrderedJUnit4ClassRunner ; <nl> import org . apache . cassandra . SchemaLoader ; <nl> import org . apache . cassandra . Util ; <nl> import org . apache . cassandra . db . ColumnFamilyStore ; <nl> @ @ - 37 , 6 + 39 , 7 @ @ import org . apache . cassandra . service . AntiEntropyService ; <nl> import org . apache . cassandra . utils . ByteBufferUtil ; <nl> import org . apache . cassandra . utils . FBUtilities ; <nl> <nl> + @ RunWith ( OrderedJUnit4ClassRunner . class ) <nl> public class LeveledCompactionStrategyTest extends SchemaLoader <nl> { <nl> / * <nl> diff - - git a / test / unit / org / apache / cassandra / dht / BootStrapperTest . java b / test / unit / org / apache / cassandra / dht / BootStrapperTest . java <nl> index d2b1aec . . 2381545 100644 <nl> - - - a / test / unit / org / apache / cassandra / dht / BootStrapperTest . java <nl> + + + b / test / unit / org / apache / cassandra / dht / BootStrapperTest . java <nl> @ @ - 31 , 7 + 31 , 9 @ @ import java . util . UUID ; <nl> import java . util . concurrent . CountDownLatch ; <nl> <nl> import org . junit . Test ; <nl> + import org . junit . runner . RunWith ; <nl> <nl> + import org . apache . cassandra . OrderedJUnit4ClassRunner ; <nl> import org . apache . cassandra . SchemaLoader ; <nl> import org . apache . cassandra . config . Schema ; <nl> import org . apache . cassandra . db . Table ; <nl> @ @ - 46 , 6 + 48 , 7 @ @ import org . apache . cassandra . utils . FBUtilities ; <nl> <nl> import static org . junit . Assert . * ; <nl> <nl> + @ RunWith ( OrderedJUnit4ClassRunner . class ) <nl> public class BootStrapperTest extends SchemaLoader <nl> { <nl> @ Test <nl> diff - - git a / test / unit / org / apache / cassandra / io / sstable / SSTableReaderTest . java b / test / unit / org / apache / cassandra / io / sstable / SSTableReaderTest . java <nl> index 0fe9757 . . 64e70f7 100644 <nl> - - - a / test / unit / org / apache / cassandra / io / sstable / SSTableReaderTest . java <nl> + + + b / test / unit / org / apache / cassandra / io / sstable / SSTableReaderTest . java <nl> @ @ - 31 , 7 + 31 , 9 @ @ import java . util . concurrent . ExecutionException ; <nl> import java . util . * ; <nl> <nl> import org . junit . Test ; <nl> + import org . junit . runner . RunWith ; <nl> <nl> + import org . apache . cassandra . OrderedJUnit4ClassRunner ; <nl> import org . apache . cassandra . SchemaLoader ; <nl> import org . apache . cassandra . Util ; <nl> import org . apache . cassandra . config . DatabaseDescriptor ; <nl> @ @ - 56 , 6 + 58 , 7 @ @ import org . apache . cassandra . utils . ByteBufferUtil ; <nl> import org . apache . cassandra . utils . CLibrary ; <nl> import org . apache . cassandra . utils . Pair ; <nl> <nl> + @ RunWith ( OrderedJUnit4ClassRunner . class ) <nl> public class SSTableReaderTest extends SchemaLoader <nl> { <nl> static Token t ( int i ) <nl> diff - - git a / test / unit / org / apache / cassandra / service / StorageServiceServerTest . java b / test / unit / org / apache / cassandra / service / StorageServiceServerTest . java <nl> index c4931a6 . . 39fbb4a 100644 <nl> - - - a / test / unit / org / apache / cassandra / service / StorageServiceServerTest . java <nl> + + + b / test / unit / org / apache / cassandra / service / StorageServiceServerTest . java <nl> @ @ - 25 , 7 + 25 , 9 @ @ import java . util . Collections ; <nl> import java . util . List ; <nl> <nl> import org . junit . Test ; <nl> + import org . junit . runner . RunWith ; <nl> <nl> + import org . apache . cassandra . OrderedJUnit4ClassRunner ; <nl> import org . apache . cassandra . exceptions . ConfigurationException ; <nl> import org . apache . cassandra . db . Table ; <nl> import org . apache . cassandra . dht . Token ; <nl> @ @ - 35 , 6 + 37 , 7 @ @ import org . apache . cassandra . config . DatabaseDescriptor ; <nl> import static org . junit . Assert . assertEquals ; <nl> import static org . junit . Assert . assertTrue ; <nl> <nl> + @ RunWith ( OrderedJUnit4ClassRunner . class ) <nl> public class StorageServiceServerTest <nl> { <nl> @ Test <nl> diff - - git a / test / unit / org / apache / cassandra / streaming / StreamingTransferTest . java b / test / unit / org / apache / cassandra / streaming / StreamingTransferTest . java <nl> index 2d96030 . . 502e5d7 100644 <nl> - - - a / test / unit / org / apache / cassandra / streaming / StreamingTransferTest . java <nl> + + + b / test / unit / org / apache / cassandra / streaming / StreamingTransferTest . java <nl> @ @ - 20 , 6 + 20 , 7 @ @ package org . apache . cassandra . streaming ; <nl> * / <nl> <nl> import static junit . framework . Assert . assertEquals ; <nl> + import org . apache . cassandra . OrderedJUnit4ClassRunner ; <nl> import org . apache . cassandra . Util ; <nl> import static org . apache . cassandra . Util . column ; <nl> import static org . apache . cassandra . Util . addMutation ; <nl> @ @ - 47 , 11 + 48 , 13 @ @ import org . apache . cassandra . utils . FBUtilities ; <nl> <nl> import org . junit . BeforeClass ; <nl> import org . junit . Test ; <nl> + import org . junit . runner . RunWith ; <nl> import org . slf4j . Logger ; <nl> import org . slf4j . LoggerFactory ; <nl> <nl> import org . apache . cassandra . utils . ByteBufferUtil ; <nl> <nl> + @ RunWith ( OrderedJUnit4ClassRunner . class ) <nl> public class StreamingTransferTest extends SchemaLoader <nl> { <nl> private static final Logger logger = LoggerFactory . getLogger ( StreamingTransferTest . class ) ;

TEST DIFF:
diff - - git a / src / java / org / apache / cassandra / db / Keyspace . java b / src / java / org / apache / cassandra / db / Keyspace . java 
 index d6746da . . c0a8690 100644 
 - - - a / src / java / org / apache / cassandra / db / Keyspace . java 
 + + + b / src / java / org / apache / cassandra / db / Keyspace . java 
 @ @ - 83 , 13 + 83 , 21 @ @ public class Keyspace 
 } 
 } ; 
 
 + private static volatile boolean initialized = false ; 
 + public static void setInitialized ( ) 
 + { 
 + initialized = true ; 
 + } 
 + 
 public static Keyspace open ( String keyspaceName ) 
 { 
 + assert initialized | | keyspaceName . equals ( SYSTEM _ KS ) ; 
 return open ( keyspaceName , Schema . instance , true ) ; 
 } 
 
 public static Keyspace openWithoutSSTables ( String keyspaceName ) 
 { 
 + assert initialized | | keyspaceName . equals ( SYSTEM _ KS ) ; 
 return open ( keyspaceName , Schema . instance , false ) ; 
 } 
 
 diff - - git a / src / java / org / apache / cassandra / service / CassandraDaemon . java b / src / java / org / apache / cassandra / service / CassandraDaemon . java 
 index 7259a17 . . 7171b68 100644 
 - - - a / src / java / org / apache / cassandra / service / CassandraDaemon . java 
 + + + b / src / java / org / apache / cassandra / service / CassandraDaemon . java 
 @ @ - 31 , 14 + 31 , 12 @ @ import javax . management . MBeanServer ; 
 import javax . management . ObjectName ; 
 import javax . management . StandardMBean ; 
 
 - import com . addthis . metrics . reporter . config . ReporterConfig ; 
 import com . google . common . collect . Iterables ; 
 import com . google . common . util . concurrent . Uninterruptibles ; 
 - 
 - import org . apache . cassandra . io . sstable . CorruptSSTableException ; 
 import org . slf4j . Logger ; 
 import org . slf4j . LoggerFactory ; 
 
 + import com . addthis . metrics . reporter . config . ReporterConfig ; 
 import org . apache . cassandra . concurrent . JMXEnabledThreadPoolExecutor ; 
 import org . apache . cassandra . concurrent . Stage ; 
 import org . apache . cassandra . concurrent . StageManager ; 
 @ @ - 53 , 6 + 51 , 7 @ @ import org . apache . cassandra . db . commitlog . CommitLog ; 
 import org . apache . cassandra . db . compaction . CompactionManager ; 
 import org . apache . cassandra . exceptions . ConfigurationException ; 
 import org . apache . cassandra . io . FSError ; 
 + import org . apache . cassandra . io . sstable . CorruptSSTableException ; 
 import org . apache . cassandra . io . util . FileUtils ; 
 import org . apache . cassandra . metrics . StorageMetrics ; 
 import org . apache . cassandra . thrift . ThriftServer ; 
 @ @ - 258 , 6 + 257 , 7 @ @ public class CassandraDaemon 
 ColumnFamilyStore . scrubDataDirectories ( cfm ) ; 
 } 
 
 + Keyspace . setInitialized ( ) ; 
 / / initialize keyspaces 
 for ( String keyspaceName : Schema . instance . getKeyspaces ( ) ) 
 { 
 diff - - git a / test / unit / org / apache / cassandra / SchemaLoader . java b / test / unit / org / apache / cassandra / SchemaLoader . java 
 index 43a6dc3 . . 943cf96 100644 
 - - - a / test / unit / org / apache / cassandra / SchemaLoader . java 
 + + + b / test / unit / org / apache / cassandra / SchemaLoader . java 
 @ @ - 21 , 19 + 21 , 19 @ @ import java . io . File ; 
 import java . nio . ByteBuffer ; 
 import java . util . * ; 
 
 - import org . apache . cassandra . cache . CachingOptions ; 
 - import org . apache . cassandra . db . index . PerRowSecondaryIndexTest ; 
 - import org . apache . cassandra . db . index . SecondaryIndex ; 
 import org . junit . AfterClass ; 
 import org . junit . BeforeClass ; 
 import org . slf4j . Logger ; 
 import org . slf4j . LoggerFactory ; 
 
 + import org . apache . cassandra . cache . CachingOptions ; 
 import org . apache . cassandra . config . * ; 
 import org . apache . cassandra . cql3 . ColumnIdentifier ; 
 import org . apache . cassandra . db . * ; 
 import org . apache . cassandra . db . commitlog . CommitLog ; 
 import org . apache . cassandra . db . compaction . LeveledCompactionStrategy ; 
 + import org . apache . cassandra . db . index . PerRowSecondaryIndexTest ; 
 + import org . apache . cassandra . db . index . SecondaryIndex ; 
 import org . apache . cassandra . db . marshal . * ; 
 import org . apache . cassandra . exceptions . ConfigurationException ; 
 import org . apache . cassandra . gms . Gossiper ; 
 @ @ - 65 , 6 + 65 , 7 @ @ public class SchemaLoader 
 } 
 } ) ; 
 
 + Keyspace . setInitialized ( ) ; 
 / / Migrations aren ' t happy if gossiper is not started . Even if we don ' t use migrations though , 
 / / some tests now expect us to start gossip for them . 
 startGossiper ( ) ; 
 diff - - git a / test / unit / org / apache / cassandra / config / DatabaseDescriptorTest . java b / test / unit / org / apache / cassandra / config / DatabaseDescriptorTest . java 
 index b954f39 . . f6d4ad4 100644 
 - - - a / test / unit / org / apache / cassandra / config / DatabaseDescriptorTest . java 
 + + + b / test / unit / org / apache / cassandra / config / DatabaseDescriptorTest . java 
 @ @ - 18 , 18 + 18 , 21 @ @ 
 * / 
 package org . apache . cassandra . config ; 
 
 + import org . junit . Test ; 
 + import org . junit . runner . RunWith ; 
 + 
 import org . apache . cassandra . OrderedJUnit4ClassRunner ; 
 import org . apache . cassandra . SchemaLoader ; 
 + import org . apache . cassandra . db . Keyspace ; 
 import org . apache . cassandra . exceptions . ConfigurationException ; 
 import org . apache . cassandra . exceptions . InvalidRequestException ; 
 import org . apache . cassandra . gms . Gossiper ; 
 import org . apache . cassandra . locator . SimpleStrategy ; 
 import org . apache . cassandra . service . MigrationManager ; 
 
 - import org . junit . Test ; 
 - import org . junit . runner . RunWith ; 
 - 
 - import static org . junit . Assert . * ; 
 + import static org . junit . Assert . assertEquals ; 
 + import static org . junit . Assert . assertNotNull ; 
 + import static org . junit . Assert . assertNull ; 
 
 @ RunWith ( OrderedJUnit4ClassRunner . class ) 
 public class DatabaseDescriptorTest 
 @ @ - 70 , 6 + 73 , 7 @ @ public class DatabaseDescriptorTest 
 assertEquals ( 0 , Schema . instance . getNonSystemKeyspaces ( ) . size ( ) ) ; 
 
 Gossiper . instance . start ( ( int ) ( System . currentTimeMillis ( ) / 1000 ) ) ; 
 + Keyspace . setInitialized ( ) ; 
 
 try 
 { 
 @ @ - 103 , 6 + 107 , 7 @ @ public class DatabaseDescriptorTest 
 / / By default , we should load from the yaml 
 Config config = DatabaseDescriptor . loadConfig ( ) ; 
 assertEquals ( " Test Cluster " , config . cluster _ name ) ; 
 + Keyspace . setInitialized ( ) ; 
 
 / / Now try custom loader 
 ConfigurationLoader testLoader = new TestLoader ( ) ; 
 diff - - git a / test / unit / org / apache / cassandra / io / sstable / CQLSSTableWriterTest . java b / test / unit / org / apache / cassandra / io / sstable / CQLSSTableWriterTest . java 
 index 73ff21c . . c35a1df 100644 
 - - - a / test / unit / org / apache / cassandra / io / sstable / CQLSSTableWriterTest . java 
 + + + b / test / unit / org / apache / cassandra / io / sstable / CQLSSTableWriterTest . java 
 @ @ - 24 , 23 + 24 , 27 @ @ import com . google . common . collect . ImmutableMap ; 
 import com . google . common . io . Files ; 
 import org . junit . BeforeClass ; 
 import org . junit . Test ; 
 - import static org . junit . Assert . assertEquals ; 
 - import static org . junit . Assert . assertFalse ; 
 
 import org . apache . cassandra . config . CFMetaData ; 
 import org . apache . cassandra . config . Schema ; 
 - import org . apache . cassandra . cql3 . * ; 
 + import org . apache . cassandra . cql3 . QueryProcessor ; 
 + import org . apache . cassandra . cql3 . UntypedResultSet ; 
 + import org . apache . cassandra . db . Keyspace ; 
 import org . apache . cassandra . dht . Range ; 
 import org . apache . cassandra . dht . Token ; 
 import org . apache . cassandra . service . StorageService ; 
 import org . apache . cassandra . utils . FBUtilities ; 
 import org . apache . cassandra . utils . OutputHandler ; 
 
 + import static org . junit . Assert . assertEquals ; 
 + import static org . junit . Assert . assertFalse ; 
 + 
 public class CQLSSTableWriterTest 
 { 
 @ BeforeClass 
 public static void setup ( ) throws Exception 
 { 
 + Keyspace . setInitialized ( ) ; 
 StorageService . instance . initServer ( ) ; 
 } 
 
 diff - - git a / test / unit / org / apache / cassandra / io / sstable / LegacySSTableTest . java b / test / unit / org / apache / cassandra / io / sstable / LegacySSTableTest . java 
 index c0c9d41 . . e26d0f5 100644 
 - - - a / test / unit / org / apache / cassandra / io / sstable / LegacySSTableTest . java 
 + + + b / test / unit / org / apache / cassandra / io / sstable / LegacySSTableTest . java 
 @ @ - 21 , 11 + 21 , 21 @ @ package org . apache . cassandra . io . sstable ; 
 
 import java . io . File ; 
 import java . nio . ByteBuffer ; 
 - import java . util . * ; 
 + import java . util . ArrayList ; 
 + import java . util . HashSet ; 
 + import java . util . List ; 
 + import java . util . Set ; 
 + 
 + import org . junit . BeforeClass ; 
 + import org . junit . Test ; 
 
 import org . apache . cassandra . SchemaLoader ; 
 import org . apache . cassandra . Util ; 
 - import org . apache . cassandra . db . * ; 
 + import org . apache . cassandra . db . ColumnFamily ; 
 + import org . apache . cassandra . db . ColumnFamilyStore ; 
 + import org . apache . cassandra . db . DecoratedKey ; 
 + import org . apache . cassandra . db . DeletionInfo ; 
 + import org . apache . cassandra . db . Keyspace ; 
 import org . apache . cassandra . db . columniterator . SSTableNamesIterator ; 
 import org . apache . cassandra . db . composites . CellNameType ; 
 import org . apache . cassandra . dht . IPartitioner ; 
 @ @ - 34 , 10 + 44 , 8 @ @ import org . apache . cassandra . dht . Token ; 
 import org . apache . cassandra . service . StorageService ; 
 import org . apache . cassandra . streaming . StreamPlan ; 
 import org . apache . cassandra . streaming . StreamSession ; 
 - import org . apache . cassandra . utils . FBUtilities ; 
 import org . apache . cassandra . utils . ByteBufferUtil ; 
 - import org . junit . BeforeClass ; 
 - import org . junit . Test ; 
 + import org . apache . cassandra . utils . FBUtilities ; 
 
 / * * 
 * Tests backwards compatibility for SSTables 
 @ @ - 54 , 6 + 62 , 7 @ @ public class LegacySSTableTest extends SchemaLoader 
 @ BeforeClass 
 public static void beforeClass ( ) 
 { 
 + Keyspace . setInitialized ( ) ; 
 String scp = System . getProperty ( LEGACY _ SSTABLE _ PROP ) ; 
 assert scp ! = null ; 
 LEGACY _ SSTABLE _ ROOT = new File ( scp ) . getAbsoluteFile ( ) ; 
 diff - - git a / test / unit / org / apache / cassandra / io / sstable / SSTableLoaderTest . java b / test / unit / org / apache / cassandra / io / sstable / SSTableLoaderTest . java 
 index 809934f . . 18beaa9 100644 
 - - - a / test / unit / org / apache / cassandra / io / sstable / SSTableLoaderTest . java 
 + + + b / test / unit / org / apache / cassandra / io / sstable / SSTableLoaderTest . java 
 @ @ - 45 , 6 + 45 , 7 @ @ public class SSTableLoaderTest extends SchemaLoader 
 @ BeforeClass 
 public static void setup ( ) throws Exception 
 { 
 + Keyspace . setInitialized ( ) ; 
 StorageService . instance . initServer ( ) ; 
 } 
 
 diff - - git a / test / unit / org / apache / cassandra / locator / EC2SnitchTest . java b / test / unit / org / apache / cassandra / locator / EC2SnitchTest . java 
 index fe48ce5 . . 6015adf 100644 
 - - - a / test / unit / org / apache / cassandra / locator / EC2SnitchTest . java 
 + + + b / test / unit / org / apache / cassandra / locator / EC2SnitchTest . java 
 @ @ - 21 , 16 + 21 , 18 @ @ package org . apache . cassandra . locator ; 
 * / 
 
 
 - import static org . junit . Assert . assertEquals ; 
 - 
 import java . io . IOException ; 
 import java . net . InetAddress ; 
 import java . net . UnknownHostException ; 
 import java . util . Map ; 
 
 + import org . junit . AfterClass ; 
 import org . junit . Assert ; 
 + import org . junit . BeforeClass ; 
 + import org . junit . Test ; 
 
 import org . apache . cassandra . SchemaLoader ; 
 + import org . apache . cassandra . db . Keyspace ; 
 import org . apache . cassandra . exceptions . ConfigurationException ; 
 import org . apache . cassandra . gms . ApplicationState ; 
 import org . apache . cassandra . gms . Gossiper ; 
 @ @ - 38 , 9 + 40 , 8 @ @ import org . apache . cassandra . gms . VersionedValue ; 
 import org . apache . cassandra . net . MessagingService ; 
 import org . apache . cassandra . net . OutboundTcpConnectionPool ; 
 import org . apache . cassandra . service . StorageService ; 
 - import org . junit . AfterClass ; 
 - import org . junit . BeforeClass ; 
 - import org . junit . Test ; 
 + 
 + import static org . junit . Assert . assertEquals ; 
 
 public class EC2SnitchTest 
 { 
 @ @ - 51 , 6 + 52 , 7 @ @ public class EC2SnitchTest 
 { 
 SchemaLoader . mkdirs ( ) ; 
 SchemaLoader . cleanup ( ) ; 
 + Keyspace . setInitialized ( ) ; 
 StorageService . instance . initServer ( 0 ) ; 
 } 
 
 diff - - git a / test / unit / org / apache / cassandra / service / StorageServiceServerTest . java b / test / unit / org / apache / cassandra / service / StorageServiceServerTest . java 
 index f58ded6 . . 81c5261 100644 
 - - - a / test / unit / org / apache / cassandra / service / StorageServiceServerTest . java 
 + + + b / test / unit / org / apache / cassandra / service / StorageServiceServerTest . java 
 @ @ - 56 , 6 + 56 , 7 @ @ public class StorageServiceServerTest 
 { 
 IEndpointSnitch snitch = new PropertyFileSnitch ( ) ; 
 DatabaseDescriptor . setEndpointSnitch ( snitch ) ; 
 + Keyspace . setInitialized ( ) ; 
 } 
 
 @ Test

NEAREST DIFF:
diff - - git a / test / unit / org / apache / cassandra / config / DatabaseDescriptorTest . java b / test / unit / org / apache / cassandra / config / DatabaseDescriptorTest . java 
 index 4273662 . . 87f1a66 100644 
 - - - a / test / unit / org / apache / cassandra / config / DatabaseDescriptorTest . java 
 + + + b / test / unit / org / apache / cassandra / config / DatabaseDescriptorTest . java 
 @ @ - 18 , 6 + 18 , 7 @ @ 
 * / 
 package org . apache . cassandra . config ; 
 
 + import org . apache . cassandra . OrderedJUnit4ClassRunner ; 
 import org . apache . cassandra . SchemaLoader ; 
 import org . apache . cassandra . exceptions . ConfigurationException ; 
 import org . apache . cassandra . exceptions . InvalidRequestException ; 
 @ @ - 26 , 9 + 27 , 11 @ @ import org . apache . cassandra . locator . SimpleStrategy ; 
 import org . apache . cassandra . service . MigrationManager ; 
 
 import org . junit . Test ; 
 + import org . junit . runner . RunWith ; 
 
 import java . io . IOException ; 
 
 + @ RunWith ( OrderedJUnit4ClassRunner . class ) 
 public class DatabaseDescriptorTest 
 { 
 @ Test 
 diff - - git a / test / unit / org / apache / cassandra / config / DefsTest . java b / test / unit / org / apache / cassandra / config / DefsTest . java 
 index 5bb16a0 . . 87c53d4 100644 
 - - - a / test / unit / org / apache / cassandra / config / DefsTest . java 
 + + + b / test / unit / org / apache / cassandra / config / DefsTest . java 
 @ @ - 24 , 6 + 24 , 7 @ @ import java . nio . ByteBuffer ; 
 import java . util . * ; 
 import java . util . concurrent . ExecutionException ; 
 
 + import org . apache . cassandra . OrderedJUnit4ClassRunner ; 
 import org . apache . cassandra . SchemaLoader ; 
 import org . apache . cassandra . Util ; 
 import org . apache . cassandra . db . * ; 
 @ @ - 43 , 7 + 44 , 9 @ @ import org . apache . cassandra . thrift . IndexType ; 
 import org . apache . cassandra . utils . ByteBufferUtil ; 
 
 import org . junit . Test ; 
 + import org . junit . runner . RunWith ; 
 
 + @ RunWith ( OrderedJUnit4ClassRunner . class ) 
 public class DefsTest extends SchemaLoader 
 { 
 
 diff - - git a / test / unit / org / apache / cassandra / db / ColumnFamilyStoreTest . java b / test / unit / org / apache / cassandra / db / ColumnFamilyStoreTest . java 
 index 8318f0d . . eab9772 100644 
 - - - a / test / unit / org / apache / cassandra / db / ColumnFamilyStoreTest . java 
 + + + b / test / unit / org / apache / cassandra / db / ColumnFamilyStoreTest . java 
 @ @ - 32 , 6 + 32 , 7 @ @ import com . google . common . collect . Sets ; 
 import org . apache . commons . lang . ArrayUtils ; 
 import org . apache . commons . lang . StringUtils ; 
 import org . junit . Test ; 
 + import org . junit . runner . RunWith ; 
 
 import static org . junit . Assert . assertNull ; 
 import static junit . framework . Assert . assertEquals ; 
 @ @ - 45 , 6 + 46 , 7 @ @ import static org . apache . cassandra . db . TableTest . assertColumns ; 
 import static org . apache . cassandra . utils . ByteBufferUtil . bytes ; 
 import static org . apache . commons . lang . ArrayUtils . EMPTY _ BYTE _ ARRAY ; 
 
 + import org . apache . cassandra . OrderedJUnit4ClassRunner ; 
 import org . apache . cassandra . SchemaLoader ; 
 import org . apache . cassandra . Util ; 
 import org . apache . cassandra . config . CFMetaData ; 
 @ @ - 68 , 6 + 70 , 7 @ @ import org . apache . cassandra . thrift . * ; 
 import org . apache . cassandra . utils . ByteBufferUtil ; 
 import org . apache . cassandra . utils . WrappedRunnable ; 
 
 + @ RunWith ( OrderedJUnit4ClassRunner . class ) 
 public class ColumnFamilyStoreTest extends SchemaLoader 
 { 
 static byte [ ] bytes1 , bytes2 ; 
 diff - - git a / test / unit / org / apache / cassandra / db / compaction / CompactionsTest . java b / test / unit / org / apache / cassandra / db / compaction / CompactionsTest . java 
 index a09451e . . 3a469bf 100644 
 - - - a / test / unit / org / apache / cassandra / db / compaction / CompactionsTest . java 
 + + + b / test / unit / org / apache / cassandra / db / compaction / CompactionsTest . java 
 @ @ - 25 , 7 + 25 , 9 @ @ import java . util . concurrent . ExecutionException ; 
 import java . util . concurrent . TimeUnit ; 
 
 import org . junit . Test ; 
 + import org . junit . runner . RunWith ; 
 
 + import org . apache . cassandra . OrderedJUnit4ClassRunner ; 
 import org . apache . cassandra . SchemaLoader ; 
 import org . apache . cassandra . Util ; 
 import org . apache . cassandra . config . DatabaseDescriptor ; 
 @ @ - 43 , 6 + 45 , 7 @ @ import org . apache . cassandra . utils . FBUtilities ; 
 
 import static junit . framework . Assert . * ; 
 
 + @ RunWith ( OrderedJUnit4ClassRunner . class ) 
 public class CompactionsTest extends SchemaLoader 
 { 
 public static final String TABLE1 = " Keyspace1 " ; 
 diff - - git a / test / unit / org / apache / cassandra / db / compaction / LeveledCompactionStrategyTest . java b / test / unit / org / apache / cassandra / db / compaction / LeveledCompactionStrategyTest . java 
 index 6a329c3 . . e073c41 100644 
 - - - a / test / unit / org / apache / cassandra / db / compaction / LeveledCompactionStrategyTest . java 
 + + + b / test / unit / org / apache / cassandra / db / compaction / LeveledCompactionStrategyTest . java 
 @ @ - 21 , 7 + 21 , 9 @ @ import java . nio . ByteBuffer ; 
 import java . util . Collection ; 
 
 import org . junit . Test ; 
 + import org . junit . runner . RunWith ; 
 
 + import org . apache . cassandra . OrderedJUnit4ClassRunner ; 
 import org . apache . cassandra . SchemaLoader ; 
 import org . apache . cassandra . Util ; 
 import org . apache . cassandra . db . ColumnFamilyStore ; 
 @ @ - 37 , 6 + 39 , 7 @ @ import org . apache . cassandra . service . AntiEntropyService ; 
 import org . apache . cassandra . utils . ByteBufferUtil ; 
 import org . apache . cassandra . utils . FBUtilities ; 
 
 + @ RunWith ( OrderedJUnit4ClassRunner . class ) 
 public class LeveledCompactionStrategyTest extends SchemaLoader 
 { 
 / * 
 diff - - git a / test / unit / org / apache / cassandra / dht / BootStrapperTest . java b / test / unit / org / apache / cassandra / dht / BootStrapperTest . java 
 index d2b1aec . . 2381545 100644 
 - - - a / test / unit / org / apache / cassandra / dht / BootStrapperTest . java 
 + + + b / test / unit / org / apache / cassandra / dht / BootStrapperTest . java 
 @ @ - 31 , 7 + 31 , 9 @ @ import java . util . UUID ; 
 import java . util . concurrent . CountDownLatch ; 
 
 import org . junit . Test ; 
 + import org . junit . runner . RunWith ; 
 
 + import org . apache . cassandra . OrderedJUnit4ClassRunner ; 
 import org . apache . cassandra . SchemaLoader ; 
 import org . apache . cassandra . config . Schema ; 
 import org . apache . cassandra . db . Table ; 
 @ @ - 46 , 6 + 48 , 7 @ @ import org . apache . cassandra . utils . FBUtilities ; 
 
 import static org . junit . Assert . * ; 
 
 + @ RunWith ( OrderedJUnit4ClassRunner . class ) 
 public class BootStrapperTest extends SchemaLoader 
 { 
 @ Test 
 diff - - git a / test / unit / org / apache / cassandra / io / sstable / SSTableReaderTest . java b / test / unit / org / apache / cassandra / io / sstable / SSTableReaderTest . java 
 index 0fe9757 . . 64e70f7 100644 
 - - - a / test / unit / org / apache / cassandra / io / sstable / SSTableReaderTest . java 
 + + + b / test / unit / org / apache / cassandra / io / sstable / SSTableReaderTest . java 
 @ @ - 31 , 7 + 31 , 9 @ @ import java . util . concurrent . ExecutionException ; 
 import java . util . * ; 
 
 import org . junit . Test ; 
 + import org . junit . runner . RunWith ; 
 
 + import org . apache . cassandra . OrderedJUnit4ClassRunner ; 
 import org . apache . cassandra . SchemaLoader ; 
 import org . apache . cassandra . Util ; 
 import org . apache . cassandra . config . DatabaseDescriptor ; 
 @ @ - 56 , 6 + 58 , 7 @ @ import org . apache . cassandra . utils . ByteBufferUtil ; 
 import org . apache . cassandra . utils . CLibrary ; 
 import org . apache . cassandra . utils . Pair ; 
 
 + @ RunWith ( OrderedJUnit4ClassRunner . class ) 
 public class SSTableReaderTest extends SchemaLoader 
 { 
 static Token t ( int i ) 
 diff - - git a / test / unit / org / apache / cassandra / service / StorageServiceServerTest . java b / test / unit / org / apache / cassandra / service / StorageServiceServerTest . java 
 index c4931a6 . . 39fbb4a 100644 
 - - - a / test / unit / org / apache / cassandra / service / StorageServiceServerTest . java 
 + + + b / test / unit / org / apache / cassandra / service / StorageServiceServerTest . java 
 @ @ - 25 , 7 + 25 , 9 @ @ import java . util . Collections ; 
 import java . util . List ; 
 
 import org . junit . Test ; 
 + import org . junit . runner . RunWith ; 
 
 + import org . apache . cassandra . OrderedJUnit4ClassRunner ; 
 import org . apache . cassandra . exceptions . ConfigurationException ; 
 import org . apache . cassandra . db . Table ; 
 import org . apache . cassandra . dht . Token ; 
 @ @ - 35 , 6 + 37 , 7 @ @ import org . apache . cassandra . config . DatabaseDescriptor ; 
 import static org . junit . Assert . assertEquals ; 
 import static org . junit . Assert . assertTrue ; 
 
 + @ RunWith ( OrderedJUnit4ClassRunner . class ) 
 public class StorageServiceServerTest 
 { 
 @ Test 
 diff - - git a / test / unit / org / apache / cassandra / streaming / StreamingTransferTest . java b / test / unit / org / apache / cassandra / streaming / StreamingTransferTest . java 
 index 2d96030 . . 502e5d7 100644 
 - - - a / test / unit / org / apache / cassandra / streaming / StreamingTransferTest . java 
 + + + b / test / unit / org / apache / cassandra / streaming / StreamingTransferTest . java 
 @ @ - 20 , 6 + 20 , 7 @ @ package org . apache . cassandra . streaming ; 
 * / 
 
 import static junit . framework . Assert . assertEquals ; 
 + import org . apache . cassandra . OrderedJUnit4ClassRunner ; 
 import org . apache . cassandra . Util ; 
 import static org . apache . cassandra . Util . column ; 
 import static org . apache . cassandra . Util . addMutation ; 
 @ @ - 47 , 11 + 48 , 13 @ @ import org . apache . cassandra . utils . FBUtilities ; 
 
 import org . junit . BeforeClass ; 
 import org . junit . Test ; 
 + import org . junit . runner . RunWith ; 
 import org . slf4j . Logger ; 
 import org . slf4j . LoggerFactory ; 
 
 import org . apache . cassandra . utils . ByteBufferUtil ; 
 
 + @ RunWith ( OrderedJUnit4ClassRunner . class ) 
 public class StreamingTransferTest extends SchemaLoader 
 { 
 private static final Logger logger = LoggerFactory . getLogger ( StreamingTransferTest . class ) ;
