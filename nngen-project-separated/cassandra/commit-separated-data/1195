BLEU SCORE: 0.007869270985473822

TEST MSG: Remove superfluous COUNTER _ MUTATION stage mapping
GENERATED MSG: Fix repair - snapshot not working patch by yukim ; reviewed by jbellis for CASSANDRA - 5512

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index 8ff726e . . 123c1f3 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 1 , 4 + 1 , 5 @ @ <nl> 2 . 1 . 12 <nl> + * Remove superfluous COUNTER _ MUTATION stage mapping ( CASSANDRA - 10605 ) <nl> * Improve json2sstable error reporting on nonexistent columns ( CASSANDRA - 10401 ) <nl> * ( cqlsh ) fix COPY using wrong variable name for time _ format ( CASSANDRA - 10633 ) <nl> * Do not run SizeEstimatesRecorder if a node is not a member of the ring ( CASSANDRA - 9912 ) <nl> diff - - git a / src / java / org / apache / cassandra / net / MessagingService . java b / src / java / org / apache / cassandra / net / MessagingService . java <nl> index 724518c . . 82320b1 100644 <nl> - - - a / src / java / org / apache / cassandra / net / MessagingService . java <nl> + + + b / src / java / org / apache / cassandra / net / MessagingService . java <nl> @ @ - 177 , 7 + 177 , 6 @ @ public final class MessagingService implements MessagingServiceMBean <nl> put ( Verb . MIGRATION _ REQUEST , Stage . MIGRATION ) ; <nl> put ( Verb . INDEX _ SCAN , Stage . READ ) ; <nl> put ( Verb . REPLICATION _ FINISHED , Stage . MISC ) ; <nl> - put ( Verb . COUNTER _ MUTATION , Stage . MUTATION ) ; <nl> put ( Verb . SNAPSHOT , Stage . MISC ) ; <nl> put ( Verb . ECHO , Stage . GOSSIP ) ; <nl>
NEAREST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / hadoop / ColumnFamilyRecordReader . java b / src / java / org / apache / cassandra / hadoop / ColumnFamilyRecordReader . java <nl> index dfeacc3 . . a987519 100644 <nl> - - - a / src / java / org / apache / cassandra / hadoop / ColumnFamilyRecordReader . java <nl> + + + b / src / java / org / apache / cassandra / hadoop / ColumnFamilyRecordReader . java <nl> @ @ - 461 , 7 + 461 , 7 @ @ public class ColumnFamilyRecordReader extends RecordReader < ByteBuffer , SortedMap <nl> return endOfData ( ) ; <nl> <nl> Pair < ByteBuffer , SortedMap < ByteBuffer , IColumn > > next = wideColumns . next ( ) ; <nl> - lastColumn = next . right . values ( ) . iterator ( ) . next ( ) . name ( ) ; <nl> + lastColumn = next . right . values ( ) . iterator ( ) . next ( ) . name ( ) . duplicate ( ) ; <nl> <nl> maybeIncreaseRowCounter ( next ) ; <nl> return next ; <nl> @ @ - 534 , 7 + 534 , 7 @ @ public class ColumnFamilyRecordReader extends RecordReader < ByteBuffer , SortedMap <nl> if ( this . nextKeyValue ( ) ) <nl> { <nl> key . clear ( ) ; <nl> - key . put ( this . getCurrentKey ( ) ) ; <nl> + key . put ( this . getCurrentKey ( ) . duplicate ( ) ) ; <nl> key . flip ( ) ; <nl> <nl> value . clear ( ) ;

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index 8ff726e . . 123c1f3 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 1 , 4 + 1 , 5 @ @ 
 2 . 1 . 12 
 + * Remove superfluous COUNTER _ MUTATION stage mapping ( CASSANDRA - 10605 ) 
 * Improve json2sstable error reporting on nonexistent columns ( CASSANDRA - 10401 ) 
 * ( cqlsh ) fix COPY using wrong variable name for time _ format ( CASSANDRA - 10633 ) 
 * Do not run SizeEstimatesRecorder if a node is not a member of the ring ( CASSANDRA - 9912 ) 
 diff - - git a / src / java / org / apache / cassandra / net / MessagingService . java b / src / java / org / apache / cassandra / net / MessagingService . java 
 index 724518c . . 82320b1 100644 
 - - - a / src / java / org / apache / cassandra / net / MessagingService . java 
 + + + b / src / java / org / apache / cassandra / net / MessagingService . java 
 @ @ - 177 , 7 + 177 , 6 @ @ public final class MessagingService implements MessagingServiceMBean 
 put ( Verb . MIGRATION _ REQUEST , Stage . MIGRATION ) ; 
 put ( Verb . INDEX _ SCAN , Stage . READ ) ; 
 put ( Verb . REPLICATION _ FINISHED , Stage . MISC ) ; 
 - put ( Verb . COUNTER _ MUTATION , Stage . MUTATION ) ; 
 put ( Verb . SNAPSHOT , Stage . MISC ) ; 
 put ( Verb . ECHO , Stage . GOSSIP ) ; 


NEAREST DIFF:
diff - - git a / src / java / org / apache / cassandra / hadoop / ColumnFamilyRecordReader . java b / src / java / org / apache / cassandra / hadoop / ColumnFamilyRecordReader . java 
 index dfeacc3 . . a987519 100644 
 - - - a / src / java / org / apache / cassandra / hadoop / ColumnFamilyRecordReader . java 
 + + + b / src / java / org / apache / cassandra / hadoop / ColumnFamilyRecordReader . java 
 @ @ - 461 , 7 + 461 , 7 @ @ public class ColumnFamilyRecordReader extends RecordReader < ByteBuffer , SortedMap 
 return endOfData ( ) ; 
 
 Pair < ByteBuffer , SortedMap < ByteBuffer , IColumn > > next = wideColumns . next ( ) ; 
 - lastColumn = next . right . values ( ) . iterator ( ) . next ( ) . name ( ) ; 
 + lastColumn = next . right . values ( ) . iterator ( ) . next ( ) . name ( ) . duplicate ( ) ; 
 
 maybeIncreaseRowCounter ( next ) ; 
 return next ; 
 @ @ - 534 , 7 + 534 , 7 @ @ public class ColumnFamilyRecordReader extends RecordReader < ByteBuffer , SortedMap 
 if ( this . nextKeyValue ( ) ) 
 { 
 key . clear ( ) ; 
 - key . put ( this . getCurrentKey ( ) ) ; 
 + key . put ( this . getCurrentKey ( ) . duplicate ( ) ) ; 
 key . flip ( ) ; 
 
 value . clear ( ) ;
