BLEU SCORE: 0.0024118012379963885

TEST MSG: Support older ant versions
GENERATED MSG: compile stress classes with debug symbols ( so you can see the line numbers on stack traces )

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index 644530b . . 865824c 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 1 , 4 + 1 , 5 @ @ <nl> 3 . 8 <nl> + * Support older ant versions ( CASSANDRA - 11807 ) <nl> * Estimate compressed on disk size when deciding if sstable size limit reached ( CASSANDRA - 11623 ) <nl> * cassandra - stress profiles should support case sensitive schemas ( CASSANDRA - 11546 ) <nl> * Remove DatabaseDescriptor dependency from FileUtils ( CASSANDRA - 11578 ) <nl> diff - - git a / build . xml b / build . xml <nl> index 3c9fb59 . . 1e58228 100644 <nl> - - - a / build . xml <nl> + + + b / build . xml <nl> @ @ - 802 , 7 + 802 , 7 @ @ <nl> < / path > <nl> < target name = " stress - build " depends = " build " description = " build stress tool " > <nl> 	 < mkdir dir = " $ { stress . build . classes } " / > <nl> - < javac debug = " true " debuglevel = " $ { debuglevel } " encoding = " utf - 8 " destdir = " $ { stress . build . classes } " includeantruntime = " true " source = " $ { source . version } " target = " $ { target . version } " > <nl> + < javac compiler = " modern " debug = " true " debuglevel = " $ { debuglevel } " encoding = " utf - 8 " destdir = " $ { stress . build . classes } " includeantruntime = " true " source = " $ { source . version } " target = " $ { target . version } " > <nl> < src path = " $ { stress . build . src } " / > <nl> < classpath > <nl> < path refid = " cassandra . classes " / > <nl> @ @ - 1135 , 6 + 1135 , 7 @ @ <nl> <nl> < target name = " build - test " depends = " build " description = " Compile test classes " > <nl> < javac <nl> + compiler = " modern " <nl> debug = " true " <nl> debuglevel = " $ { debuglevel } " <nl> destdir = " $ { test . classes } "
NEAREST DIFF (one line): diff - - git a / conf / triggers / README . txt b / conf / triggers / README . txt <nl> new file mode 100644 <nl> index 0000000 . . e69de29 <nl> diff - - git a / debian / cassandra . install b / debian / cassandra . install <nl> index d7a2242 . . 5dba772 100644 <nl> - - - a / debian / cassandra . install <nl> + + + b / debian / cassandra . install <nl> @ @ - 6 , 6 + 6 , 7 @ @ conf / cassandra - rackdc . properties etc / cassandra <nl> conf / commitlog _ archiving . properties etc / cassandra <nl> conf / cassandra - topology . properties etc / cassandra <nl> conf / log4j - tools . properties etc / cassandra <nl> + conf / triggers / * etc / cassandra / triggers <nl> debian / cassandra . in . sh usr / share / cassandra <nl> debian / cassandra . conf etc / security / limits . d <nl> debian / cassandra - sysctl . conf etc / sysctl . d <nl> diff - - git a / examples / triggers / README . txt b / examples / triggers / README . txt <nl> index 7346144 . . a99fa98 100644 <nl> - - - a / examples / triggers / README . txt <nl> + + + b / examples / triggers / README . txt <nl> @ @ - 11 , 7 + 11 , 7 @ @ Installation : <nl> = = = = = = = = = = = = <nl> change directory to < cassandra _ src _ dir > / examples / triggers <nl> run " ant jar " <nl> - Copy build / trigger - example . jar to < cassandra _ home > / triggers / <nl> + Copy build / trigger - example . jar to < cassandra _ conf > / triggers / <nl> Copy conf / * to < cassandra _ home > / conf / <nl> Create column family configured in InvertedIndex . properties <nl> Example : Keyspace1 . InvertedIndex as configured in InvertedIndex . properties <nl> diff - - git a / src / java / org / apache / cassandra / triggers / TriggerExecutor . java b / src / java / org / apache / cassandra / triggers / TriggerExecutor . java <nl> index c3a2c44 . . c6feb84 100644 <nl> - - - a / src / java / org / apache / cassandra / triggers / TriggerExecutor . java <nl> + + + b / src / java / org / apache / cassandra / triggers / TriggerExecutor . java <nl> @ @ - 42 , 7 + 42 , 7 @ @ public class TriggerExecutor <nl> <nl> private final Map < String , ITrigger > cachedTriggers = Maps . newConcurrentMap ( ) ; <nl> private final ClassLoader parent = Thread . currentThread ( ) . getContextClassLoader ( ) ; <nl> - private final File triggerDirectory = new File ( FBUtilities . cassandraHomeDir ( ) , " triggers " ) ; <nl> + private final File triggerDirectory = FBUtilities . cassandraTriggerDir ( ) ; <nl> private volatile ClassLoader customClassLoader ; <nl> <nl> private TriggerExecutor ( ) <nl> diff - - git a / src / java / org / apache / cassandra / utils / FBUtilities . java b / src / java / org / apache / cassandra / utils / FBUtilities . java <nl> index 379c0eb . . 7873ce7 100644 <nl> - - - a / src / java / org / apache / cassandra / utils / FBUtilities . java <nl> + + + b / src / java / org / apache / cassandra / utils / FBUtilities . java <nl> @ @ - 69 , 6 + 69 , 7 @ @ public class FBUtilities <nl> private static ObjectMapper jsonMapper = new ObjectMapper ( new JsonFactory ( ) ) ; <nl> <nl> public static final BigInteger TWO = new BigInteger ( " 2 " ) ; <nl> + private static final String DEFAULT _ TRIGGER _ DIR = " triggers " ; <nl> <nl> private static volatile InetAddress localInetAddress ; <nl> private static volatile InetAddress broadcastInetAddress ; <nl> @ @ - 341 , 10 + 342 , 16 @ @ public class FBUtilities <nl> return scpurl . getFile ( ) ; <nl> } <nl> <nl> - public static File cassandraHomeDir ( ) <nl> + public static File cassandraTriggerDir ( ) <nl> { <nl> - String libDir = new File ( FBUtilities . class . getProtectionDomain ( ) . getCodeSource ( ) . getLocation ( ) . getPath ( ) ) . getParent ( ) ; <nl> - return new File ( new File ( libDir ) . getParent ( ) ) ; <nl> + File triggerDir ; <nl> + if ( System . getProperty ( " cassandra . triggers _ dir " ) ! = null ) <nl> + triggerDir = new File ( System . getProperty ( " cassandra . triggers _ dir " ) ) ; <nl> + else <nl> + triggerDir = new File ( FBUtilities . class . getClassLoader ( ) . getResource ( DEFAULT _ TRIGGER _ DIR ) . getFile ( ) ) ; <nl> + if ( ! triggerDir . exists ( ) ) <nl> + throw new RuntimeException ( " Trigger Directory doesnt exist , please create inside conf . " ) ; <nl> + return triggerDir ; <nl> } <nl> <nl> public static String getReleaseVersionString ( ) <nl> diff - - git a / test / conf / triggers / README . txt b / test / conf / triggers / README . txt <nl> new file mode 100644 <nl> index 0000000 . . e69de29 <nl> diff - - git a / test / data / serialization / 2 . 0 / db . RowMutation . bin b / test / data / serialization / 2 . 0 / db . RowMutation . bin <nl> index 698b0b6 . . aa75378 100644 <nl> Binary files a / test / data / serialization / 2 . 0 / db . RowMutation . bin and b / test / data / serialization / 2 . 0 / db . RowMutation . bin differ <nl> diff - - git a / test / triggers / README . txt b / test / triggers / README . txt <nl> deleted file mode 100644 <nl> index e69de29 . . 0000000 <nl> diff - - git a / triggers / README . txt b / triggers / README . txt <nl> deleted file mode 100644 <nl> index e69de29 . . 0000000

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index 644530b . . 865824c 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 1 , 4 + 1 , 5 @ @ 
 3 . 8 
 + * Support older ant versions ( CASSANDRA - 11807 ) 
 * Estimate compressed on disk size when deciding if sstable size limit reached ( CASSANDRA - 11623 ) 
 * cassandra - stress profiles should support case sensitive schemas ( CASSANDRA - 11546 ) 
 * Remove DatabaseDescriptor dependency from FileUtils ( CASSANDRA - 11578 ) 
 diff - - git a / build . xml b / build . xml 
 index 3c9fb59 . . 1e58228 100644 
 - - - a / build . xml 
 + + + b / build . xml 
 @ @ - 802 , 7 + 802 , 7 @ @ 
 < / path > 
 < target name = " stress - build " depends = " build " description = " build stress tool " > 
 	 < mkdir dir = " $ { stress . build . classes } " / > 
 - < javac debug = " true " debuglevel = " $ { debuglevel } " encoding = " utf - 8 " destdir = " $ { stress . build . classes } " includeantruntime = " true " source = " $ { source . version } " target = " $ { target . version } " > 
 + < javac compiler = " modern " debug = " true " debuglevel = " $ { debuglevel } " encoding = " utf - 8 " destdir = " $ { stress . build . classes } " includeantruntime = " true " source = " $ { source . version } " target = " $ { target . version } " > 
 < src path = " $ { stress . build . src } " / > 
 < classpath > 
 < path refid = " cassandra . classes " / > 
 @ @ - 1135 , 6 + 1135 , 7 @ @ 
 
 < target name = " build - test " depends = " build " description = " Compile test classes " > 
 < javac 
 + compiler = " modern " 
 debug = " true " 
 debuglevel = " $ { debuglevel } " 
 destdir = " $ { test . classes } "

NEAREST DIFF:
diff - - git a / conf / triggers / README . txt b / conf / triggers / README . txt 
 new file mode 100644 
 index 0000000 . . e69de29 
 diff - - git a / debian / cassandra . install b / debian / cassandra . install 
 index d7a2242 . . 5dba772 100644 
 - - - a / debian / cassandra . install 
 + + + b / debian / cassandra . install 
 @ @ - 6 , 6 + 6 , 7 @ @ conf / cassandra - rackdc . properties etc / cassandra 
 conf / commitlog _ archiving . properties etc / cassandra 
 conf / cassandra - topology . properties etc / cassandra 
 conf / log4j - tools . properties etc / cassandra 
 + conf / triggers / * etc / cassandra / triggers 
 debian / cassandra . in . sh usr / share / cassandra 
 debian / cassandra . conf etc / security / limits . d 
 debian / cassandra - sysctl . conf etc / sysctl . d 
 diff - - git a / examples / triggers / README . txt b / examples / triggers / README . txt 
 index 7346144 . . a99fa98 100644 
 - - - a / examples / triggers / README . txt 
 + + + b / examples / triggers / README . txt 
 @ @ - 11 , 7 + 11 , 7 @ @ Installation : 
 = = = = = = = = = = = = 
 change directory to < cassandra _ src _ dir > / examples / triggers 
 run " ant jar " 
 - Copy build / trigger - example . jar to < cassandra _ home > / triggers / 
 + Copy build / trigger - example . jar to < cassandra _ conf > / triggers / 
 Copy conf / * to < cassandra _ home > / conf / 
 Create column family configured in InvertedIndex . properties 
 Example : Keyspace1 . InvertedIndex as configured in InvertedIndex . properties 
 diff - - git a / src / java / org / apache / cassandra / triggers / TriggerExecutor . java b / src / java / org / apache / cassandra / triggers / TriggerExecutor . java 
 index c3a2c44 . . c6feb84 100644 
 - - - a / src / java / org / apache / cassandra / triggers / TriggerExecutor . java 
 + + + b / src / java / org / apache / cassandra / triggers / TriggerExecutor . java 
 @ @ - 42 , 7 + 42 , 7 @ @ public class TriggerExecutor 
 
 private final Map < String , ITrigger > cachedTriggers = Maps . newConcurrentMap ( ) ; 
 private final ClassLoader parent = Thread . currentThread ( ) . getContextClassLoader ( ) ; 
 - private final File triggerDirectory = new File ( FBUtilities . cassandraHomeDir ( ) , " triggers " ) ; 
 + private final File triggerDirectory = FBUtilities . cassandraTriggerDir ( ) ; 
 private volatile ClassLoader customClassLoader ; 
 
 private TriggerExecutor ( ) 
 diff - - git a / src / java / org / apache / cassandra / utils / FBUtilities . java b / src / java / org / apache / cassandra / utils / FBUtilities . java 
 index 379c0eb . . 7873ce7 100644 
 - - - a / src / java / org / apache / cassandra / utils / FBUtilities . java 
 + + + b / src / java / org / apache / cassandra / utils / FBUtilities . java 
 @ @ - 69 , 6 + 69 , 7 @ @ public class FBUtilities 
 private static ObjectMapper jsonMapper = new ObjectMapper ( new JsonFactory ( ) ) ; 
 
 public static final BigInteger TWO = new BigInteger ( " 2 " ) ; 
 + private static final String DEFAULT _ TRIGGER _ DIR = " triggers " ; 
 
 private static volatile InetAddress localInetAddress ; 
 private static volatile InetAddress broadcastInetAddress ; 
 @ @ - 341 , 10 + 342 , 16 @ @ public class FBUtilities 
 return scpurl . getFile ( ) ; 
 } 
 
 - public static File cassandraHomeDir ( ) 
 + public static File cassandraTriggerDir ( ) 
 { 
 - String libDir = new File ( FBUtilities . class . getProtectionDomain ( ) . getCodeSource ( ) . getLocation ( ) . getPath ( ) ) . getParent ( ) ; 
 - return new File ( new File ( libDir ) . getParent ( ) ) ; 
 + File triggerDir ; 
 + if ( System . getProperty ( " cassandra . triggers _ dir " ) ! = null ) 
 + triggerDir = new File ( System . getProperty ( " cassandra . triggers _ dir " ) ) ; 
 + else 
 + triggerDir = new File ( FBUtilities . class . getClassLoader ( ) . getResource ( DEFAULT _ TRIGGER _ DIR ) . getFile ( ) ) ; 
 + if ( ! triggerDir . exists ( ) ) 
 + throw new RuntimeException ( " Trigger Directory doesnt exist , please create inside conf . " ) ; 
 + return triggerDir ; 
 } 
 
 public static String getReleaseVersionString ( ) 
 diff - - git a / test / conf / triggers / README . txt b / test / conf / triggers / README . txt 
 new file mode 100644 
 index 0000000 . . e69de29 
 diff - - git a / test / data / serialization / 2 . 0 / db . RowMutation . bin b / test / data / serialization / 2 . 0 / db . RowMutation . bin 
 index 698b0b6 . . aa75378 100644 
 Binary files a / test / data / serialization / 2 . 0 / db . RowMutation . bin and b / test / data / serialization / 2 . 0 / db . RowMutation . bin differ 
 diff - - git a / test / triggers / README . txt b / test / triggers / README . txt 
 deleted file mode 100644 
 index e69de29 . . 0000000 
 diff - - git a / triggers / README . txt b / triggers / README . txt 
 deleted file mode 100644 
 index e69de29 . . 0000000
