BLEU SCORE: 0.02595391194319116

TEST MSG: Add storage port options to sstableloader
GENERATED MSG: add auth support to sstableloader ; patch by Alexis , reviewed by yukim for CASSANDRA - 4712

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index 4f8f65f . . 848628b 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 1 , 4 + 1 , 5 @ @ <nl> 2 . 1 . 19 <nl> + * Add storage port options to sstableloader ( CASSANDRA - 13844 ) <nl> * Remove stress - test target in CircleCI as it ' s not existing ( CASSANDRA - 13775 ) <nl> * Clone HeartBeatState when building gossip messages . Make its generation / version volatile ( CASSANDRA - 13700 ) <nl> <nl> diff - - git a / src / java / org / apache / cassandra / tools / BulkLoader . java b / src / java / org / apache / cassandra / tools / BulkLoader . java <nl> index 0b1a1d4 . . 52f9467 100644 <nl> - - - a / src / java / org / apache / cassandra / tools / BulkLoader . java <nl> + + + b / src / java / org / apache / cassandra / tools / BulkLoader . java <nl> @ @ - 56 , 6 + 56 , 8 @ @ public class BulkLoader <nl> private static final String IGNORE _ NODES _ OPTION = " ignore " ; <nl> private static final String INITIAL _ HOST _ ADDRESS _ OPTION = " nodes " ; <nl> private static final String RPC _ PORT _ OPTION = " port " ; <nl> + private static final String STORAGE _ PORT _ OPTION = " storage - port " ; <nl> + private static final String SSL _ STORAGE _ PORT _ OPTION = " ssl - storage - port " ; <nl> private static final String USER _ OPTION = " username " ; <nl> private static final String PASSWD _ OPTION = " password " ; <nl> private static final String THROTTLE _ MBITS = " throttle " ; <nl> @ @ - 399 , 7 + 401 , 7 @ @ public class BulkLoader <nl> public boolean debug ; <nl> public boolean verbose ; <nl> public boolean noProgress ; <nl> - public int rpcPort = 9160 ; <nl> + public int rpcPort ; <nl> public String user ; <nl> public String passwd ; <nl> public int throttle = 0 ; <nl> @ @ - 462 , 9 + 464 , 6 @ @ public class BulkLoader <nl> opts . verbose = cmd . hasOption ( VERBOSE _ OPTION ) ; <nl> opts . noProgress = cmd . hasOption ( NOPROGRESS _ OPTION ) ; <nl> <nl> - if ( cmd . hasOption ( RPC _ PORT _ OPTION ) ) <nl> - opts . rpcPort = Integer . parseInt ( cmd . getOptionValue ( RPC _ PORT _ OPTION ) ) ; <nl> - <nl> if ( cmd . hasOption ( USER _ OPTION ) ) <nl> opts . user = cmd . getOptionValue ( USER _ OPTION ) ; <nl> <nl> @ @ - 532 , 13 + 531 , 38 @ @ public class BulkLoader <nl> config . stream _ throughput _ outbound _ megabits _ per _ sec = 0 ; <nl> config . inter _ dc _ stream _ throughput _ outbound _ megabits _ per _ sec = 0 ; <nl> } <nl> - opts . storagePort = config . storage _ port ; <nl> - opts . sslStoragePort = config . ssl _ storage _ port ; <nl> opts . throttle = config . stream _ throughput _ outbound _ megabits _ per _ sec ; <nl> opts . interDcThrottle = config . inter _ dc _ stream _ throughput _ outbound _ megabits _ per _ sec ; <nl> opts . encOptions = config . client _ encryption _ options ; <nl> opts . serverEncOptions = config . server _ encryption _ options ; <nl> <nl> + if ( cmd . hasOption ( RPC _ PORT _ OPTION ) ) <nl> + { <nl> + opts . rpcPort = Integer . parseInt ( cmd . getOptionValue ( RPC _ PORT _ OPTION ) ) ; <nl> + } <nl> + else <nl> + { <nl> + opts . rpcPort = config . rpc _ port ; <nl> + } <nl> + <nl> + if ( cmd . hasOption ( STORAGE _ PORT _ OPTION ) ) <nl> + { <nl> + opts . storagePort = Integer . parseInt ( cmd . getOptionValue ( STORAGE _ PORT _ OPTION ) ) ; <nl> + } <nl> + else <nl> + { <nl> + opts . storagePort = config . storage _ port ; <nl> + } <nl> + <nl> + if ( cmd . hasOption ( SSL _ STORAGE _ PORT _ OPTION ) ) <nl> + { <nl> + opts . sslStoragePort = Integer . parseInt ( cmd . getOptionValue ( SSL _ STORAGE _ PORT _ OPTION ) ) ; <nl> + } <nl> + else <nl> + { <nl> + opts . sslStoragePort = config . ssl _ storage _ port ; <nl> + } <nl> + <nl> if ( cmd . hasOption ( THROTTLE _ MBITS ) ) <nl> { <nl> opts . throttle = Integer . parseInt ( cmd . getOptionValue ( THROTTLE _ MBITS ) ) ; <nl> @ @ - 667 , 6 + 691 , 8 @ @ public class BulkLoader <nl> options . addOption ( " i " , IGNORE _ NODES _ OPTION , " NODES " , " don ' t stream to this ( comma separated ) list of nodes " ) ; <nl> options . addOption ( " d " , INITIAL _ HOST _ ADDRESS _ OPTION , " initial hosts " , " Required . try to connect to these hosts ( comma separated ) initially for ring information " ) ; <nl> options . addOption ( " p " , RPC _ PORT _ OPTION , " rpc port " , " port used for rpc ( default 9160 ) " ) ; <nl> + options . addOption ( " sp " , STORAGE _ PORT _ OPTION , " storage port " , " port used for internode communication ( default 7000 ) " ) ; <nl> + options . addOption ( " ssp " , SSL _ STORAGE _ PORT _ OPTION , " ssl storage port " , " port used for TLS internode communication ( default 7001 ) " ) ; <nl> options . addOption ( " t " , THROTTLE _ MBITS , " throttle " , " throttle speed in Mbits ( default unlimited ) " ) ; <nl> options . addOption ( " idct " , INTER _ DC _ THROTTLE _ MBITS , " inter - dc - throttle " , " inter - datacenter throttle speed in Mbits ( default unlimited ) " ) ; <nl> options . addOption ( " u " , USER _ OPTION , " username " , " username for cassandra authentication " ) ;
NEAREST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index a7a7ca7 . . 7425111 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 11 , 8 + 11 , 7 @ @ <nl> * Fix scrubbing of CQL3 created tables ( CASSANDRA - 4685 ) <nl> * ( CQL3 ) Fix validation when using counter and regular columns in the same table <nl> ( CASSANDRA - 4706 ) <nl> - * Fix bug starting Cassandra with simple authentication ( CASSANDRA - 4648 <nl> - * ) <nl> + * Fix bug starting Cassandra with simple authentication ( CASSANDRA - 4648 ) <nl> <nl> 1 . 2 - beta1 <nl> * add atomic _ batch _ mutate ( CASSANDRA - 4542 , - 4635 )

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index 4f8f65f . . 848628b 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 1 , 4 + 1 , 5 @ @ 
 2 . 1 . 19 
 + * Add storage port options to sstableloader ( CASSANDRA - 13844 ) 
 * Remove stress - test target in CircleCI as it ' s not existing ( CASSANDRA - 13775 ) 
 * Clone HeartBeatState when building gossip messages . Make its generation / version volatile ( CASSANDRA - 13700 ) 
 
 diff - - git a / src / java / org / apache / cassandra / tools / BulkLoader . java b / src / java / org / apache / cassandra / tools / BulkLoader . java 
 index 0b1a1d4 . . 52f9467 100644 
 - - - a / src / java / org / apache / cassandra / tools / BulkLoader . java 
 + + + b / src / java / org / apache / cassandra / tools / BulkLoader . java 
 @ @ - 56 , 6 + 56 , 8 @ @ public class BulkLoader 
 private static final String IGNORE _ NODES _ OPTION = " ignore " ; 
 private static final String INITIAL _ HOST _ ADDRESS _ OPTION = " nodes " ; 
 private static final String RPC _ PORT _ OPTION = " port " ; 
 + private static final String STORAGE _ PORT _ OPTION = " storage - port " ; 
 + private static final String SSL _ STORAGE _ PORT _ OPTION = " ssl - storage - port " ; 
 private static final String USER _ OPTION = " username " ; 
 private static final String PASSWD _ OPTION = " password " ; 
 private static final String THROTTLE _ MBITS = " throttle " ; 
 @ @ - 399 , 7 + 401 , 7 @ @ public class BulkLoader 
 public boolean debug ; 
 public boolean verbose ; 
 public boolean noProgress ; 
 - public int rpcPort = 9160 ; 
 + public int rpcPort ; 
 public String user ; 
 public String passwd ; 
 public int throttle = 0 ; 
 @ @ - 462 , 9 + 464 , 6 @ @ public class BulkLoader 
 opts . verbose = cmd . hasOption ( VERBOSE _ OPTION ) ; 
 opts . noProgress = cmd . hasOption ( NOPROGRESS _ OPTION ) ; 
 
 - if ( cmd . hasOption ( RPC _ PORT _ OPTION ) ) 
 - opts . rpcPort = Integer . parseInt ( cmd . getOptionValue ( RPC _ PORT _ OPTION ) ) ; 
 - 
 if ( cmd . hasOption ( USER _ OPTION ) ) 
 opts . user = cmd . getOptionValue ( USER _ OPTION ) ; 
 
 @ @ - 532 , 13 + 531 , 38 @ @ public class BulkLoader 
 config . stream _ throughput _ outbound _ megabits _ per _ sec = 0 ; 
 config . inter _ dc _ stream _ throughput _ outbound _ megabits _ per _ sec = 0 ; 
 } 
 - opts . storagePort = config . storage _ port ; 
 - opts . sslStoragePort = config . ssl _ storage _ port ; 
 opts . throttle = config . stream _ throughput _ outbound _ megabits _ per _ sec ; 
 opts . interDcThrottle = config . inter _ dc _ stream _ throughput _ outbound _ megabits _ per _ sec ; 
 opts . encOptions = config . client _ encryption _ options ; 
 opts . serverEncOptions = config . server _ encryption _ options ; 
 
 + if ( cmd . hasOption ( RPC _ PORT _ OPTION ) ) 
 + { 
 + opts . rpcPort = Integer . parseInt ( cmd . getOptionValue ( RPC _ PORT _ OPTION ) ) ; 
 + } 
 + else 
 + { 
 + opts . rpcPort = config . rpc _ port ; 
 + } 
 + 
 + if ( cmd . hasOption ( STORAGE _ PORT _ OPTION ) ) 
 + { 
 + opts . storagePort = Integer . parseInt ( cmd . getOptionValue ( STORAGE _ PORT _ OPTION ) ) ; 
 + } 
 + else 
 + { 
 + opts . storagePort = config . storage _ port ; 
 + } 
 + 
 + if ( cmd . hasOption ( SSL _ STORAGE _ PORT _ OPTION ) ) 
 + { 
 + opts . sslStoragePort = Integer . parseInt ( cmd . getOptionValue ( SSL _ STORAGE _ PORT _ OPTION ) ) ; 
 + } 
 + else 
 + { 
 + opts . sslStoragePort = config . ssl _ storage _ port ; 
 + } 
 + 
 if ( cmd . hasOption ( THROTTLE _ MBITS ) ) 
 { 
 opts . throttle = Integer . parseInt ( cmd . getOptionValue ( THROTTLE _ MBITS ) ) ; 
 @ @ - 667 , 6 + 691 , 8 @ @ public class BulkLoader 
 options . addOption ( " i " , IGNORE _ NODES _ OPTION , " NODES " , " don ' t stream to this ( comma separated ) list of nodes " ) ; 
 options . addOption ( " d " , INITIAL _ HOST _ ADDRESS _ OPTION , " initial hosts " , " Required . try to connect to these hosts ( comma separated ) initially for ring information " ) ; 
 options . addOption ( " p " , RPC _ PORT _ OPTION , " rpc port " , " port used for rpc ( default 9160 ) " ) ; 
 + options . addOption ( " sp " , STORAGE _ PORT _ OPTION , " storage port " , " port used for internode communication ( default 7000 ) " ) ; 
 + options . addOption ( " ssp " , SSL _ STORAGE _ PORT _ OPTION , " ssl storage port " , " port used for TLS internode communication ( default 7001 ) " ) ; 
 options . addOption ( " t " , THROTTLE _ MBITS , " throttle " , " throttle speed in Mbits ( default unlimited ) " ) ; 
 options . addOption ( " idct " , INTER _ DC _ THROTTLE _ MBITS , " inter - dc - throttle " , " inter - datacenter throttle speed in Mbits ( default unlimited ) " ) ; 
 options . addOption ( " u " , USER _ OPTION , " username " , " username for cassandra authentication " ) ;

NEAREST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index a7a7ca7 . . 7425111 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 11 , 8 + 11 , 7 @ @ 
 * Fix scrubbing of CQL3 created tables ( CASSANDRA - 4685 ) 
 * ( CQL3 ) Fix validation when using counter and regular columns in the same table 
 ( CASSANDRA - 4706 ) 
 - * Fix bug starting Cassandra with simple authentication ( CASSANDRA - 4648 
 - * ) 
 + * Fix bug starting Cassandra with simple authentication ( CASSANDRA - 4648 ) 
 
 1 . 2 - beta1 
 * add atomic _ batch _ mutate ( CASSANDRA - 4542 , - 4635 )
