BLEU SCORE: 0.02139089632303349

TEST MSG: Avoid CME when cancelling compactions for anticompaction
GENERATED MSG: CASSANDRA - 14935 followup , replace leftover todos with comments

TEST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / db / compaction / ActiveCompactions . java b / src / java / org / apache / cassandra / db / compaction / ActiveCompactions . java <nl> index bba0601 . . 5bcb06f 100644 <nl> - - - a / src / java / org / apache / cassandra / db / compaction / ActiveCompactions . java <nl> + + + b / src / java / org / apache / cassandra / db / compaction / ActiveCompactions . java <nl> @ @ - 56 , 13 + 56 , 16 @ @ public class ActiveCompactions implements ActiveCompactionsTracker <nl> public CompactionInfo getCompactionForSSTable ( SSTableReader sstable ) <nl> { <nl> CompactionInfo toReturn = null ; <nl> - for ( CompactionInfo . Holder holder : compactions ) <nl> + synchronized ( compactions ) <nl> { <nl> - if ( holder . getCompactionInfo ( ) . getSSTables ( ) . contains ( sstable ) ) <nl> + for ( CompactionInfo . Holder holder : compactions ) <nl> { <nl> - if ( toReturn ! = null ) <nl> - throw new IllegalStateException ( " SSTable " + sstable + " involved in several compactions " ) ; <nl> - toReturn = holder . getCompactionInfo ( ) ; <nl> + if ( holder . getCompactionInfo ( ) . getSSTables ( ) . contains ( sstable ) ) <nl> + { <nl> + if ( toReturn ! = null ) <nl> + throw new IllegalStateException ( " SSTable " + sstable + " involved in several compactions " ) ; <nl> + toReturn = holder . getCompactionInfo ( ) ; <nl> + } <nl> } <nl> } <nl> return toReturn ;
NEAREST DIFF (one line): ELIMINATEDSENTENCE

TEST DIFF:
diff - - git a / src / java / org / apache / cassandra / db / compaction / ActiveCompactions . java b / src / java / org / apache / cassandra / db / compaction / ActiveCompactions . java 
 index bba0601 . . 5bcb06f 100644 
 - - - a / src / java / org / apache / cassandra / db / compaction / ActiveCompactions . java 
 + + + b / src / java / org / apache / cassandra / db / compaction / ActiveCompactions . java 
 @ @ - 56 , 13 + 56 , 16 @ @ public class ActiveCompactions implements ActiveCompactionsTracker 
 public CompactionInfo getCompactionForSSTable ( SSTableReader sstable ) 
 { 
 CompactionInfo toReturn = null ; 
 - for ( CompactionInfo . Holder holder : compactions ) 
 + synchronized ( compactions ) 
 { 
 - if ( holder . getCompactionInfo ( ) . getSSTables ( ) . contains ( sstable ) ) 
 + for ( CompactionInfo . Holder holder : compactions ) 
 { 
 - if ( toReturn ! = null ) 
 - throw new IllegalStateException ( " SSTable " + sstable + " involved in several compactions " ) ; 
 - toReturn = holder . getCompactionInfo ( ) ; 
 + if ( holder . getCompactionInfo ( ) . getSSTables ( ) . contains ( sstable ) ) 
 + { 
 + if ( toReturn ! = null ) 
 + throw new IllegalStateException ( " SSTable " + sstable + " involved in several compactions " ) ; 
 + toReturn = holder . getCompactionInfo ( ) ; 
 + } 
 } 
 } 
 return toReturn ;

NEAREST DIFF:
ELIMINATEDSENTENCE
