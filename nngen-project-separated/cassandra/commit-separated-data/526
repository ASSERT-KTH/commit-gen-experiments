BLEU SCORE: 0.014199193612838947

TEST MSG: Follow - up CASSANDRA - 12905 : always return future on Keyspace . applyFuture
GENERATED MSG: Mutations do not block for completion under view lock contention

TEST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / db / Keyspace . java b / src / java / org / apache / cassandra / db / Keyspace . java <nl> index 217cf54 . . 7349f42 100644 <nl> - - - a / src / java / org / apache / cassandra / db / Keyspace . java <nl> + + + b / src / java / org / apache / cassandra / db / Keyspace . java <nl> @ @ - 381 , 13 + 381 , 13 @ @ public class Keyspace <nl> <nl> public CompletableFuture < ? > applyFuture ( Mutation mutation , boolean writeCommitLog , boolean updateIndexes ) <nl> { <nl> - return applyInternal ( mutation , writeCommitLog , updateIndexes , true , true , null ) ; <nl> + return applyInternal ( mutation , writeCommitLog , updateIndexes , true , true , new CompletableFuture < > ( ) ) ; <nl> } <nl> <nl> public CompletableFuture < ? > applyFuture ( Mutation mutation , boolean writeCommitLog , boolean updateIndexes , boolean isDroppable , <nl> boolean isDeferrable ) <nl> { <nl> - return applyInternal ( mutation , writeCommitLog , updateIndexes , isDroppable , isDeferrable , null ) ; <nl> + return applyInternal ( mutation , writeCommitLog , updateIndexes , isDroppable , isDeferrable , new CompletableFuture < > ( ) ) ; <nl> } <nl> <nl> public void apply ( Mutation mutation , boolean writeCommitLog , boolean updateIndexes ) <nl> @ @ - 433 , 7 + 433 , 7 @ @ public class Keyspace <nl> boolean isDeferrable , <nl> CompletableFuture < ? > future ) <nl> { <nl> - return applyInternal ( mutation , writeCommitLog , updateIndexes , ! isClReplay , isDeferrable , future ) ; <nl> + return applyInternal ( mutation , writeCommitLog , updateIndexes , ! isClReplay , isDeferrable , future ! = null ? future : new CompletableFuture < > ( ) ) ; <nl> } <nl> <nl> / * * <nl> @ @ - 458 , 11 + 458 , 6 @ @ public class Keyspace <nl> <nl> boolean requiresViewUpdate = updateIndexes & & viewManager . updatesAffectView ( Collections . singleton ( mutation ) , false ) ; <nl> <nl> - / / If apply is not deferrable , no future is required , returns always null <nl> - if ( isDeferrable & & future = = null ) { <nl> - future = new CompletableFuture < > ( ) ; <nl> - } <nl> - <nl> Lock lock = null ; <nl> if ( requiresViewUpdate ) <nl> {
NEAREST DIFF (one line): ELIMINATEDSENTENCE

TEST DIFF:
diff - - git a / src / java / org / apache / cassandra / db / Keyspace . java b / src / java / org / apache / cassandra / db / Keyspace . java 
 index 217cf54 . . 7349f42 100644 
 - - - a / src / java / org / apache / cassandra / db / Keyspace . java 
 + + + b / src / java / org / apache / cassandra / db / Keyspace . java 
 @ @ - 381 , 13 + 381 , 13 @ @ public class Keyspace 
 
 public CompletableFuture < ? > applyFuture ( Mutation mutation , boolean writeCommitLog , boolean updateIndexes ) 
 { 
 - return applyInternal ( mutation , writeCommitLog , updateIndexes , true , true , null ) ; 
 + return applyInternal ( mutation , writeCommitLog , updateIndexes , true , true , new CompletableFuture < > ( ) ) ; 
 } 
 
 public CompletableFuture < ? > applyFuture ( Mutation mutation , boolean writeCommitLog , boolean updateIndexes , boolean isDroppable , 
 boolean isDeferrable ) 
 { 
 - return applyInternal ( mutation , writeCommitLog , updateIndexes , isDroppable , isDeferrable , null ) ; 
 + return applyInternal ( mutation , writeCommitLog , updateIndexes , isDroppable , isDeferrable , new CompletableFuture < > ( ) ) ; 
 } 
 
 public void apply ( Mutation mutation , boolean writeCommitLog , boolean updateIndexes ) 
 @ @ - 433 , 7 + 433 , 7 @ @ public class Keyspace 
 boolean isDeferrable , 
 CompletableFuture < ? > future ) 
 { 
 - return applyInternal ( mutation , writeCommitLog , updateIndexes , ! isClReplay , isDeferrable , future ) ; 
 + return applyInternal ( mutation , writeCommitLog , updateIndexes , ! isClReplay , isDeferrable , future ! = null ? future : new CompletableFuture < > ( ) ) ; 
 } 
 
 / * * 
 @ @ - 458 , 11 + 458 , 6 @ @ public class Keyspace 
 
 boolean requiresViewUpdate = updateIndexes & & viewManager . updatesAffectView ( Collections . singleton ( mutation ) , false ) ; 
 
 - / / If apply is not deferrable , no future is required , returns always null 
 - if ( isDeferrable & & future = = null ) { 
 - future = new CompletableFuture < > ( ) ; 
 - } 
 - 
 Lock lock = null ; 
 if ( requiresViewUpdate ) 
 {

NEAREST DIFF:
ELIMINATEDSENTENCE
