BLEU SCORE: 0.037477767366779206

TEST MSG: prevent the command " cassandra start " from starting a cluster
GENERATED MSG: 2nd missing file from r760679

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index 0511ed4 . . 6ce9aa9 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 1 , 4 + 1 , 5 @ @ <nl> 3 . 2 <nl> + * Prevent running Cassandra as root ( CASSANDRA - 8142 ) <nl> * bound maximum in - flight commit log replay mutation bytes to 64 megabytes ( CASSANDRA - 8639 ) <nl> * Normalize all scripts ( CASSANDRA - 10679 ) <nl> * Make compression ratio much more accurate ( CASSANDRA - 10225 ) <nl> diff - - git a / NEWS . txt b / NEWS . txt <nl> index ec39f27 . . 3ae1031 100644 <nl> - - - a / NEWS . txt <nl> + + + b / NEWS . txt <nl> @ @ - 25 , 6 + 25 , 7 @ @ New features <nl> Upgrading <nl> - - - - - - - - - <nl> - The compression ratio metrics computation has been modified to be more accurate . <nl> + - Running Cassandra as root is prevented by default . <nl> <nl> <nl> 3 . 1 <nl> diff - - git a / bin / cassandra b / bin / cassandra <nl> index 0bbd9fb . . 810bc4b 100755 <nl> - - - a / bin / cassandra <nl> + + + b / bin / cassandra <nl> @ @ - 211 , 7 + 211 , 7 @ @ launch _ service ( ) <nl> } <nl> <nl> # Parse any command line options . <nl> - args = ` getopt vfhp : bD : H : E : " $ @ " ` <nl> + args = ` getopt vRfhp : bD : H : E : " $ @ " ` <nl> eval set - - " $ args " <nl> <nl> classname = " org . apache . cassandra . service . CassandraDaemon " <nl> @ @ - 234 , 6 + 234 , 10 @ @ while true ; do <nl> " $ JAVA " - cp " $ CLASSPATH " org . apache . cassandra . tools . GetVersion <nl> exit 0 <nl> ; ; <nl> + - R ) <nl> + allow _ root = " yes " <nl> + shift <nl> + ; ; <nl> - D ) <nl> properties = " $ properties - D $ 2 " <nl> shift 2 <nl> @ @ - 248 , 15 + 252 , 27 @ @ while true ; do <nl> ; ; <nl> - - ) <nl> shift <nl> + if [ " x $ * " ! = " x " ] ; then <nl> + echo " Error parsing arguments ! Unknown argument \ " $ * \ " " > & 2 <nl> + exit 1 <nl> + fi <nl> break <nl> ; ; <nl> * ) <nl> - echo " Error parsing arguments ! " > & 2 <nl> + echo " Error parsing arguments ! Unknown argument \ " $ 1 \ " " > & 2 <nl> exit 1 <nl> ; ; <nl> esac <nl> done <nl> <nl> + if [ " x $ allow _ root " ! = " xyes " ] ; then <nl> + if [ " ` id - u ` " = " 1 " ] | | [ " ` id - g ` " = " 0 " ] ; then <nl> + echo " Running Cassandra as root user or group is not recommended - please start Cassandra using a different system user . " <nl> + echo " If you really want to force running Cassandra as root , use - R command line option . " <nl> + exit 1 <nl> + fi <nl> + fi <nl> + <nl> # see CASSANDRA - 7254 <nl> " $ JAVA " - cp " $ CLASSPATH " $ JVM _ OPTS 2 > & 1 | grep - q ' Error : Exception thrown by the agent : java . lang . NullPointerException ' <nl> if [ $ ? - ne " 1 " ] ; then
NEAREST DIFF (one line): diff - - git a / bin / cassandra b / bin / cassandra <nl> new file mode 100755 <nl> index 0000000 . . b5365d5 <nl> - - - / dev / null <nl> + + + b / bin / cassandra <nl> @ @ - 0 , 0 + 1 , 113 @ @ <nl> + # ! / bin / sh <nl> + <nl> + <nl> + # OPTIONS : <nl> + # - f : start in foreground <nl> + # - p < filename > : log the pid to a file ( useful to kill it later ) <nl> + <nl> + <nl> + # Licensed to the Apache Software Foundation ( ASF ) under one <nl> + # or more contributor license agreements . See the NOTICE file <nl> + # distributed with this work for additional information <nl> + # regarding copyright ownership . The ASF licenses this file <nl> + # to you under the Apache License , Version 2 . 0 ( the <nl> + # " License " ) ; you may not use this file except in compliance <nl> + # with the License . You may obtain a copy of the License at <nl> + # <nl> + # http : / / www . apache . org / licenses / LICENSE - 2 . 0 <nl> + # <nl> + # Unless required by applicable law or agreed to in writing , software <nl> + # distributed under the License is distributed on an " AS IS " BASIS , <nl> + # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND , either express or implied . <nl> + # See the License for the specific language governing permissions and <nl> + # limitations under the License . <nl> + <nl> + <nl> + if [ " x $ CASSANDRA _ INCLUDE " = " x " ] ; then <nl> + for include in / usr / share / cassandra / cassandra . in . sh \ <nl> + / usr / local / share / cassandra / cassandra . in . sh \ <nl> + / opt / cassandra / cassandra . in . sh \ <nl> + ` dirname $ 0 ` / cassandra . in . sh ; do <nl> + if [ - r $ include ] ; then <nl> + . $ include <nl> + break <nl> + fi <nl> + done <nl> + elif [ - r $ CASSANDRA _ INCLUDE ] ; then <nl> + . $ CASSANDRA _ INCLUDE <nl> + fi <nl> + <nl> + if [ - z $ CASSANDRA _ CONF - o - z $ CLASSPATH ] ; then <nl> + echo " You must set the CASSANDRA _ CONF and CLASSPATH vars " > & 2 <nl> + exit 1 <nl> + fi <nl> + <nl> + # Special - case path variables . <nl> + case " ` uname ` " in <nl> + CYGWIN * ) <nl> + CLASSPATH = ` cygpath - p - w " $ CLASSPATH " ` <nl> + CASSANDRA _ CONF = ` cygpath - p - w " $ CASSANDRA _ CONF " ` <nl> + ; ; <nl> + esac <nl> + <nl> + launch _ service ( ) <nl> + { <nl> + pidpath = $ 1 <nl> + foreground = $ 2 <nl> + cassandra _ parms = " - Dcassandra - Dstorage - config = $ CASSANDRA _ CONF " <nl> + <nl> + if [ " x $ pidpath " ! = " x " ] ; then <nl> + cassandra _ parms = " $ cassandra _ parms - Dcassandra - pidfile = $ pidpath " <nl> + fi <nl> + <nl> + # The cassandra - foreground option will tell CassandraDaemon not <nl> + # to close stdout / stderr , but it ' s up to us not to background . <nl> + if [ " x $ foreground " ! = " x " ] ; then <nl> + cassandra _ parms = " $ cassandra _ parms - Dcassandra - foreground = yes " <nl> + java $ JVM _ OPTS $ cassandra _ parms - cp $ CLASSPATH \ <nl> + org . apache . cassandra . service . CassandraDaemon <nl> + # Startup CassandraDaemon , background it , and write the pid . <nl> + else <nl> + exec java $ JVM _ OPTS $ cassandra _ parms - cp $ CLASSPATH \ <nl> + org . apache . cassandra . service . CassandraDaemon < & - & <nl> + [ ! - z $ pidpath ] & & echo - n $ ! > $ pidpath <nl> + fi <nl> + <nl> + return $ ? <nl> + } <nl> + <nl> + # Parse any command line options . <nl> + args = ` getopt fhp : " $ @ " ` <nl> + eval set - - " $ args " <nl> + <nl> + while true ; do <nl> + case " $ 1 " in <nl> + - p ) <nl> + pidfile = " $ 2 " <nl> + shift 2 <nl> + ; ; <nl> + - f ) <nl> + foreground = " yes " <nl> + shift <nl> + ; ; <nl> + - h ) <nl> + echo " Usage : $ 0 [ - f ] [ - h ] [ - p pidfile ] " <nl> + exit 0 <nl> + ; ; <nl> + - - ) <nl> + shift <nl> + break <nl> + ; ; <nl> + * ) <nl> + echo " Error parsing arguments ! " > & 2 <nl> + exit 1 <nl> + ; ; <nl> + esac <nl> + done <nl> + <nl> + # Start up the service <nl> + launch _ service " $ pidfile " " $ foreground " <nl> + <nl> + exit $ ? <nl> + <nl> + # vi : ai sw = 4 ts = 4 tw = 0 et

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index 0511ed4 . . 6ce9aa9 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 1 , 4 + 1 , 5 @ @ 
 3 . 2 
 + * Prevent running Cassandra as root ( CASSANDRA - 8142 ) 
 * bound maximum in - flight commit log replay mutation bytes to 64 megabytes ( CASSANDRA - 8639 ) 
 * Normalize all scripts ( CASSANDRA - 10679 ) 
 * Make compression ratio much more accurate ( CASSANDRA - 10225 ) 
 diff - - git a / NEWS . txt b / NEWS . txt 
 index ec39f27 . . 3ae1031 100644 
 - - - a / NEWS . txt 
 + + + b / NEWS . txt 
 @ @ - 25 , 6 + 25 , 7 @ @ New features 
 Upgrading 
 - - - - - - - - - 
 - The compression ratio metrics computation has been modified to be more accurate . 
 + - Running Cassandra as root is prevented by default . 
 
 
 3 . 1 
 diff - - git a / bin / cassandra b / bin / cassandra 
 index 0bbd9fb . . 810bc4b 100755 
 - - - a / bin / cassandra 
 + + + b / bin / cassandra 
 @ @ - 211 , 7 + 211 , 7 @ @ launch _ service ( ) 
 } 
 
 # Parse any command line options . 
 - args = ` getopt vfhp : bD : H : E : " $ @ " ` 
 + args = ` getopt vRfhp : bD : H : E : " $ @ " ` 
 eval set - - " $ args " 
 
 classname = " org . apache . cassandra . service . CassandraDaemon " 
 @ @ - 234 , 6 + 234 , 10 @ @ while true ; do 
 " $ JAVA " - cp " $ CLASSPATH " org . apache . cassandra . tools . GetVersion 
 exit 0 
 ; ; 
 + - R ) 
 + allow _ root = " yes " 
 + shift 
 + ; ; 
 - D ) 
 properties = " $ properties - D $ 2 " 
 shift 2 
 @ @ - 248 , 15 + 252 , 27 @ @ while true ; do 
 ; ; 
 - - ) 
 shift 
 + if [ " x $ * " ! = " x " ] ; then 
 + echo " Error parsing arguments ! Unknown argument \ " $ * \ " " > & 2 
 + exit 1 
 + fi 
 break 
 ; ; 
 * ) 
 - echo " Error parsing arguments ! " > & 2 
 + echo " Error parsing arguments ! Unknown argument \ " $ 1 \ " " > & 2 
 exit 1 
 ; ; 
 esac 
 done 
 
 + if [ " x $ allow _ root " ! = " xyes " ] ; then 
 + if [ " ` id - u ` " = " 1 " ] | | [ " ` id - g ` " = " 0 " ] ; then 
 + echo " Running Cassandra as root user or group is not recommended - please start Cassandra using a different system user . " 
 + echo " If you really want to force running Cassandra as root , use - R command line option . " 
 + exit 1 
 + fi 
 + fi 
 + 
 # see CASSANDRA - 7254 
 " $ JAVA " - cp " $ CLASSPATH " $ JVM _ OPTS 2 > & 1 | grep - q ' Error : Exception thrown by the agent : java . lang . NullPointerException ' 
 if [ $ ? - ne " 1 " ] ; then

NEAREST DIFF:
diff - - git a / bin / cassandra b / bin / cassandra 
 new file mode 100755 
 index 0000000 . . b5365d5 
 - - - / dev / null 
 + + + b / bin / cassandra 
 @ @ - 0 , 0 + 1 , 113 @ @ 
 + # ! / bin / sh 
 + 
 + 
 + # OPTIONS : 
 + # - f : start in foreground 
 + # - p < filename > : log the pid to a file ( useful to kill it later ) 
 + 
 + 
 + # Licensed to the Apache Software Foundation ( ASF ) under one 
 + # or more contributor license agreements . See the NOTICE file 
 + # distributed with this work for additional information 
 + # regarding copyright ownership . The ASF licenses this file 
 + # to you under the Apache License , Version 2 . 0 ( the 
 + # " License " ) ; you may not use this file except in compliance 
 + # with the License . You may obtain a copy of the License at 
 + # 
 + # http : / / www . apache . org / licenses / LICENSE - 2 . 0 
 + # 
 + # Unless required by applicable law or agreed to in writing , software 
 + # distributed under the License is distributed on an " AS IS " BASIS , 
 + # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND , either express or implied . 
 + # See the License for the specific language governing permissions and 
 + # limitations under the License . 
 + 
 + 
 + if [ " x $ CASSANDRA _ INCLUDE " = " x " ] ; then 
 + for include in / usr / share / cassandra / cassandra . in . sh \ 
 + / usr / local / share / cassandra / cassandra . in . sh \ 
 + / opt / cassandra / cassandra . in . sh \ 
 + ` dirname $ 0 ` / cassandra . in . sh ; do 
 + if [ - r $ include ] ; then 
 + . $ include 
 + break 
 + fi 
 + done 
 + elif [ - r $ CASSANDRA _ INCLUDE ] ; then 
 + . $ CASSANDRA _ INCLUDE 
 + fi 
 + 
 + if [ - z $ CASSANDRA _ CONF - o - z $ CLASSPATH ] ; then 
 + echo " You must set the CASSANDRA _ CONF and CLASSPATH vars " > & 2 
 + exit 1 
 + fi 
 + 
 + # Special - case path variables . 
 + case " ` uname ` " in 
 + CYGWIN * ) 
 + CLASSPATH = ` cygpath - p - w " $ CLASSPATH " ` 
 + CASSANDRA _ CONF = ` cygpath - p - w " $ CASSANDRA _ CONF " ` 
 + ; ; 
 + esac 
 + 
 + launch _ service ( ) 
 + { 
 + pidpath = $ 1 
 + foreground = $ 2 
 + cassandra _ parms = " - Dcassandra - Dstorage - config = $ CASSANDRA _ CONF " 
 + 
 + if [ " x $ pidpath " ! = " x " ] ; then 
 + cassandra _ parms = " $ cassandra _ parms - Dcassandra - pidfile = $ pidpath " 
 + fi 
 + 
 + # The cassandra - foreground option will tell CassandraDaemon not 
 + # to close stdout / stderr , but it ' s up to us not to background . 
 + if [ " x $ foreground " ! = " x " ] ; then 
 + cassandra _ parms = " $ cassandra _ parms - Dcassandra - foreground = yes " 
 + java $ JVM _ OPTS $ cassandra _ parms - cp $ CLASSPATH \ 
 + org . apache . cassandra . service . CassandraDaemon 
 + # Startup CassandraDaemon , background it , and write the pid . 
 + else 
 + exec java $ JVM _ OPTS $ cassandra _ parms - cp $ CLASSPATH \ 
 + org . apache . cassandra . service . CassandraDaemon < & - & 
 + [ ! - z $ pidpath ] & & echo - n $ ! > $ pidpath 
 + fi 
 + 
 + return $ ? 
 + } 
 + 
 + # Parse any command line options . 
 + args = ` getopt fhp : " $ @ " ` 
 + eval set - - " $ args " 
 + 
 + while true ; do 
 + case " $ 1 " in 
 + - p ) 
 + pidfile = " $ 2 " 
 + shift 2 
 + ; ; 
 + - f ) 
 + foreground = " yes " 
 + shift 
 + ; ; 
 + - h ) 
 + echo " Usage : $ 0 [ - f ] [ - h ] [ - p pidfile ] " 
 + exit 0 
 + ; ; 
 + - - ) 
 + shift 
 + break 
 + ; ; 
 + * ) 
 + echo " Error parsing arguments ! " > & 2 
 + exit 1 
 + ; ; 
 + esac 
 + done 
 + 
 + # Start up the service 
 + launch _ service " $ pidfile " " $ foreground " 
 + 
 + exit $ ? 
 + 
 + # vi : ai sw = 4 ts = 4 tw = 0 et
