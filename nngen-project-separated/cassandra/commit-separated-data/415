BLEU SCORE: 0.040583489434387374

TEST MSG: Add charset to Analyser input stream
GENERATED MSG: load PFS properties with ResourceAsStream

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index 0761ca5 . . 7b03b6c 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 1 , 4 + 1 , 5 @ @ <nl> 3 . 11 . 0 <nl> + * Add charset to Analyser input stream ( CASSANDRA - 13151 ) <nl> * Fix testLimitSSTables flake caused by concurrent flush ( CASSANDRA - 12820 ) <nl> * cdc column addition strikes again ( CASSANDRA - 13382 ) <nl> * Fix static column indexes ( CASSANDRA - 13277 ) <nl> diff - - git a / src / java / org / apache / cassandra / index / sasi / analyzer / StandardAnalyzer . java b / src / java / org / apache / cassandra / index / sasi / analyzer / StandardAnalyzer . java <nl> index 069164c . . 3b58bf9 100644 <nl> - - - a / src / java / org / apache / cassandra / index / sasi / analyzer / StandardAnalyzer . java <nl> + + + b / src / java / org / apache / cassandra / index / sasi / analyzer / StandardAnalyzer . java <nl> @ @ - 22 , 6 + 22 , 7 @ @ import java . io . InputStream ; <nl> import java . io . InputStreamReader ; <nl> import java . io . Reader ; <nl> import java . nio . ByteBuffer ; <nl> + import java . nio . charset . StandardCharsets ; <nl> import java . util . Map ; <nl> <nl> import org . apache . cassandra . index . sasi . analyzer . filter . * ; <nl> @ @ - 152 , 7 + 153 , 7 @ @ public class StandardAnalyzer extends AbstractAnalyzer <nl> this . options = tokenizerOptions ; <nl> this . filterPipeline = getFilterPipeline ( ) ; <nl> <nl> - Reader reader = new InputStreamReader ( new DataInputBuffer ( ByteBufferUtil . EMPTY _ BYTE _ BUFFER , false ) ) ; <nl> + Reader reader = new InputStreamReader ( new DataInputBuffer ( ByteBufferUtil . EMPTY _ BYTE _ BUFFER , false ) , StandardCharsets . UTF _ 8 ) ; <nl> this . scanner = new StandardTokenizerImpl ( reader ) ; <nl> this . inputReader = reader ; <nl> } <nl> @ @ - 179 , 15 + 180 , 16 @ @ public class StandardAnalyzer extends AbstractAnalyzer <nl> public void reset ( ByteBuffer input ) <nl> { <nl> this . next = null ; <nl> - Reader reader = new InputStreamReader ( new DataInputBuffer ( input , false ) ) ; <nl> + Reader reader = new InputStreamReader ( new DataInputBuffer ( input , false ) , StandardCharsets . UTF _ 8 ) ; <nl> scanner . yyreset ( reader ) ; <nl> this . inputReader = reader ; <nl> } <nl> <nl> + @ VisibleForTesting <nl> public void reset ( InputStream input ) <nl> { <nl> this . next = null ; <nl> - Reader reader = new InputStreamReader ( input ) ; <nl> + Reader reader = new InputStreamReader ( input , StandardCharsets . UTF _ 8 ) ; <nl> scanner . yyreset ( reader ) ; <nl> this . inputReader = reader ; <nl> }
NEAREST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / service / StorageService . java b / src / java / org / apache / cassandra / service / StorageService . java <nl> index 62405ee . . 0975616 100644 <nl> - - - a / src / java / org / apache / cassandra / service / StorageService . java <nl> + + + b / src / java / org / apache / cassandra / service / StorageService . java <nl> @ @ - 169 , 15 + 169 , 6 @ @ public class StorageService implements IEndpointStateChangeSubscriber , StorageSe <nl> / * This abstraction maintains the token / endpoint metadata information * / <nl> private TokenMetadata tokenMetadata _ = new TokenMetadata ( ) ; <nl> <nl> - / * This thread pool does consistency checks when the client doesn ' t care about consistency * / <nl> - private ExecutorService consistencyManager _ = new JMXEnabledThreadPoolExecutor ( DatabaseDescriptor . getConsistencyThreads ( ) , <nl> - DatabaseDescriptor . getConsistencyThreads ( ) , <nl> - StageManager . KEEPALIVE , <nl> - TimeUnit . SECONDS , <nl> - new LinkedBlockingQueue < Runnable > ( ) , <nl> - new NamedThreadFactory ( " ReadRepair " ) , <nl> - " request " ) ; <nl> - <nl> private Set < InetAddress > replicatingNodes ; <nl> private InetAddress removingNode ; <nl>

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index 0761ca5 . . 7b03b6c 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 1 , 4 + 1 , 5 @ @ 
 3 . 11 . 0 
 + * Add charset to Analyser input stream ( CASSANDRA - 13151 ) 
 * Fix testLimitSSTables flake caused by concurrent flush ( CASSANDRA - 12820 ) 
 * cdc column addition strikes again ( CASSANDRA - 13382 ) 
 * Fix static column indexes ( CASSANDRA - 13277 ) 
 diff - - git a / src / java / org / apache / cassandra / index / sasi / analyzer / StandardAnalyzer . java b / src / java / org / apache / cassandra / index / sasi / analyzer / StandardAnalyzer . java 
 index 069164c . . 3b58bf9 100644 
 - - - a / src / java / org / apache / cassandra / index / sasi / analyzer / StandardAnalyzer . java 
 + + + b / src / java / org / apache / cassandra / index / sasi / analyzer / StandardAnalyzer . java 
 @ @ - 22 , 6 + 22 , 7 @ @ import java . io . InputStream ; 
 import java . io . InputStreamReader ; 
 import java . io . Reader ; 
 import java . nio . ByteBuffer ; 
 + import java . nio . charset . StandardCharsets ; 
 import java . util . Map ; 
 
 import org . apache . cassandra . index . sasi . analyzer . filter . * ; 
 @ @ - 152 , 7 + 153 , 7 @ @ public class StandardAnalyzer extends AbstractAnalyzer 
 this . options = tokenizerOptions ; 
 this . filterPipeline = getFilterPipeline ( ) ; 
 
 - Reader reader = new InputStreamReader ( new DataInputBuffer ( ByteBufferUtil . EMPTY _ BYTE _ BUFFER , false ) ) ; 
 + Reader reader = new InputStreamReader ( new DataInputBuffer ( ByteBufferUtil . EMPTY _ BYTE _ BUFFER , false ) , StandardCharsets . UTF _ 8 ) ; 
 this . scanner = new StandardTokenizerImpl ( reader ) ; 
 this . inputReader = reader ; 
 } 
 @ @ - 179 , 15 + 180 , 16 @ @ public class StandardAnalyzer extends AbstractAnalyzer 
 public void reset ( ByteBuffer input ) 
 { 
 this . next = null ; 
 - Reader reader = new InputStreamReader ( new DataInputBuffer ( input , false ) ) ; 
 + Reader reader = new InputStreamReader ( new DataInputBuffer ( input , false ) , StandardCharsets . UTF _ 8 ) ; 
 scanner . yyreset ( reader ) ; 
 this . inputReader = reader ; 
 } 
 
 + @ VisibleForTesting 
 public void reset ( InputStream input ) 
 { 
 this . next = null ; 
 - Reader reader = new InputStreamReader ( input ) ; 
 + Reader reader = new InputStreamReader ( input , StandardCharsets . UTF _ 8 ) ; 
 scanner . yyreset ( reader ) ; 
 this . inputReader = reader ; 
 }

NEAREST DIFF:
diff - - git a / src / java / org / apache / cassandra / service / StorageService . java b / src / java / org / apache / cassandra / service / StorageService . java 
 index 62405ee . . 0975616 100644 
 - - - a / src / java / org / apache / cassandra / service / StorageService . java 
 + + + b / src / java / org / apache / cassandra / service / StorageService . java 
 @ @ - 169 , 15 + 169 , 6 @ @ public class StorageService implements IEndpointStateChangeSubscriber , StorageSe 
 / * This abstraction maintains the token / endpoint metadata information * / 
 private TokenMetadata tokenMetadata _ = new TokenMetadata ( ) ; 
 
 - / * This thread pool does consistency checks when the client doesn ' t care about consistency * / 
 - private ExecutorService consistencyManager _ = new JMXEnabledThreadPoolExecutor ( DatabaseDescriptor . getConsistencyThreads ( ) , 
 - DatabaseDescriptor . getConsistencyThreads ( ) , 
 - StageManager . KEEPALIVE , 
 - TimeUnit . SECONDS , 
 - new LinkedBlockingQueue < Runnable > ( ) , 
 - new NamedThreadFactory ( " ReadRepair " ) , 
 - " request " ) ; 
 - 
 private Set < InetAddress > replicatingNodes ; 
 private InetAddress removingNode ; 

