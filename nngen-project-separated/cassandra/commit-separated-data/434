BLEU SCORE: 0.04266331692956902

TEST MSG: Fix code to not exchange schema across major versions
GENERATED MSG: Fix count ( * ) queries in a mixed cluster

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index 0b1bb01 . . 0af7a7d 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 1 , 4 + 1 , 5 @ @ <nl> 3 . 0 . 13 <nl> + * Fix code to not exchange schema across major versions ( CASSANDRA - 13274 ) <nl> * Dropping column results in " corrupt " SSTable ( CASSANDRA - 13337 ) <nl> * Bugs handling range tombstones in the sstable iterators ( CASSANDRA - 13340 ) <nl> * Fix CONTAINS filtering for null collections ( CASSANDRA - 13246 ) <nl> diff - - git a / src / java / org / apache / cassandra / net / MessagingService . java b / src / java / org / apache / cassandra / net / MessagingService . java <nl> index e8095d3 . . 4aaf49b 100644 <nl> - - - a / src / java / org / apache / cassandra / net / MessagingService . java <nl> + + + b / src / java / org / apache / cassandra / net / MessagingService . java <nl> @ @ - 903 , 9 + 903 , 6 @ @ public final class MessagingService implements MessagingServiceMBean <nl> * / <nl> public int setVersion ( InetAddress endpoint , int version ) <nl> { <nl> - / / We can ' t talk to someone from the future <nl> - version = Math . min ( version , current _ version ) ; <nl> - <nl> logger . trace ( " Setting version { } for { } " , version , endpoint ) ; <nl> <nl> if ( version < VERSION _ 22 ) <nl> @ @ - 926 , 7 + 923 , 7 @ @ public final class MessagingService implements MessagingServiceMBean <nl> { <nl> logger . trace ( " Resetting version for { } " , endpoint ) ; <nl> Integer removed = versions . remove ( endpoint ) ; <nl> - if ( removed ! = null & & removed < = VERSION _ 30 ) <nl> + if ( removed ! = null & & Math . min ( removed , current _ version ) < = VERSION _ 30 ) <nl> refreshAllNodeMinVersions ( ) ; <nl> } <nl> <nl> @ @ - 951 , 6 + 948 , 10 @ @ public final class MessagingService implements MessagingServiceMBean <nl> allNodesAtLeast30 = ! anyNodeLowerThan30 ; <nl> } <nl> <nl> + / * * <nl> + * Returns the messaging - version as announced by the given node but capped <nl> + * to the min of the version as announced by the node and { @ link # current _ version } . <nl> + * / <nl> public int getVersion ( InetAddress endpoint ) <nl> { <nl> Integer v = versions . get ( endpoint ) ; <nl> @ @ - 969 , 6 + 970 , 9 @ @ public final class MessagingService implements MessagingServiceMBean <nl> return getVersion ( InetAddress . getByName ( endpoint ) ) ; <nl> } <nl> <nl> + / * * <nl> + * Returns the messaging - version exactly as announced by the given endpoint . <nl> + * / <nl> public int getRawVersion ( InetAddress endpoint ) <nl> { <nl> Integer v = versions . get ( endpoint ) ;
NEAREST DIFF (one line): ELIMINATEDSENTENCE

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index 0b1bb01 . . 0af7a7d 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 1 , 4 + 1 , 5 @ @ 
 3 . 0 . 13 
 + * Fix code to not exchange schema across major versions ( CASSANDRA - 13274 ) 
 * Dropping column results in " corrupt " SSTable ( CASSANDRA - 13337 ) 
 * Bugs handling range tombstones in the sstable iterators ( CASSANDRA - 13340 ) 
 * Fix CONTAINS filtering for null collections ( CASSANDRA - 13246 ) 
 diff - - git a / src / java / org / apache / cassandra / net / MessagingService . java b / src / java / org / apache / cassandra / net / MessagingService . java 
 index e8095d3 . . 4aaf49b 100644 
 - - - a / src / java / org / apache / cassandra / net / MessagingService . java 
 + + + b / src / java / org / apache / cassandra / net / MessagingService . java 
 @ @ - 903 , 9 + 903 , 6 @ @ public final class MessagingService implements MessagingServiceMBean 
 * / 
 public int setVersion ( InetAddress endpoint , int version ) 
 { 
 - / / We can ' t talk to someone from the future 
 - version = Math . min ( version , current _ version ) ; 
 - 
 logger . trace ( " Setting version { } for { } " , version , endpoint ) ; 
 
 if ( version < VERSION _ 22 ) 
 @ @ - 926 , 7 + 923 , 7 @ @ public final class MessagingService implements MessagingServiceMBean 
 { 
 logger . trace ( " Resetting version for { } " , endpoint ) ; 
 Integer removed = versions . remove ( endpoint ) ; 
 - if ( removed ! = null & & removed < = VERSION _ 30 ) 
 + if ( removed ! = null & & Math . min ( removed , current _ version ) < = VERSION _ 30 ) 
 refreshAllNodeMinVersions ( ) ; 
 } 
 
 @ @ - 951 , 6 + 948 , 10 @ @ public final class MessagingService implements MessagingServiceMBean 
 allNodesAtLeast30 = ! anyNodeLowerThan30 ; 
 } 
 
 + / * * 
 + * Returns the messaging - version as announced by the given node but capped 
 + * to the min of the version as announced by the node and { @ link # current _ version } . 
 + * / 
 public int getVersion ( InetAddress endpoint ) 
 { 
 Integer v = versions . get ( endpoint ) ; 
 @ @ - 969 , 6 + 970 , 9 @ @ public final class MessagingService implements MessagingServiceMBean 
 return getVersion ( InetAddress . getByName ( endpoint ) ) ; 
 } 
 
 + / * * 
 + * Returns the messaging - version exactly as announced by the given endpoint . 
 + * / 
 public int getRawVersion ( InetAddress endpoint ) 
 { 
 Integer v = versions . get ( endpoint ) ;

NEAREST DIFF:
ELIMINATEDSENTENCE
