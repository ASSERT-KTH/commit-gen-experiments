BLEU SCORE: 0.0370865905565703

TEST MSG: really commit CASSANDRA - 13722 to trunk
GENERATED MSG: Add support for skip read validation flag for cassandra - stress

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index cdcfe25 . . 6b3ea2b 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 125 , 6 + 125 , 7 @ @ <nl> <nl> <nl> 3 . 11 . 1 <nl> + * Add a skip read validation flag to cassandra - stress ( CASSANDRA - 13772 ) <nl> * Fix cassandra - stress hang issues when an error during cluster connection happens ( CASSANDRA - 12938 ) <nl> * Better bootstrap failure message when blocked by ( potential ) range movement ( CASSANDRA - 13744 ) <nl> * " ignore " option is ignored in sstableloader ( CASSANDRA - 13721 ) <nl> diff - - git a / tools / stress / src / org / apache / cassandra / stress / operations / predefined / CqlOperation . java b / tools / stress / src / org / apache / cassandra / stress / operations / predefined / CqlOperation . java <nl> index 7fcc63d . . c524107 100644 <nl> - - - a / tools / stress / src / org / apache / cassandra / stress / operations / predefined / CqlOperation . java <nl> + + + b / tools / stress / src / org / apache / cassandra / stress / operations / predefined / CqlOperation . java <nl> @ @ - 186 , 11 + 186 , 14 @ @ public abstract class CqlOperation < V > extends PredefinedOperation <nl> <nl> public boolean validate ( ByteBuffer [ ] [ ] result ) <nl> { <nl> - if ( result . length ! = expect . size ( ) ) <nl> - return false ; <nl> - for ( int i = 0 ; i < result . length ; i + + ) <nl> - if ( expect . get ( i ) ! = null & & ! expect . get ( i ) . equals ( Arrays . asList ( result [ i ] ) ) ) <nl> + if ( ! settings . errors . skipReadValidation ) <nl> + { <nl> + if ( result . length ! = expect . size ( ) ) <nl> return false ; <nl> + for ( int i = 0 ; i < result . length ; i + + ) <nl> + if ( expect . get ( i ) ! = null & & ! expect . get ( i ) . equals ( Arrays . asList ( result [ i ] ) ) ) <nl> + return false ; <nl> + } <nl> return true ; <nl> } <nl> } <nl> diff - - git a / tools / stress / src / org / apache / cassandra / stress / settings / SettingsErrors . java b / tools / stress / src / org / apache / cassandra / stress / settings / SettingsErrors . java <nl> index aae4dd9 . . 41a3dbd 100644 <nl> - - - a / tools / stress / src / org / apache / cassandra / stress / settings / SettingsErrors . java <nl> + + + b / tools / stress / src / org / apache / cassandra / stress / settings / SettingsErrors . java <nl> @ @ - 33 , 11 + 33 , 13 @ @ public class SettingsErrors implements Serializable <nl> <nl> public final boolean ignore ; <nl> public final int tries ; <nl> + public final boolean skipReadValidation ; <nl> <nl> public SettingsErrors ( Options options ) <nl> { <nl> ignore = options . ignore . setByUser ( ) ; <nl> this . tries = Math . max ( 1 , Integer . parseInt ( options . retries . value ( ) ) + 1 ) ; <nl> + skipReadValidation = options . skipReadValidation . setByUser ( ) ; <nl> } <nl> <nl> / / Option Declarations <nl> @ @ - 46 , 11 + 48 , 11 @ @ public class SettingsErrors implements Serializable <nl> { <nl> final OptionSimple retries = new OptionSimple ( " retries = " , " [ 0 - 9 ] + " , " 9 " , " Number of tries to perform for each operation before failing " , false ) ; <nl> final OptionSimple ignore = new OptionSimple ( " ignore " , " " , null , " Do not fail on errors " , false ) ; <nl> - <nl> + final OptionSimple skipReadValidation = new OptionSimple ( " skip - read - validation " , " " , null , " Skip read validation and message output " , false ) ; <nl> @ Override <nl> public List < ? extends Option > options ( ) <nl> { <nl> - return Arrays . asList ( retries , ignore ) ; <nl> + return Arrays . asList ( retries , ignore , skipReadValidation ) ; <nl> } <nl> } <nl>
NEAREST DIFF (one line): ELIMINATEDSENTENCE

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index cdcfe25 . . 6b3ea2b 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 125 , 6 + 125 , 7 @ @ 
 
 
 3 . 11 . 1 
 + * Add a skip read validation flag to cassandra - stress ( CASSANDRA - 13772 ) 
 * Fix cassandra - stress hang issues when an error during cluster connection happens ( CASSANDRA - 12938 ) 
 * Better bootstrap failure message when blocked by ( potential ) range movement ( CASSANDRA - 13744 ) 
 * " ignore " option is ignored in sstableloader ( CASSANDRA - 13721 ) 
 diff - - git a / tools / stress / src / org / apache / cassandra / stress / operations / predefined / CqlOperation . java b / tools / stress / src / org / apache / cassandra / stress / operations / predefined / CqlOperation . java 
 index 7fcc63d . . c524107 100644 
 - - - a / tools / stress / src / org / apache / cassandra / stress / operations / predefined / CqlOperation . java 
 + + + b / tools / stress / src / org / apache / cassandra / stress / operations / predefined / CqlOperation . java 
 @ @ - 186 , 11 + 186 , 14 @ @ public abstract class CqlOperation < V > extends PredefinedOperation 
 
 public boolean validate ( ByteBuffer [ ] [ ] result ) 
 { 
 - if ( result . length ! = expect . size ( ) ) 
 - return false ; 
 - for ( int i = 0 ; i < result . length ; i + + ) 
 - if ( expect . get ( i ) ! = null & & ! expect . get ( i ) . equals ( Arrays . asList ( result [ i ] ) ) ) 
 + if ( ! settings . errors . skipReadValidation ) 
 + { 
 + if ( result . length ! = expect . size ( ) ) 
 return false ; 
 + for ( int i = 0 ; i < result . length ; i + + ) 
 + if ( expect . get ( i ) ! = null & & ! expect . get ( i ) . equals ( Arrays . asList ( result [ i ] ) ) ) 
 + return false ; 
 + } 
 return true ; 
 } 
 } 
 diff - - git a / tools / stress / src / org / apache / cassandra / stress / settings / SettingsErrors . java b / tools / stress / src / org / apache / cassandra / stress / settings / SettingsErrors . java 
 index aae4dd9 . . 41a3dbd 100644 
 - - - a / tools / stress / src / org / apache / cassandra / stress / settings / SettingsErrors . java 
 + + + b / tools / stress / src / org / apache / cassandra / stress / settings / SettingsErrors . java 
 @ @ - 33 , 11 + 33 , 13 @ @ public class SettingsErrors implements Serializable 
 
 public final boolean ignore ; 
 public final int tries ; 
 + public final boolean skipReadValidation ; 
 
 public SettingsErrors ( Options options ) 
 { 
 ignore = options . ignore . setByUser ( ) ; 
 this . tries = Math . max ( 1 , Integer . parseInt ( options . retries . value ( ) ) + 1 ) ; 
 + skipReadValidation = options . skipReadValidation . setByUser ( ) ; 
 } 
 
 / / Option Declarations 
 @ @ - 46 , 11 + 48 , 11 @ @ public class SettingsErrors implements Serializable 
 { 
 final OptionSimple retries = new OptionSimple ( " retries = " , " [ 0 - 9 ] + " , " 9 " , " Number of tries to perform for each operation before failing " , false ) ; 
 final OptionSimple ignore = new OptionSimple ( " ignore " , " " , null , " Do not fail on errors " , false ) ; 
 - 
 + final OptionSimple skipReadValidation = new OptionSimple ( " skip - read - validation " , " " , null , " Skip read validation and message output " , false ) ; 
 @ Override 
 public List < ? extends Option > options ( ) 
 { 
 - return Arrays . asList ( retries , ignore ) ; 
 + return Arrays . asList ( retries , ignore , skipReadValidation ) ; 
 } 
 } 


NEAREST DIFF:
ELIMINATEDSENTENCE
