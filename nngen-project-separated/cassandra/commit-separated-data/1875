BLEU SCORE: 0.027611988917697356

TEST MSG: Purge internal prepared stmts when tables are dropped
GENERATED MSG: Add missing null check in QueryProcessor

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index a8f8b87 . . e3e19cf 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 1 , 4 + 1 , 6 @ @ <nl> 2 . 1 . 3 <nl> + * Purge internal prepared statements if related tables or <nl> + keyspaces are dropped ( CASSANDRA - 8693 ) <nl> * ( cqlsh ) Handle unicode BOM at start of files ( CASSANDRA - 8638 ) <nl> * Stop compactions before exiting offline tools ( CASSANDRA - 8623 ) <nl> * Update tools / stress / README . txt to match current behaviour ( CASSANDRA - 7933 ) <nl> diff - - git a / src / java / org / apache / cassandra / cql3 / QueryProcessor . java b / src / java / org / apache / cassandra / cql3 / QueryProcessor . java <nl> index e6e6f7d . . 3d33713 100644 <nl> - - - a / src / java / org / apache / cassandra / cql3 / QueryProcessor . java <nl> + + + b / src / java / org / apache / cassandra / cql3 / QueryProcessor . java <nl> @ @ - 563 , 6 + 563 , 7 @ @ public class QueryProcessor implements QueryHandler <nl> { <nl> private void removeInvalidPreparedStatements ( String ksName , String cfName ) <nl> { <nl> + removeInvalidPreparedStatements ( internalStatements . values ( ) . iterator ( ) , ksName , cfName ) ; <nl> removeInvalidPreparedStatements ( preparedStatements . values ( ) . iterator ( ) , ksName , cfName ) ; <nl> removeInvalidPreparedStatements ( thriftPreparedStatements . values ( ) . iterator ( ) , ksName , cfName ) ; <nl> }
NEAREST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index c1de4cc . . c0e05b6 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 9 , 7 + 9 , 7 @ @ <nl> 1 . 0 . 3 <nl> * fix invalidate - related test failures ( CASSANDRA - 3437 ) <nl> * add next - gen cqlsh to bin / <nl> - * ( CQL ) fix handling of rows with no columns ( CASSANDRA - 3424 ) <nl> + * ( CQL ) fix handling of rows with no columns ( CASSANDRA - 3424 , 3473 ) <nl> Merged from 0 . 8 : <nl> * Make counter shard merging thread safe ( CASSANDRA - 3178 ) <nl> * fix updating CF row _ cache _ provider ( CASSANDRA - 3414 ) <nl> diff - - git a / src / java / org / apache / cassandra / cql / QueryProcessor . java b / src / java / org / apache / cassandra / cql / QueryProcessor . java <nl> index da17b2b . . ae48026 100644 <nl> - - - a / src / java / org / apache / cassandra / cql / QueryProcessor . java <nl> + + + b / src / java / org / apache / cassandra / cql / QueryProcessor . java <nl> @ @ - 624 , 6 + 624 , 9 @ @ public class QueryProcessor <nl> continue ; <nl> } <nl> <nl> + if ( row . cf = = null ) <nl> + continue ; <nl> + <nl> ByteBuffer name ; <nl> try <nl> {

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index a8f8b87 . . e3e19cf 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 1 , 4 + 1 , 6 @ @ 
 2 . 1 . 3 
 + * Purge internal prepared statements if related tables or 
 + keyspaces are dropped ( CASSANDRA - 8693 ) 
 * ( cqlsh ) Handle unicode BOM at start of files ( CASSANDRA - 8638 ) 
 * Stop compactions before exiting offline tools ( CASSANDRA - 8623 ) 
 * Update tools / stress / README . txt to match current behaviour ( CASSANDRA - 7933 ) 
 diff - - git a / src / java / org / apache / cassandra / cql3 / QueryProcessor . java b / src / java / org / apache / cassandra / cql3 / QueryProcessor . java 
 index e6e6f7d . . 3d33713 100644 
 - - - a / src / java / org / apache / cassandra / cql3 / QueryProcessor . java 
 + + + b / src / java / org / apache / cassandra / cql3 / QueryProcessor . java 
 @ @ - 563 , 6 + 563 , 7 @ @ public class QueryProcessor implements QueryHandler 
 { 
 private void removeInvalidPreparedStatements ( String ksName , String cfName ) 
 { 
 + removeInvalidPreparedStatements ( internalStatements . values ( ) . iterator ( ) , ksName , cfName ) ; 
 removeInvalidPreparedStatements ( preparedStatements . values ( ) . iterator ( ) , ksName , cfName ) ; 
 removeInvalidPreparedStatements ( thriftPreparedStatements . values ( ) . iterator ( ) , ksName , cfName ) ; 
 }

NEAREST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index c1de4cc . . c0e05b6 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 9 , 7 + 9 , 7 @ @ 
 1 . 0 . 3 
 * fix invalidate - related test failures ( CASSANDRA - 3437 ) 
 * add next - gen cqlsh to bin / 
 - * ( CQL ) fix handling of rows with no columns ( CASSANDRA - 3424 ) 
 + * ( CQL ) fix handling of rows with no columns ( CASSANDRA - 3424 , 3473 ) 
 Merged from 0 . 8 : 
 * Make counter shard merging thread safe ( CASSANDRA - 3178 ) 
 * fix updating CF row _ cache _ provider ( CASSANDRA - 3414 ) 
 diff - - git a / src / java / org / apache / cassandra / cql / QueryProcessor . java b / src / java / org / apache / cassandra / cql / QueryProcessor . java 
 index da17b2b . . ae48026 100644 
 - - - a / src / java / org / apache / cassandra / cql / QueryProcessor . java 
 + + + b / src / java / org / apache / cassandra / cql / QueryProcessor . java 
 @ @ - 624 , 6 + 624 , 9 @ @ public class QueryProcessor 
 continue ; 
 } 
 
 + if ( row . cf = = null ) 
 + continue ; 
 + 
 ByteBuffer name ; 
 try 
 {
