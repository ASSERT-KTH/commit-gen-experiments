BLEU SCORE: 0.031251907639724415

TEST MSG: Fix schema digest mismatch during rolling upgrades from versions before 3 . 0 . 13
GENERATED MSG: Fix startup problems due to schema tables not completely flushed

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index 6bdb283 . . c75ca87 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 1 , 4 + 1 , 5 @ @ <nl> 3 . 0 . 14 <nl> + * Fix schema digest mismatch during rolling upgrades from versions before 3 . 0 . 12 ( CASSANDRA - 13559 ) <nl> * Upgrade JNA version to 4 . 4 . 0 ( CASSANDRA - 13072 ) <nl> * Interned ColumnIdentifiers should use minimal ByteBuffers ( CASSANDRA - 13533 ) <nl> * ReverseIndexedReader may drop rows during 2 . 1 to 3 . 0 upgrade ( CASSANDRA - 13525 ) <nl> @ @ - 11 , 10 + 12 , 11 @ @ <nl> * Fail repair if insufficient responses received ( CASSANDRA - 13397 ) <nl> * Fix SSTableLoader fail when the loaded table contains dropped columns ( CASSANDRA - 13276 ) <nl> * Avoid name clashes in CassandraIndexTest ( CASSANDRA - 13427 ) <nl> - * Handling partially written hint files ( CASSANDRA - 12728 ) <nl> + * Handling partially written hint files ( CASSANDRA - 12728 ) <nl> * Interrupt replaying hints on decommission ( CASSANDRA - 13308 ) <nl> * Fix schema version calculation for rolling upgrades ( CASSANDRA - 13441 ) <nl> <nl> + <nl> 3 . 0 . 13 <nl> * Make reading of range tombstones more reliable ( CASSANDRA - 12811 ) <nl> * Fix startup problems due to schema tables not completely flushed ( CASSANDRA - 12213 ) <nl> @ @ - 50 , 6 + 52 , 7 @ @ Merged from 2 . 1 : <nl> * Fix 2ndary index queries on partition keys for tables with static columns CASSANDRA - 13147 <nl> * Fix ParseError unhashable type list in cqlsh copy from ( CASSANDRA - 13364 ) <nl> <nl> + <nl> 3 . 0 . 12 <nl> * Prevent data loss on upgrade 2 . 1 - 3 . 0 by adding component separator to LogRecord absolute path ( CASSANDRA - 13294 ) <nl> * Improve testing on macOS by eliminating sigar logging ( CASSANDRA - 13233 ) <nl> diff - - git a / src / java / org / apache / cassandra / schema / SchemaKeyspace . java b / src / java / org / apache / cassandra / schema / SchemaKeyspace . java <nl> index e860c59 . . 8719b2f 100644 <nl> - - - a / src / java / org / apache / cassandra / schema / SchemaKeyspace . java <nl> + + + b / src / java / org / apache / cassandra / schema / SchemaKeyspace . java <nl> @ @ - 97 , 6 + 97 , 13 @ @ public final class SchemaKeyspace <nl> public static final ImmutableList < String > ALL = <nl> ImmutableList . of ( COLUMNS , DROPPED _ COLUMNS , TRIGGERS , TYPES , FUNCTIONS , AGGREGATES , INDEXES , TABLES , VIEWS , KEYSPACES ) ; <nl> <nl> + / * * <nl> + * Until we upgrade the messaging service version , that is version 4 . 0 , we must preserve the old order ( before CASSANDRA - 12213 ) <nl> + * for digest calculations , otherwise the nodes will never agree on the schema during a rolling upgrade , see CASSANDRA - 13559 . <nl> + * / <nl> + public static final ImmutableList < String > ALL _ FOR _ DIGEST = <nl> + ImmutableList . of ( KEYSPACES , TABLES , COLUMNS , DROPPED _ COLUMNS , TRIGGERS , VIEWS , TYPES , FUNCTIONS , AGGREGATES , INDEXES ) ; <nl> + <nl> private static final CFMetaData Keyspaces = <nl> compile ( KEYSPACES , <nl> " keyspace definitions " , <nl> @ @ - 308 , 7 + 315 , 7 @ @ public final class SchemaKeyspace <nl> throw new RuntimeException ( e ) ; <nl> } <nl> <nl> - for ( String table : ALL ) <nl> + for ( String table : ALL _ FOR _ DIGEST ) <nl> { <nl> / / Due to CASSANDRA - 11050 we want to exclude DROPPED _ COLUMNS for schema digest computation . We can and <nl> / / should remove that in the next major release ( so C * 4 . 0 ) .
NEAREST DIFF (one line): ELIMINATEDSENTENCE

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index 6bdb283 . . c75ca87 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 1 , 4 + 1 , 5 @ @ 
 3 . 0 . 14 
 + * Fix schema digest mismatch during rolling upgrades from versions before 3 . 0 . 12 ( CASSANDRA - 13559 ) 
 * Upgrade JNA version to 4 . 4 . 0 ( CASSANDRA - 13072 ) 
 * Interned ColumnIdentifiers should use minimal ByteBuffers ( CASSANDRA - 13533 ) 
 * ReverseIndexedReader may drop rows during 2 . 1 to 3 . 0 upgrade ( CASSANDRA - 13525 ) 
 @ @ - 11 , 10 + 12 , 11 @ @ 
 * Fail repair if insufficient responses received ( CASSANDRA - 13397 ) 
 * Fix SSTableLoader fail when the loaded table contains dropped columns ( CASSANDRA - 13276 ) 
 * Avoid name clashes in CassandraIndexTest ( CASSANDRA - 13427 ) 
 - * Handling partially written hint files ( CASSANDRA - 12728 ) 
 + * Handling partially written hint files ( CASSANDRA - 12728 ) 
 * Interrupt replaying hints on decommission ( CASSANDRA - 13308 ) 
 * Fix schema version calculation for rolling upgrades ( CASSANDRA - 13441 ) 
 
 + 
 3 . 0 . 13 
 * Make reading of range tombstones more reliable ( CASSANDRA - 12811 ) 
 * Fix startup problems due to schema tables not completely flushed ( CASSANDRA - 12213 ) 
 @ @ - 50 , 6 + 52 , 7 @ @ Merged from 2 . 1 : 
 * Fix 2ndary index queries on partition keys for tables with static columns CASSANDRA - 13147 
 * Fix ParseError unhashable type list in cqlsh copy from ( CASSANDRA - 13364 ) 
 
 + 
 3 . 0 . 12 
 * Prevent data loss on upgrade 2 . 1 - 3 . 0 by adding component separator to LogRecord absolute path ( CASSANDRA - 13294 ) 
 * Improve testing on macOS by eliminating sigar logging ( CASSANDRA - 13233 ) 
 diff - - git a / src / java / org / apache / cassandra / schema / SchemaKeyspace . java b / src / java / org / apache / cassandra / schema / SchemaKeyspace . java 
 index e860c59 . . 8719b2f 100644 
 - - - a / src / java / org / apache / cassandra / schema / SchemaKeyspace . java 
 + + + b / src / java / org / apache / cassandra / schema / SchemaKeyspace . java 
 @ @ - 97 , 6 + 97 , 13 @ @ public final class SchemaKeyspace 
 public static final ImmutableList < String > ALL = 
 ImmutableList . of ( COLUMNS , DROPPED _ COLUMNS , TRIGGERS , TYPES , FUNCTIONS , AGGREGATES , INDEXES , TABLES , VIEWS , KEYSPACES ) ; 
 
 + / * * 
 + * Until we upgrade the messaging service version , that is version 4 . 0 , we must preserve the old order ( before CASSANDRA - 12213 ) 
 + * for digest calculations , otherwise the nodes will never agree on the schema during a rolling upgrade , see CASSANDRA - 13559 . 
 + * / 
 + public static final ImmutableList < String > ALL _ FOR _ DIGEST = 
 + ImmutableList . of ( KEYSPACES , TABLES , COLUMNS , DROPPED _ COLUMNS , TRIGGERS , VIEWS , TYPES , FUNCTIONS , AGGREGATES , INDEXES ) ; 
 + 
 private static final CFMetaData Keyspaces = 
 compile ( KEYSPACES , 
 " keyspace definitions " , 
 @ @ - 308 , 7 + 315 , 7 @ @ public final class SchemaKeyspace 
 throw new RuntimeException ( e ) ; 
 } 
 
 - for ( String table : ALL ) 
 + for ( String table : ALL _ FOR _ DIGEST ) 
 { 
 / / Due to CASSANDRA - 11050 we want to exclude DROPPED _ COLUMNS for schema digest computation . We can and 
 / / should remove that in the next major release ( so C * 4 . 0 ) .

NEAREST DIFF:
ELIMINATEDSENTENCE
