BLEU SCORE: 0.027611988917697356

TEST MSG: fix minor bugs related to CASSANDRA - 9143
GENERATED MSG: Backport leveled integrity check from trunk

TEST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / db / compaction / CompactionStrategyManager . java b / src / java / org / apache / cassandra / db / compaction / CompactionStrategyManager . java <nl> index 0ccdb49 . . 9397708 100644 <nl> - - - a / src / java / org / apache / cassandra / db / compaction / CompactionStrategyManager . java <nl> + + + b / src / java / org / apache / cassandra / db / compaction / CompactionStrategyManager . java <nl> @ @ - 840 , 14 + 840 , 15 @ @ public class CompactionStrategyManager implements INotificationConsumer <nl> boolean repaired = firstSSTable . isRepaired ( ) ; <nl> int firstIndex = getCompactionStrategyIndex ( cfs , directories , firstSSTable ) ; <nl> boolean isPending = firstSSTable . isPendingRepair ( ) ; <nl> + UUID pendingRepair = firstSSTable . getSSTableMetadata ( ) . pendingRepair ; <nl> for ( SSTableReader sstable : input ) <nl> { <nl> if ( sstable . isRepaired ( ) ! = repaired ) <nl> throw new UnsupportedOperationException ( " You can ' t mix repaired and unrepaired data in a compaction " ) ; <nl> if ( firstIndex ! = getCompactionStrategyIndex ( cfs , directories , sstable ) ) <nl> throw new UnsupportedOperationException ( " You can ' t mix sstables from different directories in a compaction " ) ; <nl> - if ( isPending ! = sstable . isPendingRepair ( ) ) <nl> - throw new UnsupportedOperationException ( " You can ' t compact sstables pending for repair with non - pending ones " ) ; <nl> + if ( isPending & & ! pendingRepair . equals ( sstable . getSSTableMetadata ( ) . pendingRepair ) ) <nl> + throw new UnsupportedOperationException ( " You can ' t compact sstables from different pending repair sessions " ) ; <nl> } <nl> } <nl> <nl> diff - - git a / src / java / org / apache / cassandra / io / sstable / format / SSTableReader . java b / src / java / org / apache / cassandra / io / sstable / format / SSTableReader . java <nl> index 716b27d . . f9f6f5f 100644 <nl> - - - a / src / java / org / apache / cassandra / io / sstable / format / SSTableReader . java <nl> + + + b / src / java / org / apache / cassandra / io / sstable / format / SSTableReader . java <nl> @ @ - 50 , 6 + 50 , 7 @ @ import org . apache . cassandra . db . filter . ColumnFilter ; <nl> import org . apache . cassandra . db . rows . EncodingStats ; <nl> import org . apache . cassandra . db . rows . UnfilteredRowIterator ; <nl> import org . apache . cassandra . dht . AbstractBounds ; <nl> + import org . apache . cassandra . dht . Bounds ; <nl> import org . apache . cassandra . dht . Range ; <nl> import org . apache . cassandra . dht . Token ; <nl> import org . apache . cassandra . io . FSError ; <nl> @ @ - 1758 , 7 + 1759 , 7 @ @ public abstract class SSTableReader extends SSTable implements SelfRefCounted < SS <nl> <nl> public boolean intersects ( Collection < Range < Token > > ranges ) <nl> { <nl> - Range < Token > range = new Range < > ( first . getToken ( ) , last . getToken ( ) ) ; <nl> + Bounds < Token > range = new Bounds < > ( first . getToken ( ) , last . getToken ( ) ) ; <nl> return Iterables . any ( ranges , r - > r . intersects ( range ) ) ; <nl> } <nl>
NEAREST DIFF (one line): diff - - git a / doc / cql3 / CQL . textile b / doc / cql3 / CQL . textile <nl> index fdc158a . . 2255e0b 100644 <nl> - - - a / doc / cql3 / CQL . textile <nl> + + + b / doc / cql3 / CQL . textile <nl> @ @ - 52 , 7 + 52 , 7 @ @ h3 ( # constants ) . Constants <nl> CQL defines 3 kinds of _ implicitly - typed constants _ : strings , numbers and uuids : <nl> * A string constant is an arbitrary sequence of characters characters enclosed by single - quote ( @ ' @ ) . One can include a single - quote in a string by repeating it , e . g . @ ' It ' ' s raining today ' @ . Those are not to be confused with quoted identifiers that use double - quotes . <nl> * Numeric constants are either integer constant defined by @ - ? [ 0 - 9 ] + @ or a float constant defined by @ - ? [ 0 - 9 ] + . [ 0 - 9 ] * @ . <nl> - * A " UUID " : http : / / en . wikipedia . org / wiki / Universally _ unique _ identifier constant is defined by @ hex { 8 } - hex { 4 } - hex { 4 } - hex { 12 } @ where @ hex @ is an hexadecimal character , e . g . @ [ 0 - 9a - fA - F ] @ and @ { 4 } @ is the number of such characters . <nl> + * A " UUID " : http : / / en . wikipedia . org / wiki / Universally _ unique _ identifier constant is defined by @ hex { 8 } - hex { 4 } - hex { 4 } - hex { 4 } - hex { 12 } @ where @ hex @ is an hexadecimal character , e . g . @ [ 0 - 9a - fA - F ] @ and @ { 4 } @ is the number of such characters . <nl> <nl> <nl> h3 . Comments

TEST DIFF:
diff - - git a / src / java / org / apache / cassandra / db / compaction / CompactionStrategyManager . java b / src / java / org / apache / cassandra / db / compaction / CompactionStrategyManager . java 
 index 0ccdb49 . . 9397708 100644 
 - - - a / src / java / org / apache / cassandra / db / compaction / CompactionStrategyManager . java 
 + + + b / src / java / org / apache / cassandra / db / compaction / CompactionStrategyManager . java 
 @ @ - 840 , 14 + 840 , 15 @ @ public class CompactionStrategyManager implements INotificationConsumer 
 boolean repaired = firstSSTable . isRepaired ( ) ; 
 int firstIndex = getCompactionStrategyIndex ( cfs , directories , firstSSTable ) ; 
 boolean isPending = firstSSTable . isPendingRepair ( ) ; 
 + UUID pendingRepair = firstSSTable . getSSTableMetadata ( ) . pendingRepair ; 
 for ( SSTableReader sstable : input ) 
 { 
 if ( sstable . isRepaired ( ) ! = repaired ) 
 throw new UnsupportedOperationException ( " You can ' t mix repaired and unrepaired data in a compaction " ) ; 
 if ( firstIndex ! = getCompactionStrategyIndex ( cfs , directories , sstable ) ) 
 throw new UnsupportedOperationException ( " You can ' t mix sstables from different directories in a compaction " ) ; 
 - if ( isPending ! = sstable . isPendingRepair ( ) ) 
 - throw new UnsupportedOperationException ( " You can ' t compact sstables pending for repair with non - pending ones " ) ; 
 + if ( isPending & & ! pendingRepair . equals ( sstable . getSSTableMetadata ( ) . pendingRepair ) ) 
 + throw new UnsupportedOperationException ( " You can ' t compact sstables from different pending repair sessions " ) ; 
 } 
 } 
 
 diff - - git a / src / java / org / apache / cassandra / io / sstable / format / SSTableReader . java b / src / java / org / apache / cassandra / io / sstable / format / SSTableReader . java 
 index 716b27d . . f9f6f5f 100644 
 - - - a / src / java / org / apache / cassandra / io / sstable / format / SSTableReader . java 
 + + + b / src / java / org / apache / cassandra / io / sstable / format / SSTableReader . java 
 @ @ - 50 , 6 + 50 , 7 @ @ import org . apache . cassandra . db . filter . ColumnFilter ; 
 import org . apache . cassandra . db . rows . EncodingStats ; 
 import org . apache . cassandra . db . rows . UnfilteredRowIterator ; 
 import org . apache . cassandra . dht . AbstractBounds ; 
 + import org . apache . cassandra . dht . Bounds ; 
 import org . apache . cassandra . dht . Range ; 
 import org . apache . cassandra . dht . Token ; 
 import org . apache . cassandra . io . FSError ; 
 @ @ - 1758 , 7 + 1759 , 7 @ @ public abstract class SSTableReader extends SSTable implements SelfRefCounted < SS 
 
 public boolean intersects ( Collection < Range < Token > > ranges ) 
 { 
 - Range < Token > range = new Range < > ( first . getToken ( ) , last . getToken ( ) ) ; 
 + Bounds < Token > range = new Bounds < > ( first . getToken ( ) , last . getToken ( ) ) ; 
 return Iterables . any ( ranges , r - > r . intersects ( range ) ) ; 
 } 


NEAREST DIFF:
diff - - git a / doc / cql3 / CQL . textile b / doc / cql3 / CQL . textile 
 index fdc158a . . 2255e0b 100644 
 - - - a / doc / cql3 / CQL . textile 
 + + + b / doc / cql3 / CQL . textile 
 @ @ - 52 , 7 + 52 , 7 @ @ h3 ( # constants ) . Constants 
 CQL defines 3 kinds of _ implicitly - typed constants _ : strings , numbers and uuids : 
 * A string constant is an arbitrary sequence of characters characters enclosed by single - quote ( @ ' @ ) . One can include a single - quote in a string by repeating it , e . g . @ ' It ' ' s raining today ' @ . Those are not to be confused with quoted identifiers that use double - quotes . 
 * Numeric constants are either integer constant defined by @ - ? [ 0 - 9 ] + @ or a float constant defined by @ - ? [ 0 - 9 ] + . [ 0 - 9 ] * @ . 
 - * A " UUID " : http : / / en . wikipedia . org / wiki / Universally _ unique _ identifier constant is defined by @ hex { 8 } - hex { 4 } - hex { 4 } - hex { 12 } @ where @ hex @ is an hexadecimal character , e . g . @ [ 0 - 9a - fA - F ] @ and @ { 4 } @ is the number of such characters . 
 + * A " UUID " : http : / / en . wikipedia . org / wiki / Universally _ unique _ identifier constant is defined by @ hex { 8 } - hex { 4 } - hex { 4 } - hex { 4 } - hex { 12 } @ where @ hex @ is an hexadecimal character , e . g . @ [ 0 - 9a - fA - F ] @ and @ { 4 } @ is the number of such characters . 
 
 
 h3 . Comments
