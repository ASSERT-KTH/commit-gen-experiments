BLEU SCORE: 0.04027248192421852

TEST MSG: Fix test / system / test _ thrift _ server . py
GENERATED MSG: fix system test

TEST DIFF (one line): diff - - git a / test / system / test _ thrift _ server . py b / test / system / test _ thrift _ server . py <nl> index dbbc1bf . . 7655958 100644 <nl> - - - a / test / system / test _ thrift _ server . py <nl> + + + b / test / system / test _ thrift _ server . py <nl> @ @ - 1222 , 7 + 1222 , 7 @ @ class TestMutations ( ThriftTester ) : <nl> <nl> def test _ describe _ keyspace ( self ) : <nl> kspaces = client . describe _ keyspaces ( ) <nl> - assert len ( kspaces ) = = 5 , kspaces # [ ' Keyspace2 ' , ' Keyspace1 ' , ' system ' , ' system _ traces ' , ' system _ auth ' ] <nl> + assert len ( kspaces ) = = 4 , kspaces # [ ' Keyspace2 ' , ' Keyspace1 ' , ' system ' , ' system _ traces ' ] <nl> <nl> sysks = client . describe _ keyspace ( " system " ) <nl> assert sysks in kspaces
NEAREST DIFF (one line): diff - - git a / test / unit / org / apache / cassandra / db / context / CounterContextTest . java b / test / unit / org / apache / cassandra / db / context / CounterContextTest . java <nl> index bd1cef1 . . e5617d2 100644 <nl> - - - a / test / unit / org / apache / cassandra / db / context / CounterContextTest . java <nl> + + + b / test / unit / org / apache / cassandra / db / context / CounterContextTest . java <nl> @ @ - 385 , 12 + 385 , 6 @ @ public class CounterContextTest <nl> @ Test <nl> public void testRemoveOldShardsNotAllExpiring ( ) <nl> { <nl> - runRemoveOldShardsNotAllExpiring ( HeapAllocator . instance ) ; <nl> - runRemoveOldShardsNotAllExpiring ( bumpedSlab ( ) ) ; <nl> - } <nl> - <nl> - private void runRemoveOldShardsNotAllExpiring ( Allocator allocator ) <nl> - { <nl> NodeId id1 = NodeId . fromInt ( 1 ) ; <nl> NodeId id3 = NodeId . fromInt ( 3 ) ; <nl> NodeId id6 = NodeId . fromInt ( 6 ) ; <nl> @ @ - 399 , 7 + 393 , 7 @ @ public class CounterContextTest <nl> records . add ( new NodeId . NodeIdRecord ( id3 , 4L ) ) ; <nl> records . add ( new NodeId . NodeIdRecord ( id6 , 10L ) ) ; <nl> <nl> - ContextState ctx = ContextState . allocate ( 6 , 3 , allocator ) ; <nl> + ContextState ctx = ContextState . allocate ( 6 , 3 ) ; <nl> ctx . writeElement ( id1 , 0L , 1L , true ) ; <nl> ctx . writeElement ( NodeId . fromInt ( 2 ) , 0L , 2L ) ; <nl> ctx . writeElement ( id3 , 0L , 3L , true ) ; <nl> @ @ - 411 , 7 + 405 , 7 @ @ public class CounterContextTest <nl> <nl> / / First , only merge the first id <nl> ByteBuffer merger = cc . computeOldShardMerger ( ctx . context , records , 3L ) ; <nl> - ByteBuffer merged = cc . merge ( ctx . context , merger , allocator ) ; <nl> + ByteBuffer merged = cc . merge ( ctx . context , merger ) ; <nl> assert cc . total ( ctx . context ) = = cc . total ( merged ) ; <nl> <nl> try <nl> @ @ - 425 , 7 + 419 , 7 @ @ public class CounterContextTest <nl> <nl> / / merge the second one <nl> ByteBuffer merger2 = cc . computeOldShardMerger ( merged , records , 7L ) ; <nl> - ByteBuffer merged2 = cc . merge ( merged , merger2 , allocator ) ; <nl> + ByteBuffer merged2 = cc . merge ( merged , merger2 ) ; <nl> assert cc . total ( ctx . context ) = = cc . total ( merged2 ) ; <nl> <nl> ByteBuffer cleaned = cc . removeOldShards ( merged2 , timeFirstMerge + 1 ) ; <nl> @ @ - 442 , 13 + 436 , 7 @ @ public class CounterContextTest <nl> @ Test <nl> public void testRemoveNotDeltaOldShards ( ) <nl> { <nl> - runRemoveNotDeltaOldShards ( HeapAllocator . instance ) ; <nl> - runRemoveNotDeltaOldShards ( bumpedSlab ( ) ) ; <nl> - } <nl> - <nl> - private void runRemoveNotDeltaOldShards ( Allocator allocator ) <nl> - { <nl> - ContextState ctx = ContextState . allocate ( 4 , 1 , allocator ) ; <nl> + ContextState ctx = ContextState . allocate ( 4 , 1 ) ; <nl> ctx . writeElement ( NodeId . fromInt ( 1 ) , 1L , 1L , true ) ; <nl> ctx . writeElement ( NodeId . fromInt ( 2 ) , - System . currentTimeMillis ( ) , 0L ) ; <nl> ctx . writeElement ( NodeId . fromInt ( 3 ) , - System . currentTimeMillis ( ) , 0L ) ;

TEST DIFF:
diff - - git a / test / system / test _ thrift _ server . py b / test / system / test _ thrift _ server . py 
 index dbbc1bf . . 7655958 100644 
 - - - a / test / system / test _ thrift _ server . py 
 + + + b / test / system / test _ thrift _ server . py 
 @ @ - 1222 , 7 + 1222 , 7 @ @ class TestMutations ( ThriftTester ) : 
 
 def test _ describe _ keyspace ( self ) : 
 kspaces = client . describe _ keyspaces ( ) 
 - assert len ( kspaces ) = = 5 , kspaces # [ ' Keyspace2 ' , ' Keyspace1 ' , ' system ' , ' system _ traces ' , ' system _ auth ' ] 
 + assert len ( kspaces ) = = 4 , kspaces # [ ' Keyspace2 ' , ' Keyspace1 ' , ' system ' , ' system _ traces ' ] 
 
 sysks = client . describe _ keyspace ( " system " ) 
 assert sysks in kspaces

NEAREST DIFF:
diff - - git a / test / unit / org / apache / cassandra / db / context / CounterContextTest . java b / test / unit / org / apache / cassandra / db / context / CounterContextTest . java 
 index bd1cef1 . . e5617d2 100644 
 - - - a / test / unit / org / apache / cassandra / db / context / CounterContextTest . java 
 + + + b / test / unit / org / apache / cassandra / db / context / CounterContextTest . java 
 @ @ - 385 , 12 + 385 , 6 @ @ public class CounterContextTest 
 @ Test 
 public void testRemoveOldShardsNotAllExpiring ( ) 
 { 
 - runRemoveOldShardsNotAllExpiring ( HeapAllocator . instance ) ; 
 - runRemoveOldShardsNotAllExpiring ( bumpedSlab ( ) ) ; 
 - } 
 - 
 - private void runRemoveOldShardsNotAllExpiring ( Allocator allocator ) 
 - { 
 NodeId id1 = NodeId . fromInt ( 1 ) ; 
 NodeId id3 = NodeId . fromInt ( 3 ) ; 
 NodeId id6 = NodeId . fromInt ( 6 ) ; 
 @ @ - 399 , 7 + 393 , 7 @ @ public class CounterContextTest 
 records . add ( new NodeId . NodeIdRecord ( id3 , 4L ) ) ; 
 records . add ( new NodeId . NodeIdRecord ( id6 , 10L ) ) ; 
 
 - ContextState ctx = ContextState . allocate ( 6 , 3 , allocator ) ; 
 + ContextState ctx = ContextState . allocate ( 6 , 3 ) ; 
 ctx . writeElement ( id1 , 0L , 1L , true ) ; 
 ctx . writeElement ( NodeId . fromInt ( 2 ) , 0L , 2L ) ; 
 ctx . writeElement ( id3 , 0L , 3L , true ) ; 
 @ @ - 411 , 7 + 405 , 7 @ @ public class CounterContextTest 
 
 / / First , only merge the first id 
 ByteBuffer merger = cc . computeOldShardMerger ( ctx . context , records , 3L ) ; 
 - ByteBuffer merged = cc . merge ( ctx . context , merger , allocator ) ; 
 + ByteBuffer merged = cc . merge ( ctx . context , merger ) ; 
 assert cc . total ( ctx . context ) = = cc . total ( merged ) ; 
 
 try 
 @ @ - 425 , 7 + 419 , 7 @ @ public class CounterContextTest 
 
 / / merge the second one 
 ByteBuffer merger2 = cc . computeOldShardMerger ( merged , records , 7L ) ; 
 - ByteBuffer merged2 = cc . merge ( merged , merger2 , allocator ) ; 
 + ByteBuffer merged2 = cc . merge ( merged , merger2 ) ; 
 assert cc . total ( ctx . context ) = = cc . total ( merged2 ) ; 
 
 ByteBuffer cleaned = cc . removeOldShards ( merged2 , timeFirstMerge + 1 ) ; 
 @ @ - 442 , 13 + 436 , 7 @ @ public class CounterContextTest 
 @ Test 
 public void testRemoveNotDeltaOldShards ( ) 
 { 
 - runRemoveNotDeltaOldShards ( HeapAllocator . instance ) ; 
 - runRemoveNotDeltaOldShards ( bumpedSlab ( ) ) ; 
 - } 
 - 
 - private void runRemoveNotDeltaOldShards ( Allocator allocator ) 
 - { 
 - ContextState ctx = ContextState . allocate ( 4 , 1 , allocator ) ; 
 + ContextState ctx = ContextState . allocate ( 4 , 1 ) ; 
 ctx . writeElement ( NodeId . fromInt ( 1 ) , 1L , 1L , true ) ; 
 ctx . writeElement ( NodeId . fromInt ( 2 ) , - System . currentTimeMillis ( ) , 0L ) ; 
 ctx . writeElement ( NodeId . fromInt ( 3 ) , - System . currentTimeMillis ( ) , 0L ) ;
