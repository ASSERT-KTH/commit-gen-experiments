BLEU SCORE: 0.018543295278285157

TEST MSG: Allow compaction of system tables during startup
GENERATED MSG: Expose whether jna is enabled and memory is locked via JMX

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index 3a08c33 . . d999e88 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 1 , 4 + 1 , 5 @ @ <nl> 2 . 0 . 7 <nl> + * Allow compaction of system tables during startup ( CASSANDRA - 6913 ) <nl> * Don ' t shut ExpiringMap down ( CASSANDRA - 6948 ) <nl> * Restrict Windows to parallel repairs ( CASSANDRA - 6907 ) <nl> * ( Hadoop ) Allow manually specifying start / end tokens in CFIF ( CASSANDRA - 6436 ) <nl> diff - - git a / src / java / org / apache / cassandra / service / StorageService . java b / src / java / org / apache / cassandra / service / StorageService . java <nl> index 6b70987 . . 53bbb77 100644 <nl> - - - a / src / java / org / apache / cassandra / service / StorageService . java <nl> + + + b / src / java / org / apache / cassandra / service / StorageService . java <nl> @ @ - 34 , 8 + 34 , 6 @ @ import javax . management . Notification ; <nl> import javax . management . NotificationBroadcasterSupport ; <nl> import javax . management . ObjectName ; <nl> <nl> - import static java . nio . charset . StandardCharsets . ISO _ 8859 _ 1 ; <nl> - <nl> import com . google . common . annotations . VisibleForTesting ; <nl> import com . google . common . base . Predicate ; <nl> import com . google . common . collect . * ; <nl> @ @ - 88 , 6 + 86 , 8 @ @ import org . apache . cassandra . thrift . cassandraConstants ; <nl> import org . apache . cassandra . tracing . Tracing ; <nl> import org . apache . cassandra . utils . * ; <nl> <nl> + import static java . nio . charset . StandardCharsets . ISO _ 8859 _ 1 ; <nl> + <nl> / * * <nl> * This abstraction contains the token / identifier of this node <nl> * on the identifier space . This token gets gossiped around . <nl> @ @ - 2048 , 7 + 2048 , 9 @ @ public class StorageService extends NotificationBroadcasterSupport implements IE <nl> double bytes = 0 ; <nl> for ( String keyspaceName : Schema . instance . getKeyspaces ( ) ) <nl> { <nl> - Keyspace keyspace = Keyspace . open ( keyspaceName ) ; <nl> + Keyspace keyspace = Schema . instance . getKeyspaceInstance ( keyspaceName ) ; <nl> + if ( keyspace = = null ) <nl> + continue ; <nl> for ( ColumnFamilyStore cfs : keyspace . getColumnFamilyStores ( ) ) <nl> bytes + = cfs . getLiveDiskSpaceUsed ( ) ; <nl> }
NEAREST DIFF (one line): diff - - git a / src / java / org / apache / cassandra / service / NativeAccessMBean . java b / src / java / org / apache / cassandra / service / NativeAccessMBean . java <nl> new file mode 100644 <nl> index 0000000 . . 39b96c5 <nl> - - - / dev / null <nl> + + + b / src / java / org / apache / cassandra / service / NativeAccessMBean . java <nl> @ @ - 0 , 0 + 1 , 9 @ @ <nl> + package org . apache . cassandra . service ; <nl> + <nl> + public interface NativeAccessMBean <nl> + { <nl> + boolean isAvailable ( ) ; <nl> + <nl> + boolean isMemoryLockable ( ) ; <nl> + } <nl> +

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index 3a08c33 . . d999e88 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 1 , 4 + 1 , 5 @ @ 
 2 . 0 . 7 
 + * Allow compaction of system tables during startup ( CASSANDRA - 6913 ) 
 * Don ' t shut ExpiringMap down ( CASSANDRA - 6948 ) 
 * Restrict Windows to parallel repairs ( CASSANDRA - 6907 ) 
 * ( Hadoop ) Allow manually specifying start / end tokens in CFIF ( CASSANDRA - 6436 ) 
 diff - - git a / src / java / org / apache / cassandra / service / StorageService . java b / src / java / org / apache / cassandra / service / StorageService . java 
 index 6b70987 . . 53bbb77 100644 
 - - - a / src / java / org / apache / cassandra / service / StorageService . java 
 + + + b / src / java / org / apache / cassandra / service / StorageService . java 
 @ @ - 34 , 8 + 34 , 6 @ @ import javax . management . Notification ; 
 import javax . management . NotificationBroadcasterSupport ; 
 import javax . management . ObjectName ; 
 
 - import static java . nio . charset . StandardCharsets . ISO _ 8859 _ 1 ; 
 - 
 import com . google . common . annotations . VisibleForTesting ; 
 import com . google . common . base . Predicate ; 
 import com . google . common . collect . * ; 
 @ @ - 88 , 6 + 86 , 8 @ @ import org . apache . cassandra . thrift . cassandraConstants ; 
 import org . apache . cassandra . tracing . Tracing ; 
 import org . apache . cassandra . utils . * ; 
 
 + import static java . nio . charset . StandardCharsets . ISO _ 8859 _ 1 ; 
 + 
 / * * 
 * This abstraction contains the token / identifier of this node 
 * on the identifier space . This token gets gossiped around . 
 @ @ - 2048 , 7 + 2048 , 9 @ @ public class StorageService extends NotificationBroadcasterSupport implements IE 
 double bytes = 0 ; 
 for ( String keyspaceName : Schema . instance . getKeyspaces ( ) ) 
 { 
 - Keyspace keyspace = Keyspace . open ( keyspaceName ) ; 
 + Keyspace keyspace = Schema . instance . getKeyspaceInstance ( keyspaceName ) ; 
 + if ( keyspace = = null ) 
 + continue ; 
 for ( ColumnFamilyStore cfs : keyspace . getColumnFamilyStores ( ) ) 
 bytes + = cfs . getLiveDiskSpaceUsed ( ) ; 
 }

NEAREST DIFF:
diff - - git a / src / java / org / apache / cassandra / service / NativeAccessMBean . java b / src / java / org / apache / cassandra / service / NativeAccessMBean . java 
 new file mode 100644 
 index 0000000 . . 39b96c5 
 - - - / dev / null 
 + + + b / src / java / org / apache / cassandra / service / NativeAccessMBean . java 
 @ @ - 0 , 0 + 1 , 9 @ @ 
 + package org . apache . cassandra . service ; 
 + 
 + public interface NativeAccessMBean 
 + { 
 + boolean isAvailable ( ) ; 
 + 
 + boolean isMemoryLockable ( ) ; 
 + } 
 +
