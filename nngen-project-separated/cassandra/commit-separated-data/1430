BLEU SCORE: 0.041961149062965476

TEST MSG: Fix nodetool info error when the node is not joined
GENERATED MSG: Add nodetool taketoken to relocate vnodes .

TEST DIFF (one line): diff - - git a / CHANGES . txt b / CHANGES . txt <nl> index de7cfa8 . . 9a475ea 100644 <nl> - - - a / CHANGES . txt <nl> + + + b / CHANGES . txt <nl> @ @ - 12 , 6 + 12 , 7 @ @ <nl> * Remove repair snapshot leftover on startup ( CASSANDRA - 7357 ) <nl> * Use random nodes for batch log when only 2 racks ( CASSANDRA - 8735 ) <nl> * Ensure atomicity inside thrift and stream session ( CASSANDRA - 7757 ) <nl> + * Fix nodetool info error when the node is not joined ( CASSANDRA - 9031 ) <nl> Merged from 2 . 0 : <nl> * Don ' t cast expected bf size to an int ( CASSANDRA - 9959 ) <nl> * Log when messages are dropped due to cross _ node _ timeout ( CASSANDRA - 9793 ) <nl> diff - - git a / src / java / org / apache / cassandra / tools / NodeProbe . java b / src / java / org / apache / cassandra / tools / NodeProbe . java <nl> index d3bce4d . . caa12c3 100644 <nl> - - - a / src / java / org / apache / cassandra / tools / NodeProbe . java <nl> + + + b / src / java / org / apache / cassandra / tools / NodeProbe . java <nl> @ @ - 807 , 20 + 807 , 8 @ @ public class NodeProbe implements AutoCloseable <nl> <nl> public String getEndpoint ( ) <nl> { <nl> - / / Try to find the endpoint using the local token , doing so in a crazy manner <nl> - / / to maintain backwards compatibility with the MBean interface <nl> - String stringToken = ssProxy . getTokens ( ) . get ( 0 ) ; <nl> - Map < String , String > tokenToEndpoint = ssProxy . getTokenToEndpointMap ( ) ; <nl> - <nl> - for ( Map . Entry < String , String > pair : tokenToEndpoint . entrySet ( ) ) <nl> - { <nl> - if ( pair . getKey ( ) . equals ( stringToken ) ) <nl> - { <nl> - return pair . getValue ( ) ; <nl> - } <nl> - } <nl> - <nl> - throw new RuntimeException ( " Could not find myself in the endpoint list , something is very wrong ! Is the Cassandra node fully started ? " ) ; <nl> + Map < String , String > hostIdToEndpoint = ssProxy . getHostIdMap ( ) ; <nl> + return hostIdToEndpoint . get ( ssProxy . getLocalHostId ( ) ) ; <nl> } <nl> <nl> public String getDataCenter ( ) <nl> diff - - git a / src / java / org / apache / cassandra / tools / NodeTool . java b / src / java / org / apache / cassandra / tools / NodeTool . java <nl> index a2d4ead . . 6a7a930 100644 <nl> - - - a / src / java / org / apache / cassandra / tools / NodeTool . java <nl> + + + b / src / java / org / apache / cassandra / tools / NodeTool . java <nl> @ @ - 463 , 13 + 463 , 22 @ @ public class NodeTool <nl> probe . getCacheMetric ( " CounterCache " , " HitRate " ) , <nl> cacheService . getCounterCacheSavePeriodInSeconds ( ) ) ; <nl> <nl> - / / Tokens <nl> - List < String > tokens = probe . getTokens ( ) ; <nl> - if ( tokens . size ( ) = = 1 | | this . tokens ) <nl> - for ( String token : tokens ) <nl> - System . out . printf ( " % - 23s : % s % n " , " Token " , token ) ; <nl> + / / check if node is already joined , before getting tokens , since it throws exception if not . <nl> + if ( probe . isJoined ( ) ) <nl> + { <nl> + / / Tokens <nl> + List < String > tokens = probe . getTokens ( ) ; <nl> + if ( tokens . size ( ) = = 1 | | this . tokens ) <nl> + for ( String token : tokens ) <nl> + System . out . printf ( " % - 23s : % s % n " , " Token " , token ) ; <nl> + else <nl> + System . out . printf ( " % - 23s : ( invoke with - T / - - tokens to see all % d tokens ) % n " , " Token " , <nl> + tokens . size ( ) ) ; <nl> + } <nl> else <nl> - System . out . printf ( " % - 23s : ( invoke with - T / - - tokens to see all % d tokens ) % n " , " Token " , tokens . size ( ) ) ; <nl> + { <nl> + System . out . printf ( " % - 23s : ( node is not joined to the cluster ) % n " , " Token " ) ; <nl> + } <nl> } <nl> <nl> / * *
NEAREST DIFF (one line): ELIMINATEDSENTENCE

TEST DIFF:
diff - - git a / CHANGES . txt b / CHANGES . txt 
 index de7cfa8 . . 9a475ea 100644 
 - - - a / CHANGES . txt 
 + + + b / CHANGES . txt 
 @ @ - 12 , 6 + 12 , 7 @ @ 
 * Remove repair snapshot leftover on startup ( CASSANDRA - 7357 ) 
 * Use random nodes for batch log when only 2 racks ( CASSANDRA - 8735 ) 
 * Ensure atomicity inside thrift and stream session ( CASSANDRA - 7757 ) 
 + * Fix nodetool info error when the node is not joined ( CASSANDRA - 9031 ) 
 Merged from 2 . 0 : 
 * Don ' t cast expected bf size to an int ( CASSANDRA - 9959 ) 
 * Log when messages are dropped due to cross _ node _ timeout ( CASSANDRA - 9793 ) 
 diff - - git a / src / java / org / apache / cassandra / tools / NodeProbe . java b / src / java / org / apache / cassandra / tools / NodeProbe . java 
 index d3bce4d . . caa12c3 100644 
 - - - a / src / java / org / apache / cassandra / tools / NodeProbe . java 
 + + + b / src / java / org / apache / cassandra / tools / NodeProbe . java 
 @ @ - 807 , 20 + 807 , 8 @ @ public class NodeProbe implements AutoCloseable 
 
 public String getEndpoint ( ) 
 { 
 - / / Try to find the endpoint using the local token , doing so in a crazy manner 
 - / / to maintain backwards compatibility with the MBean interface 
 - String stringToken = ssProxy . getTokens ( ) . get ( 0 ) ; 
 - Map < String , String > tokenToEndpoint = ssProxy . getTokenToEndpointMap ( ) ; 
 - 
 - for ( Map . Entry < String , String > pair : tokenToEndpoint . entrySet ( ) ) 
 - { 
 - if ( pair . getKey ( ) . equals ( stringToken ) ) 
 - { 
 - return pair . getValue ( ) ; 
 - } 
 - } 
 - 
 - throw new RuntimeException ( " Could not find myself in the endpoint list , something is very wrong ! Is the Cassandra node fully started ? " ) ; 
 + Map < String , String > hostIdToEndpoint = ssProxy . getHostIdMap ( ) ; 
 + return hostIdToEndpoint . get ( ssProxy . getLocalHostId ( ) ) ; 
 } 
 
 public String getDataCenter ( ) 
 diff - - git a / src / java / org / apache / cassandra / tools / NodeTool . java b / src / java / org / apache / cassandra / tools / NodeTool . java 
 index a2d4ead . . 6a7a930 100644 
 - - - a / src / java / org / apache / cassandra / tools / NodeTool . java 
 + + + b / src / java / org / apache / cassandra / tools / NodeTool . java 
 @ @ - 463 , 13 + 463 , 22 @ @ public class NodeTool 
 probe . getCacheMetric ( " CounterCache " , " HitRate " ) , 
 cacheService . getCounterCacheSavePeriodInSeconds ( ) ) ; 
 
 - / / Tokens 
 - List < String > tokens = probe . getTokens ( ) ; 
 - if ( tokens . size ( ) = = 1 | | this . tokens ) 
 - for ( String token : tokens ) 
 - System . out . printf ( " % - 23s : % s % n " , " Token " , token ) ; 
 + / / check if node is already joined , before getting tokens , since it throws exception if not . 
 + if ( probe . isJoined ( ) ) 
 + { 
 + / / Tokens 
 + List < String > tokens = probe . getTokens ( ) ; 
 + if ( tokens . size ( ) = = 1 | | this . tokens ) 
 + for ( String token : tokens ) 
 + System . out . printf ( " % - 23s : % s % n " , " Token " , token ) ; 
 + else 
 + System . out . printf ( " % - 23s : ( invoke with - T / - - tokens to see all % d tokens ) % n " , " Token " , 
 + tokens . size ( ) ) ; 
 + } 
 else 
 - System . out . printf ( " % - 23s : ( invoke with - T / - - tokens to see all % d tokens ) % n " , " Token " , tokens . size ( ) ) ; 
 + { 
 + System . out . printf ( " % - 23s : ( node is not joined to the cluster ) % n " , " Token " ) ; 
 + } 
 } 
 
 / * *

NEAREST DIFF:
ELIMINATEDSENTENCE
