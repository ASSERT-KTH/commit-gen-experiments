BLEU SCORE: 0.020980574531482755

TEST MSG: Update android gradle plugin to 3 . 0 . 0
GENERATED MSG: Implement the release process in Gradle

TEST DIFF (one line): diff - - git a / Dockerfile b / Dockerfile <nl> index 3d61d47 . . f5a1726 100644 <nl> - - - a / Dockerfile <nl> + + + b / Dockerfile <nl> @ @ - 51 , 7 + 51 , 7 @ @ RUN mkdir " $ { ANDROID _ HOME } / licenses " & & \ <nl> echo - e " \ n8933bad161af4178b1185d1a37fbf41ea5269c55 " > " $ { ANDROID _ HOME } / licenses / android - sdk - license " <nl> RUN sdkmanager - - update <nl> RUN sdkmanager ' platform - tools ' <nl> - RUN sdkmanager ' build - tools ; 25 . 0 . 3 ' <nl> + RUN sdkmanager ' build - tools ; 26 . 0 . 0 ' <nl> RUN sdkmanager ' extras ; android ; m2repository ' <nl> RUN sdkmanager ' platforms ; android - 25 ' <nl> <nl> diff - - git a / README . md b / README . md <nl> index 7c1c74a . . 9c996e8 100644 <nl> - - - a / README . md <nl> + + + b / README . md <nl> @ @ - 60 , 8 + 60 , 9 @ @ In case you don ' t want to use the precompiled version , you can build Realm yours <nl> # # # Prerequisites <nl> <nl> * Download the [ * * JDK 7 * * ] ( http : / / www . oracle . com / technetwork / java / javase / downloads / jdk7 - downloads - 1880260 . html ) or [ * * JDK 8 * * ] ( http : / / www . oracle . com / technetwork / java / javase / downloads / jdk8 - downloads - 2133151 . html ) from Oracle and install it . <nl> - * Download & install the Android SDK * * Build - Tools 25 . 0 . 3 * * , * * Android N ( API 25 ) * * ( for example through Android Studio ’ s * * Android SDK Manager * * ) . <nl> + * Download & install the Android SDK * * Build - Tools 26 . 0 . 0 * * , * * Android N ( API 25 ) * * ( for example through Android Studio ’ s * * Android SDK Manager * * ) . <nl> * Install CMake from SDK manager in Android Studio ( " SDK Tools " - > " CMake " ) . <nl> + * If you use Android Studio , Android Studio 3 . 0 or later is required . <nl> <nl> * Realm currently requires version r10e of the NDK . Download the one appropriate for your development platform , from the NDK [ archive ] ( https : / / developer . android . com / ndk / downloads / older _ releases . html ) . <nl> You may unzip the file wherever you choose . For macOS , a suggested location is ` ~ / Library / Android ` . The download will unzip as the directory ` android - ndk - r10e ` . <nl> diff - - git a / build . gradle b / build . gradle <nl> index a641a7f . . a27e148 100644 <nl> - - - a / build . gradle <nl> + + + b / build . gradle <nl> @ @ - 89 , 6 + 89 , 17 @ @ task check { <nl> dependsOn checkExamples <nl> } <nl> <nl> + task assembleUnitTests ( type : GradleBuild ) { <nl> + group = ' Build ' <nl> + description = ' Assemble Android unit tests of the Realm project ' <nl> + dependsOn installTransformer <nl> + buildFile = file ( ' realm / build . gradle ' ) <nl> + tasks = [ ' assembleAndroidTest ' ] <nl> + if ( project . hasProperty ( ' buildTargetABIs ' ) ) { <nl> + startParameter . projectProperties + = [ buildTargetABIs : project . getProperty ( ' buildTargetABIs ' ) ] <nl> + } <nl> + } <nl> + <nl> task connectedUnitTests ( type : GradleBuild ) { <nl> group = ' Test ' <nl> description = ' Run the Android unit tests of the Realm project ' <nl> @ @ - 100 , 6 + 111 , 17 @ @ task connectedUnitTests ( type : GradleBuild ) { <nl> } <nl> } <nl> <nl> + task assembleBenchmarks ( type : GradleBuild ) { <nl> + group = ' Build ' <nl> + description = ' Assemble benchmark tests for the library ' <nl> + dependsOn installTransformer <nl> + buildFile = file ( ' library - benchmarks / build . gradle ' ) <nl> + tasks = [ ' assembleAndroidTest ' ] <nl> + if ( project . hasProperty ( ' buildTargetABIs ' ) ) { <nl> + startParameter . projectProperties + = [ buildTargetABIs : project . getProperty ( ' buildTargetABIs ' ) ] <nl> + } <nl> + } <nl> + <nl> task connectedBenchmarks ( type : GradleBuild ) { <nl> group = ' Test ' <nl> description = ' Run all the benchmark tests for the library ' <nl> diff - - git a / examples / build . gradle b / examples / build . gradle <nl> index 1d0e7df . . aae1dce 100644 <nl> - - - a / examples / build . gradle <nl> + + + b / examples / build . gradle <nl> @ @ - 1 , 5 + 1 , 5 @ @ <nl> project . ext . sdkVersion = 25 <nl> - project . ext . buildTools = ' 25 . 0 . 3 ' <nl> + project . ext . buildTools = ' 26 . 0 . 0 ' <nl> <nl> / / Don ' t cache SNAPSHOT ( changing ) dependencies . <nl> configurations . all { <nl> @ @ - 17 , 12 + 17 , 13 @ @ allprojects { <nl> <nl> buildscript { <nl> repositories { <nl> + google ( ) <nl> mavenLocal ( ) <nl> jcenter ( ) <nl> maven { url ' https : / / jitpack . io ' } <nl> } <nl> dependencies { <nl> - classpath ' com . android . tools . build : gradle : 2 . 3 . 3 ' <nl> + classpath ' com . android . tools . build : gradle : 3 . 0 . 0 - alpha4 ' <nl> classpath ' com . jfrog . bintray . gradle : gradle - bintray - plugin : 1 . 6 ' <nl> classpath ' com . novoda : gradle - android - command - plugin : 1 . 5 . 0 ' <nl> classpath " io . realm : realm - gradle - plugin : $ { currentVersion } " <nl> @ @ - 35 , 6 + 36 , 7 @ @ allprojects { <nl> repositories { <nl> mavenLocal ( ) <nl> jcenter ( ) <nl> + google ( ) <nl> } <nl> } <nl> <nl> diff - - git a / examples / gradle . properties b / examples / gradle . properties <nl> index 4a9594a . . 3cae062 100644 <nl> - - - a / examples / gradle . properties <nl> + + + b / examples / gradle . properties <nl> @ @ - 1 + 1 , 5 @ @ <nl> - org . gradle . jvmargs = - Xmx2048M <nl> \ No newline at end of file <nl> + org . gradle . jvmargs = - Xmx2048M <nl> + org . gradle . caching = true <nl> + <nl> + # disable AAPT2 to work around an issue of Robolectric in unitTestExample https : / / github . com / robolectric / robolectric / issues / 3169 <nl> + android . enableAapt2 = false <nl> diff - - git a / examples / gridViewExample / build . gradle b / examples / gridViewExample / build . gradle <nl> index 474e861 . . 8d45e3a 100644 <nl> - - - a / examples / gridViewExample / build . gradle <nl> + + + b / examples / gridViewExample / build . gradle <nl> @ @ - 37 , 5 + 37 , 5 @ @ android { <nl> } <nl> <nl> dependencies { <nl> - compile ' com . google . code . gson : gson : 2 . 5 ' <nl> + implementation ' com . google . code . gson : gson : 2 . 5 ' <nl> } <nl> diff - - git a / examples / jsonExample / build . gradle b / examples / jsonExample / build . gradle <nl> index c46861f . . cdd8b8a 100644 <nl> - - - a / examples / jsonExample / build . gradle <nl> + + + b / examples / jsonExample / build . gradle <nl> @ @ - 12 , 6 + 12 , 7 @ @ android { <nl> minSdkVersion 15 <nl> versionCode 1 <nl> versionName " 1 . 0 " <nl> + javaCompileOptions . annotationProcessorOptions . includeCompileClasspath = true <nl> } <nl> buildTypes { <nl> release { <nl> @ @ - 27 , 6 + 28 , 6 @ @ android { <nl> } <nl> <nl> dependencies { <nl> - provided ' org . projectlombok : lombok : 1 . 16 . 6 ' <nl> + compileOnly ' org . projectlombok : lombok : 1 . 16 . 6 ' <nl> annotationProcessor ' org . projectlombok : lombok : 1 . 16 . 6 ' <nl> } <nl> diff - - git a / examples / kotlinExample / build . gradle b / examples / kotlinExample / build . gradle <nl> index 763a829 . . d4a434d 100644 <nl> - - - a / examples / kotlinExample / build . gradle <nl> + + + b / examples / kotlinExample / build . gradle <nl> @ @ - 45 , 6 + 45 , 6 @ @ android { <nl> } <nl> <nl> dependencies { <nl> - compile " org . jetbrains . kotlin : kotlin - stdlib - jre7 : $ { kotlin _ version } " <nl> - compile ' org . jetbrains . anko : anko - sdk15 : 0 . 9 . 1 ' <nl> + implementation " org . jetbrains . kotlin : kotlin - stdlib - jre7 : $ { kotlin _ version } " <nl> + implementation ' org . jetbrains . anko : anko - sdk15 : 0 . 9 . 1 ' <nl> } <nl> diff - - git a / examples / moduleExample / app / build . gradle b / examples / moduleExample / app / build . gradle <nl> index cc80f29 . . fe9fbaf 100644 <nl> - - - a / examples / moduleExample / app / build . gradle <nl> + + + b / examples / moduleExample / app / build . gradle <nl> @ @ - 37 , 5 + 37 , 5 @ @ android { <nl> } <nl> <nl> dependencies { <nl> - compile project ( ' : moduleExample : library ' ) <nl> + implementation project ( ' : moduleExample : library ' ) <nl> } <nl> diff - - git a / examples / newsreaderExample / build . gradle b / examples / newsreaderExample / build . gradle <nl> index dcc0165 . . 6e08119 100644 <nl> - - - a / examples / newsreaderExample / build . gradle <nl> + + + b / examples / newsreaderExample / build . gradle <nl> @ @ - 32 , 18 + 32 , 18 @ @ android { <nl> } <nl> <nl> dependencies { <nl> - compile fileTree ( dir : ' libs ' , include : [ ' * . jar ' ] ) <nl> + implementation fileTree ( dir : ' libs ' , include : [ ' * . jar ' ] ) <nl> / / noinspection GradleDependency <nl> - compile ' com . android . support : appcompat - v7 : 25 . 2 . 0 ' <nl> + implementation ' com . android . support : appcompat - v7 : 25 . 2 . 0 ' <nl> / / noinspection GradleDependency <nl> - compile ' com . android . support : design : 25 . 2 . 0 ' <nl> - compile ' io . reactivex : rxjava : 1 . 1 . 0 ' <nl> - compile ' io . reactivex : rxandroid : 1 . 1 . 0 ' <nl> - compile ' com . squareup . retrofit : retrofit : 2 . 0 . 0 - beta2 ' <nl> - compile ' com . squareup . retrofit : converter - jackson : 2 . 0 . 0 - beta2 ' <nl> - compile ' com . squareup . retrofit : adapter - rxjava : 2 . 0 . 0 - beta2 ' <nl> - compile ' com . jakewharton . timber : timber : 4 . 1 . 0 ' <nl> - compile ' com . jakewharton : butterknife : 8 . 5 . 1 ' <nl> + implementation ' com . android . support : design : 25 . 2 . 0 ' <nl> + implementation ' io . reactivex : rxjava : 1 . 1 . 0 ' <nl> + implementation ' io . reactivex : rxandroid : 1 . 1 . 0 ' <nl> + implementation ' com . squareup . retrofit : retrofit : 2 . 0 . 0 - beta2 ' <nl> + implementation ' com . squareup . retrofit : converter - jackson : 2 . 0 . 0 - beta2 ' <nl> + implementation ' com . squareup . retrofit : adapter - rxjava : 2 . 0 . 0 - beta2 ' <nl> + implementation ' com . jakewharton . timber : timber : 4 . 1 . 0 ' <nl> + implementation ' com . jakewharton : butterknife : 8 . 5 . 1 ' <nl> annotationProcessor ' com . jakewharton : butterknife - compiler : 8 . 5 . 1 ' <nl> - compile ' me . zhanghai . android . materialprogressbar : library : 1 . 1 . 4 ' <nl> + implementation ' me . zhanghai . android . materialprogressbar : library : 1 . 1 . 4 ' <nl> } <nl> diff - - git a / examples / objectServerExample / build . gradle b / examples / objectServerExample / build . gradle <nl> index e976f16 . . f16e3db 100644 <nl> - - - a / examples / objectServerExample / build . gradle <nl> + + + b / examples / objectServerExample / build . gradle <nl> @ @ - 60 , 10 + 60 , 10 @ @ realm { <nl> } <nl> <nl> dependencies { <nl> - compile ' com . android . support : support - v4 : 25 . 2 . 0 ' <nl> - compile ' com . android . support : appcompat - v7 : 25 . 2 . 0 ' <nl> - compile ' com . android . support : design : 25 . 2 . 0 ' <nl> - compile ' me . zhanghai . android . materialprogressbar : library : 1 . 3 . 0 ' <nl> - compile ' com . jakewharton : butterknife : 8 . 5 . 1 ' <nl> + implementation ' com . android . support : support - v4 : 25 . 2 . 0 ' <nl> + implementation ' com . android . support : appcompat - v7 : 25 . 2 . 0 ' <nl> + implementation ' com . android . support : design : 25 . 2 . 0 ' <nl> + implementation ' me . zhanghai . android . materialprogressbar : library : 1 . 3 . 0 ' <nl> + implementation ' com . jakewharton : butterknife : 8 . 5 . 1 ' <nl> annotationProcessor ' com . jakewharton : butterknife - compiler : 8 . 5 . 1 ' <nl> } <nl> diff - - git a / examples / rxJavaExample / build . gradle b / examples / rxJavaExample / build . gradle <nl> index 9a916ed . . 21c4723 100644 <nl> - - - a / examples / rxJavaExample / build . gradle <nl> + + + b / examples / rxJavaExample / build . gradle <nl> @ @ - 29 , 8 + 29 , 8 @ @ android { <nl> } <nl> <nl> dependencies { <nl> - compile ' io . reactivex : rxandroid : 1 . 1 . 0 ' <nl> - compile ' io . reactivex : rxjava : 1 . 1 . 0 ' <nl> - compile ' com . jakewharton . rxbinding : rxbinding : 0 . 3 . 0 ' <nl> - compile ' com . squareup . retrofit : retrofit : 1 . 9 . 0 ' <nl> + implementation ' io . reactivex : rxandroid : 1 . 1 . 0 ' <nl> + implementation ' io . reactivex : rxjava : 1 . 1 . 0 ' <nl> + implementation ' com . jakewharton . rxbinding : rxbinding : 0 . 3 . 0 ' <nl> + implementation ' com . squareup . retrofit : retrofit : 1 . 9 . 0 ' <nl> } <nl> diff - - git a / examples / secureTokenAndroidKeyStore / build . gradle b / examples / secureTokenAndroidKeyStore / build . gradle <nl> index a15da44 . . 2059678 100644 <nl> - - - a / examples / secureTokenAndroidKeyStore / build . gradle <nl> + + + b / examples / secureTokenAndroidKeyStore / build . gradle <nl> @ @ - 24 , 13 + 24 , 13 @ @ android { <nl> } <nl> <nl> dependencies { <nl> - compile fileTree ( dir : ' libs ' , include : [ ' * . jar ' ] ) <nl> - androidTestCompile ( ' com . android . support . test . espresso : espresso - core : 2 . 2 . 2 ' , { <nl> + implementation fileTree ( dir : ' libs ' , include : [ ' * . jar ' ] ) <nl> + androidTestImplementation ( ' com . android . support . test . espresso : espresso - core : 2 . 2 . 2 ' , { <nl> exclude group : ' com . android . support ' , module : ' support - annotations ' <nl> } ) <nl> - compile ' com . android . support : appcompat - v7 : 25 . 2 . 0 ' <nl> - testCompile ' junit : junit : 4 . 12 ' <nl> - compile ' io . realm : secure - userstore : 1 . 0 . 1 ' <nl> + implementation ' com . android . support : appcompat - v7 : 25 . 2 . 0 ' <nl> + testImplementation ' junit : junit : 4 . 12 ' <nl> + implementation ' io . realm : secure - userstore : 1 . 0 . 1 ' <nl> } <nl> <nl> realm { <nl> diff - - git a / examples / threadExample / build . gradle b / examples / threadExample / build . gradle <nl> index 98ec9f1 . . 5ebeb26 100644 <nl> - - - a / examples / threadExample / build . gradle <nl> + + + b / examples / threadExample / build . gradle <nl> @ @ - 25 , 5 + 25 , 5 @ @ android { <nl> <nl> dependencies { <nl> / / noinspection GradleDependency <nl> - compile ' com . android . support : appcompat - v7 : 24 . 0 . 0 ' <nl> + implementation ' com . android . support : appcompat - v7 : 24 . 0 . 0 ' <nl> } <nl> diff - - git a / examples / unitTestExample / build . gradle b / examples / unitTestExample / build . gradle <nl> index 7923164 . . 2270fa1 100644 <nl> - - - a / examples / unitTestExample / build . gradle <nl> + + + b / examples / unitTestExample / build . gradle <nl> @ @ - 30 , 23 + 30 , 23 @ @ android { <nl> <nl> <nl> dependencies { <nl> - testCompile ' io . reactivex : rxjava : 1 . 1 . 0 ' <nl> + testImplementation ' io . reactivex : rxjava : 1 . 1 . 0 ' <nl> <nl> / / Testing <nl> - testCompile ' junit : junit : 4 . 12 ' <nl> - testCompile " org . robolectric : robolectric : 3 . 3 . 2 " <nl> - testCompile " org . mockito : mockito - core : 1 . 10 . 19 " <nl> - testCompile ' org . robolectric : shadows - support - v4 : 3 . 0 ' <nl> + testImplementation ' junit : junit : 4 . 12 ' <nl> + testImplementation " org . robolectric : robolectric : 3 . 3 . 2 " <nl> + testImplementation " org . mockito : mockito - core : 1 . 10 . 19 " <nl> + testImplementation ' org . robolectric : shadows - support - v4 : 3 . 0 ' <nl> <nl> - testCompile " org . powermock : powermock - module - junit4 - rule : 1 . 6 . 5 " <nl> - testCompile " org . powermock : powermock - module - junit4 : 1 . 6 . 5 " <nl> - testCompile " org . powermock : powermock - api - mockito : 1 . 6 . 5 " <nl> - testCompile " org . powermock : powermock - classloading - xstream : 1 . 6 . 5 " <nl> + testImplementation " org . powermock : powermock - module - junit4 : 1 . 6 . 5 " <nl> + testImplementation " org . powermock : powermock - module - junit4 - rule : 1 . 6 . 5 " <nl> + testImplementation " org . powermock : powermock - api - mockito : 1 . 6 . 5 " <nl> + testImplementation " org . powermock : powermock - classloading - xstream : 1 . 6 . 5 " <nl> <nl> <nl> - androidTestCompile ' com . android . support . test : runner : 0 . 5 ' <nl> + androidTestImplementation ' com . android . support . test : runner : 0 . 5 ' <nl> / / Set this dependency to use JUnit 4 rules <nl> - androidTestCompile ' com . android . support . test : rules : 0 . 5 ' <nl> + androidTestImplementation ' com . android . support . test : rules : 0 . 5 ' <nl> / / Set this dependency to build and run Espresso tests <nl> - androidTestCompile ' com . android . support . test . espresso : espresso - core : 2 . 2 . 2 ' <nl> + androidTestImplementation ' com . android . support . test . espresso : espresso - core : 2 . 2 . 2 ' <nl> } <nl> diff - - git a / gradle - plugin / gradle . properties b / gradle - plugin / gradle . properties <nl> new file mode 100644 <nl> index 0000000 . . 1608900 <nl> - - - / dev / null <nl> + + + b / gradle - plugin / gradle . properties <nl> @ @ - 0 , 0 + 1 @ @ <nl> + org . gradle . caching = true <nl> diff - - git a / gradle - plugin / src / main / groovy / io / realm / gradle / Realm . groovy b / gradle - plugin / src / main / groovy / io / realm / gradle / Realm . groovy <nl> index 43bf3f8 . . 6a24fa4 100644 <nl> - - - a / gradle - plugin / src / main / groovy / io / realm / gradle / Realm . groovy <nl> + + + b / gradle - plugin / src / main / groovy / io / realm / gradle / Realm . groovy <nl> @ @ - 23 , 6 + 23 , 7 @ @ import io . realm . transformer . RealmTransformer <nl> import org . gradle . api . GradleException <nl> import org . gradle . api . Plugin <nl> import org . gradle . api . Project <nl> + import org . gradle . api . artifacts . UnknownConfigurationException <nl> <nl> class Realm implements Plugin < Project > { <nl> <nl> @ @ - 40 , 7 + 41 , 8 @ @ class Realm implements Plugin < Project > { <nl> } <nl> <nl> def syncEnabledDefault = false <nl> - project . extensions . create ( ' realm ' , RealmPluginExtension , project , syncEnabledDefault ) <nl> + def dependencyConfigurationName = getDependencyConfigurationName ( project ) <nl> + project . extensions . create ( ' realm ' , RealmPluginExtension , project , syncEnabledDefault , dependencyConfigurationName ) <nl> <nl> def usesAptPlugin = project . plugins . findPlugin ( ' com . neenbedankt . android - apt ' ) ! = null <nl> def isKotlinProject = project . plugins . findPlugin ( ' kotlin - android ' ) ! = null <nl> @ @ - 57 , 7 + 59 , 7 @ @ class Realm implements Plugin < Project > { <nl> project . android . registerTransform ( new RealmTransformer ( project ) ) <nl> <nl> project . repositories . add ( project . getRepositories ( ) . jcenter ( ) ) <nl> - project . dependencies . add ( " compile " , " io . realm : realm - annotations : $ { Version . VERSION } " ) <nl> + project . dependencies . add ( dependencyConfigurationName , " io . realm : realm - annotations : $ { Version . VERSION } " ) <nl> if ( usesAptPlugin ) { <nl> project . dependencies . add ( " apt " , " io . realm : realm - annotations - processor : $ { Version . VERSION } " ) <nl> project . dependencies . add ( " androidTestApt " , " io . realm : realm - annotations - processor : $ { Version . VERSION } " ) <nl> @ @ - 80 , 6 + 82 , 22 @ @ class Realm implements Plugin < Project > { <nl> } <nl> } <nl> <nl> + private static String getDependencyConfigurationName ( Project project ) { <nl> + / * <nl> + * Dependency configuration name for android gradle plugin 3 . 0 . 0 - * . <nl> + * We need to use ' api ' instead of ' implementation ' since user ' s model class <nl> + * might be using Realm ' s classes and annotations . <nl> + * / <nl> + def newDependencyName = " api " <nl> + def oldDependencyName = " compile " <nl> + try { <nl> + project . getConfigurations ( ) . getByName ( newDependencyName ) <nl> + return newDependencyName <nl> + } catch ( UnknownConfigurationException ignored ) { <nl> + oldDependencyName <nl> + } <nl> + } <nl> + <nl> private static boolean shouldApplyAndroidAptPlugin ( boolean usesAptPlugin , boolean isKotlinProject , <nl> boolean hasAnnotationProcessorConfiguration , <nl> boolean preferAptOnKotlinProject ) { <nl> diff - - git a / gradle - plugin / src / main / groovy / io / realm / gradle / RealmPluginExtension . groovy b / gradle - plugin / src / main / groovy / io / realm / gradle / RealmPluginExtension . groovy <nl> index ac2fc40 . . 42bd8e5 100644 <nl> - - - a / gradle - plugin / src / main / groovy / io / realm / gradle / RealmPluginExtension . groovy <nl> + + + b / gradle - plugin / src / main / groovy / io / realm / gradle / RealmPluginExtension . groovy <nl> @ @ - 21 , 9 + 21 , 11 @ @ import org . gradle . api . Project <nl> class RealmPluginExtension { <nl> private Project project <nl> def boolean syncEnabled <nl> + private String dependencyConfigurationName <nl> <nl> - RealmPluginExtension ( Project project , boolean syncEnabledDefault ) { <nl> + RealmPluginExtension ( Project project , boolean syncEnabledDefault , String dependencyConfigurationName ) { <nl> this . project = project <nl> + this . dependencyConfigurationName = dependencyConfigurationName <nl> setSyncEnabled ( syncEnabledDefault ) <nl> } <nl> <nl> @ @ - 31 , 7 + 33 , 7 @ @ class RealmPluginExtension { <nl> this . syncEnabled = value ; <nl> <nl> / / remove realm android library first <nl> - def iterator = project . getConfigurations ( ) . getByName ( " compile " ) . getDependencies ( ) . iterator ( ) ; <nl> + def iterator = project . getConfigurations ( ) . getByName ( dependencyConfigurationName ) . getDependencies ( ) . iterator ( ) ; <nl> while ( iterator . hasNext ( ) ) { <nl> def item = iterator . next ( ) <nl> if ( item . group = = ' io . realm ' & & item . name . startsWith ( ' realm - android - library ' ) ) { <nl> @ @ - 41 , 6 + 43 , 6 @ @ class RealmPluginExtension { <nl> <nl> / / then add again <nl> def artifactName = " realm - android - library $ { syncEnabled ? ' - object - server ' : ' ' } " <nl> - project . dependencies . add ( " compile " , " io . realm : $ { artifactName } : $ { Version . VERSION } " ) <nl> + project . dependencies . add ( dependencyConfigurationName , " io . realm : $ { artifactName } : $ { Version . VERSION } " ) <nl> } <nl> } <nl> diff - - git a / library - benchmarks / build . gradle b / library - benchmarks / build . gradle <nl> index e185b78 . . 38703ec 100644 <nl> - - - a / library - benchmarks / build . gradle <nl> + + + b / library - benchmarks / build . gradle <nl> @ @ - 1 , 10 + 1 , 11 @ @ <nl> buildscript { <nl> repositories { <nl> mavenLocal ( ) <nl> + google ( ) <nl> jcenter ( ) <nl> } <nl> dependencies { <nl> - classpath ' com . android . tools . build : gradle : 2 . 3 . 2 ' <nl> + classpath ' com . android . tools . build : gradle : 3 . 0 . 0 - alpha4 ' <nl> classpath " io . realm : realm - gradle - plugin : $ { file ( " $ { rootDir } / . . / version . txt " ) . text . trim ( ) } " <nl> } <nl> } <nl> @ @ - 26 , 7 + 27 , 7 @ @ apply plugin : ' realm - android ' <nl> <nl> android { <nl> compileSdkVersion 25 <nl> - buildToolsVersion " 25 . 0 . 3 " <nl> + buildToolsVersion " 26 . 0 . 0 " <nl> <nl> defaultConfig { <nl> minSdkVersion 15 <nl> @ @ - 47 , 14 + 48 , 15 @ @ android { <nl> <nl> repositories { <nl> mavenLocal ( ) <nl> + google ( ) <nl> jcenter ( ) <nl> } <nl> <nl> dependencies { <nl> - androidTestCompile ' com . android . support . test : runner : 0 . 5 ' <nl> - androidTestCompile ' com . android . support . test : rules : 0 . 5 ' <nl> - androidTestCompile ' junit : junit : 4 . 12 ' <nl> - androidTestCompile ' dk . ilios : spanner : 0 . 6 . 0 ' <nl> - androidTestCompile ' com . opencsv : opencsv : 3 . 4 ' <nl> - androidTestCompile ' junit : junit : 4 . 12 ' <nl> - } <nl> \ No newline at end of file <nl> + androidTestImplementation ' com . android . support . test : runner : 0 . 5 ' <nl> + androidTestImplementation ' com . android . support . test : rules : 0 . 5 ' <nl> + androidTestImplementation ' junit : junit : 4 . 12 ' <nl> + androidTestImplementation ' dk . ilios : spanner : 0 . 6 . 0 ' <nl> + androidTestImplementation ' com . opencsv : opencsv : 3 . 4 ' <nl> + androidTestImplementation ' junit : junit : 4 . 12 ' <nl> + } <nl> diff - - git a / realm - annotations / gradle . properties b / realm - annotations / gradle . properties <nl> new file mode 100644 <nl> index 0000000 . . 1608900 <nl> - - - / dev / null <nl> + + + b / realm - annotations / gradle . properties <nl> @ @ - 0 , 0 + 1 @ @ <nl> + org . gradle . caching = true <nl> diff - - git a / realm - transformer / gradle . properties b / realm - transformer / gradle . properties <nl> new file mode 100644 <nl> index 0000000 . . 1608900 <nl> - - - / dev / null <nl> + + + b / realm - transformer / gradle . properties <nl> @ @ - 0 , 0 + 1 @ @ <nl> + org . gradle . caching = true <nl> diff - - git a / realm - transformer / src / main / groovy / io / realm / transformer / RealmTransformer . groovy b / realm - transformer / src / main / groovy / io / realm / transformer / RealmTransformer . groovy <nl> index b02d1a6 . . bd99fb2 100644 <nl> - - - a / realm - transformer / src / main / groovy / io / realm / transformer / RealmTransformer . groovy <nl> + + + b / realm - transformer / src / main / groovy / io / realm / transformer / RealmTransformer . groovy <nl> @ @ - 66 , 6 + 66 , 7 @ @ class RealmTransformer extends Transform { <nl> <nl> @ Override <nl> Set < Scope > getReferencedScopes ( ) { <nl> + / / Scope . PROJECT _ LOCAL _ DEPS and Scope . SUB _ PROJECTS _ LOCAL _ DEPS is only for compatibility with AGP 1 . x , 2 . x <nl> return Sets . immutableEnumSet ( Scope . EXTERNAL _ LIBRARIES , Scope . PROJECT _ LOCAL _ DEPS , <nl> Scope . SUB _ PROJECTS , Scope . SUB _ PROJECTS _ LOCAL _ DEPS , Scope . TESTED _ CODE ) <nl> } <nl> diff - - git a / realm / build . gradle b / realm / build . gradle <nl> index eed9593 . . 37a4993 100644 <nl> - - - a / realm / build . gradle <nl> + + + b / realm / build . gradle <nl> @ @ - 2 , 13 + 2 , 14 @ @ buildscript { <nl> ext . kotlin _ version = ' 1 . 1 . 2 - 5 ' <nl> repositories { <nl> mavenLocal ( ) <nl> + google ( ) <nl> jcenter ( ) <nl> maven { url ' https : / / jitpack . io ' } <nl> maven { url " https : / / plugins . gradle . org / m2 / " } <nl> } <nl> <nl> dependencies { <nl> - classpath ' com . android . tools . build : gradle : 2 . 3 . 3 ' <nl> + classpath ' com . android . tools . build : gradle : 3 . 0 . 0 - alpha4 ' <nl> classpath ' de . undercouch : gradle - download - task : 3 . 1 . 1 ' <nl> classpath ' com . github . dcendents : android - maven - gradle - plugin : 1 . 5 ' <nl> classpath ' com . novoda : gradle - android - command - plugin : 1 . 5 . 0 ' <nl> @ @ - 33 , 6 + 34 , 7 @ @ allprojects { <nl> version = file ( " $ { rootDir } / . . / version . txt " ) . text . trim ( ) ; <nl> repositories { <nl> mavenLocal ( ) <nl> + google ( ) <nl> jcenter ( ) <nl> } <nl> } <nl> diff - - git a / realm / gradle . properties b / realm / gradle . properties <nl> index f3f16fc . . 0be17a4 100644 <nl> - - - a / realm / gradle . properties <nl> + + + b / realm / gradle . properties <nl> @ @ - 1 + 1 , 2 @ @ <nl> org . gradle . jvmargs = - Xms512m - Xmx2048m <nl> + org . gradle . caching = true <nl> diff - - git a / realm / realm - library / build . gradle b / realm / realm - library / build . gradle <nl> index 01283a6 . . f1e2dfe 100644 <nl> - - - a / realm / realm - library / build . gradle <nl> + + + b / realm / realm - library / build . gradle <nl> @ @ - 38 , 7 + 38 , 7 @ @ ext . lcachePath = project . findProperty ( ' lcachePath ' ) ? : System . getenv ( ' NDK _ LCACHE <nl> <nl> android { <nl> compileSdkVersion 25 <nl> - buildToolsVersion ' 25 . 0 . 3 ' <nl> + buildToolsVersion ' 26 . 0 . 0 ' <nl> <nl> defaultConfig { <nl> minSdkVersion 9 <nl> @ @ - 111 , 8 + 111 , 11 @ @ android { <nl> abortOnError false <nl> } <nl> <nl> + flavorDimensions ' api ' <nl> + <nl> productFlavors { <nl> base { <nl> + dimension ' api ' <nl> externalNativeBuild { <nl> cmake { <nl> arguments " - DREALM _ FLAVOR = base " <nl> @ @ - 121 , 6 + 124 , 7 @ @ android { <nl> consumerProguardFiles ' proguard - rules - common . pro ' , ' proguard - rules - base . pro ' <nl> } <nl> objectServer { <nl> + dimension ' api ' <nl> externalNativeBuild { <nl> cmake { <nl> arguments " - DREALM _ FLAVOR = objectServer " <nl> @ @ - 159 , 26 + 163 , 26 @ @ repositories { <nl> <nl> dependencies { <nl> <nl> - provided ' io . reactivex : rxjava : 1 . 1 . 0 ' <nl> - provided ' com . google . code . findbugs : findbugs - annotations : 3 . 0 . 1 ' <nl> + compileOnly ' io . reactivex : rxjava : 1 . 1 . 0 ' <nl> + compileOnly ' com . google . code . findbugs : findbugs - annotations : 3 . 0 . 1 ' <nl> <nl> - compile " io . realm : realm - annotations : $ { version } " <nl> - compile ' com . getkeepsafe . relinker : relinker : 1 . 2 . 2 ' <nl> + api " io . realm : realm - annotations : $ { version } " <nl> + implementation ' com . getkeepsafe . relinker : relinker : 1 . 2 . 2 ' <nl> <nl> kaptObjectServer project ( ' : realm - annotations - processor ' ) <nl> - objectServerCompile ' com . squareup . okhttp3 : okhttp : 3 . 4 . 1 ' <nl> + objectServerImplementation ' com . squareup . okhttp3 : okhttp : 3 . 4 . 1 ' <nl> <nl> kaptAndroidTest project ( ' : realm - annotations - processor ' ) <nl> - androidTestCompile fileTree ( dir : ' testLibs ' , include : [ ' * . jar ' ] ) <nl> - androidTestCompile ' io . reactivex : rxjava : 1 . 1 . 0 ' <nl> - androidTestCompile ' com . android . support : support - annotations : 25 . 3 . 1 ' <nl> - androidTestCompile ' com . android . support . test : runner : 0 . 5 ' <nl> - androidTestCompile ' com . android . support . test : rules : 0 . 5 ' <nl> - androidTestCompile ' com . google . dexmaker : dexmaker : 1 . 2 ' <nl> - androidTestCompile ' com . google . dexmaker : dexmaker - mockito : 1 . 2 ' <nl> - androidTestCompile ' org . hamcrest : hamcrest - library : 1 . 3 ' <nl> - androidTestCompile " org . jetbrains . kotlin : kotlin - stdlib - jre7 : $ kotlin _ version " <nl> - androidTestCompile " org . jetbrains . kotlin : kotlin - reflect : $ kotlin _ version " <nl> + androidTestImplementation fileTree ( dir : ' testLibs ' , include : [ ' * . jar ' ] ) <nl> + androidTestImplementation ' io . reactivex : rxjava : 1 . 1 . 0 ' <nl> + androidTestImplementation ' com . android . support : support - annotations : 25 . 3 . 1 ' <nl> + androidTestImplementation ' com . android . support . test : runner : 0 . 5 ' <nl> + androidTestImplementation ' com . android . support . test : rules : 0 . 5 ' <nl> + androidTestImplementation ' com . google . dexmaker : dexmaker : 1 . 2 ' <nl> + androidTestImplementation ' com . google . dexmaker : dexmaker - mockito : 1 . 2 ' <nl> + androidTestImplementation ' org . hamcrest : hamcrest - library : 1 . 3 ' <nl> + androidTestImplementation " org . jetbrains . kotlin : kotlin - stdlib - jre7 : $ kotlin _ version " <nl> + androidTestImplementation " org . jetbrains . kotlin : kotlin - reflect : $ kotlin _ version " <nl> } <nl> <nl> task sourcesJar ( type : Jar ) { <nl> @ @ - 360 , 7 + 364 , 7 @ @ publishing { <nl> artifact sourcesJar <nl> artifact javadocJar <nl> <nl> - pom . withXml ( createPomDependencies ( [ " baseCompile " , " compile " ] ) ) <nl> + pom . withXml ( createPomDependencies ( [ " baseImplementation " , " implementation " , " baseApi " , " api " ] ) ) <nl> } <nl> <nl> objectServerPublication ( MavenPublication ) { <nl> @ @ - 371 , 7 + 375 , 7 @ @ publishing { <nl> artifact sourcesJar <nl> artifact javadocJar <nl> <nl> - pom . withXml ( createPomDependencies ( [ " objectServerCompile " , " compile " ] ) ) <nl> + pom . withXml ( createPomDependencies ( [ " objectServerImplementation " , " implementation " , " objectServerApi " , " api " ] ) ) <nl> } <nl> } <nl> repositories {
NEAREST DIFF (one line): diff - - git a / build . gradle b / build . gradle <nl> index 05c1bdf . . f19347a 100644 <nl> - - - a / build . gradle <nl> + + + b / build . gradle <nl> @ @ - 9 , 6 + 9 , 7 @ @ buildscript { <nl> classpath ' com . jfrog . bintray . gradle : gradle - bintray - plugin : 0 . 5 ' / / Version 0 . 6 seems to require gradle 2 . 0 + <nl> classpath ' com . jakewharton . sdkmanager : gradle - plugin : 0 . 12 . 0 ' <nl> classpath ' com . novoda : gradle - android - command - plugin : 1 . 3 . 0 ' <nl> + classpath ' com . github . skhatri : gradle - s3 - plugin : 1 . 0 . 0 ' <nl> } <nl> } <nl> <nl> diff - - git a / distribution / RealmAdapterExample / build . gradle b / distribution / RealmAdapterExample / build . gradle <nl> index 2027f3b . . 61fd77e 100644 <nl> - - - a / distribution / RealmAdapterExample / build . gradle <nl> + + + b / distribution / RealmAdapterExample / build . gradle <nl> @ @ - 6 , 6 + 6 , 7 @ @ buildscript { <nl> } <nl> dependencies { <nl> classpath ' com . android . tools . build : gradle : 1 . 0 . 0 ' <nl> + classpath ' com . novoda : gradle - android - command - plugin : 1 . 3 . 0 ' <nl> } <nl> } <nl> <nl> diff - - git a / distribution / RealmEncryptionExample / build . gradle b / distribution / RealmEncryptionExample / build . gradle <nl> index 2027f3b . . 61fd77e 100644 <nl> - - - a / distribution / RealmEncryptionExample / build . gradle <nl> + + + b / distribution / RealmEncryptionExample / build . gradle <nl> @ @ - 6 , 6 + 6 , 7 @ @ buildscript { <nl> } <nl> dependencies { <nl> classpath ' com . android . tools . build : gradle : 1 . 0 . 0 ' <nl> + classpath ' com . novoda : gradle - android - command - plugin : 1 . 3 . 0 ' <nl> } <nl> } <nl> <nl> diff - - git a / distribution / RealmGridViewExample / build . gradle b / distribution / RealmGridViewExample / build . gradle <nl> index 2027f3b . . 61fd77e 100644 <nl> - - - a / distribution / RealmGridViewExample / build . gradle <nl> + + + b / distribution / RealmGridViewExample / build . gradle <nl> @ @ - 6 , 6 + 6 , 7 @ @ buildscript { <nl> } <nl> dependencies { <nl> classpath ' com . android . tools . build : gradle : 1 . 0 . 0 ' <nl> + classpath ' com . novoda : gradle - android - command - plugin : 1 . 3 . 0 ' <nl> } <nl> } <nl> <nl> diff - - git a / distribution / RealmIntroExample / build . gradle b / distribution / RealmIntroExample / build . gradle <nl> index 2027f3b . . 61fd77e 100644 <nl> - - - a / distribution / RealmIntroExample / build . gradle <nl> + + + b / distribution / RealmIntroExample / build . gradle <nl> @ @ - 6 , 6 + 6 , 7 @ @ buildscript { <nl> } <nl> dependencies { <nl> classpath ' com . android . tools . build : gradle : 1 . 0 . 0 ' <nl> + classpath ' com . novoda : gradle - android - command - plugin : 1 . 3 . 0 ' <nl> } <nl> } <nl> <nl> diff - - git a / distribution / RealmJsonExample / build . gradle b / distribution / RealmJsonExample / build . gradle <nl> index 2027f3b . . 61fd77e 100644 <nl> - - - a / distribution / RealmJsonExample / build . gradle <nl> + + + b / distribution / RealmJsonExample / build . gradle <nl> @ @ - 6 , 6 + 6 , 7 @ @ buildscript { <nl> } <nl> dependencies { <nl> classpath ' com . android . tools . build : gradle : 1 . 0 . 0 ' <nl> + classpath ' com . novoda : gradle - android - command - plugin : 1 . 3 . 0 ' <nl> } <nl> } <nl> <nl> diff - - git a / distribution / RealmMigrationExample / build . gradle b / distribution / RealmMigrationExample / build . gradle <nl> index 2027f3b . . 61fd77e 100644 <nl> - - - a / distribution / RealmMigrationExample / build . gradle <nl> + + + b / distribution / RealmMigrationExample / build . gradle <nl> @ @ - 6 , 6 + 6 , 7 @ @ buildscript { <nl> } <nl> dependencies { <nl> classpath ' com . android . tools . build : gradle : 1 . 0 . 0 ' <nl> + classpath ' com . novoda : gradle - android - command - plugin : 1 . 3 . 0 ' <nl> } <nl> } <nl> <nl> diff - - git a / distribution / RealmThreadExample / build . gradle b / distribution / RealmThreadExample / build . gradle <nl> index b9ed604 . . ae2ac55 100644 <nl> - - - a / distribution / RealmThreadExample / build . gradle <nl> + + + b / distribution / RealmThreadExample / build . gradle <nl> @ @ - 22 , 6 + 22 , 7 @ @ buildscript { <nl> } <nl> dependencies { <nl> classpath ' com . android . tools . build : gradle : 1 . 0 . 0 ' <nl> + classpath ' com . novoda : gradle - android - command - plugin : 1 . 3 . 0 ' <nl> } <nl> } <nl> <nl> diff - - git a / realm / build . gradle b / realm / build . gradle <nl> index daec63d . . 37d00f9 100644 <nl> - - - a / realm / build . gradle <nl> + + + b / realm / build . gradle <nl> @ @ - 23 , 8 + 23 , 8 @ @ android { <nl> / / } <nl> / / } <nl> <nl> - <nl> } <nl> + <nl> dependencies { <nl> compile ' com . intellij : annotations : + @ jar ' <nl> compile files ( " . . / realm - annotations / build / libs / realm - annotations - $ { version } . jar " ) <nl> @ @ - 39 , 7 + 39 , 7 @ @ android . libraryVariants . all { variant - > <nl> return ; / / Skip debug builds . <nl> } <nl> <nl> - task ( " javadoc $ { variant . name . capitalize ( ) } " , type : Javadoc ) { <nl> + def javadocTask = task ( " javadoc $ { variant . name . capitalize ( ) } " , type : Javadoc ) { <nl> description " Generates Javadoc for $ variant . name . " <nl> group ' Docs ' <nl> source = variant . javaCompile . source <nl> @ @ - 55 , 11 + 55 , 11 @ @ android . libraryVariants . all { variant - > <nl> description " Bundles Javadoc into zip for $ variant . name . " <nl> group ' Docs ' <nl> classifier = " javadoc " <nl> - from tasks [ " javadoc $ { variant . name . capitalize ( ) } " ] <nl> + from javadocTask <nl> } <nl> } <nl> <nl> - task androidJar ( type : Jar , dependsOn : [ ' assemble ' , ' bundleJavadocRelease ' ] ) { <nl> + task androidJar ( type : Jar , dependsOn : [ ' assemble ' ] ) { <nl> group ' Build ' <nl> description ' Generates a jar file continaining Realm and its annotation processor ' <nl> from zipTree ( ' build / intermediates / bundles / release / classes . jar ' ) <nl> @ @ - 156 , 10 + 156 , 8 @ @ task compileAnnotations ( type : GradleBuild ) { <nl> tasks = [ ' assemble ' ] <nl> } <nl> <nl> - tasks . preBuild { <nl> - dependsOn compileJni <nl> - dependsOn compileAnnotations <nl> - dependsOn buildApt <nl> + project . afterEvaluate { <nl> + preBuild . dependsOn ( [ ' compileJni ' , ' compileAnnotations ' , ' buildApt ' ] ) <nl> } <nl> <nl> def examples = [ <nl> @ @ - 187 , 7 + 185 , 7 @ @ task generateDistributionExamplesBuildFiles < < { <nl> } <nl> } <nl> <nl> - task populateDistributionFolder ( dependsOn : ' androidJar ' ) < < { <nl> + task populateDistributionFolder ( dependsOn : [ ' androidJar ' , ' bundleJavadocRelease ' ] ) < < { <nl> copy { <nl> from ' . . / changelog . txt ' <nl> from " build / libs / realm - $ { version } . jar " <nl> @ @ - 242 , 3 + 240 , 56 @ @ task createDistributionPackage ( type : Zip ) { <nl> destinationDir = new File ( " $ { rootDir } " ) <nl> archiveName = " realm - java - $ { version } . zip " <nl> } <nl> + <nl> + examples . each ( ) { src , dest - > <nl> + task " distributionMonkey $ { dest } " ( type : GradleBuild ) { <nl> + dependsOn createDistributionFolder <nl> + dependsOn bintrayUpload <nl> + dir = file ( " $ { rootDir } / distribution / $ { dest } " ) <nl> + tasks = [ ' monkeyRelease ' ] <nl> + } <nl> + } <nl> + <nl> + import com . github . skhatri . s3aws . plugin . S3UploadTask <nl> + <nl> + / / This is an ugly hack because we have two links to the latest version . <nl> + / / The right solution here would be to contribute a change to the S3 Gradle plugin <nl> + / / to allow link to be a list of strings . <nl> + [ ' java ' , ' android ' ] . each ( ) { link - > <nl> + task " upload $ { link . capitalize ( ) } DistributionPackage " ( type : S3UploadTask ) { <nl> + examples . each { src , dest - > <nl> + dependsOn " distributionMonkey $ { dest } " <nl> + } <nl> + bucket = ' static . realm . io ' <nl> + file = " $ { rootDir } / realm - java - $ { version } . zip " <nl> + key = ' downloads / java / realm - java - $ { version } . zip ' <nl> + link = " downloads / $ { link } / latest " <nl> + } <nl> + } <nl> + <nl> + task uploadUpdateVersion ( type : S3UploadTask ) { <nl> + [ ' java ' , ' android ' ] . each ( ) { link - > <nl> + dependsOn " upload $ { link . capitalize ( ) } DistributionPackage " <nl> + } <nl> + bucket = ' static . realm . io ' <nl> + file = " $ { rootDir } / version . txt " <nl> + key = ' downloads / update / java ' <nl> + } <nl> + <nl> + task tagRepo ( type : Exec ) { <nl> + dependsOn uploadUpdateVersion <nl> + workingDir rootDir <nl> + commandLine ' git ' , ' tag ' , ' - a ' , " v $ { version } " , ' - m ' , " v $ { version } " <nl> + } <nl> + <nl> + task pushTag ( type : Exec ) { <nl> + dependsOn tagRepo <nl> + workingDir rootDir <nl> + commandLine ' git ' , ' push ' , ' - - tags ' <nl> + } <nl> + <nl> + task release { <nl> + group ' Release ' <nl> + description ' Release realm - java ' <nl> + dependsOn pushTag <nl> + } <nl> \ No newline at end of file <nl> diff - - git a / tools / templates / RealmAdapterExample / build . gradle b / tools / templates / RealmAdapterExample / build . gradle <nl> index dd153d1 . . db868bf 100644 <nl> - - - a / tools / templates / RealmAdapterExample / build . gradle <nl> + + + b / tools / templates / RealmAdapterExample / build . gradle <nl> @ @ - 1 , 4 + 1 , 5 @ @ <nl> apply plugin : ' com . android . application ' <nl> + apply plugin : ' android - command ' <nl> <nl> android { <nl> compileSdkVersion 20 <nl> @ @ - 17 , 6 + 18 , 10 @ @ android { <nl> proguardFiles getDefaultProguardFile ( ' proguard - android . txt ' ) , ' proguard - rules . pro ' <nl> } <nl> } <nl> + <nl> + command { <nl> + events 2000 <nl> + } <nl> } <nl> <nl> dependencies { <nl> diff - - git a / tools / templates / RealmEncryptionExample / build . gradle b / tools / templates / RealmEncryptionExample / build . gradle <nl> index e9efbce . . 98cc353 100644 <nl> - - - a / tools / templates / RealmEncryptionExample / build . gradle <nl> + + + b / tools / templates / RealmEncryptionExample / build . gradle <nl> @ @ - 1 , 4 + 1 , 5 @ @ <nl> apply plugin : ' com . android . application ' <nl> + apply plugin : ' android - command ' <nl> <nl> android { <nl> compileSdkVersion 20 <nl> @ @ - 17 , 6 + 18 , 9 @ @ android { <nl> proguardFiles getDefaultProguardFile ( ' proguard - android . txt ' ) , ' proguard - rules . pro ' <nl> } <nl> } <nl> + command { <nl> + events 2000 <nl> + } <nl> } <nl> <nl> dependencies { <nl> diff - - git a / tools / templates / RealmGridViewExample / build . gradle b / tools / templates / RealmGridViewExample / build . gradle <nl> index be0a2b2 . . 7dbaa96 100644 <nl> - - - a / tools / templates / RealmGridViewExample / build . gradle <nl> + + + b / tools / templates / RealmGridViewExample / build . gradle <nl> @ @ - 1 , 4 + 1 , 5 @ @ <nl> apply plugin : ' com . android . application ' <nl> + apply plugin : ' android - command ' <nl> <nl> android { <nl> compileSdkVersion 20 <nl> @ @ - 17 , 6 + 18 , 9 @ @ android { <nl> proguardFiles getDefaultProguardFile ( ' proguard - android . txt ' ) , ' proguard - rules . pro ' <nl> } <nl> } <nl> + command { <nl> + events 2000 <nl> + } <nl> } <nl> <nl> dependencies { <nl> diff - - git a / tools / templates / RealmIntroExample / build . gradle b / tools / templates / RealmIntroExample / build . gradle <nl> index c0b929f . . 80b5cf8 100644 <nl> - - - a / tools / templates / RealmIntroExample / build . gradle <nl> + + + b / tools / templates / RealmIntroExample / build . gradle <nl> @ @ - 1 , 4 + 1 , 5 @ @ <nl> apply plugin : ' com . android . application ' <nl> + apply plugin : ' android - command ' <nl> <nl> android { <nl> compileSdkVersion 20 <nl> @ @ - 17 , 6 + 18 , 9 @ @ android { <nl> proguardFiles getDefaultProguardFile ( ' proguard - android . txt ' ) , ' proguard - rules . pro ' <nl> } <nl> } <nl> + command { <nl> + events 2000 <nl> + } <nl> } <nl> <nl> dependencies { <nl> diff - - git a / tools / templates / RealmJsonExample / build . gradle b / tools / templates / RealmJsonExample / build . gradle <nl> index f4d5be7 . . c7818f7 100644 <nl> - - - a / tools / templates / RealmJsonExample / build . gradle <nl> + + + b / tools / templates / RealmJsonExample / build . gradle <nl> @ @ - 1 , 4 + 1 , 5 @ @ <nl> apply plugin : ' com . android . application ' <nl> + apply plugin : ' android - command ' <nl> <nl> android { <nl> compileSdkVersion 20 <nl> @ @ - 17 , 6 + 18 , 9 @ @ android { <nl> proguardFiles getDefaultProguardFile ( ' proguard - android . txt ' ) , ' proguard - rules . pro ' <nl> } <nl> } <nl> + command { <nl> + events 2000 <nl> + } <nl> } <nl> <nl> dependencies { <nl> diff - - git a / tools / templates / RealmMigrationExample / build . gradle b / tools / templates / RealmMigrationExample / build . gradle <nl> index b84d005 . . 4c89033 100644 <nl> - - - a / tools / templates / RealmMigrationExample / build . gradle <nl> + + + b / tools / templates / RealmMigrationExample / build . gradle <nl> @ @ - 1 , 4 + 1 , 5 @ @ <nl> apply plugin : ' com . android . application ' <nl> + apply plugin : ' android - command ' <nl> <nl> android { <nl> compileSdkVersion 20 <nl> @ @ - 17 , 6 + 18 , 9 @ @ android { <nl> proguardFiles getDefaultProguardFile ( ' proguard - android . txt ' ) , ' proguard - rules . pro ' <nl> } <nl> } <nl> + command { <nl> + events 2000 <nl> + } <nl> } <nl> <nl> dependencies { <nl> diff - - git a / tools / templates / RealmThreadExample / build . gradle b / tools / templates / RealmThreadExample / build . gradle <nl> index 6c75572 . . e2c0a19 100644 <nl> - - - a / tools / templates / RealmThreadExample / build . gradle <nl> + + + b / tools / templates / RealmThreadExample / build . gradle <nl> @ @ - 15 , 6 + 15 , 7 @ @ <nl> * / <nl> <nl> apply plugin : ' com . android . application ' <nl> + apply plugin : ' android - command ' <nl> <nl> android { <nl> compileSdkVersion 21 <nl> @ @ - 33 , 6 + 34 , 9 @ @ android { <nl> proguardFiles getDefaultProguardFile ( ' proguard - android . txt ' ) , ' proguard - rules . pro ' <nl> } <nl> } <nl> + command { <nl> + events 2000 <nl> + } <nl> } <nl> <nl> dependencies {

TEST DIFF:
diff - - git a / Dockerfile b / Dockerfile 
 index 3d61d47 . . f5a1726 100644 
 - - - a / Dockerfile 
 + + + b / Dockerfile 
 @ @ - 51 , 7 + 51 , 7 @ @ RUN mkdir " $ { ANDROID _ HOME } / licenses " & & \ 
 echo - e " \ n8933bad161af4178b1185d1a37fbf41ea5269c55 " > " $ { ANDROID _ HOME } / licenses / android - sdk - license " 
 RUN sdkmanager - - update 
 RUN sdkmanager ' platform - tools ' 
 - RUN sdkmanager ' build - tools ; 25 . 0 . 3 ' 
 + RUN sdkmanager ' build - tools ; 26 . 0 . 0 ' 
 RUN sdkmanager ' extras ; android ; m2repository ' 
 RUN sdkmanager ' platforms ; android - 25 ' 
 
 diff - - git a / README . md b / README . md 
 index 7c1c74a . . 9c996e8 100644 
 - - - a / README . md 
 + + + b / README . md 
 @ @ - 60 , 8 + 60 , 9 @ @ In case you don ' t want to use the precompiled version , you can build Realm yours 
 # # # Prerequisites 
 
 * Download the [ * * JDK 7 * * ] ( http : / / www . oracle . com / technetwork / java / javase / downloads / jdk7 - downloads - 1880260 . html ) or [ * * JDK 8 * * ] ( http : / / www . oracle . com / technetwork / java / javase / downloads / jdk8 - downloads - 2133151 . html ) from Oracle and install it . 
 - * Download & install the Android SDK * * Build - Tools 25 . 0 . 3 * * , * * Android N ( API 25 ) * * ( for example through Android Studio ’ s * * Android SDK Manager * * ) . 
 + * Download & install the Android SDK * * Build - Tools 26 . 0 . 0 * * , * * Android N ( API 25 ) * * ( for example through Android Studio ’ s * * Android SDK Manager * * ) . 
 * Install CMake from SDK manager in Android Studio ( " SDK Tools " - > " CMake " ) . 
 + * If you use Android Studio , Android Studio 3 . 0 or later is required . 
 
 * Realm currently requires version r10e of the NDK . Download the one appropriate for your development platform , from the NDK [ archive ] ( https : / / developer . android . com / ndk / downloads / older _ releases . html ) . 
 You may unzip the file wherever you choose . For macOS , a suggested location is ` ~ / Library / Android ` . The download will unzip as the directory ` android - ndk - r10e ` . 
 diff - - git a / build . gradle b / build . gradle 
 index a641a7f . . a27e148 100644 
 - - - a / build . gradle 
 + + + b / build . gradle 
 @ @ - 89 , 6 + 89 , 17 @ @ task check { 
 dependsOn checkExamples 
 } 
 
 + task assembleUnitTests ( type : GradleBuild ) { 
 + group = ' Build ' 
 + description = ' Assemble Android unit tests of the Realm project ' 
 + dependsOn installTransformer 
 + buildFile = file ( ' realm / build . gradle ' ) 
 + tasks = [ ' assembleAndroidTest ' ] 
 + if ( project . hasProperty ( ' buildTargetABIs ' ) ) { 
 + startParameter . projectProperties + = [ buildTargetABIs : project . getProperty ( ' buildTargetABIs ' ) ] 
 + } 
 + } 
 + 
 task connectedUnitTests ( type : GradleBuild ) { 
 group = ' Test ' 
 description = ' Run the Android unit tests of the Realm project ' 
 @ @ - 100 , 6 + 111 , 17 @ @ task connectedUnitTests ( type : GradleBuild ) { 
 } 
 } 
 
 + task assembleBenchmarks ( type : GradleBuild ) { 
 + group = ' Build ' 
 + description = ' Assemble benchmark tests for the library ' 
 + dependsOn installTransformer 
 + buildFile = file ( ' library - benchmarks / build . gradle ' ) 
 + tasks = [ ' assembleAndroidTest ' ] 
 + if ( project . hasProperty ( ' buildTargetABIs ' ) ) { 
 + startParameter . projectProperties + = [ buildTargetABIs : project . getProperty ( ' buildTargetABIs ' ) ] 
 + } 
 + } 
 + 
 task connectedBenchmarks ( type : GradleBuild ) { 
 group = ' Test ' 
 description = ' Run all the benchmark tests for the library ' 
 diff - - git a / examples / build . gradle b / examples / build . gradle 
 index 1d0e7df . . aae1dce 100644 
 - - - a / examples / build . gradle 
 + + + b / examples / build . gradle 
 @ @ - 1 , 5 + 1 , 5 @ @ 
 project . ext . sdkVersion = 25 
 - project . ext . buildTools = ' 25 . 0 . 3 ' 
 + project . ext . buildTools = ' 26 . 0 . 0 ' 
 
 / / Don ' t cache SNAPSHOT ( changing ) dependencies . 
 configurations . all { 
 @ @ - 17 , 12 + 17 , 13 @ @ allprojects { 
 
 buildscript { 
 repositories { 
 + google ( ) 
 mavenLocal ( ) 
 jcenter ( ) 
 maven { url ' https : / / jitpack . io ' } 
 } 
 dependencies { 
 - classpath ' com . android . tools . build : gradle : 2 . 3 . 3 ' 
 + classpath ' com . android . tools . build : gradle : 3 . 0 . 0 - alpha4 ' 
 classpath ' com . jfrog . bintray . gradle : gradle - bintray - plugin : 1 . 6 ' 
 classpath ' com . novoda : gradle - android - command - plugin : 1 . 5 . 0 ' 
 classpath " io . realm : realm - gradle - plugin : $ { currentVersion } " 
 @ @ - 35 , 6 + 36 , 7 @ @ allprojects { 
 repositories { 
 mavenLocal ( ) 
 jcenter ( ) 
 + google ( ) 
 } 
 } 
 
 diff - - git a / examples / gradle . properties b / examples / gradle . properties 
 index 4a9594a . . 3cae062 100644 
 - - - a / examples / gradle . properties 
 + + + b / examples / gradle . properties 
 @ @ - 1 + 1 , 5 @ @ 
 - org . gradle . jvmargs = - Xmx2048M 
 \ No newline at end of file 
 + org . gradle . jvmargs = - Xmx2048M 
 + org . gradle . caching = true 
 + 
 + # disable AAPT2 to work around an issue of Robolectric in unitTestExample https : / / github . com / robolectric / robolectric / issues / 3169 
 + android . enableAapt2 = false 
 diff - - git a / examples / gridViewExample / build . gradle b / examples / gridViewExample / build . gradle 
 index 474e861 . . 8d45e3a 100644 
 - - - a / examples / gridViewExample / build . gradle 
 + + + b / examples / gridViewExample / build . gradle 
 @ @ - 37 , 5 + 37 , 5 @ @ android { 
 } 
 
 dependencies { 
 - compile ' com . google . code . gson : gson : 2 . 5 ' 
 + implementation ' com . google . code . gson : gson : 2 . 5 ' 
 } 
 diff - - git a / examples / jsonExample / build . gradle b / examples / jsonExample / build . gradle 
 index c46861f . . cdd8b8a 100644 
 - - - a / examples / jsonExample / build . gradle 
 + + + b / examples / jsonExample / build . gradle 
 @ @ - 12 , 6 + 12 , 7 @ @ android { 
 minSdkVersion 15 
 versionCode 1 
 versionName " 1 . 0 " 
 + javaCompileOptions . annotationProcessorOptions . includeCompileClasspath = true 
 } 
 buildTypes { 
 release { 
 @ @ - 27 , 6 + 28 , 6 @ @ android { 
 } 
 
 dependencies { 
 - provided ' org . projectlombok : lombok : 1 . 16 . 6 ' 
 + compileOnly ' org . projectlombok : lombok : 1 . 16 . 6 ' 
 annotationProcessor ' org . projectlombok : lombok : 1 . 16 . 6 ' 
 } 
 diff - - git a / examples / kotlinExample / build . gradle b / examples / kotlinExample / build . gradle 
 index 763a829 . . d4a434d 100644 
 - - - a / examples / kotlinExample / build . gradle 
 + + + b / examples / kotlinExample / build . gradle 
 @ @ - 45 , 6 + 45 , 6 @ @ android { 
 } 
 
 dependencies { 
 - compile " org . jetbrains . kotlin : kotlin - stdlib - jre7 : $ { kotlin _ version } " 
 - compile ' org . jetbrains . anko : anko - sdk15 : 0 . 9 . 1 ' 
 + implementation " org . jetbrains . kotlin : kotlin - stdlib - jre7 : $ { kotlin _ version } " 
 + implementation ' org . jetbrains . anko : anko - sdk15 : 0 . 9 . 1 ' 
 } 
 diff - - git a / examples / moduleExample / app / build . gradle b / examples / moduleExample / app / build . gradle 
 index cc80f29 . . fe9fbaf 100644 
 - - - a / examples / moduleExample / app / build . gradle 
 + + + b / examples / moduleExample / app / build . gradle 
 @ @ - 37 , 5 + 37 , 5 @ @ android { 
 } 
 
 dependencies { 
 - compile project ( ' : moduleExample : library ' ) 
 + implementation project ( ' : moduleExample : library ' ) 
 } 
 diff - - git a / examples / newsreaderExample / build . gradle b / examples / newsreaderExample / build . gradle 
 index dcc0165 . . 6e08119 100644 
 - - - a / examples / newsreaderExample / build . gradle 
 + + + b / examples / newsreaderExample / build . gradle 
 @ @ - 32 , 18 + 32 , 18 @ @ android { 
 } 
 
 dependencies { 
 - compile fileTree ( dir : ' libs ' , include : [ ' * . jar ' ] ) 
 + implementation fileTree ( dir : ' libs ' , include : [ ' * . jar ' ] ) 
 / / noinspection GradleDependency 
 - compile ' com . android . support : appcompat - v7 : 25 . 2 . 0 ' 
 + implementation ' com . android . support : appcompat - v7 : 25 . 2 . 0 ' 
 / / noinspection GradleDependency 
 - compile ' com . android . support : design : 25 . 2 . 0 ' 
 - compile ' io . reactivex : rxjava : 1 . 1 . 0 ' 
 - compile ' io . reactivex : rxandroid : 1 . 1 . 0 ' 
 - compile ' com . squareup . retrofit : retrofit : 2 . 0 . 0 - beta2 ' 
 - compile ' com . squareup . retrofit : converter - jackson : 2 . 0 . 0 - beta2 ' 
 - compile ' com . squareup . retrofit : adapter - rxjava : 2 . 0 . 0 - beta2 ' 
 - compile ' com . jakewharton . timber : timber : 4 . 1 . 0 ' 
 - compile ' com . jakewharton : butterknife : 8 . 5 . 1 ' 
 + implementation ' com . android . support : design : 25 . 2 . 0 ' 
 + implementation ' io . reactivex : rxjava : 1 . 1 . 0 ' 
 + implementation ' io . reactivex : rxandroid : 1 . 1 . 0 ' 
 + implementation ' com . squareup . retrofit : retrofit : 2 . 0 . 0 - beta2 ' 
 + implementation ' com . squareup . retrofit : converter - jackson : 2 . 0 . 0 - beta2 ' 
 + implementation ' com . squareup . retrofit : adapter - rxjava : 2 . 0 . 0 - beta2 ' 
 + implementation ' com . jakewharton . timber : timber : 4 . 1 . 0 ' 
 + implementation ' com . jakewharton : butterknife : 8 . 5 . 1 ' 
 annotationProcessor ' com . jakewharton : butterknife - compiler : 8 . 5 . 1 ' 
 - compile ' me . zhanghai . android . materialprogressbar : library : 1 . 1 . 4 ' 
 + implementation ' me . zhanghai . android . materialprogressbar : library : 1 . 1 . 4 ' 
 } 
 diff - - git a / examples / objectServerExample / build . gradle b / examples / objectServerExample / build . gradle 
 index e976f16 . . f16e3db 100644 
 - - - a / examples / objectServerExample / build . gradle 
 + + + b / examples / objectServerExample / build . gradle 
 @ @ - 60 , 10 + 60 , 10 @ @ realm { 
 } 
 
 dependencies { 
 - compile ' com . android . support : support - v4 : 25 . 2 . 0 ' 
 - compile ' com . android . support : appcompat - v7 : 25 . 2 . 0 ' 
 - compile ' com . android . support : design : 25 . 2 . 0 ' 
 - compile ' me . zhanghai . android . materialprogressbar : library : 1 . 3 . 0 ' 
 - compile ' com . jakewharton : butterknife : 8 . 5 . 1 ' 
 + implementation ' com . android . support : support - v4 : 25 . 2 . 0 ' 
 + implementation ' com . android . support : appcompat - v7 : 25 . 2 . 0 ' 
 + implementation ' com . android . support : design : 25 . 2 . 0 ' 
 + implementation ' me . zhanghai . android . materialprogressbar : library : 1 . 3 . 0 ' 
 + implementation ' com . jakewharton : butterknife : 8 . 5 . 1 ' 
 annotationProcessor ' com . jakewharton : butterknife - compiler : 8 . 5 . 1 ' 
 } 
 diff - - git a / examples / rxJavaExample / build . gradle b / examples / rxJavaExample / build . gradle 
 index 9a916ed . . 21c4723 100644 
 - - - a / examples / rxJavaExample / build . gradle 
 + + + b / examples / rxJavaExample / build . gradle 
 @ @ - 29 , 8 + 29 , 8 @ @ android { 
 } 
 
 dependencies { 
 - compile ' io . reactivex : rxandroid : 1 . 1 . 0 ' 
 - compile ' io . reactivex : rxjava : 1 . 1 . 0 ' 
 - compile ' com . jakewharton . rxbinding : rxbinding : 0 . 3 . 0 ' 
 - compile ' com . squareup . retrofit : retrofit : 1 . 9 . 0 ' 
 + implementation ' io . reactivex : rxandroid : 1 . 1 . 0 ' 
 + implementation ' io . reactivex : rxjava : 1 . 1 . 0 ' 
 + implementation ' com . jakewharton . rxbinding : rxbinding : 0 . 3 . 0 ' 
 + implementation ' com . squareup . retrofit : retrofit : 1 . 9 . 0 ' 
 } 
 diff - - git a / examples / secureTokenAndroidKeyStore / build . gradle b / examples / secureTokenAndroidKeyStore / build . gradle 
 index a15da44 . . 2059678 100644 
 - - - a / examples / secureTokenAndroidKeyStore / build . gradle 
 + + + b / examples / secureTokenAndroidKeyStore / build . gradle 
 @ @ - 24 , 13 + 24 , 13 @ @ android { 
 } 
 
 dependencies { 
 - compile fileTree ( dir : ' libs ' , include : [ ' * . jar ' ] ) 
 - androidTestCompile ( ' com . android . support . test . espresso : espresso - core : 2 . 2 . 2 ' , { 
 + implementation fileTree ( dir : ' libs ' , include : [ ' * . jar ' ] ) 
 + androidTestImplementation ( ' com . android . support . test . espresso : espresso - core : 2 . 2 . 2 ' , { 
 exclude group : ' com . android . support ' , module : ' support - annotations ' 
 } ) 
 - compile ' com . android . support : appcompat - v7 : 25 . 2 . 0 ' 
 - testCompile ' junit : junit : 4 . 12 ' 
 - compile ' io . realm : secure - userstore : 1 . 0 . 1 ' 
 + implementation ' com . android . support : appcompat - v7 : 25 . 2 . 0 ' 
 + testImplementation ' junit : junit : 4 . 12 ' 
 + implementation ' io . realm : secure - userstore : 1 . 0 . 1 ' 
 } 
 
 realm { 
 diff - - git a / examples / threadExample / build . gradle b / examples / threadExample / build . gradle 
 index 98ec9f1 . . 5ebeb26 100644 
 - - - a / examples / threadExample / build . gradle 
 + + + b / examples / threadExample / build . gradle 
 @ @ - 25 , 5 + 25 , 5 @ @ android { 
 
 dependencies { 
 / / noinspection GradleDependency 
 - compile ' com . android . support : appcompat - v7 : 24 . 0 . 0 ' 
 + implementation ' com . android . support : appcompat - v7 : 24 . 0 . 0 ' 
 } 
 diff - - git a / examples / unitTestExample / build . gradle b / examples / unitTestExample / build . gradle 
 index 7923164 . . 2270fa1 100644 
 - - - a / examples / unitTestExample / build . gradle 
 + + + b / examples / unitTestExample / build . gradle 
 @ @ - 30 , 23 + 30 , 23 @ @ android { 
 
 
 dependencies { 
 - testCompile ' io . reactivex : rxjava : 1 . 1 . 0 ' 
 + testImplementation ' io . reactivex : rxjava : 1 . 1 . 0 ' 
 
 / / Testing 
 - testCompile ' junit : junit : 4 . 12 ' 
 - testCompile " org . robolectric : robolectric : 3 . 3 . 2 " 
 - testCompile " org . mockito : mockito - core : 1 . 10 . 19 " 
 - testCompile ' org . robolectric : shadows - support - v4 : 3 . 0 ' 
 + testImplementation ' junit : junit : 4 . 12 ' 
 + testImplementation " org . robolectric : robolectric : 3 . 3 . 2 " 
 + testImplementation " org . mockito : mockito - core : 1 . 10 . 19 " 
 + testImplementation ' org . robolectric : shadows - support - v4 : 3 . 0 ' 
 
 - testCompile " org . powermock : powermock - module - junit4 - rule : 1 . 6 . 5 " 
 - testCompile " org . powermock : powermock - module - junit4 : 1 . 6 . 5 " 
 - testCompile " org . powermock : powermock - api - mockito : 1 . 6 . 5 " 
 - testCompile " org . powermock : powermock - classloading - xstream : 1 . 6 . 5 " 
 + testImplementation " org . powermock : powermock - module - junit4 : 1 . 6 . 5 " 
 + testImplementation " org . powermock : powermock - module - junit4 - rule : 1 . 6 . 5 " 
 + testImplementation " org . powermock : powermock - api - mockito : 1 . 6 . 5 " 
 + testImplementation " org . powermock : powermock - classloading - xstream : 1 . 6 . 5 " 
 
 
 - androidTestCompile ' com . android . support . test : runner : 0 . 5 ' 
 + androidTestImplementation ' com . android . support . test : runner : 0 . 5 ' 
 / / Set this dependency to use JUnit 4 rules 
 - androidTestCompile ' com . android . support . test : rules : 0 . 5 ' 
 + androidTestImplementation ' com . android . support . test : rules : 0 . 5 ' 
 / / Set this dependency to build and run Espresso tests 
 - androidTestCompile ' com . android . support . test . espresso : espresso - core : 2 . 2 . 2 ' 
 + androidTestImplementation ' com . android . support . test . espresso : espresso - core : 2 . 2 . 2 ' 
 } 
 diff - - git a / gradle - plugin / gradle . properties b / gradle - plugin / gradle . properties 
 new file mode 100644 
 index 0000000 . . 1608900 
 - - - / dev / null 
 + + + b / gradle - plugin / gradle . properties 
 @ @ - 0 , 0 + 1 @ @ 
 + org . gradle . caching = true 
 diff - - git a / gradle - plugin / src / main / groovy / io / realm / gradle / Realm . groovy b / gradle - plugin / src / main / groovy / io / realm / gradle / Realm . groovy 
 index 43bf3f8 . . 6a24fa4 100644 
 - - - a / gradle - plugin / src / main / groovy / io / realm / gradle / Realm . groovy 
 + + + b / gradle - plugin / src / main / groovy / io / realm / gradle / Realm . groovy 
 @ @ - 23 , 6 + 23 , 7 @ @ import io . realm . transformer . RealmTransformer 
 import org . gradle . api . GradleException 
 import org . gradle . api . Plugin 
 import org . gradle . api . Project 
 + import org . gradle . api . artifacts . UnknownConfigurationException 
 
 class Realm implements Plugin < Project > { 
 
 @ @ - 40 , 7 + 41 , 8 @ @ class Realm implements Plugin < Project > { 
 } 
 
 def syncEnabledDefault = false 
 - project . extensions . create ( ' realm ' , RealmPluginExtension , project , syncEnabledDefault ) 
 + def dependencyConfigurationName = getDependencyConfigurationName ( project ) 
 + project . extensions . create ( ' realm ' , RealmPluginExtension , project , syncEnabledDefault , dependencyConfigurationName ) 
 
 def usesAptPlugin = project . plugins . findPlugin ( ' com . neenbedankt . android - apt ' ) ! = null 
 def isKotlinProject = project . plugins . findPlugin ( ' kotlin - android ' ) ! = null 
 @ @ - 57 , 7 + 59 , 7 @ @ class Realm implements Plugin < Project > { 
 project . android . registerTransform ( new RealmTransformer ( project ) ) 
 
 project . repositories . add ( project . getRepositories ( ) . jcenter ( ) ) 
 - project . dependencies . add ( " compile " , " io . realm : realm - annotations : $ { Version . VERSION } " ) 
 + project . dependencies . add ( dependencyConfigurationName , " io . realm : realm - annotations : $ { Version . VERSION } " ) 
 if ( usesAptPlugin ) { 
 project . dependencies . add ( " apt " , " io . realm : realm - annotations - processor : $ { Version . VERSION } " ) 
 project . dependencies . add ( " androidTestApt " , " io . realm : realm - annotations - processor : $ { Version . VERSION } " ) 
 @ @ - 80 , 6 + 82 , 22 @ @ class Realm implements Plugin < Project > { 
 } 
 } 
 
 + private static String getDependencyConfigurationName ( Project project ) { 
 + / * 
 + * Dependency configuration name for android gradle plugin 3 . 0 . 0 - * . 
 + * We need to use ' api ' instead of ' implementation ' since user ' s model class 
 + * might be using Realm ' s classes and annotations . 
 + * / 
 + def newDependencyName = " api " 
 + def oldDependencyName = " compile " 
 + try { 
 + project . getConfigurations ( ) . getByName ( newDependencyName ) 
 + return newDependencyName 
 + } catch ( UnknownConfigurationException ignored ) { 
 + oldDependencyName 
 + } 
 + } 
 + 
 private static boolean shouldApplyAndroidAptPlugin ( boolean usesAptPlugin , boolean isKotlinProject , 
 boolean hasAnnotationProcessorConfiguration , 
 boolean preferAptOnKotlinProject ) { 
 diff - - git a / gradle - plugin / src / main / groovy / io / realm / gradle / RealmPluginExtension . groovy b / gradle - plugin / src / main / groovy / io / realm / gradle / RealmPluginExtension . groovy 
 index ac2fc40 . . 42bd8e5 100644 
 - - - a / gradle - plugin / src / main / groovy / io / realm / gradle / RealmPluginExtension . groovy 
 + + + b / gradle - plugin / src / main / groovy / io / realm / gradle / RealmPluginExtension . groovy 
 @ @ - 21 , 9 + 21 , 11 @ @ import org . gradle . api . Project 
 class RealmPluginExtension { 
 private Project project 
 def boolean syncEnabled 
 + private String dependencyConfigurationName 
 
 - RealmPluginExtension ( Project project , boolean syncEnabledDefault ) { 
 + RealmPluginExtension ( Project project , boolean syncEnabledDefault , String dependencyConfigurationName ) { 
 this . project = project 
 + this . dependencyConfigurationName = dependencyConfigurationName 
 setSyncEnabled ( syncEnabledDefault ) 
 } 
 
 @ @ - 31 , 7 + 33 , 7 @ @ class RealmPluginExtension { 
 this . syncEnabled = value ; 
 
 / / remove realm android library first 
 - def iterator = project . getConfigurations ( ) . getByName ( " compile " ) . getDependencies ( ) . iterator ( ) ; 
 + def iterator = project . getConfigurations ( ) . getByName ( dependencyConfigurationName ) . getDependencies ( ) . iterator ( ) ; 
 while ( iterator . hasNext ( ) ) { 
 def item = iterator . next ( ) 
 if ( item . group = = ' io . realm ' & & item . name . startsWith ( ' realm - android - library ' ) ) { 
 @ @ - 41 , 6 + 43 , 6 @ @ class RealmPluginExtension { 
 
 / / then add again 
 def artifactName = " realm - android - library $ { syncEnabled ? ' - object - server ' : ' ' } " 
 - project . dependencies . add ( " compile " , " io . realm : $ { artifactName } : $ { Version . VERSION } " ) 
 + project . dependencies . add ( dependencyConfigurationName , " io . realm : $ { artifactName } : $ { Version . VERSION } " ) 
 } 
 } 
 diff - - git a / library - benchmarks / build . gradle b / library - benchmarks / build . gradle 
 index e185b78 . . 38703ec 100644 
 - - - a / library - benchmarks / build . gradle 
 + + + b / library - benchmarks / build . gradle 
 @ @ - 1 , 10 + 1 , 11 @ @ 
 buildscript { 
 repositories { 
 mavenLocal ( ) 
 + google ( ) 
 jcenter ( ) 
 } 
 dependencies { 
 - classpath ' com . android . tools . build : gradle : 2 . 3 . 2 ' 
 + classpath ' com . android . tools . build : gradle : 3 . 0 . 0 - alpha4 ' 
 classpath " io . realm : realm - gradle - plugin : $ { file ( " $ { rootDir } / . . / version . txt " ) . text . trim ( ) } " 
 } 
 } 
 @ @ - 26 , 7 + 27 , 7 @ @ apply plugin : ' realm - android ' 
 
 android { 
 compileSdkVersion 25 
 - buildToolsVersion " 25 . 0 . 3 " 
 + buildToolsVersion " 26 . 0 . 0 " 
 
 defaultConfig { 
 minSdkVersion 15 
 @ @ - 47 , 14 + 48 , 15 @ @ android { 
 
 repositories { 
 mavenLocal ( ) 
 + google ( ) 
 jcenter ( ) 
 } 
 
 dependencies { 
 - androidTestCompile ' com . android . support . test : runner : 0 . 5 ' 
 - androidTestCompile ' com . android . support . test : rules : 0 . 5 ' 
 - androidTestCompile ' junit : junit : 4 . 12 ' 
 - androidTestCompile ' dk . ilios : spanner : 0 . 6 . 0 ' 
 - androidTestCompile ' com . opencsv : opencsv : 3 . 4 ' 
 - androidTestCompile ' junit : junit : 4 . 12 ' 
 - } 
 \ No newline at end of file 
 + androidTestImplementation ' com . android . support . test : runner : 0 . 5 ' 
 + androidTestImplementation ' com . android . support . test : rules : 0 . 5 ' 
 + androidTestImplementation ' junit : junit : 4 . 12 ' 
 + androidTestImplementation ' dk . ilios : spanner : 0 . 6 . 0 ' 
 + androidTestImplementation ' com . opencsv : opencsv : 3 . 4 ' 
 + androidTestImplementation ' junit : junit : 4 . 12 ' 
 + } 
 diff - - git a / realm - annotations / gradle . properties b / realm - annotations / gradle . properties 
 new file mode 100644 
 index 0000000 . . 1608900 
 - - - / dev / null 
 + + + b / realm - annotations / gradle . properties 
 @ @ - 0 , 0 + 1 @ @ 
 + org . gradle . caching = true 
 diff - - git a / realm - transformer / gradle . properties b / realm - transformer / gradle . properties 
 new file mode 100644 
 index 0000000 . . 1608900 
 - - - / dev / null 
 + + + b / realm - transformer / gradle . properties 
 @ @ - 0 , 0 + 1 @ @ 
 + org . gradle . caching = true 
 diff - - git a / realm - transformer / src / main / groovy / io / realm / transformer / RealmTransformer . groovy b / realm - transformer / src / main / groovy / io / realm / transformer / RealmTransformer . groovy 
 index b02d1a6 . . bd99fb2 100644 
 - - - a / realm - transformer / src / main / groovy / io / realm / transformer / RealmTransformer . groovy 
 + + + b / realm - transformer / src / main / groovy / io / realm / transformer / RealmTransformer . groovy 
 @ @ - 66 , 6 + 66 , 7 @ @ class RealmTransformer extends Transform { 
 
 @ Override 
 Set < Scope > getReferencedScopes ( ) { 
 + / / Scope . PROJECT _ LOCAL _ DEPS and Scope . SUB _ PROJECTS _ LOCAL _ DEPS is only for compatibility with AGP 1 . x , 2 . x 
 return Sets . immutableEnumSet ( Scope . EXTERNAL _ LIBRARIES , Scope . PROJECT _ LOCAL _ DEPS , 
 Scope . SUB _ PROJECTS , Scope . SUB _ PROJECTS _ LOCAL _ DEPS , Scope . TESTED _ CODE ) 
 } 
 diff - - git a / realm / build . gradle b / realm / build . gradle 
 index eed9593 . . 37a4993 100644 
 - - - a / realm / build . gradle 
 + + + b / realm / build . gradle 
 @ @ - 2 , 13 + 2 , 14 @ @ buildscript { 
 ext . kotlin _ version = ' 1 . 1 . 2 - 5 ' 
 repositories { 
 mavenLocal ( ) 
 + google ( ) 
 jcenter ( ) 
 maven { url ' https : / / jitpack . io ' } 
 maven { url " https : / / plugins . gradle . org / m2 / " } 
 } 
 
 dependencies { 
 - classpath ' com . android . tools . build : gradle : 2 . 3 . 3 ' 
 + classpath ' com . android . tools . build : gradle : 3 . 0 . 0 - alpha4 ' 
 classpath ' de . undercouch : gradle - download - task : 3 . 1 . 1 ' 
 classpath ' com . github . dcendents : android - maven - gradle - plugin : 1 . 5 ' 
 classpath ' com . novoda : gradle - android - command - plugin : 1 . 5 . 0 ' 
 @ @ - 33 , 6 + 34 , 7 @ @ allprojects { 
 version = file ( " $ { rootDir } / . . / version . txt " ) . text . trim ( ) ; 
 repositories { 
 mavenLocal ( ) 
 + google ( ) 
 jcenter ( ) 
 } 
 } 
 diff - - git a / realm / gradle . properties b / realm / gradle . properties 
 index f3f16fc . . 0be17a4 100644 
 - - - a / realm / gradle . properties 
 + + + b / realm / gradle . properties 
 @ @ - 1 + 1 , 2 @ @ 
 org . gradle . jvmargs = - Xms512m - Xmx2048m 
 + org . gradle . caching = true 
 diff - - git a / realm / realm - library / build . gradle b / realm / realm - library / build . gradle 
 index 01283a6 . . f1e2dfe 100644 
 - - - a / realm / realm - library / build . gradle 
 + + + b / realm / realm - library / build . gradle 
 @ @ - 38 , 7 + 38 , 7 @ @ ext . lcachePath = project . findProperty ( ' lcachePath ' ) ? : System . getenv ( ' NDK _ LCACHE 
 
 android { 
 compileSdkVersion 25 
 - buildToolsVersion ' 25 . 0 . 3 ' 
 + buildToolsVersion ' 26 . 0 . 0 ' 
 
 defaultConfig { 
 minSdkVersion 9 
 @ @ - 111 , 8 + 111 , 11 @ @ android { 
 abortOnError false 
 } 
 
 + flavorDimensions ' api ' 
 + 
 productFlavors { 
 base { 
 + dimension ' api ' 
 externalNativeBuild { 
 cmake { 
 arguments " - DREALM _ FLAVOR = base " 
 @ @ - 121 , 6 + 124 , 7 @ @ android { 
 consumerProguardFiles ' proguard - rules - common . pro ' , ' proguard - rules - base . pro ' 
 } 
 objectServer { 
 + dimension ' api ' 
 externalNativeBuild { 
 cmake { 
 arguments " - DREALM _ FLAVOR = objectServer " 
 @ @ - 159 , 26 + 163 , 26 @ @ repositories { 
 
 dependencies { 
 
 - provided ' io . reactivex : rxjava : 1 . 1 . 0 ' 
 - provided ' com . google . code . findbugs : findbugs - annotations : 3 . 0 . 1 ' 
 + compileOnly ' io . reactivex : rxjava : 1 . 1 . 0 ' 
 + compileOnly ' com . google . code . findbugs : findbugs - annotations : 3 . 0 . 1 ' 
 
 - compile " io . realm : realm - annotations : $ { version } " 
 - compile ' com . getkeepsafe . relinker : relinker : 1 . 2 . 2 ' 
 + api " io . realm : realm - annotations : $ { version } " 
 + implementation ' com . getkeepsafe . relinker : relinker : 1 . 2 . 2 ' 
 
 kaptObjectServer project ( ' : realm - annotations - processor ' ) 
 - objectServerCompile ' com . squareup . okhttp3 : okhttp : 3 . 4 . 1 ' 
 + objectServerImplementation ' com . squareup . okhttp3 : okhttp : 3 . 4 . 1 ' 
 
 kaptAndroidTest project ( ' : realm - annotations - processor ' ) 
 - androidTestCompile fileTree ( dir : ' testLibs ' , include : [ ' * . jar ' ] ) 
 - androidTestCompile ' io . reactivex : rxjava : 1 . 1 . 0 ' 
 - androidTestCompile ' com . android . support : support - annotations : 25 . 3 . 1 ' 
 - androidTestCompile ' com . android . support . test : runner : 0 . 5 ' 
 - androidTestCompile ' com . android . support . test : rules : 0 . 5 ' 
 - androidTestCompile ' com . google . dexmaker : dexmaker : 1 . 2 ' 
 - androidTestCompile ' com . google . dexmaker : dexmaker - mockito : 1 . 2 ' 
 - androidTestCompile ' org . hamcrest : hamcrest - library : 1 . 3 ' 
 - androidTestCompile " org . jetbrains . kotlin : kotlin - stdlib - jre7 : $ kotlin _ version " 
 - androidTestCompile " org . jetbrains . kotlin : kotlin - reflect : $ kotlin _ version " 
 + androidTestImplementation fileTree ( dir : ' testLibs ' , include : [ ' * . jar ' ] ) 
 + androidTestImplementation ' io . reactivex : rxjava : 1 . 1 . 0 ' 
 + androidTestImplementation ' com . android . support : support - annotations : 25 . 3 . 1 ' 
 + androidTestImplementation ' com . android . support . test : runner : 0 . 5 ' 
 + androidTestImplementation ' com . android . support . test : rules : 0 . 5 ' 
 + androidTestImplementation ' com . google . dexmaker : dexmaker : 1 . 2 ' 
 + androidTestImplementation ' com . google . dexmaker : dexmaker - mockito : 1 . 2 ' 
 + androidTestImplementation ' org . hamcrest : hamcrest - library : 1 . 3 ' 
 + androidTestImplementation " org . jetbrains . kotlin : kotlin - stdlib - jre7 : $ kotlin _ version " 
 + androidTestImplementation " org . jetbrains . kotlin : kotlin - reflect : $ kotlin _ version " 
 } 
 
 task sourcesJar ( type : Jar ) { 
 @ @ - 360 , 7 + 364 , 7 @ @ publishing { 
 artifact sourcesJar 
 artifact javadocJar 
 
 - pom . withXml ( createPomDependencies ( [ " baseCompile " , " compile " ] ) ) 
 + pom . withXml ( createPomDependencies ( [ " baseImplementation " , " implementation " , " baseApi " , " api " ] ) ) 
 } 
 
 objectServerPublication ( MavenPublication ) { 
 @ @ - 371 , 7 + 375 , 7 @ @ publishing { 
 artifact sourcesJar 
 artifact javadocJar 
 
 - pom . withXml ( createPomDependencies ( [ " objectServerCompile " , " compile " ] ) ) 
 + pom . withXml ( createPomDependencies ( [ " objectServerImplementation " , " implementation " , " objectServerApi " , " api " ] ) ) 
 } 
 } 
 repositories {

NEAREST DIFF:
diff - - git a / build . gradle b / build . gradle 
 index 05c1bdf . . f19347a 100644 
 - - - a / build . gradle 
 + + + b / build . gradle 
 @ @ - 9 , 6 + 9 , 7 @ @ buildscript { 
 classpath ' com . jfrog . bintray . gradle : gradle - bintray - plugin : 0 . 5 ' / / Version 0 . 6 seems to require gradle 2 . 0 + 
 classpath ' com . jakewharton . sdkmanager : gradle - plugin : 0 . 12 . 0 ' 
 classpath ' com . novoda : gradle - android - command - plugin : 1 . 3 . 0 ' 
 + classpath ' com . github . skhatri : gradle - s3 - plugin : 1 . 0 . 0 ' 
 } 
 } 
 
 diff - - git a / distribution / RealmAdapterExample / build . gradle b / distribution / RealmAdapterExample / build . gradle 
 index 2027f3b . . 61fd77e 100644 
 - - - a / distribution / RealmAdapterExample / build . gradle 
 + + + b / distribution / RealmAdapterExample / build . gradle 
 @ @ - 6 , 6 + 6 , 7 @ @ buildscript { 
 } 
 dependencies { 
 classpath ' com . android . tools . build : gradle : 1 . 0 . 0 ' 
 + classpath ' com . novoda : gradle - android - command - plugin : 1 . 3 . 0 ' 
 } 
 } 
 
 diff - - git a / distribution / RealmEncryptionExample / build . gradle b / distribution / RealmEncryptionExample / build . gradle 
 index 2027f3b . . 61fd77e 100644 
 - - - a / distribution / RealmEncryptionExample / build . gradle 
 + + + b / distribution / RealmEncryptionExample / build . gradle 
 @ @ - 6 , 6 + 6 , 7 @ @ buildscript { 
 } 
 dependencies { 
 classpath ' com . android . tools . build : gradle : 1 . 0 . 0 ' 
 + classpath ' com . novoda : gradle - android - command - plugin : 1 . 3 . 0 ' 
 } 
 } 
 
 diff - - git a / distribution / RealmGridViewExample / build . gradle b / distribution / RealmGridViewExample / build . gradle 
 index 2027f3b . . 61fd77e 100644 
 - - - a / distribution / RealmGridViewExample / build . gradle 
 + + + b / distribution / RealmGridViewExample / build . gradle 
 @ @ - 6 , 6 + 6 , 7 @ @ buildscript { 
 } 
 dependencies { 
 classpath ' com . android . tools . build : gradle : 1 . 0 . 0 ' 
 + classpath ' com . novoda : gradle - android - command - plugin : 1 . 3 . 0 ' 
 } 
 } 
 
 diff - - git a / distribution / RealmIntroExample / build . gradle b / distribution / RealmIntroExample / build . gradle 
 index 2027f3b . . 61fd77e 100644 
 - - - a / distribution / RealmIntroExample / build . gradle 
 + + + b / distribution / RealmIntroExample / build . gradle 
 @ @ - 6 , 6 + 6 , 7 @ @ buildscript { 
 } 
 dependencies { 
 classpath ' com . android . tools . build : gradle : 1 . 0 . 0 ' 
 + classpath ' com . novoda : gradle - android - command - plugin : 1 . 3 . 0 ' 
 } 
 } 
 
 diff - - git a / distribution / RealmJsonExample / build . gradle b / distribution / RealmJsonExample / build . gradle 
 index 2027f3b . . 61fd77e 100644 
 - - - a / distribution / RealmJsonExample / build . gradle 
 + + + b / distribution / RealmJsonExample / build . gradle 
 @ @ - 6 , 6 + 6 , 7 @ @ buildscript { 
 } 
 dependencies { 
 classpath ' com . android . tools . build : gradle : 1 . 0 . 0 ' 
 + classpath ' com . novoda : gradle - android - command - plugin : 1 . 3 . 0 ' 
 } 
 } 
 
 diff - - git a / distribution / RealmMigrationExample / build . gradle b / distribution / RealmMigrationExample / build . gradle 
 index 2027f3b . . 61fd77e 100644 
 - - - a / distribution / RealmMigrationExample / build . gradle 
 + + + b / distribution / RealmMigrationExample / build . gradle 
 @ @ - 6 , 6 + 6 , 7 @ @ buildscript { 
 } 
 dependencies { 
 classpath ' com . android . tools . build : gradle : 1 . 0 . 0 ' 
 + classpath ' com . novoda : gradle - android - command - plugin : 1 . 3 . 0 ' 
 } 
 } 
 
 diff - - git a / distribution / RealmThreadExample / build . gradle b / distribution / RealmThreadExample / build . gradle 
 index b9ed604 . . ae2ac55 100644 
 - - - a / distribution / RealmThreadExample / build . gradle 
 + + + b / distribution / RealmThreadExample / build . gradle 
 @ @ - 22 , 6 + 22 , 7 @ @ buildscript { 
 } 
 dependencies { 
 classpath ' com . android . tools . build : gradle : 1 . 0 . 0 ' 
 + classpath ' com . novoda : gradle - android - command - plugin : 1 . 3 . 0 ' 
 } 
 } 
 
 diff - - git a / realm / build . gradle b / realm / build . gradle 
 index daec63d . . 37d00f9 100644 
 - - - a / realm / build . gradle 
 + + + b / realm / build . gradle 
 @ @ - 23 , 8 + 23 , 8 @ @ android { 
 / / } 
 / / } 
 
 - 
 } 
 + 
 dependencies { 
 compile ' com . intellij : annotations : + @ jar ' 
 compile files ( " . . / realm - annotations / build / libs / realm - annotations - $ { version } . jar " ) 
 @ @ - 39 , 7 + 39 , 7 @ @ android . libraryVariants . all { variant - > 
 return ; / / Skip debug builds . 
 } 
 
 - task ( " javadoc $ { variant . name . capitalize ( ) } " , type : Javadoc ) { 
 + def javadocTask = task ( " javadoc $ { variant . name . capitalize ( ) } " , type : Javadoc ) { 
 description " Generates Javadoc for $ variant . name . " 
 group ' Docs ' 
 source = variant . javaCompile . source 
 @ @ - 55 , 11 + 55 , 11 @ @ android . libraryVariants . all { variant - > 
 description " Bundles Javadoc into zip for $ variant . name . " 
 group ' Docs ' 
 classifier = " javadoc " 
 - from tasks [ " javadoc $ { variant . name . capitalize ( ) } " ] 
 + from javadocTask 
 } 
 } 
 
 - task androidJar ( type : Jar , dependsOn : [ ' assemble ' , ' bundleJavadocRelease ' ] ) { 
 + task androidJar ( type : Jar , dependsOn : [ ' assemble ' ] ) { 
 group ' Build ' 
 description ' Generates a jar file continaining Realm and its annotation processor ' 
 from zipTree ( ' build / intermediates / bundles / release / classes . jar ' ) 
 @ @ - 156 , 10 + 156 , 8 @ @ task compileAnnotations ( type : GradleBuild ) { 
 tasks = [ ' assemble ' ] 
 } 
 
 - tasks . preBuild { 
 - dependsOn compileJni 
 - dependsOn compileAnnotations 
 - dependsOn buildApt 
 + project . afterEvaluate { 
 + preBuild . dependsOn ( [ ' compileJni ' , ' compileAnnotations ' , ' buildApt ' ] ) 
 } 
 
 def examples = [ 
 @ @ - 187 , 7 + 185 , 7 @ @ task generateDistributionExamplesBuildFiles < < { 
 } 
 } 
 
 - task populateDistributionFolder ( dependsOn : ' androidJar ' ) < < { 
 + task populateDistributionFolder ( dependsOn : [ ' androidJar ' , ' bundleJavadocRelease ' ] ) < < { 
 copy { 
 from ' . . / changelog . txt ' 
 from " build / libs / realm - $ { version } . jar " 
 @ @ - 242 , 3 + 240 , 56 @ @ task createDistributionPackage ( type : Zip ) { 
 destinationDir = new File ( " $ { rootDir } " ) 
 archiveName = " realm - java - $ { version } . zip " 
 } 
 + 
 + examples . each ( ) { src , dest - > 
 + task " distributionMonkey $ { dest } " ( type : GradleBuild ) { 
 + dependsOn createDistributionFolder 
 + dependsOn bintrayUpload 
 + dir = file ( " $ { rootDir } / distribution / $ { dest } " ) 
 + tasks = [ ' monkeyRelease ' ] 
 + } 
 + } 
 + 
 + import com . github . skhatri . s3aws . plugin . S3UploadTask 
 + 
 + / / This is an ugly hack because we have two links to the latest version . 
 + / / The right solution here would be to contribute a change to the S3 Gradle plugin 
 + / / to allow link to be a list of strings . 
 + [ ' java ' , ' android ' ] . each ( ) { link - > 
 + task " upload $ { link . capitalize ( ) } DistributionPackage " ( type : S3UploadTask ) { 
 + examples . each { src , dest - > 
 + dependsOn " distributionMonkey $ { dest } " 
 + } 
 + bucket = ' static . realm . io ' 
 + file = " $ { rootDir } / realm - java - $ { version } . zip " 
 + key = ' downloads / java / realm - java - $ { version } . zip ' 
 + link = " downloads / $ { link } / latest " 
 + } 
 + } 
 + 
 + task uploadUpdateVersion ( type : S3UploadTask ) { 
 + [ ' java ' , ' android ' ] . each ( ) { link - > 
 + dependsOn " upload $ { link . capitalize ( ) } DistributionPackage " 
 + } 
 + bucket = ' static . realm . io ' 
 + file = " $ { rootDir } / version . txt " 
 + key = ' downloads / update / java ' 
 + } 
 + 
 + task tagRepo ( type : Exec ) { 
 + dependsOn uploadUpdateVersion 
 + workingDir rootDir 
 + commandLine ' git ' , ' tag ' , ' - a ' , " v $ { version } " , ' - m ' , " v $ { version } " 
 + } 
 + 
 + task pushTag ( type : Exec ) { 
 + dependsOn tagRepo 
 + workingDir rootDir 
 + commandLine ' git ' , ' push ' , ' - - tags ' 
 + } 
 + 
 + task release { 
 + group ' Release ' 
 + description ' Release realm - java ' 
 + dependsOn pushTag 
 + } 
 \ No newline at end of file 
 diff - - git a / tools / templates / RealmAdapterExample / build . gradle b / tools / templates / RealmAdapterExample / build . gradle 
 index dd153d1 . . db868bf 100644 
 - - - a / tools / templates / RealmAdapterExample / build . gradle 
 + + + b / tools / templates / RealmAdapterExample / build . gradle 
 @ @ - 1 , 4 + 1 , 5 @ @ 
 apply plugin : ' com . android . application ' 
 + apply plugin : ' android - command ' 
 
 android { 
 compileSdkVersion 20 
 @ @ - 17 , 6 + 18 , 10 @ @ android { 
 proguardFiles getDefaultProguardFile ( ' proguard - android . txt ' ) , ' proguard - rules . pro ' 
 } 
 } 
 + 
 + command { 
 + events 2000 
 + } 
 } 
 
 dependencies { 
 diff - - git a / tools / templates / RealmEncryptionExample / build . gradle b / tools / templates / RealmEncryptionExample / build . gradle 
 index e9efbce . . 98cc353 100644 
 - - - a / tools / templates / RealmEncryptionExample / build . gradle 
 + + + b / tools / templates / RealmEncryptionExample / build . gradle 
 @ @ - 1 , 4 + 1 , 5 @ @ 
 apply plugin : ' com . android . application ' 
 + apply plugin : ' android - command ' 
 
 android { 
 compileSdkVersion 20 
 @ @ - 17 , 6 + 18 , 9 @ @ android { 
 proguardFiles getDefaultProguardFile ( ' proguard - android . txt ' ) , ' proguard - rules . pro ' 
 } 
 } 
 + command { 
 + events 2000 
 + } 
 } 
 
 dependencies { 
 diff - - git a / tools / templates / RealmGridViewExample / build . gradle b / tools / templates / RealmGridViewExample / build . gradle 
 index be0a2b2 . . 7dbaa96 100644 
 - - - a / tools / templates / RealmGridViewExample / build . gradle 
 + + + b / tools / templates / RealmGridViewExample / build . gradle 
 @ @ - 1 , 4 + 1 , 5 @ @ 
 apply plugin : ' com . android . application ' 
 + apply plugin : ' android - command ' 
 
 android { 
 compileSdkVersion 20 
 @ @ - 17 , 6 + 18 , 9 @ @ android { 
 proguardFiles getDefaultProguardFile ( ' proguard - android . txt ' ) , ' proguard - rules . pro ' 
 } 
 } 
 + command { 
 + events 2000 
 + } 
 } 
 
 dependencies { 
 diff - - git a / tools / templates / RealmIntroExample / build . gradle b / tools / templates / RealmIntroExample / build . gradle 
 index c0b929f . . 80b5cf8 100644 
 - - - a / tools / templates / RealmIntroExample / build . gradle 
 + + + b / tools / templates / RealmIntroExample / build . gradle 
 @ @ - 1 , 4 + 1 , 5 @ @ 
 apply plugin : ' com . android . application ' 
 + apply plugin : ' android - command ' 
 
 android { 
 compileSdkVersion 20 
 @ @ - 17 , 6 + 18 , 9 @ @ android { 
 proguardFiles getDefaultProguardFile ( ' proguard - android . txt ' ) , ' proguard - rules . pro ' 
 } 
 } 
 + command { 
 + events 2000 
 + } 
 } 
 
 dependencies { 
 diff - - git a / tools / templates / RealmJsonExample / build . gradle b / tools / templates / RealmJsonExample / build . gradle 
 index f4d5be7 . . c7818f7 100644 
 - - - a / tools / templates / RealmJsonExample / build . gradle 
 + + + b / tools / templates / RealmJsonExample / build . gradle 
 @ @ - 1 , 4 + 1 , 5 @ @ 
 apply plugin : ' com . android . application ' 
 + apply plugin : ' android - command ' 
 
 android { 
 compileSdkVersion 20 
 @ @ - 17 , 6 + 18 , 9 @ @ android { 
 proguardFiles getDefaultProguardFile ( ' proguard - android . txt ' ) , ' proguard - rules . pro ' 
 } 
 } 
 + command { 
 + events 2000 
 + } 
 } 
 
 dependencies { 
 diff - - git a / tools / templates / RealmMigrationExample / build . gradle b / tools / templates / RealmMigrationExample / build . gradle 
 index b84d005 . . 4c89033 100644 
 - - - a / tools / templates / RealmMigrationExample / build . gradle 
 + + + b / tools / templates / RealmMigrationExample / build . gradle 
 @ @ - 1 , 4 + 1 , 5 @ @ 
 apply plugin : ' com . android . application ' 
 + apply plugin : ' android - command ' 
 
 android { 
 compileSdkVersion 20 
 @ @ - 17 , 6 + 18 , 9 @ @ android { 
 proguardFiles getDefaultProguardFile ( ' proguard - android . txt ' ) , ' proguard - rules . pro ' 
 } 
 } 
 + command { 
 + events 2000 
 + } 
 } 
 
 dependencies { 
 diff - - git a / tools / templates / RealmThreadExample / build . gradle b / tools / templates / RealmThreadExample / build . gradle 
 index 6c75572 . . e2c0a19 100644 
 - - - a / tools / templates / RealmThreadExample / build . gradle 
 + + + b / tools / templates / RealmThreadExample / build . gradle 
 @ @ - 15 , 6 + 15 , 7 @ @ 
 * / 
 
 apply plugin : ' com . android . application ' 
 + apply plugin : ' android - command ' 
 
 android { 
 compileSdkVersion 21 
 @ @ - 33 , 6 + 34 , 9 @ @ android { 
 proguardFiles getDefaultProguardFile ( ' proguard - android . txt ' ) , ' proguard - rules . pro ' 
 } 
 } 
 + command { 
 + events 2000 
 + } 
 } 
 
 dependencies {
