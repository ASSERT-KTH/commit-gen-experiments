BLEU SCORE: 0.024893534183931972

TEST MSG: optimize imports
GENERATED MSG: Added unit test for primary key migration .

TEST DIFF (one line): diff - - git a / realm / realm - library / src / androidTest / java / io / realm / DynamicRealmObjectTests . java b / realm / realm - library / src / androidTest / java / io / realm / DynamicRealmObjectTests . java <nl> index f0d7f4a . . 4a895c3 100644 <nl> - - - a / realm / realm - library / src / androidTest / java / io / realm / DynamicRealmObjectTests . java <nl> + + + b / realm / realm - library / src / androidTest / java / io / realm / DynamicRealmObjectTests . java <nl> @ @ - 25 , 8 + 25 , 6 @ @ import org . junit . Test ; <nl> import org . junit . rules . ExpectedException ; <nl> import org . junit . runner . RunWith ; <nl> <nl> - import org . junit . Test ; <nl> - <nl> import java . text . ParseException ; <nl> import java . util . Arrays ; <nl> import java . util . Date ; <nl> @ @ - 37 , 16 + 35 , 16 @ @ import io . realm . entities . AllTypes ; <nl> import io . realm . entities . CyclicType ; <nl> import io . realm . entities . Dog ; <nl> import io . realm . entities . NullTypes ; <nl> - import io . realm . exceptions . RealmException ; <nl> import io . realm . entities . Owner ; <nl> + import io . realm . exceptions . RealmException ; <nl> import io . realm . rule . TestRealmConfigurationFactory ; <nl> <nl> import static org . junit . Assert . assertArrayEquals ; <nl> import static org . junit . Assert . assertEquals ; <nl> import static org . junit . Assert . assertFalse ; <nl> + import static org . junit . Assert . assertNotNull ; <nl> import static org . junit . Assert . assertNull ; <nl> import static org . junit . Assert . assertTrue ; <nl> - import static org . junit . Assert . assertNotNull ; <nl> import static org . junit . Assert . fail ; <nl> <nl> @ RunWith ( AndroidJUnit4 . class ) <nl> diff - - git a / realm / realm - library / src / androidTest / java / io / realm / IOSRealmTests . java b / realm / realm - library / src / androidTest / java / io / realm / IOSRealmTests . java <nl> index b1521fa . . cc45110 100644 <nl> - - - a / realm / realm - library / src / androidTest / java / io / realm / IOSRealmTests . java <nl> + + + b / realm / realm - library / src / androidTest / java / io / realm / IOSRealmTests . java <nl> @ @ - 34 , 12 + 34 , 11 @ @ import io . realm . entities . IOSChild ; <nl> import io . realm . internal . Table ; <nl> import io . realm . rule . TestRealmConfigurationFactory ; <nl> <nl> + import static io . realm . internal . test . ExtraTests . assertArrayEquals ; <nl> import static org . junit . Assert . assertEquals ; <nl> - import static org . junit . Assert . assertTrue ; <nl> import static org . junit . Assert . assertFalse ; <nl> import static org . junit . Assert . assertNull ; <nl> - <nl> - import static io . realm . internal . test . ExtraTests . assertArrayEquals ; <nl> + import static org . junit . Assert . assertTrue ; <nl> <nl> / * * <nl> * This class test interoperability with Realms created on iOS . <nl> diff - - git a / realm / realm - library / src / androidTest / java / io / realm / RealmAdapterTest . java b / realm / realm - library / src / androidTest / java / io / realm / RealmAdapterTest . java <nl> index 342232f . . 140eb49 100644 <nl> - - - a / realm / realm - library / src / androidTest / java / io / realm / RealmAdapterTest . java <nl> + + + b / realm / realm - library / src / androidTest / java / io / realm / RealmAdapterTest . java <nl> @ @ - 18 , 9 + 18 , 9 @ @ package io . realm ; <nl> <nl> import android . content . Context ; <nl> import android . support . test . InstrumentationRegistry ; <nl> + import android . support . test . annotation . UiThreadTest ; <nl> import android . support . test . rule . UiThreadTestRule ; <nl> import android . support . test . runner . AndroidJUnit4 ; <nl> - import android . support . test . annotation . UiThreadTest ; <nl> import android . view . View ; <nl> import android . widget . TextView ; <nl> <nl> diff - - git a / realm / realm - library / src / androidTest / java / io / realm / RealmCacheTests . java b / realm / realm - library / src / androidTest / java / io / realm / RealmCacheTests . java <nl> index 3c73dee . . abbc3a3 100644 <nl> - - - a / realm / realm - library / src / androidTest / java / io / realm / RealmCacheTests . java <nl> + + + b / realm / realm - library / src / androidTest / java / io / realm / RealmCacheTests . java <nl> @ @ - 34 , 10 + 34 , 10 @ @ import io . realm . entities . StringOnly ; <nl> import io . realm . rule . TestRealmConfigurationFactory ; <nl> <nl> import static org . junit . Assert . assertEquals ; <nl> - import static org . junit . Assert . assertTrue ; <nl> import static org . junit . Assert . assertFalse ; <nl> - import static org . junit . Assert . assertNull ; <nl> import static org . junit . Assert . assertNotNull ; <nl> + import static org . junit . Assert . assertNull ; <nl> + import static org . junit . Assert . assertTrue ; <nl> import static org . junit . Assert . fail ; <nl> <nl> @ RunWith ( AndroidJUnit4 . class ) <nl> diff - - git a / realm / realm - library / src / androidTest / java / io / realm / RealmObjectTests . java b / realm / realm - library / src / androidTest / java / io / realm / RealmObjectTests . java <nl> index a0e2530 . . 9e758e5 100644 <nl> - - - a / realm / realm - library / src / androidTest / java / io / realm / RealmObjectTests . java <nl> + + + b / realm / realm - library / src / androidTest / java / io / realm / RealmObjectTests . java <nl> @ @ - 25 , 7 + 25 , 6 @ @ import org . junit . Test ; <nl> import org . junit . rules . ExpectedException ; <nl> import org . junit . runner . RunWith ; <nl> <nl> - import java . io . File ; <nl> import java . util . Calendar ; <nl> import java . util . Date ; <nl> import java . util . HashSet ; <nl> diff - - git a / realm / realm - library / src / androidTest / java / io / realm / RealmQueryTests . java b / realm / realm - library / src / androidTest / java / io / realm / RealmQueryTests . java <nl> index c60aa55 . . d766886 100644 <nl> - - - a / realm / realm - library / src / androidTest / java / io / realm / RealmQueryTests . java <nl> + + + b / realm / realm - library / src / androidTest / java / io / realm / RealmQueryTests . java <nl> @ @ - 17 , 7 + 17 , 6 @ @ <nl> package io . realm ; <nl> <nl> import android . os . Looper ; <nl> - import android . support . test . InstrumentationRegistry ; <nl> import android . support . test . runner . AndroidJUnit4 ; <nl> <nl> import org . junit . After ; <nl> @ @ - 27 , 16 + 26 , 14 @ @ import org . junit . Test ; <nl> import org . junit . rules . ExpectedException ; <nl> import org . junit . runner . RunWith ; <nl> <nl> - import java . lang . Exception ; <nl> - import java . lang . Throwable ; <nl> import java . util . ArrayList ; <nl> import java . util . Arrays ; <nl> import java . util . Date ; <nl> import java . util . List ; <nl> import java . util . concurrent . CountDownLatch ; <nl> - import java . util . concurrent . TimeUnit ; <nl> import java . util . concurrent . ExecutorService ; <nl> import java . util . concurrent . Executors ; <nl> + import java . util . concurrent . TimeUnit ; <nl> import java . util . concurrent . atomic . AtomicInteger ; <nl> <nl> import io . realm . entities . AllJavaTypes ; <nl> @ @ - 49 , 9 + 46 , 9 @ @ import io . realm . entities . NonLatinFieldNames ; <nl> import io . realm . entities . NullTypes ; <nl> import io . realm . entities . Owner ; <nl> import io . realm . entities . StringOnly ; <nl> - import io . realm . rule . TestRealmConfigurationFactory ; <nl> import io . realm . rule . RunInLooperThread ; <nl> import io . realm . rule . RunTestInLooperThread ; <nl> + import io . realm . rule . TestRealmConfigurationFactory ; <nl> <nl> import static org . junit . Assert . assertEquals ; <nl> import static org . junit . Assert . assertFalse ; <nl> diff - - git a / realm / realm - library / src / androidTest / java / io / realm / RealmResultsTests . java b / realm / realm - library / src / androidTest / java / io / realm / RealmResultsTests . java <nl> index b800c8d . . 6ac68f2 100644 <nl> - - - a / realm / realm - library / src / androidTest / java / io / realm / RealmResultsTests . java <nl> + + + b / realm / realm - library / src / androidTest / java / io / realm / RealmResultsTests . java <nl> @ @ - 45 , 9 + 45 , 9 @ @ import io . realm . entities . NonLatinFieldNames ; <nl> import io . realm . entities . NullTypes ; <nl> import io . realm . entities . Owner ; <nl> import io . realm . internal . Table ; <nl> - import io . realm . rule . TestRealmConfigurationFactory ; <nl> import io . realm . rule . RunInLooperThread ; <nl> import io . realm . rule . RunTestInLooperThread ; <nl> + import io . realm . rule . TestRealmConfigurationFactory ; <nl> <nl> import static org . junit . Assert . assertEquals ; <nl> import static org . junit . Assert . assertFalse ; <nl> diff - - git a / realm / realm - library / src / androidTest / java / io / realm / RealmSchemaTests . java b / realm / realm - library / src / androidTest / java / io / realm / RealmSchemaTests . java <nl> index 1d5bef1 . . b2172a7 100644 <nl> - - - a / realm / realm - library / src / androidTest / java / io / realm / RealmSchemaTests . java <nl> + + + b / realm / realm - library / src / androidTest / java / io / realm / RealmSchemaTests . java <nl> @ @ - 24 , 14 + 24 , 12 @ @ import org . junit . Rule ; <nl> import org . junit . Test ; <nl> import org . junit . runner . RunWith ; <nl> <nl> - import java . util . ArrayList ; <nl> import java . util . Arrays ; <nl> import java . util . List ; <nl> import java . util . Set ; <nl> <nl> import io . realm . entities . AllJavaTypes ; <nl> import io . realm . entities . Owner ; <nl> - import io . realm . internal . Util ; <nl> import io . realm . rule . TestRealmConfigurationFactory ; <nl> <nl> import static org . junit . Assert . assertEquals ; <nl> diff - - git a / realm / realm - library / src / androidTest / java / io / realm / RxJavaTests . java b / realm / realm - library / src / androidTest / java / io / realm / RxJavaTests . java <nl> index 70f4441 . . 60e60cd 100644 <nl> - - - a / realm / realm - library / src / androidTest / java / io / realm / RxJavaTests . java <nl> + + + b / realm / realm - library / src / androidTest / java / io / realm / RxJavaTests . java <nl> @ @ - 24 , 7 + 24 , 6 @ @ import org . junit . After ; <nl> import org . junit . Before ; <nl> import org . junit . Rule ; <nl> import org . junit . Test ; <nl> - import org . junit . rules . TemporaryFolder ; <nl> import org . junit . runner . RunWith ; <nl> <nl> import java . util . concurrent . CountDownLatch ; <nl> diff - - git a / realm / realm - library / src / androidTest / java / io / realm / entities / DogPrimaryKey . java b / realm / realm - library / src / androidTest / java / io / realm / entities / DogPrimaryKey . java <nl> index 024e6fb . . 21004f0 100644 <nl> - - - a / realm / realm - library / src / androidTest / java / io / realm / entities / DogPrimaryKey . java <nl> + + + b / realm / realm - library / src / androidTest / java / io / realm / entities / DogPrimaryKey . java <nl> @ @ - 20 , 7 + 20 , 6 @ @ package io . realm . entities ; <nl> import java . util . Date ; <nl> <nl> import io . realm . RealmObject ; <nl> - import io . realm . annotations . Index ; <nl> import io . realm . annotations . PrimaryKey ; <nl> <nl> public class DogPrimaryKey extends RealmObject { <nl> diff - - git a / realm / realm - library / src / androidTest / java / io / realm / entities / IOSAllTypes . java b / realm / realm - library / src / androidTest / java / io / realm / entities / IOSAllTypes . java <nl> index f3c15b7 . . db36d1a 100644 <nl> - - - a / realm / realm - library / src / androidTest / java / io / realm / entities / IOSAllTypes . java <nl> + + + b / realm / realm - library / src / androidTest / java / io / realm / entities / IOSAllTypes . java <nl> @ @ - 21 , 7 + 21 , 6 @ @ import java . util . Date ; <nl> import io . realm . RealmList ; <nl> import io . realm . RealmObject ; <nl> import io . realm . annotations . PrimaryKey ; <nl> - import io . realm . annotations . Required ; <nl> <nl> public class IOSAllTypes extends RealmObject { <nl> <nl> diff - - git a / realm / realm - library / src / androidTest / java / io / realm / entities / IOSChild . java b / realm / realm - library / src / androidTest / java / io / realm / entities / IOSChild . java <nl> index 4e21616 . . 599d971 100644 <nl> - - - a / realm / realm - library / src / androidTest / java / io / realm / entities / IOSChild . java <nl> + + + b / realm / realm - library / src / androidTest / java / io / realm / entities / IOSChild . java <nl> @ @ - 17 , 7 + 17 , 6 @ @ <nl> package io . realm . entities ; <nl> <nl> import io . realm . RealmObject ; <nl> - import io . realm . annotations . Required ; <nl> <nl> public class IOSChild extends RealmObject { <nl> <nl> diff - - git a / realm / realm - library / src / androidTest / java / io / realm / entities / NoPrimaryKeyNullTypes . java b / realm / realm - library / src / androidTest / java / io / realm / entities / NoPrimaryKeyNullTypes . java <nl> index 0273dad . . dbac854 100644 <nl> - - - a / realm / realm - library / src / androidTest / java / io / realm / entities / NoPrimaryKeyNullTypes . java <nl> + + + b / realm / realm - library / src / androidTest / java / io / realm / entities / NoPrimaryKeyNullTypes . java <nl> @ @ - 19 , 7 + 19 , 6 @ @ package io . realm . entities ; <nl> import java . util . Date ; <nl> <nl> import io . realm . RealmObject ; <nl> - import io . realm . annotations . PrimaryKey ; <nl> import io . realm . annotations . Required ; <nl> <nl> / / Always follow below order and put comments like below to make NullTypes Related cases <nl> diff - - git a / realm / realm - library / src / androidTest / java / io / realm / internal / JNITransactions . java b / realm / realm - library / src / androidTest / java / io / realm / internal / JNITransactions . java <nl> index b4cff1b . . 91a9f56 100644 <nl> - - - a / realm / realm - library / src / androidTest / java / io / realm / internal / JNITransactions . java <nl> + + + b / realm / realm - library / src / androidTest / java / io / realm / internal / JNITransactions . java <nl> @ @ - 37 , 8 + 37 , 8 @ @ import io . realm . exceptions . RealmPrimaryKeyConstraintException ; <nl> import io . realm . rule . TestRealmConfigurationFactory ; <nl> <nl> import static org . junit . Assert . assertEquals ; <nl> - import static org . junit . Assert . assertTrue ; <nl> import static org . junit . Assert . assertNotNull ; <nl> + import static org . junit . Assert . assertTrue ; <nl> import static org . junit . Assert . fail ; <nl> <nl> @ RunWith ( AndroidJUnit4 . class ) <nl> diff - - git a / realm / realm - library / src / androidTest / java / io / realm / internal / android / ISO8601UtilsTest . java b / realm / realm - library / src / androidTest / java / io / realm / internal / android / ISO8601UtilsTest . java <nl> index e3a0267 . . 0fffbd9 100644 <nl> - - - a / realm / realm - library / src / androidTest / java / io / realm / internal / android / ISO8601UtilsTest . java <nl> + + + b / realm / realm - library / src / androidTest / java / io / realm / internal / android / ISO8601UtilsTest . java <nl> @ @ - 18 , 7 + 18 , 6 @ @ package io . realm . internal . android ; <nl> <nl> import android . test . AndroidTestCase ; <nl> <nl> - <nl> import java . text . ParseException ; <nl> import java . text . ParsePosition ; <nl> import java . util . Calendar ; <nl> diff - - git a / realm / realm - library / src / androidTest / java / io / realm / internal / test / ExtraTests . java b / realm / realm - library / src / androidTest / java / io / realm / internal / test / ExtraTests . java <nl> index c04d56e . . 3a422ea 100644 <nl> - - - a / realm / realm - library / src / androidTest / java / io / realm / internal / test / ExtraTests . java <nl> + + + b / realm / realm - library / src / androidTest / java / io / realm / internal / test / ExtraTests . java <nl> @ @ - 17 , 7 + 17 , 9 @ @ <nl> package io . realm . internal . test ; <nl> <nl> import java . lang . reflect . Array ; <nl> - import java . util . * ; <nl> + import java . util . ArrayList ; <nl> + import java . util . Date ; <nl> + import java . util . List ; <nl> <nl> import static junit . framework . Assert . assertEquals ; <nl> import static junit . framework . Assert . fail ; <nl> diff - - git a / realm / realm - library / src / androidTest / java / io / realm / proxy / HandlerProxy . java b / realm / realm - library / src / androidTest / java / io / realm / proxy / HandlerProxy . java <nl> index a6e914f . . 95d5797 100644 <nl> - - - a / realm / realm - library / src / androidTest / java / io / realm / proxy / HandlerProxy . java <nl> + + + b / realm / realm - library / src / androidTest / java / io / realm / proxy / HandlerProxy . java <nl> @ @ - 21 , 8 + 21 , 6 @ @ import android . os . Message ; <nl> <nl> import io . realm . HandlerController ; <nl> <nl> - import static android . os . Handler . * ; <nl> - <nl> / * * <nl> * Handler decorator , to help intercept some messages before they are sent and received . <nl> * /
NEAREST DIFF (one line): diff - - git a / realm - jni / src / io _ realm _ internal _ table . cpp b / realm - jni / src / io _ realm _ internal _ table . cpp <nl> index 6b25e5e . . 8a6a61b 100644 <nl> - - - a / realm - jni / src / io _ realm _ internal _ table . cpp <nl> + + + b / realm - jni / src / io _ realm _ internal _ table . cpp <nl> @ @ - 1485 , 7 + 1485 , 8 @ @ JNIEXPORT jlong JNICALL Java _ io _ realm _ internal _ Table _ nativeSetPrimaryKey ( <nl> return 0 ; <nl> } <nl> <nl> - / / Fix bug https : / / github . com / realm / realm - java / issues / 1059 <nl> + / / Fix wrong primary key table created on Realm - Android 0 . 80 . 1 and below <nl> + / / https : / / github . com / realm / realm - java / issues / 1059 <nl> JNIEXPORT void JNICALL Java _ io _ realm _ internal _ Table _ nativeMigratePrimaryKeyTableIfNeeded <nl> ( JNIEnv * env , jobject , jlong groupNativePtr , jlong privateKeyTableNativePtr ) <nl> { <nl> @ @ - 1495 , 7 + 1496 , 7 @ @ JNIEXPORT void JNICALL Java _ io _ realm _ internal _ Table _ nativeMigratePrimaryKeyTable <nl> StringData tmp _ col _ name = StringData ( " tmp _ field _ name " ) ; <nl> std : : size _ t tmp _ col _ ndx = pk _ table - > add _ column ( DataType ( type _ String ) , tmp _ col _ name ) ; <nl> <nl> - / / Create tmp string column with proper data <nl> + / / Create tmp string column with field name instead of column index <nl> int rows = pk _ table - > size ( ) ; <nl> for ( int row _ ndx = 0 ; row _ ndx < rows ; row _ ndx + + ) { <nl> StringData table _ name = pk _ table - > get _ string ( io _ realm _ internal _ Table _ PRIMARY _ KEY _ CLASS _ COLUMN _ INDEX , row _ ndx ) ; <nl> @ @ - 1505 , 6 + 1506 , 7 @ @ JNIEXPORT void JNICALL Java _ io _ realm _ internal _ Table _ nativeMigratePrimaryKeyTable <nl> } <nl> <nl> / / Delete old int column , and rename tmp column to same name <nl> + / / Index should match as we control creation of table <nl> pk _ table - > remove _ column ( io _ realm _ internal _ Table _ PRIMARY _ KEY _ FIELD _ COLUMN _ INDEX ) ; <nl> pk _ table - > rename _ column ( pk _ table - > get _ column _ index ( tmp _ col _ name ) , StringData ( " pk _ property " ) ) ; <nl> } <nl> diff - - git a / realm / src / androidTest / assets / 080 _ annotationtypes . realm b / realm / src / androidTest / assets / 080 _ annotationtypes . realm <nl> new file mode 100644 <nl> index 0000000 . . 1252c79 <nl> Binary files / dev / null and b / realm / src / androidTest / assets / 080 _ annotationtypes . realm differ <nl> diff - - git a / realm / src / androidTest / java / io / realm / RealmTest . java b / realm / src / androidTest / java / io / realm / RealmTest . java <nl> index a301ee1 . . 881612c 100644 <nl> - - - a / realm / src / androidTest / java / io / realm / RealmTest . java <nl> + + + b / realm / src / androidTest / java / io / realm / RealmTest . java <nl> @ @ - 34 , 7 + 34 , 6 @ @ import java . util . concurrent . Future ; <nl> <nl> import io . realm . entities . AllTypes ; <nl> import io . realm . entities . AllTypesPrimaryKey ; <nl> - import io . realm . entities . AnnotationTypes ; <nl> import io . realm . entities . Cat ; <nl> import io . realm . entities . CyclicType ; <nl> import io . realm . entities . CyclicTypePrimaryKey ; <nl> diff - - git a / realm / src / androidTest / java / io / realm / internal / JNITransactions . java b / realm / src / androidTest / java / io / realm / internal / JNITransactions . java <nl> index b6ab857 . . 72027ce 100644 <nl> - - - a / realm / src / androidTest / java / io / realm / internal / JNITransactions . java <nl> + + + b / realm / src / androidTest / java / io / realm / internal / JNITransactions . java <nl> @ @ - 8 , 6 + 8 , 7 @ @ import java . io . IOException ; <nl> import java . util . Arrays ; <nl> import java . util . Date ; <nl> <nl> + import io . realm . Realm ; <nl> import io . realm . TestHelper ; <nl> import io . realm . exceptions . RealmException ; <nl> <nl> @ @ - 379 , 13 + 380 , 11 @ @ public class JNITransactions extends AndroidTestCase { <nl> } <nl> <nl> public void testPrimaryKeyTableMigration ( ) throws IOException { <nl> - TestHelper . copyRealmFromAssets ( getContext ( ) , " wrong _ primarykey _ table . realm " , " default . realm " ) ; <nl> - String realmPath = new File ( getContext ( ) . getFilesDir ( ) , " default . realm " ) . getAbsolutePath ( ) ; <nl> - SharedGroup db = new SharedGroup ( realmPath , SharedGroup . Durability . FULL , null ) ; <nl> - ImplicitTransaction transaction = db . beginImplicitTransaction ( ) ; <nl> - Table table = transaction . getTable ( " pk " ) ; <nl> - assertEquals ( 2 , table . getColumnCount ( ) ) ; <nl> - assertEquals ( ColumnType . STRING , table . getColumnType ( 0 ) ) ; <nl> - assertEquals ( ColumnType . STRING , table . getColumnType ( 1 ) ) ; <nl> + TestHelper . copyRealmFromAssets ( getContext ( ) , " 080 _ annotationtypes . realm " , " default . realm " ) ; <nl> + SharedGroup db = new SharedGroup ( new File ( getContext ( ) . getFilesDir ( ) , Realm . DEFAULT _ REALM _ NAME ) . getAbsolutePath ( ) , SharedGroup . Durability . FULL , null ) ; <nl> + ImplicitTransaction tr = db . beginImplicitTransaction ( ) ; <nl> + Table t = tr . getTable ( " class _ AnnotationTypes " ) ; <nl> + assertTrue ( t . hasPrimaryKey ( ) ) ; <nl> + db . close ( ) ; <nl> } <nl> } <nl> diff - - git a / realm / src / main / java / io / realm / Realm . java b / realm / src / main / java / io / realm / Realm . java <nl> index 2eefcb8 . . 25adc38 100644 <nl> - - - a / realm / src / main / java / io / realm / Realm . java <nl> + + + b / realm / src / main / java / io / realm / Realm . java <nl> @ @ - 25 , 7 + 25 , 6 @ @ import android . os . Looper ; <nl> import android . os . Message ; <nl> import android . util . JsonReader ; <nl> <nl> - import org . jetbrains . annotations . NotNull ; <nl> import org . json . JSONArray ; <nl> import org . json . JSONException ; <nl> import org . json . JSONObject ;

TEST DIFF:
diff - - git a / realm / realm - library / src / androidTest / java / io / realm / DynamicRealmObjectTests . java b / realm / realm - library / src / androidTest / java / io / realm / DynamicRealmObjectTests . java 
 index f0d7f4a . . 4a895c3 100644 
 - - - a / realm / realm - library / src / androidTest / java / io / realm / DynamicRealmObjectTests . java 
 + + + b / realm / realm - library / src / androidTest / java / io / realm / DynamicRealmObjectTests . java 
 @ @ - 25 , 8 + 25 , 6 @ @ import org . junit . Test ; 
 import org . junit . rules . ExpectedException ; 
 import org . junit . runner . RunWith ; 
 
 - import org . junit . Test ; 
 - 
 import java . text . ParseException ; 
 import java . util . Arrays ; 
 import java . util . Date ; 
 @ @ - 37 , 16 + 35 , 16 @ @ import io . realm . entities . AllTypes ; 
 import io . realm . entities . CyclicType ; 
 import io . realm . entities . Dog ; 
 import io . realm . entities . NullTypes ; 
 - import io . realm . exceptions . RealmException ; 
 import io . realm . entities . Owner ; 
 + import io . realm . exceptions . RealmException ; 
 import io . realm . rule . TestRealmConfigurationFactory ; 
 
 import static org . junit . Assert . assertArrayEquals ; 
 import static org . junit . Assert . assertEquals ; 
 import static org . junit . Assert . assertFalse ; 
 + import static org . junit . Assert . assertNotNull ; 
 import static org . junit . Assert . assertNull ; 
 import static org . junit . Assert . assertTrue ; 
 - import static org . junit . Assert . assertNotNull ; 
 import static org . junit . Assert . fail ; 
 
 @ RunWith ( AndroidJUnit4 . class ) 
 diff - - git a / realm / realm - library / src / androidTest / java / io / realm / IOSRealmTests . java b / realm / realm - library / src / androidTest / java / io / realm / IOSRealmTests . java 
 index b1521fa . . cc45110 100644 
 - - - a / realm / realm - library / src / androidTest / java / io / realm / IOSRealmTests . java 
 + + + b / realm / realm - library / src / androidTest / java / io / realm / IOSRealmTests . java 
 @ @ - 34 , 12 + 34 , 11 @ @ import io . realm . entities . IOSChild ; 
 import io . realm . internal . Table ; 
 import io . realm . rule . TestRealmConfigurationFactory ; 
 
 + import static io . realm . internal . test . ExtraTests . assertArrayEquals ; 
 import static org . junit . Assert . assertEquals ; 
 - import static org . junit . Assert . assertTrue ; 
 import static org . junit . Assert . assertFalse ; 
 import static org . junit . Assert . assertNull ; 
 - 
 - import static io . realm . internal . test . ExtraTests . assertArrayEquals ; 
 + import static org . junit . Assert . assertTrue ; 
 
 / * * 
 * This class test interoperability with Realms created on iOS . 
 diff - - git a / realm / realm - library / src / androidTest / java / io / realm / RealmAdapterTest . java b / realm / realm - library / src / androidTest / java / io / realm / RealmAdapterTest . java 
 index 342232f . . 140eb49 100644 
 - - - a / realm / realm - library / src / androidTest / java / io / realm / RealmAdapterTest . java 
 + + + b / realm / realm - library / src / androidTest / java / io / realm / RealmAdapterTest . java 
 @ @ - 18 , 9 + 18 , 9 @ @ package io . realm ; 
 
 import android . content . Context ; 
 import android . support . test . InstrumentationRegistry ; 
 + import android . support . test . annotation . UiThreadTest ; 
 import android . support . test . rule . UiThreadTestRule ; 
 import android . support . test . runner . AndroidJUnit4 ; 
 - import android . support . test . annotation . UiThreadTest ; 
 import android . view . View ; 
 import android . widget . TextView ; 
 
 diff - - git a / realm / realm - library / src / androidTest / java / io / realm / RealmCacheTests . java b / realm / realm - library / src / androidTest / java / io / realm / RealmCacheTests . java 
 index 3c73dee . . abbc3a3 100644 
 - - - a / realm / realm - library / src / androidTest / java / io / realm / RealmCacheTests . java 
 + + + b / realm / realm - library / src / androidTest / java / io / realm / RealmCacheTests . java 
 @ @ - 34 , 10 + 34 , 10 @ @ import io . realm . entities . StringOnly ; 
 import io . realm . rule . TestRealmConfigurationFactory ; 
 
 import static org . junit . Assert . assertEquals ; 
 - import static org . junit . Assert . assertTrue ; 
 import static org . junit . Assert . assertFalse ; 
 - import static org . junit . Assert . assertNull ; 
 import static org . junit . Assert . assertNotNull ; 
 + import static org . junit . Assert . assertNull ; 
 + import static org . junit . Assert . assertTrue ; 
 import static org . junit . Assert . fail ; 
 
 @ RunWith ( AndroidJUnit4 . class ) 
 diff - - git a / realm / realm - library / src / androidTest / java / io / realm / RealmObjectTests . java b / realm / realm - library / src / androidTest / java / io / realm / RealmObjectTests . java 
 index a0e2530 . . 9e758e5 100644 
 - - - a / realm / realm - library / src / androidTest / java / io / realm / RealmObjectTests . java 
 + + + b / realm / realm - library / src / androidTest / java / io / realm / RealmObjectTests . java 
 @ @ - 25 , 7 + 25 , 6 @ @ import org . junit . Test ; 
 import org . junit . rules . ExpectedException ; 
 import org . junit . runner . RunWith ; 
 
 - import java . io . File ; 
 import java . util . Calendar ; 
 import java . util . Date ; 
 import java . util . HashSet ; 
 diff - - git a / realm / realm - library / src / androidTest / java / io / realm / RealmQueryTests . java b / realm / realm - library / src / androidTest / java / io / realm / RealmQueryTests . java 
 index c60aa55 . . d766886 100644 
 - - - a / realm / realm - library / src / androidTest / java / io / realm / RealmQueryTests . java 
 + + + b / realm / realm - library / src / androidTest / java / io / realm / RealmQueryTests . java 
 @ @ - 17 , 7 + 17 , 6 @ @ 
 package io . realm ; 
 
 import android . os . Looper ; 
 - import android . support . test . InstrumentationRegistry ; 
 import android . support . test . runner . AndroidJUnit4 ; 
 
 import org . junit . After ; 
 @ @ - 27 , 16 + 26 , 14 @ @ import org . junit . Test ; 
 import org . junit . rules . ExpectedException ; 
 import org . junit . runner . RunWith ; 
 
 - import java . lang . Exception ; 
 - import java . lang . Throwable ; 
 import java . util . ArrayList ; 
 import java . util . Arrays ; 
 import java . util . Date ; 
 import java . util . List ; 
 import java . util . concurrent . CountDownLatch ; 
 - import java . util . concurrent . TimeUnit ; 
 import java . util . concurrent . ExecutorService ; 
 import java . util . concurrent . Executors ; 
 + import java . util . concurrent . TimeUnit ; 
 import java . util . concurrent . atomic . AtomicInteger ; 
 
 import io . realm . entities . AllJavaTypes ; 
 @ @ - 49 , 9 + 46 , 9 @ @ import io . realm . entities . NonLatinFieldNames ; 
 import io . realm . entities . NullTypes ; 
 import io . realm . entities . Owner ; 
 import io . realm . entities . StringOnly ; 
 - import io . realm . rule . TestRealmConfigurationFactory ; 
 import io . realm . rule . RunInLooperThread ; 
 import io . realm . rule . RunTestInLooperThread ; 
 + import io . realm . rule . TestRealmConfigurationFactory ; 
 
 import static org . junit . Assert . assertEquals ; 
 import static org . junit . Assert . assertFalse ; 
 diff - - git a / realm / realm - library / src / androidTest / java / io / realm / RealmResultsTests . java b / realm / realm - library / src / androidTest / java / io / realm / RealmResultsTests . java 
 index b800c8d . . 6ac68f2 100644 
 - - - a / realm / realm - library / src / androidTest / java / io / realm / RealmResultsTests . java 
 + + + b / realm / realm - library / src / androidTest / java / io / realm / RealmResultsTests . java 
 @ @ - 45 , 9 + 45 , 9 @ @ import io . realm . entities . NonLatinFieldNames ; 
 import io . realm . entities . NullTypes ; 
 import io . realm . entities . Owner ; 
 import io . realm . internal . Table ; 
 - import io . realm . rule . TestRealmConfigurationFactory ; 
 import io . realm . rule . RunInLooperThread ; 
 import io . realm . rule . RunTestInLooperThread ; 
 + import io . realm . rule . TestRealmConfigurationFactory ; 
 
 import static org . junit . Assert . assertEquals ; 
 import static org . junit . Assert . assertFalse ; 
 diff - - git a / realm / realm - library / src / androidTest / java / io / realm / RealmSchemaTests . java b / realm / realm - library / src / androidTest / java / io / realm / RealmSchemaTests . java 
 index 1d5bef1 . . b2172a7 100644 
 - - - a / realm / realm - library / src / androidTest / java / io / realm / RealmSchemaTests . java 
 + + + b / realm / realm - library / src / androidTest / java / io / realm / RealmSchemaTests . java 
 @ @ - 24 , 14 + 24 , 12 @ @ import org . junit . Rule ; 
 import org . junit . Test ; 
 import org . junit . runner . RunWith ; 
 
 - import java . util . ArrayList ; 
 import java . util . Arrays ; 
 import java . util . List ; 
 import java . util . Set ; 
 
 import io . realm . entities . AllJavaTypes ; 
 import io . realm . entities . Owner ; 
 - import io . realm . internal . Util ; 
 import io . realm . rule . TestRealmConfigurationFactory ; 
 
 import static org . junit . Assert . assertEquals ; 
 diff - - git a / realm / realm - library / src / androidTest / java / io / realm / RxJavaTests . java b / realm / realm - library / src / androidTest / java / io / realm / RxJavaTests . java 
 index 70f4441 . . 60e60cd 100644 
 - - - a / realm / realm - library / src / androidTest / java / io / realm / RxJavaTests . java 
 + + + b / realm / realm - library / src / androidTest / java / io / realm / RxJavaTests . java 
 @ @ - 24 , 7 + 24 , 6 @ @ import org . junit . After ; 
 import org . junit . Before ; 
 import org . junit . Rule ; 
 import org . junit . Test ; 
 - import org . junit . rules . TemporaryFolder ; 
 import org . junit . runner . RunWith ; 
 
 import java . util . concurrent . CountDownLatch ; 
 diff - - git a / realm / realm - library / src / androidTest / java / io / realm / entities / DogPrimaryKey . java b / realm / realm - library / src / androidTest / java / io / realm / entities / DogPrimaryKey . java 
 index 024e6fb . . 21004f0 100644 
 - - - a / realm / realm - library / src / androidTest / java / io / realm / entities / DogPrimaryKey . java 
 + + + b / realm / realm - library / src / androidTest / java / io / realm / entities / DogPrimaryKey . java 
 @ @ - 20 , 7 + 20 , 6 @ @ package io . realm . entities ; 
 import java . util . Date ; 
 
 import io . realm . RealmObject ; 
 - import io . realm . annotations . Index ; 
 import io . realm . annotations . PrimaryKey ; 
 
 public class DogPrimaryKey extends RealmObject { 
 diff - - git a / realm / realm - library / src / androidTest / java / io / realm / entities / IOSAllTypes . java b / realm / realm - library / src / androidTest / java / io / realm / entities / IOSAllTypes . java 
 index f3c15b7 . . db36d1a 100644 
 - - - a / realm / realm - library / src / androidTest / java / io / realm / entities / IOSAllTypes . java 
 + + + b / realm / realm - library / src / androidTest / java / io / realm / entities / IOSAllTypes . java 
 @ @ - 21 , 7 + 21 , 6 @ @ import java . util . Date ; 
 import io . realm . RealmList ; 
 import io . realm . RealmObject ; 
 import io . realm . annotations . PrimaryKey ; 
 - import io . realm . annotations . Required ; 
 
 public class IOSAllTypes extends RealmObject { 
 
 diff - - git a / realm / realm - library / src / androidTest / java / io / realm / entities / IOSChild . java b / realm / realm - library / src / androidTest / java / io / realm / entities / IOSChild . java 
 index 4e21616 . . 599d971 100644 
 - - - a / realm / realm - library / src / androidTest / java / io / realm / entities / IOSChild . java 
 + + + b / realm / realm - library / src / androidTest / java / io / realm / entities / IOSChild . java 
 @ @ - 17 , 7 + 17 , 6 @ @ 
 package io . realm . entities ; 
 
 import io . realm . RealmObject ; 
 - import io . realm . annotations . Required ; 
 
 public class IOSChild extends RealmObject { 
 
 diff - - git a / realm / realm - library / src / androidTest / java / io / realm / entities / NoPrimaryKeyNullTypes . java b / realm / realm - library / src / androidTest / java / io / realm / entities / NoPrimaryKeyNullTypes . java 
 index 0273dad . . dbac854 100644 
 - - - a / realm / realm - library / src / androidTest / java / io / realm / entities / NoPrimaryKeyNullTypes . java 
 + + + b / realm / realm - library / src / androidTest / java / io / realm / entities / NoPrimaryKeyNullTypes . java 
 @ @ - 19 , 7 + 19 , 6 @ @ package io . realm . entities ; 
 import java . util . Date ; 
 
 import io . realm . RealmObject ; 
 - import io . realm . annotations . PrimaryKey ; 
 import io . realm . annotations . Required ; 
 
 / / Always follow below order and put comments like below to make NullTypes Related cases 
 diff - - git a / realm / realm - library / src / androidTest / java / io / realm / internal / JNITransactions . java b / realm / realm - library / src / androidTest / java / io / realm / internal / JNITransactions . java 
 index b4cff1b . . 91a9f56 100644 
 - - - a / realm / realm - library / src / androidTest / java / io / realm / internal / JNITransactions . java 
 + + + b / realm / realm - library / src / androidTest / java / io / realm / internal / JNITransactions . java 
 @ @ - 37 , 8 + 37 , 8 @ @ import io . realm . exceptions . RealmPrimaryKeyConstraintException ; 
 import io . realm . rule . TestRealmConfigurationFactory ; 
 
 import static org . junit . Assert . assertEquals ; 
 - import static org . junit . Assert . assertTrue ; 
 import static org . junit . Assert . assertNotNull ; 
 + import static org . junit . Assert . assertTrue ; 
 import static org . junit . Assert . fail ; 
 
 @ RunWith ( AndroidJUnit4 . class ) 
 diff - - git a / realm / realm - library / src / androidTest / java / io / realm / internal / android / ISO8601UtilsTest . java b / realm / realm - library / src / androidTest / java / io / realm / internal / android / ISO8601UtilsTest . java 
 index e3a0267 . . 0fffbd9 100644 
 - - - a / realm / realm - library / src / androidTest / java / io / realm / internal / android / ISO8601UtilsTest . java 
 + + + b / realm / realm - library / src / androidTest / java / io / realm / internal / android / ISO8601UtilsTest . java 
 @ @ - 18 , 7 + 18 , 6 @ @ package io . realm . internal . android ; 
 
 import android . test . AndroidTestCase ; 
 
 - 
 import java . text . ParseException ; 
 import java . text . ParsePosition ; 
 import java . util . Calendar ; 
 diff - - git a / realm / realm - library / src / androidTest / java / io / realm / internal / test / ExtraTests . java b / realm / realm - library / src / androidTest / java / io / realm / internal / test / ExtraTests . java 
 index c04d56e . . 3a422ea 100644 
 - - - a / realm / realm - library / src / androidTest / java / io / realm / internal / test / ExtraTests . java 
 + + + b / realm / realm - library / src / androidTest / java / io / realm / internal / test / ExtraTests . java 
 @ @ - 17 , 7 + 17 , 9 @ @ 
 package io . realm . internal . test ; 
 
 import java . lang . reflect . Array ; 
 - import java . util . * ; 
 + import java . util . ArrayList ; 
 + import java . util . Date ; 
 + import java . util . List ; 
 
 import static junit . framework . Assert . assertEquals ; 
 import static junit . framework . Assert . fail ; 
 diff - - git a / realm / realm - library / src / androidTest / java / io / realm / proxy / HandlerProxy . java b / realm / realm - library / src / androidTest / java / io / realm / proxy / HandlerProxy . java 
 index a6e914f . . 95d5797 100644 
 - - - a / realm / realm - library / src / androidTest / java / io / realm / proxy / HandlerProxy . java 
 + + + b / realm / realm - library / src / androidTest / java / io / realm / proxy / HandlerProxy . java 
 @ @ - 21 , 8 + 21 , 6 @ @ import android . os . Message ; 
 
 import io . realm . HandlerController ; 
 
 - import static android . os . Handler . * ; 
 - 
 / * * 
 * Handler decorator , to help intercept some messages before they are sent and received . 
 * /

NEAREST DIFF:
diff - - git a / realm - jni / src / io _ realm _ internal _ table . cpp b / realm - jni / src / io _ realm _ internal _ table . cpp 
 index 6b25e5e . . 8a6a61b 100644 
 - - - a / realm - jni / src / io _ realm _ internal _ table . cpp 
 + + + b / realm - jni / src / io _ realm _ internal _ table . cpp 
 @ @ - 1485 , 7 + 1485 , 8 @ @ JNIEXPORT jlong JNICALL Java _ io _ realm _ internal _ Table _ nativeSetPrimaryKey ( 
 return 0 ; 
 } 
 
 - / / Fix bug https : / / github . com / realm / realm - java / issues / 1059 
 + / / Fix wrong primary key table created on Realm - Android 0 . 80 . 1 and below 
 + / / https : / / github . com / realm / realm - java / issues / 1059 
 JNIEXPORT void JNICALL Java _ io _ realm _ internal _ Table _ nativeMigratePrimaryKeyTableIfNeeded 
 ( JNIEnv * env , jobject , jlong groupNativePtr , jlong privateKeyTableNativePtr ) 
 { 
 @ @ - 1495 , 7 + 1496 , 7 @ @ JNIEXPORT void JNICALL Java _ io _ realm _ internal _ Table _ nativeMigratePrimaryKeyTable 
 StringData tmp _ col _ name = StringData ( " tmp _ field _ name " ) ; 
 std : : size _ t tmp _ col _ ndx = pk _ table - > add _ column ( DataType ( type _ String ) , tmp _ col _ name ) ; 
 
 - / / Create tmp string column with proper data 
 + / / Create tmp string column with field name instead of column index 
 int rows = pk _ table - > size ( ) ; 
 for ( int row _ ndx = 0 ; row _ ndx < rows ; row _ ndx + + ) { 
 StringData table _ name = pk _ table - > get _ string ( io _ realm _ internal _ Table _ PRIMARY _ KEY _ CLASS _ COLUMN _ INDEX , row _ ndx ) ; 
 @ @ - 1505 , 6 + 1506 , 7 @ @ JNIEXPORT void JNICALL Java _ io _ realm _ internal _ Table _ nativeMigratePrimaryKeyTable 
 } 
 
 / / Delete old int column , and rename tmp column to same name 
 + / / Index should match as we control creation of table 
 pk _ table - > remove _ column ( io _ realm _ internal _ Table _ PRIMARY _ KEY _ FIELD _ COLUMN _ INDEX ) ; 
 pk _ table - > rename _ column ( pk _ table - > get _ column _ index ( tmp _ col _ name ) , StringData ( " pk _ property " ) ) ; 
 } 
 diff - - git a / realm / src / androidTest / assets / 080 _ annotationtypes . realm b / realm / src / androidTest / assets / 080 _ annotationtypes . realm 
 new file mode 100644 
 index 0000000 . . 1252c79 
 Binary files / dev / null and b / realm / src / androidTest / assets / 080 _ annotationtypes . realm differ 
 diff - - git a / realm / src / androidTest / java / io / realm / RealmTest . java b / realm / src / androidTest / java / io / realm / RealmTest . java 
 index a301ee1 . . 881612c 100644 
 - - - a / realm / src / androidTest / java / io / realm / RealmTest . java 
 + + + b / realm / src / androidTest / java / io / realm / RealmTest . java 
 @ @ - 34 , 7 + 34 , 6 @ @ import java . util . concurrent . Future ; 
 
 import io . realm . entities . AllTypes ; 
 import io . realm . entities . AllTypesPrimaryKey ; 
 - import io . realm . entities . AnnotationTypes ; 
 import io . realm . entities . Cat ; 
 import io . realm . entities . CyclicType ; 
 import io . realm . entities . CyclicTypePrimaryKey ; 
 diff - - git a / realm / src / androidTest / java / io / realm / internal / JNITransactions . java b / realm / src / androidTest / java / io / realm / internal / JNITransactions . java 
 index b6ab857 . . 72027ce 100644 
 - - - a / realm / src / androidTest / java / io / realm / internal / JNITransactions . java 
 + + + b / realm / src / androidTest / java / io / realm / internal / JNITransactions . java 
 @ @ - 8 , 6 + 8 , 7 @ @ import java . io . IOException ; 
 import java . util . Arrays ; 
 import java . util . Date ; 
 
 + import io . realm . Realm ; 
 import io . realm . TestHelper ; 
 import io . realm . exceptions . RealmException ; 
 
 @ @ - 379 , 13 + 380 , 11 @ @ public class JNITransactions extends AndroidTestCase { 
 } 
 
 public void testPrimaryKeyTableMigration ( ) throws IOException { 
 - TestHelper . copyRealmFromAssets ( getContext ( ) , " wrong _ primarykey _ table . realm " , " default . realm " ) ; 
 - String realmPath = new File ( getContext ( ) . getFilesDir ( ) , " default . realm " ) . getAbsolutePath ( ) ; 
 - SharedGroup db = new SharedGroup ( realmPath , SharedGroup . Durability . FULL , null ) ; 
 - ImplicitTransaction transaction = db . beginImplicitTransaction ( ) ; 
 - Table table = transaction . getTable ( " pk " ) ; 
 - assertEquals ( 2 , table . getColumnCount ( ) ) ; 
 - assertEquals ( ColumnType . STRING , table . getColumnType ( 0 ) ) ; 
 - assertEquals ( ColumnType . STRING , table . getColumnType ( 1 ) ) ; 
 + TestHelper . copyRealmFromAssets ( getContext ( ) , " 080 _ annotationtypes . realm " , " default . realm " ) ; 
 + SharedGroup db = new SharedGroup ( new File ( getContext ( ) . getFilesDir ( ) , Realm . DEFAULT _ REALM _ NAME ) . getAbsolutePath ( ) , SharedGroup . Durability . FULL , null ) ; 
 + ImplicitTransaction tr = db . beginImplicitTransaction ( ) ; 
 + Table t = tr . getTable ( " class _ AnnotationTypes " ) ; 
 + assertTrue ( t . hasPrimaryKey ( ) ) ; 
 + db . close ( ) ; 
 } 
 } 
 diff - - git a / realm / src / main / java / io / realm / Realm . java b / realm / src / main / java / io / realm / Realm . java 
 index 2eefcb8 . . 25adc38 100644 
 - - - a / realm / src / main / java / io / realm / Realm . java 
 + + + b / realm / src / main / java / io / realm / Realm . java 
 @ @ - 25 , 7 + 25 , 6 @ @ import android . os . Looper ; 
 import android . os . Message ; 
 import android . util . JsonReader ; 
 
 - import org . jetbrains . annotations . NotNull ; 
 import org . json . JSONArray ; 
 import org . json . JSONException ; 
 import org . json . JSONObject ;
