BLEU SCORE: 0.027611988917697356

TEST MSG: Logging a message when compact ( ) fails
GENERATED MSG: Implementation of Realm . cancelTransaction

TEST DIFF (one line): diff - - git a / realm / realm - library / src / main / java / io / realm / internal / SharedGroupManager . java b / realm / realm - library / src / main / java / io / realm / internal / SharedGroupManager . java <nl> index 326437f . . 49e285b 100644 <nl> - - - a / realm / realm - library / src / main / java / io / realm / internal / SharedGroupManager . java <nl> + + + b / realm / realm - library / src / main / java / io / realm / internal / SharedGroupManager . java <nl> @ @ - 21 , 6 + 21 , 7 @ @ import java . io . File ; <nl> import java . io . IOException ; <nl> <nl> import io . realm . RealmConfiguration ; <nl> + import io . realm . internal . log . RealmLog ; <nl> <nl> / * * <nl> * This class wraps access to a given Realm file on a single thread including its { @ link SharedGroup } and <nl> @ @ - 162 , 6 + 163 , 7 @ @ public class SharedGroupManager implements Closeable { <nl> <nl> / * * <nl> * Compacts a Realm file . It cannot be open when calling this method . <nl> + * Returns true if compaction succeeded , false otherwise . <nl> * / <nl> public static boolean compact ( RealmConfiguration configuration ) { <nl> SharedGroup sharedGroup = null ; <nl> @ @ - 174 , 6 + 176 , 7 @ @ public class SharedGroupManager implements Closeable { <nl> configuration . getEncryptionKey ( ) ) ; <nl> result = sharedGroup . compact ( ) ; <nl> } catch ( Exception e ) { <nl> + RealmLog . i ( e . getMessage ( ) ) ; <nl> return false ; <nl> } finally { <nl> if ( sharedGroup ! = null ) {
NEAREST DIFF (one line): diff - - git a / changelog . txt b / changelog . txt <nl> index ecaedb9 . . 2c7dd3b 100644 <nl> - - - a / changelog . txt <nl> + + + b / changelog . txt <nl> @ @ - 3 , 6 + 3 , 7 @ @ <nl> * Better support for Java 7 and 8 in the annotations processor <nl> * Better support for the Eclipse annotations processor <nl> * Add Eclipse dupport to the distribution file <nl> + * Add Realm . cancelTransaction ( ) to cancel / abort / rollback a write transaction <nl> <nl> 0 . 71 . 0 ( 07 Oct 2014 ) <nl> * Simplified the release artifact to a single Jar file <nl> diff - - git a / realm - jni / src / io _ realm _ internal _ SharedGroup . cpp b / realm - jni / src / io _ realm _ internal _ SharedGroup . cpp <nl> index da9127a . . a931a6b 100644 <nl> - - - a / realm - jni / src / io _ realm _ internal _ SharedGroup . cpp <nl> + + + b / realm - jni / src / io _ realm _ internal _ SharedGroup . cpp <nl> @ @ - 249 , 6 + 249 , 13 @ @ JNIEXPORT void JNICALL Java _ io _ realm _ internal _ SharedGroup _ nativeRollback ( <nl> SG ( native _ ptr ) - > rollback ( ) ; / / noexcept <nl> } <nl> <nl> + JNIEXPORT void JNICALL Java _ io _ realm _ internal _ SharedGroup _ nativeRollbackAndContinueAsRead ( <nl> + JNIEnv * , jobject , jlong native _ ptr ) <nl> + { <nl> + LangBindHelper : : rollback _ and _ continue _ as _ read ( * SG ( native _ ptr ) ) ; <nl> + } <nl> + <nl> + <nl> JNIEXPORT jboolean JNICALL Java _ io _ realm _ internal _ SharedGroup _ nativeHasChanged <nl> ( JNIEnv * , jobject , jlong native _ ptr ) <nl> { <nl> diff - - git a / realm - jni / src / io _ realm _ internal _ SharedGroup . h b / realm - jni / src / io _ realm _ internal _ SharedGroup . h <nl> index 6a3e231 . . ef18102 100644 <nl> - - - a / realm - jni / src / io _ realm _ internal _ SharedGroup . h <nl> + + + b / realm - jni / src / io _ realm _ internal _ SharedGroup . h <nl> @ @ - 57 , 6 + 57 , 14 @ @ JNIEXPORT void JNICALL Java _ io _ realm _ internal _ SharedGroup _ nativeCommitAndContinu <nl> <nl> / * <nl> * Class : io _ realm _ internal _ SharedGroup <nl> + * Method : nativeRollbackAndContinueAsRead <nl> + * Signature : ( J ) V <nl> + * / <nl> + JNIEXPORT void JNICALL Java _ io _ realm _ internal _ SharedGroup _ nativeRollbackAndContinueAsRead <nl> + ( JNIEnv * , jobject , jlong ) ; <nl> + <nl> + / * <nl> + * Class : io _ realm _ internal _ SharedGroup <nl> * Method : nativeBeginImplicit <nl> * Signature : ( J ) J <nl> * / <nl> diff - - git a / realm / src / androidTest / java / io / realm / RealmTest . java b / realm / src / androidTest / java / io / realm / RealmTest . java <nl> index a781f9c . . a41282a 100644 <nl> - - - a / realm / src / androidTest / java / io / realm / RealmTest . java <nl> + + + b / realm / src / androidTest / java / io / realm / RealmTest . java <nl> @ @ - 641 , 6 + 641 , 18 @ @ public class RealmTest extends AndroidTestCase { <nl> assertEquals ( " Change has not been committed " , TEST _ DATA _ SIZE + 1 , resultList . size ( ) ) ; <nl> } <nl> <nl> + public void testCancelTransaction ( ) { <nl> + testRealm . beginTransaction ( ) ; <nl> + AllTypes allTypes = testRealm . createObject ( AllTypes . class ) ; <nl> + testRealm . cancelTransaction ( ) ; <nl> + assertEquals ( TEST _ DATA _ SIZE , testRealm . allObjects ( AllTypes . class ) . size ( ) ) ; <nl> + <nl> + try { <nl> + testRealm . cancelTransaction ( ) ; <nl> + fail ( ) ; <nl> + } catch ( RealmException ignored ) { } <nl> + } <nl> + <nl> / / void clear ( Class < ? > classSpec ) <nl> public void testClassClear ( ) { <nl> <nl> diff - - git a / realm / src / main / java / io / realm / Realm . java b / realm / src / main / java / io / realm / Realm . java <nl> index 813456f . . ca7d8d5 100644 <nl> - - - a / realm / src / main / java / io / realm / Realm . java <nl> + + + b / realm / src / main / java / io / realm / Realm . java <nl> @ @ - 593 , 6 + 593 , 17 @ @ public class Realm { <nl> } <nl> <nl> / * * <nl> + * Revert all writes made in the current write transaction and end the transaction . <nl> + * Calling this when not in a write transaction will throw an exception . <nl> + * <nl> + * @ throws io . realm . exceptions . RealmException If not in a write transaction . <nl> + * @ throws IllegalStateException If the write transaction is invalid . <nl> + * / <nl> + public void cancelTransaction ( ) { <nl> + transaction . rollback ( ) ; <nl> + } <nl> + <nl> + / * * <nl> * Remove all objects of the specified class <nl> * <nl> * @ param classSpec The class which objects should be removed <nl> diff - - git a / realm / src / main / java / io / realm / internal / ImplicitTransaction . java b / realm / src / main / java / io / realm / internal / ImplicitTransaction . java <nl> index 88c7bdf . . 641675f 100644 <nl> - - - a / realm / src / main / java / io / realm / internal / ImplicitTransaction . java <nl> + + + b / realm / src / main / java / io / realm / internal / ImplicitTransaction . java <nl> @ @ - 49 , 6 + 49 , 15 @ @ public class ImplicitTransaction extends Group { <nl> parent . endRead ( ) ; <nl> } <nl> <nl> + public void rollback ( ) { <nl> + if ( ! immutable ) { <nl> + parent . rollbackAndContinueAsRead ( ) ; <nl> + immutable = true ; <nl> + } else { <nl> + throw new RealmException ( " Cannot cancel a non - write transaction . " ) ; <nl> + } <nl> + } <nl> + <nl> protected void finalize ( ) { } / / Nullify the actions of Group . finalize ( ) <nl> <nl> } <nl> diff - - git a / realm / src / main / java / io / realm / internal / SharedGroup . java b / realm / src / main / java / io / realm / internal / SharedGroup . java <nl> index d4a20a0 . . 490e45e 100644 <nl> - - - a / realm / src / main / java / io / realm / internal / SharedGroup . java <nl> + + + b / realm / src / main / java / io / realm / internal / SharedGroup . java <nl> @ @ - 103 , 6 + 103 , 10 @ @ public class SharedGroup implements Closeable { <nl> <nl> private native void nativeCommitAndContinueAsRead ( long nativePtr ) ; <nl> <nl> + void rollbackAndContinueAsRead ( ) { nativeRollbackAndContinueAsRead ( nativePtr ) ; } <nl> + <nl> + private native void nativeRollbackAndContinueAsRead ( long nativePtr ) ; <nl> + <nl> public ImplicitTransaction beginImplicitTransaction ( ) { <nl> if ( activeTransaction ) { <nl> throw new IllegalStateException (

TEST DIFF:
diff - - git a / realm / realm - library / src / main / java / io / realm / internal / SharedGroupManager . java b / realm / realm - library / src / main / java / io / realm / internal / SharedGroupManager . java 
 index 326437f . . 49e285b 100644 
 - - - a / realm / realm - library / src / main / java / io / realm / internal / SharedGroupManager . java 
 + + + b / realm / realm - library / src / main / java / io / realm / internal / SharedGroupManager . java 
 @ @ - 21 , 6 + 21 , 7 @ @ import java . io . File ; 
 import java . io . IOException ; 
 
 import io . realm . RealmConfiguration ; 
 + import io . realm . internal . log . RealmLog ; 
 
 / * * 
 * This class wraps access to a given Realm file on a single thread including its { @ link SharedGroup } and 
 @ @ - 162 , 6 + 163 , 7 @ @ public class SharedGroupManager implements Closeable { 
 
 / * * 
 * Compacts a Realm file . It cannot be open when calling this method . 
 + * Returns true if compaction succeeded , false otherwise . 
 * / 
 public static boolean compact ( RealmConfiguration configuration ) { 
 SharedGroup sharedGroup = null ; 
 @ @ - 174 , 6 + 176 , 7 @ @ public class SharedGroupManager implements Closeable { 
 configuration . getEncryptionKey ( ) ) ; 
 result = sharedGroup . compact ( ) ; 
 } catch ( Exception e ) { 
 + RealmLog . i ( e . getMessage ( ) ) ; 
 return false ; 
 } finally { 
 if ( sharedGroup ! = null ) {

NEAREST DIFF:
diff - - git a / changelog . txt b / changelog . txt 
 index ecaedb9 . . 2c7dd3b 100644 
 - - - a / changelog . txt 
 + + + b / changelog . txt 
 @ @ - 3 , 6 + 3 , 7 @ @ 
 * Better support for Java 7 and 8 in the annotations processor 
 * Better support for the Eclipse annotations processor 
 * Add Eclipse dupport to the distribution file 
 + * Add Realm . cancelTransaction ( ) to cancel / abort / rollback a write transaction 
 
 0 . 71 . 0 ( 07 Oct 2014 ) 
 * Simplified the release artifact to a single Jar file 
 diff - - git a / realm - jni / src / io _ realm _ internal _ SharedGroup . cpp b / realm - jni / src / io _ realm _ internal _ SharedGroup . cpp 
 index da9127a . . a931a6b 100644 
 - - - a / realm - jni / src / io _ realm _ internal _ SharedGroup . cpp 
 + + + b / realm - jni / src / io _ realm _ internal _ SharedGroup . cpp 
 @ @ - 249 , 6 + 249 , 13 @ @ JNIEXPORT void JNICALL Java _ io _ realm _ internal _ SharedGroup _ nativeRollback ( 
 SG ( native _ ptr ) - > rollback ( ) ; / / noexcept 
 } 
 
 + JNIEXPORT void JNICALL Java _ io _ realm _ internal _ SharedGroup _ nativeRollbackAndContinueAsRead ( 
 + JNIEnv * , jobject , jlong native _ ptr ) 
 + { 
 + LangBindHelper : : rollback _ and _ continue _ as _ read ( * SG ( native _ ptr ) ) ; 
 + } 
 + 
 + 
 JNIEXPORT jboolean JNICALL Java _ io _ realm _ internal _ SharedGroup _ nativeHasChanged 
 ( JNIEnv * , jobject , jlong native _ ptr ) 
 { 
 diff - - git a / realm - jni / src / io _ realm _ internal _ SharedGroup . h b / realm - jni / src / io _ realm _ internal _ SharedGroup . h 
 index 6a3e231 . . ef18102 100644 
 - - - a / realm - jni / src / io _ realm _ internal _ SharedGroup . h 
 + + + b / realm - jni / src / io _ realm _ internal _ SharedGroup . h 
 @ @ - 57 , 6 + 57 , 14 @ @ JNIEXPORT void JNICALL Java _ io _ realm _ internal _ SharedGroup _ nativeCommitAndContinu 
 
 / * 
 * Class : io _ realm _ internal _ SharedGroup 
 + * Method : nativeRollbackAndContinueAsRead 
 + * Signature : ( J ) V 
 + * / 
 + JNIEXPORT void JNICALL Java _ io _ realm _ internal _ SharedGroup _ nativeRollbackAndContinueAsRead 
 + ( JNIEnv * , jobject , jlong ) ; 
 + 
 + / * 
 + * Class : io _ realm _ internal _ SharedGroup 
 * Method : nativeBeginImplicit 
 * Signature : ( J ) J 
 * / 
 diff - - git a / realm / src / androidTest / java / io / realm / RealmTest . java b / realm / src / androidTest / java / io / realm / RealmTest . java 
 index a781f9c . . a41282a 100644 
 - - - a / realm / src / androidTest / java / io / realm / RealmTest . java 
 + + + b / realm / src / androidTest / java / io / realm / RealmTest . java 
 @ @ - 641 , 6 + 641 , 18 @ @ public class RealmTest extends AndroidTestCase { 
 assertEquals ( " Change has not been committed " , TEST _ DATA _ SIZE + 1 , resultList . size ( ) ) ; 
 } 
 
 + public void testCancelTransaction ( ) { 
 + testRealm . beginTransaction ( ) ; 
 + AllTypes allTypes = testRealm . createObject ( AllTypes . class ) ; 
 + testRealm . cancelTransaction ( ) ; 
 + assertEquals ( TEST _ DATA _ SIZE , testRealm . allObjects ( AllTypes . class ) . size ( ) ) ; 
 + 
 + try { 
 + testRealm . cancelTransaction ( ) ; 
 + fail ( ) ; 
 + } catch ( RealmException ignored ) { } 
 + } 
 + 
 / / void clear ( Class < ? > classSpec ) 
 public void testClassClear ( ) { 
 
 diff - - git a / realm / src / main / java / io / realm / Realm . java b / realm / src / main / java / io / realm / Realm . java 
 index 813456f . . ca7d8d5 100644 
 - - - a / realm / src / main / java / io / realm / Realm . java 
 + + + b / realm / src / main / java / io / realm / Realm . java 
 @ @ - 593 , 6 + 593 , 17 @ @ public class Realm { 
 } 
 
 / * * 
 + * Revert all writes made in the current write transaction and end the transaction . 
 + * Calling this when not in a write transaction will throw an exception . 
 + * 
 + * @ throws io . realm . exceptions . RealmException If not in a write transaction . 
 + * @ throws IllegalStateException If the write transaction is invalid . 
 + * / 
 + public void cancelTransaction ( ) { 
 + transaction . rollback ( ) ; 
 + } 
 + 
 + / * * 
 * Remove all objects of the specified class 
 * 
 * @ param classSpec The class which objects should be removed 
 diff - - git a / realm / src / main / java / io / realm / internal / ImplicitTransaction . java b / realm / src / main / java / io / realm / internal / ImplicitTransaction . java 
 index 88c7bdf . . 641675f 100644 
 - - - a / realm / src / main / java / io / realm / internal / ImplicitTransaction . java 
 + + + b / realm / src / main / java / io / realm / internal / ImplicitTransaction . java 
 @ @ - 49 , 6 + 49 , 15 @ @ public class ImplicitTransaction extends Group { 
 parent . endRead ( ) ; 
 } 
 
 + public void rollback ( ) { 
 + if ( ! immutable ) { 
 + parent . rollbackAndContinueAsRead ( ) ; 
 + immutable = true ; 
 + } else { 
 + throw new RealmException ( " Cannot cancel a non - write transaction . " ) ; 
 + } 
 + } 
 + 
 protected void finalize ( ) { } / / Nullify the actions of Group . finalize ( ) 
 
 } 
 diff - - git a / realm / src / main / java / io / realm / internal / SharedGroup . java b / realm / src / main / java / io / realm / internal / SharedGroup . java 
 index d4a20a0 . . 490e45e 100644 
 - - - a / realm / src / main / java / io / realm / internal / SharedGroup . java 
 + + + b / realm / src / main / java / io / realm / internal / SharedGroup . java 
 @ @ - 103 , 6 + 103 , 10 @ @ public class SharedGroup implements Closeable { 
 
 private native void nativeCommitAndContinueAsRead ( long nativePtr ) ; 
 
 + void rollbackAndContinueAsRead ( ) { nativeRollbackAndContinueAsRead ( nativePtr ) ; } 
 + 
 + private native void nativeRollbackAndContinueAsRead ( long nativePtr ) ; 
 + 
 public ImplicitTransaction beginImplicitTransaction ( ) { 
 if ( activeTransaction ) { 
 throw new IllegalStateException (
