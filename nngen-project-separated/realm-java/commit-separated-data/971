BLEU SCORE: 0.05341087579952926

TEST MSG: convertColumnToNotNullable now works correctly .
GENERATED MSG: Better doc + changelog

TEST DIFF (one line): diff - - git a / changelog . txt b / changelog . txt <nl> index 3bbcd02 . . bd86d1b 100644 <nl> - - - a / changelog . txt <nl> + + + b / changelog . txt <nl> @ @ - 1 , 3 + 1 , 6 @ @ <nl> + 0 . 84 . 2 <nl> + * Fixed bug making it impossible to convert a field to being required during a migration . <nl> + <nl> 0 . 84 . 1 <nl> * Updated Realm Core to 0 . 94 . 4 <nl> - Fixed a bug that could cause a crash when running the same query multiple times . <nl> diff - - git a / realm - jni / src / io _ realm _ internal _ table . cpp b / realm - jni / src / io _ realm _ internal _ table . cpp <nl> index 8579a96 . . c073ad0 100644 <nl> - - - a / realm - jni / src / io _ realm _ internal _ table . cpp <nl> + + + b / realm - jni / src / io _ realm _ internal _ table . cpp <nl> @ @ - 291 , 7 + 291 , 7 @ @ JNIEXPORT void JNICALL Java _ io _ realm _ internal _ Table _ nativeConvertColumnToNotNull <nl> std : : ostringstream ss ; <nl> ss < < std : : string ( " _ _ TMP _ _ " ) < < j ; <nl> if ( table - > get _ column _ index ( ss . str ( ) ) = = realm : : not _ found ) { <nl> - table - > insert _ column ( column _ index , column _ type , ss . str ( ) , true ) ; <nl> + table - > insert _ column ( column _ index , column _ type , ss . str ( ) , false ) ; <nl> tmp _ column _ name = ss . str ( ) ; <nl> break ; <nl> } <nl> diff - - git a / realm / src / androidTest / java / io / realm / internal / JNITableTest . java b / realm / src / androidTest / java / io / realm / internal / JNITableTest . java <nl> index 837b729 . . dcd2f94 100644 <nl> - - - a / realm / src / androidTest / java / io / realm / internal / JNITableTest . java <nl> + + + b / realm / src / androidTest / java / io / realm / internal / JNITableTest . java <nl> @ @ - 490 , 6 + 490 , 7 @ @ public class JNITableTest extends AndroidTestCase { <nl> assertEquals ( 1 , table . size ( ) ) ; <nl> <nl> table . convertColumnToNullable ( colIndex ) ; <nl> + assertTrue ( table . isColumnNullable ( colIndex ) ) ; <nl> assertEquals ( 1 , table . size ( ) ) ; <nl> assertEquals ( 2 , table . getColumnCount ( ) ) ; <nl> assertTrue ( table . getColumnIndex ( columnName ) > = 0 ) ; <nl> @ @ - 559 , 6 + 560 , 7 @ @ public class JNITableTest extends AndroidTestCase { <nl> assertEquals ( 2 , table . size ( ) ) ; <nl> <nl> table . convertColumnToNotNullable ( colIndex ) ; <nl> + assertFalse ( table . isColumnNullable ( colIndex ) ) ; <nl> assertEquals ( 2 , table . size ( ) ) ; <nl> assertEquals ( 2 , table . getColumnCount ( ) ) ; <nl> assertTrue ( table . getColumnIndex ( columnName ) > = 0 ) ;
NEAREST DIFF (one line): diff - - git a / changelog . txt b / changelog . txt <nl> index 6b92c68 . . ad6d84d 100644 <nl> - - - a / changelog . txt <nl> + + + b / changelog . txt <nl> @ @ - 1 , 3 + 1 , 6 @ @ <nl> + 0 . 81 . 0 <nl> + * Fixed a bug making it impossible to open Realms created by Realm - Cocoa if a model had a primary key . <nl> + <nl> 0 . 80 . 1 <nl> * Realm . createOrUpdateWithJson ( ) no longer resets fields to their default value if they are not found in the JSON input . <nl> * Realm . compactRealmFile ( ) now uses Realm Core ' s compact ( ) method which is more failure resilient . <nl> diff - - git a / realm - jni / src / io _ realm _ internal _ table . cpp b / realm - jni / src / io _ realm _ internal _ table . cpp <nl> index 8a6a61b . . d3923a5 100644 <nl> - - - a / realm - jni / src / io _ realm _ internal _ table . cpp <nl> + + + b / realm - jni / src / io _ realm _ internal _ table . cpp <nl> @ @ - 1485 , 8 + 1485 , 11 @ @ JNIEXPORT jlong JNICALL Java _ io _ realm _ internal _ Table _ nativeSetPrimaryKey ( <nl> return 0 ; <nl> } <nl> <nl> - / / Fix wrong primary key table created on Realm - Android 0 . 80 . 1 and below <nl> - / / https : / / github . com / realm / realm - java / issues / 1059 <nl> + / / Fixes interop issue with Cocoa Realm where the Primary Key table had different types . <nl> + / / This effects : <nl> + / / - All Realms created by Cocoa and used by Realm - android up to 0 . 80 . 1 <nl> + / / - All Realms created by Realm - Android 0 . 80 . 1 and below <nl> + / / See https : / / github . com / realm / realm - java / issues / 1059 <nl> JNIEXPORT void JNICALL Java _ io _ realm _ internal _ Table _ nativeMigratePrimaryKeyTableIfNeeded <nl> ( JNIEnv * env , jobject , jlong groupNativePtr , jlong privateKeyTableNativePtr ) <nl> { <nl> @ @ - 1506 , 7 + 1509 , 7 @ @ JNIEXPORT void JNICALL Java _ io _ realm _ internal _ Table _ nativeMigratePrimaryKeyTable <nl> } <nl> <nl> / / Delete old int column , and rename tmp column to same name <nl> - / / Index should match as we control creation of table <nl> + / / Index should stay the same as we control creation of table <nl> pk _ table - > remove _ column ( io _ realm _ internal _ Table _ PRIMARY _ KEY _ FIELD _ COLUMN _ INDEX ) ; <nl> pk _ table - > rename _ column ( pk _ table - > get _ column _ index ( tmp _ col _ name ) , StringData ( " pk _ property " ) ) ; <nl> }

TEST DIFF:
diff - - git a / changelog . txt b / changelog . txt 
 index 3bbcd02 . . bd86d1b 100644 
 - - - a / changelog . txt 
 + + + b / changelog . txt 
 @ @ - 1 , 3 + 1 , 6 @ @ 
 + 0 . 84 . 2 
 + * Fixed bug making it impossible to convert a field to being required during a migration . 
 + 
 0 . 84 . 1 
 * Updated Realm Core to 0 . 94 . 4 
 - Fixed a bug that could cause a crash when running the same query multiple times . 
 diff - - git a / realm - jni / src / io _ realm _ internal _ table . cpp b / realm - jni / src / io _ realm _ internal _ table . cpp 
 index 8579a96 . . c073ad0 100644 
 - - - a / realm - jni / src / io _ realm _ internal _ table . cpp 
 + + + b / realm - jni / src / io _ realm _ internal _ table . cpp 
 @ @ - 291 , 7 + 291 , 7 @ @ JNIEXPORT void JNICALL Java _ io _ realm _ internal _ Table _ nativeConvertColumnToNotNull 
 std : : ostringstream ss ; 
 ss < < std : : string ( " _ _ TMP _ _ " ) < < j ; 
 if ( table - > get _ column _ index ( ss . str ( ) ) = = realm : : not _ found ) { 
 - table - > insert _ column ( column _ index , column _ type , ss . str ( ) , true ) ; 
 + table - > insert _ column ( column _ index , column _ type , ss . str ( ) , false ) ; 
 tmp _ column _ name = ss . str ( ) ; 
 break ; 
 } 
 diff - - git a / realm / src / androidTest / java / io / realm / internal / JNITableTest . java b / realm / src / androidTest / java / io / realm / internal / JNITableTest . java 
 index 837b729 . . dcd2f94 100644 
 - - - a / realm / src / androidTest / java / io / realm / internal / JNITableTest . java 
 + + + b / realm / src / androidTest / java / io / realm / internal / JNITableTest . java 
 @ @ - 490 , 6 + 490 , 7 @ @ public class JNITableTest extends AndroidTestCase { 
 assertEquals ( 1 , table . size ( ) ) ; 
 
 table . convertColumnToNullable ( colIndex ) ; 
 + assertTrue ( table . isColumnNullable ( colIndex ) ) ; 
 assertEquals ( 1 , table . size ( ) ) ; 
 assertEquals ( 2 , table . getColumnCount ( ) ) ; 
 assertTrue ( table . getColumnIndex ( columnName ) > = 0 ) ; 
 @ @ - 559 , 6 + 560 , 7 @ @ public class JNITableTest extends AndroidTestCase { 
 assertEquals ( 2 , table . size ( ) ) ; 
 
 table . convertColumnToNotNullable ( colIndex ) ; 
 + assertFalse ( table . isColumnNullable ( colIndex ) ) ; 
 assertEquals ( 2 , table . size ( ) ) ; 
 assertEquals ( 2 , table . getColumnCount ( ) ) ; 
 assertTrue ( table . getColumnIndex ( columnName ) > = 0 ) ;

NEAREST DIFF:
diff - - git a / changelog . txt b / changelog . txt 
 index 6b92c68 . . ad6d84d 100644 
 - - - a / changelog . txt 
 + + + b / changelog . txt 
 @ @ - 1 , 3 + 1 , 6 @ @ 
 + 0 . 81 . 0 
 + * Fixed a bug making it impossible to open Realms created by Realm - Cocoa if a model had a primary key . 
 + 
 0 . 80 . 1 
 * Realm . createOrUpdateWithJson ( ) no longer resets fields to their default value if they are not found in the JSON input . 
 * Realm . compactRealmFile ( ) now uses Realm Core ' s compact ( ) method which is more failure resilient . 
 diff - - git a / realm - jni / src / io _ realm _ internal _ table . cpp b / realm - jni / src / io _ realm _ internal _ table . cpp 
 index 8a6a61b . . d3923a5 100644 
 - - - a / realm - jni / src / io _ realm _ internal _ table . cpp 
 + + + b / realm - jni / src / io _ realm _ internal _ table . cpp 
 @ @ - 1485 , 8 + 1485 , 11 @ @ JNIEXPORT jlong JNICALL Java _ io _ realm _ internal _ Table _ nativeSetPrimaryKey ( 
 return 0 ; 
 } 
 
 - / / Fix wrong primary key table created on Realm - Android 0 . 80 . 1 and below 
 - / / https : / / github . com / realm / realm - java / issues / 1059 
 + / / Fixes interop issue with Cocoa Realm where the Primary Key table had different types . 
 + / / This effects : 
 + / / - All Realms created by Cocoa and used by Realm - android up to 0 . 80 . 1 
 + / / - All Realms created by Realm - Android 0 . 80 . 1 and below 
 + / / See https : / / github . com / realm / realm - java / issues / 1059 
 JNIEXPORT void JNICALL Java _ io _ realm _ internal _ Table _ nativeMigratePrimaryKeyTableIfNeeded 
 ( JNIEnv * env , jobject , jlong groupNativePtr , jlong privateKeyTableNativePtr ) 
 { 
 @ @ - 1506 , 7 + 1509 , 7 @ @ JNIEXPORT void JNICALL Java _ io _ realm _ internal _ Table _ nativeMigratePrimaryKeyTable 
 } 
 
 / / Delete old int column , and rename tmp column to same name 
 - / / Index should match as we control creation of table 
 + / / Index should stay the same as we control creation of table 
 pk _ table - > remove _ column ( io _ realm _ internal _ Table _ PRIMARY _ KEY _ FIELD _ COLUMN _ INDEX ) ; 
 pk _ table - > rename _ column ( pk _ table - > get _ column _ index ( tmp _ col _ name ) , StringData ( " pk _ property " ) ) ; 
 }
