BLEU SCORE: 0.6389431042462724

TEST MSG: fix failing tests
GENERATED MSG: fix failing test

TEST DIFF (one line): diff - - git a / realm / realm - library / src / androidTestObjectServer / java / io / realm / SchemaTests . java b / realm / realm - library / src / androidTestObjectServer / java / io / realm / SchemaTests . java <nl> index 92c4cfd . . b7c6e43 100644 <nl> - - - a / realm / realm - library / src / androidTestObjectServer / java / io / realm / SchemaTests . java <nl> + + + b / realm / realm - library / src / androidTestObjectServer / java / io / realm / SchemaTests . java <nl> @ @ - 165 , 6 + 165 , 8 @ @ public class SchemaTests { <nl> <nl> @ Test <nl> public void addPrimaryKey _ notAllowed ( ) { <nl> + / / Init schema <nl> + Realm . getInstance ( config ) . close ( ) ; <nl> String className = " StringOnly " ; <nl> String fieldName = " chars " ; <nl> DynamicRealm realm = DynamicRealm . getInstance ( config ) ; <nl> @ @ - 179 , 13 + 181 , 15 @ @ public class SchemaTests { <nl> fail ( ) ; <nl> } catch ( UnsupportedOperationException ignored ) { <nl> } finally { <nl> - realm . commitTransaction ( ) ; <nl> + realm . cancelTransaction ( ) ; <nl> realm . close ( ) ; <nl> } <nl> } <nl> <nl> @ Test <nl> public void addField _ withPrimaryKeyModifier _ notAllowed ( ) { <nl> + / / Init schema <nl> + Realm . getInstance ( config ) . close ( ) ; <nl> String className = " StringOnly " ; <nl> DynamicRealm realm = DynamicRealm . getInstance ( config ) ; <nl> <nl> @ @ - 194 , 11 + 198 , 11 @ @ public class SchemaTests { <nl> assertNotNull ( objectSchema ) ; <nl> <nl> try { <nl> - objectSchema . addField ( " foo " , String . class , FieldAttribute . PRIMARY _ KEY ) ; <nl> + objectSchema . addField ( " bar " , String . class , FieldAttribute . PRIMARY _ KEY ) ; <nl> fail ( ) ; <nl> } catch ( UnsupportedOperationException ignored ) { <nl> } finally { <nl> - realm . commitTransaction ( ) ; <nl> + realm . cancelTransaction ( ) ; <nl> realm . close ( ) ; <nl> } <nl> }
NEAREST DIFF (one line): diff - - git a / realm / realm - library / src / androidTestObjectServer / java / io / realm / SchemaTests . java b / realm / realm - library / src / androidTestObjectServer / java / io / realm / SchemaTests . java <nl> index 4221aca . . 92c4cfd 100644 <nl> - - - a / realm / realm - library / src / androidTestObjectServer / java / io / realm / SchemaTests . java <nl> + + + b / realm / realm - library / src / androidTestObjectServer / java / io / realm / SchemaTests . java <nl> @ @ - 133 , 8 + 133 , 8 @ @ public class SchemaTests { <nl> String fieldName = " chars " ; <nl> final RealmObjectSchema objectSchema = realm . getSchema ( ) . get ( className ) ; <nl> assertNotNull ( objectSchema ) ; <nl> - realm . beginTransaction ( ) ; <nl> assertTrue ( objectSchema . hasField ( fieldName ) ) ; <nl> + realm . beginTransaction ( ) ; <nl> try { <nl> objectSchema . removeField ( fieldName ) ; <nl> fail ( ) ; <nl> @ @ - 166 , 15 + 166 , 16 @ @ public class SchemaTests { <nl> @ Test <nl> public void addPrimaryKey _ notAllowed ( ) { <nl> String className = " StringOnly " ; <nl> + String fieldName = " chars " ; <nl> DynamicRealm realm = DynamicRealm . getInstance ( config ) ; <nl> <nl> - realm . beginTransaction ( ) ; <nl> RealmObjectSchema objectSchema = realm . getSchema ( ) . get ( className ) ; <nl> assertNotNull ( objectSchema ) ; <nl> - objectSchema . addField ( " foo " , String . class ) ; <nl> + assertTrue ( objectSchema . hasField ( fieldName ) ) ; <nl> <nl> + realm . beginTransaction ( ) ; <nl> try { <nl> - objectSchema . addPrimaryKey ( " foo " ) ; <nl> + objectSchema . addPrimaryKey ( fieldName ) ; <nl> fail ( ) ; <nl> } catch ( UnsupportedOperationException ignored ) { <nl> } finally {

TEST DIFF:
diff - - git a / realm / realm - library / src / androidTestObjectServer / java / io / realm / SchemaTests . java b / realm / realm - library / src / androidTestObjectServer / java / io / realm / SchemaTests . java 
 index 92c4cfd . . b7c6e43 100644 
 - - - a / realm / realm - library / src / androidTestObjectServer / java / io / realm / SchemaTests . java 
 + + + b / realm / realm - library / src / androidTestObjectServer / java / io / realm / SchemaTests . java 
 @ @ - 165 , 6 + 165 , 8 @ @ public class SchemaTests { 
 
 @ Test 
 public void addPrimaryKey _ notAllowed ( ) { 
 + / / Init schema 
 + Realm . getInstance ( config ) . close ( ) ; 
 String className = " StringOnly " ; 
 String fieldName = " chars " ; 
 DynamicRealm realm = DynamicRealm . getInstance ( config ) ; 
 @ @ - 179 , 13 + 181 , 15 @ @ public class SchemaTests { 
 fail ( ) ; 
 } catch ( UnsupportedOperationException ignored ) { 
 } finally { 
 - realm . commitTransaction ( ) ; 
 + realm . cancelTransaction ( ) ; 
 realm . close ( ) ; 
 } 
 } 
 
 @ Test 
 public void addField _ withPrimaryKeyModifier _ notAllowed ( ) { 
 + / / Init schema 
 + Realm . getInstance ( config ) . close ( ) ; 
 String className = " StringOnly " ; 
 DynamicRealm realm = DynamicRealm . getInstance ( config ) ; 
 
 @ @ - 194 , 11 + 198 , 11 @ @ public class SchemaTests { 
 assertNotNull ( objectSchema ) ; 
 
 try { 
 - objectSchema . addField ( " foo " , String . class , FieldAttribute . PRIMARY _ KEY ) ; 
 + objectSchema . addField ( " bar " , String . class , FieldAttribute . PRIMARY _ KEY ) ; 
 fail ( ) ; 
 } catch ( UnsupportedOperationException ignored ) { 
 } finally { 
 - realm . commitTransaction ( ) ; 
 + realm . cancelTransaction ( ) ; 
 realm . close ( ) ; 
 } 
 }

NEAREST DIFF:
diff - - git a / realm / realm - library / src / androidTestObjectServer / java / io / realm / SchemaTests . java b / realm / realm - library / src / androidTestObjectServer / java / io / realm / SchemaTests . java 
 index 4221aca . . 92c4cfd 100644 
 - - - a / realm / realm - library / src / androidTestObjectServer / java / io / realm / SchemaTests . java 
 + + + b / realm / realm - library / src / androidTestObjectServer / java / io / realm / SchemaTests . java 
 @ @ - 133 , 8 + 133 , 8 @ @ public class SchemaTests { 
 String fieldName = " chars " ; 
 final RealmObjectSchema objectSchema = realm . getSchema ( ) . get ( className ) ; 
 assertNotNull ( objectSchema ) ; 
 - realm . beginTransaction ( ) ; 
 assertTrue ( objectSchema . hasField ( fieldName ) ) ; 
 + realm . beginTransaction ( ) ; 
 try { 
 objectSchema . removeField ( fieldName ) ; 
 fail ( ) ; 
 @ @ - 166 , 15 + 166 , 16 @ @ public class SchemaTests { 
 @ Test 
 public void addPrimaryKey _ notAllowed ( ) { 
 String className = " StringOnly " ; 
 + String fieldName = " chars " ; 
 DynamicRealm realm = DynamicRealm . getInstance ( config ) ; 
 
 - realm . beginTransaction ( ) ; 
 RealmObjectSchema objectSchema = realm . getSchema ( ) . get ( className ) ; 
 assertNotNull ( objectSchema ) ; 
 - objectSchema . addField ( " foo " , String . class ) ; 
 + assertTrue ( objectSchema . hasField ( fieldName ) ) ; 
 
 + realm . beginTransaction ( ) ; 
 try { 
 - objectSchema . addPrimaryKey ( " foo " ) ; 
 + objectSchema . addPrimaryKey ( fieldName ) ; 
 fail ( ) ; 
 } catch ( UnsupportedOperationException ignored ) { 
 } finally {
