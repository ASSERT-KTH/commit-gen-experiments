BLEU SCORE: 0.05341087579952926

TEST MSG: Use transitive dependencies in CMake
GENERATED MSG: Disabling sync / compact combo

TEST DIFF (one line): diff - - git a / realm / realm - library / src / main / cpp / CMakeLists . txt b / realm / realm - library / src / main / cpp / CMakeLists . txt <nl> index dadf564 . . 5b84b34 100644 <nl> - - - a / realm / realm - library / src / main / cpp / CMakeLists . txt <nl> + + + b / realm / realm - library / src / main / cpp / CMakeLists . txt <nl> @ @ - 77 , 7 + 77 , 11 @ @ if ( NOT EXISTS $ { core _ lib _ PATH } ) <nl> endif ( ) <nl> <nl> add _ library ( lib _ realm _ core STATIC IMPORTED ) <nl> - set _ target _ properties ( lib _ realm _ core PROPERTIES IMPORTED _ LOCATION $ { core _ lib _ PATH } ) <nl> + <nl> + # - latomic is not set by default for mips and armv5 . <nl> + # See https : / / code . google . com / p / android / issues / detail ? id = 182094 <nl> + set _ target _ properties ( lib _ realm _ core PROPERTIES IMPORTED _ LOCATION $ { core _ lib _ PATH } <nl> + IMPORTED _ LINK _ INTERFACE _ LIBRARIES atomic ) <nl> <nl> # Sync static library <nl> set ( sync _ lib _ PATH $ { REALM _ CORE _ DIST _ DIR } / librealm - sync - android - $ { ANDROID _ ABI } . a ) <nl> @ @ - 94 , 7 + 98 , 8 @ @ if ( NOT EXISTS $ { sync _ lib _ PATH } ) <nl> endif ( ) <nl> endif ( ) <nl> add _ library ( lib _ realm _ sync STATIC IMPORTED ) <nl> - set _ target _ properties ( lib _ realm _ sync PROPERTIES IMPORTED _ LOCATION $ { sync _ lib _ PATH } ) <nl> + set _ target _ properties ( lib _ realm _ sync PROPERTIES IMPORTED _ LOCATION $ { sync _ lib _ PATH } <nl> + IMPORTED _ LINK _ INTERFACE _ LIBRARIES lib _ realm _ core ) <nl> <nl> # build application ' s shared lib <nl> include _ directories ( $ { REALM _ CORE _ DIST _ DIR } / include <nl> @ @ - 172 , 12 + 177 , 11 @ @ endif ( ) <nl> <nl> add _ library ( realm - jni SHARED $ { jni _ SRC } $ { objectstore _ SRC } $ { objectstore _ sync _ SRC } ) <nl> add _ dependencies ( realm - jni jni _ headers ) <nl> - # - latomic is not set by default for mips . See https : / / code . google . com / p / android / issues / detail ? id = 182094 <nl> + <nl> if ( build _ SYNC ) <nl> - # FIXME : The order matters ! lib _ realm _ sync needs to be in front of lib _ realm _ core ! ! Find out why ! ! <nl> - target _ link _ libraries ( realm - jni log android atomic lib _ realm _ sync lib _ realm _ core ) <nl> + target _ link _ libraries ( realm - jni log android lib _ realm _ sync ) <nl> else ( ) <nl> - target _ link _ libraries ( realm - jni log android atomic lib _ realm _ core ) <nl> + target _ link _ libraries ( realm - jni log android lib _ realm _ core ) <nl> endif ( ) <nl> <nl> # Strip the release so files and backup the unstripped versions
NEAREST DIFF (one line): diff - - git a / CHANGELOG . md b / CHANGELOG . md <nl> index 58be2af . . afd128c 100644 <nl> - - - a / CHANGELOG . md <nl> + + + b / CHANGELOG . md <nl> @ @ - 1 , 5 + 1 , 9 @ @ <nl> # # 2 . 2 . 2 <nl> <nl> + # # # Object Server API Changes ( In Beta ) <nl> + <nl> + * Disabled ` Realm . compactRealm ( ) ` when sync is enabled as it might corrupt the Realm ( https : / / github . com / realm / realm - core / issues / 2345 ) . <nl> + <nl> # # # Enhancements <nl> <nl> * All major public classes are now non - final . This is mostly a compromise to <nl> diff - - git a / realm / realm - library / src / androidTestObjectServer / java / io / realm / SyncConfigurationTests . java b / realm / realm - library / src / androidTestObjectServer / java / io / realm / SyncConfigurationTests . java <nl> index 17b734f . . 938fe33 100644 <nl> - - - a / realm / realm - library / src / androidTestObjectServer / java / io / realm / SyncConfigurationTests . java <nl> + + + b / realm / realm - library / src / androidTestObjectServer / java / io / realm / SyncConfigurationTests . java <nl> @ @ - 401 , 4 + 401 , 14 @ @ public class SyncConfigurationTests { <nl> String configStr = config . toString ( ) ; <nl> assertTrue ( configStr ! = null & & ! configStr . isEmpty ( ) ) ; <nl> } <nl> + <nl> + / / FIXME : This test can be removed when https : / / github . com / realm / realm - core / issues / 2345 is resolved <nl> + @ Test ( expected = UnsupportedOperationException . class ) <nl> + public void compact _ NotAllowed ( ) { <nl> + SyncUser user = createTestUser ( ) ; <nl> + String url = " realm : / / objectserver . realm . io / default " ; <nl> + SyncConfiguration config = new SyncConfiguration . Builder ( user , url ) . build ( ) ; <nl> + <nl> + Realm . compactRealm ( config ) ; <nl> + } <nl> } <nl> diff - - git a / realm / realm - library / src / main / java / io / realm / Realm . java b / realm / realm - library / src / main / java / io / realm / Realm . java <nl> index f74055d . . 81c4bde 100644 <nl> - - - a / realm / realm - library / src / main / java / io / realm / Realm . java <nl> + + + b / realm / realm - library / src / main / java / io / realm / Realm . java <nl> @ @ - 1555 , 10 + 1555 , 13 @ @ public class Realm extends BaseRealm { <nl> * <nl> * @ param configuration a { @ link RealmConfiguration } pointing to a Realm file . <nl> * @ return { @ code true } if successful , { @ code false } if any file operation failed . <nl> - * @ throws IllegalArgumentException if the realm file is encrypted . Compacting an encrypted Realm file is not <nl> - * supported yet . <nl> + * @ throws UnsupportedOperationException if Realm is synchronized . <nl> * / <nl> public static boolean compactRealm ( RealmConfiguration configuration ) { <nl> + / / FIXME : remove this restriction when https : / / github . com / realm / realm - core / issues / 2345 is resolved <nl> + if ( configuration . isSyncConfiguration ( ) ) { <nl> + throw new UnsupportedOperationException ( " Compacting is not supported yet on synced Realms . See https : / / github . com / realm / realm - core / issues / 2345 " ) ; <nl> + } <nl> return BaseRealm . compactRealm ( configuration ) ; <nl> } <nl>

TEST DIFF:
diff - - git a / realm / realm - library / src / main / cpp / CMakeLists . txt b / realm / realm - library / src / main / cpp / CMakeLists . txt 
 index dadf564 . . 5b84b34 100644 
 - - - a / realm / realm - library / src / main / cpp / CMakeLists . txt 
 + + + b / realm / realm - library / src / main / cpp / CMakeLists . txt 
 @ @ - 77 , 7 + 77 , 11 @ @ if ( NOT EXISTS $ { core _ lib _ PATH } ) 
 endif ( ) 
 
 add _ library ( lib _ realm _ core STATIC IMPORTED ) 
 - set _ target _ properties ( lib _ realm _ core PROPERTIES IMPORTED _ LOCATION $ { core _ lib _ PATH } ) 
 + 
 + # - latomic is not set by default for mips and armv5 . 
 + # See https : / / code . google . com / p / android / issues / detail ? id = 182094 
 + set _ target _ properties ( lib _ realm _ core PROPERTIES IMPORTED _ LOCATION $ { core _ lib _ PATH } 
 + IMPORTED _ LINK _ INTERFACE _ LIBRARIES atomic ) 
 
 # Sync static library 
 set ( sync _ lib _ PATH $ { REALM _ CORE _ DIST _ DIR } / librealm - sync - android - $ { ANDROID _ ABI } . a ) 
 @ @ - 94 , 7 + 98 , 8 @ @ if ( NOT EXISTS $ { sync _ lib _ PATH } ) 
 endif ( ) 
 endif ( ) 
 add _ library ( lib _ realm _ sync STATIC IMPORTED ) 
 - set _ target _ properties ( lib _ realm _ sync PROPERTIES IMPORTED _ LOCATION $ { sync _ lib _ PATH } ) 
 + set _ target _ properties ( lib _ realm _ sync PROPERTIES IMPORTED _ LOCATION $ { sync _ lib _ PATH } 
 + IMPORTED _ LINK _ INTERFACE _ LIBRARIES lib _ realm _ core ) 
 
 # build application ' s shared lib 
 include _ directories ( $ { REALM _ CORE _ DIST _ DIR } / include 
 @ @ - 172 , 12 + 177 , 11 @ @ endif ( ) 
 
 add _ library ( realm - jni SHARED $ { jni _ SRC } $ { objectstore _ SRC } $ { objectstore _ sync _ SRC } ) 
 add _ dependencies ( realm - jni jni _ headers ) 
 - # - latomic is not set by default for mips . See https : / / code . google . com / p / android / issues / detail ? id = 182094 
 + 
 if ( build _ SYNC ) 
 - # FIXME : The order matters ! lib _ realm _ sync needs to be in front of lib _ realm _ core ! ! Find out why ! ! 
 - target _ link _ libraries ( realm - jni log android atomic lib _ realm _ sync lib _ realm _ core ) 
 + target _ link _ libraries ( realm - jni log android lib _ realm _ sync ) 
 else ( ) 
 - target _ link _ libraries ( realm - jni log android atomic lib _ realm _ core ) 
 + target _ link _ libraries ( realm - jni log android lib _ realm _ core ) 
 endif ( ) 
 
 # Strip the release so files and backup the unstripped versions

NEAREST DIFF:
diff - - git a / CHANGELOG . md b / CHANGELOG . md 
 index 58be2af . . afd128c 100644 
 - - - a / CHANGELOG . md 
 + + + b / CHANGELOG . md 
 @ @ - 1 , 5 + 1 , 9 @ @ 
 # # 2 . 2 . 2 
 
 + # # # Object Server API Changes ( In Beta ) 
 + 
 + * Disabled ` Realm . compactRealm ( ) ` when sync is enabled as it might corrupt the Realm ( https : / / github . com / realm / realm - core / issues / 2345 ) . 
 + 
 # # # Enhancements 
 
 * All major public classes are now non - final . This is mostly a compromise to 
 diff - - git a / realm / realm - library / src / androidTestObjectServer / java / io / realm / SyncConfigurationTests . java b / realm / realm - library / src / androidTestObjectServer / java / io / realm / SyncConfigurationTests . java 
 index 17b734f . . 938fe33 100644 
 - - - a / realm / realm - library / src / androidTestObjectServer / java / io / realm / SyncConfigurationTests . java 
 + + + b / realm / realm - library / src / androidTestObjectServer / java / io / realm / SyncConfigurationTests . java 
 @ @ - 401 , 4 + 401 , 14 @ @ public class SyncConfigurationTests { 
 String configStr = config . toString ( ) ; 
 assertTrue ( configStr ! = null & & ! configStr . isEmpty ( ) ) ; 
 } 
 + 
 + / / FIXME : This test can be removed when https : / / github . com / realm / realm - core / issues / 2345 is resolved 
 + @ Test ( expected = UnsupportedOperationException . class ) 
 + public void compact _ NotAllowed ( ) { 
 + SyncUser user = createTestUser ( ) ; 
 + String url = " realm : / / objectserver . realm . io / default " ; 
 + SyncConfiguration config = new SyncConfiguration . Builder ( user , url ) . build ( ) ; 
 + 
 + Realm . compactRealm ( config ) ; 
 + } 
 } 
 diff - - git a / realm / realm - library / src / main / java / io / realm / Realm . java b / realm / realm - library / src / main / java / io / realm / Realm . java 
 index f74055d . . 81c4bde 100644 
 - - - a / realm / realm - library / src / main / java / io / realm / Realm . java 
 + + + b / realm / realm - library / src / main / java / io / realm / Realm . java 
 @ @ - 1555 , 10 + 1555 , 13 @ @ public class Realm extends BaseRealm { 
 * 
 * @ param configuration a { @ link RealmConfiguration } pointing to a Realm file . 
 * @ return { @ code true } if successful , { @ code false } if any file operation failed . 
 - * @ throws IllegalArgumentException if the realm file is encrypted . Compacting an encrypted Realm file is not 
 - * supported yet . 
 + * @ throws UnsupportedOperationException if Realm is synchronized . 
 * / 
 public static boolean compactRealm ( RealmConfiguration configuration ) { 
 + / / FIXME : remove this restriction when https : / / github . com / realm / realm - core / issues / 2345 is resolved 
 + if ( configuration . isSyncConfiguration ( ) ) { 
 + throw new UnsupportedOperationException ( " Compacting is not supported yet on synced Realms . See https : / / github . com / realm / realm - core / issues / 2345 " ) ; 
 + } 
 return BaseRealm . compactRealm ( configuration ) ; 
 } 

