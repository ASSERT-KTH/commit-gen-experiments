BLEU SCORE: 0.027611988917697356

TEST MSG: fix leak when Property is added to OsRealmObjectSchema
GENERATED MSG: Add support for checks for :

TEST DIFF (one line): diff - - git a / realm / realm - library / src / main / java / io / realm / OsRealmObjectSchema . java b / realm / realm - library / src / main / java / io / realm / OsRealmObjectSchema . java <nl> index 922e28a . . 4cce7b0 100644 <nl> - - - a / realm / realm - library / src / main / java / io / realm / OsRealmObjectSchema . java <nl> + + + b / realm / realm - library / src / main / java / io / realm / OsRealmObjectSchema . java <nl> @ @ - 167 , 13 + 167 , 23 @ @ class OsRealmObjectSchema extends RealmObjectSchema { <nl> <nl> @ Override <nl> OsRealmObjectSchema add ( String name , RealmFieldType type , boolean primary , boolean indexed , boolean required ) { <nl> - nativeAddProperty ( nativePtr , new Property ( name , type , primary , indexed , required ) . getNativePtr ( ) ) ; <nl> + final Property property = new Property ( name , type , primary , indexed , required ) ; <nl> + try { <nl> + nativeAddProperty ( nativePtr , property . getNativePtr ( ) ) ; <nl> + } finally { <nl> + property . close ( ) ; <nl> + } <nl> return this ; <nl> } <nl> <nl> @ Override <nl> OsRealmObjectSchema add ( String name , RealmFieldType type , RealmObjectSchema linkedTo ) { <nl> - nativeAddProperty ( nativePtr , new Property ( name , type , linkedTo ) . getNativePtr ( ) ) ; <nl> + final Property property = new Property ( name , type , linkedTo ) ; <nl> + try { <nl> + nativeAddProperty ( nativePtr , property . getNativePtr ( ) ) ; <nl> + } finally { <nl> + property . close ( ) ; <nl> + } <nl> return this ; <nl> } <nl>
NEAREST DIFF (one line): diff - - git a / realm / config / checkstyle / checkstyle . xml b / realm / config / checkstyle / checkstyle . xml <nl> index 398a6ec . . e505156 100644 <nl> - - - a / realm / config / checkstyle / checkstyle . xml <nl> + + + b / realm / config / checkstyle / checkstyle . xml <nl> @ @ - 9 , 12 + 9 , 11 @ @ <nl> < property name = " file " value = " $ { proj . module . dir } / config / checkstyle / checkstyle - suppressions . xml " / > <nl> < / module > <nl> <nl> - < ! - - TODO : UNCOMMENT <nl> < module name = " NewlineAtEndOfFile " > <nl> < property name = " lineSeparator " value = " lf " / > <nl> < / module > <nl> < module name = " FileLength " / > <nl> - < module name = " FileTabCharacter " / > - - > <nl> + < module name = " FileTabCharacter " / > <nl> <nl> < ! - - Trailing spaces - - > <nl> < ! - - TODO : UNCOMMENT <nl> @ @ - 23 , 9 + 22 , 9 @ @ <nl> < property name = " message " value = " Line has trailing spaces . " / > <nl> < / module > - - > <nl> <nl> - < ! - - Space after ' for ' and ' if ' - - > <nl> + < ! - - Space after ' for ' , ' if ' , ' while ' - - > <nl> < module name = " RegexpSingleline " > <nl> - < property name = " format " value = " ^ \ s * ( for | if ) [ ^ ] " / > <nl> + < property name = " format " value = " ^ \ s * ( for | if | while ) [ ^ ] " / > <nl> < property name = " message " value = " Space needed before opening parenthesis . " / > <nl> < / module > <nl> <nl> @ @ - 71 , 10 + 70 , 11 @ @ <nl> <nl> < ! - - Checks for Size Violations . - - > <nl> < ! - - See http : / / checkstyle . sf . net / config _ sizes . html - - > <nl> + < ! - - TODO : UNCOMMENT <nl> < module name = " LineLength " > <nl> < property name = " max " value = " 120 " / > <nl> < property name = " severity " value = " warning " / > <nl> - < / module > <nl> + < / module > - - > <nl> < ! - - < module name = " MethodLength " / > - - > <nl> < ! - - < module name = " ParameterNumber " / > - - > <nl> <nl> @ @ - 90 , 8 + 90 , 10 @ @ <nl> < module name = " OperatorWrap " / > <nl> < module name = " ParenPad " / > <nl> < module name = " TypecastParenPad " / > <nl> - < module name = " WhitespaceAfter " / > <nl> - < module name = " WhitespaceAround " / > - - > <nl> + < module name = " WhitespaceAfter " / > - - > <nl> + < module name = " WhitespaceAround " > <nl> + < property name = " tokens " value = " LITERAL _ DO " / > <nl> + < / module > <nl> <nl> <nl> < ! - - Modifier Checks - - > <nl> diff - - git a / realm / src / androidTest / java / io / realm / RealmAdapterTest . java b / realm / src / androidTest / java / io / realm / RealmAdapterTest . java <nl> index 75020fa . . 88b0d7c 100644 <nl> - - - a / realm / src / androidTest / java / io / realm / RealmAdapterTest . java <nl> + + + b / realm / src / androidTest / java / io / realm / RealmAdapterTest . java <nl> @ @ - 16 , 13 + 16 , 11 @ @ <nl> package io . realm ; <nl> <nl> import android . test . AndroidTestCase ; <nl> - import android . util . Log ; <nl> import android . view . View ; <nl> import android . widget . TextView ; <nl> <nl> import io . realm . entities . AllTypes ; <nl> import io . realm . entities . RealmAdapter ; <nl> - import io . realm . exceptions . RealmException ; <nl> <nl> public class RealmAdapterTest extends AndroidTestCase { <nl> <nl> diff - - git a / realm / src / androidTest / java / io / realm / RealmAnnotationTest . java b / realm / src / androidTest / java / io / realm / RealmAnnotationTest . java <nl> index 445465e . . 9910a7b 100644 <nl> - - - a / realm / src / androidTest / java / io / realm / RealmAnnotationTest . java <nl> + + + b / realm / src / androidTest / java / io / realm / RealmAnnotationTest . java <nl> @ @ - 207 , 4 + 207 , 4 @ @ public class RealmAnnotationTest extends AndroidTestCase { <nl> assertTrue ( anc2 . isObject ( ) ) ; <nl> realm . close ( ) ; <nl> } <nl> - } <nl> \ No newline at end of file <nl> + } <nl> diff - - git a / realm / src / androidTest / java / io / realm / RealmJsonTest . java b / realm / src / androidTest / java / io / realm / RealmJsonTest . java <nl> index 754ea23 . . 0ff63ec 100644 <nl> - - - a / realm / src / androidTest / java / io / realm / RealmJsonTest . java <nl> + + + b / realm / src / androidTest / java / io / realm / RealmJsonTest . java <nl> @ @ - 621 , 4 + 621 , 4 @ @ public class RealmJsonTest extends AndroidTestCase { <nl> assertEquals ( 2 , obj . getColumnRealmList ( ) . size ( ) ) ; <nl> assertEquals ( " Dog5 " , obj . getColumnRealmList ( ) . get ( 0 ) . getName ( ) ) ; <nl> } <nl> - } <nl> \ No newline at end of file <nl> + } <nl> diff - - git a / realm / src / main / java / io / realm / Realm . java b / realm / src / main / java / io / realm / Realm . java <nl> index 60c446f . . ced04b8 100644 <nl> - - - a / realm / src / main / java / io / realm / Realm . java <nl> + + + b / realm / src / main / java / io / realm / Realm . java <nl> @ @ - 607 , 7 + 607 , 7 @ @ public final class Realm implements Closeable { <nl> if ( currentVersion ! = UNVERSIONED & & requiredVersion < currentVersion & & validateSchema ) { <nl> realm . close ( ) ; <nl> throw new IllegalArgumentException ( String . format ( " Realm on disc is newer than the one specified : v % s vs . v % s " , currentVersion , requiredVersion ) ) ; <nl> - 	 	 } <nl> + } <nl> <nl> / / Initialize Realm schema if needed <nl> if ( validateSchema ) { <nl> diff - - git a / realm / src / main / java / io / realm / internal / RealmCore . java b / realm / src / main / java / io / realm / internal / RealmCore . java <nl> index d60c075 . . b4c7601 100644 <nl> - - - a / realm / src / main / java / io / realm / internal / RealmCore . java <nl> + + + b / realm / src / main / java / io / realm / internal / RealmCore . java <nl> @ @ - 101 , 7 + 101 , 7 @ @ public class RealmCore { <nl> Object obj = new Object ( ) ; <nl> WeakReference < Object > ref = new WeakReference < Object > ( obj ) ; <nl> obj = null ; <nl> - while ( ref . get ( ) ! = null ) <nl> + while ( ref . get ( ) ! = null ) <nl> System . gc ( ) ; <nl> } <nl>

TEST DIFF:
diff - - git a / realm / realm - library / src / main / java / io / realm / OsRealmObjectSchema . java b / realm / realm - library / src / main / java / io / realm / OsRealmObjectSchema . java 
 index 922e28a . . 4cce7b0 100644 
 - - - a / realm / realm - library / src / main / java / io / realm / OsRealmObjectSchema . java 
 + + + b / realm / realm - library / src / main / java / io / realm / OsRealmObjectSchema . java 
 @ @ - 167 , 13 + 167 , 23 @ @ class OsRealmObjectSchema extends RealmObjectSchema { 
 
 @ Override 
 OsRealmObjectSchema add ( String name , RealmFieldType type , boolean primary , boolean indexed , boolean required ) { 
 - nativeAddProperty ( nativePtr , new Property ( name , type , primary , indexed , required ) . getNativePtr ( ) ) ; 
 + final Property property = new Property ( name , type , primary , indexed , required ) ; 
 + try { 
 + nativeAddProperty ( nativePtr , property . getNativePtr ( ) ) ; 
 + } finally { 
 + property . close ( ) ; 
 + } 
 return this ; 
 } 
 
 @ Override 
 OsRealmObjectSchema add ( String name , RealmFieldType type , RealmObjectSchema linkedTo ) { 
 - nativeAddProperty ( nativePtr , new Property ( name , type , linkedTo ) . getNativePtr ( ) ) ; 
 + final Property property = new Property ( name , type , linkedTo ) ; 
 + try { 
 + nativeAddProperty ( nativePtr , property . getNativePtr ( ) ) ; 
 + } finally { 
 + property . close ( ) ; 
 + } 
 return this ; 
 } 


NEAREST DIFF:
diff - - git a / realm / config / checkstyle / checkstyle . xml b / realm / config / checkstyle / checkstyle . xml 
 index 398a6ec . . e505156 100644 
 - - - a / realm / config / checkstyle / checkstyle . xml 
 + + + b / realm / config / checkstyle / checkstyle . xml 
 @ @ - 9 , 12 + 9 , 11 @ @ 
 < property name = " file " value = " $ { proj . module . dir } / config / checkstyle / checkstyle - suppressions . xml " / > 
 < / module > 
 
 - < ! - - TODO : UNCOMMENT 
 < module name = " NewlineAtEndOfFile " > 
 < property name = " lineSeparator " value = " lf " / > 
 < / module > 
 < module name = " FileLength " / > 
 - < module name = " FileTabCharacter " / > - - > 
 + < module name = " FileTabCharacter " / > 
 
 < ! - - Trailing spaces - - > 
 < ! - - TODO : UNCOMMENT 
 @ @ - 23 , 9 + 22 , 9 @ @ 
 < property name = " message " value = " Line has trailing spaces . " / > 
 < / module > - - > 
 
 - < ! - - Space after ' for ' and ' if ' - - > 
 + < ! - - Space after ' for ' , ' if ' , ' while ' - - > 
 < module name = " RegexpSingleline " > 
 - < property name = " format " value = " ^ \ s * ( for | if ) [ ^ ] " / > 
 + < property name = " format " value = " ^ \ s * ( for | if | while ) [ ^ ] " / > 
 < property name = " message " value = " Space needed before opening parenthesis . " / > 
 < / module > 
 
 @ @ - 71 , 10 + 70 , 11 @ @ 
 
 < ! - - Checks for Size Violations . - - > 
 < ! - - See http : / / checkstyle . sf . net / config _ sizes . html - - > 
 + < ! - - TODO : UNCOMMENT 
 < module name = " LineLength " > 
 < property name = " max " value = " 120 " / > 
 < property name = " severity " value = " warning " / > 
 - < / module > 
 + < / module > - - > 
 < ! - - < module name = " MethodLength " / > - - > 
 < ! - - < module name = " ParameterNumber " / > - - > 
 
 @ @ - 90 , 8 + 90 , 10 @ @ 
 < module name = " OperatorWrap " / > 
 < module name = " ParenPad " / > 
 < module name = " TypecastParenPad " / > 
 - < module name = " WhitespaceAfter " / > 
 - < module name = " WhitespaceAround " / > - - > 
 + < module name = " WhitespaceAfter " / > - - > 
 + < module name = " WhitespaceAround " > 
 + < property name = " tokens " value = " LITERAL _ DO " / > 
 + < / module > 
 
 
 < ! - - Modifier Checks - - > 
 diff - - git a / realm / src / androidTest / java / io / realm / RealmAdapterTest . java b / realm / src / androidTest / java / io / realm / RealmAdapterTest . java 
 index 75020fa . . 88b0d7c 100644 
 - - - a / realm / src / androidTest / java / io / realm / RealmAdapterTest . java 
 + + + b / realm / src / androidTest / java / io / realm / RealmAdapterTest . java 
 @ @ - 16 , 13 + 16 , 11 @ @ 
 package io . realm ; 
 
 import android . test . AndroidTestCase ; 
 - import android . util . Log ; 
 import android . view . View ; 
 import android . widget . TextView ; 
 
 import io . realm . entities . AllTypes ; 
 import io . realm . entities . RealmAdapter ; 
 - import io . realm . exceptions . RealmException ; 
 
 public class RealmAdapterTest extends AndroidTestCase { 
 
 diff - - git a / realm / src / androidTest / java / io / realm / RealmAnnotationTest . java b / realm / src / androidTest / java / io / realm / RealmAnnotationTest . java 
 index 445465e . . 9910a7b 100644 
 - - - a / realm / src / androidTest / java / io / realm / RealmAnnotationTest . java 
 + + + b / realm / src / androidTest / java / io / realm / RealmAnnotationTest . java 
 @ @ - 207 , 4 + 207 , 4 @ @ public class RealmAnnotationTest extends AndroidTestCase { 
 assertTrue ( anc2 . isObject ( ) ) ; 
 realm . close ( ) ; 
 } 
 - } 
 \ No newline at end of file 
 + } 
 diff - - git a / realm / src / androidTest / java / io / realm / RealmJsonTest . java b / realm / src / androidTest / java / io / realm / RealmJsonTest . java 
 index 754ea23 . . 0ff63ec 100644 
 - - - a / realm / src / androidTest / java / io / realm / RealmJsonTest . java 
 + + + b / realm / src / androidTest / java / io / realm / RealmJsonTest . java 
 @ @ - 621 , 4 + 621 , 4 @ @ public class RealmJsonTest extends AndroidTestCase { 
 assertEquals ( 2 , obj . getColumnRealmList ( ) . size ( ) ) ; 
 assertEquals ( " Dog5 " , obj . getColumnRealmList ( ) . get ( 0 ) . getName ( ) ) ; 
 } 
 - } 
 \ No newline at end of file 
 + } 
 diff - - git a / realm / src / main / java / io / realm / Realm . java b / realm / src / main / java / io / realm / Realm . java 
 index 60c446f . . ced04b8 100644 
 - - - a / realm / src / main / java / io / realm / Realm . java 
 + + + b / realm / src / main / java / io / realm / Realm . java 
 @ @ - 607 , 7 + 607 , 7 @ @ public final class Realm implements Closeable { 
 if ( currentVersion ! = UNVERSIONED & & requiredVersion < currentVersion & & validateSchema ) { 
 realm . close ( ) ; 
 throw new IllegalArgumentException ( String . format ( " Realm on disc is newer than the one specified : v % s vs . v % s " , currentVersion , requiredVersion ) ) ; 
 - 	 	 } 
 + } 
 
 / / Initialize Realm schema if needed 
 if ( validateSchema ) { 
 diff - - git a / realm / src / main / java / io / realm / internal / RealmCore . java b / realm / src / main / java / io / realm / internal / RealmCore . java 
 index d60c075 . . b4c7601 100644 
 - - - a / realm / src / main / java / io / realm / internal / RealmCore . java 
 + + + b / realm / src / main / java / io / realm / internal / RealmCore . java 
 @ @ - 101 , 7 + 101 , 7 @ @ public class RealmCore { 
 Object obj = new Object ( ) ; 
 WeakReference < Object > ref = new WeakReference < Object > ( obj ) ; 
 obj = null ; 
 - while ( ref . get ( ) ! = null ) 
 + while ( ref . get ( ) ! = null ) 
 System . gc ( ) ; 
 } 

