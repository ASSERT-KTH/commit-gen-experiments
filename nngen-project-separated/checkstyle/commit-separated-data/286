BLEU SCORE: 0.17359100558362855

TEST MSG: config : add strata project to wercker
GENERATED MSG: Issue # 4829 : add NoErrorTest for sevntu project to wercker

TEST DIFF (one line): diff - - git a / . ci / jsoref - spellchecker / whitelist . words b / . ci / jsoref - spellchecker / whitelist . words <nl> index a215a8e . . 76e49e4 100644 <nl> - - - a / . ci / jsoref - spellchecker / whitelist . words <nl> + + + b / . ci / jsoref - spellchecker / whitelist . words <nl> @ @ - 326 , 6 + 326 , 7 @ @ Dskip <nl> dsm <nl> Dsonar <nl> Dspotbugs <nl> + Dstrict <nl> Dtest <nl> Dubinin <nl> Duser <nl> diff - - git a / . ci / wercker . sh b / . ci / wercker . sh <nl> index 22b71c8 . . 7c4adf1 100755 <nl> - - - a / . ci / wercker . sh <nl> + + + b / . ci / wercker . sh <nl> @ @ - 94 , 6 + 94 , 17 @ @ no - error - sevntu - checks ) <nl> rm - rf sevntu . checkstyle <nl> ; ; <nl> <nl> + no - error - strata ) <nl> + set - e <nl> + CS _ POM _ VERSION = $ ( mvn - e - q - Dexec . executable = ' echo ' - Dexec . args = ' $ { project . version } ' - - non - recursive org . codehaus . mojo : exec - maven - plugin : 1 . 3 . 1 : exec ) <nl> + echo CS _ version : $ { CS _ POM _ VERSION } <nl> + for i in 1 2 3 4 5 ; do git clone https : / / github . com / OpenGamma / Strata & & break | | sleep 15 ; done <nl> + cd Strata <nl> + mvn install - e - B - Dstrict - DskipTests - Dforbiddenapis . skip = true - Dcheckstyle . version = $ { CS _ POM _ VERSION } <nl> + cd . . / <nl> + rm - rf Strata <nl> + ; ; <nl> + <nl> no - exception - struts ) <nl> CS _ POM _ VERSION = $ ( mvn - e - q - Dexec . executable = ' echo ' - Dexec . args = ' $ { project . version } ' - - non - recursive org . codehaus . mojo : exec - maven - plugin : 1 . 3 . 1 : exec ) <nl> echo CS _ version : $ { CS _ POM _ VERSION }
NEAREST DIFF (one line): diff - - git a / config / suppressions . xml b / config / suppressions . xml <nl> index 6c88945 . . 965bd06 100644 <nl> - - - a / config / suppressions . xml <nl> + + + b / config / suppressions . xml <nl> @ @ - 32 , 7 + 32 , 7 @ @ <nl> < suppress checks = " Javadoc " files = " . * [ \ \ / ] src [ \ \ / ] ( test | it ) [ \ \ / ] " / > <nl> < suppress checks = " MagicNumber " files = " . * [ \ \ / ] src [ \ \ / ] ( test | it ) [ \ \ / ] " / > <nl> < suppress checks = " AvoidStaticImport " files = " . * [ \ \ / ] src [ \ \ / ] ( test | it ) [ \ \ / ] " / > <nl> - < suppress checks = " ClassDataAbstractionCoupling " files = " [ \ \ / ] IndentationCheckTest . java $ " / > <nl> + < suppress checks = " ClassDataAbstractionCoupling " files = " [ \ \ / ] IndentationCheckTest . java $ | [ \ \ / ] SuppressWithNearbyCommentFilterTest . java $ | [ \ \ / ] SuppressionCommentFilterTest . java $ " / > <nl> < suppress checks = " EqualsAvoidNull " files = " [ \ \ / ] Int . * FilterTest . java $ " / > <nl> < suppress checks = " VisibilityModifier " files = " [ \ \ / ] BaseCheckTestSupport . java $ | [ \ \ / ] AbstractModuleTestSupport . java $ " / > <nl> < suppress checks = " WriteTag " files = " . * [ \ \ / ] src [ \ \ / ] ( test | it ) [ \ \ / ] " / > <nl> diff - - git a / pom . xml b / pom . xml <nl> index 6b35402 . . 2a99b38 100644 <nl> - - - a / pom . xml <nl> + + + b / pom . xml <nl> @ @ - 2232 , 18 + 2232 , 6 @ @ <nl> < param > com . puppycrawl . tools . checkstyle . filefilters . * < / param > <nl> < param > com . puppycrawl . tools . checkstyle . filters . * < / param > <nl> < / targetTests > <nl> - < excludedMethods > <nl> - < ! - - till https : / / github . com / checkstyle / checkstyle / issues / 4396 - - > <nl> - < param > compareTo < / param > <nl> - < ! - - till https : / / github . com / checkstyle / checkstyle / issues / 4396 - - > <nl> - < param > findNearestMatch < / param > <nl> - < ! - - till https : / / github . com / checkstyle / checkstyle / issues / 4396 - - > <nl> - < param > tagSuppressions < / param > <nl> - < ! - - till https : / / github . com / checkstyle / checkstyle / issues / 4396 - - > <nl> - < param > tagSuppressions < / param > <nl> - < ! - - till https : / / github . com / checkstyle / checkstyle / issues / 4396 - - > <nl> - < param > startElement < / param > <nl> - < / excludedMethods > <nl> < mutationThreshold > 100 < / mutationThreshold > <nl> < timeoutFactor > $ { pitest . plugin . timeout . factor } < / timeoutFactor > <nl> < timeoutConstant > $ { pitest . plugin . timeout . constant } < / timeoutConstant > <nl> diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / filters / SuppressWithNearbyCommentFilter . java b / src / main / java / com / puppycrawl / tools / checkstyle / filters / SuppressWithNearbyCommentFilter . java <nl> index a0d2556 . . fa1b1fd 100644 <nl> - - - a / src / main / java / com / puppycrawl / tools / checkstyle / filters / SuppressWithNearbyCommentFilter . java <nl> + + + b / src / main / java / com / puppycrawl / tools / checkstyle / filters / SuppressWithNearbyCommentFilter . java <nl> @ @ - 22 , 7 + 22 , 6 @ @ package com . puppycrawl . tools . checkstyle . filters ; <nl> import java . lang . ref . WeakReference ; <nl> import java . util . ArrayList ; <nl> import java . util . Collection ; <nl> - import java . util . Collections ; <nl> import java . util . List ; <nl> import java . util . Objects ; <nl> import java . util . regex . Matcher ; <nl> @ @ - 234 , 7 + 233 , 6 @ @ public class SuppressWithNearbyCommentFilter <nl> contents . getBlockComments ( ) . values ( ) ; <nl> cComments . forEach ( this : : tagSuppressions ) ; <nl> } <nl> - Collections . sort ( tags ) ; <nl> } <nl> <nl> / * * <nl> @ @ - 279 , 7 + 277 , 7 @ @ public class SuppressWithNearbyCommentFilter <nl> / * * <nl> * A Tag holds a suppression comment and its location . <nl> * / <nl> - public static class Tag implements Comparable < Tag > { <nl> + public static class Tag { <nl> / * * The text of the tag . * / <nl> private final String text ; <nl> <nl> @ @ - 348 , 26 + 346 , 6 @ @ public class SuppressWithNearbyCommentFilter <nl> } <nl> } <nl> <nl> - / * * <nl> - * Compares the position of this tag in the file <nl> - * with the position of another tag . <nl> - * @ param other the tag to compare with this one . <nl> - * @ return a negative number if this tag is before the other tag , <nl> - * 0 if they are at the same position , and a positive number if this <nl> - * tag is after the other tag . <nl> - * / <nl> - @ Override <nl> - public int compareTo ( Tag other ) { <nl> - final int result ; <nl> - if ( firstLine = = other . firstLine ) { <nl> - result = Integer . compare ( lastLine , other . lastLine ) ; <nl> - } <nl> - else { <nl> - result = Integer . compare ( firstLine , other . firstLine ) ; <nl> - } <nl> - return result ; <nl> - } <nl> - <nl> @ Override <nl> public boolean equals ( Object other ) { <nl> if ( this = = other ) { <nl> diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / filters / SuppressionsLoader . java b / src / main / java / com / puppycrawl / tools / checkstyle / filters / SuppressionsLoader . java <nl> index 8eced85 . . 3a2e05c 100644 <nl> - - - a / src / main / java / com / puppycrawl / tools / checkstyle / filters / SuppressionsLoader . java <nl> + + + b / src / main / java / com / puppycrawl / tools / checkstyle / filters / SuppressionsLoader . java <nl> @ @ - 93 , 9 + 93 , 7 @ @ public final class SuppressionsLoader <nl> try { <nl> final String files = attributes . getValue ( " files " ) ; <nl> suppress = new SuppressElement ( files ) ; <nl> - if ( modId ! = null ) { <nl> - suppress . setModuleId ( modId ) ; <nl> - } <nl> + suppress . setModuleId ( modId ) ; <nl> if ( checks ! = null ) { <nl> suppress . setChecks ( checks ) ; <nl> } <nl> diff - - git a / src / test / java / com / puppycrawl / tools / checkstyle / filters / SuppressWithNearbyCommentFilterTest . java b / src / test / java / com / puppycrawl / tools / checkstyle / filters / SuppressWithNearbyCommentFilterTest . java <nl> index 4e1851a . . fb78a4c 100644 <nl> - - - a / src / test / java / com / puppycrawl / tools / checkstyle / filters / SuppressWithNearbyCommentFilterTest . java <nl> + + + b / src / test / java / com / puppycrawl / tools / checkstyle / filters / SuppressWithNearbyCommentFilterTest . java <nl> @ @ - 20 , 16 + 20 , 18 @ @ <nl> package com . puppycrawl . tools . checkstyle . filters ; <nl> <nl> import static org . junit . Assert . assertEquals ; <nl> + import static org . junit . Assert . assertTrue ; <nl> <nl> import java . io . File ; <nl> import java . io . IOException ; <nl> import java . util . Arrays ; <nl> import java . util . Collection ; <nl> + import java . util . List ; <nl> import java . util . Locale ; <nl> import java . util . stream . Collectors ; <nl> <nl> - import org . junit . Assert ; <nl> import org . junit . Test ; <nl> + import org . powermock . reflect . Whitebox ; <nl> <nl> import com . puppycrawl . tools . checkstyle . BaseCheckTestSupport ; <nl> import com . puppycrawl . tools . checkstyle . BriefUtLogger ; <nl> @ @ - 39 , 6 + 41 , 8 @ @ import com . puppycrawl . tools . checkstyle . TreeWalker ; <nl> import com . puppycrawl . tools . checkstyle . api . AuditEvent ; <nl> import com . puppycrawl . tools . checkstyle . api . CheckstyleException ; <nl> import com . puppycrawl . tools . checkstyle . api . Configuration ; <nl> + import com . puppycrawl . tools . checkstyle . api . FileContents ; <nl> + import com . puppycrawl . tools . checkstyle . api . LocalizedMessage ; <nl> import com . puppycrawl . tools . checkstyle . checks . FileContentsHolder ; <nl> import com . puppycrawl . tools . checkstyle . checks . coding . IllegalCatchCheck ; <nl> import com . puppycrawl . tools . checkstyle . checks . naming . ConstantNameCheck ; <nl> @ @ - 298 , 7 + 302 , 7 @ @ public class SuppressWithNearbyCommentFilterTest <nl> public void testAcceptNullLocalizedMessage ( ) { <nl> final SuppressWithNearbyCommentFilter filter = new SuppressWithNearbyCommentFilter ( ) ; <nl> final AuditEvent auditEvent = new AuditEvent ( this ) ; <nl> - Assert . assertTrue ( filter . accept ( auditEvent ) ) ; <nl> + assertTrue ( filter . accept ( auditEvent ) ) ; <nl> } <nl> <nl> @ Test <nl> @ @ - 343 , 4 + 347 , 29 @ @ public class SuppressWithNearbyCommentFilterTest <nl> getPath ( " InputSuppressByIdWithNearbyCommentFilter . java " ) , <nl> removeSuppressed ( expectedViolationMessages , suppressedViolationMessages ) ) ; <nl> } <nl> + <nl> + @ Test <nl> + public void testTagsAreClearedEachRun ( ) { <nl> + final SuppressWithNearbyCommentFilter suppressionCommentFilter = <nl> + new SuppressWithNearbyCommentFilter ( ) ; <nl> + final AuditEvent dummyEvent = new AuditEvent ( new Object ( ) , " filename " , <nl> + new LocalizedMessage ( 1 , null , null , null , null , Object . class , null ) ) ; <nl> + <nl> + final FileContentsHolder fileContentsHolder = new FileContentsHolder ( ) ; <nl> + final FileContents contents = <nl> + new FileContents ( " filename " , " / / SUPPRESS CHECKSTYLE ignore " , " line2 " ) ; <nl> + contents . reportSingleLineComment ( 1 , 0 ) ; <nl> + fileContentsHolder . setFileContents ( contents ) ; <nl> + fileContentsHolder . beginTree ( null ) ; <nl> + suppressionCommentFilter . accept ( dummyEvent ) ; <nl> + final FileContents contents2 = <nl> + new FileContents ( " filename2 " , " some line " , " / / SUPPRESS CHECKSTYLE ignore " ) ; <nl> + contents2 . reportSingleLineComment ( 2 , 0 ) ; <nl> + fileContentsHolder . setFileContents ( contents2 ) ; <nl> + fileContentsHolder . beginTree ( null ) ; <nl> + suppressionCommentFilter . accept ( dummyEvent ) ; <nl> + final List < SuppressionCommentFilter . Tag > tags = <nl> + Whitebox . getInternalState ( suppressionCommentFilter , " tags " ) ; <nl> + assertEquals ( 1 , tags . size ( ) ) ; <nl> + } <nl> } <nl> diff - - git a / src / test / java / com / puppycrawl / tools / checkstyle / filters / SuppressionCommentFilterTest . java b / src / test / java / com / puppycrawl / tools / checkstyle / filters / SuppressionCommentFilterTest . java <nl> index 72b0f37 . . 3d37f23 100644 <nl> - - - a / src / test / java / com / puppycrawl / tools / checkstyle / filters / SuppressionCommentFilterTest . java <nl> + + + b / src / test / java / com / puppycrawl / tools / checkstyle / filters / SuppressionCommentFilterTest . java <nl> @ @ - 20 , 16 + 20 , 19 @ @ <nl> package com . puppycrawl . tools . checkstyle . filters ; <nl> <nl> import static org . junit . Assert . assertEquals ; <nl> + import static org . junit . Assert . assertFalse ; <nl> <nl> import java . io . File ; <nl> import java . io . IOException ; <nl> import java . util . Arrays ; <nl> import java . util . Collection ; <nl> + import java . util . List ; <nl> import java . util . Locale ; <nl> import java . util . stream . Collectors ; <nl> <nl> import org . junit . Assert ; <nl> import org . junit . Test ; <nl> + import org . powermock . reflect . Whitebox ; <nl> <nl> import com . puppycrawl . tools . checkstyle . BaseCheckTestSupport ; <nl> import com . puppycrawl . tools . checkstyle . BriefUtLogger ; <nl> @ @ - 39 , 6 + 42 , 8 @ @ import com . puppycrawl . tools . checkstyle . TreeWalker ; <nl> import com . puppycrawl . tools . checkstyle . api . AuditEvent ; <nl> import com . puppycrawl . tools . checkstyle . api . CheckstyleException ; <nl> import com . puppycrawl . tools . checkstyle . api . Configuration ; <nl> + import com . puppycrawl . tools . checkstyle . api . FileContents ; <nl> + import com . puppycrawl . tools . checkstyle . api . LocalizedMessage ; <nl> import com . puppycrawl . tools . checkstyle . checks . FileContentsHolder ; <nl> import com . puppycrawl . tools . checkstyle . checks . coding . IllegalCatchCheck ; <nl> import com . puppycrawl . tools . checkstyle . checks . naming . ConstantNameCheck ; <nl> @ @ - 320 , 4 + 325 , 44 @ @ public class SuppressionCommentFilterTest <nl> getPath ( " InputSuppressByIdWithCommentFilter . java " ) , <nl> removeSuppressed ( expectedViolationMessages , suppressedViolationMessages ) ) ; <nl> } <nl> + <nl> + @ Test <nl> + public void testFindNearestMatchDontAllowSameColumn ( ) { <nl> + final SuppressionCommentFilter suppressionCommentFilter = new SuppressionCommentFilter ( ) ; <nl> + final AuditEvent dummyEvent = new AuditEvent ( new Object ( ) , " filename " , <nl> + new LocalizedMessage ( 1 , null , null , null , null , Object . class , null ) ) ; <nl> + <nl> + final FileContentsHolder fileContentsHolder = new FileContentsHolder ( ) ; <nl> + final FileContents contents = <nl> + new FileContents ( " filename " , " / / CHECKSTYLE : OFF : ConstantNameCheck " , " line2 " ) ; <nl> + contents . reportSingleLineComment ( 1 , 0 ) ; <nl> + fileContentsHolder . setFileContents ( contents ) ; <nl> + fileContentsHolder . beginTree ( null ) ; <nl> + final boolean result = suppressionCommentFilter . accept ( dummyEvent ) ; <nl> + assertFalse ( result ) ; <nl> + } <nl> + <nl> + @ Test <nl> + public void testTagsAreClearedEachRun ( ) { <nl> + final SuppressionCommentFilter suppressionCommentFilter = new SuppressionCommentFilter ( ) ; <nl> + final AuditEvent dummyEvent = new AuditEvent ( new Object ( ) , " filename " , <nl> + new LocalizedMessage ( 1 , null , null , null , null , Object . class , null ) ) ; <nl> + <nl> + final FileContentsHolder fileContentsHolder = new FileContentsHolder ( ) ; <nl> + final FileContents contents = <nl> + new FileContents ( " filename " , " / / CHECKSTYLE : OFF " , " line2 " ) ; <nl> + contents . reportSingleLineComment ( 1 , 0 ) ; <nl> + fileContentsHolder . setFileContents ( contents ) ; <nl> + fileContentsHolder . beginTree ( null ) ; <nl> + suppressionCommentFilter . accept ( dummyEvent ) ; <nl> + final FileContents contents2 = <nl> + new FileContents ( " filename2 " , " some line " , " / / CHECKSTYLE : OFF " ) ; <nl> + contents2 . reportSingleLineComment ( 2 , 0 ) ; <nl> + fileContentsHolder . setFileContents ( contents2 ) ; <nl> + fileContentsHolder . beginTree ( null ) ; <nl> + suppressionCommentFilter . accept ( dummyEvent ) ; <nl> + final List < SuppressionCommentFilter . Tag > tags = <nl> + Whitebox . getInternalState ( suppressionCommentFilter , " tags " ) ; <nl> + assertEquals ( 1 , tags . size ( ) ) ; <nl> + } <nl> } <nl> diff - - git a / src / test / java / com / puppycrawl / tools / checkstyle / filters / SuppressionsLoaderTest . java b / src / test / java / com / puppycrawl / tools / checkstyle / filters / SuppressionsLoaderTest . java <nl> index 17fd097 . . 570e617 100644 <nl> - - - a / src / test / java / com / puppycrawl / tools / checkstyle / filters / SuppressionsLoaderTest . java <nl> + + + b / src / test / java / com / puppycrawl / tools / checkstyle / filters / SuppressionsLoaderTest . java <nl> @ @ - 34 , 6 + 34 , 7 @ @ import org . junit . rules . ExpectedException ; <nl> import org . junit . runner . RunWith ; <nl> import org . powermock . core . classloader . annotations . PrepareForTest ; <nl> import org . powermock . modules . junit4 . PowerMockRunner ; <nl> + import org . powermock . reflect . Whitebox ; <nl> import org . xml . sax . InputSource ; <nl> <nl> import com . puppycrawl . tools . checkstyle . AbstractPathTestSupport ; <nl> @ @ - 297 , 4 + 298 , 14 @ @ public class SuppressionsLoaderTest extends AbstractPathTestSupport { <nl> final FilterSet fc2 = new FilterSet ( ) ; <nl> assertEquals ( " Suppressions were not loaded " , fc2 , fc ) ; <nl> } <nl> + <nl> + @ Test <nl> + public void testSettingModuleId ( ) throws Exception { <nl> + final FilterSet fc = <nl> + SuppressionsLoader . loadSuppressions ( getPath ( " suppressions _ with _ id . xml " ) ) ; <nl> + final SuppressElement suppressElement = ( SuppressElement ) fc . getFilters ( ) . toArray ( ) [ 0 ] ; <nl> + <nl> + final String id = Whitebox . getInternalState ( suppressElement , " moduleId " ) ; <nl> + assertEquals ( " Id has to be defined " , " someId " , id ) ; <nl> + } <nl> } <nl> diff - - git a / src / test / resources / com / puppycrawl / tools / checkstyle / filters / InputSuppressByIdWithNearbyCommentFilter . java b / src / test / resources / com / puppycrawl / tools / checkstyle / filters / InputSuppressByIdWithNearbyCommentFilter . java <nl> index 5586a21 . . c057667 100644 <nl> - - - a / src / test / resources / com / puppycrawl / tools / checkstyle / filters / InputSuppressByIdWithNearbyCommentFilter . java <nl> + + + b / src / test / resources / com / puppycrawl / tools / checkstyle / filters / InputSuppressByIdWithNearbyCommentFilter . java <nl> @ @ - 9 , 4 + 9 , 6 @ @ public class InputSuppressByIdWithNearbyCommentFilter { <nl> int line _ length = 100 ; / / Suppression @ cs - : ignore ( reason ) <nl> <nl> private long ID = 1 ; / / Suppression @ cs - : <nl> + / * <nl> + Suppression @ cs - : ignore ( reason ) * / private long ID3 = 1 ; <nl> } <nl> diff - - git a / src / test / resources / com / puppycrawl / tools / checkstyle / filters / InputSuppressionCommentFilter . java b / src / test / resources / com / puppycrawl / tools / checkstyle / filters / InputSuppressionCommentFilter . java <nl> index d6d8a7c . . 94214fe 100644 <nl> - - - a / src / test / resources / com / puppycrawl / tools / checkstyle / filters / InputSuppressionCommentFilter . java <nl> + + + b / src / test / resources / com / puppycrawl / tools / checkstyle / filters / InputSuppressionCommentFilter . java <nl> @ @ - 22 , 9 + 22 , 9 @ @ class InputSuppressionCommentFilter <nl> private int L ; <nl> private static final int m = 0 ; <nl> / * <nl> - * CSON : MemberNameCheck <nl> + * CSON : MemberNameCheck | ConstantNameCheck <nl> * / <nl> - private int M2 ; <nl> + private int M2 ; / / CSOFF : ConstantNameCheck <nl> private static final int n = 0 ; <nl> / / CSON : ConstantNameCheck <nl> <nl> diff - - git a / src / test / resources / com / puppycrawl / tools / checkstyle / filters / suppressions _ with _ id . xml b / src / test / resources / com / puppycrawl / tools / checkstyle / filters / suppressions _ with _ id . xml <nl> new file mode 100644 <nl> index 0000000 . . ac08258 <nl> - - - / dev / null <nl> + + + b / src / test / resources / com / puppycrawl / tools / checkstyle / filters / suppressions _ with _ id . xml <nl> @ @ - 0 , 0 + 1 , 7 @ @ <nl> + < ? xml version = " 1 . 0 " encoding = " UTF - 8 " ? > <nl> + < ! DOCTYPE suppressions PUBLIC <nl> + " - / / Puppy Crawl / / DTD Suppressions 1 . 1 / / EN " <nl> + " http : / / checkstyle . sourceforge . net / dtds / suppressions _ 1 _ 1 . dtd " > <nl> + < suppressions > <nl> + < suppress files = " file0 " checks = " check0 " id = " someId " / > <nl> + < / suppressions >

TEST DIFF:
diff - - git a / . ci / jsoref - spellchecker / whitelist . words b / . ci / jsoref - spellchecker / whitelist . words 
 index a215a8e . . 76e49e4 100644 
 - - - a / . ci / jsoref - spellchecker / whitelist . words 
 + + + b / . ci / jsoref - spellchecker / whitelist . words 
 @ @ - 326 , 6 + 326 , 7 @ @ Dskip 
 dsm 
 Dsonar 
 Dspotbugs 
 + Dstrict 
 Dtest 
 Dubinin 
 Duser 
 diff - - git a / . ci / wercker . sh b / . ci / wercker . sh 
 index 22b71c8 . . 7c4adf1 100755 
 - - - a / . ci / wercker . sh 
 + + + b / . ci / wercker . sh 
 @ @ - 94 , 6 + 94 , 17 @ @ no - error - sevntu - checks ) 
 rm - rf sevntu . checkstyle 
 ; ; 
 
 + no - error - strata ) 
 + set - e 
 + CS _ POM _ VERSION = $ ( mvn - e - q - Dexec . executable = ' echo ' - Dexec . args = ' $ { project . version } ' - - non - recursive org . codehaus . mojo : exec - maven - plugin : 1 . 3 . 1 : exec ) 
 + echo CS _ version : $ { CS _ POM _ VERSION } 
 + for i in 1 2 3 4 5 ; do git clone https : / / github . com / OpenGamma / Strata & & break | | sleep 15 ; done 
 + cd Strata 
 + mvn install - e - B - Dstrict - DskipTests - Dforbiddenapis . skip = true - Dcheckstyle . version = $ { CS _ POM _ VERSION } 
 + cd . . / 
 + rm - rf Strata 
 + ; ; 
 + 
 no - exception - struts ) 
 CS _ POM _ VERSION = $ ( mvn - e - q - Dexec . executable = ' echo ' - Dexec . args = ' $ { project . version } ' - - non - recursive org . codehaus . mojo : exec - maven - plugin : 1 . 3 . 1 : exec ) 
 echo CS _ version : $ { CS _ POM _ VERSION }

NEAREST DIFF:
diff - - git a / config / suppressions . xml b / config / suppressions . xml 
 index 6c88945 . . 965bd06 100644 
 - - - a / config / suppressions . xml 
 + + + b / config / suppressions . xml 
 @ @ - 32 , 7 + 32 , 7 @ @ 
 < suppress checks = " Javadoc " files = " . * [ \ \ / ] src [ \ \ / ] ( test | it ) [ \ \ / ] " / > 
 < suppress checks = " MagicNumber " files = " . * [ \ \ / ] src [ \ \ / ] ( test | it ) [ \ \ / ] " / > 
 < suppress checks = " AvoidStaticImport " files = " . * [ \ \ / ] src [ \ \ / ] ( test | it ) [ \ \ / ] " / > 
 - < suppress checks = " ClassDataAbstractionCoupling " files = " [ \ \ / ] IndentationCheckTest . java $ " / > 
 + < suppress checks = " ClassDataAbstractionCoupling " files = " [ \ \ / ] IndentationCheckTest . java $ | [ \ \ / ] SuppressWithNearbyCommentFilterTest . java $ | [ \ \ / ] SuppressionCommentFilterTest . java $ " / > 
 < suppress checks = " EqualsAvoidNull " files = " [ \ \ / ] Int . * FilterTest . java $ " / > 
 < suppress checks = " VisibilityModifier " files = " [ \ \ / ] BaseCheckTestSupport . java $ | [ \ \ / ] AbstractModuleTestSupport . java $ " / > 
 < suppress checks = " WriteTag " files = " . * [ \ \ / ] src [ \ \ / ] ( test | it ) [ \ \ / ] " / > 
 diff - - git a / pom . xml b / pom . xml 
 index 6b35402 . . 2a99b38 100644 
 - - - a / pom . xml 
 + + + b / pom . xml 
 @ @ - 2232 , 18 + 2232 , 6 @ @ 
 < param > com . puppycrawl . tools . checkstyle . filefilters . * < / param > 
 < param > com . puppycrawl . tools . checkstyle . filters . * < / param > 
 < / targetTests > 
 - < excludedMethods > 
 - < ! - - till https : / / github . com / checkstyle / checkstyle / issues / 4396 - - > 
 - < param > compareTo < / param > 
 - < ! - - till https : / / github . com / checkstyle / checkstyle / issues / 4396 - - > 
 - < param > findNearestMatch < / param > 
 - < ! - - till https : / / github . com / checkstyle / checkstyle / issues / 4396 - - > 
 - < param > tagSuppressions < / param > 
 - < ! - - till https : / / github . com / checkstyle / checkstyle / issues / 4396 - - > 
 - < param > tagSuppressions < / param > 
 - < ! - - till https : / / github . com / checkstyle / checkstyle / issues / 4396 - - > 
 - < param > startElement < / param > 
 - < / excludedMethods > 
 < mutationThreshold > 100 < / mutationThreshold > 
 < timeoutFactor > $ { pitest . plugin . timeout . factor } < / timeoutFactor > 
 < timeoutConstant > $ { pitest . plugin . timeout . constant } < / timeoutConstant > 
 diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / filters / SuppressWithNearbyCommentFilter . java b / src / main / java / com / puppycrawl / tools / checkstyle / filters / SuppressWithNearbyCommentFilter . java 
 index a0d2556 . . fa1b1fd 100644 
 - - - a / src / main / java / com / puppycrawl / tools / checkstyle / filters / SuppressWithNearbyCommentFilter . java 
 + + + b / src / main / java / com / puppycrawl / tools / checkstyle / filters / SuppressWithNearbyCommentFilter . java 
 @ @ - 22 , 7 + 22 , 6 @ @ package com . puppycrawl . tools . checkstyle . filters ; 
 import java . lang . ref . WeakReference ; 
 import java . util . ArrayList ; 
 import java . util . Collection ; 
 - import java . util . Collections ; 
 import java . util . List ; 
 import java . util . Objects ; 
 import java . util . regex . Matcher ; 
 @ @ - 234 , 7 + 233 , 6 @ @ public class SuppressWithNearbyCommentFilter 
 contents . getBlockComments ( ) . values ( ) ; 
 cComments . forEach ( this : : tagSuppressions ) ; 
 } 
 - Collections . sort ( tags ) ; 
 } 
 
 / * * 
 @ @ - 279 , 7 + 277 , 7 @ @ public class SuppressWithNearbyCommentFilter 
 / * * 
 * A Tag holds a suppression comment and its location . 
 * / 
 - public static class Tag implements Comparable < Tag > { 
 + public static class Tag { 
 / * * The text of the tag . * / 
 private final String text ; 
 
 @ @ - 348 , 26 + 346 , 6 @ @ public class SuppressWithNearbyCommentFilter 
 } 
 } 
 
 - / * * 
 - * Compares the position of this tag in the file 
 - * with the position of another tag . 
 - * @ param other the tag to compare with this one . 
 - * @ return a negative number if this tag is before the other tag , 
 - * 0 if they are at the same position , and a positive number if this 
 - * tag is after the other tag . 
 - * / 
 - @ Override 
 - public int compareTo ( Tag other ) { 
 - final int result ; 
 - if ( firstLine = = other . firstLine ) { 
 - result = Integer . compare ( lastLine , other . lastLine ) ; 
 - } 
 - else { 
 - result = Integer . compare ( firstLine , other . firstLine ) ; 
 - } 
 - return result ; 
 - } 
 - 
 @ Override 
 public boolean equals ( Object other ) { 
 if ( this = = other ) { 
 diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / filters / SuppressionsLoader . java b / src / main / java / com / puppycrawl / tools / checkstyle / filters / SuppressionsLoader . java 
 index 8eced85 . . 3a2e05c 100644 
 - - - a / src / main / java / com / puppycrawl / tools / checkstyle / filters / SuppressionsLoader . java 
 + + + b / src / main / java / com / puppycrawl / tools / checkstyle / filters / SuppressionsLoader . java 
 @ @ - 93 , 9 + 93 , 7 @ @ public final class SuppressionsLoader 
 try { 
 final String files = attributes . getValue ( " files " ) ; 
 suppress = new SuppressElement ( files ) ; 
 - if ( modId ! = null ) { 
 - suppress . setModuleId ( modId ) ; 
 - } 
 + suppress . setModuleId ( modId ) ; 
 if ( checks ! = null ) { 
 suppress . setChecks ( checks ) ; 
 } 
 diff - - git a / src / test / java / com / puppycrawl / tools / checkstyle / filters / SuppressWithNearbyCommentFilterTest . java b / src / test / java / com / puppycrawl / tools / checkstyle / filters / SuppressWithNearbyCommentFilterTest . java 
 index 4e1851a . . fb78a4c 100644 
 - - - a / src / test / java / com / puppycrawl / tools / checkstyle / filters / SuppressWithNearbyCommentFilterTest . java 
 + + + b / src / test / java / com / puppycrawl / tools / checkstyle / filters / SuppressWithNearbyCommentFilterTest . java 
 @ @ - 20 , 16 + 20 , 18 @ @ 
 package com . puppycrawl . tools . checkstyle . filters ; 
 
 import static org . junit . Assert . assertEquals ; 
 + import static org . junit . Assert . assertTrue ; 
 
 import java . io . File ; 
 import java . io . IOException ; 
 import java . util . Arrays ; 
 import java . util . Collection ; 
 + import java . util . List ; 
 import java . util . Locale ; 
 import java . util . stream . Collectors ; 
 
 - import org . junit . Assert ; 
 import org . junit . Test ; 
 + import org . powermock . reflect . Whitebox ; 
 
 import com . puppycrawl . tools . checkstyle . BaseCheckTestSupport ; 
 import com . puppycrawl . tools . checkstyle . BriefUtLogger ; 
 @ @ - 39 , 6 + 41 , 8 @ @ import com . puppycrawl . tools . checkstyle . TreeWalker ; 
 import com . puppycrawl . tools . checkstyle . api . AuditEvent ; 
 import com . puppycrawl . tools . checkstyle . api . CheckstyleException ; 
 import com . puppycrawl . tools . checkstyle . api . Configuration ; 
 + import com . puppycrawl . tools . checkstyle . api . FileContents ; 
 + import com . puppycrawl . tools . checkstyle . api . LocalizedMessage ; 
 import com . puppycrawl . tools . checkstyle . checks . FileContentsHolder ; 
 import com . puppycrawl . tools . checkstyle . checks . coding . IllegalCatchCheck ; 
 import com . puppycrawl . tools . checkstyle . checks . naming . ConstantNameCheck ; 
 @ @ - 298 , 7 + 302 , 7 @ @ public class SuppressWithNearbyCommentFilterTest 
 public void testAcceptNullLocalizedMessage ( ) { 
 final SuppressWithNearbyCommentFilter filter = new SuppressWithNearbyCommentFilter ( ) ; 
 final AuditEvent auditEvent = new AuditEvent ( this ) ; 
 - Assert . assertTrue ( filter . accept ( auditEvent ) ) ; 
 + assertTrue ( filter . accept ( auditEvent ) ) ; 
 } 
 
 @ Test 
 @ @ - 343 , 4 + 347 , 29 @ @ public class SuppressWithNearbyCommentFilterTest 
 getPath ( " InputSuppressByIdWithNearbyCommentFilter . java " ) , 
 removeSuppressed ( expectedViolationMessages , suppressedViolationMessages ) ) ; 
 } 
 + 
 + @ Test 
 + public void testTagsAreClearedEachRun ( ) { 
 + final SuppressWithNearbyCommentFilter suppressionCommentFilter = 
 + new SuppressWithNearbyCommentFilter ( ) ; 
 + final AuditEvent dummyEvent = new AuditEvent ( new Object ( ) , " filename " , 
 + new LocalizedMessage ( 1 , null , null , null , null , Object . class , null ) ) ; 
 + 
 + final FileContentsHolder fileContentsHolder = new FileContentsHolder ( ) ; 
 + final FileContents contents = 
 + new FileContents ( " filename " , " / / SUPPRESS CHECKSTYLE ignore " , " line2 " ) ; 
 + contents . reportSingleLineComment ( 1 , 0 ) ; 
 + fileContentsHolder . setFileContents ( contents ) ; 
 + fileContentsHolder . beginTree ( null ) ; 
 + suppressionCommentFilter . accept ( dummyEvent ) ; 
 + final FileContents contents2 = 
 + new FileContents ( " filename2 " , " some line " , " / / SUPPRESS CHECKSTYLE ignore " ) ; 
 + contents2 . reportSingleLineComment ( 2 , 0 ) ; 
 + fileContentsHolder . setFileContents ( contents2 ) ; 
 + fileContentsHolder . beginTree ( null ) ; 
 + suppressionCommentFilter . accept ( dummyEvent ) ; 
 + final List < SuppressionCommentFilter . Tag > tags = 
 + Whitebox . getInternalState ( suppressionCommentFilter , " tags " ) ; 
 + assertEquals ( 1 , tags . size ( ) ) ; 
 + } 
 } 
 diff - - git a / src / test / java / com / puppycrawl / tools / checkstyle / filters / SuppressionCommentFilterTest . java b / src / test / java / com / puppycrawl / tools / checkstyle / filters / SuppressionCommentFilterTest . java 
 index 72b0f37 . . 3d37f23 100644 
 - - - a / src / test / java / com / puppycrawl / tools / checkstyle / filters / SuppressionCommentFilterTest . java 
 + + + b / src / test / java / com / puppycrawl / tools / checkstyle / filters / SuppressionCommentFilterTest . java 
 @ @ - 20 , 16 + 20 , 19 @ @ 
 package com . puppycrawl . tools . checkstyle . filters ; 
 
 import static org . junit . Assert . assertEquals ; 
 + import static org . junit . Assert . assertFalse ; 
 
 import java . io . File ; 
 import java . io . IOException ; 
 import java . util . Arrays ; 
 import java . util . Collection ; 
 + import java . util . List ; 
 import java . util . Locale ; 
 import java . util . stream . Collectors ; 
 
 import org . junit . Assert ; 
 import org . junit . Test ; 
 + import org . powermock . reflect . Whitebox ; 
 
 import com . puppycrawl . tools . checkstyle . BaseCheckTestSupport ; 
 import com . puppycrawl . tools . checkstyle . BriefUtLogger ; 
 @ @ - 39 , 6 + 42 , 8 @ @ import com . puppycrawl . tools . checkstyle . TreeWalker ; 
 import com . puppycrawl . tools . checkstyle . api . AuditEvent ; 
 import com . puppycrawl . tools . checkstyle . api . CheckstyleException ; 
 import com . puppycrawl . tools . checkstyle . api . Configuration ; 
 + import com . puppycrawl . tools . checkstyle . api . FileContents ; 
 + import com . puppycrawl . tools . checkstyle . api . LocalizedMessage ; 
 import com . puppycrawl . tools . checkstyle . checks . FileContentsHolder ; 
 import com . puppycrawl . tools . checkstyle . checks . coding . IllegalCatchCheck ; 
 import com . puppycrawl . tools . checkstyle . checks . naming . ConstantNameCheck ; 
 @ @ - 320 , 4 + 325 , 44 @ @ public class SuppressionCommentFilterTest 
 getPath ( " InputSuppressByIdWithCommentFilter . java " ) , 
 removeSuppressed ( expectedViolationMessages , suppressedViolationMessages ) ) ; 
 } 
 + 
 + @ Test 
 + public void testFindNearestMatchDontAllowSameColumn ( ) { 
 + final SuppressionCommentFilter suppressionCommentFilter = new SuppressionCommentFilter ( ) ; 
 + final AuditEvent dummyEvent = new AuditEvent ( new Object ( ) , " filename " , 
 + new LocalizedMessage ( 1 , null , null , null , null , Object . class , null ) ) ; 
 + 
 + final FileContentsHolder fileContentsHolder = new FileContentsHolder ( ) ; 
 + final FileContents contents = 
 + new FileContents ( " filename " , " / / CHECKSTYLE : OFF : ConstantNameCheck " , " line2 " ) ; 
 + contents . reportSingleLineComment ( 1 , 0 ) ; 
 + fileContentsHolder . setFileContents ( contents ) ; 
 + fileContentsHolder . beginTree ( null ) ; 
 + final boolean result = suppressionCommentFilter . accept ( dummyEvent ) ; 
 + assertFalse ( result ) ; 
 + } 
 + 
 + @ Test 
 + public void testTagsAreClearedEachRun ( ) { 
 + final SuppressionCommentFilter suppressionCommentFilter = new SuppressionCommentFilter ( ) ; 
 + final AuditEvent dummyEvent = new AuditEvent ( new Object ( ) , " filename " , 
 + new LocalizedMessage ( 1 , null , null , null , null , Object . class , null ) ) ; 
 + 
 + final FileContentsHolder fileContentsHolder = new FileContentsHolder ( ) ; 
 + final FileContents contents = 
 + new FileContents ( " filename " , " / / CHECKSTYLE : OFF " , " line2 " ) ; 
 + contents . reportSingleLineComment ( 1 , 0 ) ; 
 + fileContentsHolder . setFileContents ( contents ) ; 
 + fileContentsHolder . beginTree ( null ) ; 
 + suppressionCommentFilter . accept ( dummyEvent ) ; 
 + final FileContents contents2 = 
 + new FileContents ( " filename2 " , " some line " , " / / CHECKSTYLE : OFF " ) ; 
 + contents2 . reportSingleLineComment ( 2 , 0 ) ; 
 + fileContentsHolder . setFileContents ( contents2 ) ; 
 + fileContentsHolder . beginTree ( null ) ; 
 + suppressionCommentFilter . accept ( dummyEvent ) ; 
 + final List < SuppressionCommentFilter . Tag > tags = 
 + Whitebox . getInternalState ( suppressionCommentFilter , " tags " ) ; 
 + assertEquals ( 1 , tags . size ( ) ) ; 
 + } 
 } 
 diff - - git a / src / test / java / com / puppycrawl / tools / checkstyle / filters / SuppressionsLoaderTest . java b / src / test / java / com / puppycrawl / tools / checkstyle / filters / SuppressionsLoaderTest . java 
 index 17fd097 . . 570e617 100644 
 - - - a / src / test / java / com / puppycrawl / tools / checkstyle / filters / SuppressionsLoaderTest . java 
 + + + b / src / test / java / com / puppycrawl / tools / checkstyle / filters / SuppressionsLoaderTest . java 
 @ @ - 34 , 6 + 34 , 7 @ @ import org . junit . rules . ExpectedException ; 
 import org . junit . runner . RunWith ; 
 import org . powermock . core . classloader . annotations . PrepareForTest ; 
 import org . powermock . modules . junit4 . PowerMockRunner ; 
 + import org . powermock . reflect . Whitebox ; 
 import org . xml . sax . InputSource ; 
 
 import com . puppycrawl . tools . checkstyle . AbstractPathTestSupport ; 
 @ @ - 297 , 4 + 298 , 14 @ @ public class SuppressionsLoaderTest extends AbstractPathTestSupport { 
 final FilterSet fc2 = new FilterSet ( ) ; 
 assertEquals ( " Suppressions were not loaded " , fc2 , fc ) ; 
 } 
 + 
 + @ Test 
 + public void testSettingModuleId ( ) throws Exception { 
 + final FilterSet fc = 
 + SuppressionsLoader . loadSuppressions ( getPath ( " suppressions _ with _ id . xml " ) ) ; 
 + final SuppressElement suppressElement = ( SuppressElement ) fc . getFilters ( ) . toArray ( ) [ 0 ] ; 
 + 
 + final String id = Whitebox . getInternalState ( suppressElement , " moduleId " ) ; 
 + assertEquals ( " Id has to be defined " , " someId " , id ) ; 
 + } 
 } 
 diff - - git a / src / test / resources / com / puppycrawl / tools / checkstyle / filters / InputSuppressByIdWithNearbyCommentFilter . java b / src / test / resources / com / puppycrawl / tools / checkstyle / filters / InputSuppressByIdWithNearbyCommentFilter . java 
 index 5586a21 . . c057667 100644 
 - - - a / src / test / resources / com / puppycrawl / tools / checkstyle / filters / InputSuppressByIdWithNearbyCommentFilter . java 
 + + + b / src / test / resources / com / puppycrawl / tools / checkstyle / filters / InputSuppressByIdWithNearbyCommentFilter . java 
 @ @ - 9 , 4 + 9 , 6 @ @ public class InputSuppressByIdWithNearbyCommentFilter { 
 int line _ length = 100 ; / / Suppression @ cs - : ignore ( reason ) 
 
 private long ID = 1 ; / / Suppression @ cs - : 
 + / * 
 + Suppression @ cs - : ignore ( reason ) * / private long ID3 = 1 ; 
 } 
 diff - - git a / src / test / resources / com / puppycrawl / tools / checkstyle / filters / InputSuppressionCommentFilter . java b / src / test / resources / com / puppycrawl / tools / checkstyle / filters / InputSuppressionCommentFilter . java 
 index d6d8a7c . . 94214fe 100644 
 - - - a / src / test / resources / com / puppycrawl / tools / checkstyle / filters / InputSuppressionCommentFilter . java 
 + + + b / src / test / resources / com / puppycrawl / tools / checkstyle / filters / InputSuppressionCommentFilter . java 
 @ @ - 22 , 9 + 22 , 9 @ @ class InputSuppressionCommentFilter 
 private int L ; 
 private static final int m = 0 ; 
 / * 
 - * CSON : MemberNameCheck 
 + * CSON : MemberNameCheck | ConstantNameCheck 
 * / 
 - private int M2 ; 
 + private int M2 ; / / CSOFF : ConstantNameCheck 
 private static final int n = 0 ; 
 / / CSON : ConstantNameCheck 
 
 diff - - git a / src / test / resources / com / puppycrawl / tools / checkstyle / filters / suppressions _ with _ id . xml b / src / test / resources / com / puppycrawl / tools / checkstyle / filters / suppressions _ with _ id . xml 
 new file mode 100644 
 index 0000000 . . ac08258 
 - - - / dev / null 
 + + + b / src / test / resources / com / puppycrawl / tools / checkstyle / filters / suppressions _ with _ id . xml 
 @ @ - 0 , 0 + 1 , 7 @ @ 
 + < ? xml version = " 1 . 0 " encoding = " UTF - 8 " ? > 
 + < ! DOCTYPE suppressions PUBLIC 
 + " - / / Puppy Crawl / / DTD Suppressions 1 . 1 / / EN " 
 + " http : / / checkstyle . sourceforge . net / dtds / suppressions _ 1 _ 1 . dtd " > 
 + < suppressions > 
 + < suppress files = " file0 " checks = " check0 " id = " someId " / > 
 + < / suppressions >
