BLEU SCORE: 0.03089055318156698

TEST MSG: Issue # 2969 : Add the ability to validate language codes by TranslationCheck
GENERATED MSG: Patch from Oleg Sukhodolsky to add MissingSwitchDefaultCheck to check that a

TEST DIFF (one line): diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / checks / TranslationCheck . java b / src / main / java / com / puppycrawl / tools / checkstyle / checks / TranslationCheck . java <nl> index e87d341 . . 8965e6a 100644 <nl> - - - a / src / main / java / com / puppycrawl / tools / checkstyle / checks / TranslationCheck . java <nl> + + + b / src / main / java / com / puppycrawl / tools / checkstyle / checks / TranslationCheck . java <nl> @ @ - 91 , 7 + 91 , 9 @ @ import com . puppycrawl . tools . checkstyle . utils . CommonUtils ; <nl> * Default value is < b > empty String Set < / b > which means that only the existence of <nl> * default translation is checked . Note , if you specify language codes ( or just one language <nl> * code ) of required translations the check will also check for existence of default translation <nl> - * files in project . <nl> + * files in project . ATTENTION : the check will perform the validation of ISO codes if the option <nl> + * is used . So , if you specify , for example , " mm " for language code , TranslationCheck will rise <nl> + * violation that the language code is incorrect . <nl> * < br > <nl> * <nl> * @ author Alexandra Bunge <nl> @ @ - 113 , 6 + 115 , 16 @ @ public class TranslationCheck extends AbstractFileSetCheck { <nl> public static final String MSG _ KEY _ MISSING _ TRANSLATION _ FILE = <nl> " translation . missingTranslationFile " ; <nl> <nl> + / * * Resource bundle which contains messages for TranslationCheck . * / <nl> + private static final String TRANSLATION _ BUNDLE = <nl> + " com . puppycrawl . tools . checkstyle . checks . messages " ; <nl> + <nl> + / * * <nl> + * A key is pointing to the warning message text for wrong language code <nl> + * in " messages . properties " file . <nl> + * / <nl> + private static final String WRONG _ LANGUAGE _ CODE _ KEY = " translation . wrongLanguageCode " ; <nl> + <nl> / * * Logger for TranslationCheck . * / <nl> private static final Log LOG = LogFactory . getLog ( TranslationCheck . class ) ; <nl> <nl> @ @ - 186 , 6 + 198 , 7 @ @ public class TranslationCheck extends AbstractFileSetCheck { <nl> public void setRequiredTranslations ( String translationCodes ) { <nl> requiredTranslations = Sets . newTreeSet ( Splitter . on ( ' , ' ) <nl> . trimResults ( ) . omitEmptyStrings ( ) . split ( translationCodes ) ) ; <nl> + validateUserSpecifiedLanguageCodes ( requiredTranslations ) ; <nl> } <nl> <nl> @ Override <nl> @ @ - 213 , 6 + 226 , 39 @ @ public class TranslationCheck extends AbstractFileSetCheck { <nl> } <nl> <nl> / * * <nl> + * Validates the correctness of user specififed language codes for the check . <nl> + * @ param languageCodes user specified language codes for the check . <nl> + * / <nl> + private void validateUserSpecifiedLanguageCodes ( SortedSet < String > languageCodes ) { <nl> + for ( String code : languageCodes ) { <nl> + if ( ! isValidLanguageCode ( code ) ) { <nl> + final LocalizedMessage msg = new LocalizedMessage ( 0 , TRANSLATION _ BUNDLE , <nl> + WRONG _ LANGUAGE _ CODE _ KEY , new Object [ ] { code } , getId ( ) , getClass ( ) , null ) ; <nl> + final String exceptionMessage = String . format ( Locale . ROOT , <nl> + " % s [ % s ] " , msg . getMessage ( ) , TranslationCheck . class . getSimpleName ( ) ) ; <nl> + throw new IllegalArgumentException ( exceptionMessage ) ; <nl> + } <nl> + } <nl> + } <nl> + <nl> + / * * <nl> + * Checks whether user specified language code is correct ( is contained in available locales ) . <nl> + * @ param userSpecifiedLanguageCode user specified language code . <nl> + * @ return true if user specified language code is correct . <nl> + * / <nl> + private static boolean isValidLanguageCode ( final String userSpecifiedLanguageCode ) { <nl> + boolean valid = false ; <nl> + final Locale [ ] locales = Locale . getAvailableLocales ( ) ; <nl> + for ( Locale locale : locales ) { <nl> + if ( userSpecifiedLanguageCode . equals ( locale . toString ( ) ) ) { <nl> + valid = true ; <nl> + break ; <nl> + } <nl> + } <nl> + return valid ; <nl> + } <nl> + <nl> + / * * <nl> * Groups a set of files into bundles . <nl> * Only files , which names match base name regexp pattern will be grouped . <nl> * @ param files set of files . <nl> diff - - git a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages . properties b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages . properties <nl> index d80905b . . 99699cc 100644 <nl> - - - a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages . properties <nl> + + + b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages . properties <nl> @ @ - 6 , 6 + 6 , 7 @ @ todo . match = Comment matches to - do format ' ' { 0 } ' ' . <nl> upperEll = Should use uppercase ' ' L ' ' . <nl> <nl> translation . missingKey = Key ' ' { 0 } ' ' missing . <nl> + translation . wrongLanguageCode = Specified language code ' ' { 0 } ' ' is incorrect . <nl> translation . missingTranslationFile = Properties file ' ' { 0 } ' ' is missing . <nl> <nl> missing . switch . default = switch without \ " default \ " clause . <nl> diff - - git a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ de . properties b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ de . properties <nl> index c2889d4 . . 0339eb3 100644 <nl> - - - a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ de . properties <nl> + + + b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ de . properties <nl> @ @ - 6 , 6 + 6 , 7 @ @ todo . match = Kommentar entspricht to - do - Format ' ' { 0 } ' ' . <nl> upperEll = Zur besseren Lesbarkeit sollte ein gro ß es ' ' L ' ' verwendet werden . <nl> <nl> translation . missingKey = Ü bersetzung f ü r Schl ü ssel ' ' { 0 } ' ' fehlt . <nl> + translation . wrongLanguageCode = Spezifizierte Sprachcode ' ' { 0 } ' ' ist nicht korrekt . <nl> translation . missingTranslationFile = Properties - Datei ' ' { 0 } ' ' fehlt . <nl> <nl> missing . switch . default = switch ohne \ " default \ " . <nl> diff - - git a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ es . properties b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ es . properties <nl> index 3d03de3 . . bd9e9ef 100644 <nl> - - - a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ es . properties <nl> + + + b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ es . properties <nl> @ @ - 9 , 6 + 9 , 7 @ @ translation . missingKey = La clave ' ' { 0 } ' ' falta . <nl> <nl> missing . switch . default = switch sin etiqueta \ " default \ " . <nl> translation . missingTranslationFile = Archivo de propiedades ' ' { 0 } ' ' no se encuentra . <nl> + translation . wrongLanguageCode = C ó digo de idioma especificado ' ' { 0 } ' ' no es correcta . <nl> <nl> uncommented . main = Se encotr ó un m é todo main sin comentar . <nl> <nl> diff - - git a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ fi . properties b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ fi . properties <nl> index ed61272 . . 6d7733b 100644 <nl> - - - a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ fi . properties <nl> + + + b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ fi . properties <nl> @ @ - 7 , 6 + 7 , 7 @ @ upperEll = Pit ä ä olla iso ' ' L ' ' . <nl> <nl> translation . missingKey = K ä ä nn ö savain ' ' { 0 } ' ' puuttuu . <nl> translation . missingTranslationFile = Ominaisuudet tiedosto ' ' { 0 } ' ' puuttuu . <nl> + translation . wrongLanguageCode = M ä ä ritetty kielikoodi ' ' { 0 } ' ' on virheellinen . <nl> <nl> missing . switch . default = vaihtaa ilman \ " default \ " lauseke . <nl> <nl> diff - - git a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ fr . properties b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ fr . properties <nl> index f2d47b9 . . ecab6e5 100644 <nl> - - - a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ fr . properties <nl> + + + b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ fr . properties <nl> @ @ - 7 , 6 + 7 , 7 @ @ upperEll = Utilisez un ' ' L ' ' majuscule pour une meilleure lisibilit é . <nl> <nl> translation . missingKey = La traduction du message ' ' { 0 } ' ' est manquante . <nl> translation . missingTranslationFile = Fichier de propri é t é s ' ' { 0 } ' ' est manquant . <nl> + translation . wrongLanguageCode = Sp é cifi é code de langue ' ' { 0 } ' ' est incorrect . <nl> <nl> missing . switch . default = Il manque le cas \ " default \ " dans le bloc \ " switch \ " . <nl> <nl> diff - - git a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ ja . properties b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ ja . properties <nl> index 2aa315a . . 71bd0a5 100644 <nl> - - - a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ ja . properties <nl> + + + b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ ja . properties <nl> @ @ - 7 , 6 + 7 , 7 @ @ upperEll = 大 文 字 の ' ' L ' ' を 使 用 す べ き で す 。 <nl> <nl> translation . missingKey = キ ー ' ' { 0 } ' ' が あ り ま せ ん 。 <nl> translation . missingTranslationFile = プ ロ パ テ ィ フ ァ イ ル ' ' { 0 } ' ' が あ り ま せ ん 。 <nl> + translation . wrongLanguageCode = 指 定 し た 言 語 コ ー ド は ' ' { 0 } ' ' が 正 し く あ り ま せ ん 。 <nl> <nl> missing . switch . default = " default " 節 の 無 い switch 文 で す 。 <nl> <nl> diff - - git a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ pt . properties b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ pt . properties <nl> index e13d681 . . 783a7cd 100644 <nl> - - - a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ pt . properties <nl> + + + b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ pt . properties <nl> @ @ - 7 , 6 + 7 , 7 @ @ todo . match = O coment á rio condiz com o padr ã o de tarefa pendente ' ' { 0 } ' ' . <nl> <nl> translation . missingKey = Falta a chave ' ' { 0 } ' ' . <nl> translation . missingTranslationFile = Arquivo de propriedades ' ' { 0 } ' ' est á faltando . <nl> + translation . wrongLanguageCode = C ó digo de idioma especificado ' ' { 0 } ' ' est á incorreto . <nl> <nl> uncommented . main = M é todo main n ã o comentado encontrado . <nl> <nl> diff - - git a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ tr . properties b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ tr . properties <nl> index f61769d . . f8422cf 100644 <nl> - - - a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ tr . properties <nl> + + + b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ tr . properties <nl> @ @ - 7 , 6 + 7 , 7 @ @ upperEll = B ü y ü k harf ' ' L ' ' kullan ı lmal ı . <nl> <nl> translation . missingKey = ' ' { 0 } ' ' anahtar ı eksik . <nl> translation . missingTranslationFile = Ö zellikler dosyas ı ' ' { 0 } ' ' eksik . <nl> + translation . wrongLanguageCode = Belirtilen dil kodu ' ' { 0 } ' ' ' yanl ı ş t ı r . <nl> <nl> missing . switch . default = ' ' default ' ' durumu olmayan bir ' ' switch ' ' mevcut . <nl> <nl> diff - - git a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ zh . properties b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ zh . properties <nl> index 1b97530 . . 793f084 100644 <nl> - - - a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ zh . properties <nl> + + + b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ zh . properties <nl> @ @ - 7 , 6 + 7 , 7 @ @ upperEll = 请 使 用 大 写 ' ' L ' ' 。 <nl> <nl> translation . missingKey = 找 不 到 Key ： ' ' { 0 } ' ' 。 <nl> translation . missingTranslationFile = 找 不 到 配 置 文 件 ： ' ' { 0 } ' ' 。 <nl> + translation . wrongLanguageCode = 指 定 的 語 言 代 碼 ' ' { 0 } ' ' 是 不 正 確 。 <nl> <nl> missing . switch . default = switch 没 有 \ " default \ " 从 句 。 <nl> <nl> diff - - git a / src / test / java / com / puppycrawl / tools / checkstyle / checks / TranslationCheckTest . java b / src / test / java / com / puppycrawl / tools / checkstyle / checks / TranslationCheckTest . java <nl> index 8dc1bd0 . . dc6bc65 100644 <nl> - - - a / src / test / java / com / puppycrawl / tools / checkstyle / checks / TranslationCheckTest . java <nl> + + + b / src / test / java / com / puppycrawl / tools / checkstyle / checks / TranslationCheckTest . java <nl> @ @ - 20 , 6 + 20 , 10 @ @ <nl> package com . puppycrawl . tools . checkstyle . checks ; <nl> <nl> import static com . puppycrawl . tools . checkstyle . checks . TranslationCheck . MSG _ KEY ; <nl> + import static org . hamcrest . CoreMatchers . containsString ; <nl> + import static org . hamcrest . CoreMatchers . endsWith ; <nl> + import static org . junit . Assert . assertThat ; <nl> + import static org . junit . Assert . fail ; <nl> <nl> import java . io . File ; <nl> import java . io . IOException ; <nl> @ @ - 388 , 4 + 392 , 18 @ @ public class TranslationCheckTest extends BaseCheckTestSupport { <nl> getPath ( " " ) , <nl> expected ) ; <nl> } <nl> + <nl> + @ Test <nl> + public void testWrongUserSpecifiedLanguageCodes ( ) throws Exception { <nl> + final TranslationCheck check = new TranslationCheck ( ) ; <nl> + try { <nl> + check . setRequiredTranslations ( " 11 " ) ; <nl> + fail ( " IllegalArgumentException is expected . Specified language code is incorrect . " ) ; <nl> + } <nl> + catch ( IllegalArgumentException ex ) { <nl> + final String exceptionMessage = ex . getMessage ( ) ; <nl> + assertThat ( exceptionMessage , containsString ( " 11 " ) ) ; <nl> + assertThat ( exceptionMessage , endsWith ( " [ TranslationCheck ] " ) ) ; <nl> + } <nl> + } <nl> } <nl> diff - - git a / src / xdocs / config _ misc . xml b / src / xdocs / config _ misc . xml <nl> index a15dbb5 . . 0b9acf0 100755 <nl> - - - a / src / xdocs / config _ misc . xml <nl> + + + b / src / xdocs / config _ misc . xml <nl> @ @ - 1629 , 10 + 1629 , 9 @ @ messages . properties : Key ' ok ' missing . <nl> of default translation is checked . Note , if you specify language codes ( or just <nl> one language code ) of required translations the check will also check for <nl> existence of default translation files in project . <nl> - ATTENTION : the check will not perform the validation of ISO codes if the option <nl> - is set to true . So , if you specify , for example , " mm " for language code , <nl> - TranslationCheck will not warn about the incorrect language code and will use it <nl> - for validation . <nl> + ATTENTION : the check will perform the validation of ISO codes if the option <nl> + is used . So , if you specify , for example , " mm " for language code , TranslationCheck <nl> + will rise violation that the language code is incorrect . <nl> < / td > <nl> < td > < a href = " property _ types . html # stringSet " > String Set < / a > < / td > <nl> < td > < code > empty String Set < / code > < / td >
NEAREST DIFF (one line): diff - - git a / docs / releasenotes . html b / docs / releasenotes . html <nl> index 6bf8888 . . 0cccd80 100644 <nl> - - - a / docs / releasenotes . html <nl> + + + b / docs / releasenotes . html <nl> @ @ - 101 , 8 + 101 , 13 @ @ <nl> < p class = " body " > <nl> Resolved bugs : <nl> < / p > <nl> - < ul > <nl> - < li class = " body " > False alarms from RightCurly module for code that does not have braces in if - then - else ( bug 689836 ) . < / li > <nl> + 	 < ul > <nl> + 	 <nl> + 	 < li class = " body " > False alarms from RightCurly module for code that <nl> + does not have braces in if - then - else ( bug 689836 ) . < / li > <nl> + <nl> + 	 < li class = " body " > Grammar incorrectly defaulting unqualified floating point literals to be float , when they should be double ( bug 713716 ) . < / li > <nl> + <nl> < li class = " body " > & quot ; threadsafe & quot ; was treated as a Java keyword , resulting in parser errors for <nl> sources that use it as an identifier ( bug 710319 ) . < / li > <nl> < li class = " body " > ConfigurationLoader was not public ( only relevant for IDE plugin authors ) . < / li > <nl> diff - - git a / src / checkstyle / com / puppycrawl / tools / checkstyle / java . g b / src / checkstyle / com / puppycrawl / tools / checkstyle / java . g <nl> index 9c7d73c . . 56e165d 100644 <nl> - - - a / src / checkstyle / com / puppycrawl / tools / checkstyle / java . g <nl> + + + b / src / checkstyle / com / puppycrawl / tools / checkstyle / java . g <nl> @ @ - 1154 , 11 + 1154 , 11 @ @ NUM _ INT <nl> : ' . ' { _ ttype = DOT ; } <nl> ( 	 ( ' 0 ' . . ' 9 ' ) + ( EXPONENT ) ? ( f1 : FLOAT _ SUFFIX { t = f1 ; } ) ? <nl> { <nl> - 	 	 	 	 if ( t ! = null & & t . getText ( ) . toUpperCase ( ) . indexOf ( ' D ' ) > = 0 ) { <nl> - 	 _ ttype = NUM _ DOUBLE ; <nl> + 	 	 	 	 if ( t ! = null & & t . getText ( ) . toUpperCase ( ) . indexOf ( ' F ' ) > = 0 ) { <nl> + 	 _ ttype = NUM _ FLOAT ; <nl> 	 	 	 	 } <nl> 	 	 	 	 else { <nl> - 	 _ ttype = NUM _ FLOAT ; <nl> + 	 _ ttype = NUM _ DOUBLE ; / / assume double <nl> 	 	 	 	 } <nl> 	 	 	 	 } <nl> ) ? <nl> @ @ - 1189 , 11 + 1189 , 11 @ @ NUM _ INT <nl> | f4 : FLOAT _ SUFFIX { t = f4 ; } <nl> ) <nl> { <nl> - 	 	 	 if ( t ! = null & & t . getText ( ) . toUpperCase ( ) . indexOf ( ' D ' ) > = 0 ) { <nl> - _ ttype = NUM _ DOUBLE ; <nl> + 	 	 	 if ( t ! = null & & t . getText ( ) . toUpperCase ( ) . indexOf ( ' F ' ) > = 0 ) { <nl> + _ ttype = NUM _ FLOAT ; <nl> 	 	 	 } <nl> else { <nl> - _ ttype = NUM _ FLOAT ; <nl> + 	 	 _ ttype = NUM _ DOUBLE ; / / assume double <nl> 	 	 	 } <nl> 	 	 	 } <nl> ) ?

TEST DIFF:
diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / checks / TranslationCheck . java b / src / main / java / com / puppycrawl / tools / checkstyle / checks / TranslationCheck . java 
 index e87d341 . . 8965e6a 100644 
 - - - a / src / main / java / com / puppycrawl / tools / checkstyle / checks / TranslationCheck . java 
 + + + b / src / main / java / com / puppycrawl / tools / checkstyle / checks / TranslationCheck . java 
 @ @ - 91 , 7 + 91 , 9 @ @ import com . puppycrawl . tools . checkstyle . utils . CommonUtils ; 
 * Default value is < b > empty String Set < / b > which means that only the existence of 
 * default translation is checked . Note , if you specify language codes ( or just one language 
 * code ) of required translations the check will also check for existence of default translation 
 - * files in project . 
 + * files in project . ATTENTION : the check will perform the validation of ISO codes if the option 
 + * is used . So , if you specify , for example , " mm " for language code , TranslationCheck will rise 
 + * violation that the language code is incorrect . 
 * < br > 
 * 
 * @ author Alexandra Bunge 
 @ @ - 113 , 6 + 115 , 16 @ @ public class TranslationCheck extends AbstractFileSetCheck { 
 public static final String MSG _ KEY _ MISSING _ TRANSLATION _ FILE = 
 " translation . missingTranslationFile " ; 
 
 + / * * Resource bundle which contains messages for TranslationCheck . * / 
 + private static final String TRANSLATION _ BUNDLE = 
 + " com . puppycrawl . tools . checkstyle . checks . messages " ; 
 + 
 + / * * 
 + * A key is pointing to the warning message text for wrong language code 
 + * in " messages . properties " file . 
 + * / 
 + private static final String WRONG _ LANGUAGE _ CODE _ KEY = " translation . wrongLanguageCode " ; 
 + 
 / * * Logger for TranslationCheck . * / 
 private static final Log LOG = LogFactory . getLog ( TranslationCheck . class ) ; 
 
 @ @ - 186 , 6 + 198 , 7 @ @ public class TranslationCheck extends AbstractFileSetCheck { 
 public void setRequiredTranslations ( String translationCodes ) { 
 requiredTranslations = Sets . newTreeSet ( Splitter . on ( ' , ' ) 
 . trimResults ( ) . omitEmptyStrings ( ) . split ( translationCodes ) ) ; 
 + validateUserSpecifiedLanguageCodes ( requiredTranslations ) ; 
 } 
 
 @ Override 
 @ @ - 213 , 6 + 226 , 39 @ @ public class TranslationCheck extends AbstractFileSetCheck { 
 } 
 
 / * * 
 + * Validates the correctness of user specififed language codes for the check . 
 + * @ param languageCodes user specified language codes for the check . 
 + * / 
 + private void validateUserSpecifiedLanguageCodes ( SortedSet < String > languageCodes ) { 
 + for ( String code : languageCodes ) { 
 + if ( ! isValidLanguageCode ( code ) ) { 
 + final LocalizedMessage msg = new LocalizedMessage ( 0 , TRANSLATION _ BUNDLE , 
 + WRONG _ LANGUAGE _ CODE _ KEY , new Object [ ] { code } , getId ( ) , getClass ( ) , null ) ; 
 + final String exceptionMessage = String . format ( Locale . ROOT , 
 + " % s [ % s ] " , msg . getMessage ( ) , TranslationCheck . class . getSimpleName ( ) ) ; 
 + throw new IllegalArgumentException ( exceptionMessage ) ; 
 + } 
 + } 
 + } 
 + 
 + / * * 
 + * Checks whether user specified language code is correct ( is contained in available locales ) . 
 + * @ param userSpecifiedLanguageCode user specified language code . 
 + * @ return true if user specified language code is correct . 
 + * / 
 + private static boolean isValidLanguageCode ( final String userSpecifiedLanguageCode ) { 
 + boolean valid = false ; 
 + final Locale [ ] locales = Locale . getAvailableLocales ( ) ; 
 + for ( Locale locale : locales ) { 
 + if ( userSpecifiedLanguageCode . equals ( locale . toString ( ) ) ) { 
 + valid = true ; 
 + break ; 
 + } 
 + } 
 + return valid ; 
 + } 
 + 
 + / * * 
 * Groups a set of files into bundles . 
 * Only files , which names match base name regexp pattern will be grouped . 
 * @ param files set of files . 
 diff - - git a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages . properties b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages . properties 
 index d80905b . . 99699cc 100644 
 - - - a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages . properties 
 + + + b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages . properties 
 @ @ - 6 , 6 + 6 , 7 @ @ todo . match = Comment matches to - do format ' ' { 0 } ' ' . 
 upperEll = Should use uppercase ' ' L ' ' . 
 
 translation . missingKey = Key ' ' { 0 } ' ' missing . 
 + translation . wrongLanguageCode = Specified language code ' ' { 0 } ' ' is incorrect . 
 translation . missingTranslationFile = Properties file ' ' { 0 } ' ' is missing . 
 
 missing . switch . default = switch without \ " default \ " clause . 
 diff - - git a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ de . properties b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ de . properties 
 index c2889d4 . . 0339eb3 100644 
 - - - a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ de . properties 
 + + + b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ de . properties 
 @ @ - 6 , 6 + 6 , 7 @ @ todo . match = Kommentar entspricht to - do - Format ' ' { 0 } ' ' . 
 upperEll = Zur besseren Lesbarkeit sollte ein gro ß es ' ' L ' ' verwendet werden . 
 
 translation . missingKey = Ü bersetzung f ü r Schl ü ssel ' ' { 0 } ' ' fehlt . 
 + translation . wrongLanguageCode = Spezifizierte Sprachcode ' ' { 0 } ' ' ist nicht korrekt . 
 translation . missingTranslationFile = Properties - Datei ' ' { 0 } ' ' fehlt . 
 
 missing . switch . default = switch ohne \ " default \ " . 
 diff - - git a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ es . properties b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ es . properties 
 index 3d03de3 . . bd9e9ef 100644 
 - - - a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ es . properties 
 + + + b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ es . properties 
 @ @ - 9 , 6 + 9 , 7 @ @ translation . missingKey = La clave ' ' { 0 } ' ' falta . 
 
 missing . switch . default = switch sin etiqueta \ " default \ " . 
 translation . missingTranslationFile = Archivo de propiedades ' ' { 0 } ' ' no se encuentra . 
 + translation . wrongLanguageCode = C ó digo de idioma especificado ' ' { 0 } ' ' no es correcta . 
 
 uncommented . main = Se encotr ó un m é todo main sin comentar . 
 
 diff - - git a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ fi . properties b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ fi . properties 
 index ed61272 . . 6d7733b 100644 
 - - - a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ fi . properties 
 + + + b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ fi . properties 
 @ @ - 7 , 6 + 7 , 7 @ @ upperEll = Pit ä ä olla iso ' ' L ' ' . 
 
 translation . missingKey = K ä ä nn ö savain ' ' { 0 } ' ' puuttuu . 
 translation . missingTranslationFile = Ominaisuudet tiedosto ' ' { 0 } ' ' puuttuu . 
 + translation . wrongLanguageCode = M ä ä ritetty kielikoodi ' ' { 0 } ' ' on virheellinen . 
 
 missing . switch . default = vaihtaa ilman \ " default \ " lauseke . 
 
 diff - - git a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ fr . properties b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ fr . properties 
 index f2d47b9 . . ecab6e5 100644 
 - - - a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ fr . properties 
 + + + b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ fr . properties 
 @ @ - 7 , 6 + 7 , 7 @ @ upperEll = Utilisez un ' ' L ' ' majuscule pour une meilleure lisibilit é . 
 
 translation . missingKey = La traduction du message ' ' { 0 } ' ' est manquante . 
 translation . missingTranslationFile = Fichier de propri é t é s ' ' { 0 } ' ' est manquant . 
 + translation . wrongLanguageCode = Sp é cifi é code de langue ' ' { 0 } ' ' est incorrect . 
 
 missing . switch . default = Il manque le cas \ " default \ " dans le bloc \ " switch \ " . 
 
 diff - - git a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ ja . properties b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ ja . properties 
 index 2aa315a . . 71bd0a5 100644 
 - - - a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ ja . properties 
 + + + b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ ja . properties 
 @ @ - 7 , 6 + 7 , 7 @ @ upperEll = 大 文 字 の ' ' L ' ' を 使 用 す べ き で す 。 
 
 translation . missingKey = キ ー ' ' { 0 } ' ' が あ り ま せ ん 。 
 translation . missingTranslationFile = プ ロ パ テ ィ フ ァ イ ル ' ' { 0 } ' ' が あ り ま せ ん 。 
 + translation . wrongLanguageCode = 指 定 し た 言 語 コ ー ド は ' ' { 0 } ' ' が 正 し く あ り ま せ ん 。 
 
 missing . switch . default = " default " 節 の 無 い switch 文 で す 。 
 
 diff - - git a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ pt . properties b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ pt . properties 
 index e13d681 . . 783a7cd 100644 
 - - - a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ pt . properties 
 + + + b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ pt . properties 
 @ @ - 7 , 6 + 7 , 7 @ @ todo . match = O coment á rio condiz com o padr ã o de tarefa pendente ' ' { 0 } ' ' . 
 
 translation . missingKey = Falta a chave ' ' { 0 } ' ' . 
 translation . missingTranslationFile = Arquivo de propriedades ' ' { 0 } ' ' est á faltando . 
 + translation . wrongLanguageCode = C ó digo de idioma especificado ' ' { 0 } ' ' est á incorreto . 
 
 uncommented . main = M é todo main n ã o comentado encontrado . 
 
 diff - - git a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ tr . properties b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ tr . properties 
 index f61769d . . f8422cf 100644 
 - - - a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ tr . properties 
 + + + b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ tr . properties 
 @ @ - 7 , 6 + 7 , 7 @ @ upperEll = B ü y ü k harf ' ' L ' ' kullan ı lmal ı . 
 
 translation . missingKey = ' ' { 0 } ' ' anahtar ı eksik . 
 translation . missingTranslationFile = Ö zellikler dosyas ı ' ' { 0 } ' ' eksik . 
 + translation . wrongLanguageCode = Belirtilen dil kodu ' ' { 0 } ' ' ' yanl ı ş t ı r . 
 
 missing . switch . default = ' ' default ' ' durumu olmayan bir ' ' switch ' ' mevcut . 
 
 diff - - git a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ zh . properties b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ zh . properties 
 index 1b97530 . . 793f084 100644 
 - - - a / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ zh . properties 
 + + + b / src / main / resources / com / puppycrawl / tools / checkstyle / checks / messages _ zh . properties 
 @ @ - 7 , 6 + 7 , 7 @ @ upperEll = 请 使 用 大 写 ' ' L ' ' 。 
 
 translation . missingKey = 找 不 到 Key ： ' ' { 0 } ' ' 。 
 translation . missingTranslationFile = 找 不 到 配 置 文 件 ： ' ' { 0 } ' ' 。 
 + translation . wrongLanguageCode = 指 定 的 語 言 代 碼 ' ' { 0 } ' ' 是 不 正 確 。 
 
 missing . switch . default = switch 没 有 \ " default \ " 从 句 。 
 
 diff - - git a / src / test / java / com / puppycrawl / tools / checkstyle / checks / TranslationCheckTest . java b / src / test / java / com / puppycrawl / tools / checkstyle / checks / TranslationCheckTest . java 
 index 8dc1bd0 . . dc6bc65 100644 
 - - - a / src / test / java / com / puppycrawl / tools / checkstyle / checks / TranslationCheckTest . java 
 + + + b / src / test / java / com / puppycrawl / tools / checkstyle / checks / TranslationCheckTest . java 
 @ @ - 20 , 6 + 20 , 10 @ @ 
 package com . puppycrawl . tools . checkstyle . checks ; 
 
 import static com . puppycrawl . tools . checkstyle . checks . TranslationCheck . MSG _ KEY ; 
 + import static org . hamcrest . CoreMatchers . containsString ; 
 + import static org . hamcrest . CoreMatchers . endsWith ; 
 + import static org . junit . Assert . assertThat ; 
 + import static org . junit . Assert . fail ; 
 
 import java . io . File ; 
 import java . io . IOException ; 
 @ @ - 388 , 4 + 392 , 18 @ @ public class TranslationCheckTest extends BaseCheckTestSupport { 
 getPath ( " " ) , 
 expected ) ; 
 } 
 + 
 + @ Test 
 + public void testWrongUserSpecifiedLanguageCodes ( ) throws Exception { 
 + final TranslationCheck check = new TranslationCheck ( ) ; 
 + try { 
 + check . setRequiredTranslations ( " 11 " ) ; 
 + fail ( " IllegalArgumentException is expected . Specified language code is incorrect . " ) ; 
 + } 
 + catch ( IllegalArgumentException ex ) { 
 + final String exceptionMessage = ex . getMessage ( ) ; 
 + assertThat ( exceptionMessage , containsString ( " 11 " ) ) ; 
 + assertThat ( exceptionMessage , endsWith ( " [ TranslationCheck ] " ) ) ; 
 + } 
 + } 
 } 
 diff - - git a / src / xdocs / config _ misc . xml b / src / xdocs / config _ misc . xml 
 index a15dbb5 . . 0b9acf0 100755 
 - - - a / src / xdocs / config _ misc . xml 
 + + + b / src / xdocs / config _ misc . xml 
 @ @ - 1629 , 10 + 1629 , 9 @ @ messages . properties : Key ' ok ' missing . 
 of default translation is checked . Note , if you specify language codes ( or just 
 one language code ) of required translations the check will also check for 
 existence of default translation files in project . 
 - ATTENTION : the check will not perform the validation of ISO codes if the option 
 - is set to true . So , if you specify , for example , " mm " for language code , 
 - TranslationCheck will not warn about the incorrect language code and will use it 
 - for validation . 
 + ATTENTION : the check will perform the validation of ISO codes if the option 
 + is used . So , if you specify , for example , " mm " for language code , TranslationCheck 
 + will rise violation that the language code is incorrect . 
 < / td > 
 < td > < a href = " property _ types . html # stringSet " > String Set < / a > < / td > 
 < td > < code > empty String Set < / code > < / td >

NEAREST DIFF:
diff - - git a / docs / releasenotes . html b / docs / releasenotes . html 
 index 6bf8888 . . 0cccd80 100644 
 - - - a / docs / releasenotes . html 
 + + + b / docs / releasenotes . html 
 @ @ - 101 , 8 + 101 , 13 @ @ 
 < p class = " body " > 
 Resolved bugs : 
 < / p > 
 - < ul > 
 - < li class = " body " > False alarms from RightCurly module for code that does not have braces in if - then - else ( bug 689836 ) . < / li > 
 + 	 < ul > 
 + 	 
 + 	 < li class = " body " > False alarms from RightCurly module for code that 
 + does not have braces in if - then - else ( bug 689836 ) . < / li > 
 + 
 + 	 < li class = " body " > Grammar incorrectly defaulting unqualified floating point literals to be float , when they should be double ( bug 713716 ) . < / li > 
 + 
 < li class = " body " > & quot ; threadsafe & quot ; was treated as a Java keyword , resulting in parser errors for 
 sources that use it as an identifier ( bug 710319 ) . < / li > 
 < li class = " body " > ConfigurationLoader was not public ( only relevant for IDE plugin authors ) . < / li > 
 diff - - git a / src / checkstyle / com / puppycrawl / tools / checkstyle / java . g b / src / checkstyle / com / puppycrawl / tools / checkstyle / java . g 
 index 9c7d73c . . 56e165d 100644 
 - - - a / src / checkstyle / com / puppycrawl / tools / checkstyle / java . g 
 + + + b / src / checkstyle / com / puppycrawl / tools / checkstyle / java . g 
 @ @ - 1154 , 11 + 1154 , 11 @ @ NUM _ INT 
 : ' . ' { _ ttype = DOT ; } 
 ( 	 ( ' 0 ' . . ' 9 ' ) + ( EXPONENT ) ? ( f1 : FLOAT _ SUFFIX { t = f1 ; } ) ? 
 { 
 - 	 	 	 	 if ( t ! = null & & t . getText ( ) . toUpperCase ( ) . indexOf ( ' D ' ) > = 0 ) { 
 - 	 _ ttype = NUM _ DOUBLE ; 
 + 	 	 	 	 if ( t ! = null & & t . getText ( ) . toUpperCase ( ) . indexOf ( ' F ' ) > = 0 ) { 
 + 	 _ ttype = NUM _ FLOAT ; 
 	 	 	 	 } 
 	 	 	 	 else { 
 - 	 _ ttype = NUM _ FLOAT ; 
 + 	 _ ttype = NUM _ DOUBLE ; / / assume double 
 	 	 	 	 } 
 	 	 	 	 } 
 ) ? 
 @ @ - 1189 , 11 + 1189 , 11 @ @ NUM _ INT 
 | f4 : FLOAT _ SUFFIX { t = f4 ; } 
 ) 
 { 
 - 	 	 	 if ( t ! = null & & t . getText ( ) . toUpperCase ( ) . indexOf ( ' D ' ) > = 0 ) { 
 - _ ttype = NUM _ DOUBLE ; 
 + 	 	 	 if ( t ! = null & & t . getText ( ) . toUpperCase ( ) . indexOf ( ' F ' ) > = 0 ) { 
 + _ ttype = NUM _ FLOAT ; 
 	 	 	 } 
 else { 
 - _ ttype = NUM _ FLOAT ; 
 + 	 	 _ ttype = NUM _ DOUBLE ; / / assume double 
 	 	 	 } 
 	 	 	 } 
 ) ?
