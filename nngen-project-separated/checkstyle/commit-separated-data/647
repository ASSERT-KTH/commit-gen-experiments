BLEU SCORE: 0.09837489905577816

TEST MSG: Issue # 4724 : fix all violations from the sixth part of idea violations
GENERATED MSG: Issue # 4726 : fix CallToSimpleGetterInClass , MismatchedCollectionQueryUpdate , NullableProblems idea violations

TEST DIFF (one line): diff - - git a / config / intellij - idea - inspections . xml b / config / intellij - idea - inspections . xml <nl> index cce766a . . 270baa0 100644 <nl> - - - a / config / intellij - idea - inspections . xml <nl> + + + b / config / intellij - idea - inspections . xml <nl> @ @ - 306 , 7 + 306 , 7 @ @ <nl> < / inspection _ tool > <nl> < inspection _ tool class = " ClassInitializer " enabled = " true " level = " WARNING " enabled _ by _ default = " true " / > <nl> < inspection _ tool class = " ClassInitializerMayBeStatic " enabled = " true " level = " ERROR " enabled _ by _ default = " true " / > <nl> - < inspection _ tool class = " ClassLoaderInstantiation " enabled = " false " level = " ERROR " enabled _ by _ default = " false " / > <nl> + < inspection _ tool class = " ClassLoaderInstantiation " enabled = " true " level = " ERROR " enabled _ by _ default = " true " / > <nl> < inspection _ tool class = " ClassMayBeInterface " enabled = " true " level = " ERROR " enabled _ by _ default = " true " / > <nl> < inspection _ tool class = " ClassNameDiffersFromFileName " enabled = " true " level = " WARNING " enabled _ by _ default = " true " / > <nl> < ! - - names of Checks are public to users , we do care about clear name for user without information in <nl> @ @ - 1011 , 7 + 1011 , 7 @ @ <nl> < / inspection _ tool > <nl> < inspection _ tool class = " HtmlUnknownTarget " enabled = " true " level = " ERROR " enabled _ by _ default = " true " / > <nl> < inspection _ tool class = " IOResource " enabled = " true " level = " WARNING " enabled _ by _ default = " true " > <nl> - < scope name = " Production " level = " WARNING " enabled = " false " > <nl> + < scope name = " Production " level = " WARNING " enabled = " true " > <nl> < option name = " ignoredTypesString " value = " java . io . ByteArrayOutputStream , java . io . ByteArrayInputStream , java . io . StringBufferInputStream , java . io . CharArrayWriter , java . io . CharArrayReader , java . io . StringWriter , java . io . StringReader " / > <nl> < option name = " insideTryAllowed " value = " false " / > <nl> < / scope > <nl> @ @ - 1554 , 7 + 1554 , 7 @ @ <nl> < / inspection _ tool > <nl> < inspection _ tool class = " NonPublicClone " enabled = " true " level = " ERROR " enabled _ by _ default = " true " / > <nl> < inspection _ tool class = " NonReproducibleMathCall " enabled = " true " level = " ERROR " enabled _ by _ default = " true " / > <nl> - < inspection _ tool class = " NonSerializableFieldInSerializableClass " enabled = " false " level = " ERROR " enabled _ by _ default = " false " > <nl> + < inspection _ tool class = " NonSerializableFieldInSerializableClass " enabled = " true " level = " ERROR " enabled _ by _ default = " true " > <nl> < option name = " ignorableAnnotations " > <nl> < value / > <nl> < / option > <nl> @ @ - 1572 , 7 + 1572 , 7 @ @ <nl> < / inspection _ tool > <nl> < ! - - this inspection is not for us - - > <nl> < inspection _ tool class = " NonStaticInnerClassInSecureContext " enabled = " false " level = " ERROR " enabled _ by _ default = " false " / > <nl> - < inspection _ tool class = " NonSynchronizedMethodOverridesSynchronizedMethod " enabled = " false " level = " ERROR " enabled _ by _ default = " false " / > <nl> + < inspection _ tool class = " NonSynchronizedMethodOverridesSynchronizedMethod " enabled = " true " level = " ERROR " enabled _ by _ default = " true " / > <nl> < inspection _ tool class = " NonThreadSafeLazyInitialization " enabled = " true " level = " ERROR " enabled _ by _ default = " true " / > <nl> < inspection _ tool class = " NoopMethodInAbstractClass " enabled = " true " level = " ERROR " enabled _ by _ default = " true " / > <nl> < inspection _ tool class = " NotifyCalledOnCondition " enabled = " true " level = " WARNING " enabled _ by _ default = " true " / > <nl> @ @ - 1861 , 9 + 1861 , 10 @ @ <nl> < option name = " ignoreAnonymousInnerClasses " value = " false " / > <nl> < option name = " superClassString " value = " " / > <nl> < / inspection _ tool > <nl> - < inspection _ tool class = " SerializableHasSerializationMethods " enabled = " false " level = " ERROR " enabled _ by _ default = " false " > <nl> - < option name = " ignoreAnonymousInnerClasses " value = " false " / > <nl> - < option name = " superClassString " value = " " / > <nl> + < inspection _ tool class = " SerializableHasSerializationMethods " enabled = " true " level = " ERROR " enabled _ by _ default = " true " > <nl> + < option name = " ignoreAnonymousInnerClasses " value = " true " / > <nl> + < option name = " superClassString " value = " com . puppycrawl . tools . checkstyle . gui . BaseCellEditor , com . puppycrawl . tools . checkstyle . gui . CodeSelector , com . puppycrawl . tools . checkstyle . gui . CodeSelectorPresentation , com . puppycrawl . tools . checkstyle . gui . ListToTreeSelectionModelWrapper , com . puppycrawl . tools . checkstyle . gui . Main , com . puppycrawl . tools . checkstyle . gui . MainFrame , com . puppycrawl . tools . checkstyle . gui . MainFrameModel , com . puppycrawl . tools . checkstyle . gui . ParseTreeTableModel , com . puppycrawl . tools . checkstyle . gui . ParseTreeTablePresentation , com . puppycrawl . tools . checkstyle . gui . TreeTableCellRenderer , com . puppycrawl . tools . checkstyle . gui . TreeTableModelAdapter , com . puppycrawl . tools . checkstyle . gui . TreeTable " / > <nl> + < option name = " ignoreClassWithoutFields " value = " true " / > <nl> < / inspection _ tool > <nl> < inspection _ tool class = " SerializableInnerClassHasSerialVersionUIDField " enabled = " true " level = " ERROR " enabled _ by _ default = " true " > <nl> < option name = " ignoreAnonymousInnerClasses " value = " false " / > <nl> @ @ - 2124 , 6 + 2125 , 8 @ @ <nl> < option value = " FieldNotUsedInToString " / > <nl> < ! - - till # 4805 - - > <nl> < option value = " HtmlTagCanBeJavadocTag " / > <nl> + < ! - - we need to work with AntClassLoader , there is no way to avoid this - - > <nl> + < option value = " ClassLoaderInstantiation " / > <nl> < / list > <nl> < / option > <nl> < / inspection _ tool > <nl> diff - - git a / config / pmd . xml b / config / pmd . xml <nl> index f974089 . . 7d69b67 100644 <nl> - - - a / config / pmd . xml <nl> + + + b / config / pmd . xml <nl> @ @ - 190 , 6 + 190 , 13 @ @ <nl> < / properties > <nl> < / rule > <nl> <nl> + < rule ref = " rulesets / java / design . xml / AvoidSynchronizedAtMethodLevel " > <nl> + < properties > <nl> + < ! - - UniqueProperties # put overloads synchronized method , so it should have synchronized modifier - - > <nl> + < property name = " violationSuppressXPath " value = " / / ClassOrInterfaceDeclaration [ @ Image = ' UniqueProperties ' ] / / MethodDeclarator [ @ Image = ' put ' ] " / > <nl> + < / properties > <nl> + < / rule > <nl> + <nl> < rule ref = " rulesets / java / empty . xml " / > <nl> < rule ref = " rulesets / java / empty . xml / EmptyCatchBlock " > <nl> < properties > <nl> diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / DefaultConfiguration . java b / src / main / java / com / puppycrawl / tools / checkstyle / DefaultConfiguration . java <nl> index 8467b1b . . 2154b85 100644 <nl> - - - a / src / main / java / com / puppycrawl / tools / checkstyle / DefaultConfiguration . java <nl> + + + b / src / main / java / com / puppycrawl / tools / checkstyle / DefaultConfiguration . java <nl> @ @ - 32 , 6 + 32 , 7 @ @ import com . puppycrawl . tools . checkstyle . api . Configuration ; <nl> / * * <nl> * Default implementation of the Configuration interface . <nl> * @ author lkuehne <nl> + * @ noinspection SerializableHasSerializationMethods <nl> * / <nl> public final class DefaultConfiguration implements Configuration { <nl> private static final long serialVersionUID = 1157875385356127169L ; <nl> diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / Main . java b / src / main / java / com / puppycrawl / tools / checkstyle / Main . java <nl> index 27fd41a . . 5198806 100644 <nl> - - - a / src / main / java / com / puppycrawl / tools / checkstyle / Main . java <nl> + + + b / src / main / java / com / puppycrawl / tools / checkstyle / Main . java <nl> @ @ - 569 , 6 + 569 , 7 @ @ public final class Main { <nl> * @ param outputLocation the location of output <nl> * @ return a fresh new { @ code AuditListener } <nl> * @ exception FileNotFoundException when provided output location is not found <nl> + * @ noinspection IOResourceOpenedButNotSafelyClosed <nl> * / <nl> private static AuditListener createListener ( String format , <nl> String outputLocation ) <nl> diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / PropertyCacheFile . java b / src / main / java / com / puppycrawl / tools / checkstyle / PropertyCacheFile . java <nl> index 68f1a01 . . ef03801 100644 <nl> - - - a / src / main / java / com / puppycrawl / tools / checkstyle / PropertyCacheFile . java <nl> + + + b / src / main / java / com / puppycrawl / tools / checkstyle / PropertyCacheFile . java <nl> @ @ - 246 , 9 + 246 , 8 @ @ final class PropertyCacheFile { <nl> * / <nl> private static void serialize ( Serializable object , <nl> OutputStream outputStream ) throws IOException { <nl> - ObjectOutputStream oos = null ; <nl> + final ObjectOutputStream oos = new ObjectOutputStream ( outputStream ) ; <nl> try { <nl> - oos = new ObjectOutputStream ( outputStream ) ; <nl> oos . writeObject ( object ) ; <nl> } <nl> finally { <nl> diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / ThreadModeSettings . java b / src / main / java / com / puppycrawl / tools / checkstyle / ThreadModeSettings . java <nl> index dac67c0 . . b3b3449 100644 <nl> - - - a / src / main / java / com / puppycrawl / tools / checkstyle / ThreadModeSettings . java <nl> + + + b / src / main / java / com / puppycrawl / tools / checkstyle / ThreadModeSettings . java <nl> @ @ - 24 , 6 + 24 , 7 @ @ import java . io . Serializable ; <nl> / * * <nl> * Thread mode settings for the checkstyle modules . <nl> * @ author Andrew Kuchev <nl> + * @ noinspection SerializableHasSerializationMethods <nl> * / <nl> public class ThreadModeSettings implements Serializable { <nl> / * * A checker module name . * / <nl> diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / ant / CheckstyleAntTask . java b / src / main / java / com / puppycrawl / tools / checkstyle / ant / CheckstyleAntTask . java <nl> index 5df05bf . . f1b287f 100644 <nl> - - - a / src / main / java / com / puppycrawl / tools / checkstyle / ant / CheckstyleAntTask . java <nl> + + + b / src / main / java / com / puppycrawl / tools / checkstyle / ant / CheckstyleAntTask . java <nl> @ @ - 64 , 6 + 64 , 7 @ @ import com . puppycrawl . tools . checkstyle . api . SeverityLevelCounter ; <nl> * An implementation of a ANT task for calling checkstyle . See the documentation <nl> * of the task for usage . <nl> * @ author Oliver Burn <nl> + * @ noinspection ClassLoaderInstantiation <nl> * / <nl> public class CheckstyleAntTask extends Task { <nl> / * * Poor man ' s enum for an xml formatter . * / <nl> diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / api / AuditEvent . java b / src / main / java / com / puppycrawl / tools / checkstyle / api / AuditEvent . java <nl> index acad045 . . 0157f98 100644 <nl> - - - a / src / main / java / com / puppycrawl / tools / checkstyle / api / AuditEvent . java <nl> + + + b / src / main / java / com / puppycrawl / tools / checkstyle / api / AuditEvent . java <nl> @ @ - 37 , 6 + 37 , 7 @ @ import java . util . EventObject ; <nl> * <nl> * @ author < a href = " mailto : stephane . bailliez @ wanadoo . fr " > Stephane Bailliez < / a > <nl> * @ see AuditListener <nl> + * @ noinspection SerializableHasSerializationMethods <nl> * / <nl> public final class AuditEvent <nl> extends EventObject { <nl> diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / api / DetailAST . java b / src / main / java / com / puppycrawl / tools / checkstyle / api / DetailAST . java <nl> index dab8f8a . . 74f9e76 100644 <nl> - - - a / src / main / java / com / puppycrawl / tools / checkstyle / api / DetailAST . java <nl> + + + b / src / main / java / com / puppycrawl / tools / checkstyle / api / DetailAST . java <nl> @ @ - 32 , 7 + 32 , 7 @ @ import com . puppycrawl . tools . checkstyle . utils . TokenUtils ; <nl> * @ author Oliver Burn <nl> * @ author lkuehne <nl> * @ see < a href = " http : / / www . antlr . org / " > ANTLR Website < / a > <nl> - * @ noinspection FieldNotUsedInToString <nl> + * @ noinspection FieldNotUsedInToString , SerializableHasSerializationMethods <nl> * / <nl> public final class DetailAST extends CommonASTWithHiddenTokens { <nl> private static final long serialVersionUID = - 2580884815577559874L ; <nl> diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / api / FileText . java b / src / main / java / com / puppycrawl / tools / checkstyle / api / FileText . java <nl> index 1dc1d71 . . b550a76 100644 <nl> - - - a / src / main / java / com / puppycrawl / tools / checkstyle / api / FileText . java <nl> + + + b / src / main / java / com / puppycrawl / tools / checkstyle / api / FileText . java <nl> @ @ - 127 , 16 + 127 , 20 @ @ public final class FileText { <nl> / / is about 30 % faster than using the <nl> / / LINE _ TERMINATOR . split ( fullText , - 1 ) method <nl> final ArrayList < String > textLines = new ArrayList < > ( ) ; <nl> - final BufferedReader reader = <nl> - new BufferedReader ( new StringReader ( fullText ) ) ; <nl> - while ( true ) { <nl> - final String line = reader . readLine ( ) ; <nl> - if ( line = = null ) { <nl> - break ; <nl> + final BufferedReader reader = new BufferedReader ( new StringReader ( fullText ) ) ; <nl> + try { <nl> + while ( true ) { <nl> + final String line = reader . readLine ( ) ; <nl> + if ( line = = null ) { <nl> + break ; <nl> + } <nl> + textLines . add ( line ) ; <nl> } <nl> - textLines . add ( line ) ; <nl> + lines = textLines . toArray ( new String [ textLines . size ( ) ] ) ; <nl> + } <nl> + finally { <nl> + Closeables . closeQuietly ( reader ) ; <nl> } <nl> - lines = textLines . toArray ( new String [ textLines . size ( ) ] ) ; <nl> } <nl> <nl> / * * <nl> diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / api / LocalizedMessage . java b / src / main / java / com / puppycrawl / tools / checkstyle / api / LocalizedMessage . java <nl> index 3fa49e6 . . e6675ad 100644 <nl> - - - a / src / main / java / com / puppycrawl / tools / checkstyle / api / LocalizedMessage . java <nl> + + + b / src / main / java / com / puppycrawl / tools / checkstyle / api / LocalizedMessage . java <nl> @ @ - 45 , 7 + 45 , 7 @ @ import java . util . ResourceBundle . Control ; <nl> * <nl> * @ author Oliver Burn <nl> * @ author lkuehne <nl> - * @ noinspection ConstructorWithTooManyParameters <nl> + * @ noinspection ConstructorWithTooManyParameters , SerializableHasSerializationMethods <nl> * / <nl> public final class LocalizedMessage <nl> implements Comparable < LocalizedMessage > , Serializable { <nl> @ @ - 78 , 7 + 78 , 9 @ @ public final class LocalizedMessage <nl> / * * Key for the message format . * * / <nl> private final String key ; <nl> <nl> - / * * Arguments for MessageFormat . * * / <nl> + / * * Arguments for MessageFormat . <nl> + * @ noinspection NonSerializableFieldInSerializableClass <nl> + * / <nl> private final Object [ ] args ; <nl> <nl> / * * Name of the resource bundle to get messages from . * * / <nl> @ @ - 388 , 6 + 390 , 7 @ @ public final class LocalizedMessage <nl> * < / p > <nl> * <nl> * @ author < a href = " mailto : nesterenko - aleksey @ list . ru " > Aleksey Nesterenko < / a > <nl> + * @ noinspection IOResourceOpenedButNotSafelyClosed <nl> * / <nl> public static class Utf8Control extends Control { <nl> @ Override <nl> diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / checks / UniquePropertiesCheck . java b / src / main / java / com / puppycrawl / tools / checkstyle / checks / UniquePropertiesCheck . java <nl> index cd93107 . . d581894 100644 <nl> - - - a / src / main / java / com / puppycrawl / tools / checkstyle / checks / UniquePropertiesCheck . java <nl> + + + b / src / main / java / com / puppycrawl / tools / checkstyle / checks / UniquePropertiesCheck . java <nl> @ @ - 134 , 7 + 134 , 7 @ @ public class UniquePropertiesCheck extends AbstractFileSetCheck { <nl> * Properties subclass to store duplicated property keys in a separate map . <nl> * <nl> * @ author Pavel Baranchikov <nl> - * @ noinspection ClassExtendsConcreteCollection <nl> + * @ noinspection ClassExtendsConcreteCollection , SerializableHasSerializationMethods <nl> * / <nl> private static class UniqueProperties extends Properties { <nl> private static final long serialVersionUID = 1L ; <nl> @ @ - 146 , 7 + 146 , 7 @ @ public class UniquePropertiesCheck extends AbstractFileSetCheck { <nl> . create ( ) ; <nl> <nl> @ Override <nl> - public Object put ( Object key , Object value ) { <nl> + public synchronized Object put ( Object key , Object value ) { <nl> final Object oldValue = super . put ( key , value ) ; <nl> if ( oldValue ! = null & & key instanceof String ) { <nl> final String keyString = ( String ) key ; <nl> diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / checks / header / AbstractHeaderCheck . java b / src / main / java / com / puppycrawl / tools / checkstyle / checks / header / AbstractHeaderCheck . java <nl> index d3b0271 . . b1b5b0a 100644 <nl> - - - a / src / main / java / com / puppycrawl / tools / checkstyle / checks / header / AbstractHeaderCheck . java <nl> + + + b / src / main / java / com / puppycrawl / tools / checkstyle / checks / header / AbstractHeaderCheck . java <nl> @ @ - 168 , 14 + 168 , 20 @ @ public abstract class AbstractHeaderCheck extends AbstractFileSetCheck <nl> * / <nl> private void loadHeader ( final Reader headerReader ) throws IOException { <nl> final LineNumberReader lnr = new LineNumberReader ( headerReader ) ; <nl> - while ( true ) { <nl> - final String line = lnr . readLine ( ) ; <nl> - if ( line = = null ) { <nl> - break ; <nl> + try { <nl> + while ( true ) { <nl> + final String line = lnr . readLine ( ) ; <nl> + if ( line = = null ) { <nl> + break ; <nl> + } <nl> + readerLines . add ( line ) ; <nl> } <nl> - readerLines . add ( line ) ; <nl> + postProcessHeaderLines ( ) ; <nl> + } <nl> + finally { <nl> + Closeables . closeQuietly ( lnr ) ; <nl> } <nl> - postProcessHeaderLines ( ) ; <nl> + <nl> } <nl> <nl> @ Override <nl> diff - - git a / src / test / java / com / puppycrawl / tools / checkstyle / api / FileTextTest . java b / src / test / java / com / puppycrawl / tools / checkstyle / api / FileTextTest . java <nl> index 1fd577b . . ebfe4b1 100644 <nl> - - - a / src / test / java / com / puppycrawl / tools / checkstyle / api / FileTextTest . java <nl> + + + b / src / test / java / com / puppycrawl / tools / checkstyle / api / FileTextTest . java <nl> @ @ - 68 , 7 + 68 , 7 @ @ public class FileTextTest { <nl> + " checkstyle / api / import - control _ complete . xml " ) , charsetName ) ; <nl> assertEquals ( charsetName , fileText . getCharset ( ) . name ( ) ) ; <nl> <nl> - verifyStatic ( times ( 1 ) ) ; <nl> + verifyStatic ( times ( 2 ) ) ; <nl> Closeables . closeQuietly ( any ( Reader . class ) ) ; <nl> } <nl> <nl> diff - - git a / src / test / java / com / puppycrawl / tools / checkstyle / checks / header / RegexpHeaderCheckTest . java b / src / test / java / com / puppycrawl / tools / checkstyle / checks / header / RegexpHeaderCheckTest . java <nl> index b709ef3 . . 54018b7 100644 <nl> - - - a / src / test / java / com / puppycrawl / tools / checkstyle / checks / header / RegexpHeaderCheckTest . java <nl> + + + b / src / test / java / com / puppycrawl / tools / checkstyle / checks / header / RegexpHeaderCheckTest . java <nl> @ @ - 113 , 7 + 113 , 7 @ @ public class RegexpHeaderCheckTest extends BaseFileSetCheckTestSupport { <nl> final String header = " abc . * " ; <nl> instance . setHeader ( header ) ; <nl> <nl> - verifyStatic ( times ( 1 ) ) ; <nl> + verifyStatic ( times ( 2 ) ) ; <nl> Closeables . closeQuietly ( any ( Reader . class ) ) ; <nl> } <nl> <nl> @ @ - 372 , 7 + 372 , 7 @ @ public class RegexpHeaderCheckTest extends BaseFileSetCheckTestSupport { <nl> createChecker ( checkConfig ) ; <nl> <nl> / / check if reader finally closed <nl> - verifyStatic ( times ( 1 ) ) ; <nl> + verifyStatic ( times ( 2 ) ) ; <nl> Closeables . closeQuietly ( any ( InputStreamReader . class ) ) ; <nl> } <nl> }
NEAREST DIFF (one line): diff - - git a / src / test / java / com / puppycrawl / tools / checkstyle / checks / header / HeaderCheckTest . java b / src / test / java / com / puppycrawl / tools / checkstyle / checks / header / HeaderCheckTest . java <nl> index 2dca5da . . 665dc16 100644 <nl> - - - a / src / test / java / com / puppycrawl / tools / checkstyle / checks / header / HeaderCheckTest . java <nl> + + + b / src / test / java / com / puppycrawl / tools / checkstyle / checks / header / HeaderCheckTest . java <nl> @ @ - 56 , 7 + 56 , 9 @ @ public class HeaderCheckTest extends BaseFileSetCheckTestSupport { <nl> @ Override <nl> protected String getPath ( String filename ) throws IOException { <nl> return super . getPath ( " checks " + File . separator <nl> - + " header " + File . separator + filename ) ; <nl> + + " header " + File . separator <nl> + + " header " + File . separator <nl> + + filename ) ; <nl> } <nl> <nl> private String getConfigPath ( String filename ) throws IOException { <nl> @ @ - 80 , 7 + 82 , 7 @ @ public class HeaderCheckTest extends BaseFileSetCheckTestSupport { <nl> try { <nl> createChecker ( checkConfig ) ; <nl> final String [ ] expected = CommonUtils . EMPTY _ STRING _ ARRAY ; <nl> - verify ( checkConfig , getPath ( " InputRegexpHeader1 . java " ) , expected ) ; <nl> + verify ( checkConfig , getPath ( " InputRegexpHeader . java " ) , expected ) ; <nl> } <nl> catch ( CheckstyleException ex ) { <nl> / / Exception is not expected <nl> @ @ - 95 , 7 + 97 , 7 @ @ public class HeaderCheckTest extends BaseFileSetCheckTestSupport { <nl> try { <nl> createChecker ( checkConfig ) ; <nl> final String [ ] expected = CommonUtils . EMPTY _ STRING _ ARRAY ; <nl> - verify ( checkConfig , getPath ( " InputRegexpHeader1 . java " ) , expected ) ; <nl> + verify ( checkConfig , getPath ( " InputRegexpHeader . java " ) , expected ) ; <nl> } <nl> catch ( CheckstyleException ex ) { <nl> / / Exception is not expected <nl> @ @ - 233 , 7 + 235 , 7 @ @ public class HeaderCheckTest extends BaseFileSetCheckTestSupport { <nl> PowerMockito . doThrow ( new IOException ( " expected exception " ) ) . when ( check , " loadHeader " , <nl> anyObject ( ) ) ; <nl> <nl> - check . setHeaderFile ( CommonUtils . getUriByFilename ( getPath ( " InputRegexpHeader1 . java " ) ) ) ; <nl> + check . setHeaderFile ( CommonUtils . getUriByFilename ( getPath ( " InputRegexpHeader . java " ) ) ) ; <nl> <nl> final Method loadHeaderFile = AbstractHeaderCheck . class . getDeclaredMethod ( " loadHeaderFile " ) ; <nl> loadHeaderFile . setAccessible ( true ) ; <nl> diff - - git a / src / test / resources / com / puppycrawl / tools / checkstyle / checks / header / InputHeader . java b / src / test / resources / com / puppycrawl / tools / checkstyle / checks / header / InputHeader . java <nl> deleted file mode 100644 <nl> index 896ae03 . . 0000000 <nl> - - - a / src / test / resources / com / puppycrawl / tools / checkstyle / checks / header / InputHeader . java <nl> + + + / dev / null <nl> @ @ - 1 + 0 , 0 @ @ <nl> - package com . puppycrawl . tools . checkstyle . checks . header ; class InputHeader { } / / One line test <nl> diff - - git a / src / test / resources / com / puppycrawl / tools / checkstyle / checks / header / InputRegexpHeader1 . java b / src / test / resources / com / puppycrawl / tools / checkstyle / checks / header / InputRegexpHeader1 . java <nl> deleted file mode 100644 <nl> index 6e25292 . . 0000000 <nl> - - - a / src / test / resources / com / puppycrawl / tools / checkstyle / checks / header / InputRegexpHeader1 . java <nl> + + + / dev / null <nl> @ @ - 1 , 11 + 0 , 0 @ @ <nl> - package com . puppycrawl . tools . checkstyle . checks . header ; <nl> - <nl> - import java . awt . * ; <nl> - <nl> - / * * <nl> - * Some doc . <nl> - * / <nl> - <nl> - public class InputRegexpHeader1 <nl> - { <nl> - } <nl> diff - - git a / src / test / resources / com / puppycrawl / tools / checkstyle / checks / header / header / InputHeader . java b / src / test / resources / com / puppycrawl / tools / checkstyle / checks / header / header / InputHeader . java <nl> new file mode 100644 <nl> index 0000000 . . 366225c <nl> - - - / dev / null <nl> + + + b / src / test / resources / com / puppycrawl / tools / checkstyle / checks / header / header / InputHeader . java <nl> @ @ - 0 , 0 + 1 @ @ <nl> + package com . puppycrawl . tools . checkstyle . checks . header . header ; class InputHeader { } / / One line test <nl> diff - - git a / src / test / resources / com / puppycrawl / tools / checkstyle / checks / header / header / InputRegexpHeader . java b / src / test / resources / com / puppycrawl / tools / checkstyle / checks / header / header / InputRegexpHeader . java <nl> new file mode 100644 <nl> index 0000000 . . 430953b <nl> - - - / dev / null <nl> + + + b / src / test / resources / com / puppycrawl / tools / checkstyle / checks / header / header / InputRegexpHeader . java <nl> @ @ - 0 , 0 + 1 , 11 @ @ <nl> + package com . puppycrawl . tools . checkstyle . checks . header . header ; <nl> + <nl> + import java . awt . * ; <nl> + <nl> + / * * <nl> + * Some doc . <nl> + * / <nl> + <nl> + public class InputRegexpHeader <nl> + { <nl> + }

TEST DIFF:
diff - - git a / config / intellij - idea - inspections . xml b / config / intellij - idea - inspections . xml 
 index cce766a . . 270baa0 100644 
 - - - a / config / intellij - idea - inspections . xml 
 + + + b / config / intellij - idea - inspections . xml 
 @ @ - 306 , 7 + 306 , 7 @ @ 
 < / inspection _ tool > 
 < inspection _ tool class = " ClassInitializer " enabled = " true " level = " WARNING " enabled _ by _ default = " true " / > 
 < inspection _ tool class = " ClassInitializerMayBeStatic " enabled = " true " level = " ERROR " enabled _ by _ default = " true " / > 
 - < inspection _ tool class = " ClassLoaderInstantiation " enabled = " false " level = " ERROR " enabled _ by _ default = " false " / > 
 + < inspection _ tool class = " ClassLoaderInstantiation " enabled = " true " level = " ERROR " enabled _ by _ default = " true " / > 
 < inspection _ tool class = " ClassMayBeInterface " enabled = " true " level = " ERROR " enabled _ by _ default = " true " / > 
 < inspection _ tool class = " ClassNameDiffersFromFileName " enabled = " true " level = " WARNING " enabled _ by _ default = " true " / > 
 < ! - - names of Checks are public to users , we do care about clear name for user without information in 
 @ @ - 1011 , 7 + 1011 , 7 @ @ 
 < / inspection _ tool > 
 < inspection _ tool class = " HtmlUnknownTarget " enabled = " true " level = " ERROR " enabled _ by _ default = " true " / > 
 < inspection _ tool class = " IOResource " enabled = " true " level = " WARNING " enabled _ by _ default = " true " > 
 - < scope name = " Production " level = " WARNING " enabled = " false " > 
 + < scope name = " Production " level = " WARNING " enabled = " true " > 
 < option name = " ignoredTypesString " value = " java . io . ByteArrayOutputStream , java . io . ByteArrayInputStream , java . io . StringBufferInputStream , java . io . CharArrayWriter , java . io . CharArrayReader , java . io . StringWriter , java . io . StringReader " / > 
 < option name = " insideTryAllowed " value = " false " / > 
 < / scope > 
 @ @ - 1554 , 7 + 1554 , 7 @ @ 
 < / inspection _ tool > 
 < inspection _ tool class = " NonPublicClone " enabled = " true " level = " ERROR " enabled _ by _ default = " true " / > 
 < inspection _ tool class = " NonReproducibleMathCall " enabled = " true " level = " ERROR " enabled _ by _ default = " true " / > 
 - < inspection _ tool class = " NonSerializableFieldInSerializableClass " enabled = " false " level = " ERROR " enabled _ by _ default = " false " > 
 + < inspection _ tool class = " NonSerializableFieldInSerializableClass " enabled = " true " level = " ERROR " enabled _ by _ default = " true " > 
 < option name = " ignorableAnnotations " > 
 < value / > 
 < / option > 
 @ @ - 1572 , 7 + 1572 , 7 @ @ 
 < / inspection _ tool > 
 < ! - - this inspection is not for us - - > 
 < inspection _ tool class = " NonStaticInnerClassInSecureContext " enabled = " false " level = " ERROR " enabled _ by _ default = " false " / > 
 - < inspection _ tool class = " NonSynchronizedMethodOverridesSynchronizedMethod " enabled = " false " level = " ERROR " enabled _ by _ default = " false " / > 
 + < inspection _ tool class = " NonSynchronizedMethodOverridesSynchronizedMethod " enabled = " true " level = " ERROR " enabled _ by _ default = " true " / > 
 < inspection _ tool class = " NonThreadSafeLazyInitialization " enabled = " true " level = " ERROR " enabled _ by _ default = " true " / > 
 < inspection _ tool class = " NoopMethodInAbstractClass " enabled = " true " level = " ERROR " enabled _ by _ default = " true " / > 
 < inspection _ tool class = " NotifyCalledOnCondition " enabled = " true " level = " WARNING " enabled _ by _ default = " true " / > 
 @ @ - 1861 , 9 + 1861 , 10 @ @ 
 < option name = " ignoreAnonymousInnerClasses " value = " false " / > 
 < option name = " superClassString " value = " " / > 
 < / inspection _ tool > 
 - < inspection _ tool class = " SerializableHasSerializationMethods " enabled = " false " level = " ERROR " enabled _ by _ default = " false " > 
 - < option name = " ignoreAnonymousInnerClasses " value = " false " / > 
 - < option name = " superClassString " value = " " / > 
 + < inspection _ tool class = " SerializableHasSerializationMethods " enabled = " true " level = " ERROR " enabled _ by _ default = " true " > 
 + < option name = " ignoreAnonymousInnerClasses " value = " true " / > 
 + < option name = " superClassString " value = " com . puppycrawl . tools . checkstyle . gui . BaseCellEditor , com . puppycrawl . tools . checkstyle . gui . CodeSelector , com . puppycrawl . tools . checkstyle . gui . CodeSelectorPresentation , com . puppycrawl . tools . checkstyle . gui . ListToTreeSelectionModelWrapper , com . puppycrawl . tools . checkstyle . gui . Main , com . puppycrawl . tools . checkstyle . gui . MainFrame , com . puppycrawl . tools . checkstyle . gui . MainFrameModel , com . puppycrawl . tools . checkstyle . gui . ParseTreeTableModel , com . puppycrawl . tools . checkstyle . gui . ParseTreeTablePresentation , com . puppycrawl . tools . checkstyle . gui . TreeTableCellRenderer , com . puppycrawl . tools . checkstyle . gui . TreeTableModelAdapter , com . puppycrawl . tools . checkstyle . gui . TreeTable " / > 
 + < option name = " ignoreClassWithoutFields " value = " true " / > 
 < / inspection _ tool > 
 < inspection _ tool class = " SerializableInnerClassHasSerialVersionUIDField " enabled = " true " level = " ERROR " enabled _ by _ default = " true " > 
 < option name = " ignoreAnonymousInnerClasses " value = " false " / > 
 @ @ - 2124 , 6 + 2125 , 8 @ @ 
 < option value = " FieldNotUsedInToString " / > 
 < ! - - till # 4805 - - > 
 < option value = " HtmlTagCanBeJavadocTag " / > 
 + < ! - - we need to work with AntClassLoader , there is no way to avoid this - - > 
 + < option value = " ClassLoaderInstantiation " / > 
 < / list > 
 < / option > 
 < / inspection _ tool > 
 diff - - git a / config / pmd . xml b / config / pmd . xml 
 index f974089 . . 7d69b67 100644 
 - - - a / config / pmd . xml 
 + + + b / config / pmd . xml 
 @ @ - 190 , 6 + 190 , 13 @ @ 
 < / properties > 
 < / rule > 
 
 + < rule ref = " rulesets / java / design . xml / AvoidSynchronizedAtMethodLevel " > 
 + < properties > 
 + < ! - - UniqueProperties # put overloads synchronized method , so it should have synchronized modifier - - > 
 + < property name = " violationSuppressXPath " value = " / / ClassOrInterfaceDeclaration [ @ Image = ' UniqueProperties ' ] / / MethodDeclarator [ @ Image = ' put ' ] " / > 
 + < / properties > 
 + < / rule > 
 + 
 < rule ref = " rulesets / java / empty . xml " / > 
 < rule ref = " rulesets / java / empty . xml / EmptyCatchBlock " > 
 < properties > 
 diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / DefaultConfiguration . java b / src / main / java / com / puppycrawl / tools / checkstyle / DefaultConfiguration . java 
 index 8467b1b . . 2154b85 100644 
 - - - a / src / main / java / com / puppycrawl / tools / checkstyle / DefaultConfiguration . java 
 + + + b / src / main / java / com / puppycrawl / tools / checkstyle / DefaultConfiguration . java 
 @ @ - 32 , 6 + 32 , 7 @ @ import com . puppycrawl . tools . checkstyle . api . Configuration ; 
 / * * 
 * Default implementation of the Configuration interface . 
 * @ author lkuehne 
 + * @ noinspection SerializableHasSerializationMethods 
 * / 
 public final class DefaultConfiguration implements Configuration { 
 private static final long serialVersionUID = 1157875385356127169L ; 
 diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / Main . java b / src / main / java / com / puppycrawl / tools / checkstyle / Main . java 
 index 27fd41a . . 5198806 100644 
 - - - a / src / main / java / com / puppycrawl / tools / checkstyle / Main . java 
 + + + b / src / main / java / com / puppycrawl / tools / checkstyle / Main . java 
 @ @ - 569 , 6 + 569 , 7 @ @ public final class Main { 
 * @ param outputLocation the location of output 
 * @ return a fresh new { @ code AuditListener } 
 * @ exception FileNotFoundException when provided output location is not found 
 + * @ noinspection IOResourceOpenedButNotSafelyClosed 
 * / 
 private static AuditListener createListener ( String format , 
 String outputLocation ) 
 diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / PropertyCacheFile . java b / src / main / java / com / puppycrawl / tools / checkstyle / PropertyCacheFile . java 
 index 68f1a01 . . ef03801 100644 
 - - - a / src / main / java / com / puppycrawl / tools / checkstyle / PropertyCacheFile . java 
 + + + b / src / main / java / com / puppycrawl / tools / checkstyle / PropertyCacheFile . java 
 @ @ - 246 , 9 + 246 , 8 @ @ final class PropertyCacheFile { 
 * / 
 private static void serialize ( Serializable object , 
 OutputStream outputStream ) throws IOException { 
 - ObjectOutputStream oos = null ; 
 + final ObjectOutputStream oos = new ObjectOutputStream ( outputStream ) ; 
 try { 
 - oos = new ObjectOutputStream ( outputStream ) ; 
 oos . writeObject ( object ) ; 
 } 
 finally { 
 diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / ThreadModeSettings . java b / src / main / java / com / puppycrawl / tools / checkstyle / ThreadModeSettings . java 
 index dac67c0 . . b3b3449 100644 
 - - - a / src / main / java / com / puppycrawl / tools / checkstyle / ThreadModeSettings . java 
 + + + b / src / main / java / com / puppycrawl / tools / checkstyle / ThreadModeSettings . java 
 @ @ - 24 , 6 + 24 , 7 @ @ import java . io . Serializable ; 
 / * * 
 * Thread mode settings for the checkstyle modules . 
 * @ author Andrew Kuchev 
 + * @ noinspection SerializableHasSerializationMethods 
 * / 
 public class ThreadModeSettings implements Serializable { 
 / * * A checker module name . * / 
 diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / ant / CheckstyleAntTask . java b / src / main / java / com / puppycrawl / tools / checkstyle / ant / CheckstyleAntTask . java 
 index 5df05bf . . f1b287f 100644 
 - - - a / src / main / java / com / puppycrawl / tools / checkstyle / ant / CheckstyleAntTask . java 
 + + + b / src / main / java / com / puppycrawl / tools / checkstyle / ant / CheckstyleAntTask . java 
 @ @ - 64 , 6 + 64 , 7 @ @ import com . puppycrawl . tools . checkstyle . api . SeverityLevelCounter ; 
 * An implementation of a ANT task for calling checkstyle . See the documentation 
 * of the task for usage . 
 * @ author Oliver Burn 
 + * @ noinspection ClassLoaderInstantiation 
 * / 
 public class CheckstyleAntTask extends Task { 
 / * * Poor man ' s enum for an xml formatter . * / 
 diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / api / AuditEvent . java b / src / main / java / com / puppycrawl / tools / checkstyle / api / AuditEvent . java 
 index acad045 . . 0157f98 100644 
 - - - a / src / main / java / com / puppycrawl / tools / checkstyle / api / AuditEvent . java 
 + + + b / src / main / java / com / puppycrawl / tools / checkstyle / api / AuditEvent . java 
 @ @ - 37 , 6 + 37 , 7 @ @ import java . util . EventObject ; 
 * 
 * @ author < a href = " mailto : stephane . bailliez @ wanadoo . fr " > Stephane Bailliez < / a > 
 * @ see AuditListener 
 + * @ noinspection SerializableHasSerializationMethods 
 * / 
 public final class AuditEvent 
 extends EventObject { 
 diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / api / DetailAST . java b / src / main / java / com / puppycrawl / tools / checkstyle / api / DetailAST . java 
 index dab8f8a . . 74f9e76 100644 
 - - - a / src / main / java / com / puppycrawl / tools / checkstyle / api / DetailAST . java 
 + + + b / src / main / java / com / puppycrawl / tools / checkstyle / api / DetailAST . java 
 @ @ - 32 , 7 + 32 , 7 @ @ import com . puppycrawl . tools . checkstyle . utils . TokenUtils ; 
 * @ author Oliver Burn 
 * @ author lkuehne 
 * @ see < a href = " http : / / www . antlr . org / " > ANTLR Website < / a > 
 - * @ noinspection FieldNotUsedInToString 
 + * @ noinspection FieldNotUsedInToString , SerializableHasSerializationMethods 
 * / 
 public final class DetailAST extends CommonASTWithHiddenTokens { 
 private static final long serialVersionUID = - 2580884815577559874L ; 
 diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / api / FileText . java b / src / main / java / com / puppycrawl / tools / checkstyle / api / FileText . java 
 index 1dc1d71 . . b550a76 100644 
 - - - a / src / main / java / com / puppycrawl / tools / checkstyle / api / FileText . java 
 + + + b / src / main / java / com / puppycrawl / tools / checkstyle / api / FileText . java 
 @ @ - 127 , 16 + 127 , 20 @ @ public final class FileText { 
 / / is about 30 % faster than using the 
 / / LINE _ TERMINATOR . split ( fullText , - 1 ) method 
 final ArrayList < String > textLines = new ArrayList < > ( ) ; 
 - final BufferedReader reader = 
 - new BufferedReader ( new StringReader ( fullText ) ) ; 
 - while ( true ) { 
 - final String line = reader . readLine ( ) ; 
 - if ( line = = null ) { 
 - break ; 
 + final BufferedReader reader = new BufferedReader ( new StringReader ( fullText ) ) ; 
 + try { 
 + while ( true ) { 
 + final String line = reader . readLine ( ) ; 
 + if ( line = = null ) { 
 + break ; 
 + } 
 + textLines . add ( line ) ; 
 } 
 - textLines . add ( line ) ; 
 + lines = textLines . toArray ( new String [ textLines . size ( ) ] ) ; 
 + } 
 + finally { 
 + Closeables . closeQuietly ( reader ) ; 
 } 
 - lines = textLines . toArray ( new String [ textLines . size ( ) ] ) ; 
 } 
 
 / * * 
 diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / api / LocalizedMessage . java b / src / main / java / com / puppycrawl / tools / checkstyle / api / LocalizedMessage . java 
 index 3fa49e6 . . e6675ad 100644 
 - - - a / src / main / java / com / puppycrawl / tools / checkstyle / api / LocalizedMessage . java 
 + + + b / src / main / java / com / puppycrawl / tools / checkstyle / api / LocalizedMessage . java 
 @ @ - 45 , 7 + 45 , 7 @ @ import java . util . ResourceBundle . Control ; 
 * 
 * @ author Oliver Burn 
 * @ author lkuehne 
 - * @ noinspection ConstructorWithTooManyParameters 
 + * @ noinspection ConstructorWithTooManyParameters , SerializableHasSerializationMethods 
 * / 
 public final class LocalizedMessage 
 implements Comparable < LocalizedMessage > , Serializable { 
 @ @ - 78 , 7 + 78 , 9 @ @ public final class LocalizedMessage 
 / * * Key for the message format . * * / 
 private final String key ; 
 
 - / * * Arguments for MessageFormat . * * / 
 + / * * Arguments for MessageFormat . 
 + * @ noinspection NonSerializableFieldInSerializableClass 
 + * / 
 private final Object [ ] args ; 
 
 / * * Name of the resource bundle to get messages from . * * / 
 @ @ - 388 , 6 + 390 , 7 @ @ public final class LocalizedMessage 
 * < / p > 
 * 
 * @ author < a href = " mailto : nesterenko - aleksey @ list . ru " > Aleksey Nesterenko < / a > 
 + * @ noinspection IOResourceOpenedButNotSafelyClosed 
 * / 
 public static class Utf8Control extends Control { 
 @ Override 
 diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / checks / UniquePropertiesCheck . java b / src / main / java / com / puppycrawl / tools / checkstyle / checks / UniquePropertiesCheck . java 
 index cd93107 . . d581894 100644 
 - - - a / src / main / java / com / puppycrawl / tools / checkstyle / checks / UniquePropertiesCheck . java 
 + + + b / src / main / java / com / puppycrawl / tools / checkstyle / checks / UniquePropertiesCheck . java 
 @ @ - 134 , 7 + 134 , 7 @ @ public class UniquePropertiesCheck extends AbstractFileSetCheck { 
 * Properties subclass to store duplicated property keys in a separate map . 
 * 
 * @ author Pavel Baranchikov 
 - * @ noinspection ClassExtendsConcreteCollection 
 + * @ noinspection ClassExtendsConcreteCollection , SerializableHasSerializationMethods 
 * / 
 private static class UniqueProperties extends Properties { 
 private static final long serialVersionUID = 1L ; 
 @ @ - 146 , 7 + 146 , 7 @ @ public class UniquePropertiesCheck extends AbstractFileSetCheck { 
 . create ( ) ; 
 
 @ Override 
 - public Object put ( Object key , Object value ) { 
 + public synchronized Object put ( Object key , Object value ) { 
 final Object oldValue = super . put ( key , value ) ; 
 if ( oldValue ! = null & & key instanceof String ) { 
 final String keyString = ( String ) key ; 
 diff - - git a / src / main / java / com / puppycrawl / tools / checkstyle / checks / header / AbstractHeaderCheck . java b / src / main / java / com / puppycrawl / tools / checkstyle / checks / header / AbstractHeaderCheck . java 
 index d3b0271 . . b1b5b0a 100644 
 - - - a / src / main / java / com / puppycrawl / tools / checkstyle / checks / header / AbstractHeaderCheck . java 
 + + + b / src / main / java / com / puppycrawl / tools / checkstyle / checks / header / AbstractHeaderCheck . java 
 @ @ - 168 , 14 + 168 , 20 @ @ public abstract class AbstractHeaderCheck extends AbstractFileSetCheck 
 * / 
 private void loadHeader ( final Reader headerReader ) throws IOException { 
 final LineNumberReader lnr = new LineNumberReader ( headerReader ) ; 
 - while ( true ) { 
 - final String line = lnr . readLine ( ) ; 
 - if ( line = = null ) { 
 - break ; 
 + try { 
 + while ( true ) { 
 + final String line = lnr . readLine ( ) ; 
 + if ( line = = null ) { 
 + break ; 
 + } 
 + readerLines . add ( line ) ; 
 } 
 - readerLines . add ( line ) ; 
 + postProcessHeaderLines ( ) ; 
 + } 
 + finally { 
 + Closeables . closeQuietly ( lnr ) ; 
 } 
 - postProcessHeaderLines ( ) ; 
 + 
 } 
 
 @ Override 
 diff - - git a / src / test / java / com / puppycrawl / tools / checkstyle / api / FileTextTest . java b / src / test / java / com / puppycrawl / tools / checkstyle / api / FileTextTest . java 
 index 1fd577b . . ebfe4b1 100644 
 - - - a / src / test / java / com / puppycrawl / tools / checkstyle / api / FileTextTest . java 
 + + + b / src / test / java / com / puppycrawl / tools / checkstyle / api / FileTextTest . java 
 @ @ - 68 , 7 + 68 , 7 @ @ public class FileTextTest { 
 + " checkstyle / api / import - control _ complete . xml " ) , charsetName ) ; 
 assertEquals ( charsetName , fileText . getCharset ( ) . name ( ) ) ; 
 
 - verifyStatic ( times ( 1 ) ) ; 
 + verifyStatic ( times ( 2 ) ) ; 
 Closeables . closeQuietly ( any ( Reader . class ) ) ; 
 } 
 
 diff - - git a / src / test / java / com / puppycrawl / tools / checkstyle / checks / header / RegexpHeaderCheckTest . java b / src / test / java / com / puppycrawl / tools / checkstyle / checks / header / RegexpHeaderCheckTest . java 
 index b709ef3 . . 54018b7 100644 
 - - - a / src / test / java / com / puppycrawl / tools / checkstyle / checks / header / RegexpHeaderCheckTest . java 
 + + + b / src / test / java / com / puppycrawl / tools / checkstyle / checks / header / RegexpHeaderCheckTest . java 
 @ @ - 113 , 7 + 113 , 7 @ @ public class RegexpHeaderCheckTest extends BaseFileSetCheckTestSupport { 
 final String header = " abc . * " ; 
 instance . setHeader ( header ) ; 
 
 - verifyStatic ( times ( 1 ) ) ; 
 + verifyStatic ( times ( 2 ) ) ; 
 Closeables . closeQuietly ( any ( Reader . class ) ) ; 
 } 
 
 @ @ - 372 , 7 + 372 , 7 @ @ public class RegexpHeaderCheckTest extends BaseFileSetCheckTestSupport { 
 createChecker ( checkConfig ) ; 
 
 / / check if reader finally closed 
 - verifyStatic ( times ( 1 ) ) ; 
 + verifyStatic ( times ( 2 ) ) ; 
 Closeables . closeQuietly ( any ( InputStreamReader . class ) ) ; 
 } 
 }

NEAREST DIFF:
diff - - git a / src / test / java / com / puppycrawl / tools / checkstyle / checks / header / HeaderCheckTest . java b / src / test / java / com / puppycrawl / tools / checkstyle / checks / header / HeaderCheckTest . java 
 index 2dca5da . . 665dc16 100644 
 - - - a / src / test / java / com / puppycrawl / tools / checkstyle / checks / header / HeaderCheckTest . java 
 + + + b / src / test / java / com / puppycrawl / tools / checkstyle / checks / header / HeaderCheckTest . java 
 @ @ - 56 , 7 + 56 , 9 @ @ public class HeaderCheckTest extends BaseFileSetCheckTestSupport { 
 @ Override 
 protected String getPath ( String filename ) throws IOException { 
 return super . getPath ( " checks " + File . separator 
 - + " header " + File . separator + filename ) ; 
 + + " header " + File . separator 
 + + " header " + File . separator 
 + + filename ) ; 
 } 
 
 private String getConfigPath ( String filename ) throws IOException { 
 @ @ - 80 , 7 + 82 , 7 @ @ public class HeaderCheckTest extends BaseFileSetCheckTestSupport { 
 try { 
 createChecker ( checkConfig ) ; 
 final String [ ] expected = CommonUtils . EMPTY _ STRING _ ARRAY ; 
 - verify ( checkConfig , getPath ( " InputRegexpHeader1 . java " ) , expected ) ; 
 + verify ( checkConfig , getPath ( " InputRegexpHeader . java " ) , expected ) ; 
 } 
 catch ( CheckstyleException ex ) { 
 / / Exception is not expected 
 @ @ - 95 , 7 + 97 , 7 @ @ public class HeaderCheckTest extends BaseFileSetCheckTestSupport { 
 try { 
 createChecker ( checkConfig ) ; 
 final String [ ] expected = CommonUtils . EMPTY _ STRING _ ARRAY ; 
 - verify ( checkConfig , getPath ( " InputRegexpHeader1 . java " ) , expected ) ; 
 + verify ( checkConfig , getPath ( " InputRegexpHeader . java " ) , expected ) ; 
 } 
 catch ( CheckstyleException ex ) { 
 / / Exception is not expected 
 @ @ - 233 , 7 + 235 , 7 @ @ public class HeaderCheckTest extends BaseFileSetCheckTestSupport { 
 PowerMockito . doThrow ( new IOException ( " expected exception " ) ) . when ( check , " loadHeader " , 
 anyObject ( ) ) ; 
 
 - check . setHeaderFile ( CommonUtils . getUriByFilename ( getPath ( " InputRegexpHeader1 . java " ) ) ) ; 
 + check . setHeaderFile ( CommonUtils . getUriByFilename ( getPath ( " InputRegexpHeader . java " ) ) ) ; 
 
 final Method loadHeaderFile = AbstractHeaderCheck . class . getDeclaredMethod ( " loadHeaderFile " ) ; 
 loadHeaderFile . setAccessible ( true ) ; 
 diff - - git a / src / test / resources / com / puppycrawl / tools / checkstyle / checks / header / InputHeader . java b / src / test / resources / com / puppycrawl / tools / checkstyle / checks / header / InputHeader . java 
 deleted file mode 100644 
 index 896ae03 . . 0000000 
 - - - a / src / test / resources / com / puppycrawl / tools / checkstyle / checks / header / InputHeader . java 
 + + + / dev / null 
 @ @ - 1 + 0 , 0 @ @ 
 - package com . puppycrawl . tools . checkstyle . checks . header ; class InputHeader { } / / One line test 
 diff - - git a / src / test / resources / com / puppycrawl / tools / checkstyle / checks / header / InputRegexpHeader1 . java b / src / test / resources / com / puppycrawl / tools / checkstyle / checks / header / InputRegexpHeader1 . java 
 deleted file mode 100644 
 index 6e25292 . . 0000000 
 - - - a / src / test / resources / com / puppycrawl / tools / checkstyle / checks / header / InputRegexpHeader1 . java 
 + + + / dev / null 
 @ @ - 1 , 11 + 0 , 0 @ @ 
 - package com . puppycrawl . tools . checkstyle . checks . header ; 
 - 
 - import java . awt . * ; 
 - 
 - / * * 
 - * Some doc . 
 - * / 
 - 
 - public class InputRegexpHeader1 
 - { 
 - } 
 diff - - git a / src / test / resources / com / puppycrawl / tools / checkstyle / checks / header / header / InputHeader . java b / src / test / resources / com / puppycrawl / tools / checkstyle / checks / header / header / InputHeader . java 
 new file mode 100644 
 index 0000000 . . 366225c 
 - - - / dev / null 
 + + + b / src / test / resources / com / puppycrawl / tools / checkstyle / checks / header / header / InputHeader . java 
 @ @ - 0 , 0 + 1 @ @ 
 + package com . puppycrawl . tools . checkstyle . checks . header . header ; class InputHeader { } / / One line test 
 diff - - git a / src / test / resources / com / puppycrawl / tools / checkstyle / checks / header / header / InputRegexpHeader . java b / src / test / resources / com / puppycrawl / tools / checkstyle / checks / header / header / InputRegexpHeader . java 
 new file mode 100644 
 index 0000000 . . 430953b 
 - - - / dev / null 
 + + + b / src / test / resources / com / puppycrawl / tools / checkstyle / checks / header / header / InputRegexpHeader . java 
 @ @ - 0 , 0 + 1 , 11 @ @ 
 + package com . puppycrawl . tools . checkstyle . checks . header . header ; 
 + 
 + import java . awt . * ; 
 + 
 + / * * 
 + * Some doc . 
 + * / 
 + 
 + public class InputRegexpHeader 
 + { 
 + }
